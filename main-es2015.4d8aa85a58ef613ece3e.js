(self.webpackChunkVillagerKings=self.webpackChunkVillagerKings||[]).push([[179],{98255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=98255,e.exports=t},48475:function(e,t,i){"use strict";function s(e){return"function"==typeof e}let r=!1;const n={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=e},get useDeprecatedSynchronousErrorHandling(){return r}};function o(e){setTimeout(()=>{throw e},0)}const a={closed:!0,next(e){},error(e){if(n.useDeprecatedSynchronousErrorHandling)throw e;o(e)},complete(){}},c=Array.isArray||(e=>e&&"number"==typeof e.length);function l(e){return null!==e&&"object"==typeof e}const u=(()=>{function e(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e})();class h{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:n}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof h)t.remove(this);else if(null!==t)for(let s=0;s<t.length;++s)t[s].remove(this);if(s(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof u?g(o.errors):[o]}}if(c(n)){let t=-1,i=n.length;for(;++t<i;){const i=n[t];if(l(i))try{i.unsubscribe()}catch(a){e=e||[],a instanceof u?e=e.concat(g(a.errors)):e.push(a)}}}if(e)throw new u(e)}add(e){let t=e;if(!e)return h.EMPTY;switch(typeof e){case"function":t=new h(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof h)){const e=t;t=new h,t._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof h){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const s=this._subscriptions;return null===s?this._subscriptions=[t]:s.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var d;function g(e){return e.reduce((e,t)=>e.concat(t instanceof u?t.errors:t),[])}h.EMPTY=((d=new h).closed=!0,d);const p="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class f extends h{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!e){this.destination=a;break}if("object"==typeof e){e instanceof f?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,e,t,i)}}[p](){return this}static create(e,t,i){const s=new f(e,t,i);return s.syncErrorThrowable=!1,s}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class m extends f{constructor(e,t,i,r){super(),this._parentSubscriber=e;let n,o=this;s(t)?n=t:t&&(n=t.next,i=t.error,r=t.complete,t!==a&&(o=Object.create(t),s(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=n,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;n.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=n;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):o(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;o(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);n.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),n.useDeprecatedSynchronousErrorHandling)throw i;o(i)}}__tryOrSetError(e,t,i){if(!n.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(s){return n.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=s,e.syncErrorThrown=!0,!0):(o(s),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const S="function"==typeof Symbol&&Symbol.observable||"@@observable";function E(e){return e}let v=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(e,t,i){const{operator:s}=this,r=function(e,t,i){if(e){if(e instanceof f)return e;if(e[p])return e[p]()}return e||t||i?new f(e,t,i):new f(a)}(e,t,i);if(r.add(s?s.call(r,this.source):this.source||n.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),n.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}_trySubscribe(e){try{return this._subscribe(e)}catch(t){n.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:i,isStopped:s}=e;if(t||s)return!1;e=i&&i instanceof f?i:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=R(t))((t,i)=>{let s;s=this.subscribe(t=>{try{e(t)}catch(r){i(r),s&&s.unsubscribe()}},i,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[S](){return this}pipe(...e){return 0===e.length?this:function(e){return 0===e.length?E:1===e.length?e[0]:function(t){return e.reduce((e,t)=>t(e),t)}}(e)(this)}toPromise(e){return new(e=R(e))((e,t)=>{let i;this.subscribe(e=>i=e,e=>t(e),()=>e(i))})}}return e.create=t=>new e(t),e})();function R(e){if(e||(e=n.Promise||Promise),!e)throw new Error("no Promise impl found");return e}const O=(()=>{function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e})();class T extends h{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class I extends f{constructor(e){super(e),this.destination=e}}let b=(()=>{class e extends v{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[p](){return new I(this)}lift(e){const t=new C(this,this);return t.operator=e,t}next(e){if(this.closed)throw new O;if(!this.isStopped){const{observers:t}=this,i=t.length,s=t.slice();for(let r=0;r<i;r++)s[r].next(e)}}error(e){if(this.closed)throw new O;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,i=t.length,s=t.slice();for(let r=0;r<i;r++)s[r].error(e);this.observers.length=0}complete(){if(this.closed)throw new O;this.isStopped=!0;const{observers:e}=this,t=e.length,i=e.slice();for(let s=0;s<t;s++)i[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new O;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new O;return this.hasError?(e.error(this.thrownError),h.EMPTY):this.isStopped?(e.complete(),h.EMPTY):(this.observers.push(e),new T(this,e))}asObservable(){const e=new v;return e.source=this,e}}return e.create=(e,t)=>new C(e,t),e})();class C extends b{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):h.EMPTY}}function y(e){return e&&"function"==typeof e.schedule}function A(e,t){return function(i){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new N(e,t))}}class N{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new _(e,this.project,this.thisArg))}}class _ extends f{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const w=e=>t=>{for(let i=0,s=e.length;i<s&&!t.closed;i++)t.next(e[i]);t.complete()},P="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",M=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function L(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}const D=e=>{if(e&&"function"==typeof e[S])return(e=>t=>{const i=e[S]();if("function"!=typeof i.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return i.subscribe(t)})(e);if(M(e))return w(e);if(L(e))return(e=>t=>(e.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,o),t))(e);if(e&&"function"==typeof e[P])return(e=>t=>{const i=e[P]();for(;;){let e;try{e=i.next()}catch(s){return t.error(s),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof i.return&&t.add(()=>{i.return&&i.return()}),t})(e);{const t=`You provided ${l(e)?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function x(e,t){return new v(i=>{const s=new h;let r=0;return s.add(t.schedule(function(){r!==e.length?(i.next(e[r++]),i.closed||s.add(this.schedule())):i.complete()})),s})}function k(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[S]}(e))return function(e,t){return new v(i=>{const s=new h;return s.add(t.schedule(()=>{const r=e[S]();s.add(r.subscribe({next(e){s.add(t.schedule(()=>i.next(e)))},error(e){s.add(t.schedule(()=>i.error(e)))},complete(){s.add(t.schedule(()=>i.complete()))}}))})),s})}(e,t);if(L(e))return function(e,t){return new v(i=>{const s=new h;return s.add(t.schedule(()=>e.then(e=>{s.add(t.schedule(()=>{i.next(e),s.add(t.schedule(()=>i.complete()))}))},e=>{s.add(t.schedule(()=>i.error(e)))}))),s})}(e,t);if(M(e))return x(e,t);if(function(e){return e&&"function"==typeof e[P]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new v(i=>{const s=new h;let r;return s.add(()=>{r&&"function"==typeof r.return&&r.return()}),s.add(t.schedule(()=>{r=e[P](),s.add(t.schedule(function(){if(i.closed)return;let e,t;try{const i=r.next();e=i.value,t=i.done}catch(s){return void i.error(s)}t?i.complete():(i.next(e),this.schedule())}))})),s})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof v?e:new v(D(e))}class F extends f{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class U extends f{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function H(e,t){if(!t.closed)return e instanceof v?e.subscribe(t):D(e)(t)}function G(e,t,i=Number.POSITIVE_INFINITY){return"function"==typeof t?s=>s.pipe(G((i,s)=>k(e(i,s)).pipe(A((e,r)=>t(i,e,s,r))),i)):("number"==typeof t&&(i=t),t=>t.lift(new B(e,i)))}class B{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new W(e,this.project,this.concurrent))}}class W extends U{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(s){return void this.destination.error(s)}this.active++,this._innerSub(t)}_innerSub(e){const t=new F(this),i=this.destination;i.add(t);const s=H(e,t);s!==t&&i.add(s)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function V(e=Number.POSITIVE_INFINITY){return G(E,e)}function z(e,t){return t?x(e,t):new v(w(e))}function Y(...e){let t=Number.POSITIVE_INFINITY,i=null,s=e[e.length-1];return y(s)?(i=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof s&&(t=e.pop()),null===i&&1===e.length&&e[0]instanceof v?e[0]:V(t)(z(e,i))}function K(){return function(e){return e.lift(new j(e))}}class j{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const s=new $(e,i),r=t.subscribe(s);return s.closed||(s.connection=i.connect()),r}}class $ extends f{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,s=e._connection;this.connection=null,s&&(!i||s===i)&&s.unsubscribe()}}class Q extends v{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new h,e.add(this.source.subscribe(new X(this.getSubject(),this))),e.closed&&(this._connection=null,e=h.EMPTY)),e}refCount(){return K()(this)}}const q=(()=>{const e=Q.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class X extends I{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function Z(){return new b}function J(e){for(let t in e)if(e[t]===J)return t;throw Error("Could not find renamed property on target object.")}function ee(e,t){for(const i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}function te(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(te).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const i=t.indexOf("\n");return-1===i?t:t.substring(0,i)}function ie(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const se=J({__forward_ref__:J});function re(e){return e.__forward_ref__=re,e.toString=function(){return te(this())},e}function ne(e){return oe(e)?e():e}function oe(e){return"function"==typeof e&&e.hasOwnProperty(se)&&e.__forward_ref__===re}class ae extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function ce(e){return"string"==typeof e?e:null==e?"":String(e)}function le(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():ce(e)}function ue(e,t){const i=t?` in ${t}`:"";throw new ae("201",`No provider for ${le(e)} found${i}`)}function he(e,t){null==e&&function(e,t,i,s){throw new Error(`ASSERTION ERROR: ${e}`+(null==s?"":` [Expected=> ${i} ${s} ${t} <=Actual]`))}(t,e,null,"!=")}function de(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ge(e){return{providers:e.providers||[],imports:e.imports||[]}}function pe(e){return fe(e,Se)||fe(e,ve)}function fe(e,t){return e.hasOwnProperty(t)?e[t]:null}function me(e){return e&&(e.hasOwnProperty(Ee)||e.hasOwnProperty(Re))?e[Ee]:null}const Se=J({"\u0275prov":J}),Ee=J({"\u0275inj":J}),ve=J({ngInjectableDef:J}),Re=J({ngInjectorDef:J});var Oe=(()=>((Oe=Oe||{})[Oe.Default=0]="Default",Oe[Oe.Host=1]="Host",Oe[Oe.Self=2]="Self",Oe[Oe.SkipSelf=4]="SkipSelf",Oe[Oe.Optional=8]="Optional",Oe))();let Te;function Ie(e){const t=Te;return Te=e,t}function be(e,t,i){const s=pe(e);return s&&"root"==s.providedIn?void 0===s.value?s.value=s.factory():s.value:i&Oe.Optional?null:void 0!==t?t:void ue(te(e),"Injector")}function Ce(e){return{toString:e}.toString()}var ye=(()=>((ye=ye||{})[ye.OnPush=0]="OnPush",ye[ye.Default=1]="Default",ye))(),Ae=(()=>((Ae=Ae||{})[Ae.Emulated=0]="Emulated",Ae[Ae.None=2]="None",Ae[Ae.ShadowDom=3]="ShadowDom",Ae))();const Ne="undefined"!=typeof globalThis&&globalThis,_e="undefined"!=typeof window&&window,we="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Pe="undefined"!=typeof global&&global,Me=Ne||Pe||_e||we,Le={},De=[],xe=J({"\u0275cmp":J}),ke=J({"\u0275dir":J}),Fe=J({"\u0275pipe":J}),Ue=J({"\u0275mod":J}),He=J({"\u0275loc":J}),Ge=J({"\u0275fac":J}),Be=J({__NG_ELEMENT_ID__:J});let We=0;function Ve(e){return Ce(()=>{const t={},i={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===ye.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||De,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ae.Emulated,id:"c",styles:e.styles||De,_:null,setInput:null,schemas:e.schemas||null,tView:null},s=e.directives,r=e.features,n=e.pipes;return i.id+=We++,i.inputs=$e(e.inputs,t),i.outputs=$e(e.outputs),r&&r.forEach(e=>e(i)),i.directiveDefs=s?()=>("function"==typeof s?s():s).map(ze):null,i.pipeDefs=n?()=>("function"==typeof n?n():n).map(Ye):null,i})}function ze(e){return Xe(e)||function(e){return e[ke]||null}(e)}function Ye(e){return function(e){return e[Fe]||null}(e)}const Ke={};function je(e){return Ce(()=>{const t={type:e.type,bootstrap:e.bootstrap||De,declarations:e.declarations||De,imports:e.imports||De,exports:e.exports||De,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(Ke[e.id]=e.type),t})}function $e(e,t){if(null==e)return Le;const i={};for(const s in e)if(e.hasOwnProperty(s)){let r=e[s],n=r;Array.isArray(r)&&(n=r[1],r=r[0]),i[r]=s,t&&(t[r]=n)}return i}const Qe=Ve;function qe(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Xe(e){return e[xe]||null}function Ze(e,t){const i=e[Ue]||null;if(!i&&!0===t)throw new Error(`Type ${te(e)} does not have '\u0275mod' property.`);return i}function Je(e){return Array.isArray(e)&&"object"==typeof e[1]}function et(e){return Array.isArray(e)&&!0===e[1]}function tt(e){return 0!=(8&e.flags)}function it(e){return 2==(2&e.flags)}function st(e){return 1==(1&e.flags)}function rt(e){return null!==e.template}function nt(e){return 0!=(512&e[2])}function ot(e,t){return e.hasOwnProperty(Ge)?e[Ge]:null}class at{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function ct(){return lt}function lt(e){return e.type.prototype.ngOnChanges&&(e.setInput=ht),ut}function ut(){const e=gt(this),t=null==e?void 0:e.current;if(t){const i=e.previous;if(i===Le)e.previous=t;else for(let e in t)i[e]=t[e];e.current=null,this.ngOnChanges(t)}}function ht(e,t,i,s){const r=gt(e)||function(e,t){return e[dt]=t}(e,{previous:Le,current:null}),n=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[i],c=o[a];n[a]=new at(c&&c.currentValue,t,o===Le),e[s]=t}ct.ngInherit=!0;const dt="__ngSimpleChanges__";function gt(e){return e[dt]||null}const pt="http://www.w3.org/2000/svg";let ft;function mt(){return void 0!==ft?ft:"undefined"!=typeof document?document:void 0}function St(e){return!!e.listen}const Et={createRenderer:(e,t)=>mt()};function vt(e){for(;Array.isArray(e);)e=e[0];return e}function Rt(e,t){return vt(t[e])}function Ot(e,t){return vt(t[e.index])}function Tt(e,t){return e.data[t]}function It(e,t){return e[t]}function bt(e,t){const i=t[e];return Je(i)?i:i[0]}function Ct(e){return 4==(4&e[2])}function yt(e){return 128==(128&e[2])}function At(e,t){return null==t?null:e[t]}function Nt(e){e[18]=0}function _t(e,t){e[5]+=t;let i=e,s=e[3];for(;null!==s&&(1===t&&1===i[5]||-1===t&&0===i[5]);)s[5]+=t,i=s,s=s[3]}const wt={lFrame:ei(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Pt(){return wt.bindingsEnabled}function Mt(){return wt.lFrame.lView}function Lt(){return wt.lFrame.tView}function Dt(e){return wt.lFrame.contextLView=e,e[8]}function xt(){let e=kt();for(;null!==e&&64===e.type;)e=e.parent;return e}function kt(){return wt.lFrame.currentTNode}function Ft(e,t){const i=wt.lFrame;i.currentTNode=e,i.isParent=t}function Ut(){return wt.lFrame.isParent}function Ht(){wt.lFrame.isParent=!1}function Gt(){return wt.isInCheckNoChangesMode}function Bt(e){wt.isInCheckNoChangesMode=e}function Wt(){const e=wt.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Vt(){return wt.lFrame.bindingIndex}function zt(){return wt.lFrame.bindingIndex++}function Yt(e){const t=wt.lFrame,i=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,i}function Kt(e,t){const i=wt.lFrame;i.bindingIndex=i.bindingRootIndex=e,jt(t)}function jt(e){wt.lFrame.currentDirectiveIndex=e}function $t(){return wt.lFrame.currentQueryIndex}function Qt(e){wt.lFrame.currentQueryIndex=e}function qt(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function Xt(e,t,i){if(i&Oe.SkipSelf){let s=t,r=e;for(;!(s=s.parent,null!==s||i&Oe.Host||(s=qt(r),null===s||(r=r[15],10&s.type))););if(null===s)return!1;t=s,e=r}const s=wt.lFrame=Jt();return s.currentTNode=t,s.lView=e,!0}function Zt(e){const t=Jt(),i=e[1];wt.lFrame=t,t.currentTNode=i.firstChild,t.lView=e,t.tView=i,t.contextLView=e,t.bindingIndex=i.bindingStartIndex,t.inI18n=!1}function Jt(){const e=wt.lFrame,t=null===e?null:e.child;return null===t?ei(e):t}function ei(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function ti(){const e=wt.lFrame;return wt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const ii=ti;function si(){const e=ti();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function ri(){return wt.lFrame.selectedIndex}function ni(e){wt.lFrame.selectedIndex=e}function oi(){const e=wt.lFrame;return Tt(e.tView,e.selectedIndex)}function ai(){wt.lFrame.currentNamespace=pt}function ci(e,t){for(let i=t.directiveStart,s=t.directiveEnd;i<s;i++){const t=e.data[i].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:r,ngAfterViewInit:n,ngAfterViewChecked:o,ngOnDestroy:a}=t;s&&(e.contentHooks||(e.contentHooks=[])).push(-i,s),r&&((e.contentHooks||(e.contentHooks=[])).push(i,r),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(i,r)),n&&(e.viewHooks||(e.viewHooks=[])).push(-i,n),o&&((e.viewHooks||(e.viewHooks=[])).push(i,o),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(i,o)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(i,a)}}function li(e,t,i){di(e,t,3,i)}function ui(e,t,i,s){(3&e[2])===i&&di(e,t,i,s)}function hi(e,t){let i=e[2];(3&i)===t&&(i&=2047,i+=1,e[2]=i)}function di(e,t,i,s){const r=null!=s?s:-1,n=t.length-1;let o=0;for(let a=void 0!==s?65535&e[18]:0;a<n;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=s&&o>=s)break}else t[a]<0&&(e[18]+=65536),(o<r||-1==r)&&(gi(e,i,t,a),e[18]=(4294901760&e[18])+a+2),a++}function gi(e,t,i,s){const r=i[s]<0,n=i[s+1],o=e[r?-i[s]:i[s]];if(r){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{n.call(o)}finally{}}}else try{n.call(o)}finally{}}class pi{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function fi(e,t,i){const s=St(e);let r=0;for(;r<i.length;){const n=i[r];if("number"==typeof n){if(0!==n)break;r++;const o=i[r++],a=i[r++],c=i[r++];s?e.setAttribute(t,a,c,o):t.setAttributeNS(o,a,c)}else{const o=n,a=i[++r];Si(o)?s&&e.setProperty(t,o,a):s?e.setAttribute(t,o,a):t.setAttribute(o,a),r++}}return r}function mi(e){return 3===e||4===e||6===e}function Si(e){return 64===e.charCodeAt(0)}function Ei(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let i=-1;for(let s=0;s<t.length;s++){const r=t[s];"number"==typeof r?i=r:0===i||vi(e,i,r,null,-1===i||2===i?t[++s]:null)}}return e}function vi(e,t,i,s,r){let n=0,o=e.length;if(-1===t)o=-1;else for(;n<e.length;){const i=e[n++];if("number"==typeof i){if(i===t){o=-1;break}if(i>t){o=n-1;break}}}for(;n<e.length;){const t=e[n];if("number"==typeof t)break;if(t===i){if(null===s)return void(null!==r&&(e[n+1]=r));if(s===e[n+1])return void(e[n+2]=r)}n++,null!==s&&n++,null!==r&&n++}-1!==o&&(e.splice(o,0,t),n=o+1),e.splice(n++,0,i),null!==s&&e.splice(n++,0,s),null!==r&&e.splice(n++,0,r)}function Ri(e){return-1!==e}function Oi(e){return 32767&e}function Ti(e,t){let i=function(e){return e>>16}(e),s=t;for(;i>0;)s=s[15],i--;return s}let Ii=!0;function bi(e){const t=Ii;return Ii=e,t}let Ci=0;function yi(e,t){const i=Ni(e,t);if(-1!==i)return i;const s=t[1];s.firstCreatePass&&(e.injectorIndex=t.length,Ai(s.data,e),Ai(t,null),Ai(s.blueprint,null));const r=_i(e,t),n=e.injectorIndex;if(Ri(r)){const e=Oi(r),i=Ti(r,t),s=i[1].data;for(let r=0;r<8;r++)t[n+r]=i[e+r]|s[e+r]}return t[n+8]=r,n}function Ai(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Ni(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function _i(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let i=0,s=null,r=t;for(;null!==r;){const e=r[1],t=e.type;if(s=2===t?e.declTNode:1===t?r[6]:null,null===s)return-1;if(i++,r=r[15],-1!==s.injectorIndex)return s.injectorIndex|i<<16}return-1}function wi(e,t,i){!function(e,t,i){let s;"string"==typeof i?s=i.charCodeAt(0)||0:i.hasOwnProperty(Be)&&(s=i[Be]),null==s&&(s=i[Be]=Ci++);const r=255&s;t.data[e+(r>>5)]|=1<<r}(e,t,i)}function Pi(e,t,i){if(i&Oe.Optional)return e;ue(t,"NodeInjector")}function Mi(e,t,i,s){if(i&Oe.Optional&&void 0===s&&(s=null),0==(i&(Oe.Self|Oe.Host))){const r=e[9],n=Ie(void 0);try{return r?r.get(t,s,i&Oe.Optional):be(t,s,i&Oe.Optional)}finally{Ie(n)}}return Pi(s,t,i)}function Li(e,t,i,s=Oe.Default,r){if(null!==e){const n=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Be)?e[Be]:void 0;return"number"==typeof t?t>=0?255&t:xi:t}(i);if("function"==typeof n){if(!Xt(t,e,s))return s&Oe.Host?Pi(r,i,s):Mi(t,i,s,r);try{const e=n(s);if(null!=e||s&Oe.Optional)return e;ue(i)}finally{ii()}}else if("number"==typeof n){let r=null,o=Ni(e,t),a=-1,c=s&Oe.Host?t[16][6]:null;for((-1===o||s&Oe.SkipSelf)&&(a=-1===o?_i(e,t):t[o+8],-1!==a&&Gi(s,!1)?(r=t[1],o=Oi(a),t=Ti(a,t)):o=-1);-1!==o;){const e=t[1];if(Hi(n,o,e.data)){const e=ki(o,t,i,r,s,c);if(e!==Di)return e}a=t[o+8],-1!==a&&Gi(s,t[1].data[o+8]===c)&&Hi(n,o,t)?(r=e,o=Oi(a),t=Ti(a,t)):o=-1}}}return Mi(t,i,s,r)}const Di={};function xi(){return new Bi(xt(),Mt())}function ki(e,t,i,s,r,n){const o=t[1],a=o.data[e+8],c=Fi(a,o,i,null==s?it(a)&&Ii:s!=o&&0!=(3&a.type),r&Oe.Host&&n===a);return null!==c?Ui(t,o,c,a):Di}function Fi(e,t,i,s,r){const n=e.providerIndexes,o=t.data,a=1048575&n,c=e.directiveStart,l=n>>20,u=r?a+l:e.directiveEnd;for(let h=s?a:a+l;h<u;h++){const e=o[h];if(h<c&&i===e||h>=c&&e.type===i)return h}if(r){const e=o[c];if(e&&rt(e)&&e.type===i)return c}return null}function Ui(e,t,i,s){let r=e[i];const n=t.data;if(function(e){return e instanceof pi}(r)){const o=r;o.resolving&&function(e,t){throw new ae("200",`Circular dependency in DI detected for ${e}`)}(le(n[i]));const a=bi(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?Ie(o.injectImpl):null;Xt(e,s,Oe.Default);try{r=e[i]=o.factory(void 0,n,e,s),t.firstCreatePass&&i>=s.directiveStart&&function(e,t,i){const{ngOnChanges:s,ngOnInit:r,ngDoCheck:n}=t.type.prototype;if(s){const s=lt(t);(i.preOrderHooks||(i.preOrderHooks=[])).push(e,s),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,s)}r&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-e,r),n&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,n))}(i,n[i],t)}finally{null!==c&&Ie(c),bi(a),o.resolving=!1,ii()}}return r}function Hi(e,t,i){return!!(i[t+(e>>5)]&1<<e)}function Gi(e,t){return!(e&Oe.Self||e&Oe.Host&&t)}class Bi{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Li(this._tNode,this._lView,e,void 0,t)}}function Wi(e){return Ce(()=>{const t=e.prototype.constructor,i=t[Ge]||Vi(t),s=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==s;){const e=r[Ge]||Vi(r);if(e&&e!==i)return e;r=Object.getPrototypeOf(r)}return e=>new e})}function Vi(e){return oe(e)?()=>{const t=Vi(ne(e));return t&&t()}:ot(e)}function zi(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const i=e.attrs;if(i){const e=i.length;let s=0;for(;s<e;){const r=i[s];if(mi(r))break;if(0===r)s+=2;else if("number"==typeof r)for(s++;s<e&&"string"==typeof i[s];)s++;else{if(r===t)return i[s+1];s+=2}}}return null}(xt(),e)}const Yi="__parameters__";function Ki(e,t,i){return Ce(()=>{const s=function(e){return function(...t){if(e){const i=e(...t);for(const e in i)this[e]=i[e]}}}(t);function r(...e){if(this instanceof r)return s.apply(this,e),this;const t=new r(...e);return i.annotation=t,i;function i(e,i,s){const r=e.hasOwnProperty(Yi)?e[Yi]:Object.defineProperty(e,Yi,{value:[]})[Yi];for(;r.length<=s;)r.push(null);return(r[s]=r[s]||[]).push(t),e}}return i&&(r.prototype=Object.create(i.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}class ji{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=de({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const $i=new ji("AnalyzeForEntryComponents"),Qi=Function;function qi(e,t){void 0===t&&(t=e);for(let i=0;i<e.length;i++){let s=e[i];Array.isArray(s)?(t===e&&(t=e.slice(0,i)),qi(s,t)):t!==e&&t.push(s)}return t}function Xi(e,t){e.forEach(e=>Array.isArray(e)?Xi(e,t):t(e))}function Zi(e,t,i){t>=e.length?e.push(i):e.splice(t,0,i)}function Ji(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function es(e,t){const i=[];for(let s=0;s<e;s++)i.push(t);return i}function ts(e,t,i){let s=ss(e,t);return s>=0?e[1|s]=i:(s=~s,function(e,t,i,s){let r=e.length;if(r==t)e.push(i,s);else if(1===r)e.push(s,e[0]),e[0]=i;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=i,e[t+1]=s}}(e,s,t,i)),s}function is(e,t){const i=ss(e,t);if(i>=0)return e[1|i]}function ss(e,t){return function(e,t,i){let s=0,r=e.length>>i;for(;r!==s;){const n=s+(r-s>>1),o=e[n<<i];if(t===o)return n<<i;o>t?r=n:s=n+1}return~(r<<i)}(e,t,1)}const rs={},ns="__NG_DI_FLAG__",os="ngTempTokenPath",as=/\n/gm,cs="__source",ls=J({provide:String,useValue:J});let us;function hs(e){const t=us;return us=e,t}function ds(e,t=Oe.Default){if(void 0===us)throw new Error("inject() must be called from an injection context");return null===us?be(e,void 0,t):us.get(e,t&Oe.Optional?null:void 0,t)}function gs(e,t=Oe.Default){return(Te||ds)(ne(e),t)}const ps=gs;function fs(e){const t=[];for(let i=0;i<e.length;i++){const s=ne(e[i]);if(Array.isArray(s)){if(0===s.length)throw new Error("Arguments array must have arguments.");let e,i=Oe.Default;for(let t=0;t<s.length;t++){const r=s[t],n=Ss(r);"number"==typeof n?-1===n?e=r.token:i|=n:e=r}t.push(gs(e,i))}else t.push(gs(s))}return t}function ms(e,t){return e[ns]=t,e.prototype[ns]=t,e}function Ss(e){return e[ns]}function Es(e,t,i,s){const r=e[os];throw t[cs]&&r.unshift(t[cs]),e.message=function(e,t,i,s=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let r=te(t);if(Array.isArray(t))r=t.map(te).join(" -> ");else if("object"==typeof t){let e=[];for(let i in t)if(t.hasOwnProperty(i)){let s=t[i];e.push(i+":"+("string"==typeof s?JSON.stringify(s):te(s)))}r=`{${e.join(", ")}}`}return`${i}${s?"("+s+")":""}[${r}]: ${e.replace(as,"\n  ")}`}("\n"+e.message,r,i,s),e.ngTokenPath=r,e[os]=null,e}const vs=ms(Ki("Inject",e=>({token:e})),-1),Rs=ms(Ki("Optional"),8),Os=ms(Ki("SkipSelf"),4);let Ts,Is;function bs(e){var t;return(null===(t=function(){if(void 0===Ts&&(Ts=null,Me.trustedTypes))try{Ts=Me.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(e){}return Ts}())||void 0===t?void 0:t.createHTML(e))||e}function Cs(e){var t;return(null===(t=function(){if(void 0===Is&&(Is=null,Me.trustedTypes))try{Is=Me.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(e){}return Is}())||void 0===t?void 0:t.createHTML(e))||e}class ys{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function As(e){return e instanceof ys?e.changingThisBreaksApplicationSecurity:e}function Ns(e,t){const i=function(e){return e instanceof ys&&e.getTypeName()||null}(e);if(null!=i&&i!==t){if("ResourceURL"===i&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${i} (see https://g.co/ng/security#xss)`)}return i===t}class _s{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(bs(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class ws{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const t=this.inertDocument.createElement("body");e.appendChild(t)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=bs(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=bs(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let s=t.length-1;0<s;s--){const i=t.item(s).name;("xmlns:ns1"===i||0===i.indexOf("ns1:"))&&e.removeAttribute(i)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const Ps=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Ms=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ls(e){return(e=String(e)).match(Ps)||e.match(Ms)?e:"unsafe:"+e}function Ds(e){return(e=String(e)).split(",").map(e=>Ls(e.trim())).join(", ")}function xs(e){const t={};for(const i of e.split(","))t[i]=!0;return t}function ks(...e){const t={};for(const i of e)for(const e in i)i.hasOwnProperty(e)&&(t[e]=!0);return t}const Fs=xs("area,br,col,hr,img,wbr"),Us=xs("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Hs=xs("rp,rt"),Gs=ks(Fs,ks(Us,xs("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ks(Hs,xs("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ks(Hs,Us)),Bs=xs("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ws=xs("srcset"),Vs=ks(Bs,Ws,xs("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),xs("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),zs=xs("script,style,template");class Ys{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!Gs.hasOwnProperty(t))return this.sanitizedSomething=!0,!zs.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let s=0;s<i.length;s++){const e=i.item(s),t=e.name,r=t.toLowerCase();if(!Vs.hasOwnProperty(r)){this.sanitizedSomething=!0;continue}let n=e.value;Bs[r]&&(n=Ls(n)),Ws[r]&&(n=Ds(n)),this.buf.push(" ",t,'="',$s(n),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();Gs.hasOwnProperty(t)&&!Fs.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push($s(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Ks=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,js=/([^\#-~ |!])/g;function $s(e){return e.replace(/&/g,"&amp;").replace(Ks,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(js,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Qs;function qs(e,t){let i=null;try{Qs=Qs||function(e){const t=new ws(e);return function(){try{return!!(new window.DOMParser).parseFromString(bs(""),"text/html")}catch(e){return!1}}()?new _s(t):t}(e);let s=t?String(t):"";i=Qs.getInertBodyElement(s);let r=5,n=s;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,s=n,n=i.innerHTML,i=Qs.getInertBodyElement(s)}while(s!==n);return bs((new Ys).sanitizeChildren(Xs(i)||i))}finally{if(i){const e=Xs(i)||i;for(;e.firstChild;)e.removeChild(e.firstChild)}}}function Xs(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var Zs=(()=>((Zs=Zs||{})[Zs.NONE=0]="NONE",Zs[Zs.HTML=1]="HTML",Zs[Zs.STYLE=2]="STYLE",Zs[Zs.SCRIPT=3]="SCRIPT",Zs[Zs.URL=4]="URL",Zs[Zs.RESOURCE_URL=5]="RESOURCE_URL",Zs))();function Js(e){const t=tr();return t?Cs(t.sanitize(Zs.HTML,e)||""):Ns(e,"HTML")?Cs(As(e)):qs(mt(),ce(e))}function er(e){const t=tr();return t?t.sanitize(Zs.URL,e)||"":Ns(e,"URL")?As(e):Ls(ce(e))}function tr(){const e=Mt();return e&&e[12]}const ir="__ngContext__";function sr(e,t){e[ir]=t}function rr(e){const t=function(e){return e[ir]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function nr(e){return e.ngOriginalError}function or(e,...t){e.error(...t)}class ar{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),s=function(e){return e&&e.ngErrorLogger||or}(e);s(this._console,"ERROR",e),t&&s(this._console,"ORIGINAL ERROR",t),i&&s(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(e){return e.ngDebugContext}(e)||this._findContext(nr(e)):null}_findOriginalError(e){let t=e&&nr(e);for(;t&&nr(t);)t=nr(t);return t||null}}const cr=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Me))();function lr(e){return e.ownerDocument.defaultView}function ur(e){return e.ownerDocument}function hr(e){return e instanceof Function?e():e}var dr=(()=>((dr=dr||{})[dr.Important=1]="Important",dr[dr.DashCase=2]="DashCase",dr))();function gr(e,t){return undefined(e,t)}function pr(e){const t=e[3];return et(t)?t[3]:t}function fr(e){return Sr(e[13])}function mr(e){return Sr(e[4])}function Sr(e){for(;null!==e&&!et(e);)e=e[4];return e}function Er(e,t,i,s,r){if(null!=s){let n,o=!1;et(s)?n=s:Je(s)&&(o=!0,s=s[0]);const a=vt(s);0===e&&null!==i?null==r?yr(t,i,a):Cr(t,i,a,r||null,!0):1===e&&null!==i?Cr(t,i,a,r||null,!0):2===e?function(e,t,i){const s=Nr(e,t);s&&function(e,t,i,s){St(e)?e.removeChild(t,i,s):t.removeChild(i)}(e,s,t,i)}(t,a,o):3===e&&t.destroyNode(a),null!=n&&function(e,t,i,s,r){const n=i[7];n!==vt(i)&&Er(t,e,s,n,r);for(let o=10;o<i.length;o++){const r=i[o];kr(r[1],r,e,t,s,n)}}(t,e,n,i,r)}}function vr(e,t,i){return St(e)?e.createElement(t,i):null===i?e.createElement(t):e.createElementNS(i,t)}function Rr(e,t){const i=e[9],s=i.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,_t(r,-1)),i.splice(s,1)}function Or(e,t){if(e.length<=10)return;const i=10+t,s=e[i];if(s){const r=s[17];null!==r&&r!==e&&Rr(r,s),t>0&&(e[i-1][4]=s[4]);const n=Ji(e,10+t);!function(e,t){kr(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(s[1],s);const o=n[19];null!==o&&o.detachView(n[1]),s[3]=null,s[4]=null,s[2]&=-129}return s}function Tr(e,t){if(!(256&t[2])){const i=t[11];St(i)&&i.destroyNode&&kr(e,t,i,3,null,null),function(e){let t=e[13];if(!t)return Ir(e[1],e);for(;t;){let i=null;if(Je(t))i=t[13];else{const e=t[10];e&&(i=e)}if(!i){for(;t&&!t[4]&&t!==e;)Je(t)&&Ir(t[1],t),t=t[3];null===t&&(t=e),Je(t)&&Ir(t[1],t),i=t&&t[4]}t=i}}(t)}}function Ir(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let i;if(null!=e&&null!=(i=e.destroyHooks))for(let s=0;s<i.length;s+=2){const e=t[i[s]];if(!(e instanceof pi)){const t=i[s+1];if(Array.isArray(t))for(let i=0;i<t.length;i+=2){const s=e[t[i]],r=t[i+1];try{r.call(s)}finally{}}else try{t.call(e)}finally{}}}}(e,t),function(e,t){const i=e.cleanup,s=t[7];let r=-1;if(null!==i)for(let n=0;n<i.length-1;n+=2)if("string"==typeof i[n]){const e=i[n+1],o="function"==typeof e?e(t):vt(t[e]),a=s[r=i[n+2]],c=i[n+3];"boolean"==typeof c?o.removeEventListener(i[n],a,c):c>=0?s[r=c]():s[r=-c].unsubscribe(),n+=2}else{const e=s[r=i[n+1]];i[n].call(e)}if(null!==s){for(let e=r+1;e<s.length;e++)s[e]();t[7]=null}}(e,t),1===t[1].type&&St(t[11])&&t[11].destroy();const i=t[17];if(null!==i&&et(t[3])){i!==t[3]&&Rr(i,t);const s=t[19];null!==s&&s.detachView(e)}}}function br(e,t,i){return function(e,t,i){let s=t;for(;null!==s&&40&s.type;)s=(t=s).parent;if(null===s)return i[0];if(2&s.flags){const t=e.data[s.directiveStart].encapsulation;if(t===Ae.None||t===Ae.Emulated)return null}return Ot(s,i)}(e,t.parent,i)}function Cr(e,t,i,s,r){St(e)?e.insertBefore(t,i,s,r):t.insertBefore(i,s,r)}function yr(e,t,i){St(e)?e.appendChild(t,i):t.appendChild(i)}function Ar(e,t,i,s,r){null!==s?Cr(e,t,i,s,r):yr(e,t,i)}function Nr(e,t){return St(e)?e.parentNode(t):t.parentNode}function _r(e,t,i){return wr(e,t,i)}let wr=function(e,t,i){return 40&e.type?Ot(e,i):null};function Pr(e,t,i,s){const r=br(e,s,t),n=t[11],o=_r(s.parent||t[6],s,t);if(null!=r)if(Array.isArray(i))for(let a=0;a<i.length;a++)Ar(n,r,i[a],o,!1);else Ar(n,r,i,o,!1)}function Mr(e,t){if(null!==t){const i=t.type;if(3&i)return Ot(t,e);if(4&i)return Dr(-1,e[t.index]);if(8&i){const i=t.child;if(null!==i)return Mr(e,i);{const i=e[t.index];return et(i)?Dr(-1,i):vt(i)}}if(32&i)return gr(t,e)()||vt(e[t.index]);{const i=Lr(e,t);return null!==i?Array.isArray(i)?i[0]:Mr(pr(e[16]),i):Mr(e,t.next)}}return null}function Lr(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Dr(e,t){const i=10+e+1;if(i<t.length){const e=t[i],s=e[1].firstChild;if(null!==s)return Mr(e,s)}return t[7]}function xr(e,t,i,s,r,n,o){for(;null!=i;){const a=s[i.index],c=i.type;if(o&&0===t&&(a&&sr(vt(a),s),i.flags|=4),64!=(64&i.flags))if(8&c)xr(e,t,i.child,s,r,n,!1),Er(t,e,r,a,n);else if(32&c){const o=gr(i,s);let c;for(;c=o();)Er(t,e,r,c,n);Er(t,e,r,a,n)}else 16&c?Fr(e,t,s,i,r,n):Er(t,e,r,a,n);i=o?i.projectionNext:i.next}}function kr(e,t,i,s,r,n){xr(i,s,e.firstChild,t,r,n,!1)}function Fr(e,t,i,s,r,n){const o=i[16],a=o[6].projection[s.projection];if(Array.isArray(a))for(let c=0;c<a.length;c++)Er(t,e,r,a[c],n);else xr(e,t,a,o[3],r,n,!0)}function Ur(e,t,i){St(e)?e.setAttribute(t,"style",i):t.style.cssText=i}function Hr(e,t,i){St(e)?""===i?e.removeAttribute(t,"class"):e.setAttribute(t,"class",i):t.className=i}function Gr(e,t,i){let s=e.length;for(;;){const r=e.indexOf(t,i);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const i=t.length;if(r+i===s||e.charCodeAt(r+i)<=32)return r}i=r+1}}const Br="ng-template";function Wr(e,t,i){let s=0;for(;s<e.length;){let r=e[s++];if(i&&"class"===r){if(r=e[s],-1!==Gr(r.toLowerCase(),t,0))return!0}else if(1===r){for(;s<e.length&&"string"==typeof(r=e[s++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function Vr(e){return 4===e.type&&e.value!==Br}function zr(e,t,i){return t===(4!==e.type||i?e.value:Br)}function Yr(e,t,i){let s=4;const r=e.attrs||[],n=function(e){for(let t=0;t<e.length;t++)if(mi(e[t]))return t;return e.length}(r);let o=!1;for(let a=0;a<t.length;a++){const c=t[a];if("number"!=typeof c){if(!o)if(4&s){if(s=2|1&s,""!==c&&!zr(e,c,i)||""===c&&1===t.length){if(Kr(s))return!1;o=!0}}else{const l=8&s?c:t[++a];if(8&s&&null!==e.attrs){if(!Wr(e.attrs,l,i)){if(Kr(s))return!1;o=!0}continue}const u=jr(8&s?"class":c,r,Vr(e),i);if(-1===u){if(Kr(s))return!1;o=!0;continue}if(""!==l){let e;e=u>n?"":r[u+1].toLowerCase();const t=8&s?e:null;if(t&&-1!==Gr(t,l,0)||2&s&&l!==e){if(Kr(s))return!1;o=!0}}}}else{if(!o&&!Kr(s)&&!Kr(c))return!1;if(o&&Kr(c))continue;o=!1,s=c|1&s}}return Kr(s)||o}function Kr(e){return 0==(1&e)}function jr(e,t,i,s){if(null===t)return-1;let r=0;if(s||!i){let i=!1;for(;r<t.length;){const s=t[r];if(s===e)return r;if(3===s||6===s)i=!0;else{if(1===s||2===s){let e=t[++r];for(;"string"==typeof e;)e=t[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=i?1:2}return-1}return function(e,t){let i=e.indexOf(4);if(i>-1)for(i++;i<e.length;){const s=e[i];if("number"==typeof s)return-1;if(s===t)return i;i++}return-1}(t,e)}function $r(e,t,i=!1){for(let s=0;s<t.length;s++)if(Yr(e,t[s],i))return!0;return!1}function Qr(e,t){e:for(let i=0;i<t.length;i++){const s=t[i];if(e.length===s.length){for(let t=0;t<e.length;t++)if(e[t]!==s[t])continue e;return!0}}return!1}function qr(e,t){return e?":not("+t.trim()+")":t}function Xr(e){let t=e[0],i=1,s=2,r="",n=!1;for(;i<e.length;){let o=e[i];if("string"==typeof o)if(2&s){const t=e[++i];r+="["+o+(t.length>0?'="'+t+'"':"")+"]"}else 8&s?r+="."+o:4&s&&(r+=" "+o);else""!==r&&!Kr(o)&&(t+=qr(n,r),r=""),s=o,n=n||!Kr(s);i++}return""!==r&&(t+=qr(n,r)),t}const Zr={};function Jr(e){en(Lt(),Mt(),ri()+e,Gt())}function en(e,t,i,s){if(!s)if(3==(3&t[2])){const s=e.preOrderCheckHooks;null!==s&&li(t,s,i)}else{const s=e.preOrderHooks;null!==s&&ui(t,s,0,i)}ni(i)}function tn(e,t){return e<<17|t<<2}function sn(e){return e>>17&32767}function rn(e){return 2|e}function nn(e){return(131068&e)>>2}function on(e,t){return-131069&e|t<<2}function an(e){return 1|e}function cn(e,t){const i=e.contentQueries;if(null!==i)for(let s=0;s<i.length;s+=2){const r=i[s],n=i[s+1];if(-1!==n){const i=e.data[n];Qt(r),i.contentQueries(2,t[n],n)}}}function ln(e,t,i,s,r,n,o,a,c,l){const u=t.blueprint.slice();return u[0]=r,u[2]=140|s,Nt(u),u[3]=u[15]=e,u[8]=i,u[10]=o||e&&e[10],u[11]=a||e&&e[11],u[12]=c||e&&e[12]||null,u[9]=l||e&&e[9]||null,u[6]=n,u[16]=2==t.type?e[16]:u,u}function un(e,t,i,s,r){let n=e.data[t];if(null===n)n=function(e,t,i,s,r){const n=kt(),o=Ut(),a=e.data[t]=function(e,t,i,s,r,n){return{type:i,index:s,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:n,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?n:n&&n.parent,i,t,s,r);return null===e.firstChild&&(e.firstChild=a),null!==n&&(o?null==n.child&&null!==a.parent&&(n.child=a):null===n.next&&(n.next=a)),a}(e,t,i,s,r),wt.lFrame.inI18n&&(n.flags|=64);else if(64&n.type){n.type=i,n.value=s,n.attrs=r;const e=function(){const e=wt.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();n.injectorIndex=null===e?-1:e.injectorIndex}return Ft(n,!0),n}function hn(e,t,i,s){if(0===i)return-1;const r=t.length;for(let n=0;n<i;n++)t.push(s),e.blueprint.push(s),e.data.push(null);return r}function dn(e,t,i){Zt(t);try{const s=e.viewQuery;null!==s&&Vn(1,s,i);const r=e.template;null!==r&&fn(e,t,r,1,i),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&cn(e,t),e.staticViewQueries&&Vn(2,e.viewQuery,i);const n=e.components;null!==n&&function(e,t){for(let i=0;i<t.length;i++)Un(e,t[i])}(t,n)}catch(s){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),s}finally{t[2]&=-5,si()}}function gn(e,t,i,s){const r=t[2];if(256==(256&r))return;Zt(t);const n=Gt();try{Nt(t),function(e){wt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==i&&fn(e,t,i,2,s);const o=3==(3&r);if(!n)if(o){const i=e.preOrderCheckHooks;null!==i&&li(t,i,null)}else{const i=e.preOrderHooks;null!==i&&ui(t,i,0,null),hi(t,0)}if(function(e){for(let t=fr(e);null!==t;t=mr(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const i=e[t],s=i[3];0==(1024&i[2])&&_t(s,1),i[2]|=1024}}}(t),function(e){for(let t=fr(e);null!==t;t=mr(t))for(let e=10;e<t.length;e++){const i=t[e],s=i[1];yt(i)&&gn(s,i,s.template,i[8])}}(t),null!==e.contentQueries&&cn(e,t),!n)if(o){const i=e.contentCheckHooks;null!==i&&li(t,i)}else{const i=e.contentHooks;null!==i&&ui(t,i,1),hi(t,1)}!function(e,t){const i=e.hostBindingOpCodes;if(null!==i)try{for(let e=0;e<i.length;e++){const s=i[e];if(s<0)ni(~s);else{const r=s,n=i[++e],o=i[++e];Kt(n,r),o(2,t[r])}}}finally{ni(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let i=0;i<t.length;i++)kn(e,t[i])}(t,a);const c=e.viewQuery;if(null!==c&&Vn(2,c,s),!n)if(o){const i=e.viewCheckHooks;null!==i&&li(t,i)}else{const i=e.viewHooks;null!==i&&ui(t,i,2),hi(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,_t(t[3],-1))}finally{si()}}function pn(e,t,i,s){const r=t[10],n=!Gt(),o=Ct(t);try{n&&!o&&r.begin&&r.begin(),o&&dn(e,t,s),gn(e,t,i,s)}finally{n&&!o&&r.end&&r.end()}}function fn(e,t,i,s,r){const n=ri(),o=2&s;try{ni(-1),o&&t.length>20&&en(e,t,20,Gt()),i(s,r)}finally{ni(n)}}function mn(e,t,i){if(tt(t)){const s=t.directiveEnd;for(let r=t.directiveStart;r<s;r++){const t=e.data[r];t.contentQueries&&t.contentQueries(1,i[r],r)}}}function Sn(e,t,i){!Pt()||(function(e,t,i,s){const r=i.directiveStart,n=i.directiveEnd;e.firstCreatePass||yi(i,t),sr(s,t);const o=i.initialInputs;for(let a=r;a<n;a++){const s=e.data[a],n=rt(s);n&&Pn(t,i,s);const c=Ui(t,e,a,i);sr(c,t),null!==o&&Ln(0,a-r,c,s,0,o),n&&(bt(i.index,t)[8]=c)}}(e,t,i,Ot(i,t)),128==(128&i.flags)&&function(e,t,i){const s=i.directiveStart,r=i.directiveEnd,n=i.index,o=wt.lFrame.currentDirectiveIndex;try{ni(n);for(let i=s;i<r;i++){const s=e.data[i],r=t[i];jt(i),(null!==s.hostBindings||0!==s.hostVars||null!==s.hostAttrs)&&yn(s,r)}}finally{ni(-1),jt(o)}}(e,t,i))}function En(e,t,i=Ot){const s=t.localNames;if(null!==s){let r=t.index+1;for(let n=0;n<s.length;n+=2){const o=s[n+1],a=-1===o?i(t,e):e[o];e[r++]=a}}}function vn(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Rn(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Rn(e,t,i,s,r,n,o,a,c,l){const u=20+s,h=u+r,d=function(e,t){const i=[];for(let s=0;s<t;s++)i.push(s<e?null:Zr);return i}(u,h),g="function"==typeof l?l():l;return d[1]={type:e,blueprint:d,template:i,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof n?n():n,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:g,incompleteFirstPass:!1}}function On(e,t,i,s){const r=Yn(t);null===i?r.push(s):(r.push(i),e.firstCreatePass&&Kn(e).push(s,r.length-1))}function Tn(e,t,i){for(let s in e)if(e.hasOwnProperty(s)){const r=e[s];(i=null===i?{}:i).hasOwnProperty(s)?i[s].push(t,r):i[s]=[t,r]}return i}function In(e,t,i,s,r,n,o,a){const c=Ot(t,i);let l,u=t.inputs;!a&&null!=u&&(l=u[s])?($n(e,i,l,s,r),it(t)&&function(e,t){const i=bt(t,e);16&i[2]||(i[2]|=64)}(i,t.index)):3&t.type&&(s=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(s),r=null!=o?o(r,t.value||"",s):r,St(n)?n.setProperty(c,s,r):Si(s)||(c.setProperty?c.setProperty(s,r):c[s]=r))}function bn(e,t,i,s){let r=!1;if(Pt()){const n=function(e,t,i){const s=e.directiveRegistry;let r=null;if(s)for(let n=0;n<s.length;n++){const o=s[n];$r(i,o.selectors,!1)&&(r||(r=[]),wi(yi(i,t),e,o.type),rt(o)?(An(e,i),r.unshift(o)):r.push(o))}return r}(e,t,i),o=null===s?null:{"":-1};if(null!==n){r=!0,_n(i,e.data.length,n.length);for(let e=0;e<n.length;e++){const t=n[e];t.providersResolver&&t.providersResolver(t)}let s=!1,a=!1,c=hn(e,t,n.length,null);for(let r=0;r<n.length;r++){const l=n[r];i.mergedAttrs=Ei(i.mergedAttrs,l.hostAttrs),wn(e,i,t,c,l),Nn(c,l,o),null!==l.contentQueries&&(i.flags|=8),(null!==l.hostBindings||null!==l.hostAttrs||0!==l.hostVars)&&(i.flags|=128);const u=l.type.prototype;!s&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(i.index),s=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i.index),a=!0),c++}!function(e,t){const i=t.directiveEnd,s=e.data,r=t.attrs,n=[];let o=null,a=null;for(let c=t.directiveStart;c<i;c++){const e=s[c],i=e.inputs,l=null===r||Vr(t)?null:Dn(i,r);n.push(l),o=Tn(i,c,o),a=Tn(e.outputs,c,a)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=n,t.inputs=o,t.outputs=a}(e,i)}o&&function(e,t,i){if(t){const s=e.localNames=[];for(let e=0;e<t.length;e+=2){const r=i[t[e+1]];if(null==r)throw new ae("301",`Export of name '${t[e+1]}' not found!`);s.push(t[e],r)}}}(i,s,o)}return i.mergedAttrs=Ei(i.mergedAttrs,i.attrs),r}function Cn(e,t,i,s,r,n){const o=n.hostBindings;if(o){let i=e.hostBindingOpCodes;null===i&&(i=e.hostBindingOpCodes=[]);const n=~t.index;(function(e){let t=e.length;for(;t>0;){const i=e[--t];if("number"==typeof i&&i<0)return i}return 0})(i)!=n&&i.push(n),i.push(s,r,o)}}function yn(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function An(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Nn(e,t,i){if(i){if(t.exportAs)for(let s=0;s<t.exportAs.length;s++)i[t.exportAs[s]]=e;rt(t)&&(i[""]=e)}}function _n(e,t,i){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+i,e.providerIndexes=t}function wn(e,t,i,s,r){e.data[s]=r;const n=r.factory||(r.factory=ot(r.type)),o=new pi(n,rt(r),null);e.blueprint[s]=o,i[s]=o,Cn(e,t,0,s,hn(e,i,r.hostVars,Zr),r)}function Pn(e,t,i){const s=Ot(t,e),r=vn(i),n=e[10],o=Hn(e,ln(e,r,null,i.onPush?64:16,s,t,n,n.createRenderer(s,i),null,null));e[t.index]=o}function Mn(e,t,i,s,r,n){const o=Ot(e,t);!function(e,t,i,s,r,n,o){if(null==n)St(e)?e.removeAttribute(t,r,i):t.removeAttribute(r);else{const a=null==o?ce(n):o(n,s||"",r);St(e)?e.setAttribute(t,r,a,i):i?t.setAttributeNS(i,r,a):t.setAttribute(r,a)}}(t[11],o,n,e.value,i,s,r)}function Ln(e,t,i,s,r,n){const o=n[t];if(null!==o){const e=s.setInput;for(let t=0;t<o.length;){const r=o[t++],n=o[t++],a=o[t++];null!==e?s.setInput(i,a,r,n):i[n]=a}}}function Dn(e,t){let i=null,s=0;for(;s<t.length;){const r=t[s];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===i&&(i=[]),i.push(r,e[r],t[s+1])),s+=2}else s+=2;else s+=4}return i}function xn(e,t,i,s){return new Array(e,!0,!1,t,null,0,s,i,null,null)}function kn(e,t){const i=bt(t,e);if(yt(i)){const e=i[1];80&i[2]?gn(e,i,e.template,i[8]):i[5]>0&&Fn(i)}}function Fn(e){for(let i=fr(e);null!==i;i=mr(i))for(let e=10;e<i.length;e++){const t=i[e];if(1024&t[2]){const e=t[1];gn(e,t,e.template,t[8])}else t[5]>0&&Fn(t)}const t=e[1].components;if(null!==t)for(let i=0;i<t.length;i++){const s=bt(t[i],e);yt(s)&&s[5]>0&&Fn(s)}}function Un(e,t){const i=bt(t,e),s=i[1];(function(e,t){for(let i=t.length;i<e.blueprint.length;i++)t.push(e.blueprint[i])})(s,i),dn(s,i,i[8])}function Hn(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Gn(e){for(;e;){e[2]|=64;const t=pr(e);if(nt(e)&&!t)return e;e=t}return null}function Bn(e,t,i){const s=t[10];s.begin&&s.begin();try{gn(e,t,e.template,i)}catch(r){throw jn(t,r),r}finally{s.end&&s.end()}}function Wn(e){!function(e){for(let t=0;t<e.components.length;t++){const i=e.components[t],s=rr(i),r=s[1];pn(r,s,r.template,i)}}(e[8])}function Vn(e,t,i){Qt(0),t(e,i)}const zn=(()=>Promise.resolve(null))();function Yn(e){return e[7]||(e[7]=[])}function Kn(e){return e.cleanup||(e.cleanup=[])}function jn(e,t){const i=e[9],s=i?i.get(ar,null):null;s&&s.handleError(t)}function $n(e,t,i,s,r){for(let n=0;n<i.length;){const o=i[n++],a=i[n++],c=t[o],l=e.data[o];null!==l.setInput?l.setInput(c,r,s,a):c[a]=r}}function Qn(e,t,i){const s=Rt(t,e);!function(e,t,i){St(e)?e.setValue(t,i):t.textContent=i}(e[11],s,i)}function qn(e,t,i){let s=i?e.styles:null,r=i?e.classes:null,n=0;if(null!==t)for(let o=0;o<t.length;o++){const e=t[o];"number"==typeof e?n=e:1==n?r=ie(r,e):2==n&&(s=ie(s,e+": "+t[++o]+";"))}i?e.styles=s:e.stylesWithoutHost=s,i?e.classes=r:e.classesWithoutHost=r}const Xn=new ji("INJECTOR",-1);class Zn{get(e,t=rs){if(t===rs){const t=new Error(`NullInjectorError: No provider for ${te(e)}!`);throw t.name="NullInjectorError",t}return t}}const Jn=new ji("Set Injector scope."),eo={},to={};let io;function so(){return void 0===io&&(io=new Zn),io}function ro(e,t=null,i=null,s){return new no(e,i,t||so(),s)}class no{constructor(e,t,i,s=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];t&&Xi(t,i=>this.processProvider(i,e,t)),Xi([e],e=>this.processInjectorType(e,[],r)),this.records.set(Xn,co(void 0,this));const n=this.records.get(Jn);this.scope=null!=n?n.value:null,this.source=s||("object"==typeof e?null:te(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=rs,i=Oe.Default){this.assertNotDestroyed();const s=hs(this),r=Ie(void 0);try{if(!(i&Oe.SkipSelf)){let t=this.records.get(e);if(void 0===t){const i=function(e){return"function"==typeof e||"object"==typeof e&&e instanceof ji}(e)&&pe(e);t=i&&this.injectableDefInScope(i)?co(oo(e),eo):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(i&Oe.Self?so():this.parent).get(e,t=i&Oe.Optional&&t===rs?null:t)}catch(n){if("NullInjectorError"===n.name){if((n[os]=n[os]||[]).unshift(te(e)),s)throw n;return Es(n,e,"R3InjectorError",this.source)}throw n}finally{Ie(r),hs(s)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,i)=>e.push(te(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=ne(e)))return!1;let s=me(e);const r=null==s&&e.ngModule||void 0,n=void 0===r?e:r,o=-1!==i.indexOf(n);if(void 0!==r&&(s=me(r)),null==s)return!1;if(null!=s.imports&&!o){let e;i.push(n);try{Xi(s.imports,s=>{this.processInjectorType(s,t,i)&&(void 0===e&&(e=[]),e.push(s))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:i,providers:s}=e[t];Xi(s,e=>this.processProvider(e,i,s||De))}}this.injectorDefTypes.add(n);const a=ot(n)||(()=>new n);this.records.set(n,co(a,eo));const c=s.providers;if(null!=c&&!o){const t=e;Xi(c,e=>this.processProvider(e,t,c))}return void 0!==r&&void 0!==e.providers}processProvider(e,t,i){let s=uo(e=ne(e))?e:ne(e&&e.provide);const r=function(e,t,i){return lo(e)?co(void 0,e.useValue):co(ao(e),eo)}(e);if(uo(e)||!0!==e.multi)this.records.get(s);else{let t=this.records.get(s);t||(t=co(void 0,eo,!0),t.factory=()=>fs(t.multi),this.records.set(s,t)),s=e,t.multi.push(e)}this.records.set(s,r)}hydrate(e,t){return t.value===eo&&(t.value=to,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ne(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function oo(e){const t=pe(e),i=null!==t?t.factory:ot(e);if(null!==i)return i;if(e instanceof ji)throw new Error(`Token ${te(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const i=es(t,"?");throw new Error(`Can't resolve all parameters for ${te(e)}: (${i.join(", ")}).`)}const i=function(e){const t=e&&(e[Se]||e[ve]);if(t){const i=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),t}return null}(e);return null!==i?()=>i.factory(e):()=>new e}(e);throw new Error("unreachable")}function ao(e,t,i){let s;if(uo(e)){const t=ne(e);return ot(t)||oo(t)}if(lo(e))s=()=>ne(e.useValue);else if(function(e){return!(!e||!e.useFactory)}(e))s=()=>e.useFactory(...fs(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))s=()=>gs(ne(e.useExisting));else{const t=ne(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return ot(t)||oo(t);s=()=>new t(...fs(e.deps))}return s}function co(e,t,i=!1){return{factory:e,value:t,multi:i?[]:void 0}}function lo(e){return null!==e&&"object"==typeof e&&ls in e}function uo(e){return"function"==typeof e}const ho=function(e,t,i){return function(e,t=null,i=null,s){const r=ro(e,t,i,s);return r._resolveInjectorDefTypes(),r}({name:i},t,e,i)};class go{static create(e,t){return Array.isArray(e)?ho(e,t,""):ho(e.providers,e.parent,e.name||"")}}function po(e,t){ci(rr(e)[1],xt())}function fo(e){let t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),i=!0;const s=[e];for(;t;){let r;if(rt(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");r=t.\u0275dir}if(r){if(i){s.push(r);const t=e;t.inputs=mo(e.inputs),t.declaredInputs=mo(e.declaredInputs),t.outputs=mo(e.outputs);const i=r.hostBindings;i&&vo(e,i);const n=r.viewQuery,o=r.contentQueries;if(n&&So(e,n),o&&Eo(e,o),ee(e.inputs,r.inputs),ee(e.declaredInputs,r.declaredInputs),ee(e.outputs,r.outputs),rt(r)&&r.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(r.data.animation)}}const t=r.features;if(t)for(let s=0;s<t.length;s++){const r=t[s];r&&r.ngInherit&&r(e),r===fo&&(i=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,i=null;for(let s=e.length-1;s>=0;s--){const r=e[s];r.hostVars=t+=r.hostVars,r.hostAttrs=Ei(r.hostAttrs,i=Ei(i,r.hostAttrs))}}(s)}function mo(e){return e===Le?{}:e===De?[]:e}function So(e,t){const i=e.viewQuery;e.viewQuery=i?(e,s)=>{t(e,s),i(e,s)}:t}function Eo(e,t){const i=e.contentQueries;e.contentQueries=i?(e,s,r)=>{t(e,s,r),i(e,s,r)}:t}function vo(e,t){const i=e.hostBindings;e.hostBindings=i?(e,s)=>{t(e,s),i(e,s)}:t}go.THROW_IF_NOT_FOUND=rs,go.NULL=new Zn,go.\u0275prov=de({token:go,providedIn:"any",factory:()=>gs(Xn)}),go.__NG_ELEMENT_ID__=-1;let Ro=null;function Oo(){if(!Ro){const e=Me.Symbol;if(e&&e.iterator)Ro=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Ro=i)}}}return Ro}class To{constructor(e){this.wrapped=e}static wrap(e){return new To(e)}static unwrap(e){return To.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof To}}function Io(e){return!!bo(e)&&(Array.isArray(e)||!(e instanceof Map)&&Oo()in e)}function bo(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Co(e,t,i){return e[t]=i}function yo(e,t,i){return!Object.is(e[t],i)&&(e[t]=i,!0)}function Ao(e,t,i,s){const r=yo(e,t,i);return yo(e,t+1,s)||r}function No(e,t,i,s){const r=Mt();return yo(r,zt(),t)&&(Lt(),Mn(oi(),r,e,t,i,s)),No}function _o(e,t,i,s){return yo(e,zt(),i)?t+ce(i)+s:Zr}function wo(e,t,i,s,r,n,o,a){const c=function(e,t,i,s,r){const n=Ao(e,t,i,s);return yo(e,t+2,r)||n}(e,Vt(),i,r,o);return Yt(3),c?t+ce(i)+s+ce(r)+n+ce(o)+a:Zr}function Po(e,t,i,s,r,n,o,a){const c=Mt(),l=Lt(),u=e+20,h=l.firstCreatePass?function(e,t,i,s,r,n,o,a,c){const l=t.consts,u=un(t,e,4,o||null,At(l,a));bn(t,i,u,At(l,c)),ci(t,u);const h=u.tViews=Rn(2,u,s,r,n,t.directiveRegistry,t.pipeRegistry,null,t.schemas,l);return null!==t.queries&&(t.queries.template(t,u),h.queries=t.queries.embeddedTView(u)),u}(u,l,c,t,i,s,r,n,o):l.data[u];Ft(h,!1);const d=c[11].createComment("");Pr(l,c,d,h),sr(d,c),Hn(c,c[u]=xn(d,c,d,h)),st(h)&&Sn(l,c,h),null!=o&&En(c,h,a)}function Mo(e,t=Oe.Default){const i=Mt();return null===i?gs(e,t):Li(xt(),i,ne(e),t)}function Lo(e,t,i){const s=Mt();return yo(s,zt(),t)&&In(Lt(),oi(),s,e,t,s[11],i,!1),Lo}function Do(e,t,i,s,r){const n=r?"class":"style";$n(e,i,t.inputs[n],n,s)}function xo(e,t,i,s){const r=Mt(),n=Lt(),o=20+e,a=r[11],c=r[o]=vr(a,t,wt.lFrame.currentNamespace),l=n.firstCreatePass?function(e,t,i,s,r,n,o){const a=t.consts,c=un(t,e,2,r,At(a,n));return bn(t,i,c,At(a,o)),null!==c.attrs&&qn(c,c.attrs,!1),null!==c.mergedAttrs&&qn(c,c.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,c),c}(o,n,r,0,t,i,s):n.data[o];Ft(l,!0);const u=l.mergedAttrs;null!==u&&fi(a,c,u);const h=l.classes;null!==h&&Hr(a,c,h);const d=l.styles;null!==d&&Ur(a,c,d),64!=(64&l.flags)&&Pr(n,r,c,l),0===wt.lFrame.elementDepthCount&&sr(c,r),wt.lFrame.elementDepthCount++,st(l)&&(Sn(n,r,l),mn(n,l,r)),null!==s&&En(r,l)}function ko(){let e=xt();Ut()?Ht():(e=e.parent,Ft(e,!1));const t=e;wt.lFrame.elementDepthCount--;const i=Lt();i.firstCreatePass&&(ci(i,e),tt(e)&&i.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Do(i,t,Mt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Do(i,t,Mt(),t.stylesWithoutHost,!1)}function Fo(e,t,i,s){xo(e,t,i,s),ko()}function Uo(e,t,i){const s=Mt(),r=Lt(),n=e+20,o=r.firstCreatePass?function(e,t,i,s,r){const n=t.consts,o=At(n,s),a=un(t,e,8,"ng-container",o);return null!==o&&qn(a,o,!0),bn(t,i,a,At(n,r)),null!==t.queries&&t.queries.elementStart(t,a),a}(n,r,s,t,i):r.data[n];Ft(o,!0);const a=s[n]=s[11].createComment("");Pr(r,s,a,o),sr(a,s),st(o)&&(Sn(r,s,o),mn(r,o,s)),null!=i&&En(s,o)}function Ho(){let e=xt();const t=Lt();Ut()?Ht():(e=e.parent,Ft(e,!1)),t.firstCreatePass&&(ci(t,e),tt(e)&&t.queries.elementEnd(e))}function Go(){return Mt()}function Bo(e){return!!e&&"function"==typeof e.then}const Wo=function(e){return!!e&&"function"==typeof e.subscribe};function Vo(e,t,i,s){const r=Mt(),n=Lt(),o=xt();return function(e,t,i,s,r,n,o,a){const c=st(s),l=e.firstCreatePass&&Kn(e),u=t[8],h=Yn(t);let d=!0;if(3&s.type||a){const g=Ot(s,t),p=a?a(g):g,f=h.length,m=a?e=>a(vt(e[s.index])):s.index;if(St(i)){let o=null;if(!a&&c&&(o=function(e,t,i,s){const r=e.cleanup;if(null!=r)for(let n=0;n<r.length-1;n+=2){const e=r[n];if(e===i&&r[n+1]===s){const e=t[7],i=r[n+2];return e.length>i?e[i]:null}"string"==typeof e&&(n+=2)}return null}(e,t,r,s.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=n,o.__ngLastListenerFn__=n,d=!1;else{n=Yo(s,t,u,n,!1);const e=i.listen(p,r,n);h.push(n,e),l&&l.push(r,m,f,f+1)}}else n=Yo(s,t,u,n,!0),p.addEventListener(r,n,o),h.push(n),l&&l.push(r,m,f,o)}else n=Yo(s,t,u,n,!1);const g=s.outputs;let p;if(d&&null!==g&&(p=g[r])){const e=p.length;if(e)for(let i=0;i<e;i+=2){const e=t[p[i]][p[i+1]].subscribe(n),o=h.length;h.push(n,e),l&&l.push(r,s.index,o,-(o+1))}}}(n,r,r[11],o,e,t,!!i,s),Vo}function zo(e,t,i,s){try{return!1!==i(s)}catch(r){return jn(e,r),!1}}function Yo(e,t,i,s,r){return function i(n){if(n===Function)return s;const o=2&e.flags?bt(e.index,t):t;0==(32&t[2])&&Gn(o);let a=zo(t,0,s,n),c=i.__ngNextListenerFn__;for(;c;)a=zo(t,0,c,n)&&a,c=c.__ngNextListenerFn__;return r&&!1===a&&(n.preventDefault(),n.returnValue=!1),a}}function Ko(e=1){return function(e){return(wt.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,wt.lFrame.contextLView))[8]}(e)}function jo(e,t){let i=null;const s=function(e){const t=e.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(e);for(let r=0;r<t.length;r++){const n=t[r];if("*"!==n){if(null===s?$r(e,n,!0):Qr(s,n))return r}else i=r}return i}function $o(e,t,i){return Qo(e,"",t,"",i),$o}function Qo(e,t,i,s,r){const n=Mt(),o=_o(n,t,i,s);return o!==Zr&&In(Lt(),oi(),n,e,o,n[11],r,!1),Qo}function qo(e,t,i,s,r){const n=e[i+1],o=null===t;let a=s?sn(n):nn(n),c=!1;for(;0!==a&&(!1===c||o);){const i=e[a+1];Xo(e[a],t)&&(c=!0,e[a+1]=s?an(i):rn(i)),a=s?sn(i):nn(i)}c&&(e[i+1]=s?rn(n):an(n))}function Xo(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&ss(e,t)>=0}function Zo(e,t){return function(e,t,i,s){const r=Mt(),n=Lt(),o=Yt(2);n.firstUpdatePass&&function(e,t,i,s){const r=e.data;if(null===r[i+1]){const n=r[ri()],o=function(e,t){return t>=e.expandoStartIndex}(e,i);(function(e,t){return 0!=(e.flags&(t?16:32))})(n,s)&&null===t&&!o&&(t=!1),t=function(e,t,i,s){const r=function(e){const t=wt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let n=s?t.residualClasses:t.residualStyles;if(null===r)0===(s?t.classBindings:t.styleBindings)&&(i=ea(i=Jo(null,e,t,i,s),t.attrs,s),n=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(i=Jo(r,e,t,i,s),null===n){let i=function(e,t,i){const s=i?t.classBindings:t.styleBindings;if(0!==nn(s))return e[sn(s)]}(e,t,s);void 0!==i&&Array.isArray(i)&&(i=Jo(null,e,t,i[1],s),i=ea(i,t.attrs,s),function(e,t,i,s){e[sn(i?t.classBindings:t.styleBindings)]=s}(e,t,s,i))}else n=function(e,t,i){let s;const r=t.directiveEnd;for(let n=1+t.directiveStylingLast;n<r;n++)s=ea(s,e[n].hostAttrs,i);return ea(s,t.attrs,i)}(e,t,s)}return void 0!==n&&(s?t.residualClasses=n:t.residualStyles=n),i}(r,n,t,s),function(e,t,i,s,r,n){let o=n?t.classBindings:t.styleBindings,a=sn(o),c=nn(o);e[s]=i;let l,u=!1;if(Array.isArray(i)){const e=i;l=e[1],(null===l||ss(e,l)>0)&&(u=!0)}else l=i;if(r)if(0!==c){const t=sn(e[a+1]);e[s+1]=tn(t,a),0!==t&&(e[t+1]=on(e[t+1],s)),e[a+1]=function(e,t){return 131071&e|t<<17}(e[a+1],s)}else e[s+1]=tn(a,0),0!==a&&(e[a+1]=on(e[a+1],s)),a=s;else e[s+1]=tn(c,0),0===a?a=s:e[c+1]=on(e[c+1],s),c=s;u&&(e[s+1]=rn(e[s+1])),qo(e,l,s,!0),qo(e,l,s,!1),function(e,t,i,s,r){const n=r?e.residualClasses:e.residualStyles;null!=n&&"string"==typeof t&&ss(n,t)>=0&&(i[s+1]=an(i[s+1]))}(t,l,e,s,n),o=tn(a,c),n?t.classBindings=o:t.styleBindings=o}(r,n,t,i,o,s)}}(n,e,o,s),t!==Zr&&yo(r,o,t)&&function(e,t,i,s,r,n,o,a){if(!(3&t.type))return;const c=e.data,l=c[a+1];ia(function(e){return 1==(1&e)}(l)?ta(c,t,i,r,nn(l),o):void 0)||(ia(n)||function(e){return 2==(2&e)}(l)&&(n=ta(c,null,i,r,a,o)),function(e,t,i,s,r){const n=St(e);if(t)r?n?e.addClass(i,s):i.classList.add(s):n?e.removeClass(i,s):i.classList.remove(s);else{let t=-1===s.indexOf("-")?void 0:dr.DashCase;if(null==r)n?e.removeStyle(i,s,t):i.style.removeProperty(s);else{const o="string"==typeof r&&r.endsWith("!important");o&&(r=r.slice(0,-10),t|=dr.Important),n?e.setStyle(i,s,r,t):i.style.setProperty(s,r,o?"important":"")}}}(s,o,Rt(ri(),i),r,n))}(n,n.data[ri()],r,r[11],e,r[o+1]=function(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=te(As(e)))),e}(t,i),s,o)}(e,t,null,!0),Zo}function Jo(e,t,i,s,r){let n=null;const o=i.directiveEnd;let a=i.directiveStylingLast;for(-1===a?a=i.directiveStart:a++;a<o&&(n=t[a],s=ea(s,n.hostAttrs,r),n!==e);)a++;return null!==e&&(i.directiveStylingLast=a),s}function ea(e,t,i){const s=i?1:2;let r=-1;if(null!==t)for(let n=0;n<t.length;n++){const o=t[n];"number"==typeof o?r=o:r===s&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),ts(e,o,!!i||t[++n]))}return void 0===e?null:e}function ta(e,t,i,s,r,n){const o=null===t;let a;for(;r>0;){const t=e[r],n=Array.isArray(t),c=n?t[1]:t,l=null===c;let u=i[r+1];u===Zr&&(u=l?De:void 0);let h=l?is(u,s):c===s?u:void 0;if(n&&!ia(h)&&(h=is(t,s)),ia(h)&&(a=h,o))return a;const d=e[r+1];r=o?sn(d):nn(d)}if(null!==t){let e=n?t.residualClasses:t.residualStyles;null!=e&&(a=is(e,s))}return a}function ia(e){return void 0!==e}function sa(e,t=""){const i=Mt(),s=Lt(),r=e+20,n=s.firstCreatePass?un(s,r,1,t,null):s.data[r],o=i[r]=function(e,t){return St(e)?e.createText(t):e.createTextNode(t)}(i[11],t);Pr(s,i,o,n),Ft(n,!1)}function ra(e){return na("",e,""),ra}function na(e,t,i){const s=Mt(),r=_o(s,e,t,i);return r!==Zr&&Qn(s,ri(),r),na}function oa(e,t,i,s,r){const n=Mt(),o=function(e,t,i,s,r,n){const o=Ao(e,Vt(),i,r);return Yt(2),o?t+ce(i)+s+ce(r)+n:Zr}(n,e,t,i,s,r);return o!==Zr&&Qn(n,ri(),o),oa}function aa(e,t,i,s,r,n,o){const a=Mt(),c=wo(a,e,t,i,s,r,n,o);return c!==Zr&&Qn(a,ri(),c),aa}function ca(e,t,i){const s=Mt();return yo(s,zt(),t)&&In(Lt(),oi(),s,e,t,s[11],i,!0),ca}const la=void 0;var ua=["en",[["a","p"],["AM","PM"],la],[["AM","PM"],la,la],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],la,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],la,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",la,"{1} 'at' {0}",la],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){const t=Math.floor(Math.abs(e)),i=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let ha={};function da(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let i=ga(t);if(i)return i;const s=t.split("-")[0];if(i=ga(s),i)return i;if("en"===s)return ua;throw new Error(`Missing locale data for the locale "${e}".`)}function ga(e){return e in ha||(ha[e]=Me.ng&&Me.ng.common&&Me.ng.common.locales&&Me.ng.common.locales[e]),ha[e]}var pa=(()=>((pa=pa||{})[pa.LocaleId=0]="LocaleId",pa[pa.DayPeriodsFormat=1]="DayPeriodsFormat",pa[pa.DayPeriodsStandalone=2]="DayPeriodsStandalone",pa[pa.DaysFormat=3]="DaysFormat",pa[pa.DaysStandalone=4]="DaysStandalone",pa[pa.MonthsFormat=5]="MonthsFormat",pa[pa.MonthsStandalone=6]="MonthsStandalone",pa[pa.Eras=7]="Eras",pa[pa.FirstDayOfWeek=8]="FirstDayOfWeek",pa[pa.WeekendRange=9]="WeekendRange",pa[pa.DateFormat=10]="DateFormat",pa[pa.TimeFormat=11]="TimeFormat",pa[pa.DateTimeFormat=12]="DateTimeFormat",pa[pa.NumberSymbols=13]="NumberSymbols",pa[pa.NumberFormats=14]="NumberFormats",pa[pa.CurrencyCode=15]="CurrencyCode",pa[pa.CurrencySymbol=16]="CurrencySymbol",pa[pa.CurrencyName=17]="CurrencyName",pa[pa.Currencies=18]="Currencies",pa[pa.Directionality=19]="Directionality",pa[pa.PluralCase=20]="PluralCase",pa[pa.ExtraData=21]="ExtraData",pa))();const fa="en-US";let ma=fa;function Sa(e){he(e,"Expected localeId to be defined"),"string"==typeof e&&(ma=e.toLowerCase().replace(/_/g,"-"))}function Ea(e,t,i,s,r){if(e=ne(e),Array.isArray(e))for(let n=0;n<e.length;n++)Ea(e[n],t,i,s,r);else{const n=Lt(),o=Mt();let a=uo(e)?e:ne(e.provide),c=ao(e);const l=xt(),u=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(uo(e)||!e.multi){const s=new pi(c,r,Mo),g=Oa(a,t,r?u:u+d,h);-1===g?(wi(yi(l,o),n,a),va(n,e,t.length),t.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),i.push(s),o.push(s)):(i[g]=s,o[g]=s)}else{const g=Oa(a,t,u+d,h),p=Oa(a,t,u,u+d),f=g>=0&&i[g],m=p>=0&&i[p];if(r&&!m||!r&&!f){wi(yi(l,o),n,a);const u=function(e,t,i,s,r){const n=new pi(e,i,Mo);return n.multi=[],n.index=t,n.componentProviders=0,Ra(n,r,s&&!i),n}(r?Ia:Ta,i.length,r,s,c);!r&&m&&(i[p].providerFactory=u),va(n,e,t.length,0),t.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),i.push(u),o.push(u)}else va(n,e,g>-1?g:p,Ra(i[r?p:g],c,!r&&s));!r&&s&&m&&i[p].componentProviders++}}}function va(e,t,i,s){const r=uo(t);if(r||function(e){return!!e.useClass}(t)){const n=(t.useClass||t).prototype.ngOnDestroy;if(n){const o=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const e=o.indexOf(i);-1===e?o.push(i,[s,n]):o[e+1].push(s,n)}else o.push(i,n)}}}function Ra(e,t,i){return i&&e.componentProviders++,e.multi.push(t)-1}function Oa(e,t,i,s){for(let r=i;r<s;r++)if(t[r]===e)return r;return-1}function Ta(e,t,i,s){return ba(this.multi,[])}function Ia(e,t,i,s){const r=this.multi;let n;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=Ui(i,i[1],this.providerFactory.index,s);n=t.slice(0,e),ba(r,n);for(let i=e;i<t.length;i++)n.push(t[i])}else n=[],ba(r,n);return n}function ba(e,t){for(let i=0;i<e.length;i++)t.push((0,e[i])());return t}function Ca(e,t=[]){return i=>{i.providersResolver=(i,s)=>function(e,t,i){const s=Lt();if(s.firstCreatePass){const r=rt(e);Ea(i,s.data,s.blueprint,r,!0),Ea(t,s.data,s.blueprint,r,!1)}}(i,s?s(e):e,t)}}class ya{}const Aa="ngComponent";class Na{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${te(e)}. Did you add it to @NgModule.entryComponents?`);return t[Aa]=e,t}(e)}}class _a{}function wa(...e){}function Pa(e,t){return new La(Ot(e,t))}_a.NULL=new Na;const Ma=function(){return Pa(xt(),Mt())};let La=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=Ma,e})();function Da(e){return e instanceof La?e.nativeElement:e}class xa{}let ka=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Fa(),e})();const Fa=function(){const e=Mt(),t=bt(xt().index,e);return function(e){return e[11]}(Je(t)?t:e)};let Ua=(()=>{class e{}return e.\u0275prov=de({token:e,providedIn:"root",factory:()=>null}),e})();class Ha{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Ga=new Ha("12.2.1");class Ba{constructor(){}supports(e){return Io(e)}create(e){return new Va(e)}}const Wa=(e,t)=>t;class Va{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Wa}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,s=0,r=null;for(;t||i;){const n=!i||t&&t.currentIndex<ja(i,s,r)?t:i,o=ja(n,s,r),a=n.currentIndex;if(n===i)s--,i=i._nextRemoved;else if(t=t._next,null==n.previousIndex)s++;else{r||(r=[]);const e=o-s,t=a-s;if(e!=t){for(let i=0;i<e;i++){const s=i<r.length?r[i]:r[i]=0,n=s+i;t<=n&&n<e&&(r[i]=s+1)}r[n.previousIndex]=t-e}}o!==a&&e(n,o,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Io(e))throw new Error(`Error trying to diff '${te(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,i,s,r=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)i=e[t],s=this._trackByFn(t,i),null!==r&&Object.is(r.trackById,s)?(n&&(r=this._verifyReinsertion(r,i,s,t)),Object.is(r.item,i)||this._addIdentityChange(r,i)):(r=this._mismatch(r,i,s,t),n=!0),r=r._next}else t=0,function(e,t){if(Array.isArray(e))for(let i=0;i<e.length;i++)t(e[i]);else{const i=e[Oo()]();let s;for(;!(s=i.next()).done;)t(s.value)}}(e,e=>{s=this._trackByFn(t,e),null!==r&&Object.is(r.trackById,s)?(n&&(r=this._verifyReinsertion(r,e,s,t)),Object.is(r.item,e)||this._addIdentityChange(r,e)):(r=this._mismatch(r,e,s,t),n=!0),r=r._next,t++}),this.length=t;return this._truncate(r),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,s){let r;return null===e?r=this._itTail:(r=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,r,s)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,s))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,r,s)):e=this._addAfter(new za(t,i),r,s),e}_verifyReinsertion(e,t,i,s){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==r?e=this._reinsertAfter(r,e._prev,s):e.currentIndex!=s&&(e.currentIndex=s,this._addToMoves(e,s)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const s=e._prevRemoved,r=e._nextRemoved;return null===s?this._removalsHead=r:s._nextRemoved=r,null===r?this._removalsTail=s:r._prevRemoved=s,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const s=null===t?this._itHead:t._next;return e._next=s,e._prev=t,null===s?this._itTail=e:s._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Ka),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Ka),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class za{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Ya{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class Ka{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Ya,this.map.set(t,i)),i.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ja(e,t,i){const s=e.previousIndex;if(null===s)return s;let r=0;return i&&s<i.length&&(r=i[s]),s+t+r}class $a{constructor(){}supports(e){return e instanceof Map||bo(e)}create(){return new Qa}}class Qa{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||bo(e)))throw new Error(`Error trying to diff '${te(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(i,e);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const s=i._prev,r=i._next;return s&&(s._next=r),r&&(r._prev=s),i._next=null,i._prev=null,i}const i=new qa(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class qa{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Xa(){return new Za([new Ba])}let Za=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(null!=i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||Xa()),deps:[[e,new Os,new Rs]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(e){return e.name||typeof e}(e)}'`)}}return e.\u0275prov=de({token:e,providedIn:"root",factory:Xa}),e})();function Ja(){return new ec([new $a])}let ec=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||Ja()),deps:[[e,new Os,new Rs]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=de({token:e,providedIn:"root",factory:Ja}),e})();function tc(e,t,i,s,r=!1){for(;null!==i;){const n=t[i.index];if(null!==n&&s.push(vt(n)),et(n))for(let e=10;e<n.length;e++){const t=n[e],i=t[1].firstChild;null!==i&&tc(t[1],t,i,s)}const o=i.type;if(8&o)tc(e,t,i.child,s);else if(32&o){const e=gr(i,t);let r;for(;r=e();)s.push(r)}else if(16&o){const e=Lr(t,i);if(Array.isArray(e))s.push(...e);else{const i=pr(t[16]);tc(i[1],i,e,s,!0)}}i=r?i.projectionNext:i.next}return s}class ic{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return tc(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(et(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Or(e,i),Ji(t,i))}this._attachedToViewContainer=!1}Tr(this._lView[1],this._lView)}onDestroy(e){On(this._lView[1],this._lView,null,e)}markForCheck(){Gn(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Bn(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,i){Bt(!0);try{Bn(e,t,i)}finally{Bt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(e,t){kr(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class sc extends ic{constructor(e){super(e),this._view=e}detectChanges(){Wn(this._view)}checkNoChanges(){!function(e){Bt(!0);try{Wn(e)}finally{Bt(!1)}}(this._view)}get context(){return null}}const rc=function(e){return function(e,t,i){if(it(e)&&!i){const i=bt(e.index,t);return new ic(i,i)}return 47&e.type?new ic(t[16],t):null}(xt(),Mt(),16==(16&e))};let nc=(()=>{class e{}return e.__NG_ELEMENT_ID__=rc,e})();const oc=[new $a],ac=new Za([new Ba]),cc=new ec(oc),lc=function(){return gc(xt(),Mt())};let uc=(()=>{class e{}return e.__NG_ELEMENT_ID__=lc,e})();const hc=uc,dc=class extends hc{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=ln(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),dn(t,i,e),new ic(i)}};function gc(e,t){return 4&e.type?new dc(t,e,Pa(e,t)):null}class pc{}class fc{}const mc=function(){return Tc(xt(),Mt())};let Sc=(()=>{class e{}return e.__NG_ELEMENT_ID__=mc,e})();const Ec=Sc,vc=class extends Ec{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Pa(this._hostTNode,this._hostLView)}get injector(){return new Bi(this._hostTNode,this._hostLView)}get parentInjector(){const e=_i(this._hostTNode,this._hostLView);if(Ri(e)){const t=Ti(e,this._hostLView),i=Oi(e);return new Bi(t[1].data[i+8],t)}return new Bi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Rc(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const s=e.createEmbeddedView(t||{});return this.insert(s,i),s}createComponent(e,t,i,s,r){const n=i||this.parentInjector;if(!r&&null==e.ngModule&&n){const e=n.get(pc,null);e&&(r=e)}const o=e.create(n,s,void 0,r);return this.insert(o.hostView,t),o}insert(e,t){const i=e._lView,s=i[1];if(function(e){return et(e[3])}(i)){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=i[3],s=new vc(t,t[6],t[3]);s.detach(s.indexOf(e))}}const r=this._adjustIndex(t),n=this._lContainer;!function(e,t,i,s){const r=10+s,n=i.length;s>0&&(i[r-1][4]=t),s<n-10?(t[4]=i[r],Zi(i,10+s,t)):(i.push(t),t[4]=null),t[3]=i;const o=t[17];null!==o&&i!==o&&function(e,t){const i=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===i?e[9]=[t]:i.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(s,i,n,r);const o=Dr(r,n),a=i[11],c=Nr(a,n[7]);return null!==c&&function(e,t,i,s,r,n){s[0]=r,s[6]=t,kr(e,s,i,1,r,n)}(s,n[6],a,i,c,o),e.attachToViewContainerRef(),Zi(Oc(n),r,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Rc(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Or(this._lContainer,t);i&&(Ji(Oc(this._lContainer),t),Tr(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=Or(this._lContainer,t);return i&&null!=Ji(Oc(this._lContainer),t)?new ic(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Rc(e){return e[8]}function Oc(e){return e[8]||(e[8]=[])}function Tc(e,t){let i;const s=t[e.index];if(et(s))i=s;else{let r;if(8&e.type)r=vt(s);else{const i=t[11];r=i.createComment("");const s=Ot(e,t);Cr(i,Nr(i,s),r,function(e,t){return St(e)?e.nextSibling(t):t.nextSibling}(i,s),!1)}t[e.index]=i=xn(s,t,r,e),Hn(t,i)}return new vc(i,e,t)}const Ic={};class bc extends _a{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Xe(e);return new Ac(t,this.ngModule)}}function Cc(e){const t=[];for(let i in e)e.hasOwnProperty(i)&&t.push({propName:e[i],templateName:i});return t}const yc=new ji("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>cr});class Ac extends ya{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(e){return e.map(Xr).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Cc(this.componentDef.inputs)}get outputs(){return Cc(this.componentDef.outputs)}create(e,t,i,s){const r=(s=s||this.ngModule)?function(e,t){return{get:(i,s,r)=>{const n=e.get(i,Ic,r);return n!==Ic||s===Ic?n:t.get(i,s,r)}}}(e,s.injector):e,n=r.get(xa,Et),o=r.get(Ua,null),a=n.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",l=i?function(e,t,i){if(St(e))return e.selectRootElement(t,i===Ae.ShadowDom);let s="string"==typeof t?e.querySelector(t):t;return s.textContent="",s}(a,i,this.componentDef.encapsulation):vr(n.createRenderer(null,this.componentDef),c,function(e){const t=e.toLowerCase();return"svg"===t?pt:"math"===t?"http://www.w3.org/1998/MathML/":null}(c)),u=this.componentDef.onPush?576:528,h=function(e,t){return{components:[],scheduler:e||cr,clean:zn,playerHandler:t||null,flags:0}}(),d=Rn(0,null,null,1,0,null,null,null,null,null),g=ln(null,d,h,u,null,null,n,a,o,r);let p,f;Zt(g);try{const e=function(e,t,i,s,r,n){const o=i[1];i[20]=e;const a=un(o,20,2,"#host",null),c=a.mergedAttrs=t.hostAttrs;null!==c&&(qn(a,c,!0),null!==e&&(fi(r,e,c),null!==a.classes&&Hr(r,e,a.classes),null!==a.styles&&Ur(r,e,a.styles)));const l=s.createRenderer(e,t),u=ln(i,vn(t),null,t.onPush?64:16,i[20],a,s,l,n||null,null);return o.firstCreatePass&&(wi(yi(a,i),o,t.type),An(o,a),_n(a,i.length,1)),Hn(i,u),i[20]=u}(l,this.componentDef,g,n,a);if(l)if(i)fi(a,l,["ng-version",Ga.full]);else{const{attrs:e,classes:t}=function(e){const t=[],i=[];let s=1,r=2;for(;s<e.length;){let n=e[s];if("string"==typeof n)2===r?""!==n&&t.push(n,e[++s]):8===r&&i.push(n);else{if(!Kr(r))break;r=n}s++}return{attrs:t,classes:i}}(this.componentDef.selectors[0]);e&&fi(a,l,e),t&&t.length>0&&Hr(a,l,t.join(" "))}if(f=Tt(d,20),void 0!==t){const e=f.projection=[];for(let i=0;i<this.ngContentSelectors.length;i++){const s=t[i];e.push(null!=s?Array.from(s):null)}}p=function(e,t,i,s,r){const n=i[1],o=function(e,t,i){const s=xt();e.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),wn(e,s,t,hn(e,t,1,null),i));const r=Ui(t,e,s.directiveStart,s);sr(r,t);const n=Ot(s,t);return n&&sr(n,t),r}(n,i,t);if(s.components.push(o),e[8]=o,r&&r.forEach(e=>e(o,t)),t.contentQueries){const e=xt();t.contentQueries(1,o,e.directiveStart)}const a=xt();return!n.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(ni(a.index),Cn(i[1],a,0,a.directiveStart,a.directiveEnd,t),yn(t,o)),o}(e,this.componentDef,g,h,[po]),dn(d,g,null)}finally{si()}return new Nc(this.componentType,p,Pa(f,g),g,f)}}class Nc extends class{}{constructor(e,t,i,s,r){super(),this.location=i,this._rootLView=s,this._tNode=r,this.instance=t,this.hostView=this.changeDetectorRef=new sc(s),this.componentType=e}get injector(){return new Bi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const _c=new Map;class wc extends pc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new bc(this);const i=Ze(e),s=function(e){return e[He]||null}(e);s&&Sa(s),this._bootstrapComponents=hr(i.bootstrap),this._r3Injector=ro(e,t,[{provide:pc,useValue:this},{provide:_a,useValue:this.componentFactoryResolver}],te(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=go.THROW_IF_NOT_FOUND,i=Oe.Default){return e===go||e===pc||e===Xn?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Pc extends fc{constructor(e){super(),this.moduleType=e,null!==Ze(e)&&function(e){const t=new Set;!function e(i){const s=Ze(i,!0),r=s.id;null!==r&&(function(e,t,i){if(t&&t!==i)throw new Error(`Duplicate module registered for ${e} - ${te(t)} vs ${te(t.name)}`)}(r,_c.get(r),i),_c.set(r,i));const n=hr(s.imports);for(const o of n)t.has(o)||(t.add(o),e(o))}(e)}(e)}create(e){return new wc(this.moduleType,e)}}function Mc(e,t,i,s){return xc(Mt(),Wt(),e,t,i,s)}function Lc(e,t,i,s,r){return kc(Mt(),Wt(),e,t,i,s,r)}function Dc(e,t){const i=e[t];return i===Zr?void 0:i}function xc(e,t,i,s,r,n){const o=t+i;return yo(e,o,r)?Co(e,o+1,n?s.call(n,r):s(r)):Dc(e,o+1)}function kc(e,t,i,s,r,n,o){const a=t+i;return Ao(e,a,r,n)?Co(e,a+2,o?s.call(o,r,n):s(r,n)):Dc(e,a+2)}function Fc(e,t){const i=Lt();let s;const r=e+20;i.firstCreatePass?(s=function(e,t){if(t)for(let i=t.length-1;i>=0;i--){const s=t[i];if(e===s.name)return s}throw new ae("302",`The pipe '${e}' could not be found!`)}(t,i.pipeRegistry),i.data[r]=s,s.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(r,s.onDestroy)):s=i.data[r];const n=s.factory||(s.factory=ot(s.type)),o=Ie(Mo);try{const e=bi(!1),t=n();return bi(e),function(e,t,i,s){i>=e.data.length&&(e.data[i]=null,e.blueprint[i]=null),t[i]=s}(i,Mt(),r,t),t}finally{Ie(o)}}function Uc(e,t,i){const s=e+20,r=Mt(),n=It(r,s);return Bc(r,Gc(r,s)?xc(r,Wt(),t,n.transform,i,n):n.transform(i))}function Hc(e,t,i,s){const r=e+20,n=Mt(),o=It(n,r);return Bc(n,Gc(n,r)?kc(n,Wt(),t,o.transform,i,s,o):o.transform(i,s))}function Gc(e,t){return e[1].data[t].pure}function Bc(e,t){return To.isWrapped(t)&&(t=To.unwrap(t),e[Vt()]=Zr),t}function Wc(e){return t=>{setTimeout(e,void 0,t)}}const Vc=class extends b{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var s,r,n;let o=e,a=t||(()=>null),c=i;if(e&&"object"==typeof e){const t=e;o=null===(s=t.next)||void 0===s?void 0:s.bind(t),a=null===(r=t.error)||void 0===r?void 0:r.bind(t),c=null===(n=t.complete)||void 0===n?void 0:n.bind(t)}this.__isAsync&&(a=Wc(a),o&&(o=Wc(o)),c&&(c=Wc(c)));const l=super.subscribe({next:o,error:a,complete:c});return e instanceof h&&e.add(l),l}};function zc(){return this._results[Oo()]()}class Yc{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Oo(),i=Yc.prototype;i[t]||(i[t]=zc)}get changes(){return this._changes||(this._changes=new Vc)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const s=qi(e);(this._changesDetected=!function(e,t,i){if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++){let r=e[s],n=t[s];if(i&&(r=i(r),n=i(n)),n!==r)return!1}return!0}(i._results,s,t))&&(i._results=s,i.length=s.length,i.last=s[this.length-1],i.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class Kc{constructor(e){this.queryList=e,this.matches=null}clone(){return new Kc(this.queryList)}setDirty(){this.queryList.setDirty()}}class jc{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,s=[];for(let e=0;e<i;e++){const i=t.getByIndex(e);s.push(this.queries[i.indexInDeclarationView].clone())}return new jc(s)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==al(e,t).matches&&this.queries[t].setDirty()}}class $c{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Qc{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const s=null!==t?t.length:0,r=this.getByIndex(i).embeddedTView(e,s);r&&(r.indexInDeclarationView=i,null!==t?t.push(r):t=[r])}return null!==t?new Qc(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class qc{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new qc(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let s=0;s<i.length;s++){const r=i[s];this.matchTNodeWithReadOption(e,t,Xc(t,r)),this.matchTNodeWithReadOption(e,t,Fi(t,e,r,!1,!1))}else i===uc?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Fi(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const s=this.metadata.read;if(null!==s)if(s===La||s===Sc||s===uc&&4&t.type)this.addMatch(t.index,-2);else{const i=Fi(t,e,s,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Xc(e,t){const i=e.localNames;if(null!==i)for(let s=0;s<i.length;s+=2)if(i[s]===t)return i[s+1];return null}function Zc(e,t,i,s){return-1===i?function(e,t){return 11&e.type?Pa(e,t):4&e.type?gc(e,t):null}(t,e):-2===i?function(e,t,i){return i===La?Pa(t,e):i===uc?gc(t,e):i===Sc?Tc(t,e):void 0}(e,t,s):Ui(e,e[1],i,t)}function Jc(e,t,i,s){const r=t[19].queries[s];if(null===r.matches){const s=e.data,n=i.matches,o=[];for(let e=0;e<n.length;e+=2){const r=n[e];o.push(r<0?null:Zc(t,s[r],n[e+1],i.metadata.read))}r.matches=o}return r.matches}function el(e,t,i,s){const r=e.queries.getByIndex(i),n=r.matches;if(null!==n){const o=Jc(e,t,r,i);for(let e=0;e<n.length;e+=2){const i=n[e];if(i>0)s.push(o[e/2]);else{const r=n[e+1],o=t[-i];for(let e=10;e<o.length;e++){const t=o[e];t[17]===t[3]&&el(t[1],t,r,s)}if(null!==o[9]){const e=o[9];for(let t=0;t<e.length;t++){const i=e[t];el(i[1],i,r,s)}}}}}return s}function tl(e){const t=Mt(),i=Lt(),s=$t();Qt(s+1);const r=al(i,s);if(e.dirty&&Ct(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const n=r.crossesNgTemplate?el(i,t,s,[]):Jc(i,t,r,s);e.reset(n,Da),e.notifyOnChanges()}return!0}return!1}function il(e,t,i){const s=Lt();s.firstCreatePass&&(ol(s,new $c(e,t,i),-1),2==(2&t)&&(s.staticViewQueries=!0)),nl(s,Mt(),t)}function sl(e,t,i,s){const r=Lt();if(r.firstCreatePass){const n=xt();ol(r,new $c(t,i,s),n.index),function(e,t){const i=e.contentQueries||(e.contentQueries=[]);t!==(i.length?i[i.length-1]:-1)&&i.push(e.queries.length-1,t)}(r,e),2==(2&i)&&(r.staticContentQueries=!0)}nl(r,Mt(),i)}function rl(){return function(e,t){return e[19].queries[t].queryList}(Mt(),$t())}function nl(e,t,i){const s=new Yc(4==(4&i));On(e,t,s,s.destroy),null===t[19]&&(t[19]=new jc),t[19].queries.push(new Kc(s))}function ol(e,t,i){null===e.queries&&(e.queries=new Qc),e.queries.track(new qc(t,i))}function al(e,t){return e.queries.getByIndex(t)}const cl=new ji("Application Initializer");let ll=(()=>{class e{constructor(e){this.appInits=e,this.resolve=wa,this.reject=wa,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const t=this.appInits[i]();if(Bo(t))e.push(t);else if(Wo(t)){const i=new Promise((e,i)=>{t.subscribe({complete:e,error:i})});e.push(i)}}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(gs(cl,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const ul=new ji("AppId"),hl={provide:ul,useFactory:function(){return`${dl()}${dl()}${dl()}`},deps:[]};function dl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const gl=new ji("Platform Initializer"),pl=new ji("Platform ID"),fl=new ji("appBootstrapListener");let ml=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const Sl=new ji("LocaleId"),El=new ji("DefaultCurrencyCode");class vl{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const Rl=function(e){return new Pc(e)},Ol=Rl,Tl=function(e){return Promise.resolve(Rl(e))},Il=function(e){const t=Rl(e),i=hr(Ze(e).declarations).reduce((e,t)=>{const i=Xe(t);return i&&e.push(new Ac(i)),e},[]);return new vl(t,i)},bl=Il,Cl=function(e){return Promise.resolve(Il(e))};let yl=(()=>{class e{constructor(){this.compileModuleSync=Ol,this.compileModuleAsync=Tl,this.compileModuleAndAllComponentsSync=bl,this.compileModuleAndAllComponentsAsync=Cl}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const Al=(()=>Promise.resolve(0))();function Nl(e){"undefined"==typeof Zone?Al.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class _l{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Vc(!1),this.onMicrotaskEmpty=new Vc(!1),this.onStable=new Vc(!1),this.onError=new Vc(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&t,s.shouldCoalesceRunChangeDetection=i,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function(){let e=Me.requestAnimationFrame,t=Me.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const s=t[Zone.__symbol__("OriginalDelegate")];s&&(t=s)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Me,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Ml(e),e.isCheckStableRunning=!0,Pl(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Ml(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,s,r,n,o,a)=>{try{return Ll(e),i.invokeTask(r,n,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===n.type||e.shouldCoalesceRunChangeDetection)&&t(),Dl(e)}},onInvoke:(i,s,r,n,o,a,c)=>{try{return Ll(e),i.invoke(r,n,o,a,c)}finally{e.shouldCoalesceRunChangeDetection&&t(),Dl(e)}},onHasTask:(t,i,s,r)=>{t.hasTask(s,r),i===s&&("microTask"==r.change?(e._hasPendingMicrotasks=r.microTask,Ml(e),Pl(e)):"macroTask"==r.change&&(e.hasPendingMacrotasks=r.macroTask))},onHandleError:(t,i,s,r)=>(t.handleError(s,r),e.runOutsideAngular(()=>e.onError.emit(r)),!1)})}(s)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!_l.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(_l.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,s){const r=this._inner,n=r.scheduleEventTask("NgZoneEvent: "+s,e,wl,wa,wa);try{return r.runTask(n,t,i)}finally{r.cancelTask(n)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const wl={};function Pl(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Ml(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Ll(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Dl(e){e._nesting--,Pl(e)}class xl{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Vc,this.onMicrotaskEmpty=new Vc,this.onStable=new Vc,this.onError=new Vc}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,s){return e.apply(t,i)}}let kl=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_l.assertNotInAngularZone(),Nl(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Nl(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,i){let s=-1;t&&t>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==s),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:i})}whenStable(e,t,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,i){return[]}}return e.\u0275fac=function(t){return new(t||e)(gs(_l))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Fl=(()=>{class e{constructor(){this._applications=new Map,Hl.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return Hl.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class Ul{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let Hl=new Ul,Gl=!0,Bl=!1;function Wl(){return Bl=!0,Gl}let Vl;const zl=new ji("AllowMultipleToken");class Yl{constructor(e,t){this.name=e,this.token=t}}function Kl(e,t,i=[]){const s=`Platform: ${t}`,r=new ji(s);return(t=[])=>{let n=jl();if(!n||n.injector.get(zl,!1))if(e)e(i.concat(t).concat({provide:r,useValue:!0}));else{const e=i.concat(t).concat({provide:r,useValue:!0},{provide:Jn,useValue:"platform"});!function(e){if(Vl&&!Vl.destroyed&&!Vl.injector.get(zl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Vl=e.get($l);const t=e.get(gl,null);t&&t.forEach(e=>e())}(go.create({providers:e,name:s}))}return function(e){const t=jl();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function jl(){return Vl&&!Vl.destroyed?Vl:null}let $l=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const i=function(e,t){let i;return i="noop"===e?new xl:("zone.js"===e?void 0:e)||new _l({enableLongStackTrace:Wl(),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),i}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),s=[{provide:_l,useValue:i}];return i.run(()=>{const r=go.create({providers:s,parent:this.injector,name:e.moduleType.name}),n=e.create(r),o=n.injector.get(ar,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.runOutsideAngular(()=>{const e=i.onError.subscribe({next:e=>{o.handleError(e)}});n.onDestroy(()=>{Xl(this._modules,n),e.unsubscribe()})}),function(e,i,s){try{const t=s();return Bo(t)?t.catch(t=>{throw i.runOutsideAngular(()=>e.handleError(t)),t}):t}catch(t){throw i.runOutsideAngular(()=>e.handleError(t)),t}}(o,i,()=>{const e=n.injector.get(ll);return e.runInitializers(),e.donePromise.then(()=>(Sa(n.injector.get(Sl,fa)||fa),this._moduleDoBootstrap(n),n))})})}bootstrapModule(e,t=[]){const i=Ql({},t);return function(e,t,i){const s=new Pc(i);return Promise.resolve(s)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,i))}_moduleDoBootstrap(e){const t=e.injector.get(ql);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${te(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(gs(go))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function Ql(e,t){return Array.isArray(t)?t.reduce(Ql,e):Object.assign(Object.assign({},e),t)}let ql=(()=>{class e{constructor(e,t,i,s,r){this._zone=e,this._injector=t,this._exceptionHandler=i,this._componentFactoryResolver=s,this._initStatus=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const n=new v(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),o=new v(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{_l.assertNotInAngularZone(),Nl(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,e.next(!0))})})});const i=this._zone.onUnstable.subscribe(()=>{_l.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),i.unsubscribe()}});this.isStable=Y(n,o.pipe(e=>K()(function(e,t){return function(t){let i;i="function"==typeof e?e:function(){return e};const s=Object.create(t,q);return s.source=t,s.subjectFactory=i,s}}(Z)(e))))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=e instanceof ya?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(i.componentType);const s=function(e){return e.isBoundToModule}(i)?void 0:this._injector.get(pc),r=i.create(go.NULL,[],t||i.selector,s),n=r.location.nativeElement,o=r.injector.get(kl,null),a=o&&r.injector.get(Fl);return o&&a&&a.registerApplication(n,o),r.onDestroy(()=>{this.detachView(r.hostView),Xl(this.components,r),a&&a.unregisterApplication(n)}),this._loadComponent(r),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;Xl(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(fl,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(gs(_l),gs(go),gs(ar),gs(_a),gs(ll))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function Xl(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class Zl{}class Jl{}const eu={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let tu=(()=>{class e{constructor(e,t){this._compiler=e,this._config=t||eu}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[t,s]=e.split("#");return void 0===s&&(s="default"),i(98255)(t).then(e=>e[s]).then(e=>iu(e,t,s)).then(e=>this._compiler.compileModuleAsync(e))}loadFactory(e){let[t,s]=e.split("#"),r="NgFactory";return void 0===s&&(s="default",r=""),i(98255)(this._config.factoryPathPrefix+t+this._config.factoryPathSuffix).then(e=>e[s+r]).then(e=>iu(e,t,s))}}return e.\u0275fac=function(t){return new(t||e)(gs(yl),gs(Jl,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function iu(e,t,i){if(!e)throw new Error(`Cannot find '${i}' in '${t}'`);return e}const su=Kl(null,"core",[{provide:pl,useValue:"unknown"},{provide:$l,deps:[go]},{provide:Fl,deps:[]},{provide:ml,deps:[]}]),ru=[{provide:ql,useClass:ql,deps:[_l,go,ar,_a,ll]},{provide:yc,deps:[_l],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:ll,useClass:ll,deps:[[new Rs,cl]]},{provide:yl,useClass:yl,deps:[]},hl,{provide:Za,useFactory:function(){return ac},deps:[]},{provide:ec,useFactory:function(){return cc},deps:[]},{provide:Sl,useFactory:function(e){return Sa(e=e||"undefined"!=typeof $localize&&$localize.locale||fa),e},deps:[[new vs(Sl),new Rs,new Os]]},{provide:El,useValue:"USD"}];let nu=(()=>{class e{constructor(e){}}return e.\u0275fac=function(t){return new(t||e)(gs(ql))},e.\u0275mod=je({type:e}),e.\u0275inj=ge({providers:ru}),e})(),ou=null;function au(){return ou}const cu=new ji("DocumentToken");let lu=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:uu,token:e,providedIn:"platform"}),e})();function uu(){return gs(du)}const hu=new ji("Location Initialized");let du=(()=>{class e extends lu{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return au().getBaseHref(this._doc)}onPopState(e){const t=au().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),()=>t.removeEventListener("popstate",e)}onHashChange(e){const t=au().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),()=>t.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,i){gu()?this._history.pushState(e,t,i):this.location.hash=i}replaceState(e,t,i){gu()?this._history.replaceState(e,t,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(gs(cu))},e.\u0275prov=de({factory:pu,token:e,providedIn:"platform"}),e})();function gu(){return!!window.history.pushState}function pu(){return new du(gs(cu))}function fu(e,t){if(0==e.length)return t;if(0==t.length)return e;let i=0;return e.endsWith("/")&&i++,t.startsWith("/")&&i++,2==i?e+t.substring(1):1==i?e+t:e+"/"+t}function mu(e){const t=e.match(/#|\?|$/),i=t&&t.index||e.length;return e.slice(0,i-("/"===e[i-1]?1:0))+e.slice(i)}function Su(e){return e&&"?"!==e[0]?"?"+e:e}let Eu=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:vu,token:e,providedIn:"root"}),e})();function vu(e){const t=gs(cu).location;return new Ou(gs(lu),t&&t.origin||"")}const Ru=new ji("appBaseHref");let Ou=(()=>{class e extends Eu{constructor(e,t){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return fu(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+Su(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${t}${i}`:t}pushState(e,t,i,s){const r=this.prepareExternalUrl(i+Su(s));this._platformLocation.pushState(e,t,r)}replaceState(e,t,i,s){const r=this.prepareExternalUrl(i+Su(s));this._platformLocation.replaceState(e,t,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,i;null===(i=(t=this._platformLocation).historyGo)||void 0===i||i.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(gs(lu),gs(Ru,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Tu=(()=>{class e extends Eu{constructor(e,t){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=t&&(this._baseHref=t)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}prepareExternalUrl(e){const t=fu(this._baseHref,e);return t.length>0?"#"+t:t}pushState(e,t,i,s){let r=this.prepareExternalUrl(i+Su(s));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(e,t,r)}replaceState(e,t,i,s){let r=this.prepareExternalUrl(i+Su(s));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,i;null===(i=(t=this._platformLocation).historyGo)||void 0===i||i.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(gs(lu),gs(Ru,8))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Iu=(()=>{class e{constructor(e,t){this._subject=new Vc,this._urlChangeListeners=[],this._platformStrategy=e;const i=this._platformStrategy.getBaseHref();this._platformLocation=t,this._baseHref=mu(Cu(i)),this._platformStrategy.onPopState(e=>{this._subject.emit({url:this.path(!0),pop:!0,state:e.state,type:e.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,t=""){return this.path()==this.normalize(e+Su(t))}normalize(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,Cu(t)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,t="",i=null){this._platformStrategy.pushState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Su(t)),i)}replaceState(e,t="",i=null){this._platformStrategy.replaceState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Su(t)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var t,i;null===(i=(t=this._platformStrategy).historyGo)||void 0===i||i.call(t,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(e=>{this._notifyUrlChangeListeners(e.url,e.state)}))}_notifyUrlChangeListeners(e="",t){this._urlChangeListeners.forEach(i=>i(e,t))}subscribe(e,t,i){return this._subject.subscribe({next:e,error:t,complete:i})}}return e.\u0275fac=function(t){return new(t||e)(gs(Eu),gs(lu))},e.normalizeQueryParams=Su,e.joinWithSlash=fu,e.stripTrailingSlash=mu,e.\u0275prov=de({factory:bu,token:e,providedIn:"root"}),e})();function bu(){return new Iu(gs(Eu),gs(lu))}function Cu(e){return e.replace(/\/index.html$/,"")}var yu=(()=>((yu=yu||{})[yu.Decimal=0]="Decimal",yu[yu.Percent=1]="Percent",yu[yu.Currency=2]="Currency",yu[yu.Scientific=3]="Scientific",yu))(),Au=(()=>((Au=Au||{})[Au.Zero=0]="Zero",Au[Au.One=1]="One",Au[Au.Two=2]="Two",Au[Au.Few=3]="Few",Au[Au.Many=4]="Many",Au[Au.Other=5]="Other",Au))(),Nu=(()=>((Nu=Nu||{})[Nu.Decimal=0]="Decimal",Nu[Nu.Group=1]="Group",Nu[Nu.List=2]="List",Nu[Nu.PercentSign=3]="PercentSign",Nu[Nu.PlusSign=4]="PlusSign",Nu[Nu.MinusSign=5]="MinusSign",Nu[Nu.Exponential=6]="Exponential",Nu[Nu.SuperscriptingExponent=7]="SuperscriptingExponent",Nu[Nu.PerMille=8]="PerMille",Nu[Nu.Infinity=9]="Infinity",Nu[Nu.NaN=10]="NaN",Nu[Nu.TimeSeparator=11]="TimeSeparator",Nu[Nu.CurrencyDecimal=12]="CurrencyDecimal",Nu[Nu.CurrencyGroup=13]="CurrencyGroup",Nu))();function _u(e,t){const i=da(e),s=i[pa.NumberSymbols][t];if(void 0===s){if(t===Nu.CurrencyDecimal)return i[pa.NumberSymbols][Nu.Decimal];if(t===Nu.CurrencyGroup)return i[pa.NumberSymbols][Nu.Group]}return s}const wu=function(e){return da(e)[pa.PluralCase]},Pu=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Mu(e){const t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}class Lu{}let Du=(()=>{class e extends Lu{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(wu(t||this.locale)(e)){case Au.Zero:return"zero";case Au.One:return"one";case Au.Two:return"two";case Au.Few:return"few";case Au.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(gs(Sl))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function xu(e,t){t=encodeURIComponent(t);for(const i of e.split(";")){const e=i.indexOf("="),[s,r]=-1==e?[i,""]:[i.slice(0,e),i.slice(e+1)];if(s.trim()===t)return decodeURIComponent(r)}return null}let ku=(()=>{class e{constructor(e,t,i,s){this._iterableDiffers=e,this._keyValueDiffers=t,this._ngEl=i,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Io(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachChangedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachRemovedItem(e=>{e.previousValue&&this._toggleClass(e.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(e=>{if("string"!=typeof e.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${te(e.item)}`);this._toggleClass(e.item,!0)}),e.forEachRemovedItem(e=>this._toggleClass(e.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!0)):Object.keys(e).forEach(t=>this._toggleClass(t,!!e[t])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!1)):Object.keys(e).forEach(e=>this._toggleClass(e,!1)))}_toggleClass(e,t){(e=e.trim())&&e.split(/\s+/g).forEach(e=>{t?this._renderer.addClass(this._ngEl.nativeElement,e):this._renderer.removeClass(this._ngEl.nativeElement,e)})}}return e.\u0275fac=function(t){return new(t||e)(Mo(Za),Mo(ec),Mo(La),Mo(ka))},e.\u0275dir=Qe({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class Fu{constructor(e,t,i,s){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Uu=(()=>{class e{constructor(e,t,i){this._viewContainer=e,this._template=t,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(e){return e.name||typeof e}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,i,s)=>{if(null==e.previousIndex){const i=this._viewContainer.createEmbeddedView(this._template,new Fu(null,this._ngForOf,-1,-1),null===s?void 0:s),r=new Hu(e,i);t.push(r)}else if(null==s)this._viewContainer.remove(null===i?void 0:i);else if(null!==i){const r=this._viewContainer.get(i);this._viewContainer.move(r,s);const n=new Hu(e,r);t.push(n)}});for(let i=0;i<t.length;i++)this._perViewChange(t[i].view,t[i].record);for(let i=0,s=this._viewContainer.length;i<s;i++){const e=this._viewContainer.get(i);e.context.index=i,e.context.count=s,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(Mo(Sc),Mo(uc),Mo(Za))},e.\u0275dir=Qe({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class Hu{constructor(e,t){this.record=e,this.view=t}}let Gu=(()=>{class e{constructor(e,t){this._viewContainer=e,this._context=new Bu,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Wu("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Wu("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(Mo(Sc),Mo(uc))},e.\u0275dir=Qe({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class Bu{constructor(){this.$implicit=null,this.ngIf=null}}function Wu(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${te(t)}'.`)}class Vu{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let zu=(()=>{class e{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),e})(),Yu=(()=>{class e{constructor(e,t,i){this.ngSwitch=i,i._addCase(),this._view=new Vu(e,t)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return e.\u0275fac=function(t){return new(t||e)(Mo(Sc),Mo(uc),Mo(zu,9))},e.\u0275dir=Qe({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),e})(),Ku=(()=>{class e{constructor(e,t,i){this._ngEl=e,this._differs=t,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,t){const[i,s]=e.split(".");null!=(t=null!=t&&s?`${t}${s}`:t)?this._renderer.setStyle(this._ngEl.nativeElement,i,t):this._renderer.removeStyle(this._ngEl.nativeElement,i)}_applyChanges(e){e.forEachRemovedItem(e=>this._setStyle(e.key,null)),e.forEachAddedItem(e=>this._setStyle(e.key,e.currentValue)),e.forEachChangedItem(e=>this._setStyle(e.key,e.currentValue))}}return e.\u0275fac=function(t){return new(t||e)(Mo(La),Mo(ec),Mo(ka))},e.\u0275dir=Qe({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),e})();function ju(e,t){return Error(`InvalidPipeArgument: '${t}' for pipe '${te(e)}'`)}const $u=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])\S*/g;let Qu=(()=>{class e{transform(t){if(null==t)return null;if("string"!=typeof t)throw ju(e,t);return t.replace($u,e=>e[0].toUpperCase()+e.substr(1).toLowerCase())}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=qe({name:"titlecase",type:e,pure:!0}),e})(),qu=(()=>{class e{constructor(e){this.differs=e,this.keyValues=[],this.compareFn=Xu}transform(e,t=Xu){if(!e||!(e instanceof Map)&&"object"!=typeof e)return null;this.differ||(this.differ=this.differs.find(e).create());const i=this.differ.diff(e),s=t!==this.compareFn;return i&&(this.keyValues=[],i.forEachItem(e=>{this.keyValues.push(function(e,t){return{key:e,value:t}}(e.key,e.currentValue))})),(i||s)&&(this.keyValues.sort(t),this.compareFn=t),this.keyValues}}return e.\u0275fac=function(t){return new(t||e)(Mo(ec,16))},e.\u0275pipe=qe({name:"keyvalue",type:e,pure:!1}),e})();function Xu(e,t){const i=e.key,s=t.key;if(i===s)return 0;if(void 0===i)return 1;if(void 0===s)return-1;if(null===i)return 1;if(null===s)return-1;if("string"==typeof i&&"string"==typeof s)return i<s?-1:1;if("number"==typeof i&&"number"==typeof s)return i-s;if("boolean"==typeof i&&"boolean"==typeof s)return i<s?-1:1;const r=String(i),n=String(s);return r==n?0:r<n?-1:1}let Zu=(()=>{class e{constructor(e){this._locale=e}transform(t,i,s){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;s=s||this._locale;try{return function(e,t,i){return function(e,t,i,s,r,n,o=!1){let a="",c=!1;if(isFinite(e)){let l=function(e){let t,i,s,r,n,o=Math.abs(e)+"",a=0;for((i=o.indexOf("."))>-1&&(o=o.replace(".","")),(s=o.search(/e/i))>0?(i<0&&(i=s),i+=+o.slice(s+1),o=o.substring(0,s)):i<0&&(i=o.length),s=0;"0"===o.charAt(s);s++);if(s===(n=o.length))t=[0],i=1;else{for(n--;"0"===o.charAt(n);)n--;for(i-=s,t=[],r=0;s<=n;s++,r++)t[r]=Number(o.charAt(s))}return i>22&&(t=t.splice(0,21),a=i-1,i=1),{digits:t,exponent:a,integerLen:i}}(e);o&&(l=function(e){if(0===e.digits[0])return e;const t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(l));let u=t.minInt,h=t.minFrac,d=t.maxFrac;if(n){const e=n.match(Pu);if(null===e)throw new Error(`${n} is not a valid digit info`);const t=e[1],i=e[3],s=e[5];null!=t&&(u=Mu(t)),null!=i&&(h=Mu(i)),null!=s?d=Mu(s):null!=i&&h>d&&(d=h)}!function(e,t,i){if(t>i)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${i}).`);let s=e.digits,r=s.length-e.integerLen;const n=Math.min(Math.max(t,r),i);let o=n+e.integerLen,a=s[o];if(o>0){s.splice(Math.max(e.integerLen,o));for(let e=o;e<s.length;e++)s[e]=0}else{r=Math.max(0,r),e.integerLen=1,s.length=Math.max(1,o=n+1),s[0]=0;for(let e=1;e<o;e++)s[e]=0}if(a>=5)if(o-1<0){for(let t=0;t>o;t--)s.unshift(0),e.integerLen++;s.unshift(1),e.integerLen++}else s[o-1]++;for(;r<Math.max(0,n);r++)s.push(0);let c=0!==n;const l=t+e.integerLen,u=s.reduceRight(function(e,t,i,s){return s[i]=(t+=e)<10?t:t-10,c&&(0===s[i]&&i>=l?s.pop():c=!1),t>=10?1:0},0);u&&(s.unshift(u),e.integerLen++)}(l,h,d);let g=l.digits,p=l.integerLen;const f=l.exponent;let m=[];for(c=g.every(e=>!e);p<u;p++)g.unshift(0);for(;p<0;p++)g.unshift(0);p>0?m=g.splice(p,g.length):(m=g,g=[0]);const S=[];for(g.length>=t.lgSize&&S.unshift(g.splice(-t.lgSize,g.length).join(""));g.length>t.gSize;)S.unshift(g.splice(-t.gSize,g.length).join(""));g.length&&S.unshift(g.join("")),a=S.join(_u(i,s)),m.length&&(a+=_u(i,r)+m.join("")),f&&(a+=_u(i,Nu.Exponential)+"+"+f)}else a=_u(i,Nu.Infinity);return a=e<0&&!c?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf,a}(e,function(e,t="-"){const i={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},s=e.split(";"),r=s[0],n=s[1],o=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],a=o[0],c=o[1]||"";i.posPre=a.substr(0,a.indexOf("#"));for(let u=0;u<c.length;u++){const e=c.charAt(u);"0"===e?i.minFrac=i.maxFrac=u+1:"#"===e?i.maxFrac=u+1:i.posSuf+=e}const l=a.split(",");if(i.gSize=l[1]?l[1].length:0,i.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,n){const e=r.length-i.posPre.length-i.posSuf.length,t=n.indexOf("#");i.negPre=n.substr(0,t).replace(/'/g,""),i.negSuf=n.substr(t+e).replace(/'/g,"")}else i.negPre=t+i.posPre,i.negSuf=i.posSuf;return i}(function(e,t){return da(e)[pa.NumberFormats][t]}(t,yu.Decimal),_u(t,Nu.MinusSign)),t,Nu.Group,Nu.Decimal,i)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error(`${e} is not a number`);return e}(t),s,i)}catch(r){throw ju(e,r.message)}}}return e.\u0275fac=function(t){return new(t||e)(Mo(Sl,16))},e.\u0275pipe=qe({name:"number",type:e,pure:!0}),e})();let Ju=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({providers:[{provide:Lu,useClass:Du}]}),e})();const eh="browser";let th=(()=>{class e{}return e.\u0275prov=de({token:e,providedIn:"root",factory:()=>new ih(gs(cu),window)}),e})();class ih{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function(e,t){const i=e.getElementById(t)||e.getElementsByName(t)[0];if(i)return i;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let s=i.currentNode;for(;s;){const e=s.shadowRoot;if(e){const i=e.getElementById(t)||e.querySelector(`[name="${t}"]`);if(i)return i}s=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,s=t.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(i-r[0],s-r[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=sh(this.window.history)||sh(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function sh(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class rh{}class nh extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(e){ou||(ou=e)}(new nh)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(ah=ah||document.querySelector("base"),ah?ah.getAttribute("href"):null);return null==t?null:function(e){oh=oh||document.createElement("a"),oh.setAttribute("href",e);const t=oh.pathname;return"/"===t.charAt(0)?t:`/${t}`}(t)}resetBaseElement(){ah=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return xu(document.cookie,e)}}let oh,ah=null;const ch=new ji("TRANSITION_ID"),lh=[{provide:cl,useFactory:function(e,t,i){return()=>{i.get(ll).donePromise.then(()=>{const i=au();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(t=>t.getAttribute("ng-transition")===e).forEach(e=>i.remove(e))})}},deps:[ch,cu,go],multi:!0}];class uh{static init(){!function(e){Hl=e}(new uh)}addToWindow(e){Me.getAngularTestability=(t,i=!0)=>{const s=e.findTestabilityInTree(t,i);if(null==s)throw new Error("Could not find testability for element.");return s},Me.getAllAngularTestabilities=()=>e.getAllTestabilities(),Me.getAllAngularRootElements=()=>e.getAllRootElements(),Me.frameworkStabilizers||(Me.frameworkStabilizers=[]),Me.frameworkStabilizers.push(e=>{const t=Me.getAllAngularTestabilities();let i=t.length,s=!1;const r=function(t){s=s||t,i--,0==i&&e(s)};t.forEach(function(e){e.whenStable(r)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const s=e.getTestability(t);return null!=s?s:i?au().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let hh=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const dh=new ji("EventManagerPlugins");let gh=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,i){return this._findPluginFor(t).addEventListener(e,t,i)}addGlobalEventListener(e,t,i){return this._findPluginFor(t).addGlobalEventListener(e,t,i)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const i=this._plugins;for(let s=0;s<i.length;s++){const t=i[s];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(gs(dh),gs(_l))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class ph{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const s=au().getGlobalEventTarget(this._doc,e);if(!s)throw new Error(`Unsupported event target ${s} for event ${t}`);return this.addEventListener(s,t,i)}}let fh=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),mh=(()=>{class e extends fh{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,t,i){e.forEach(e=>{const s=this._doc.createElement("style");s.textContent=e,i.push(t.appendChild(s))})}addHost(e){const t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}removeHost(e){const t=this._hostNodes.get(e);t&&t.forEach(Sh),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((t,i)=>{this._addStylesToHost(e,i,t)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(Sh))}}return e.\u0275fac=function(t){return new(t||e)(gs(cu))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function Sh(e){au().remove(e)}const Eh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},vh=/%COMP%/g;function Rh(e,t,i){for(let s=0;s<t.length;s++){let r=t[s];Array.isArray(r)?Rh(e,r,i):(r=r.replace(vh,e),i.push(r))}return i}function Oh(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let Th=(()=>{class e{constructor(e,t,i){this.eventManager=e,this.sharedStylesHost=t,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Ih(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ae.Emulated:{let i=this.rendererByCompId.get(t.id);return i||(i=new bh(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,i)),i.applyToHost(e),i}case 1:case Ae.ShadowDom:return new Ch(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=Rh(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(gs(gh),gs(mh),gs(ul))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class Ih{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Eh[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,s){if(s){t=s+":"+t;const r=Eh[s];r?e.setAttributeNS(r,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const s=Eh[i];s?e.removeAttributeNS(s,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,s){s&(dr.DashCase|dr.Important)?e.style.setProperty(t,i,s&dr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&dr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Oh(i)):this.eventManager.addEventListener(e,t,Oh(i))}}class bh extends Ih{constructor(e,t,i,s){super(e),this.component=i;const r=Rh(s+"-"+i.id,i.styles,[]);t.addStyles(r),this.contentAttr=function(e){return"_ngcontent-%COMP%".replace(vh,e)}(s+"-"+i.id),this.hostAttr=function(e){return"_nghost-%COMP%".replace(vh,e)}(s+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class Ch extends Ih{constructor(e,t,i,s){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=Rh(s.id,s.styles,[]);for(let n=0;n<r.length;n++){const e=document.createElement("style");e.textContent=r[n],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let yh=(()=>{class e extends ph{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,i){return e.addEventListener(t,i,!1),()=>this.removeEventListener(e,t,i)}removeEventListener(e,t,i){return e.removeEventListener(t,i)}}return e.\u0275fac=function(t){return new(t||e)(gs(cu))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const Ah=["alt","control","meta","shift"],Nh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_h={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},wh={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Ph=(()=>{class e extends ph{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,s){const r=e.parseEventName(i),n=e.eventCallback(r.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>au().onAndCancel(t,r.domEventName,n))}static parseEventName(t){const i=t.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const r=e._normalizeKey(i.pop());let n="";if(Ah.forEach(e=>{const t=i.indexOf(e);t>-1&&(i.splice(t,1),n+=e+".")}),n+=r,0!=i.length||0===r.length)return null;const o={};return o.domEventName=s,o.fullKey=n,o}static getEventFullKey(e){let t="",i=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&_h.hasOwnProperty(t)&&(t=_h[t]))}return Nh[t]||t}(e);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Ah.forEach(s=>{s!=i&&wh[s](e)&&(t+=s+".")}),t+=i,t}static eventCallback(t,i,s){return r=>{e.getEventFullKey(r)===t&&s.runGuarded(()=>i(r))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return e.\u0275fac=function(t){return new(t||e)(gs(cu))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const Mh=Kl(su,"browser",[{provide:pl,useValue:eh},{provide:gl,useValue:function(){nh.makeCurrent(),uh.init()},multi:!0},{provide:cu,useFactory:function(){return function(e){ft=e}(document),document},deps:[]}]),Lh=[[],{provide:Jn,useValue:"root"},{provide:ar,useFactory:function(){return new ar},deps:[]},{provide:dh,useClass:yh,multi:!0,deps:[cu,_l,pl]},{provide:dh,useClass:Ph,multi:!0,deps:[cu]},[],{provide:Th,useClass:Th,deps:[gh,mh,ul]},{provide:xa,useExisting:Th},{provide:fh,useExisting:mh},{provide:mh,useClass:mh,deps:[cu]},{provide:kl,useClass:kl,deps:[_l]},{provide:gh,useClass:gh,deps:[dh,_l]},{provide:rh,useClass:hh,deps:[]},[]];let Dh=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:ul,useValue:t.appId},{provide:ch,useExisting:ul},lh]}}}return e.\u0275fac=function(t){return new(t||e)(gs(e,12))},e.\u0275mod=je({type:e}),e.\u0275inj=ge({providers:Lh,imports:[Ju,nu]}),e})();function xh(...e){let t=e[e.length-1];return y(t)?(e.pop(),x(e,t)):z(e)}"undefined"!=typeof window&&window;class kh extends b{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new O;return this._value}next(e){super.next(this._value=e)}}class Fh extends f{notifyNext(e,t,i,s,r){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class Uh extends f{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function Hh(e,t,i,s,r=new Uh(e,i,s)){if(!r.closed)return t instanceof v?t.subscribe(r):D(t)(r)}const Gh={};class Bh{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new Wh(e,this.resultSelector))}}class Wh extends Fh{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(Gh),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(Hh(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const s=this.values,r=this.toRespond?s[i]===Gh?--this.toRespond:this.toRespond:0;s[i]=t,0===r&&(this.resultSelector?this._tryResultSelector(s):this.destination.next(s.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Vh=(()=>{function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e})();function zh(...e){return V(1)(xh(...e))}const Yh=new v(e=>e.complete());function Kh(e){return e?function(e){return new v(t=>e.schedule(()=>t.complete()))}(e):Yh}function jh(e){return new v(t=>{let i;try{i=e()}catch(s){return void t.error(s)}return(i?k(i):Kh()).subscribe(t)})}function $h(e,t){return"function"==typeof t?i=>i.pipe($h((i,s)=>k(e(i,s)).pipe(A((e,r)=>t(i,e,s,r))))):t=>t.lift(new Qh(e))}class Qh{constructor(e){this.project=e}call(e,t){return t.subscribe(new qh(e,this.project))}}class qh extends U{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(s){return void this.destination.error(s)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new F(this),s=this.destination;s.add(i),this.innerSubscription=H(e,i),this.innerSubscription!==i&&s.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const Xh=(()=>{function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e})();function Zh(e){return t=>0===e?Kh():t.lift(new Jh(e))}class Jh{constructor(e){if(this.total=e,this.total<0)throw new Xh}call(e,t){return t.subscribe(new ed(e,this.total))}}class ed extends f{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function td(...e){const t=e[e.length-1];return y(t)?(e.pop(),i=>zh(e,i,t)):t=>zh(e,t)}function id(e,t){let i=!1;return arguments.length>=2&&(i=!0),function(s){return s.lift(new sd(e,t,i))}}class sd{constructor(e,t,i=!1){this.accumulator=e,this.seed=t,this.hasSeed=i}call(e,t){return t.subscribe(new rd(e,this.accumulator,this.seed,this.hasSeed))}}class rd extends f{constructor(e,t,i,s){super(e),this.accumulator=t,this._seed=i,this.hasSeed=s,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let i;try{i=this.accumulator(this.seed,e,t)}catch(s){this.destination.error(s)}this.seed=i,this.destination.next(i)}}function nd(e,t){return function(i){return i.lift(new od(e,t))}}class od{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new ad(e,this.predicate,this.thisArg))}}class ad extends f{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function cd(e){return function(t){const i=new ld(e),s=t.lift(i);return i.caught=s}}class ld{constructor(e){this.selector=e}call(e,t){return t.subscribe(new ud(e,this.selector,this.caught))}}class ud extends U{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let i;try{i=this.selector(e,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle();const s=new F(this);this.add(s);const r=H(i,s);r!==s&&this.add(r)}}}function hd(e,t){return G(e,t,1)}function dd(e){return function(t){return 0===e?Kh():t.lift(new gd(e))}}class gd{constructor(e){if(this.total=e,this.total<0)throw new Xh}call(e,t){return t.subscribe(new pd(e,this.total))}}class pd extends f{constructor(e,t){super(e),this.total=t,this.ring=new Array,this.count=0}_next(e){const t=this.ring,i=this.total,s=this.count++;t.length<i?t.push(e):t[s%i]=e}_complete(){const e=this.destination;let t=this.count;if(t>0){const i=this.count>=this.total?this.total:this.count,s=this.ring;for(let r=0;r<i;r++){const r=t++%i;e.next(s[r])}}e.complete()}}function fd(e=Ed){return t=>t.lift(new md(e))}class md{constructor(e){this.errorFactory=e}call(e,t){return t.subscribe(new Sd(e,this.errorFactory))}}class Sd extends f{constructor(e,t){super(e),this.errorFactory=t,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let t;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)}}}function Ed(){return new Vh}function vd(e=null){return t=>t.lift(new Rd(e))}class Rd{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new Od(e,this.defaultValue))}}class Od extends f{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Td(e,t){const i=arguments.length>=2;return s=>s.pipe(e?nd((t,i)=>e(t,i,s)):E,Zh(1),i?vd(t):fd(()=>new Vh))}function Id(){}function bd(e,t,i){return function(s){return s.lift(new Cd(e,t,i))}}class Cd{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new yd(e,this.nextOrObserver,this.error,this.complete))}}class yd extends f{constructor(e,t,i,r){super(e),this._tapNext=Id,this._tapError=Id,this._tapComplete=Id,this._tapError=i||Id,this._tapComplete=r||Id,s(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||Id,this._tapError=t.error||Id,this._tapComplete=t.complete||Id)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}class Ad{constructor(e){this.callback=e}call(e,t){return t.subscribe(new Nd(e,this.callback))}}class Nd extends f{constructor(e,t){super(e),this.add(new h(t))}}class _d{constructor(e,t){this.id=e,this.url=t}}class wd extends _d{constructor(e,t,i="imperative",s=null){super(e,t),this.navigationTrigger=i,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Pd extends _d{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Md extends _d{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ld extends _d{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Dd extends _d{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xd extends _d{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kd extends _d{constructor(e,t,i,s,r){super(e,t),this.urlAfterRedirects=i,this.state=s,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Fd extends _d{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ud extends _d{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hd{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Gd{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Bd{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wd{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vd{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zd{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Yd{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Kd="primary";class jd{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function $d(e){return new jd(e)}const Qd="ngNavigationCancelingError";function qd(e){const t=Error("NavigationCancelingError: "+e);return t[Qd]=!0,t}function Xd(e,t,i){const s=i.path.split("/");if(s.length>e.length||"full"===i.pathMatch&&(t.hasChildren()||s.length<e.length))return null;const r={};for(let n=0;n<s.length;n++){const t=s[n],i=e[n];if(t.startsWith(":"))r[t.substring(1)]=i;else if(t!==i.path)return null}return{consumed:e.slice(0,s.length),posParams:r}}function Zd(e,t){const i=e?Object.keys(e):void 0,s=t?Object.keys(t):void 0;if(!i||!s||i.length!=s.length)return!1;let r;for(let n=0;n<i.length;n++)if(r=i[n],!Jd(e[r],t[r]))return!1;return!0}function Jd(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const i=[...e].sort(),s=[...t].sort();return i.every((e,t)=>s[t]===e)}return e===t}function eg(e){return Array.prototype.concat.apply([],e)}function tg(e){return e.length>0?e[e.length-1]:null}function ig(e,t){for(const i in e)e.hasOwnProperty(i)&&t(e[i],i)}function sg(e){return Wo(e)?e:Bo(e)?k(Promise.resolve(e)):xh(e)}const rg={exact:function e(t,i,s){if(!gg(t.segments,i.segments)||!lg(t.segments,i.segments,s)||t.numberOfChildren!==i.numberOfChildren)return!1;for(const r in i.children)if(!t.children[r]||!e(t.children[r],i.children[r],s))return!1;return!0},subset:ag},ng={exact:function(e,t){return Zd(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(i=>Jd(e[i],t[i]))},ignored:()=>!0};function og(e,t,i){return rg[i.paths](e.root,t.root,i.matrixParams)&&ng[i.queryParams](e.queryParams,t.queryParams)&&!("exact"===i.fragment&&e.fragment!==t.fragment)}function ag(e,t,i){return cg(e,t,t.segments,i)}function cg(e,t,i,s){if(e.segments.length>i.length){const r=e.segments.slice(0,i.length);return!(!gg(r,i)||t.hasChildren()||!lg(r,i,s))}if(e.segments.length===i.length){if(!gg(e.segments,i)||!lg(e.segments,i,s))return!1;for(const i in t.children)if(!e.children[i]||!ag(e.children[i],t.children[i],s))return!1;return!0}{const r=i.slice(0,e.segments.length),n=i.slice(e.segments.length);return!!(gg(e.segments,r)&&lg(e.segments,r,s)&&e.children[Kd])&&cg(e.children[Kd],t,n,s)}}function lg(e,t,i){return t.every((t,s)=>ng[i](e[s].parameters,t.parameters))}class ug{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$d(this.queryParams)),this._queryParamMap}toString(){return mg.serialize(this)}}class hg{constructor(e,t){this.segments=e,this.children=t,this.parent=null,ig(t,(e,t)=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Sg(this)}}class dg{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=$d(this.parameters)),this._parameterMap}toString(){return bg(this)}}function gg(e,t){return e.length===t.length&&e.every((e,i)=>e.path===t[i].path)}class pg{}class fg{parse(e){const t=new _g(e);return new ug(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){return`${`/${Eg(e.root,!0)}`}${function(e){const t=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(e=>`${Rg(t)}=${Rg(e)}`).join("&"):`${Rg(t)}=${Rg(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(e.queryParams)}${"string"==typeof e.fragment?`#${function(e){return encodeURI(e)}(e.fragment)}`:""}`}}const mg=new fg;function Sg(e){return e.segments.map(e=>bg(e)).join("/")}function Eg(e,t){if(!e.hasChildren())return Sg(e);if(t){const t=e.children[Kd]?Eg(e.children[Kd],!1):"",i=[];return ig(e.children,(e,t)=>{t!==Kd&&i.push(`${t}:${Eg(e,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function(e,t){let i=[];return ig(e.children,(e,s)=>{s===Kd&&(i=i.concat(t(e,s)))}),ig(e.children,(e,s)=>{s!==Kd&&(i=i.concat(t(e,s)))}),i}(e,(t,i)=>i===Kd?[Eg(e.children[Kd],!1)]:[`${i}:${Eg(t,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Kd]?`${Sg(e)}/${t[0]}`:`${Sg(e)}/(${t.join("//")})`}}function vg(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Rg(e){return vg(e).replace(/%3B/gi,";")}function Og(e){return vg(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Tg(e){return decodeURIComponent(e)}function Ig(e){return Tg(e.replace(/\+/g,"%20"))}function bg(e){return`${Og(e.path)}${function(e){return Object.keys(e).map(t=>`;${Og(t)}=${Og(e[t])}`).join("")}(e.parameters)}`}const Cg=/^[^\/()?;=#]+/;function yg(e){const t=e.match(Cg);return t?t[0]:""}const Ag=/^[^=?&#]+/,Ng=/^[^?&#]+/;class _g{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new hg([],{}):new hg([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Kd]=new hg(e,t)),i}parseSegment(){const e=yg(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new dg(Tg(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=yg(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=yg(this.remaining);e&&(i=e,this.capture(i))}e[Tg(t)]=Tg(i)}parseQueryParam(e){const t=function(e){const t=e.match(Ag);return t?t[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=function(e){const t=e.match(Ng);return t?t[0]:""}(this.remaining);e&&(i=e,this.capture(i))}const s=Ig(t),r=Ig(i);if(e.hasOwnProperty(s)){let t=e[s];Array.isArray(t)||(t=[t],e[s]=t),t.push(r)}else e[s]=r}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=yg(this.remaining),s=this.remaining[i.length];if("/"!==s&&")"!==s&&";"!==s)throw new Error(`Cannot parse url '${this.url}'`);let r;i.indexOf(":")>-1?(r=i.substr(0,i.indexOf(":")),this.capture(r),this.capture(":")):e&&(r=Kd);const n=this.parseChildren();t[r]=1===Object.keys(n).length?n[Kd]:new hg([],n),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class wg{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Pg(e,this._root);return t?t.children.map(e=>e.value):[]}firstChild(e){const t=Pg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Mg(e,this._root);return t.length<2?[]:t[t.length-2].children.map(e=>e.value).filter(t=>t!==e)}pathFromRoot(e){return Mg(e,this._root).map(e=>e.value)}}function Pg(e,t){if(e===t.value)return t;for(const i of t.children){const t=Pg(e,i);if(t)return t}return null}function Mg(e,t){if(e===t.value)return[t];for(const i of t.children){const s=Mg(e,i);if(s.length)return s.unshift(t),s}return[]}class Lg{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Dg(e){const t={};return e&&e.children.forEach(e=>t[e.value.outlet]=e),t}class xg extends wg{constructor(e,t){super(e),this.snapshot=t,Bg(this,e)}toString(){return this.snapshot.toString()}}function kg(e,t){const i=function(e,t){const i=new Hg([],{},{},"",{},Kd,t,null,e.root,-1,{});return new Gg("",new Lg(i,[]))}(e,t),s=new kh([new dg("",{})]),r=new kh({}),n=new kh({}),o=new kh({}),a=new kh(""),c=new Fg(s,r,o,a,n,Kd,t,i.root);return c.snapshot=i.root,new xg(new Lg(c,[]),i)}class Fg{constructor(e,t,i,s,r,n,o,a){this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=r,this.outlet=n,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(A(e=>$d(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(A(e=>$d(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ug(e,t="emptyOnly"){const i=e.pathFromRoot;let s=0;if("always"!==t)for(s=i.length-1;s>=1;){const e=i[s],t=i[s-1];if(e.routeConfig&&""===e.routeConfig.path)s--;else{if(t.component)break;s--}}return function(e){return e.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(s))}class Hg{constructor(e,t,i,s,r,n,o,a,c,l,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=r,this.outlet=n,this.component=o,this.routeConfig=a,this._urlSegment=c,this._lastPathIndex=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=$d(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$d(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(e=>e.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Gg extends wg{constructor(e,t){super(t),this.url=e,Bg(this,t)}toString(){return Wg(this._root)}}function Bg(e,t){t.value._routerState=e,t.children.forEach(t=>Bg(e,t))}function Wg(e){const t=e.children.length>0?` { ${e.children.map(Wg).join(", ")} } `:"";return`${e.value}${t}`}function Vg(e){if(e.snapshot){const t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,Zd(t.queryParams,i.queryParams)||e.queryParams.next(i.queryParams),t.fragment!==i.fragment&&e.fragment.next(i.fragment),Zd(t.params,i.params)||e.params.next(i.params),function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Zd(e[i],t[i]))return!1;return!0}(t.url,i.url)||e.url.next(i.url),Zd(t.data,i.data)||e.data.next(i.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function zg(e,t){return Zd(e.params,t.params)&&function(e,t){return gg(e,t)&&e.every((e,i)=>Zd(e.parameters,t[i].parameters))}(e.url,t.url)&&!(!e.parent!=!t.parent)&&(!e.parent||zg(e.parent,t.parent))}function Yg(e,t,i){if(i&&e.shouldReuseRoute(t.value,i.value.snapshot)){const s=i.value;s._futureSnapshot=t.value;const r=function(e,t,i){return t.children.map(t=>{for(const s of i.children)if(e.shouldReuseRoute(t.value,s.value.snapshot))return Yg(e,t,s);return Yg(e,t)})}(e,t,i);return new Lg(s,r)}{if(e.shouldAttach(t.value)){const i=e.retrieve(t.value);if(null!==i){const e=i.route;return Kg(t,e),e}}const i=function(e){return new Fg(new kh(e.url),new kh(e.params),new kh(e.queryParams),new kh(e.fragment),new kh(e.data),e.outlet,e.component,e)}(t.value),s=t.children.map(t=>Yg(e,t));return new Lg(i,s)}}function Kg(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(let i=0;i<e.children.length;++i)Kg(e.children[i],t.children[i])}function jg(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function $g(e){return"object"==typeof e&&null!=e&&e.outlets}function Qg(e,t,i,s,r){let n={};return s&&ig(s,(e,t)=>{n[t]=Array.isArray(e)?e.map(e=>`${e}`):`${e}`}),new ug(i.root===e?t:qg(i.root,e,t),n,r)}function qg(e,t,i){const s={};return ig(e.children,(e,r)=>{s[r]=e===t?i:qg(e,t,i)}),new hg(e.segments,s)}class Xg{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&jg(i[0]))throw new Error("Root segment cannot have matrix parameters");const s=i.find($g);if(s&&s!==tg(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Zg{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function Jg(e,t,i){if(e||(e=new hg([],{})),0===e.segments.length&&e.hasChildren())return ep(e,t,i);const s=function(e,t,i){let s=0,r=t;const n={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(s>=i.length)return n;const t=e.segments[r],o=i[s];if($g(o))break;const a=`${o}`,c=s<i.length-1?i[s+1]:null;if(r>0&&void 0===a)break;if(a&&c&&"object"==typeof c&&void 0===c.outlets){if(!rp(a,c,t))return n;s+=2}else{if(!rp(a,{},t))return n;s++}r++}return{match:!0,pathIndex:r,commandIndex:s}}(e,t,i),r=i.slice(s.commandIndex);if(s.match&&s.pathIndex<e.segments.length){const t=new hg(e.segments.slice(0,s.pathIndex),{});return t.children[Kd]=new hg(e.segments.slice(s.pathIndex),e.children),ep(t,0,r)}return s.match&&0===r.length?new hg(e.segments,{}):s.match&&!e.hasChildren()?tp(e,t,i):s.match?ep(e,0,r):tp(e,t,i)}function ep(e,t,i){if(0===i.length)return new hg(e.segments,{});{const s=function(e){return $g(e[0])?e[0].outlets:{[Kd]:e}}(i),r={};return ig(s,(i,s)=>{"string"==typeof i&&(i=[i]),null!==i&&(r[s]=Jg(e.children[s],t,i))}),ig(e.children,(e,t)=>{void 0===s[t]&&(r[t]=e)}),new hg(e.segments,r)}}function tp(e,t,i){const s=e.segments.slice(0,t);let r=0;for(;r<i.length;){const n=i[r];if($g(n)){const e=ip(n.outlets);return new hg(s,e)}if(0===r&&jg(i[0])){s.push(new dg(e.segments[t].path,sp(i[0]))),r++;continue}const o=$g(n)?n.outlets[Kd]:`${n}`,a=r<i.length-1?i[r+1]:null;o&&a&&jg(a)?(s.push(new dg(o,sp(a))),r+=2):(s.push(new dg(o,{})),r++)}return new hg(s,{})}function ip(e){const t={};return ig(e,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[i]=tp(new hg([],{}),0,e))}),t}function sp(e){const t={};return ig(e,(e,i)=>t[i]=`${e}`),t}function rp(e,t,i){return e==i.path&&Zd(t,i.parameters)}class np{constructor(e,t,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Vg(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const s=Dg(t);e.children.forEach(e=>{const t=e.value.outlet;this.deactivateRoutes(e,s[t],i),delete s[t]}),ig(s,(e,t)=>{this.deactivateRouteAndItsChildren(e,i)})}deactivateRoutes(e,t,i){const s=e.value,r=t?t.value:null;if(s===r)if(s.component){const r=i.getContext(s.outlet);r&&this.deactivateChildRoutes(e,t,r.children)}else this.deactivateChildRoutes(e,t,i);else r&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet);if(i&&i.outlet){const t=i.outlet.detach(),s=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:t,route:e,contexts:s})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),s=i&&e.value.component?i.children:t,r=Dg(e);for(const n of Object.keys(r))this.deactivateRouteAndItsChildren(r[n],s);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const s=Dg(t);e.children.forEach(e=>{this.activateRoutes(e,s[e.value.outlet],i),this.forwardEvent(new zd(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Wd(e.value.snapshot))}activateRoutes(e,t,i){const s=e.value,r=t?t.value:null;if(Vg(s),s===r)if(s.component){const r=i.getOrCreateContext(s.outlet);this.activateChildRoutes(e,t,r.children)}else this.activateChildRoutes(e,t,i);else if(s.component){const t=i.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const e=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),t.children.onOutletReAttached(e.contexts),t.attachRef=e.componentRef,t.route=e.route.value,t.outlet&&t.outlet.attach(e.componentRef,e.route.value),op(e.route)}else{const i=function(e){for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(s.snapshot),r=i?i.module.componentFactoryResolver:null;t.attachRef=null,t.route=s,t.resolver=r,t.outlet&&t.outlet.activateWith(s,r),this.activateChildRoutes(e,null,t.children)}}else this.activateChildRoutes(e,null,i)}}function op(e){Vg(e.value),e.children.forEach(op)}class ap{constructor(e,t){this.routes=e,this.module=t}}function cp(e){return"function"==typeof e}function lp(e){return e instanceof ug}const up=Symbol("INITIAL_VALUE");function hp(){return $h(e=>function(...e){let t,i;return y(e[e.length-1])&&(i=e.pop()),"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&c(e[0])&&(e=e[0]),z(e,i).lift(new Bh(t))}(e.map(e=>e.pipe(Zh(1),td(up)))).pipe(id((e,t)=>{let i=!1;return t.reduce((e,s,r)=>e!==up?e:(s===up&&(i=!0),i||!1!==s&&r!==t.length-1&&!lp(s)?e:s),e)},up),nd(e=>e!==up),A(e=>lp(e)?e:!0===e),Zh(1)))}let dp=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ve({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&Fo(0,"router-outlet")},directives:function(){return[df]},encapsulation:2}),e})();function gp(e,t=""){for(let i=0;i<e.length;i++){const s=e[i];pp(s,fp(t,s))}}function pp(e,t){e.children&&gp(e.children,t)}function fp(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function mp(e){const t=e.children&&e.children.map(mp),i=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!i.component&&(t||i.loadChildren)&&i.outlet&&i.outlet!==Kd&&(i.component=dp),i}function Sp(e){return e.outlet||Kd}function Ep(e,t){const i=e.filter(e=>Sp(e)===t);return i.push(...e.filter(e=>Sp(e)!==t)),i}const vp={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Rp(e,t,i){var s;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||i.length>0)?Object.assign({},vp):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const r=(t.matcher||Xd)(i,e,t);if(!r)return Object.assign({},vp);const n={};ig(r.posParams,(e,t)=>{n[t]=e.path});const o=r.consumed.length>0?Object.assign(Object.assign({},n),r.consumed[r.consumed.length-1].parameters):n;return{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o,positionalParamSegments:null!==(s=r.posParams)&&void 0!==s?s:{}}}function Op(e,t,i,s,r="corrected"){if(i.length>0&&function(e,t,i){return i.some(i=>Tp(e,t,i)&&Sp(i)!==Kd)}(e,i,s)){const r=new hg(t,function(e,t,i,s){const r={};r[Kd]=s,s._sourceSegment=e,s._segmentIndexShift=t.length;for(const n of i)if(""===n.path&&Sp(n)!==Kd){const i=new hg([],{});i._sourceSegment=e,i._segmentIndexShift=t.length,r[Sp(n)]=i}return r}(e,t,s,new hg(i,e.children)));return r._sourceSegment=e,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:[]}}if(0===i.length&&function(e,t,i){return i.some(i=>Tp(e,t,i))}(e,i,s)){const n=new hg(e.segments,function(e,t,i,s,r,n){const o={};for(const a of s)if(Tp(e,i,a)&&!r[Sp(a)]){const i=new hg([],{});i._sourceSegment=e,i._segmentIndexShift="legacy"===n?e.segments.length:t.length,o[Sp(a)]=i}return Object.assign(Object.assign({},r),o)}(e,t,i,s,e.children,r));return n._sourceSegment=e,n._segmentIndexShift=t.length,{segmentGroup:n,slicedSegments:i}}const n=new hg(e.segments,e.children);return n._sourceSegment=e,n._segmentIndexShift=t.length,{segmentGroup:n,slicedSegments:i}}function Tp(e,t,i){return(!(e.hasChildren()||t.length>0)||"full"!==i.pathMatch)&&""===i.path}function Ip(e,t,i,s){return!!(Sp(e)===s||s!==Kd&&Tp(t,i,e))&&("**"===e.path||Rp(t,e,i).matched)}function bp(e,t,i){return 0===t.length&&!e.children[i]}class Cp{constructor(e){this.segmentGroup=e||null}}class yp{constructor(e){this.urlTree=e}}function Ap(e){return new v(t=>t.error(new Cp(e)))}function Np(e){return new v(t=>t.error(new yp(e)))}function _p(e){return new v(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class wp{constructor(e,t,i,s,r){this.configLoader=t,this.urlSerializer=i,this.urlTree=s,this.config=r,this.allowRedirects=!0,this.ngModule=e.get(pc)}apply(){const e=Op(this.urlTree.root,[],[],this.config).segmentGroup,t=new hg(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,Kd).pipe(A(e=>this.createUrlTree(Pp(e),this.urlTree.queryParams,this.urlTree.fragment))).pipe(cd(e=>{if(e instanceof yp)return this.allowRedirects=!1,this.match(e.urlTree);throw e instanceof Cp?this.noMatchError(e):e}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Kd).pipe(A(t=>this.createUrlTree(Pp(t),e.queryParams,e.fragment))).pipe(cd(e=>{throw e instanceof Cp?this.noMatchError(e):e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const s=e.segments.length>0?new hg([],{[Kd]:e}):e;return new ug(s,t,i)}expandSegmentGroup(e,t,i,s){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(A(e=>new hg([],e))):this.expandSegment(e,i,t,i.segments,s,!0)}expandChildren(e,t,i){const s=[];for(const r of Object.keys(i.children))"primary"===r?s.unshift(r):s.push(r);return k(s).pipe(hd(s=>{const r=i.children[s],n=Ep(t,s);return this.expandSegmentGroup(e,n,r,s).pipe(A(e=>({segment:e,outlet:s})))}),id((e,t)=>(e[t.outlet]=t.segment,e),{}),function(e,t){const i=arguments.length>=2;return s=>s.pipe(e?nd((t,i)=>e(t,i,s)):E,dd(1),i?vd(t):fd(()=>new Vh))}())}expandSegment(e,t,i,s,r,n){return k(i).pipe(hd(o=>this.expandSegmentAgainstRoute(e,t,i,o,s,r,n).pipe(cd(e=>{if(e instanceof Cp)return xh(null);throw e}))),Td(e=>!!e),cd((e,i)=>{if(e instanceof Vh||"EmptyError"===e.name){if(bp(t,s,r))return xh(new hg([],{}));throw new Cp(t)}throw e}))}expandSegmentAgainstRoute(e,t,i,s,r,n,o){return Ip(s,t,r,n)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(e,t,s,r,n):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,s,r,n):Ap(t):Ap(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,s,r,n){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,s,n):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,s,r,n)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,s){const r=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?Np(r):this.lineralizeSegments(i,r).pipe(G(i=>{const r=new hg(i,{});return this.expandSegment(e,r,t,i,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,s,r,n){const{matched:o,consumedSegments:a,lastChild:c,positionalParamSegments:l}=Rp(t,s,r);if(!o)return Ap(t);const u=this.applyRedirectCommands(a,s.redirectTo,l);return s.redirectTo.startsWith("/")?Np(u):this.lineralizeSegments(s,u).pipe(G(s=>this.expandSegment(e,t,i,s.concat(r.slice(c)),n,!1)))}matchSegmentAgainstRoute(e,t,i,s,r){if("**"===i.path)return i.loadChildren?(i._loadedConfig?xh(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(A(e=>(i._loadedConfig=e,new hg(s,{})))):xh(new hg(s,{}));const{matched:n,consumedSegments:o,lastChild:a}=Rp(t,i,s);if(!n)return Ap(t);const c=s.slice(a);return this.getChildConfig(e,i,s).pipe(G(e=>{const s=e.module,n=e.routes,{segmentGroup:a,slicedSegments:l}=Op(t,o,c,n),u=new hg(a.segments,a.children);if(0===l.length&&u.hasChildren())return this.expandChildren(s,n,u).pipe(A(e=>new hg(o,e)));if(0===n.length&&0===l.length)return xh(new hg(o,{}));const h=Sp(i)===r;return this.expandSegment(s,u,n,l,h?Kd:r,!0).pipe(A(e=>new hg(o.concat(e.segments),e.children)))}))}getChildConfig(e,t,i){return t.children?xh(new ap(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?xh(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(G(i=>i?this.configLoader.load(e.injector,t).pipe(A(e=>(t._loadedConfig=e,e))):function(e){return new v(t=>t.error(qd(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`)))}(t))):xh(new ap([],e))}runCanLoadGuards(e,t,i){const s=t.canLoad;return s&&0!==s.length?xh(s.map(s=>{const r=e.get(s);let n;if(function(e){return e&&cp(e.canLoad)}(r))n=r.canLoad(t,i);else{if(!cp(r))throw new Error("Invalid CanLoad guard");n=r(t,i)}return sg(n)})).pipe(hp(),bd(e=>{if(!lp(e))return;const t=qd(`Redirecting to "${this.urlSerializer.serialize(e)}"`);throw t.url=e,t}),A(e=>!0===e)):xh(!0)}lineralizeSegments(e,t){let i=[],s=t.root;for(;;){if(i=i.concat(s.segments),0===s.numberOfChildren)return xh(i);if(s.numberOfChildren>1||!s.children[Kd])return _p(e.redirectTo);s=s.children[Kd]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,s){const r=this.createSegmentGroup(e,t.root,i,s);return new ug(r,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return ig(e,(e,s)=>{if("string"==typeof e&&e.startsWith(":")){const r=e.substring(1);i[s]=t[r]}else i[s]=e}),i}createSegmentGroup(e,t,i,s){const r=this.createSegments(e,t.segments,i,s);let n={};return ig(t.children,(t,r)=>{n[r]=this.createSegmentGroup(e,t,i,s)}),new hg(r,n)}createSegments(e,t,i,s){return t.map(t=>t.path.startsWith(":")?this.findPosParam(e,t,s):this.findOrReturn(t,i))}findPosParam(e,t,i){const s=i[t.path.substring(1)];if(!s)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return s}findOrReturn(e,t){let i=0;for(const s of t){if(s.path===e.path)return t.splice(i),s;i++}return e}}function Pp(e){const t={};for(const i of Object.keys(e.children)){const s=Pp(e.children[i]);(s.segments.length>0||s.hasChildren())&&(t[i]=s)}return function(e){if(1===e.numberOfChildren&&e.children[Kd]){const t=e.children[Kd];return new hg(e.segments.concat(t.segments),t.children)}return e}(new hg(e.segments,t))}class Mp{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Lp{constructor(e,t){this.component=e,this.route=t}}function Dp(e,t,i){const s=e._root;return kp(s,t?t._root:null,i,[s.value])}function xp(e,t,i){const s=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(s?s.module.injector:i).get(e)}function kp(e,t,i,s,r={canDeactivateChecks:[],canActivateChecks:[]}){const n=Dg(t);return e.children.forEach(e=>{(function(e,t,i,s,r={canDeactivateChecks:[],canActivateChecks:[]}){const n=e.value,o=t?t.value:null,a=i?i.getContext(e.value.outlet):null;if(o&&n.routeConfig===o.routeConfig){const c=function(e,t,i){if("function"==typeof i)return i(e,t);switch(i){case"pathParamsChange":return!gg(e.url,t.url);case"pathParamsOrQueryParamsChange":return!gg(e.url,t.url)||!Zd(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!zg(e,t)||!Zd(e.queryParams,t.queryParams);case"paramsChange":default:return!zg(e,t)}}(o,n,n.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new Mp(s)):(n.data=o.data,n._resolvedData=o._resolvedData),kp(e,t,n.component?a?a.children:null:i,s,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Lp(a.outlet.component,o))}else o&&Fp(t,a,r),r.canActivateChecks.push(new Mp(s)),kp(e,null,n.component?a?a.children:null:i,s,r)})(e,n[e.value.outlet],i,s.concat([e.value]),r),delete n[e.value.outlet]}),ig(n,(e,t)=>Fp(e,i.getContext(t),r)),r}function Fp(e,t,i){const s=Dg(e),r=e.value;ig(s,(e,s)=>{Fp(e,r.component?t?t.children.getContext(s):null:t,i)}),i.canDeactivateChecks.push(new Lp(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}class Up{}function Hp(e){return new v(t=>t.error(e))}class Gp{constructor(e,t,i,s,r,n){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=s,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=n}recognize(){const e=Op(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Kd);if(null===t)return null;const i=new Hg([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Kd,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Lg(i,t),r=new Gg(this.url,s);return this.inheritParamsAndData(r._root),r}inheritParamsAndData(e){const t=e.value,i=Ug(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(e=>this.inheritParamsAndData(e))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const r of Object.keys(t.children)){const s=t.children[r],n=Ep(e,r),o=this.processSegmentGroup(n,s,r);if(null===o)return null;i.push(...o)}const s=Wp(i);return function(e){e.sort((e,t)=>e.value.outlet===Kd?-1:t.value.outlet===Kd?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}processSegment(e,t,i,s){for(const r of e){const e=this.processSegmentAgainstRoute(r,t,i,s);if(null!==e)return e}return bp(t,i,s)?[]:null}processSegmentAgainstRoute(e,t,i,s){if(e.redirectTo||!Ip(e,t,i,s))return null;let r,n=[],o=[];if("**"===e.path){const s=i.length>0?tg(i).parameters:{};r=new Hg(i,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Yp(e),Sp(e),e.component,e,Vp(t),zp(t)+i.length,Kp(e))}else{const s=Rp(t,e,i);if(!s.matched)return null;n=s.consumedSegments,o=i.slice(s.lastChild),r=new Hg(n,s.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Yp(e),Sp(e),e.component,e,Vp(t),zp(t)+n.length,Kp(e))}const a=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:l}=Op(t,n,o,a.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution);if(0===l.length&&c.hasChildren()){const e=this.processChildren(a,c);return null===e?null:[new Lg(r,e)]}if(0===a.length&&0===l.length)return[new Lg(r,[])];const u=Sp(e)===s,h=this.processSegment(a,c,l,u?Kd:s);return null===h?null:[new Lg(r,h)]}}function Bp(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Wp(e){const t=[],i=new Set;for(const s of e){if(!Bp(s)){t.push(s);continue}const e=t.find(e=>s.value.routeConfig===e.value.routeConfig);void 0!==e?(e.children.push(...s.children),i.add(e)):t.push(s)}for(const s of i){const e=Wp(s.children);t.push(new Lg(s.value,e))}return t.filter(e=>!i.has(e))}function Vp(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function zp(e){let t=e,i=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,i+=t._segmentIndexShift?t._segmentIndexShift:0;return i-1}function Yp(e){return e.data||{}}function Kp(e){return e.resolve||{}}function jp(e){return $h(t=>{const i=e(t);return i?k(i).pipe(A(()=>t)):xh(t)})}class $p{}class Qp extends class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const qp=new ji("ROUTES");class Xp{constructor(e,t,i,s){this.loader=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=s}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe(A(i=>{this.onLoadEndListener&&this.onLoadEndListener(t);const s=i.create(e);return new ap(eg(s.injector.get(qp,void 0,Oe.Self|Oe.Optional)).map(mp),s)}),cd(e=>{throw t._loader$=void 0,e}));return t._loader$=new Q(i,()=>new b).pipe(K()),t._loader$}loadModuleFactory(e){return"string"==typeof e?k(this.loader.load(e)):sg(e()).pipe(G(e=>e instanceof fc?xh(e):k(this.compiler.compileModuleAsync(e))))}}class Zp{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Jp,this.attachRef=null}}class Jp{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new Zp,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}class ef{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function tf(e){throw e}function sf(e,t,i){return t.parse("/")}function rf(e,t){return xh(null)}const nf={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},of={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let af=(()=>{class e{constructor(e,t,i,s,r,n,o,a){this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=i,this.location=s,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new b,this.errorHandler=tf,this.malformedUriErrorHandler=sf,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:rf,afterPreactivation:rf},this.urlHandlingStrategy=new ef,this.routeReuseStrategy=new Qp,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=r.get(pc),this.console=r.get(ml);const c=r.get(_l);this.isNgZoneEnabled=c instanceof _l&&_l.isInAngularZone(),this.resetConfig(a),this.currentUrlTree=new ug(new hg([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Xp(n,o,e=>this.triggerEvent(new Hd(e)),e=>this.triggerEvent(new Gd(e))),this.routerState=kg(this.currentUrlTree,this.rootComponentType),this.transitions=new kh({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}setupNavigations(e){const t=this.events;return e.pipe(nd(e=>0!==e.id),A(e=>Object.assign(Object.assign({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl)})),$h(e=>{let i=!1,s=!1;return xh(e).pipe(bd(e=>{this.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),$h(e=>{const i=!this.navigated||e.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return xh(e).pipe($h(e=>{const i=this.transitions.getValue();return t.next(new wd(e.id,this.serializeUrl(e.extractedUrl),e.source,e.restoredState)),i!==this.transitions.getValue()?Yh:Promise.resolve(e)}),function(e,t,i,s){return $h(r=>function(e,t,i,s,r){return new wp(e,t,i,s,r).apply()}(e,t,i,r.extractedUrl,s).pipe(A(e=>Object.assign(Object.assign({},r),{urlAfterRedirects:e}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),bd(e=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,t,i,r,n){return G(o=>function(e,t,i,r,n="emptyOnly",o="legacy"){try{const s=new Gp(e,t,i,r,n,o).recognize();return null===s?Hp(new Up):xh(s)}catch(s){return Hp(s)}}(e,t,o.urlAfterRedirects,i(o.urlAfterRedirects),r,n).pipe(A(e=>Object.assign(Object.assign({},o),{targetSnapshot:e}))))}(this.rootComponentType,this.config,e=>this.serializeUrl(e),this.paramsInheritanceStrategy,this.relativeLinkResolution),bd(e=>{"eager"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(e.urlAfterRedirects,e),this.browserUrlTree=e.urlAfterRedirects);const i=new Dd(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.next(i)}));if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:i,extractedUrl:s,source:r,restoredState:n,extras:o}=e,a=new wd(i,this.serializeUrl(s),r,n);t.next(a);const c=kg(s,this.rootComponentType).snapshot;return xh(Object.assign(Object.assign({},e),{targetSnapshot:c,urlAfterRedirects:s,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=e.rawUrl,this.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Yh}),jp(e=>{const{targetSnapshot:t,id:i,extractedUrl:s,rawUrl:r,extras:{skipLocationChange:n,replaceUrl:o}}=e;return this.hooks.beforePreactivation(t,{navigationId:i,appliedUrlTree:s,rawUrlTree:r,skipLocationChange:!!n,replaceUrl:!!o})}),bd(e=>{const t=new xd(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),A(e=>Object.assign(Object.assign({},e),{guards:Dp(e.targetSnapshot,e.currentSnapshot,this.rootContexts)})),function(e,t){return G(i=>{const{targetSnapshot:s,currentSnapshot:r,guards:{canActivateChecks:n,canDeactivateChecks:o}}=i;return 0===o.length&&0===n.length?xh(Object.assign(Object.assign({},i),{guardsResult:!0})):function(e,t,i,s){return k(e).pipe(G(e=>function(e,t,i,s,r){const n=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return n&&0!==n.length?xh(n.map(n=>{const o=xp(n,t,r);let a;if(function(e){return e&&cp(e.canDeactivate)}(o))a=sg(o.canDeactivate(e,t,i,s));else{if(!cp(o))throw new Error("Invalid CanDeactivate guard");a=sg(o(e,t,i,s))}return a.pipe(Td())})).pipe(hp()):xh(!0)}(e.component,e.route,i,t,s)),Td(e=>!0!==e,!0))}(o,s,r,e).pipe(G(i=>i&&function(e){return"boolean"==typeof e}(i)?function(e,t,i,s){return k(t).pipe(hd(t=>zh(function(e,t){return null!==e&&t&&t(new Bd(e)),xh(!0)}(t.route.parent,s),function(e,t){return null!==e&&t&&t(new Vd(e)),xh(!0)}(t.route,s),function(e,t,i){const s=t[t.length-1],r=t.slice(0,t.length-1).reverse().map(e=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)).filter(e=>null!==e).map(t=>jh(()=>xh(t.guards.map(r=>{const n=xp(r,t.node,i);let o;if(function(e){return e&&cp(e.canActivateChild)}(n))o=sg(n.canActivateChild(s,e));else{if(!cp(n))throw new Error("Invalid CanActivateChild guard");o=sg(n(s,e))}return o.pipe(Td())})).pipe(hp())));return xh(r).pipe(hp())}(e,t.path,i),function(e,t,i){const s=t.routeConfig?t.routeConfig.canActivate:null;return s&&0!==s.length?xh(s.map(s=>jh(()=>{const r=xp(s,t,i);let n;if(function(e){return e&&cp(e.canActivate)}(r))n=sg(r.canActivate(t,e));else{if(!cp(r))throw new Error("Invalid CanActivate guard");n=sg(r(t,e))}return n.pipe(Td())}))).pipe(hp()):xh(!0)}(e,t.route,i))),Td(e=>!0!==e,!0))}(s,n,e,t):xh(i)),A(e=>Object.assign(Object.assign({},i),{guardsResult:e})))})}(this.ngModule.injector,e=>this.triggerEvent(e)),bd(e=>{if(lp(e.guardsResult)){const t=qd(`Redirecting to "${this.serializeUrl(e.guardsResult)}"`);throw t.url=e.guardsResult,t}const t=new kd(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);this.triggerEvent(t)}),nd(e=>!!e.guardsResult||(this.restoreHistory(e),this.cancelNavigationTransition(e,""),!1)),jp(e=>{if(e.guards.canActivateChecks.length)return xh(e).pipe(bd(e=>{const t=new Fd(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),$h(e=>{let t=!1;return xh(e).pipe(function(e,t){return G(i=>{const{targetSnapshot:s,guards:{canActivateChecks:r}}=i;if(!r.length)return xh(i);let n=0;return k(r).pipe(hd(i=>function(e,t,i,s){return function(e,t,i,s){const r=Object.keys(e);if(0===r.length)return xh({});const n={};return k(r).pipe(G(r=>function(e,t,i,s){const r=xp(e,t,s);return sg(r.resolve?r.resolve(t,i):r(t,i))}(e[r],t,i,s).pipe(bd(e=>{n[r]=e}))),dd(1),G(()=>Object.keys(n).length===r.length?xh(n):Yh))}(e._resolve,e,t,s).pipe(A(t=>(e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),Ug(e,i).resolve),null)))}(i.route,s,e,t)),bd(()=>n++),dd(1),G(e=>n===r.length?xh(i):Yh))})}(this.paramsInheritanceStrategy,this.ngModule.injector),bd({next:()=>t=!0,complete:()=>{t||(this.restoreHistory(e),this.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),bd(e=>{const t=new Ud(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}))}),jp(e=>{const{targetSnapshot:t,id:i,extractedUrl:s,rawUrl:r,extras:{skipLocationChange:n,replaceUrl:o}}=e;return this.hooks.afterPreactivation(t,{navigationId:i,appliedUrlTree:s,rawUrlTree:r,skipLocationChange:!!n,replaceUrl:!!o})}),A(e=>{const t=function(e,t,i){const s=Yg(e,t._root,i?i._root:void 0);return new xg(s,t)}(this.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:t})}),bd(e=>{this.currentUrlTree=e.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl),this.routerState=e.targetRouterState,"deferred"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,e),this.browserUrlTree=e.urlAfterRedirects)}),((e,t,i)=>A(s=>(new np(t,s.targetRouterState,s.currentRouterState,i).activate(e),s)))(this.rootContexts,this.routeReuseStrategy,e=>this.triggerEvent(e)),bd({next(){i=!0},complete(){i=!0}}),function(e){return t=>t.lift(new Ad(e))}(()=>{if(!i&&!s){const t=`Navigation ID ${e.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(e),this.cancelNavigationTransition(e,t)):this.cancelNavigationTransition(e,t)}this.currentNavigation=null}),cd(i=>{if(s=!0,function(e){return e&&e[Qd]}(i)){const s=lp(i.url);s||(this.navigated=!0,this.restoreHistory(e,!0));const r=new Md(e.id,this.serializeUrl(e.extractedUrl),i.message);t.next(r),s?setTimeout(()=>{const t=this.urlHandlingStrategy.merge(i.url,this.rawUrlTree);this.scheduleNavigation(t,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{this.restoreHistory(e,!0);const s=new Ld(e.id,this.serializeUrl(e.extractedUrl),i);t.next(s);try{e.resolve(this.errorHandler(i))}catch(r){e.reject(r)}}return Yh}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const t=this.extractLocationChangeInfoFromEvent(e);this.shouldScheduleNavigation(this.lastLocationChangeInfo,t)&&setTimeout(()=>{const{source:e,state:i,urlTree:s}=t,r={replaceUrl:!0};if(i){const e=Object.assign({},i);delete e.navigationId,delete e.\u0275routerPageId,0!==Object.keys(e).length&&(r.state=e)}this.scheduleNavigation(s,e,i,r)},0),this.lastLocationChangeInfo=t}))}extractLocationChangeInfoFromEvent(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(e,t){if(!e)return!0;const i=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!i||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){gp(e),this.config=e.map(mp),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,t={}){const{relativeTo:i,queryParams:s,fragment:r,queryParamsHandling:n,preserveFragment:o}=t,a=i||this.routerState.root,c=o?this.currentUrlTree.fragment:r;let l=null;switch(n){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=s||null}return null!==l&&(l=this.removeEmptyProps(l)),function(e,t,i,s,r){if(0===i.length)return Qg(t.root,t.root,t,s,r);const n=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Xg(!0,0,e);let t=0,i=!1;const s=e.reduce((e,s,r)=>{if("object"==typeof s&&null!=s){if(s.outlets){const t={};return ig(s.outlets,(e,i)=>{t[i]="string"==typeof e?e.split("/"):e}),[...e,{outlets:t}]}if(s.segmentPath)return[...e,s.segmentPath]}return"string"!=typeof s?[...e,s]:0===r?(s.split("/").forEach((s,r)=>{0==r&&"."===s||(0==r&&""===s?i=!0:".."===s?t++:""!=s&&e.push(s))}),e):[...e,s]},[]);return new Xg(i,t,s)}(i);if(n.toRoot())return Qg(t.root,new hg([],{}),t,s,r);const o=function(e,t,i){if(e.isAbsolute)return new Zg(t.root,!0,0);if(-1===i.snapshot._lastPathIndex){const e=i.snapshot._urlSegment;return new Zg(e,e===t.root,0)}const s=jg(e.commands[0])?0:1;return function(e,t,i){let s=e,r=t,n=i;for(;n>r;){if(n-=r,s=s.parent,!s)throw new Error("Invalid number of '../'");r=s.segments.length}return new Zg(s,!1,r-n)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+s,e.numberOfDoubleDots)}(n,t,e),a=o.processChildren?ep(o.segmentGroup,o.index,n.commands):Jg(o.segmentGroup,o.index,n.commands);return Qg(o.segmentGroup,a,t,s,r)}(a,this.currentUrlTree,e,l,null!=c?c:null)}navigateByUrl(e,t={skipLocationChange:!1}){const i=lp(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,t)}navigate(e,t={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const i=e[t];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let t;try{t=this.urlSerializer.parse(e)}catch(i){t=this.malformedUriErrorHandler(i,this.urlSerializer,e)}return t}isActive(e,t){let i;if(i=!0===t?Object.assign({},nf):!1===t?Object.assign({},of):t,lp(e))return og(this.currentUrlTree,e,i);const s=this.parseUrl(e);return og(this.currentUrlTree,s,i)}removeEmptyProps(e){return Object.keys(e).reduce((t,i)=>{const s=e[i];return null!=s&&(t[i]=s),t},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new Pd(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(e,t,i,s,r){var n,o;if(this.disposed)return Promise.resolve(!1);const a=this.getTransition(),c="imperative"!==t&&"imperative"===(null==a?void 0:a.source),l=(this.lastSuccessfulId===a.id||this.currentNavigation?a.rawUrl:a.urlAfterRedirects).toString()===e.toString();if(c&&l)return Promise.resolve(!0);let u,h,d;r?(u=r.resolve,h=r.reject,d=r.promise):d=new Promise((e,t)=>{u=e,h=t});const g=++this.navigationId;let p;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),p=i&&i.\u0275routerPageId?i.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(n=this.browserPageId)&&void 0!==n?n:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):p=0,this.setTransition({id:g,targetPageId:p,source:t,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:s,resolve:u,reject:h,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(e=>Promise.reject(e))}setBrowserUrl(e,t){const i=this.urlSerializer.serialize(e),s=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(i)||t.extras.replaceUrl?this.location.replaceState(i,"",s):this.location.go(i,"",s)}restoreHistory(e,t=!1){var i,s;if("computed"===this.canceledNavigationResolution){const t=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===t?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===t&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(t)}else"replace"===this.canceledNavigationResolution&&(t&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,t){const i=new Md(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}return e.\u0275fac=function(t){return new(t||e)(gs(Qi),gs(pg),gs(Jp),gs(Iu),gs(go),gs(Zl),gs(yl),gs(void 0))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),cf=(()=>{class e{constructor(e,t,i,s,r){this.router=e,this.route=t,this.commands=[],this.onChanges=new b,null==i&&s.setAttribute(r.nativeElement,"tabindex","0")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}onClick(){const e={skipLocationChange:uf(this.skipLocationChange),replaceUrl:uf(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:uf(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(Mo(af),Mo(Fg),zi("tabindex"),Mo(ka),Mo(La))},e.\u0275dir=Qe({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&Vo("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ct]}),e})(),lf=(()=>{class e{constructor(e,t,i){this.router=e,this.route=t,this.locationStrategy=i,this.commands=[],this.onChanges=new b,this.subscription=e.events.subscribe(e=>{e instanceof Pd&&this.updateTargetUrlAndHref()})}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,t,i,s,r){if(0!==e||t||i||s||r||"string"==typeof this.target&&"_self"!=this.target)return!0;const n={skipLocationChange:uf(this.skipLocationChange),replaceUrl:uf(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,n),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:uf(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(Mo(af),Mo(Fg),Mo(Eu))},e.\u0275dir=Qe({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&Vo("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(ca("href",t.href,er),No("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[ct]}),e})();function uf(e){return""===e||!!e}let hf=(()=>{class e{constructor(e,t,i,s,r,n){this.router=e,this.element=t,this.renderer=i,this.cdr=s,this.link=r,this.linkWithHref=n,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.routerEventsSubscription=e.events.subscribe(e=>{e instanceof Pd&&this.update()})}ngAfterContentInit(){xh(this.links.changes,this.linksWithHrefs.changes,xh(null)).pipe(V()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var e;null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe();const t=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(e=>!!e).map(e=>e.onChanges);this.linkInputChangesSubscription=k(t).pipe(V()).subscribe(e=>{this.isActive!==this.isLinkActive(this.router)(e)&&this.update()})}set routerLinkActive(e){const t=Array.isArray(e)?e:e.split(" ");this.classes=t.filter(e=>!!e)}ngOnChanges(e){this.update()}ngOnDestroy(){var e;this.routerEventsSubscription.unsubscribe(),null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this.isActive!==e&&(this.isActive=e,this.cdr.markForCheck(),this.classes.forEach(t=>{e?this.renderer.addClass(this.element.nativeElement,t):this.renderer.removeClass(this.element.nativeElement,t)}))})}isLinkActive(e){const t=function(e){return!!e.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>e.isActive(i.urlTree,t)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.linkWithHref&&e(this.linkWithHref)||this.links.some(e)||this.linksWithHrefs.some(e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(af),Mo(La),Mo(ka),Mo(nc),Mo(cf,8),Mo(lf,8))},e.\u0275dir=Qe({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(e,t,i){if(1&e&&(sl(i,cf,5),sl(i,lf,5)),2&e){let e;tl(e=rl())&&(t.links=e),tl(e=rl())&&(t.linksWithHrefs=e)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[ct]}),e})(),df=(()=>{class e{constructor(e,t,i,s,r){this.parentContexts=e,this.location=t,this.resolver=i,this.changeDetector=r,this.activated=null,this._activatedRoute=null,this.activateEvents=new Vc,this.deactivateEvents=new Vc,this.name=s||Kd,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const i=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),s=this.parentContexts.getOrCreateContext(this.name).children,r=new gf(e,s,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)(Mo(Jp),Mo(Sc),Mo(_a),zi("name"),Mo(nc))},e.\u0275dir=Qe({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e})();class gf{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Fg?this.route:e===Jp?this.childContexts:this.parent.get(e,t)}}class pf{}class ff{preload(e,t){return xh(null)}}let mf=(()=>{class e{constructor(e,t,i,s,r){this.router=e,this.injector=s,this.preloadingStrategy=r,this.loader=new Xp(t,i,t=>e.triggerEvent(new Hd(t)),t=>e.triggerEvent(new Gd(t)))}setUpPreloading(){this.subscription=this.router.events.pipe(nd(e=>e instanceof Pd),hd(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(pc);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,t){const i=[];for(const s of t)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const e=s._loadedConfig;i.push(this.processRoutes(e.module,e.routes))}else s.loadChildren&&!s.canLoad?i.push(this.preloadConfig(e,s)):s.children&&i.push(this.processRoutes(e,s.children));return k(i).pipe(V(),A(e=>{}))}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>(t._loadedConfig?xh(t._loadedConfig):this.loader.load(e.injector,t)).pipe(G(e=>(t._loadedConfig=e,this.processRoutes(e.module,e.routes)))))}}return e.\u0275fac=function(t){return new(t||e)(gs(af),gs(Zl),gs(yl),gs(go),gs(pf))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),Sf=(()=>{class e{constructor(e,t,i={}){this.router=e,this.viewportScroller=t,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof wd?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Pd&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Yd&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.router.triggerEvent(new Yd(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(gs(af),gs(th),gs(void 0))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const Ef=new ji("ROUTER_CONFIGURATION"),vf=new ji("ROUTER_FORROOT_GUARD"),Rf=[Iu,{provide:pg,useClass:fg},{provide:af,useFactory:function(e,t,i,s,r,n,o,a={},c,l){const u=new af(null,e,t,i,s,r,n,eg(o));return c&&(u.urlHandlingStrategy=c),l&&(u.routeReuseStrategy=l),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(a,u),a.enableTracing&&u.events.subscribe(e=>{var t,i;null===(t=console.group)||void 0===t||t.call(console,`Router Event: ${e.constructor.name}`),console.log(e.toString()),console.log(e),null===(i=console.groupEnd)||void 0===i||i.call(console)}),u},deps:[pg,Jp,Iu,go,Zl,yl,qp,Ef,[class{},new Rs],[$p,new Rs]]},Jp,{provide:Fg,useFactory:function(e){return e.routerState.root},deps:[af]},{provide:Zl,useClass:tu},mf,ff,class{preload(e,t){return t().pipe(cd(()=>xh(null)))}},{provide:Ef,useValue:{enableTracing:!1}}];function Of(){return new Yl("Router",af)}let Tf=(()=>{class e{constructor(e,t){}static forRoot(t,i){return{ngModule:e,providers:[Rf,yf(t),{provide:vf,useFactory:Cf,deps:[[af,new Rs,new Os]]},{provide:Ef,useValue:i||{}},{provide:Eu,useFactory:bf,deps:[lu,[new vs(Ru),new Rs],Ef]},{provide:Sf,useFactory:If,deps:[af,th,Ef]},{provide:pf,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:ff},{provide:Yl,multi:!0,useFactory:Of},[Af,{provide:cl,multi:!0,useFactory:Nf,deps:[Af]},{provide:wf,useFactory:_f,deps:[Af]},{provide:fl,multi:!0,useExisting:wf}]]}}static forChild(t){return{ngModule:e,providers:[yf(t)]}}}return e.\u0275fac=function(t){return new(t||e)(gs(vf,8),gs(af,8))},e.\u0275mod=je({type:e}),e.\u0275inj=ge({}),e})();function If(e,t,i){return i.scrollOffset&&t.setOffset(i.scrollOffset),new Sf(e,t,i)}function bf(e,t,i={}){return i.useHash?new Tu(e,t):new Ou(e,t)}function Cf(e){return"guarded"}function yf(e){return[{provide:$i,multi:!0,useValue:e},{provide:qp,multi:!0,useValue:e}]}let Af=(()=>{class e{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new b}appInitializer(){return this.injector.get(hu,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let e=null;const t=new Promise(t=>e=t),i=this.injector.get(af),s=this.injector.get(Ef);return"disabled"===s.initialNavigation?(i.setUpLocationChangeListener(),e(!0)):"enabled"===s.initialNavigation||"enabledBlocking"===s.initialNavigation?(i.hooks.afterPreactivation=()=>this.initNavigation?xh(null):(this.initNavigation=!0,e(!0),this.resultOfPreactivationDone),i.initialNavigation()):e(!0),t})}bootstrapListener(e){const t=this.injector.get(Ef),i=this.injector.get(mf),s=this.injector.get(Sf),r=this.injector.get(af),n=this.injector.get(ql);e===n.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&r.initialNavigation(),i.setUpPreloading(),s.init(),r.resetRootComponentType(n.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(t){return new(t||e)(gs(go))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();function Nf(e){return e.appInitializer.bind(e)}function _f(e){return e.bootstrapListener.bind(e)}const wf=new ji("Router Initializer");var Pf=(()=>(function(e){e.ALL="all",e.BUILD="build-modal",e.IMPORT="import-modal",e.EXPORT="export-modal",e.HARD_RESET="hard-reset-modal",e.INFO="info-modal",e.OPTIONS="options-modal",e.CONFIRM="confirm-modal",e.INPUT="input-modal",e.ROYAL="royal-modal",e.MISSION="mission-modal",e.MARKET="market-modal",e.WORK_MANAGEMENT="work-management-modal",e.TUTORIAL="tutorial-modal",e.CHANGELOG="changelog-modal",e.RESOURCE_MANAGEMENT="resource-management-modal",e.RECIPE="recipe-modal",e.WORLD="world-modal",e.WORLD_BUILD="world-build-modal",e.FIGHT_REPORT="fight-report-modal",e.ABDICATION="abdication-modal",e.ASCENSION="ascension-modal",e.RESEARCH_UNLOCK="research-unlock-modal",e.SHIPYARD="shipyard-modal",e.FESTIVAL="festival-modal",e.ERROR="error-modal"}(Pf||(Pf={})),Pf))(),Mf=(()=>(function(e){e[e.WEATHER=0]="WEATHER",e[e.MARKET=1]="MARKET",e[e.MANAGEMENT=2]="MANAGEMENT",e[e.CRAFTING=3]="CRAFTING",e[e.RESEARCH=4]="RESEARCH",e[e.ARMY=5]="ARMY",e[e.RELIGION=6]="RELIGION",e[e.FORT=7]="FORT",e[e.SEA=8]="SEA",e[e.FIELD=9]="FIELD",e[e.MOUNTAINS=10]="MOUNTAINS",e[e.PLATEAU=11]="PLATEAU",e[e.HOUSE=12]="HOUSE",e[e.SHRINE=13]="SHRINE",e[e.CHURCH=14]="CHURCH",e[e.TAILOR=15]="TAILOR",e[e.TAVERN=16]="TAVERN",e[e.BAKERY=17]="BAKERY",e[e.MARKETPLACE=18]="MARKETPLACE",e[e.BARRACKS=19]="BARRACKS",e[e.STOCKADE=20]="STOCKADE",e[e.WOODEN_TOWER=21]="WOODEN_TOWER",e[e.STONE_TOWER=22]="STONE_TOWER",e[e.STASH=23]="STASH",e[e.FORESTER=24]="FORESTER",e[e.SAWMILL=25]="SAWMILL",e[e.HUNTER=26]="HUNTER",e[e.TANNERY=27]="TANNERY",e[e.WINDMILL=28]="WINDMILL",e[e.FARM=29]="FARM",e[e.PASTURE=30]="PASTURE",e[e.BUTCHER=31]="BUTCHER",e[e.BREWERY=32]="BREWERY",e[e.WINERY=33]="WINERY",e[e.COTTON_MILL=34]="COTTON_MILL",e[e.PIT_MINE=35]="PIT_MINE",e[e.GEOLOGIST=36]="GEOLOGIST",e[e.SMITHY=37]="SMITHY",e[e.MINT=38]="MINT",e[e.FISHERS_HUT=39]="FISHERS_HUT",e[e.CALENDAR=40]="CALENDAR",e[e.FIRE=41]="FIRE",e[e.URBAN_PLANNING=42]="URBAN_PLANNING",e[e.ALCOHOL=43]="ALCOHOL",e[e.GOLD=44]="GOLD",e[e.SILVER=45]="SILVER",e[e.BRONZE=46]="BRONZE",e[e.IRON=47]="IRON",e[e.STEEL=48]="STEEL",e[e.ADVANCED_ORE_PROCESSING=49]="ADVANCED_ORE_PROCESSING",e[e.BUFFS=50]="BUFFS",e[e.COTTON=51]="COTTON",e[e.BARLEY=52]="BARLEY",e[e.HOPS=53]="HOPS",e[e.BUILT_QUARRY=54]="BUILT_QUARRY",e[e.BUILT_SMITHY=55]="BUILT_SMITHY",e[e.HUMAN_RESOURCES=56]="HUMAN_RESOURCES",e[e.FISH_FOOD=57]="FISH_FOOD",e[e.SPECIALISED_PRODUCTION=58]="SPECIALISED_PRODUCTION",e[e.MANUFACTURE=59]="MANUFACTURE",e[e.STONEMASON=60]="STONEMASON",e[e.LONGHOUSE=61]="LONGHOUSE",e[e.HERITAGE=62]="HERITAGE",e[e.HERBALISM=63]="HERBALISM",e[e.EMBASSY=64]="EMBASSY",e[e.CARTOGRAPHY=65]="CARTOGRAPHY",e[e.PAPER_MILL=66]="PAPER_MILL",e[e.DEEP_MINE=67]="DEEP_MINE",e[e.LOGISTICS=68]="LOGISTICS",e[e.PRODUCTION_ZONES=69]="PRODUCTION_ZONES",e[e.BARN=70]="BARN",e[e.KITCHEN=71]="KITCHEN",e[e.CLAY_PIT=72]="CLAY_PIT",e[e.TUDOR_HOUSE=73]="TUDOR_HOUSE",e[e.NAVY=74]="NAVY",e[e.PIER=75]="PIER",e[e.BOAT_BUILDER=76]="BOAT_BUILDER",e[e.HARBOUR=77]="HARBOUR",e[e.SHIPYARD=78]="SHIPYARD",e[e.BRIGANTINE=79]="BRIGANTINE",e[e.GALLEON=80]="GALLEON",e[e.LIGHTHOUSE=81]="LIGHTHOUSE",e[e.CARTOGRAPHER=82]="CARTOGRAPHER",e[e.SETTLEMENT=83]="SETTLEMENT",e[e.SCHOLARS_LAB=84]="SCHOLARS_LAB",e[e.TAX_COLLECTOR=85]="TAX_COLLECTOR",e[e.JEWELRY=86]="JEWELRY",e[e.BUILDERS_GUILD=87]="BUILDERS_GUILD"}(Mf||(Mf={})),Mf))(),Lf=(()=>(function(e){e[e.ALL=0]="ALL",e[e.CONSTRUCTION=1]="CONSTRUCTION",e[e.DECONSTRUCTION=2]="DECONSTRUCTION",e[e.HUT=3]="HUT",e[e.HOUSE=4]="HOUSE",e[e.MARKETPLACE=5]="MARKETPLACE",e[e.WAREHOUSE=6]="WAREHOUSE",e[e.SMITHY=7]="SMITHY",e[e.BAKERY=8]="BAKERY",e[e.WORKSHOP=9]="WORKSHOP",e[e.SHRINE=10]="SHRINE",e[e.TAILOR=11]="TAILOR",e[e.BREWERY=12]="BREWERY",e[e.TAVERN=13]="TAVERN",e[e.CHURCH=14]="CHURCH",e[e.STOCKADE=15]="STOCKADE",e[e.BARRACKS=16]="BARRACKS",e[e.TRAINING_SQUARE=17]="TRAINING_SQUARE",e[e.WOODEN_TOWER=18]="WOODEN_TOWER",e[e.STONE_TOWER=19]="STONE_TOWER",e[e.STASH=20]="STASH",e[e.LOGGERS_HUT=21]="LOGGERS_HUT",e[e.SAWMILL=22]="SAWMILL",e[e.FORESTER=23]="FORESTER",e[e.HUNTER_LODGE=24]="HUNTER_LODGE",e[e.GATHERER=25]="GATHERER",e[e.TANNERY=26]="TANNERY",e[e.FARM=27]="FARM",e[e.FIELD=28]="FIELD",e[e.ORCHARD=29]="ORCHARD",e[e.PASTURE=30]="PASTURE",e[e.WINDMILL=31]="WINDMILL",e[e.BUTCHER=32]="BUTCHER",e[e.COTTON_MILL=33]="COTTON_MILL",e[e.WINERY=34]="WINERY",e[e.PIT_MINE=35]="PIT_MINE",e[e.QUARRY=36]="QUARRY",e[e.GEOLOGIST=37]="GEOLOGIST",e[e.STONEMASON=38]="STONEMASON",e[e.MINT=39]="MINT",e[e.FISHERS_HUT=40]="FISHERS_HUT",e[e.SCHOOL_OF_FISH=41]="SCHOOL_OF_FISH",e[e.SHARKS=42]="SHARKS",e[e.STONEHENGE=43]="STONEHENGE",e[e.PYRAMID=44]="PYRAMID",e[e.HANGING_GARDEN=45]="HANGING_GARDEN",e[e.COLOSSUS=46]="COLOSSUS",e[e.UNDERGROUND_CITY=47]="UNDERGROUND_CITY",e[e.GREAT_LIGHTHOUSE=48]="GREAT_LIGHTHOUSE",e[e.SACRED_GROVE=49]="SACRED_GROVE",e[e.ASCENSION_TEMPLE=50]="ASCENSION_TEMPLE",e[e.MANUFACTURE=51]="MANUFACTURE",e[e.LONGHOUSE=52]="LONGHOUSE",e[e.EMBASSY=53]="EMBASSY",e[e.PAPER_MILL=54]="PAPER_MILL",e[e.DEEP_MINE=55]="DEEP_MINE",e[e.GATHERERS_CAMP=56]="GATHERERS_CAMP",e[e.BARN=57]="BARN",e[e.KITCHEN=58]="KITCHEN",e[e.CLAY_PIT=59]="CLAY_PIT",e[e.TUDOR_HOUSE=60]="TUDOR_HOUSE",e[e.LOGGERS_CAMP=61]="LOGGERS_CAMP",e[e.METEORITE=62]="METEORITE",e[e.BOAT_BUILDER=63]="BOAT_BUILDER",e[e.SHIPYARD=64]="SHIPYARD",e[e.PIER=65]="PIER",e[e.HARBOUR=66]="HARBOUR",e[e.LIGHTHOUSE=67]="LIGHTHOUSE",e[e.CARTOGRAPHER=68]="CARTOGRAPHER",e[e.SETTLEMENT=69]="SETTLEMENT",e[e.SCHOLARS_LAB=70]="SCHOLARS_LAB",e[e.TAX_COLLECTOR=71]="TAX_COLLECTOR",e[e.BUILDERS_GUILD=72]="BUILDERS_GUILD"}(Lf||(Lf={})),Lf))(),Df=(()=>(function(e){e[e.NOTHING=0]="NOTHING",e[e.FOOD=1]="FOOD",e[e.LOG=2]="LOG",e[e.BRUSHWOOD=3]="BRUSHWOOD",e[e.STONE=4]="STONE",e[e.FUR=5]="FUR",e[e.WHEAT=6]="WHEAT",e[e.BARLEY=7]="BARLEY",e[e.HOP=8]="HOP",e[e.COTTON=9]="COTTON",e[e.HAY=10]="HAY",e[e.CHICKEN=11]="CHICKEN",e[e.COW=12]="COW",e[e.PIG=13]="PIG",e[e.HORSE=14]="HORSE",e[e.COAL=15]="COAL",e[e.GOLD_ORE=16]="GOLD_ORE",e[e.SILVER_ORE=17]="SILVER_ORE",e[e.COPPER_ORE=18]="COPPER_ORE",e[e.TIN_ORE=19]="TIN_ORE",e[e.IRON_ORE=20]="IRON_ORE",e[e.PLANK=21]="PLANK",e[e.CUT_STONE=22]="CUT_STONE",e[e.FUEL=23]="FUEL",e[e.FLOUR=24]="FLOUR",e[e.FABRIC=25]="FABRIC",e[e.LEATHER=26]="LEATHER",e[e.COINS=27]="COINS",e[e.COPPER=28]="COPPER",e[e.GOLD=29]="GOLD",e[e.SILVER=30]="SILVER",e[e.TIN=31]="TIN",e[e.BRONZE=32]="BRONZE",e[e.IRON=33]="IRON",e[e.STEEL=34]="STEEL",e[e.BERRY=35]="BERRY",e[e.MUSHROOM=36]="MUSHROOM",e[e.FISH=37]="FISH",e[e.APPLE=38]="APPLE",e[e.GRAPE=39]="GRAPE",e[e.BREAD=40]="BREAD",e[e.MEAT=41]="MEAT",e[e.EGG=42]="EGG",e[e.MILK=43]="MILK",e[e.COOKED_MEAT=44]="COOKED_MEAT",e[e.VEGETABLE_SOUP=45]="VEGETABLE_SOUP",e[e.MEAT_SOUP=46]="MEAT_SOUP",e[e.BEER=47]="BEER",e[e.WINE=48]="WINE",e[e.CLOTHES=49]="CLOTHES",e[e.BOW=50]="BOW",e[e.PICKAXE=51]="PICKAXE",e[e.SHOVEL=52]="SHOVEL",e[e.AXE=53]="AXE",e[e.SPEAR=54]="SPEAR",e[e.HAMMER=55]="HAMMER",e[e.SWORD=56]="SWORD",e[e.SHIELD=57]="SHIELD",e[e.LEATHER_ARMOR=58]="LEATHER_ARMOR",e[e.LIGHT_ARMOR=59]="LIGHT_ARMOR",e[e.HEAVY_ARMOR=60]="HEAVY_ARMOR",e[e.FISH_FOOD=61]="FISH_FOOD",e[e.CHEESE=62]="CHEESE",e[e.HERBS=63]="HERBS",e[e.HERBAL_MEDICINE=64]="HERBAL_MEDICINE",e[e.COOKED_FISH=65]="COOKED_FISH",e[e.SHEEP=66]="SHEEP",e[e.WOOL=67]="WOOL",e[e.PAPER=68]="PAPER",e[e.GLASS=69]="GLASS",e[e.CLAY=70]="CLAY",e[e.POTTERY=71]="POTTERY",e[e.BRICKS=72]="BRICKS",e[e.OMELETTE=73]="OMELETTE",e[e.PIE=74]="PIE",e[e.NAILS=75]="NAILS",e[e.MAP=76]="MAP",e[e.CANNON=77]="CANNON",e[e.BOUILLABAISSE=78]="BOUILLABAISSE",e[e.GEMS=79]="GEMS",e[e.JEWELRY=80]="JEWELRY"}(Df||(Df={})),Df))();!function(e){e.values=function(){return Object.keys(e).filter(e=>isNaN(e)&&"values"!==e)}}(Df||(Df={}));var xf=(()=>(function(e){e[e.MOTIVATION_SPEECH=0]="MOTIVATION_SPEECH",e[e.ROYAL_PROPHECY=1]="ROYAL_PROPHECY",e[e.HERITAGE=2]="HERITAGE",e[e.FAMILY_JEWELS=3]="FAMILY_JEWELS",e[e.KING_OF_THE_FOREST=4]="KING_OF_THE_FOREST",e[e.KING_OF_THE_SEAS=5]="KING_OF_THE_SEAS",e[e.KING_OF_THE_PEOPLE=6]="KING_OF_THE_PEOPLE",e[e.KING_OF_THE_WAR=7]="KING_OF_THE_WAR",e[e.CALL_TO_ARMS=8]="CALL_TO_ARMS",e[e.UNITE_WITH_THE_PEOPLE=9]="UNITE_WITH_THE_PEOPLE",e[e.JESTER=10]="JESTER",e[e.ROYAL_ORDERS=11]="ROYAL_ORDERS",e[e.ROYAL_ARCHIVES=12]="ROYAL_ARCHIVES",e[e.ASTROLOGICAL_NOTE=13]="ASTROLOGICAL_NOTE",e[e.ROYAL_FESTIVAL=14]="ROYAL_FESTIVAL",e[e.ROYAL_RESERVE=15]="ROYAL_RESERVE",e[e.ANCIENT_SEA_MAPS=16]="ANCIENT_SEA_MAPS",e[e.ROYAL_GARDENS=17]="ROYAL_GARDENS",e[e.HIRE_MERCENARIES=18]="HIRE_MERCENARIES",e[e.HIRE_PIRATES=19]="HIRE_PIRATES",e[e.ANCIENT_PROTECTION=20]="ANCIENT_PROTECTION",e[e.ROYAL_TRADITIONS=21]="ROYAL_TRADITIONS"}(xf||(xf={})),xf))(),kf=(()=>(function(e){e[e.MANAGEMENT=0]="MANAGEMENT",e[e.STONE_AXE=1]="STONE_AXE",e[e.STONE_PICKAXE=2]="STONE_PICKAXE",e[e.STONE_SHOVEL=3]="STONE_SHOVEL",e[e.STONE_HAMMER=4]="STONE_HAMMER",e[e.HUNTING=5]="HUNTING",e[e.FIRE=6]="FIRE",e[e.BIGGER_FIRE=7]="BIGGER_FIRE",e[e.COOKING=8]="COOKING",e[e.TRADE=9]="TRADE",e[e.ALCOHOL=10]="ALCOHOL",e[e.WONDER_BUILDINGS=11]="WONDER_BUILDINGS",e[e.TRADE_ROUTES=12]="TRADE_ROUTES",e[e.BUFF_PRODUCTION=13]="BUFF_PRODUCTION",e[e.STONE_SPEAR=14]="STONE_SPEAR",e[e.BOW=15]="BOW",e[e.BARRACKS=16]="BARRACKS",e[e.WOODEN_DEFENCES=17]="WOODEN_DEFENCES",e[e.STONE_DEFENCES=18]="STONE_DEFENCES",e[e.STASH=19]="STASH",e[e.SCIENTIFIC_METHOD=20]="SCIENTIFIC_METHOD",e[e.FORESIGHT=21]="FORESIGHT",e[e.CALENDAR=22]="CALENDAR",e[e.WEATHER=23]="WEATHER",e[e.HISTORY=24]="HISTORY",e[e.URBAN_PLANNING=25]="URBAN_PLANNING",e[e.MATHEMATICS=26]="MATHEMATICS",e[e.PROSPECTING_FOR_ORE=27]="PROSPECTING_FOR_ORE",e[e.ADVANCED_PROSPECTING=28]="ADVANCED_PROSPECTING",e[e.MASTER_PROSPECTING=29]="MASTER_PROSPECTING",e[e.SAWMILL=30]="SAWMILL",e[e.MINING=31]="MINING",e[e.PIT_MINE=32]="PIT_MINE",e[e.UNDERGROUND_MINE=33]="UNDERGROUND_MINE",e[e.WINDMILL=34]="WINDMILL",e[e.MORTAR=35]="MORTAR",e[e.HOUSE=36]="HOUSE",e[e.TANNERY=37]="TANNERY",e[e.FABRIC=38]="FABRIC",e[e.TAILORING=39]="TAILORING",e[e.ORE_PROCESSING=40]="ORE_PROCESSING",e[e.ADVANCED_ORE_PROCESSING=41]="ADVANCED_ORE_PROCESSING",e[e.MASTER_ORE_PROCESSING=42]="MASTER_ORE_PROCESSING",e[e.COINS_MINTING=43]="COINS_MINTING",e[e.METALLURGY=44]="METALLURGY",e[e.ADVANCED_METALLURGY=45]="ADVANCED_METALLURGY",e[e.PICKAXE_DESIGN=46]="PICKAXE_DESIGN",e[e.AGRICULTURE=47]="AGRICULTURE",e[e.FORESTRY=48]="FORESTRY",e[e.FISHING=49]="FISHING",e[e.ANIMALS=50]="ANIMALS",e[e.COTTON=51]="COTTON",e[e.FERTILIZER=52]="FERTILIZER",e[e.HUMAN_RESOURCES=53]="HUMAN_RESOURCES",e[e.FISH_FOOD=54]="FISH_FOOD",e[e.SPECIALISED_PRODUCTION=55]="SPECIALISED_PRODUCTION",e[e.LONGHOUSE=56]="LONGHOUSE",e[e.HERBAL_MEDICINE=57]="HERBAL_MEDICINE",e[e.HERBALISM=58]="HERBALISM",e[e.CARTOGRAPHY=59]="CARTOGRAPHY",e[e.PARCHMENT=60]="PARCHMENT",e[e.PAPER_MILL=61]="PAPER_MILL",e[e.DEEP_MINE=62]="DEEP_MINE",e[e.ADVANCED_MATHEMATICS=63]="ADVANCED_MATHEMATICS",e[e.IMPROVED_FORESIGHT=64]="IMPROVED_FORESIGHT",e[e.LOGISTICS=65]="LOGISTICS",e[e.PRODUCTION_ZONES=66]="PRODUCTION_ZONES",e[e.CROPS_STORAGE=67]="CROPS_STORAGE",e[e.COPPER_TOOLS=68]="COPPER_TOOLS",e[e.BRONZE_TOOLS=69]="BRONZE_TOOLS",e[e.IRON_TOOLS=70]="IRON_TOOLS",e[e.BAKERY=71]="BAKERY",e[e.KITCHEN=72]="KITCHEN",e[e.DIGGING=73]="DIGGING",e[e.POTTERY=74]="POTTERY",e[e.BRICKS=75]="BRICKS",e[e.TUDOR_HOUSE=76]="TUDOR_HOUSE",e[e.IMPROVED_COOKING=77]="IMPROVED_COOKING",e[e.BOAT_BUILDING=78]="BOAT_BUILDING",e[e.CANNON=79]="CANNON",e[e.GALLEON=80]="GALLEON",e[e.BIGGER_SHIPS=81]="BIGGER_SHIPS",e[e.SEA_NAVIGATION=82]="SEA_NAVIGATION",e[e.SEA_CARTOGRAPHY=83]="SEA_CARTOGRAPHY",e[e.SEA_CUISINE=84]="SEA_CUISINE",e[e.SETTLEMENT=85]="SETTLEMENT",e[e.SCHOLAR=86]="SCHOLAR",e[e.TAX=87]="TAX",e[e.JEWELRY=88]="JEWELRY",e[e.BUILDERS_GUILD=89]="BUILDERS_GUILD"}(kf||(kf={})),kf))(),Ff=(()=>(function(e){e[e.BLESSING=0]="BLESSING",e[e.PREACH=1]="PREACH",e[e.FAITH_SHIELD=2]="FAITH_SHIELD",e[e.SOLDIER_PRAYER=3]="SOLDIER_PRAYER",e[e.FAITHFUL_RESEARCH=4]="FAITHFUL_RESEARCH",e[e.BABY_BOOM=5]="BABY_BOOM",e[e.LIFE_CYCLE=6]="LIFE_CYCLE",e[e.HOLY_WAR=7]="HOLY_WAR",e[e.PRAY=8]="PRAY"}(Ff||(Ff={})),Ff))(),Uf=(()=>(function(e){e[e.SPY=0]="SPY",e[e.DIVERSION=1]="DIVERSION",e[e.PLUNDER=2]="PLUNDER",e[e.EXPEDITION=3]="EXPEDITION",e[e.CONQUER=4]="CONQUER",e[e.COLONIZE=5]="COLONIZE",e[e.MOVE=6]="MOVE",e[e.BUILD=7]="BUILD",e[e.FISHING=8]="FISHING",e[e.HUNTING=9]="HUNTING",e[e.TREASURE=10]="TREASURE",e[e.CARTOGRAPHY=11]="CARTOGRAPHY",e[e.SEA_BATTLE=12]="SEA_BATTLE",e[e.SEA_PLUNDER=13]="SEA_PLUNDER",e[e.SEA_CONQUER=14]="SEA_CONQUER",e[e.SEA_MOVE=15]="SEA_MOVE"}(Uf||(Uf={})),Uf))(),Hf=(()=>(function(e){e[e.NONE=0]="NONE",e[e.WHEAT=1]="WHEAT",e[e.BARLEY=2]="BARLEY",e[e.HAY=3]="HAY",e[e.HOP=4]="HOP",e[e.COTTON=5]="COTTON",e[e.BERRY=6]="BERRY",e[e.GRAPE=7]="GRAPE",e[e.APPLE=8]="APPLE",e[e.HERBS=9]="HERBS",e[e.MUSHROOM=10]="MUSHROOM"}(Hf||(Hf={})),Hf))(),Gf=(()=>(function(e){e[e.ALL=0]="ALL",e[e.NONE=1]="NONE",e[e.RAW=2]="RAW",e[e.PROCESSED=3]="PROCESSED",e[e.FOOD=4]="FOOD",e[e.TOOLS=5]="TOOLS",e[e.OTHER=6]="OTHER",e[e.WOODEN=7]="WOODEN",e[e.METAL=8]="METAL",e[e.STONE=9]="STONE",e[e.ANIMAL=10]="ANIMAL",e[e.FUEL=11]="FUEL",e[e.CONSUMABLE=12]="CONSUMABLE"}(Gf||(Gf={})),Gf))(),Bf=(()=>(function(e){e[e.NONE=0]="NONE",e[e.FERTILITY=1]="FERTILITY",e[e.NATURE=2]="NATURE",e[e.TECHNOLOGY=3]="TECHNOLOGY",e[e.WAR=4]="WAR"}(Bf||(Bf={})),Bf))(),Wf=(()=>(function(e){e[e.ALL=0]="ALL",e[e.MILITIA=1]="MILITIA",e[e.SPEARMAN=2]="SPEARMAN",e[e.ARCHER=3]="ARCHER",e[e.SWORDSMAN=4]="SWORDSMAN",e[e.LIGHT_CAVALRY=5]="LIGHT_CAVALRY",e[e.SPY=6]="SPY",e[e.COLONIST=7]="COLONIST",e[e.HORSE_ARCHER=8]="HORSE_ARCHER",e[e.BOAT=9]="BOAT",e[e.BRIGANTINE=10]="BRIGANTINE",e[e.GALLEON=11]="GALLEON",e[e.GUARD_TOWER=12]="GUARD_TOWER"}(Wf||(Wf={})),Wf))(),Vf=(()=>(function(e){e[e.NONE=0]="NONE",e[e.OFFENSE=1]="OFFENSE",e[e.DEFENSE=2]="DEFENSE",e[e.ECONOMY=3]="ECONOMY",e[e.PEACE=4]="PEACE"}(Vf||(Vf={})),Vf))(),zf=(()=>(function(e){e[e.SPECIAL=0]="SPECIAL",e[e.PLAYER=1]="PLAYER",e[e.NEUTRAL=2]="NEUTRAL",e[e.EXPEDITION=3]="EXPEDITION",e[e.CLEADAL=4]="CLEADAL",e[e.GRIERIA=5]="GRIERIA",e[e.BOTHIL=6]="BOTHIL",e[e.DOSHOR=7]="DOSHOR",e[e.CREURUS=8]="CREURUS",e[e.ESTRAILA=9]="ESTRAILA",e[e.NONE=10]="NONE",e[e.PIRATES=11]="PIRATES"}(zf||(zf={})),zf))(),Yf=(()=>(function(e){e[e.FLU=0]="FLU",e[e.COLD=1]="COLD",e[e.PNEUMONIA=2]="PNEUMONIA"}(Yf||(Yf={})),Yf))(),Kf=(()=>(function(e){e[e.VILLAGE=0]="VILLAGE",e[e.FORT=1]="FORT",e[e.FOREST=2]="FOREST",e[e.FIELD=3]="FIELD",e[e.MOUNTAINS=4]="MOUNTAINS",e[e.SEA=5]="SEA",e[e.PLATEAU=6]="PLATEAU"}(Kf||(Kf={})),Kf))(),jf=(()=>(function(e){e[e.FISH=0]="FISH",e[e.SHARK=1]="SHARK",e[e.TREASURE=2]="TREASURE",e[e.PIRATES=3]="PIRATES",e[e.PIRATES_BASE=4]="PIRATES_BASE",e[e.WHIRLPOOL=5]="WHIRLPOOL",e[e.CARTOGRAPHY=6]="CARTOGRAPHY"}(jf||(jf={})),jf))(),$f=(()=>(function(e){e[e.FOOD=0]="FOOD",e[e.VARIOUS_FOOD=1]="VARIOUS_FOOD",e[e.MONOTONOUS_FOOD=2]="MONOTONOUS_FOOD",e[e.RAW_FOOD=3]="RAW_FOOD",e[e.CLOTHES=4]="CLOTHES",e[e.FUR_CLOTHES=5]="FUR_CLOTHES",e[e.ALCOHOL=6]="ALCOHOL",e[e.TAX=7]="TAX",e[e.DONATION=8]="DONATION",e[e.FREEZING=9]="FREEZING",e[e.SICKNESS_DEATH=10]="SICKNESS_DEATH",e[e.FESTIVAL=11]="FESTIVAL",e[e.ROYAL_FESTIVAL=12]="ROYAL_FESTIVAL",e[e.RELIGION=13]="RELIGION",e[e.PRAYER=14]="PRAYER",e[e.POPULATION_SIZE=15]="POPULATION_SIZE",e[e.LOW_QUALITY_HOUSING=16]="LOW_QUALITY_HOUSING",e[e.SUCCESSFUL_CONQUER=17]="SUCCESSFUL_CONQUER",e[e.RECENTLY_INVADED=18]="RECENTLY_INVADED",e[e.RECENTLY_CONQUERED=19]="RECENTLY_CONQUERED",e[e.PIRATES_DEFEATED=20]="PIRATES_DEFEATED",e[e.PIRATES_BASE_PRESENT=21]="PIRATES_BASE_PRESENT",e[e.ROYAL_GARDENS=22]="ROYAL_GARDENS"}($f||($f={})),$f))();class Qf{static round(e,t){return e.toFixed(t)}static titleCase(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}static prepareResourceName(e){const t=Df[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: r"+e+")"}static prepareRegionName(e){const t=Kf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: reg"+e+")"}static prepareResourceTypeName(e){const t=Gf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: rt"+e+")"}static preparePerkName(e){const t=xf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: rp"+e+")"}static prepareTechName(e){const t=kf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: r"+e+")"}static prepareFlagName(e){const t=Mf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: f"+e+")"}static prepareBuildingName(e){const t=Lf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: b"+e+")"}static prepareSeaEventName(e){const t=jf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: se"+e+")"}static preparePrayerName(e){const t=Ff[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: p"+e+")"}static prepareReligionName(e){const t=Bf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: rel"+e+")"}static prepareTroopName(e){const t=Wf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: t"+e+")"}static prepareMissionName(e){const t=Uf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: m"+e+")"}static prepareCropName(e){const t=Hf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: c"+e+")"}static prepareFocusName(e){const t=Vf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: foc"+e+")"}static prepareCountryName(e){const t=zf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: co"+e+")"}static prepareSicknessName(e){const t=Yf[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: si"+e+")"}static prepareHappinessEffectName(e){const t=$f[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: he"+e+")"}static resourcesArraysDiff(e,t){return e.filter(e=>t.findIndex(t=>t.resource===e.resource)<0)}static prepareResourcesNamesList(e){let t="";return e.forEach(e=>t+=Qf.prepareResourceName(e.resource)+", "),t=t.substr(0,t.length-2),t.toLowerCase()}static copyResourceArray(e){const t=[];return e.forEach(e=>t.push({resource:e.resource,amount:e.amount})),t}}var qf=(()=>(function(e){e[e.ALL=0]="ALL",e[e.WORKING=1]="WORKING",e[e.IDLE=2]="IDLE",e[e.PASSIVE=3]="PASSIVE"}(qf||(qf={})),qf))(),Xf=(()=>(function(e){e[e.AUTO_SAVE_STATUS=0]="AUTO_SAVE_STATUS",e[e.AUTO_SAVE_PERIOD=1]="AUTO_SAVE_PERIOD",e[e.METRIC=2]="METRIC",e[e.SAVE_LOGS=3]="SAVE_LOGS",e[e.SOUND_MASTER=4]="SOUND_MASTER",e[e.SOUND_MASTER_VOLUME=5]="SOUND_MASTER_VOLUME",e[e.VISUAL_PROGRESS_BARS=6]="VISUAL_PROGRESS_BARS",e[e.AUTO_TEXT_FITTING=7]="AUTO_TEXT_FITTING",e[e.POSITIVE_COLOUR=8]="POSITIVE_COLOUR",e[e.NEGATIVE_COLOUR=9]="NEGATIVE_COLOUR",e[e.PAGED_VIEW=10]="PAGED_VIEW",e[e.BUILDINGS_PER_PAGE=11]="BUILDINGS_PER_PAGE",e[e.KEEP_RESERVATION_SETTINGS_ON_RESET=12]="KEEP_RESERVATION_SETTINGS_ON_RESET",e[e.KEEP_MANAGEMENT_SETTINGS_ON_RESET=13]="KEEP_MANAGEMENT_SETTINGS_ON_RESET",e[e.PAUSE_ON_INIT=14]="PAUSE_ON_INIT",e[e.KEEP_AUTO_TRADE_ON_RESET=15]="KEEP_AUTO_TRADE_ON_RESET",e[e.AI_DIFFICULTY=16]="AI_DIFFICULTY",e[e.SOUND_MUSIC=17]="SOUND_MUSIC",e[e.SOUND_MUSIC_VOLUME=18]="SOUND_MUSIC_VOLUME",e[e.SOUND_EFFECTS=19]="SOUND_EFFECTS",e[e.SOUND_EFFECTS_VOLUME=20]="SOUND_EFFECTS_VOLUME",e[e.SOUND_EFFECT_MARKET=21]="SOUND_EFFECT_MARKET",e[e.SOUND_EFFECT_RESEARCH=22]="SOUND_EFFECT_RESEARCH",e[e.SOUND_EFFECT_INVASION=23]="SOUND_EFFECT_INVASION",e[e.SOUND_EFFECT_SEASON=24]="SOUND_EFFECT_SEASON",e[e.PLAYER_COLOUR=25]="PLAYER_COLOUR"}(Xf||(Xf={})),Xf))(),Zf=(()=>(function(e){e[e.GAME=0]="GAME",e[e.LOG=1]="LOG",e[e.MODAL=2]="MODAL",e[e.RESOURCES=3]="RESOURCES",e[e.LAND=4]="LAND",e[e.RESEARCH=5]="RESEARCH",e[e.CRAFTING=6]="CRAFTING",e[e.RECIPE=7]="RECIPE",e[e.RELIGION=8]="RELIGION",e[e.WEATHER=9]="WEATHER",e[e.CALENDAR=10]="CALENDAR",e[e.EFFECTS=11]="EFFECTS",e[e.ARMY=12]="ARMY",e[e.HAPPINESS=13]="HAPPINESS",e[e.MANAGEMENT=14]="MANAGEMENT",e[e.ROYAL=15]="ROYAL",e[e.MARKET=16]="MARKET",e[e.VILLAGE=17]="VILLAGE",e[e.FORT=18]="FORT",e[e.FOREST=19]="FOREST",e[e.FIELD=20]="FIELD",e[e.MOUNTAINS=21]="MOUNTAINS",e[e.SEA=22]="SEA",e[e.PLATEAU=23]="PLATEAU",e[e.BUILDING_FACTORY=24]="BUILDING_FACTORY",e[e.SERIALIZER=25]="SERIALIZER",e[e.KONGREGATE=26]="KONGREGATE",e[e.ID=27]="ID",e[e.TICKER=28]="TICKER",e[e.HERITAGE=29]="HERITAGE",e[e.WORLD=30]="WORLD",e[e.MISSION_FACTORY=31]="MISSION_FACTORY",e[e.SOUND=32]="SOUND",e[e.TUTORIAL=33]="TUTORIAL",e[e.NAVY=34]="NAVY",e[e.REGIONS=35]="REGIONS"}(Zf||(Zf={})),Zf))();let Jf=(()=>{class e{constructor(){this.services=new Map}addService(e,t){this.services.set(e,t)}getService(e){return this.services.get(e)}getIdService(){return this.services.get(Zf.ID)}getKongregateService(){return this.services.get(Zf.KONGREGATE)}getWeatherService(){return this.services.get(Zf.WEATHER)}getManagementService(){return this.services.get(Zf.MANAGEMENT)}getTechService(){return this.services.get(Zf.RESEARCH)}getHappinessService(){return this.services.get(Zf.HAPPINESS)}getEffectsService(){return this.services.get(Zf.EFFECTS)}getRecipeService(){return this.services.get(Zf.RECIPE)}getLandService(){return this.services.get(Zf.LAND)}getResourcesService(){return this.services.get(Zf.RESOURCES)}getRegionsService(){return this.services.get(Zf.REGIONS)}getVillageService(){return this.services.get(Zf.VILLAGE)}getFortService(){return this.services.get(Zf.FORT)}getForestService(){return this.services.get(Zf.FOREST)}getFieldService(){return this.services.get(Zf.FIELD)}getMountainsService(){return this.services.get(Zf.MOUNTAINS)}getSeaService(){return this.services.get(Zf.SEA)}getCalendarService(){return this.services.get(Zf.CALENDAR)}getRoyalService(){return this.services.get(Zf.ROYAL)}getWorldService(){return this.services.get(Zf.WORLD)}getModalService(){return this.services.get(Zf.MODAL)}getArmyService(){return this.services.get(Zf.ARMY)}getNavyService(){return this.services.get(Zf.NAVY)}getLogService(){return this.services.get(Zf.LOG)}getGameService(){return this.services.get(Zf.GAME)}getServiceByRegion(e){switch(e){case Kf.VILLAGE:return this.services.get(Zf.VILLAGE);case Kf.FORT:return this.services.get(Zf.FORT);case Kf.FIELD:return this.services.get(Zf.FIELD);case Kf.FOREST:return this.services.get(Zf.FOREST);case Kf.MOUNTAINS:return this.services.get(Zf.MOUNTAINS);case Kf.SEA:return this.services.get(Zf.SEA);case Kf.PLATEAU:return this.services.get(Zf.PLATEAU);default:console.error("Region service not found for ["+Kf[e]+"]")}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),em=(()=>{class e{constructor(e){this.servicesService=e,this.textSubject=new b,this.errorSubject=new b,this.missionDataSubject=new b,this.returnRegionSubject=new b,this.regionSelectionSubject=new b,this.shipyardLimitBoat=new b,this.buildingSubject=new b,this.tutorialSubject=new b,this.tutorialResponseSubject=new b,this.valueSubject=new b,this.onOpenSubject=new b,this.confirmationSubject=new b,this.abdicationSubject=new b,this.closeSubject=new b,this.valueResponseSubject=new b,this.regionSubject=new b,this.worldRegionSubject=new b,this.fightReportSubject=new b,this.techSubject=new b,this.resourceOptionsSubject=new b,this.resourceOptionsResponseSubject=new b,this.modals=[],this.servicesService.addService(Zf.MODAL,this)}add(e){this.modals.push(e)}remove(e){this.modals=this.modals.filter(t=>t.id!==e)}open(e){this.modals.find(t=>t.id===e).open(),this.onOpenSubject.next(e)}close(e){this.modals.find(t=>t.id===e).close(),this.closeSubject.next(e)}registerForText(){return this.textSubject.asObservable()}registerForErrorReport(){return this.errorSubject.asObservable()}registerForOnOpen(){return this.onOpenSubject.asObservable()}registerForConfirmation(){return this.confirmationSubject.asObservable()}sendConfirmationResult(e){this.confirmationSubject.next(e)}registerForAbdication(){return this.abdicationSubject.asObservable()}sendAbdicationResult(e){this.abdicationSubject.next(e)}setModalText(e){this.textSubject.next(e)}setModalErrorReport(e){this.errorSubject.next(e)}registerForRegion(){return this.regionSubject.asObservable()}setRegion(e){this.regionSubject.next(e)}registerForCloseModal(){return this.closeSubject.asObservable()}sendCloseSignal(e){this.closeSubject.next(e)}registerForValue(){return this.valueSubject.asObservable()}setModalValue(e){this.valueSubject.next(e)}sendValueInput(e){this.valueResponseSubject.next(e)}registerForValueResponse(){return this.valueResponseSubject.asObservable()}registerForMissionData(){return this.missionDataSubject.asObservable()}registerForBuilding(){return this.buildingSubject.asObservable()}setMissionData(e){this.missionDataSubject.next(e)}setBuilding(e){this.buildingSubject.next(e)}info(e){this.open(Pf.INFO),this.setModalText(e)}openTutorialModal(e){const t=this.modals.find(e=>e.id===Pf.TUTORIAL);t.close(),t.openTutorialWindow(e)}registerForTutorial(){return this.tutorialSubject.asObservable()}setTutorial(e){this.tutorialSubject.next(e)}registerForTutorialResponse(){return this.tutorialResponseSubject.asObservable()}sendTutorialResponse(e){this.tutorialResponseSubject.next(e)}registerForResourceOptions(){return this.resourceOptionsSubject.asObservable()}setResourceOptions(e){this.resourceOptionsSubject.next(e)}registerForResourceOptionsResponse(){return this.resourceOptionsResponseSubject.asObservable()}sendResourceOptionsResponse(e){return this.resourceOptionsResponseSubject.next(e)}registerForReturnRegion(){return this.returnRegionSubject.asObservable()}setReturnRegion(e){this.returnRegionSubject.next(e)}registerForRegionSelectionOrder(){return this.regionSelectionSubject.asObservable()}setRegionSelection(e){this.regionSelectionSubject.next(e)}registerForShipyardLimitBoat(){return this.shipyardLimitBoat.asObservable()}setShipyardLimitBoat(e){this.shipyardLimitBoat.next(e)}registerForWorldRegion(){return this.worldRegionSubject.asObservable()}setWorldRegion(e){this.worldRegionSubject.next(e)}registerForFightReport(){return this.fightReportSubject.asObservable()}setFightReport(e){this.fightReportSubject.next(e)}registerForTech(){return this.techSubject.asObservable()}setTech(e){this.techSubject.next(e)}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var tm=(()=>(function(e){e[e.DEV=0]="DEV",e[e.V1_0_0=1]="V1_0_0"}(tm||(tm={})),tm))(),im=(()=>(function(e){e[e.SUN=0]="SUN",e[e.CLOUDS=1]="CLOUDS",e[e.RAIN=2]="RAIN",e[e.WIND=3]="WIND",e[e.STORM=4]="STORM",e[e.SNOW=5]="SNOW"}(im||(im={})),im))(),sm=(()=>(function(e){e[e.PLANK=0]="PLANK",e[e.CUT_STONE=1]="CUT_STONE",e[e.FABRIC=2]="FABRIC",e[e.LEATHER=3]="LEATHER",e[e.GOLD=4]="GOLD",e[e.SILVER=5]="SILVER",e[e.COPPER=6]="COPPER",e[e.TIN=7]="TIN",e[e.BRONZE=8]="BRONZE",e[e.IRON=9]="IRON",e[e.STEEL=10]="STEEL",e[e.FUEL_BRUSHWOOD=11]="FUEL_BRUSHWOOD",e[e.FUEL_LOG=12]="FUEL_LOG",e[e.FUEL_COAL=13]="FUEL_COAL",e[e.STONE_AXE=14]="STONE_AXE",e[e.STONE_PICKAXE=15]="STONE_PICKAXE",e[e.STONE_SHOVEL=16]="STONE_SHOVEL",e[e.STONE_SPEAR=17]="STONE_SPEAR",e[e.STONE_HAMMER=18]="STONE_HAMMER",e[e.BOW=19]="BOW",e[e.CLOTHES_FUR=20]="CLOTHES_FUR",e[e.CLOTHES_FABRIC=21]="CLOTHES_FABRIC",e[e.SWORD=22]="SWORD",e[e.WOODEN_SHIELD=23]="WOODEN_SHIELD",e[e.LEATHER_ARMOR=24]="LEATHER_ARMOR",e[e.LIGHT_ARMOR=25]="LIGHT_ARMOR",e[e.HEAVY_ARMOR=26]="HEAVY_ARMOR",e[e.COOKED_MEAT=27]="COOKED_MEAT",e[e.FLOUR=28]="FLOUR",e[e.BREAD=29]="BREAD",e[e.VEGETABLE_SOUP_BERRY=30]="VEGETABLE_SOUP_BERRY",e[e.VEGETABLE_SOUP_MUSHROOM=31]="VEGETABLE_SOUP_MUSHROOM",e[e.MEAT_SOUP=32]="MEAT_SOUP",e[e.CHEESE=33]="CHEESE",e[e.HERBAL_MEDICINE=34]="HERBAL_MEDICINE",e[e.COOKED_FISH=35]="COOKED_FISH",e[e.FABRIC_WOOL=36]="FABRIC_WOOL",e[e.PARCHMENT=37]="PARCHMENT",e[e.VEGETABLE_SOUP_BERRY_MUSHROOM=38]="VEGETABLE_SOUP_BERRY_MUSHROOM",e[e.COPPER_AXE=39]="COPPER_AXE",e[e.COPPER_PICKAXE=40]="COPPER_PICKAXE",e[e.COPPER_SHOVEL=41]="COPPER_SHOVEL",e[e.COPPER_SPEAR=42]="COPPER_SPEAR",e[e.COPPER_HAMMER=43]="COPPER_HAMMER",e[e.BRONZE_AXE=44]="BRONZE_AXE",e[e.BRONZE_PICKAXE=45]="BRONZE_PICKAXE",e[e.BRONZE_SHOVEL=46]="BRONZE_SHOVEL",e[e.BRONZE_SPEAR=47]="BRONZE_SPEAR",e[e.BRONZE_HAMMER=48]="BRONZE_HAMMER",e[e.IRON_AXE=49]="IRON_AXE",e[e.IRON_PICKAXE=50]="IRON_PICKAXE",e[e.IRON_SHOVEL=51]="IRON_SHOVEL",e[e.IRON_SPEAR=52]="IRON_SPEAR",e[e.IRON_HAMMER=53]="IRON_HAMMER",e[e.POTTERY=54]="POTTERY",e[e.BRICKS=55]="BRICKS",e[e.OMELETTE=56]="OMELETTE",e[e.PIE=57]="PIE",e[e.COPPER_NAILS=58]="COPPER_NAILS",e[e.BRONZE_NAILS=59]="BRONZE_NAILS",e[e.IRON_NAILS=60]="IRON_NAILS",e[e.CANNON=61]="CANNON",e[e.BOUILLABAISSE=62]="BOUILLABAISSE",e[e.JEWELRY=63]="JEWELRY",e[e.BRONZE_SWORD=64]="BRONZE_SWORD",e[e.IRON_SWORD=65]="IRON_SWORD",e[e.BRONZE_SHIELD=66]="BRONZE_SHIELD",e[e.IRON_SHIELD=67]="IRON_SHIELD"}(sm||(sm={})),sm))(),rm=(()=>(function(e){e[e.GENERAL=0]="GENERAL",e[e.MILITARY=1]="MILITARY",e[e.SCIENCE=2]="SCIENCE",e[e.TECHNOLOGY=3]="TECHNOLOGY",e[e.AGRICULTURE=4]="AGRICULTURE"}(rm||(rm={})),rm))();class nm{constructor(e,t,i,s,r=0){this.name=e,this.building=t,this.effect=i,this.duration=s,this.buff=r}isPermanent(){return this.duration<0}isRoyal(){return-10===this.duration}isWonder(){return-9===this.duration}isBuff(){return this.buff>0}}let om=(()=>{class e{}return e.PERMANENT=-1,e.WONDER=-9,e.ROYAL=-10,e})(),am=(()=>{class e{static randomElement(e,t=!1,i=10){let s=0;if(e.forEach(e=>s+=e.chance),s>100||s<100&&t){const t=100/s;e.forEach(e=>e.chance=Math.floor(e.chance*t))}const r=this.randomBetween(1,100*i);let n=0;for(const o of e){if(n+1<=r&&n+o.chance*i>=r)return o.item;n+=o.chance*i}for(;s>100;)for(const t of e){if(n+1<=r&&n+t.chance*i>=r)return t.item;n+=t.chance*i}return null}static chance(e){return Math.random()<e}static randomExcept(e,t){const i=e.filter(function(e){return t.indexOf(e)<0});return i[this.randomBetween(0,i.length-1)]}static randomArrayElement(e){return e[this.randomBetween(0,e.length-1)]}static randomBetween(e,t){return Math.floor(Math.random()*(t-e+1))+e}static randomBetweenFloat(e,t){return Math.random()*(t-e+1)+e}static randomWeightedExcept(e,t){const i=e.filter(function(e){return t.indexOf(e.item)<0});let s=0;i.forEach(e=>s+=e.chance);const r=this.randomBetween(1,s);let n=0;for(let o=0;o<i.length;o++){if(n<r&&r<=n+i[o].chance)return i[o].item;n+=i[o].chance}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class cm{constructor(e,t,i,s){this.name=e,this.troop=t,this.effect=i,this.duration=s}isPermanent(){return this.duration<0}isRoyal(){return-10===this.duration}isWonder(){return-9===this.duration}}class lm{constructor(e,t,i){this.name=e,this.effect=t,this.duration=i}isPermanent(){return this.duration<0}isRoyal(){return-10===this.duration}isWonder(){return-9===this.duration}}var um=(()=>(function(e){e[e.METEORITE=0]="METEORITE",e[e.SMALL_REFUGEE=1]="SMALL_REFUGEE",e[e.MEDIUM_REFUGEE=2]="MEDIUM_REFUGEE"}(um||(um={})),um))(),hm=(()=>(function(e){e[e.LOG=0]="LOG",e[e.WARNING=1]="WARNING",e[e.SUCCESS=2]="SUCCESS",e[e.MYSTICAL=3]="MYSTICAL",e[e.FIGHT_REPORT=4]="FIGHT_REPORT",e[e.ERROR=5]="ERROR"}(hm||(hm={})),hm))(),dm=(()=>(function(e){e[e.DISABLED=0]="DISABLED",e[e.EASY=1]="EASY",e[e.MEDIUM=2]="MEDIUM",e[e.HARD=3]="HARD"}(dm||(dm={})),dm))(),gm=(()=>(function(e){e[e.DEFENSES=0]="DEFENSES",e[e.ROADS=1]="ROADS",e[e.WATCHTOWER=2]="WATCHTOWER",e[e.GUARD_TOWER=3]="GUARD_TOWER",e[e.HARBOUR=4]="HARBOUR"}(gm||(gm={})),gm))();const pm={AUTO_SAVE_STATUS:!0,AUTO_SAVE_PERIOD:5,METRIC:!0,SAVE_LOGS:!1,PAUSE_ON_INIT:!1,KEEP_RESERVATION_SETTINGS_ON_RESET:!1,KEEP_MANAGEMENT_SETTINGS_ON_RESET:!1,KEEP_AUTO_TRADE_ON_RESET:!1,SOUND_MASTER:!0,SOUND_MASTER_VOLUME:50,SOUND_MUSIC:!0,SOUND_MUSIC_VOLUME:50,SOUND_EFFECTS:!0,SOUND_EFFECTS_VOLUME:50,SOUND_EFFECT_MARKET:!0,SOUND_EFFECT_RESEARCH:!0,SOUND_EFFECT_INVASION:!0,SOUND_EFFECT_SEASON:!0,VISUAL_PROGRESS_BARS:!0,AUTO_TEXT_FITTING:!0,PAGED_VIEW:!1,BUILDINGS_PER_PAGE:12,POSITIVE_COLOUR:"#006400",NEGATIVE_COLOUR:"#8B0000",PLAYER_COLOUR:"#006400",AI_DIFFICULTY:dm.MEDIUM},fm={getBuilding(e){const t=this.getBuildings().find(t=>t[0]===Lf[e]);if(t)return t[1];console.warn("Invalid building: "+Qf.prepareBuildingName(e))},getBuildings(){return Object.entries(this.VILLAGE).concat(Object.entries(this.FORT)).concat(Object.entries(this.FOREST)).concat(Object.entries(this.FIELD)).concat(Object.entries(this.MOUNTAINS)).concat(Object.entries(this.PLATEAU)).concat(Object.entries(this.SEA))},getBuildingRegion(e){return Object.keys(this.FOREST).includes(Lf[e])?Kf.FOREST:Object.keys(this.VILLAGE).includes(Lf[e])?Kf.VILLAGE:Object.keys(this.MOUNTAINS).includes(Lf[e])?Kf.MOUNTAINS:Object.keys(this.FIELD).includes(Lf[e])?Kf.FIELD:Object.keys(this.FORT).includes(Lf[e])?Kf.FORT:Object.keys(this.SEA).includes(Lf[e])?Kf.SEA:Object.keys(this.PLATEAU).includes(Lf[e])?Kf.PLATEAU:void 0},DEMOLITION_RETURN:.3,FOREST:{LOGGERS_HUT:{BASE_POWER:5,SIZE:5,COMPLEXITY:5,DESCRIPTION:"Loggers cut trees in the forest",COST:[{resource:Df.LOG,amount:10}],WEATHER:[{weather:im.RAIN,effect:-50},{weather:im.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.AXE,amount:5}]},UPGRADES:[{BASE_POWER:7.5,COMPLEXITY:10,PREREQUISITES:[Mf.URBAN_PLANNING],COST:[{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:10},{resource:Df.HAMMER,amount:5},{resource:Df.AXE,amount:5}]},{BASE_POWER:10,COMPLEXITY:20,PREREQUISITES:[],COST:[{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:20},{resource:Df.COPPER,amount:10},{resource:Df.AXE,amount:10}]}]},LOGGERS_CAMP:{BASE_POWER:5,SIZE:20,COMPLEXITY:5,DESCRIPTION:"Loggers cut trees in the forest",COST:[{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:10}],WEATHER:[{weather:im.RAIN,effect:-50},{weather:im.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.AXE,amount:20}]},UPGRADES:[{BASE_POWER:7.5,COMPLEXITY:10,PREREQUISITES:[Mf.URBAN_PLANNING],COST:[{resource:Df.PLANK,amount:40},{resource:Df.CUT_STONE,amount:40},{resource:Df.HAMMER,amount:20},{resource:Df.AXE,amount:20}]},{BASE_POWER:10,COMPLEXITY:20,PREREQUISITES:[],COST:[{resource:Df.PLANK,amount:80},{resource:Df.BRICKS,amount:40},{resource:Df.BRONZE,amount:20},{resource:Df.AXE,amount:40}]}]},FORESTER:{BASE_POWER:10,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Forester can plant new trees and control natural growth of the forest",COST:[{resource:Df.LOG,amount:10},{resource:Df.SHOVEL,amount:2}],WEATHER:[{weather:im.RAIN,effect:-100},{weather:im.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.SHOVEL,amount:5}]}},SAWMILL:{BASE_POWER:3,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Sawmill cut logs into planks",COST:[{resource:Df.LOG,amount:20},{resource:Df.CUT_STONE,amount:10}],TEXT:"cutting",INPUT_RESOURCES:[{resource:Df.LOG,amount:3}],OUTPUT_RESOURCES:[{resource:Df.PLANK,amount:1}]},GATHERER:{BASE_POWER:10,SIZE:5,COMPLEXITY:3,DESCRIPTION:"Gatherer can find all kinds of useful things in the forest.<br>They can look for either food or resources",COST:[{resource:Df.LOG,amount:10},{resource:Df.STONE,amount:5}],WEATHER:[{weather:im.RAIN,effect:-75},{weather:im.STORM,effect:-100}],CAN_PRODUCE:[Df.BERRY,Df.MUSHROOM,Df.WHEAT,Df.HERBS,Df.BRUSHWOOD,Df.STONE,Df.LOG,Df.COPPER],BERRY_CHANCE:30,MUSHROOM_CHANCE:30,WHEAT_CHANCE:3,BRUSHWOOD_CHANCE:35,STONE_CHANCE:15,LOG_CHANCE:5,COPPER_CHANCE:.5,HERBS_CHANCE:2},GATHERERS_CAMP:{BASE_POWER:10,SIZE:20,COMPLEXITY:15,DESCRIPTION:"It is more efficient to group gatherers together in one place",COST:[{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:10}],WEATHER:[{weather:im.RAIN,effect:-75},{weather:im.STORM,effect:-100}],CAN_PRODUCE:[Df.BERRY,Df.MUSHROOM,Df.WHEAT,Df.HERBS,Df.BRUSHWOOD,Df.STONE,Df.LOG,Df.COPPER],BERRY_CHANCE:30,MUSHROOM_CHANCE:30,WHEAT_CHANCE:3,BRUSHWOOD_CHANCE:35,STONE_CHANCE:15,LOG_CHANCE:5,COPPER_CHANCE:.5,HERBS_CHANCE:2},HUNTER_LODGE:{BASE_POWER:2,SIZE:5,COMPLEXITY:8,DESCRIPTION:"Hunts animals for meat and fur",COST:[{resource:Df.LOG,amount:15},{resource:Df.PLANK,amount:5},{resource:Df.BOW,amount:1}],WEATHER:[{weather:im.RAIN,effect:-100},{weather:im.STORM,effect:-100}],CAN_PRODUCE:[Df.MEAT,Df.FUR],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.BOW,amount:5}]}},TANNERY:{BASE_POWER:5,SIZE:5,COMPLEXITY:5,DESCRIPTION:"Turns furs into leather",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10}],TEXT:"tanning",INPUT_RESOURCES:[{resource:Df.FUR,amount:1}],OUTPUT_RESOURCES:[{resource:Df.LEATHER,amount:1}]},PAPER_MILL:{BASE_POWER:2,SIZE:20,COMPLEXITY:20,DESCRIPTION:"Produces paper from logs",COST:[{resource:Df.LOG,amount:20},{resource:Df.CUT_STONE,amount:10},{resource:Df.PLANK,amount:10}],TEXT:"producing",INPUT_RESOURCES:[{resource:Df.LOG,amount:3}],OUTPUT_RESOURCES:[{resource:Df.PAPER,amount:1}]}},MOUNTAINS:{QUARRY:{BASE_POWER:5,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Cuts stone out of mountains",COST:[{resource:Df.LOG,amount:40},{resource:Df.PLANK,amount:20}],WEATHER:[{weather:im.RAIN,effect:-100},{weather:im.STORM,effect:-100}],CAN_PRODUCE:[Df.STONE],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.PICKAXE,amount:5}]}},GEOLOGIST:{BASE_POWER:1,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Looks for useful rocks",COST:[{resource:Df.LOG,amount:10},{resource:Df.STONE,amount:5}],WEATHER:[{weather:im.RAIN,effect:-100},{weather:im.STORM,effect:-100}],COAL_CHANCE:20,GOLD_CHANCE:4,SILVER_CHANCE:8,COPPER_CHANCE:10,TIN_CHANCE:6,IRON_CHANCE:4},PIT_MINE:{BASE_POWER:2,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Allows workers to mine ores",COST:[{resource:Df.LOG,amount:60},{resource:Df.PICKAXE,amount:5}],WEATHER:[{weather:im.RAIN,effect:-100},{weather:im.STORM,effect:-100}],GEM_CHANCE:.001,BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.PICKAXE,amount:5},{resource:Df.SHOVEL,amount:5}]}},METEORITE:{BASE_POWER:3,SIZE:0,COMPLEXITY:0,DESCRIPTION:"Pieces of metal that fell from the sky",COST:[],WEATHER:[{weather:im.RAIN,effect:-100},{weather:im.STORM,effect:-100}]},DEEP_MINE:{BASE_POWER:1,SIZE:20,COMPLEXITY:30,DESCRIPTION:"Allows workers to mine ores from under the ground",COST:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50},{resource:Df.CUT_STONE,amount:50},{resource:Df.PICKAXE,amount:20},{resource:Df.SHOVEL,amount:20},{resource:Df.HAMMER,amount:10}],WEATHER:[],GEM_CHANCE:.002,BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.PICKAXE,amount:10},{resource:Df.SHOVEL,amount:10}]},UPGRADES:[{BASE_POWER:1,COMPLEXITY:40,PREREQUISITES:[],COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:10},{resource:Df.PICKAXE,amount:5},{resource:Df.HAMMER,amount:5},{resource:Df.SHOVEL,amount:5}]},{BASE_POWER:1,COMPLEXITY:50,PREREQUISITES:[],COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:10},{resource:Df.PICKAXE,amount:5},{resource:Df.HAMMER,amount:5},{resource:Df.SHOVEL,amount:5}]},{BASE_POWER:1,COMPLEXITY:60,PREREQUISITES:[],COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:10},{resource:Df.PICKAXE,amount:5},{resource:Df.HAMMER,amount:5},{resource:Df.SHOVEL,amount:5}]},{BASE_POWER:1,COMPLEXITY:70,PREREQUISITES:[],COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:10},{resource:Df.PICKAXE,amount:5},{resource:Df.HAMMER,amount:5},{resource:Df.SHOVEL,amount:5}]}]},STONEMASON:{BASE_POWER:3,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Shapes stones for building",COST:[{resource:Df.LOG,amount:10},{resource:Df.STONE,amount:10}],TEXT:"cutting",INPUT_RESOURCES:[{resource:Df.STONE,amount:3}],OUTPUT_RESOURCES:[{resource:Df.CUT_STONE,amount:1}]},SMITHY:{BASE_POWER:5,SIZE:10,COMPLEXITY:20,DESCRIPTION:"Provides furnace for smelting ore and metal items",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:10},{resource:Df.COPPER,amount:5}],RECIPES:[{recipe:sm.COPPER,prerequisite:Mf.SMITHY},{recipe:sm.TIN,prerequisite:Mf.SMITHY},{recipe:sm.BRONZE,prerequisite:Mf.BRONZE},{recipe:sm.GOLD,prerequisite:Mf.ADVANCED_ORE_PROCESSING},{recipe:sm.SILVER,prerequisite:Mf.ADVANCED_ORE_PROCESSING},{recipe:sm.IRON,prerequisite:Mf.IRON},{recipe:sm.STEEL,prerequisite:Mf.STEEL},{recipe:sm.SWORD,prerequisite:Mf.SMITHY},{recipe:sm.BRONZE_SWORD,prerequisite:Mf.BRONZE},{recipe:sm.IRON_SWORD,prerequisite:Mf.IRON},{recipe:sm.BRONZE_SHIELD,prerequisite:Mf.BRONZE},{recipe:sm.IRON_SHIELD,prerequisite:Mf.IRON},{recipe:sm.LIGHT_ARMOR,prerequisite:Mf.SMITHY},{recipe:sm.HEAVY_ARMOR,prerequisite:Mf.BRONZE}]},MINT:{BASE_POWER:3,SIZE:40,COMPLEXITY:20,DESCRIPTION:"Produces coins from gold",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:10},{resource:Df.BRONZE,amount:10}],TEXT:"minting",INPUT_RESOURCES:[{resource:Df.GOLD,amount:1},{resource:Df.SILVER,amount:1}],OUTPUT_RESOURCES:[{resource:Df.COINS,amount:150}]}},VILLAGE:{HUT:{BASE_POWER:.5,FUEL_EFFICIENCY:0,SIZE:10,COMPLEXITY:5,STORAGE:100,TAX:1,DESCRIPTION:"Very primitive shelter but keeps rain and cold away. Houses 2 villagers",COST:[{resource:Df.FOOD,amount:100},{resource:Df.LOG,amount:10},{resource:Df.BRUSHWOOD,amount:10}],MAX_OCCUPANTS:2,UPGRADES:[{BASE_POWER:0,SIZE:15,COMPLEXITY:15,NEW_BUILDING:Lf.HOUSE,PREREQUISITES:[Mf.HOUSE],COST:[{resource:Df.FOOD,amount:100},{resource:Df.LOG,amount:15},{resource:Df.BRUSHWOOD,amount:5},{resource:Df.PLANK,amount:20}]}]},HOUSE:{BASE_POWER:.7,FUEL_EFFICIENCY:.2,SIZE:25,COMPLEXITY:15,STORAGE:200,TAX:1,DESCRIPTION:"Bigger and more durable shelter. Houses 6 villagers.<br>It's more efficient to heat than multiple huts",COST:[{resource:Df.FOOD,amount:200},{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.BRUSHWOOD,amount:10}],MAX_OCCUPANTS:6,UPGRADES:[{BASE_POWER:0,SIZE:20,COMPLEXITY:20,NEW_BUILDING:Lf.LONGHOUSE,PREREQUISITES:[Mf.LONGHOUSE],COST:[{resource:Df.FOOD,amount:100},{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:30},{resource:Df.CUT_STONE,amount:20},{resource:Df.HAY,amount:10}]}]},LONGHOUSE:{BASE_POWER:.9,FUEL_EFFICIENCY:.3,SIZE:45,COMPLEXITY:20,STORAGE:300,TAX:2,DESCRIPTION:"Long building for multiple families. Houses 15 villagers",COST:[{resource:Df.FOOD,amount:300},{resource:Df.LOG,amount:40},{resource:Df.PLANK,amount:40},{resource:Df.CUT_STONE,amount:20},{resource:Df.HAY,amount:10}],MAX_OCCUPANTS:15,UPGRADES:[{BASE_POWER:0,SIZE:55,COMPLEXITY:30,NEW_BUILDING:Lf.TUDOR_HOUSE,PREREQUISITES:[Mf.TUDOR_HOUSE],COST:[{resource:Df.FOOD,amount:500},{resource:Df.LOG,amount:80},{resource:Df.PLANK,amount:60},{resource:Df.CUT_STONE,amount:10},{resource:Df.BRICKS,amount:50}]}]},TUDOR_HOUSE:{BASE_POWER:1.1,FUEL_EFFICIENCY:.35,SIZE:100,COMPLEXITY:30,STORAGE:800,TAX:2,DESCRIPTION:"Very big and durable house. Houses 40 villagers",COST:[{resource:Df.FOOD,amount:800},{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:80},{resource:Df.CUT_STONE,amount:20},{resource:Df.BRICKS,amount:50}],MAX_OCCUPANTS:40,UPGRADES:[{BASE_POWER:0,SIZE:100,COMPLEXITY:60,NEW_BUILDING:Lf.SETTLEMENT,PREREQUISITES:[Mf.SETTLEMENT],COST:[{resource:Df.FOOD,amount:800},{resource:Df.LOG,amount:150},{resource:Df.PLANK,amount:110},{resource:Df.CUT_STONE,amount:40},{resource:Df.BRICKS,amount:25},{resource:Df.NAILS,amount:100},{resource:Df.HAMMER,amount:20},{resource:Df.SHOVEL,amount:20}]}]},SETTLEMENT:{BASE_POWER:1.3,FUEL_EFFICIENCY:.38,SIZE:200,COMPLEXITY:60,STORAGE:1600,TAX:3,DESCRIPTION:"A group of small buildings that can house up to 90 villagers",COST:[{resource:Df.FOOD,amount:1600},{resource:Df.LOG,amount:200},{resource:Df.PLANK,amount:150},{resource:Df.CUT_STONE,amount:50},{resource:Df.BRICKS,amount:50},{resource:Df.NAILS,amount:100},{resource:Df.HAMMER,amount:20},{resource:Df.SHOVEL,amount:20}],MAX_OCCUPANTS:90},WAREHOUSE:{BASE_POWER:0,SIZE:50,COMPLEXITY:10,DESCRIPTION:"Stores selected type of resources",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:5}]},WORKSHOP:{BASE_POWER:5,RESEARCH_POWER:1,CRAFTING_POWER:1.5,SIZE:15,COMPLEXITY:15,DESCRIPTION:"At the workshop workers can do research projects or build complex things",COST:[{resource:Df.LOG,amount:20},{resource:Df.BRUSHWOOD,amount:10}]},TAX_COLLECTOR:{BASE_POWER:0,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Tax collector gathers taxes from villagers or give donations",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:20},{resource:Df.BRICKS,amount:20},{resource:Df.PAPER,amount:30}]},BUILDERS_GUILD:{BASE_POWER:.5,SIZE:20,COMPLEXITY:10,DESCRIPTION:"Builders guild allow unemployed villagers to automatically work at construction sites. They are not as proficient at this as regular builders and cannot work at wonder buildings construction sites",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:40},{resource:Df.HAMMER,amount:5},{resource:Df.SHOVEL,amount:5},{resource:Df.AXE,amount:5},{resource:Df.PICKAXE,amount:5}],WEATHER:[{weather:im.RAIN,effect:-75},{weather:im.STORM,effect:-100}]},SCHOLARS_LAB:{BASE_POWER:2.5,RESEARCH_POWER:4,SIZE:15,COMPLEXITY:25,DESCRIPTION:"Scholars cannot craft items but they are more efficient at research (each cycle generates 4 research points)",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:20},{resource:Df.HAY,amount:20},{resource:Df.PAPER,amount:20}]},KITCHEN:{BASE_POWER:12.5,CRAFTING_POWER:1.5,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Kitchen focuses on processing raw food",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:5},{resource:Df.CUT_STONE,amount:5},{resource:Df.POTTERY,amount:5}]},MANUFACTURE:{BASE_POWER:7,CRAFTING_POWER:1.5,SIZE:5,COMPLEXITY:20,DESCRIPTION:"Manufacture specialises in crafting one recipe and it takes time to change production but it produces slightly faster than workshop",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:10},{resource:Df.HAMMER,amount:5}]},MARKETPLACE:{BASE_POWER:1,SIZE:20,COMPLEXITY:5,DESCRIPTION:"Place for trading with other villages",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:10},{resource:Df.STONE,amount:20}]},TAVERN:{BASE_POWER:1,SIZE:10,COMPLEXITY:20,DESCRIPTION:"Meeting place where villagers can relax and cheer up<br>Consume wine and beer but increase happiness",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:20},{resource:Df.BRUSHWOOD,amount:20}],WEATHER:[{weather:im.RAIN,effect:25},{weather:im.STORM,effect:25}]},BAKERY:{BASE_POWER:10,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Bakes bread from flour",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:10},{resource:Df.STONE,amount:10},{resource:Df.CUT_STONE,amount:10}],TEXT:"baking",INPUT_RESOURCES:[{resource:Df.FLOUR,amount:2},{resource:Df.FUEL,amount:1}],OUTPUT_RESOURCES:[{resource:Df.BREAD,amount:1}],BUFF:{name:"Bread oven",effect:10,duration:360,cost:[{resource:Df.CUT_STONE,amount:20}]}},TAILOR:{BASE_POWER:5,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Produces clothes from fabric",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:10}],TEXT:"sewing",INPUT_RESOURCES:[{resource:Df.FABRIC,amount:3}],OUTPUT_RESOURCES:[{resource:Df.CLOTHES,amount:1}]},SHRINE:{BASE_POWER:2,POPULATION:8,SIZE:2,COMPLEXITY:8,DESCRIPTION:"Place for prayer and offerings",COST:[{resource:Df.LOG,amount:5},{resource:Df.CUT_STONE,amount:5},{resource:Df.BERRY,amount:10},{resource:Df.MUSHROOM,amount:10},{resource:Df.MEAT,amount:10}]},CHURCH:{BASE_POWER:1,POPULATION:20,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Place of prayer and contemplation",COST:[{resource:Df.LOG,amount:40},{resource:Df.CUT_STONE,amount:30}],BUFF:{name:"Offering",effect:10,duration:360,cost:[{resource:Df.COINS,amount:200}]}}},FORT:{BARRACKS:{BASE_POWER:0,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Housing for troops",COST:[{resource:Df.LOG,amount:20},{resource:Df.CUT_STONE,amount:10}]},TRAINING_SQUARE:{BASE_POWER:10,SIZE:10,COMPLEXITY:3,DESCRIPTION:"Place for training recruits",COST:[{resource:Df.STONE,amount:40}],WEATHER:[{weather:im.RAIN,effect:-50},{weather:im.STORM,effect:-100}]},EMBASSY:{BASE_POWER:1,SIZE:20,COMPLEXITY:10,DESCRIPTION:"Ambassadors work here to improve relations with other kingdoms",COST:[{resource:Df.PLANK,amount:30},{resource:Df.CUT_STONE,amount:30}]},STOCKADE:{BASE_POWER:10,SIZE:50,COMPLEXITY:100,DESCRIPTION:"Protective wall around the village to protect against attackers",COST:[{resource:Df.LOG,amount:100},{resource:Df.STONE,amount:10}],DEFENSE:2,DURABILITY:50},WOODEN_TOWER:{BASE_POWER:10,SIZE:10,COMPLEXITY:30,DESCRIPTION:" Provide passive defense power",COST:[{resource:Df.LOG,amount:40},{resource:Df.PLANK,amount:20}],DEFENSE:3,DURABILITY:50},STONE_TOWER:{BASE_POWER:10,SIZE:10,COMPLEXITY:30,DESCRIPTION:"Provide passive defense power, more durable than wooden tower",COST:[{resource:Df.CUT_STONE,amount:40},{resource:Df.PLANK,amount:20}],DEFENSE:3,DURABILITY:100},STASH:{BASE_POWER:1,SIZE:10,COMPLEXITY:30,DESCRIPTION:"Complex hidden tunnels allow us to hide some resources in case of invasion",COST:[{resource:Df.LOG,amount:30},{resource:Df.CUT_STONE,amount:10},{resource:Df.PLANK,amount:10},{resource:Df.PICKAXE,amount:5}]}},FIELD:{FARM:{BASE_POWER:20,SIZE:15,COMPLEXITY:10,DESCRIPTION:"Farm allows workers to work on fields, orchard and pastures",COST:[{resource:Df.LOG,amount:40},{resource:Df.PLANK,amount:20},{resource:Df.STONE,amount:10}],WEATHER:[{weather:im.RAIN,effect:-50},{weather:im.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Df.SHOVEL,amount:5}]},UPGRADES:[{BASE_POWER:22,COMPLEXITY:10,PREREQUISITES:[Mf.URBAN_PLANNING],COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:10},{resource:Df.HAMMER,amount:5},{resource:Df.SHOVEL,amount:5}]}]},BARN:{BASE_POWER:0,SIZE:50,COMPLEXITY:10,DESCRIPTION:"Stores selected type of crops",COST:[{resource:Df.LOG,amount:40},{resource:Df.PLANK,amount:20},{resource:Df.HAY,amount:20},{resource:Df.CUT_STONE,amount:10}]},WINDMILL:{BASE_POWER:10,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Windmill turns wheat into flour",COST:[{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:10},{resource:Df.FABRIC,amount:20}],TEXT:"milling",INPUT_RESOURCES:[{resource:Df.WHEAT,amount:1}],OUTPUT_RESOURCES:[{resource:Df.FLOUR,amount:2}],WEATHER:[{weather:im.WIND,effect:50},{weather:im.STORM,effect:-100}]},COTTON_MILL:{BASE_POWER:5,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Spins cotton into fabric",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:10}],TEXT:"spinning",INPUT_RESOURCES:[{resource:Df.COTTON,amount:2}],OUTPUT_RESOURCES:[{resource:Df.FABRIC,amount:1}]},BREWERY:{BASE_POWER:1,SIZE:25,COMPLEXITY:20,DESCRIPTION:"Brews delicious beer",COST:[{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:30},{resource:Df.COPPER,amount:5},{resource:Df.POTTERY,amount:10}],TEXT:"brewing",INPUT_RESOURCES:[{resource:Df.BARLEY,amount:10},{resource:Df.HOP,amount:5},{resource:Df.FUEL,amount:3}],OUTPUT_RESOURCES:[{resource:Df.BEER,amount:20}]},FIELD:{BASE_POWER:1,SIZE:50,COMPLEXITY:1,DESCRIPTION:"Various crops can be grown here (Farm required to work on fields)",COST:[{resource:Df.STONE,amount:4}],WEATHER:[{weather:im.RAIN,effect:50},{weather:im.SUN,effect:50},{weather:im.CLOUDS,effect:-25}]},BUTCHER:{BASE_POWER:5,SIZE:15,COMPLEXITY:10,DESCRIPTION:"Turns animals from pastures into meat",COST:[{resource:Df.LOG,amount:15},{resource:Df.PLANK,amount:10},{resource:Df.CUT_STONE,amount:5}]},ORCHARD:{BASE_POWER:1,SIZE:50,COMPLEXITY:1,DESCRIPTION:"Various fruit trees and bushes can be grown here (Farm required to work on orchards)",COST:[{resource:Df.LOG,amount:5}],WEATHER:[{weather:im.RAIN,effect:50},{weather:im.SUN,effect:50},{weather:im.CLOUDS,effect:-25}]},PASTURE:{BASE_POWER:1,SIZE:50,COMPLEXITY:3,DESCRIPTION:"Many animals can be grown here (Farm required to work on pastures). <br>After building pasture and selecting animal type it is possible to use hunter lodges to tame animals or buy them from market.<br>Animals start to breed if there are at least two of them in a pasture.",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:20}]},CLAY_PIT:{BASE_POWER:5,SIZE:15,COMPLEXITY:15,DESCRIPTION:"We can extract clay here",COST:[{resource:Df.LOG,amount:15},{resource:Df.PLANK,amount:5}],WEATHER:[{weather:im.RAIN,effect:-100},{weather:im.STORM,effect:-100}],CAN_PRODUCE:[Df.CLAY]},WINERY:{BASE_POWER:1,SIZE:25,COMPLEXITY:10,DESCRIPTION:"Extracts and ferments grape juices",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.COPPER,amount:5},{resource:Df.POTTERY,amount:10}],TEXT:"fermenting",INPUT_RESOURCES:[{resource:Df.GRAPE,amount:35}],OUTPUT_RESOURCES:[{resource:Df.WINE,amount:16}]}},SEA:{FISHERS_HUT:{BASE_POWER:5,SIZE:5,COMPLEXITY:5,DESCRIPTION:"Fishers catch fish in the sea",COST:[{resource:Df.LOG,amount:10},{resource:Df.PLANK,amount:5},{resource:Df.COPPER,amount:1}],WEATHER:[{weather:im.RAIN,effect:25},{weather:im.STORM,effect:-100},{weather:im.WIND,effect:25}]},PIER:{BASE_POWER:0,SIZE:25,HARBOUR_SIZE:80,COMPLEXITY:40,DESCRIPTION:"Pier is where your boats can dock",COST:[{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:20},{resource:Df.COPPER,amount:10}]},HARBOUR:{BASE_POWER:0,SIZE:200,HARBOUR_SIZE:800,COMPLEXITY:60,DESCRIPTION:"Harbour can dock many more boats and ships than pier",COST:[{resource:Df.CUT_STONE,amount:50},{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:20},{resource:Df.BRONZE,amount:20},{resource:Df.IRON,amount:20}]},LIGHTHOUSE:{BASE_POWER:0,SIZE:20,COMPLEXITY:20,DESCRIPTION:"Sailors can better navigate at sea when lighthouse light guide them",COST:[{resource:Df.CUT_STONE,amount:20},{resource:Df.LOG,amount:10},{resource:Df.BRONZE,amount:5},{resource:Df.FUEL,amount:5}]},BOAT_BUILDER:{BASE_POWER:1,SIZE:20,COMPLEXITY:30,DESCRIPTION:"Boat builder can craft small boats",COST:[{resource:Df.LOG,amount:30},{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:20},{resource:Df.HAMMER,amount:10}]},SHIPYARD:{BASE_POWER:2,SIZE:50,COMPLEXITY:50,DESCRIPTION:"Shipyards excel in building even the biggest ships",COST:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50},{resource:Df.BRICKS,amount:50},{resource:Df.HAMMER,amount:20}]},CARTOGRAPHER:{BASE_POWER:2,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Gathers information produced by sea missions and by creating star maps to help navigating to distant lands",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10},{resource:Df.PAPER,amount:50}]}},PLATEAU:{STONEHENGE:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"Huge rocks mark place for old rituals and scientific experiments",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.PICKAXE,amount:10},{resource:Df.HAMMER,amount:10}],progress:10},{cost:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.STONE,amount:100}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.STONE,amount:100}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.STONE,amount:100}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10}],BUILDING_EFFECTS:[{building:Lf.WORKSHOP,value:20},{building:Lf.KITCHEN,value:10},{building:Lf.MANUFACTURE,value:10}],RP:20},PYRAMID:{BASE_POWER:3,SIZE:100,COMPLEXITY:0,DESCRIPTION:"Although it's just \"putting one rock on the other\", our construction worker's skill will be put to the test with this huge project",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.PICKAXE,amount:10},{resource:Df.HAMMER,amount:10}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:50}],progress:10},{cost:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:5},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:5},{cost:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:5},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:5}],BUILDING_EFFECTS:[{building:Lf.CONSTRUCTION,value:10},{building:Lf.DECONSTRUCTION,value:10},{building:Lf.BUILDERS_GUILD,value:10}],RP:20},HANGING_GARDEN:{BASE_POWER:3,SIZE:30,COMPLEXITY:0,DESCRIPTION:"With all those plants that cover entire buildings we truly became masters of flora",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.HAMMER,amount:10},{resource:Df.AXE,amount:10}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.BERRY,amount:75},{resource:Df.MUSHROOM,amount:75}],progress:10},{cost:[{resource:Df.SHOVEL,amount:20}],progress:10},{cost:[{resource:Df.WHEAT,amount:100}],progress:10},{cost:[{resource:Df.BARLEY,amount:100}],progress:10},{cost:[{resource:Df.APPLE,amount:100}],progress:10},{cost:[{resource:Df.HOP,amount:100}],progress:10},{cost:[{resource:Df.COTTON,amount:100}],progress:10},{cost:[{resource:Df.GRAPE,amount:100}],progress:10}],BUILDING_EFFECTS:[{building:Lf.FARM,value:15}],RP:20},COLOSSUS:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"This giant statue watches over our troops both during defense and attack",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.PICKAXE,amount:10},{resource:Df.HAMMER,amount:10}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.STONE,amount:75},{resource:Df.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.STONE,amount:75},{resource:Df.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.STONE,amount:75},{resource:Df.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.STONE,amount:75},{resource:Df.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Df.COPPER,amount:100},{resource:Df.HAMMER,amount:20}],progress:10}],ARMY_EFFECTS:[{troop:Wf.ALL,value:15}],RP:20},UNDERGROUND_CITY:{BASE_POWER:3,SIZE:0,COMPLEXITY:0,DESCRIPTION:"After connecting empty mines tunnels and repurposing them we will create entire underground city",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.HAMMER,amount:10},{resource:Df.PICKAXE,amount:10}],progress:10},{cost:[{resource:Df.LOG,amount:100}],progress:10},{cost:[{resource:Df.SHOVEL,amount:20},{resource:Df.HAMMER,amount:20},{resource:Df.PICKAXE,amount:20}],progress:10},{cost:[{resource:Df.LOG,amount:100}],progress:10},{cost:[{resource:Df.SHOVEL,amount:20},{resource:Df.HAMMER,amount:20},{resource:Df.PICKAXE,amount:20}],progress:10},{cost:[{resource:Df.LOG,amount:100}],progress:10},{cost:[{resource:Df.SHOVEL,amount:20},{resource:Df.HAMMER,amount:20},{resource:Df.PICKAXE,amount:20}],progress:10},{cost:[{resource:Df.LOG,amount:100}],progress:10},{cost:[{resource:Df.SHOVEL,amount:20},{resource:Df.HAMMER,amount:20},{resource:Df.PICKAXE,amount:20}],progress:10},{cost:[{resource:Df.LOG,amount:50},{resource:Df.CUT_STONE,amount:50}],progress:10}],BUILDING_EFFECTS:[{building:Lf.DEEP_MINE,value:15},{building:Lf.PIT_MINE,value:15},{building:Lf.QUARRY,value:15},{building:Lf.GEOLOGIST,value:15}],RP:20},GREAT_LIGHTHOUSE:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"Light from this building can be seen as far as anyone would like to ever travel",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.HAMMER,amount:10},{resource:Df.PICKAXE,amount:10}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:50}],progress:10},{cost:[{resource:Df.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Df.PLANK,amount:100}],progress:10}],BUILDING_EFFECTS:[{building:Lf.BOAT_BUILDER,value:20},{building:Lf.SHIPYARD,value:10}],ARMY_EFFECTS:[{troop:Wf.BOAT,value:10},{troop:Wf.BRIGANTINE,value:10},{troop:Wf.GALLEON,value:10}],RP:20},SACRED_GROVE:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"Collection of the oldest and greatest forest fauna and flora in one place",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.HAMMER,amount:10},{resource:Df.PICKAXE,amount:10}],progress:10},{cost:[{resource:Df.BERRY,amount:100},{resource:Df.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Df.CHICKEN,amount:20},{resource:Df.HORSE,amount:10},{resource:Df.PIG,amount:10}],progress:10},{cost:[{resource:Df.BERRY,amount:200},{resource:Df.MUSHROOM,amount:200}],progress:10},{cost:[{resource:Df.BERRY,amount:100},{resource:Df.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Df.CHICKEN,amount:20},{resource:Df.HORSE,amount:10},{resource:Df.PIG,amount:10}],progress:10},{cost:[{resource:Df.BERRY,amount:100},{resource:Df.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Df.CHICKEN,amount:20},{resource:Df.HORSE,amount:10},{resource:Df.PIG,amount:10}],progress:10},{cost:[{resource:Df.BERRY,amount:100},{resource:Df.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Df.BERRY,amount:200},{resource:Df.MUSHROOM,amount:200}],progress:10}],BUILDING_EFFECTS:[{building:Lf.FORESTER,value:10},{building:Lf.LOGGERS_HUT,value:10},{building:Lf.LOGGERS_CAMP,value:10},{building:Lf.HUNTER_LODGE,value:10},{building:Lf.GATHERER,value:10},{building:Lf.GATHERERS_CAMP,value:10}],RP:20},ASCENSION_TEMPLE:{BASE_POWER:1.5,SIZE:100,COMPLEXITY:0,DESCRIPTION:"Mystical place where your fate will be determined",COST:[],STAGES:[{cost:[{resource:Df.SHOVEL,amount:10},{resource:Df.HAMMER,amount:10},{resource:Df.PICKAXE,amount:10}],progress:5},{cost:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:100}],progress:5},{cost:[{resource:Df.CUT_STONE,amount:100},{resource:Df.PLANK,amount:100}],progress:10},{cost:[{resource:Df.COPPER,amount:50},{resource:Df.IRON,amount:50},{resource:Df.STEEL,amount:50}],progress:5},{cost:[{resource:Df.GOLD,amount:50},{resource:Df.SILVER,amount:50}],progress:5},{cost:[{resource:Df.CUT_STONE,amount:100},{resource:Df.PLANK,amount:100}],progress:10},{cost:[{resource:Df.COPPER,amount:50},{resource:Df.IRON,amount:50},{resource:Df.STEEL,amount:50}],progress:5},{cost:[{resource:Df.GOLD,amount:50},{resource:Df.SILVER,amount:50}],progress:5},{cost:[{resource:Df.CUT_STONE,amount:100},{resource:Df.PLANK,amount:100}],progress:10},{cost:[{resource:Df.COPPER,amount:50},{resource:Df.IRON,amount:50},{resource:Df.STEEL,amount:50}],progress:5},{cost:[{resource:Df.GOLD,amount:50},{resource:Df.SILVER,amount:50}],progress:5},{cost:[{resource:Df.CUT_STONE,amount:100},{resource:Df.PLANK,amount:100}],progress:10},{cost:[{resource:Df.COPPER,amount:50},{resource:Df.IRON,amount:50},{resource:Df.STEEL,amount:50}],progress:5},{cost:[{resource:Df.GOLD,amount:50},{resource:Df.SILVER,amount:50}],progress:5},{cost:[{resource:Df.GOLD,amount:100},{resource:Df.SILVER,amount:100}],progress:10}],RP:50}},CONSTRUCTION_SITE:{BASE_POWER:10,SIZE:0,COMPLEXITY:0,DESCRIPTION:"",COST:[],WEATHER:[{weather:im.RAIN,effect:-75},{weather:im.STORM,effect:-100}]},DECONSTRUCTION_SITE:{BASE_POWER:10,SIZE:0,COMPLEXITY:0,DESCRIPTION:"",COST:[],WEATHER:[{weather:im.RAIN,effect:-75},{weather:im.STORM,effect:-100}]}},mm={getResource(e){const t=this.getResources().find(t=>t[0]===Df[e]);if(t)return t[1];console.warn("Invalid resource: "+Qf.prepareResourceName(e))},getResourcesByType(e){const t=this.getResources().filter(t=>t[1].TYPES.includes(e));if(t)return t;console.warn("Invalid resource type: "+Qf.prepareResourceTypeName(e))},getResources(){return Object.entries(this.RAW).concat(Object.entries(this.PROCESSED)).concat(Object.entries(this.FOOD)).concat(Object.entries(this.TOOLS))},DEFAULT_AMOUNT:0,DEFAULT_LIMIT:50,DEFAULT_VISIBLE:!1,DEFAULT_HIGHLIGHTED:!1,RAW:{LOG:{TYPES:[Gf.RAW,Gf.FUEL],TRADE_VALUE:2,AMOUNT:20,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,FUEL_PRIORITY:3,POWER:10},BRUSHWOOD:{TYPES:[Gf.RAW,Gf.FUEL],TRADE_VALUE:1,AMOUNT:20,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,FUEL_PRIORITY:4,POWER:5.5},STONE:{TYPES:[Gf.RAW],TRADE_VALUE:3,AMOUNT:20,LIMIT:100,VISIBLE:!0},FUR:{TYPES:[Gf.RAW],TRADE_VALUE:3},WHEAT:{TYPES:[Gf.RAW],TRADE_VALUE:2},BARLEY:{TYPES:[Gf.RAW],TRADE_VALUE:3},HOP:{TYPES:[Gf.RAW],TRADE_VALUE:3},COTTON:{TYPES:[Gf.RAW],TRADE_VALUE:3},WOOL:{TYPES:[Gf.RAW],TRADE_VALUE:3},HERBS:{TYPES:[Gf.RAW],TRADE_VALUE:2},HAY:{TYPES:[Gf.RAW],TRADE_VALUE:2},CLAY:{TYPES:[Gf.RAW],TRADE_VALUE:2},CHICKEN:{TYPES:[Gf.RAW,Gf.ANIMAL],LIMIT:0,SIZE:2,MEAT:8,FUR:0,REPRODUCTION_SPEED:6,BUTCHERING_DIFFICULTY:1,TRADE_VALUE:20},SHEEP:{TYPES:[Gf.RAW,Gf.ANIMAL],LIMIT:0,SIZE:3,MEAT:16,FUR:1,REPRODUCTION_SPEED:4,BUTCHERING_DIFFICULTY:1,TRADE_VALUE:25},COW:{TYPES:[Gf.RAW,Gf.ANIMAL],LIMIT:0,SIZE:5,MEAT:60,FUR:3,REPRODUCTION_SPEED:1,BUTCHERING_DIFFICULTY:3,TRADE_VALUE:40},PIG:{TYPES:[Gf.RAW,Gf.ANIMAL],LIMIT:0,SIZE:3,MEAT:30,FUR:2,REPRODUCTION_SPEED:5,BUTCHERING_DIFFICULTY:3,TRADE_VALUE:30},HORSE:{TYPES:[Gf.RAW,Gf.ANIMAL],LIMIT:0,SIZE:5,MEAT:20,FUR:1,REPRODUCTION_SPEED:1,BUTCHERING_DIFFICULTY:5,TRADE_VALUE:50},COAL:{TYPES:[Gf.RAW,Gf.FUEL],TRADE_VALUE:8,FUEL_PRIORITY:2,POWER:50},GOLD_ORE:{TYPES:[Gf.RAW],TRADE_VALUE:40},SILVER_ORE:{TYPES:[Gf.RAW],TRADE_VALUE:20},COPPER_ORE:{TYPES:[Gf.RAW],TRADE_VALUE:13},TIN_ORE:{TYPES:[Gf.RAW],TRADE_VALUE:20},IRON_ORE:{TYPES:[Gf.RAW],TRADE_VALUE:40},GEMS:{TYPES:[Gf.RAW],TRADE_VALUE:100}},PROCESSED:{PLANK:{TYPES:[Gf.PROCESSED],TRADE_VALUE:3,VISIBLE:!0},CUT_STONE:{TYPES:[Gf.PROCESSED],TRADE_VALUE:5},FUEL:{TYPES:[Gf.PROCESSED,Gf.FUEL],TRADE_VALUE:3,FUEL_PRIORITY:1,POWER:12.5},FLOUR:{TYPES:[Gf.PROCESSED],TRADE_VALUE:3},FABRIC:{TYPES:[Gf.PROCESSED],TRADE_VALUE:7},LEATHER:{TYPES:[Gf.PROCESSED],TRADE_VALUE:4},PAPER:{TYPES:[Gf.PROCESSED],TRADE_VALUE:8},POTTERY:{TYPES:[Gf.PROCESSED],TRADE_VALUE:10},BRICKS:{TYPES:[Gf.PROCESSED],TRADE_VALUE:17},COINS:{TYPES:[Gf.PROCESSED],TRADE_VALUE:1,LIMIT:Number.MAX_SAFE_INTEGER},COPPER:{TYPES:[Gf.PROCESSED],TRADE_VALUE:32},GOLD:{TYPES:[Gf.PROCESSED],TRADE_VALUE:90},SILVER:{TYPES:[Gf.PROCESSED],TRADE_VALUE:45},TIN:{TYPES:[Gf.PROCESSED],TRADE_VALUE:45},BRONZE:{TYPES:[Gf.PROCESSED],TRADE_VALUE:50},IRON:{TYPES:[Gf.PROCESSED],TRADE_VALUE:135},STEEL:{TYPES:[Gf.PROCESSED],TRADE_VALUE:190},FISH_FOOD:{TYPES:[Gf.PROCESSED],TRADE_VALUE:5}},FOOD:{BERRY:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:2,AMOUNT:50,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,POWER:50},MUSHROOM:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:2,AMOUNT:50,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,POWER:50},FISH:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:3,POWER:75},APPLE:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:1,POWER:25},GRAPE:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:1,POWER:20},BREAD:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:10,POWER:300},MEAT:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:3,POWER:75},EGG:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:1,POWER:25},MILK:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:1,POWER:25},CHEESE:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:9,POWER:200},COOKED_FISH:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:8,POWER:175},COOKED_MEAT:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:8,POWER:175},VEGETABLE_SOUP:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:10,POWER:225},MEAT_SOUP:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:10,POWER:225},OMELETTE:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:10,POWER:225},PIE:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:12,POWER:250},BOUILLABAISSE:{TYPES:[Gf.FOOD,Gf.CONSUMABLE],TRADE_VALUE:32,POWER:900},BEER:{TYPES:[Gf.FOOD],TRADE_VALUE:3},WINE:{TYPES:[Gf.FOOD],TRADE_VALUE:5},HERBAL_MEDICINE:{TYPES:[Gf.FOOD],TRADE_VALUE:15}},TOOLS:{CLOTHES:{TYPES:[Gf.TOOLS],VISIBLE:!0,AMOUNT:10,TRADE_VALUE:25},PICKAXE:{TYPES:[Gf.TOOLS],TRADE_VALUE:35},SHOVEL:{TYPES:[Gf.TOOLS],TRADE_VALUE:35},AXE:{TYPES:[Gf.TOOLS],TRADE_VALUE:35},HAMMER:{TYPES:[Gf.TOOLS],TRADE_VALUE:35},BOW:{TYPES:[Gf.TOOLS],TRADE_VALUE:35},SPEAR:{TYPES:[Gf.TOOLS],TRADE_VALUE:35},NAILS:{TYPES:[Gf.TOOLS],TRADE_VALUE:12},MAP:{TYPES:[Gf.TOOLS],TRADE_VALUE:1e3},SWORD:{TYPES:[Gf.TOOLS],TRADE_VALUE:190},SHIELD:{TYPES:[Gf.TOOLS],TRADE_VALUE:30},LEATHER_ARMOR:{TYPES:[Gf.TOOLS],TRADE_VALUE:50},LIGHT_ARMOR:{TYPES:[Gf.TOOLS],TRADE_VALUE:400},HEAVY_ARMOR:{TYPES:[Gf.TOOLS],TRADE_VALUE:550},CANNON:{TYPES:[Gf.TOOLS],TRADE_VALUE:2e3},JEWELRY:{TYPES:[Gf.TOOLS],TRADE_VALUE:300}}},Sm={getTroop(e){const t=Object.entries(this.TROOPS).find(t=>t[0]===Wf[e]);if(t)return t[1];console.warn("Invalid troop: "+Qf.prepareTroopName(e))},getMission(e){const t=Object.entries(this.MISSIONS).find(t=>t[0]===Uf[e]);if(t)return t[1];console.warn("Invalid mission: "+Qf.prepareMissionName(e))},TROOPS:{COLONIST:{SIZE:1,CARGO:0,SPEED:3},SPY:{SIZE:1,CARGO:0,RECRUIT_TIME:10,STRENGTH:0,DEFENSE:1,PAY:5,SPEED:10,COST:[{resource:Df.CLOTHES,amount:1},{resource:Df.COINS,amount:20}]},MILITIA:{SIZE:1,CARGO:0,RECRUIT_TIME:3,STRENGTH:0,DEFENSE:2,PAY:0,SPEED:3,COST:[{resource:Df.FUR,amount:5}],AI_COST:3},SPEARMAN:{SIZE:1,CARGO:0,RECRUIT_TIME:12,STRENGTH:5,DEFENSE:2,PAY:2,SPEED:6,COST:[{resource:Df.SPEAR,amount:1},{resource:Df.LEATHER_ARMOR,amount:1}],AI_COST:6},ARCHER:{SIZE:1,CARGO:0,RECRUIT_TIME:12,STRENGTH:2,DEFENSE:5,PAY:2,SPEED:6,COST:[{resource:Df.BOW,amount:1},{resource:Df.LEATHER_ARMOR,amount:1}],AI_COST:6},SWORDSMAN:{SIZE:2,CARGO:0,RECRUIT_TIME:22,STRENGTH:9,DEFENSE:4,PAY:5,SPEED:5,COST:[{resource:Df.SWORD,amount:1},{resource:Df.SHIELD,amount:1},{resource:Df.LEATHER_ARMOR,amount:1}],AI_COST:10},LIGHT_CAVALRY:{SIZE:3,CARGO:0,RECRUIT_TIME:30,STRENGTH:15,DEFENSE:6,PAY:10,SPEED:10,COST:[{resource:Df.HORSE,amount:1},{resource:Df.SWORD,amount:1},{resource:Df.LIGHT_ARMOR,amount:1}],AI_COST:15},HORSE_ARCHER:{SIZE:3,CARGO:0,RECRUIT_TIME:30,STRENGTH:6,DEFENSE:15,PAY:10,SPEED:10,COST:[{resource:Df.HORSE,amount:1},{resource:Df.BOW,amount:1},{resource:Df.LIGHT_ARMOR,amount:1}],AI_COST:15},BOAT:{SIZE:5,CARGO:5,COMPLEXITY:5,SPEED:5,STRENGTH:0,DEFENSE:0,COST:[{resource:Df.PLANK,amount:10},{resource:Df.LOG,amount:5},{resource:Df.FABRIC,amount:10},{resource:Df.HAMMER,amount:5},{resource:Df.NAILS,amount:10}],PAY:10,CREW:1,AI_COST:0},BRIGANTINE:{SIZE:40,CARGO:40,COMPLEXITY:20,SPEED:15,STRENGTH:6,DEFENSE:6,COST:[{resource:Df.PLANK,amount:100},{resource:Df.LOG,amount:50},{resource:Df.FABRIC,amount:40},{resource:Df.IRON,amount:20},{resource:Df.HAMMER,amount:20},{resource:Df.NAILS,amount:40},{resource:Df.CANNON,amount:6}],PAY:80,CREW:10,AI_COST:0},GALLEON:{SIZE:150,CARGO:300,COMPLEXITY:50,SPEED:10,STRENGTH:30,DEFENSE:30,COST:[{resource:Df.PLANK,amount:350},{resource:Df.LOG,amount:200},{resource:Df.FABRIC,amount:200},{resource:Df.IRON,amount:80},{resource:Df.HAMMER,amount:50},{resource:Df.NAILS,amount:200},{resource:Df.CANNON,amount:20}],PAY:300,CREW:25,AI_COST:0},GUARD_TOWER:{SIZE:0,CARGO:0,COMPLEXITY:0,SPEED:0,STRENGTH:0,DEFENSE:10,COST:[],PAY:0,CREW:0,AI_COST:10}},MISSIONS:{MOVE:{TIME:3,ICON:"move",DESCRIPTION:"Move your troops to another region",COST:[{resource:Df.FOOD,amount:20}]},BUILD:{TIME:10,ICON:"build",DESCRIPTION:"Improve region defenses",COST:[{resource:Df.LOG,amount:20},{resource:Df.CUT_STONE,amount:20}]},COLONIZE:{TIME:3,ICON:"colonize",DESCRIPTION:"Connect this unowned land to your kingdom",COST:[{resource:Df.FOOD,amount:200},{resource:Df.LOG,amount:3},{resource:Df.BRUSHWOOD,amount:2},{resource:Df.FUEL,amount:1}]},SPY:{TIME:7,ICON:"spy",DESCRIPTION:"Try to find out military strength of the enemy and region wealth",COST:[{resource:Df.FOOD,amount:100}]},PLUNDER:{TIME:2,ICON:"plunder",DESCRIPTION:"Plunder your enemies",COST:[{resource:Df.FOOD,amount:100}]},CONQUER:{TIME:3,ICON:"conquer",DESCRIPTION:"Conquer your enemies and claim their land",COST:[{resource:Df.FOOD,amount:200}]},FISHING:{TIME:3,ICON:"fish",DESCRIPTION:"Catch fish from the sea",COST:[{resource:Df.FOOD,amount:200}]},HUNTING:{TIME:3,ICON:"hunting",DESCRIPTION:"Hunt the bigger fish",COST:[{resource:Df.FOOD,amount:200}]},TREASURE:{TIME:2,ICON:"treasure",DESCRIPTION:"Collect treasure",COST:[{resource:Df.FOOD,amount:200}]},CARTOGRAPHY:{TIME:3,ICON:"cartography",DESCRIPTION:"Gather information about all islands and stars during night",COST:[{resource:Df.FOOD,amount:200}]},EXPEDITION:{TIME:12,ICON:"expedition",DESCRIPTION:"Discover distant lands",COST:[{resource:Df.FOOD,amount:20}]},SEA_BATTLE:{TIME:2,ICON:"battle",DESCRIPTION:"Sea battle with other ships",COST:[{resource:Df.FOOD,amount:200}]},SEA_PLUNDER:{TIME:2,ICON:"plunder",DESCRIPTION:"Plunder your enemies",COST:[{resource:Df.FOOD,amount:100}]},SEA_CONQUER:{TIME:3,ICON:"conquer",DESCRIPTION:"Conquer your enemies and claim their land",COST:[{resource:Df.FOOD,amount:200}]},SEA_MOVE:{TIME:3,ICON:"move",DESCRIPTION:"Move your troops to another region",COST:[{resource:Df.FOOD,amount:20}]}}},Em={getCrop(e){const t=this.getCrops().find(t=>t[0]===Hf[e]);if(t)return t[1];console.warn("Invalid crop: "+Qf.prepareCropName(e))},getCrops(){return Object.entries(this.FIELD).concat(Object.entries(this.ORCHARD))},FIELD:{WHEAT:{CROP:Hf.WHEAT,GROWTH:20,YIELD_MULTIPLIER:2},BARLEY:{CROP:Hf.BARLEY,GROWTH:20,YIELD_MULTIPLIER:2,PREREQUISITE:Mf.BARLEY},HAY:{CROP:Hf.HAY,GROWTH:10,YIELD_MULTIPLIER:1.5},HOP:{CROP:Hf.HOP,GROWTH:20,YIELD_MULTIPLIER:2,PREREQUISITE:Mf.HOPS},HERBS:{CROP:Hf.HERBS,GROWTH:20,YIELD_MULTIPLIER:4,PREREQUISITE:Mf.HERBALISM},MUSHROOM:{CROP:Hf.MUSHROOM,GROWTH:10,YIELD_MULTIPLIER:1},COTTON:{CROP:Hf.COTTON,GROWTH:20,YIELD_MULTIPLIER:2,PREREQUISITE:Mf.COTTON}},ORCHARD:{BERRY:{CROP:Hf.BERRY,GROWTH:25,FRUITING:15,YIELD_MULTIPLIER:1},GRAPE:{CROP:Hf.GRAPE,GROWTH:50,FRUITING:15,YIELD_MULTIPLIER:1},APPLE:{CROP:Hf.APPLE,GROWTH:75,FRUITING:25,YIELD_MULTIPLIER:2}}},vm={SCIENTIFIC_METHOD:{CATEGORY:rm.SCIENCE,COST:[],RESEARCH_POINT:5,DESCRIPTION:"Maybe there is something we don't know about yet?",FINISH_DESCRIPTION:"We learned how to research things",PREREQUISITES:[],FINISH:function(e){e.getLogService().log("New research projects unlocked")}},FORESIGHT:{CATEGORY:rm.SCIENCE,COST:[],RESEARCH_POINT:20,DESCRIPTION:"If only we knew what we don't know",FINISH_DESCRIPTION:"We gained insight into what can be researched in close future",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getTechService().increaseForesight(1),e.getLogService().log("Foresight level increased")}},CARTOGRAPHY:{CATEGORY:rm.SCIENCE,COST:[],RESEARCH_POINT:50,DESCRIPTION:"What if we combine all the information we get from visitors and scouts?",FINISH_DESCRIPTION:"We unlocked world map and gained insight into what happens in the world",PREREQUISITES:[kf.FORESIGHT],FINISH:function(e){e.getGameService().enable(Mf.CARTOGRAPHY),e.getLogService().log("World map unlocked")}},MANAGEMENT:{CATEGORY:rm.GENERAL,COST:[],RESEARCH_POINT:30,DESCRIPTION:"Maybe we could make some hard decisions which could help us survive?",FINISH_DESCRIPTION:"Now we have access to many management options",PREREQUISITES:[kf.FORESIGHT],FINISH:function(e){e.getGameService().enable(Mf.MANAGEMENT),e.getLogService().log("Management tab unlocked")}},TAX:{CATEGORY:rm.GENERAL,COST:[],RESEARCH_POINT:100,DESCRIPTION:"Could we gather money from citizens?",FINISH_DESCRIPTION:"We invented tax and donations",PREREQUISITES:[kf.MANAGEMENT,kf.LONGHOUSE],FINISH:function(e){e.getGameService().enable(Mf.TAX_COLLECTOR),e.getLogService().log("Tax collector unlocked")}},FISHING:{CATEGORY:rm.AGRICULTURE,COST:[{resource:Df.BERRY,amount:20}],RESEARCH_POINT:30,DESCRIPTION:"Could there be something edible in the water?",FINISH_DESCRIPTION:"We learned how to get fish out of the sea",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getGameService().enable(Mf.SEA),e.getLogService().log("Sea unlocked"),e.getGameService().enable(Mf.FISHERS_HUT),e.getLogService().log("Fisher's hut invented")}},ANIMALS:{CATEGORY:rm.AGRICULTURE,COST:[{resource:Df.HAY,amount:20}],RESEARCH_POINT:70,DESCRIPTION:"Is it possible to breed animals near farms?",FINISH_DESCRIPTION:"Now we know how to breed animals on pastures",PREREQUISITES:[kf.AGRICULTURE,kf.HUNTING],FINISH:function(e){e.getGameService().enable(Mf.PASTURE),e.getLogService().log("Pastures invented"),e.getGameService().enable(Mf.BUTCHER),e.getLogService().log("Butcher invented")}},TRADE:{CATEGORY:rm.GENERAL,COST:[],RESEARCH_POINT:50,DESCRIPTION:"If others have resources we need maybe we could trade with them?",FINISH_DESCRIPTION:"We learned how to trade on marketplace",PREREQUISITES:[kf.MANAGEMENT,kf.CARTOGRAPHY],FINISH:function(e){e.getGameService().enable(Mf.MARKETPLACE),e.getLogService().log("Marketplace invented"),e.getResourcesService().makeVisible(Df.COINS)}},TANNERY:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.FUR,amount:20}],RESEARCH_POINT:50,DESCRIPTION:"Could we use dead animals fur in our advantage?",FINISH_DESCRIPTION:"Tanned fur is much better for armour",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.HUNTING],FINISH:function(e){e.getGameService().enable(Mf.TANNERY),e.getLogService().log("Tannery invented"),e.getRecipeService().enable(sm.LEATHER)}},COTTON:{CATEGORY:rm.AGRICULTURE,COST:[],RESEARCH_POINT:50,DESCRIPTION:"Maybe we can plant cotton?",FINISH_DESCRIPTION:"Now we can plant cotton on fields",PREREQUISITES:[kf.AGRICULTURE],FINISH:function(e){e.getGameService().enable(Mf.COTTON),e.getLogService().log("Cotton planting unlocked"),e.getResourcesService().makeVisible(Df.COTTON)}},PARCHMENT:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.FUR,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"What if we make leather even thinner?",FINISH_DESCRIPTION:"We learned how to make parchment (paper) out of fur",PREREQUISITES:[kf.TANNERY],FINISH:function(e){e.getLogService().log("Parchment recipe unlocked"),e.getResourcesService().makeVisible(Df.PAPER),e.getRecipeService().enable(sm.PARCHMENT)}},PAPER_MILL:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.PAPER,amount:5}],RESEARCH_POINT:50,DESCRIPTION:"Maybe we could use trees to make paper?",FINISH_DESCRIPTION:"We invented paper mill where we can produce paper from logs",PREREQUISITES:[kf.PARCHMENT,kf.SAWMILL],FINISH:function(e){e.getLogService().log("Paper mill invented"),e.getGameService().enable(Mf.PAPER_MILL)}},HERBALISM:{CATEGORY:rm.AGRICULTURE,COST:[{resource:Df.HERBS,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Is it possible to effectively plant herbs?",FINISH_DESCRIPTION:"We learned to how to plant herbs on fields",PREREQUISITES:[kf.AGRICULTURE],FINISH:function(e){e.getGameService().enable(Mf.HERBALISM),e.getLogService().log("Herbs planting unlocked"),e.getResourcesService().makeVisible(Df.HERBS)}},FABRIC:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.COTTON,amount:20}],RESEARCH_POINT:50,DESCRIPTION:"Could we make fabric using cotton?",FINISH_DESCRIPTION:"We invented cotton mill and ways to spint cotton into fabric",PREREQUISITES:[kf.COTTON],FINISH:function(e){e.getGameService().enable(Mf.COTTON_MILL),e.getLogService().log("Cotton mill invented"),e.getRecipeService().enable(sm.FABRIC),e.getRecipeService().enable(sm.FABRIC_WOOL)}},TAILORING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.FABRIC,amount:5},{resource:Df.FUR,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"How can me make new clothes?",FINISH_DESCRIPTION:"We can now make clothes out of fabric and fur",PREREQUISITES:[kf.FABRIC],FINISH:function(e){e.getGameService().enable(Mf.TAILOR),e.getLogService().log("Tailor invented"),e.getRecipeService().enable(sm.CLOTHES_FABRIC),e.getRecipeService().enable(sm.CLOTHES_FUR)}},SCHOLAR:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.FOOD,amount:1e4},{resource:Df.PAPER,amount:30}],RESEARCH_POINT:200,DESCRIPTION:"Can we focus on science?",FINISH_DESCRIPTION:"We learned how to research new technologies more efficiently",PREREQUISITES:[kf.PAPER_MILL,kf.IMPROVED_FORESIGHT],FINISH:function(e){e.getGameService().enable(Mf.SCHOLARS_LAB),e.getLogService().log("Scholar labs invented")}},ALCOHOL:{CATEGORY:rm.GENERAL,COST:[],RESEARCH_POINT:100,DESCRIPTION:"Would it boost our moods if we took some time to have fun??",FINISH_DESCRIPTION:"We learned how to plants hops and barley, how to build buildings that will make alcohol and tavern where we can drink it",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.COOKING,kf.AGRICULTURE],FINISH:function(e){e.getGameService().enable(Mf.ALCOHOL),e.getGameService().enable(Mf.TAVERN),e.getLogService().log("Tavern invented"),e.getGameService().enable(Mf.BREWERY),e.getLogService().log("Brewery invented"),e.getGameService().enable(Mf.WINERY),e.getLogService().log("Winery invented"),e.getGameService().enable(Mf.BARLEY),e.getLogService().log("Barley planting unlocked"),e.getResourcesService().makeVisible(Df.BARLEY),e.getGameService().enable(Mf.HOPS),e.getLogService().log("Hops planting unlocked"),e.getResourcesService().makeVisible(Df.HOP),e.getResourcesService().makeVisible(Df.BEER),e.getResourcesService().makeVisible(Df.WINE)}},CALENDAR:{CATEGORY:rm.SCIENCE,COST:[{resource:Df.LOG,amount:10}],RESEARCH_POINT:30,DESCRIPTION:"Is there some pattern to seasons?",FINISH_DESCRIPTION:"Now we know what day it is today",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getGameService().enable(Mf.CALENDAR),e.getLogService().log("We are now able to track years and seasons")}},WEATHER:{CATEGORY:rm.SCIENCE,COST:[{resource:Df.LOG,amount:10},{resource:Df.STONE,amount:10},{resource:Df.PLANK,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"Would it be good to know the weather in advance?",FINISH_DESCRIPTION:"We can now predict weather for a few days ahead",PREREQUISITES:[kf.FORESIGHT],FINISH:function(e){e.getGameService().enable(Mf.WEATHER),e.getLogService().log("We now can predict weather"),e.getWeatherService().increaseForecastPeriod(4)}},AGRICULTURE:{CATEGORY:rm.AGRICULTURE,COST:[{resource:Df.LOG,amount:10},{resource:Df.BERRY,amount:20},{resource:Df.WHEAT,amount:20},{resource:Df.SHOVEL,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Why should we risk looking for food in the forest if we can grow it it the open?",FINISH_DESCRIPTION:"We discovered how to build farms and cultivate crops on fields and orchards",PREREQUISITES:[kf.WEATHER,kf.CALENDAR,kf.STONE_SHOVEL],FINISH:function(e){e.getGameService().isEnabled(Mf.FIELD)||(e.getGameService().enable(Mf.FIELD),e.getLogService().log("Field unlocked")),e.getGameService().enable(Mf.FARM),e.getLogService().log("Farm invented"),e.getResourcesService().makeVisible(Df.WHEAT),e.getResourcesService().makeVisible(Df.BARLEY),e.getResourcesService().makeVisible(Df.HAY),e.getResourcesService().makeVisible(Df.APPLE),e.getResourcesService().makeVisible(Df.GRAPE)}},CROPS_STORAGE:{CATEGORY:rm.AGRICULTURE,COST:[{resource:Df.FOOD,amount:5e3}],RESEARCH_POINT:50,DESCRIPTION:"Would it be more efficient if we had a storage building for crops closer to the fields?",FINISH_DESCRIPTION:"We found out that it is better to have a special building for storing crops",PREREQUISITES:[kf.AGRICULTURE],FINISH:function(e){e.getGameService().enable(Mf.BARN),e.getLogService().log("Barn invented")}},BOW:{CATEGORY:rm.GENERAL,COST:[{resource:Df.LOG,amount:20},{resource:Df.BRUSHWOOD,amount:20}],RESEARCH_POINT:25,DESCRIPTION:"Could we kill without coming closer?",FINISH_DESCRIPTION:"We learned how to craft bows",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(sm.BOW)}},HUNTING:{CATEGORY:rm.GENERAL,COST:[{resource:Df.LOG,amount:5},{resource:Df.BRUSHWOOD,amount:5},{resource:Df.STONE,amount:5},{resource:Df.BOW,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"What if hunted became the hunter?",FINISH_DESCRIPTION:"We learned how to hunt animals in the forest",PREREQUISITES:[kf.BOW],FINISH:function(e){e.getGameService().enable(Mf.HUNTER),e.getLogService().log("Hunter invented")}},FIRE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.BRUSHWOOD,amount:20},{resource:Df.STONE,amount:2}],RESEARCH_POINT:30,DESCRIPTION:"Would it be useful if we could start fire on demand?",FINISH_DESCRIPTION:"We discovered ways to process brushwood into more efficient fuel",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getGameService().enable(Mf.FIRE),e.getRecipeService().enable(sm.FUEL_BRUSHWOOD)}},BIGGER_FIRE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:10},{resource:Df.STONE,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Could we make our fire bigger and last for longer?",FINISH_DESCRIPTION:"We learned how to turn logs into fuel",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.FIRE],FINISH:function(e){e.getRecipeService().enable(sm.FUEL_LOG)}},COOKING:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FUEL,amount:20},{resource:Df.BERRY,amount:20},{resource:Df.MUSHROOM,amount:20}],RESEARCH_POINT:30,DESCRIPTION:"What would happen if we heat up raw food?",FINISH_DESCRIPTION:"We discovered the art of cooking. We can prepare things with more nutrition value",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.FIRE],FINISH:function(e){e.getRecipeService().enable(sm.COOKED_MEAT),e.getRecipeService().enable(sm.COOKED_FISH),e.getRecipeService().enable(sm.BREAD),e.getRecipeService().enable(sm.VEGETABLE_SOUP_BERRY),e.getRecipeService().enable(sm.VEGETABLE_SOUP_MUSHROOM),e.getRecipeService().enable(sm.VEGETABLE_SOUP_BERRY_MUSHROOM),e.getRecipeService().enable(sm.MEAT_SOUP),e.getRecipeService().enable(sm.CHEESE)}},IMPROVED_COOKING:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FUEL,amount:30},{resource:Df.EGG,amount:20},{resource:Df.FLOUR,amount:20}],RESEARCH_POINT:70,DESCRIPTION:"Are there any better things to cook?",FINISH_DESCRIPTION:"We invented new cooking recipes",PREREQUISITES:[kf.COOKING,kf.BIGGER_FIRE],FINISH:function(e){e.getRecipeService().enable(sm.OMELETTE),e.getRecipeService().enable(sm.PIE)}},KITCHEN:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FUEL,amount:20},{resource:Df.CUT_STONE,amount:5},{resource:Df.COPPER,amount:2},{resource:Df.POTTERY,amount:5}],RESEARCH_POINT:70,DESCRIPTION:"Can we improve food production rate?",FINISH_DESCRIPTION:"We realised that specialised building for food making can improve cooking speed",PREREQUISITES:[kf.COOKING,kf.POTTERY],FINISH:function(e){e.getGameService().enable(Mf.KITCHEN),e.getLogService().log("Kitchen invented"),e.getLogService().log("Kitchen orders can be now placed in it's own submenu of crafting menu")}},BAKERY:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FUEL,amount:20},{resource:Df.FLOUR,amount:20},{resource:Df.CUT_STONE,amount:10}],RESEARCH_POINT:70,DESCRIPTION:"Could we improve bread making?",FINISH_DESCRIPTION:"We found out that by using special bread ovens we can greatly increase bread production",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.COOKING],FINISH:function(e){e.getGameService().enable(Mf.BAKERY),e.getLogService().log("Bakery invented")}},MORTAR:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.STONE,amount:20}],RESEARCH_POINT:20,DESCRIPTION:"Would it be useful to grind things up?",FINISH_DESCRIPTION:"Now we can grind things up",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(sm.FLOUR)}},STONE_SPEAR:{CATEGORY:rm.MILITARY,COST:[{resource:Df.STONE,amount:10},{resource:Df.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"Would we have better chance of survival if we keep enemy at distance?",FINISH_DESCRIPTION:"We learned how to craft stone spear",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(sm.STONE_SPEAR)}},STONE_AXE:{CATEGORY:rm.GENERAL,COST:[{resource:Df.STONE,amount:10},{resource:Df.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"It's probably more effective to hit trees with sharp stone?",FINISH_DESCRIPTION:"We learned how to craft stone axe",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(sm.STONE_AXE)}},STONE_PICKAXE:{CATEGORY:rm.GENERAL,COST:[{resource:Df.STONE,amount:10},{resource:Df.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"Would stone win against stone?",FINISH_DESCRIPTION:"We learned how to craft stone pickaxe",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(sm.STONE_PICKAXE)}},STONE_HAMMER:{CATEGORY:rm.GENERAL,COST:[{resource:Df.STONE,amount:10},{resource:Df.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"Can hitting with stone be easier?",FINISH_DESCRIPTION:"We learned how to craft stone hammer",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(sm.STONE_HAMMER)}},STONE_SHOVEL:{CATEGORY:rm.GENERAL,COST:[{resource:Df.STONE,amount:10},{resource:Df.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"It should be better to get your stone dirty and not your hands?",FINISH_DESCRIPTION:"We learned how to craft stone shovel",PREREQUISITES:[kf.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(sm.STONE_SHOVEL)}},COPPER_TOOLS:{CATEGORY:rm.GENERAL,COST:[{resource:Df.LOG,amount:20},{resource:Df.COPPER,amount:20},{resource:Df.HAMMER,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Could we make better tools with metal instead of stone? ",FINISH_DESCRIPTION:"We learned how to craft copper tools",PREREQUISITES:[kf.ORE_PROCESSING,kf.STONE_SHOVEL,kf.STONE_PICKAXE,kf.STONE_AXE,kf.STONE_HAMMER,kf.STONE_SPEAR],FINISH:function(e){e.getRecipeService().enable(sm.COPPER_AXE),e.getRecipeService().enable(sm.COPPER_PICKAXE),e.getRecipeService().enable(sm.COPPER_SHOVEL),e.getRecipeService().enable(sm.COPPER_SPEAR),e.getRecipeService().enable(sm.COPPER_HAMMER),e.getRecipeService().enable(sm.COPPER_NAILS)}},BRONZE_TOOLS:{CATEGORY:rm.GENERAL,COST:[{resource:Df.LOG,amount:20},{resource:Df.BRONZE,amount:20},{resource:Df.HAMMER,amount:2}],RESEARCH_POINT:100,DESCRIPTION:"Would bronze tools be even better than copper ones?",FINISH_DESCRIPTION:"We learned how to craft bronze tools",PREREQUISITES:[kf.COPPER_TOOLS,kf.METALLURGY],FINISH:function(e){e.getRecipeService().enable(sm.BRONZE_AXE),e.getRecipeService().enable(sm.BRONZE_PICKAXE),e.getRecipeService().enable(sm.BRONZE_SHOVEL),e.getRecipeService().enable(sm.BRONZE_SPEAR),e.getRecipeService().enable(sm.BRONZE_HAMMER),e.getRecipeService().enable(sm.BRONZE_NAILS),e.getRecipeService().enable(sm.BRONZE_SWORD),e.getRecipeService().enable(sm.BRONZE_SHIELD)}},IRON_TOOLS:{CATEGORY:rm.GENERAL,COST:[{resource:Df.LOG,amount:20},{resource:Df.IRON,amount:20},{resource:Df.HAMMER,amount:2}],RESEARCH_POINT:200,DESCRIPTION:"Can we craft tools from iron?",FINISH_DESCRIPTION:"We learned how to craft iron tools",PREREQUISITES:[kf.BRONZE_TOOLS,kf.MASTER_ORE_PROCESSING],FINISH:function(e){e.getRecipeService().enable(sm.IRON_AXE),e.getRecipeService().enable(sm.IRON_PICKAXE),e.getRecipeService().enable(sm.IRON_SHOVEL),e.getRecipeService().enable(sm.IRON_SPEAR),e.getRecipeService().enable(sm.IRON_HAMMER),e.getRecipeService().enable(sm.IRON_NAILS),e.getRecipeService().enable(sm.IRON_SWORD),e.getRecipeService().enable(sm.IRON_SHIELD)}},MINING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:10},{resource:Df.STONE,amount:5},{resource:Df.PICKAXE,amount:1}],RESEARCH_POINT:50,DESCRIPTION:"If we dig deep enough maybe there is something nice?",FINISH_DESCRIPTION:"We discovered that stone can be harvested in the mountains",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.STONE_PICKAXE],FINISH:function(e){e.getGameService().isEnabled(Mf.MOUNTAINS)||(e.getGameService().enable(Mf.MOUNTAINS),e.getLogService().log("Mountains unlocked"))}},DIGGING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:10},{resource:Df.SHOVEL,amount:1}],RESEARCH_POINT:30,DESCRIPTION:"How can we move soil away efficiently?",FINISH_DESCRIPTION:"We discovered good ways of digging",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.STONE_SHOVEL],FINISH:function(e){e.getGameService().isEnabled(Mf.FIELD)||(e.getGameService().enable(Mf.FIELD),e.getLogService().log("Field unlocked")),e.getGameService().enable(Mf.CLAY_PIT),e.getLogService().log("Clay pit unlocked"),e.getResourcesService().makeVisible(Df.CLAY)}},POTTERY:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:10},{resource:Df.FUEL,amount:5},{resource:Df.CLAY,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"Can we do something useful with all that clay?",FINISH_DESCRIPTION:"We invented how to make pottery from clay",PREREQUISITES:[kf.DIGGING,kf.FIRE],FINISH:function(e){e.getRecipeService().enable(sm.POTTERY),e.getResourcesService().makeVisible(Df.POTTERY)}},BRICKS:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:10},{resource:Df.FUEL,amount:5},{resource:Df.CLAY,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we can use clay for building?",FINISH_DESCRIPTION:"We discovered how to make bricks from clay and hay",PREREQUISITES:[kf.POTTERY,kf.BIGGER_FIRE,kf.LONGHOUSE],FINISH:function(e){e.getRecipeService().enable(sm.BRICKS),e.getResourcesService().makeVisible(Df.BRICKS)}},PROSPECTING_FOR_ORE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.PICKAXE,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"There must be something useful under all this dirt",FINISH_DESCRIPTION:"We discovered that trained geologist can find ores deposits in the mountains",PREREQUISITES:[kf.MINING],FINISH:function(e){e.getGameService().enable(Mf.GEOLOGIST),e.getLogService().log("Geologist invented")}},ADVANCED_PROSPECTING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.PICKAXE,amount:20}],RESEARCH_POINT:75,DESCRIPTION:"There must be something even more valuable under the ground?",FINISH_DESCRIPTION:"We learned about more resources that mountains have to offer",PREREQUISITES:[kf.PROSPECTING_FOR_ORE],FINISH:function(e){e.getGameService().enable(Mf.GOLD),e.getGameService().enable(Mf.SILVER)}},MASTER_PROSPECTING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.PICKAXE,amount:40}],RESEARCH_POINT:100,DESCRIPTION:"Is there anything else to find?",FINISH_DESCRIPTION:"We discovered iron",PREREQUISITES:[kf.ADVANCED_PROSPECTING,kf.IMPROVED_FORESIGHT],FINISH:function(e){e.getGameService().enable(Mf.IRON)}},PIT_MINE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.STONE,amount:20},{resource:Df.LOG,amount:20},{resource:Df.PICKAXE,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Could we get precious resources from under the ground?",FINISH_DESCRIPTION:"We invented a way to mine ore deposits from the ground",PREREQUISITES:[kf.PROSPECTING_FOR_ORE],FLAG_PREREQUISITES:[Mf.BUILT_QUARRY],FINISH:function(e){e.getGameService().enable(Mf.PIT_MINE),e.getLogService().log("Pit mine invented"),e.getRecipeService().enable(sm.FUEL_COAL)}},DEEP_MINE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:40},{resource:Df.PLANK,amount:40},{resource:Df.CUT_STONE,amount:20},{resource:Df.PICKAXE,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Do we have to move all the dirt or could we just dig tunnels?",FINISH_DESCRIPTION:"It's now possible to build deep mines to mine ore",PREREQUISITES:[kf.PIT_MINE,kf.ADVANCED_MATHEMATICS],FLAG_PREREQUISITES:[],FINISH:function(e){e.getGameService().enable(Mf.DEEP_MINE),e.getLogService().log("Deep mine invented")}},ORE_PROCESSING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.CUT_STONE,amount:40},{resource:Df.STONE,amount:20},{resource:Df.HAMMER,amount:10},{resource:Df.COPPER_ORE,amount:20}],RESEARCH_POINT:100,DESCRIPTION:"What happens if we heat ore in fire?",FINISH_DESCRIPTION:"We discovered how to process ore into metal",PREREQUISITES:[kf.PROSPECTING_FOR_ORE],FINISH:function(e){e.getGameService().enable(Mf.SMITHY),e.getLogService().log("Smithy invented")}},ADVANCED_ORE_PROCESSING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.CUT_STONE,amount:40},{resource:Df.STONE,amount:20},{resource:Df.HAMMER,amount:5},{resource:Df.GOLD_ORE,amount:5},{resource:Df.SILVER_ORE,amount:5}],RESEARCH_POINT:150,DESCRIPTION:"What about heating other ores?",FINISH_DESCRIPTION:"We discovered how to process gold and silver ore",PREREQUISITES:[kf.ADVANCED_PROSPECTING,kf.ORE_PROCESSING],FLAG_PREREQUISITES:[Mf.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(Mf.ADVANCED_ORE_PROCESSING),e.getGameService().isEnabled(Mf.BUILT_SMITHY)&&(e.getRecipeService().enable(sm.GOLD),e.getRecipeService().enable(sm.SILVER))}},MASTER_ORE_PROCESSING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.CUT_STONE,amount:40},{resource:Df.STONE,amount:20},{resource:Df.HAMMER,amount:5},{resource:Df.IRON_ORE,amount:10}],RESEARCH_POINT:200,DESCRIPTION:"Can we smelt any ore we want?",FINISH_DESCRIPTION:"We learned to process iron ore",PREREQUISITES:[kf.MASTER_PROSPECTING,kf.ADVANCED_ORE_PROCESSING],FLAG_PREREQUISITES:[Mf.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(Mf.IRON),e.getGameService().isEnabled(Mf.BUILT_SMITHY)&&e.getRecipeService().enable(sm.IRON)}},METALLURGY:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.COPPER,amount:10},{resource:Df.TIN,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"What would happen if we mix two metals?",FINISH_DESCRIPTION:"We discovered that mixing multiple metals can give better results",PREREQUISITES:[kf.ORE_PROCESSING],FLAG_PREREQUISITES:[Mf.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(Mf.BRONZE),e.getGameService().isEnabled(Mf.BUILT_SMITHY)&&e.getRecipeService().enable(sm.BRONZE)}},ADVANCED_METALLURGY:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.IRON,amount:10},{resource:Df.COAL,amount:50}],RESEARCH_POINT:200,DESCRIPTION:"Could we mix iron with coal to make it stronger?",FINISH_DESCRIPTION:"We invented steel",PREREQUISITES:[kf.MASTER_ORE_PROCESSING],FLAG_PREREQUISITES:[Mf.BUILT_SMITHY,Mf.IRON],FINISH:function(e){e.getGameService().enable(Mf.STEEL),e.getGameService().isEnabled(Mf.BUILT_SMITHY)&&e.getRecipeService().enable(sm.STEEL)}},COINS_MINTING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.GOLD,amount:10},{resource:Df.SILVER,amount:20}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we can make our own coins?",FINISH_DESCRIPTION:"We learned how to mint our own coins",PREREQUISITES:[kf.ADVANCED_ORE_PROCESSING],FLAG_PREREQUISITES:[Mf.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(Mf.MINT),e.getLogService().log("Mint invented")}},JEWELRY:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.GOLD,amount:10},{resource:Df.SILVER,amount:20},{resource:Df.GEMS,amount:5}],RESEARCH_POINT:200,DESCRIPTION:"Could we show our status by wearing expensive and beautiful things?",FINISH_DESCRIPTION:"We learned how to make jewelry",PREREQUISITES:[kf.COINS_MINTING],FINISH:function(e){e.getGameService().enable(Mf.JEWELRY),e.getRecipeService().enable(sm.JEWELRY),e.getLogService().log("Jewelry invented")}},HOUSE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],RESEARCH_POINT:100,DESCRIPTION:"What if huts were bigger?",FINISH_DESCRIPTION:"We learned how to build bigger and more efficient buildings for living",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.STONE_HAMMER,kf.STONE_SHOVEL],FINISH:function(e){e.getGameService().enable(Mf.HOUSE),e.getLogService().log("House invented")}},LONGHOUSE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50},{resource:Df.CUT_STONE,amount:20},{resource:Df.HAY,amount:20},{resource:Df.HAMMER,amount:5}],RESEARCH_POINT:200,DESCRIPTION:"Could we house multiple families in one building?",FINISH_DESCRIPTION:"Now we can build longhouses that can house multiple families",PREREQUISITES:[kf.HOUSE,kf.AGRICULTURE],FINISH:function(e){e.getGameService().enable(Mf.LONGHOUSE),e.getLogService().log("Longhouse invented")}},TUDOR_HOUSE:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:70},{resource:Df.PLANK,amount:50},{resource:Df.BRICKS,amount:40},{resource:Df.HAMMER,amount:10}],RESEARCH_POINT:400,DESCRIPTION:"Can we use better building materials to build bigger houses?",FINISH_DESCRIPTION:"We worked out how to build tudor houses",PREREQUISITES:[kf.LONGHOUSE,kf.BRICKS],FINISH:function(e){e.getGameService().enable(Mf.TUDOR_HOUSE),e.getLogService().log("Tudor House invented")}},SETTLEMENT:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:70},{resource:Df.PLANK,amount:50},{resource:Df.BRICKS,amount:40},{resource:Df.NAILS,amount:50},{resource:Df.HAMMER,amount:10}],RESEARCH_POINT:800,DESCRIPTION:"Could we build a new settlement to house more people?",FINISH_DESCRIPTION:"We can now construct whole settlements",PREREQUISITES:[kf.TUDOR_HOUSE,kf.BRICKS,kf.TAILORING,kf.COPPER_TOOLS],FINISH:function(e){e.getGameService().enable(Mf.SETTLEMENT),e.getLogService().log("Settlements invented")}},URBAN_PLANNING:{CATEGORY:rm.SCIENCE,COST:[],RESEARCH_POINT:50,DESCRIPTION:"Maybe we could rearrange buildings?",FINISH_DESCRIPTION:"Now we can combine and split some buildings like fields, orchards, pastures and warehouses",PREREQUISITES:[kf.MANAGEMENT,kf.MATHEMATICS],FINISH:function(e){e.getGameService().enable(Mf.URBAN_PLANNING)}},WONDER_BUILDINGS:{CATEGORY:rm.GENERAL,COST:[],RESEARCH_POINT:500,DESCRIPTION:"What if we built something remarkable?",FINISH_DESCRIPTION:"We learned that by building wonders we can boost future generations progress",PREREQUISITES:[kf.HOUSE,kf.URBAN_PLANNING,kf.ADVANCED_MATHEMATICS],FINISH:function(e){e.getGameService().enable(Mf.PLATEAU),e.getLogService().log("Plateau unlocked")}},SAWMILL:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:10},{resource:Df.COPPER,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Is it possible to produce planks even faster?",FINISH_DESCRIPTION:"We discovered sawmill that efficiently turns logs into planks",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.STONE_HAMMER,kf.STONE_AXE],FINISH:function(e){e.getGameService().enable(Mf.SAWMILL),e.getLogService().log("Sawmill invented")}},WINDMILL:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:10},{resource:Df.COPPER,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Could we use wind to do hard work for us?",FINISH_DESCRIPTION:"We invented windmill that can effortlessly turn wheat into flour",PREREQUISITES:[kf.AGRICULTURE,kf.MORTAR,kf.MATHEMATICS],FINISH:function(e){e.getGameService().enable(Mf.WINDMILL),e.getLogService().log("Windmill invented"),e.getResourcesService().makeVisible(Df.FABRIC)}},FORESTRY:{CATEGORY:rm.AGRICULTURE,COST:[{resource:Df.LOG,amount:20},{resource:Df.BRUSHWOOD,amount:20},{resource:Df.SHOVEL,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Is there any reason why trees grow out of dirt?",FINISH_DESCRIPTION:"We now can hire foresters to plant new trees and manage forest better",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.MANAGEMENT,kf.STONE_SHOVEL],FINISH:function(e){e.getGameService().enable(Mf.FORESTER),e.getLogService().log("Forester invented"),e.getLogService().log("Forest management unlocked")}},BARRACKS:{CATEGORY:rm.MILITARY,COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:20},{resource:Df.SPEAR,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"How can we make those of us more aggressive less of a threat to others?",FINISH_DESCRIPTION:"We found out that we can form army and use it to our advantage",PREREQUISITES:[kf.SCIENTIFIC_METHOD,kf.CALENDAR,kf.STONE_SPEAR],FINISH:function(e){e.getGameService().isEnabled(Mf.FORT)||(e.getGameService().enable(Mf.FORT),e.getLogService().log("Fort unlocked")),e.getRecipeService().enable(sm.WOODEN_SHIELD),e.getRecipeService().enable(sm.LEATHER_ARMOR),e.getGameService().enable(Mf.BARRACKS),e.getLogService().log("Barracks invented")}},STASH:{CATEGORY:rm.MILITARY,COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10}],RESEARCH_POINT:30,DESCRIPTION:"Can we hide our goods somewhere?",FINISH_DESCRIPTION:"We learned how to hide goods from invaders",PREREQUISITES:[kf.FORESIGHT],FINISH:function(e){e.getGameService().isEnabled(Mf.FORT)||(e.getGameService().enable(Mf.FORT),e.getLogService().log("Fort unlocked")),e.getGameService().enable(Mf.STASH)}},WOODEN_DEFENCES:{CATEGORY:rm.MILITARY,COST:[{resource:Df.LOG,amount:50}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we could use logs to defend ourselves?",FINISH_DESCRIPTION:"Now we can build simple wooden defences that will delay invasions",PREREQUISITES:[kf.BARRACKS],FINISH:function(e){e.getGameService().enable(Mf.STOCKADE),e.getLogService().log("Stockade invented"),e.getGameService().enable(Mf.WOODEN_TOWER),e.getLogService().log("Wooden tower invented")}},STONE_DEFENCES:{CATEGORY:rm.MILITARY,COST:[{resource:Df.STONE,amount:50},{resource:Df.CUT_STONE,amount:50}],RESEARCH_POINT:200,DESCRIPTION:"Maybe we could use stone to defend ourselves?",FINISH_DESCRIPTION:"We learned how to build more durable defences",PREREQUISITES:[kf.WOODEN_DEFENCES],FINISH:function(e){e.getGameService().enable(Mf.STONE_TOWER),e.getLogService().log("Stone tower invented")}},MATHEMATICS:{CATEGORY:rm.SCIENCE,COST:[{resource:Df.FOOD,amount:1e3}],RESEARCH_POINT:50,DESCRIPTION:"What if we calculate things first?",FINISH_DESCRIPTION:"By calculating things we are better at constructing and deconstructing buildings",PREREQUISITES:[kf.FORESIGHT],FINISH:function(e){e.getEffectsService().addBuildingEffect(new nm("Mathematics",Lf.CONSTRUCTION,10,om.PERMANENT)),e.getEffectsService().addBuildingEffect(new nm("Mathematics",Lf.DECONSTRUCTION,10,om.PERMANENT))}},ADVANCED_MATHEMATICS:{CATEGORY:rm.SCIENCE,COST:[{resource:Df.FOOD,amount:4e3},{resource:Df.PAPER,amount:20}],RESEARCH_POINT:200,DESCRIPTION:"Are there any better ways of calculations?",FINISH_DESCRIPTION:"Our calculations methods improved and we are now able to research more advanced things",PREREQUISITES:[kf.MATHEMATICS,kf.PARCHMENT],FINISH:function(e){}},IMPROVED_FORESIGHT:{CATEGORY:rm.SCIENCE,COST:[{resource:Df.FOOD,amount:5e3},{resource:Df.PAPER,amount:50}],RESEARCH_POINT:300,DESCRIPTION:"Can we use our knowledge to foresight what we could learn?",FINISH_DESCRIPTION:"With our knowledge we can look further into the unknown and foresight future researches",PREREQUISITES:[kf.ADVANCED_MATHEMATICS,kf.PARCHMENT],FINISH:function(e){e.getTechService().increaseForesight(1),e.getLogService().log("Foresight level increased")}},LOGISTICS:{CATEGORY:rm.MILITARY,COST:[{resource:Df.STONE,amount:100},{resource:Df.CLOTHES,amount:25}],RESEARCH_POINT:200,DESCRIPTION:"Can we improve travel speed between world regions?",FINISH_DESCRIPTION:"With improved military clothing and roads we can move faster between world regions",PREREQUISITES:[kf.ADVANCED_MATHEMATICS],FINISH:function(e){e.getGameService().enable(Mf.LOGISTICS),e.getLogService().log("Logistics invented")}},FERTILIZER:{CATEGORY:rm.AGRICULTURE,COST:[{resource:Df.FOOD,amount:3e3}],RESEARCH_POINT:100,DESCRIPTION:"Could we reuse what animals produce?",FINISH_DESCRIPTION:"By using animals manure we boost growth on fields and orchards",PREREQUISITES:[kf.ANIMALS],FINISH:function(e){e.getEffectsService().addBuildingEffect(new nm("Fertilizer",Lf.FIELD,10,om.PERMANENT)),e.getEffectsService().addBuildingEffect(new nm("Fertilizer",Lf.ORCHARD,10,om.PERMANENT))}},PICKAXE_DESIGN:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:10},{resource:Df.CUT_STONE,amount:10},{resource:Df.PICKAXE,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we could redesign our pickaxes?",FINISH_DESCRIPTION:"We discovered different pickaxe design that improved mining speed",PREREQUISITES:[kf.MINING],FINISH:function(e){e.getEffectsService().addBuildingEffect(new nm("Pickaxe Design",Lf.QUARRY,10,om.PERMANENT)),e.getEffectsService().addBuildingEffect(new nm("Pickaxe Design",Lf.PIT_MINE,10,om.PERMANENT)),e.getEffectsService().addBuildingEffect(new nm("Pickaxe Design",Lf.GEOLOGIST,10,om.PERMANENT)),e.getEffectsService().addBuildingEffect(new nm("Pickaxe Design",Lf.DEEP_MINE,10,om.PERMANENT))}},TRADE_ROUTES:{CATEGORY:rm.GENERAL,COST:[{resource:Df.COINS,amount:400}],RESEARCH_POINT:50,DESCRIPTION:"Is it possible to attract more merchants?",FINISH_DESCRIPTION:"By optimizing roads system we will have more visiting merchants",PREREQUISITES:[kf.TRADE,kf.MATHEMATICS],FINISH:function(e){e.getEffectsService().addBuildingEffect(new nm("Trade Routes",Lf.MARKETPLACE,15,om.PERMANENT))}},BUFF_PRODUCTION:{CATEGORY:rm.GENERAL,COST:[{resource:Df.AXE,amount:2},{resource:Df.SHOVEL,amount:2},{resource:Df.PICKAXE,amount:2},{resource:Df.HAMMER,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Would people work better if we give them better tools?",FINISH_DESCRIPTION:"Now we can replace used tools to boost some buildings production",PREREQUISITES:[kf.MANAGEMENT],FINISH:function(e){e.getGameService().enable(Mf.BUFFS),e.getLogService().log("Production buffs invented")}},HUMAN_RESOURCES:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FOOD,amount:5e3}],RESEARCH_POINT:50,DESCRIPTION:"Maybe we can optimize work?",FINISH_DESCRIPTION:"We discovered automated work management for some buildings",PREREQUISITES:[kf.MANAGEMENT],FINISH:function(e){e.getGameService().enable(Mf.HUMAN_RESOURCES),e.getLogService().log("Automated work management available in management tab")}},BUILDERS_GUILD:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FOOD,amount:5e3},{resource:Df.HAMMER,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Can we send unemployed to work?",FINISH_DESCRIPTION:"We learned that by creating builders guild we can send unemployed villagers to work",PREREQUISITES:[kf.HUMAN_RESOURCES,kf.SAWMILL],FINISH:function(e){e.getGameService().enable(Mf.BUILDERS_GUILD),e.getLogService().log("Builders guild unlocked")}},SPECIALISED_PRODUCTION:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.FOOD,amount:3e3},{resource:Df.HAMMER,amount:5},{resource:Df.AXE,amount:5},{resource:Df.PICKAXE,amount:5},{resource:Df.SHOVEL,amount:5}],RESEARCH_POINT:50,DESCRIPTION:"Can we specialise in crafting one thing to do it better and faster?",FINISH_DESCRIPTION:"We realized that if we focus on crafting only one thing we can do it more efficiently",PREREQUISITES:[kf.MATHEMATICS,kf.STONE_HAMMER,kf.STONE_AXE,kf.STONE_PICKAXE,kf.STONE_SHOVEL],FINISH:function(e){e.getGameService().enable(Mf.SPECIALISED_PRODUCTION),e.getLogService().log("Manufacture invented")}},HERBAL_MEDICINE:{CATEGORY:rm.SCIENCE,COST:[{resource:Df.HERBS,amount:20}],RESEARCH_POINT:25,DESCRIPTION:"Would we heal faster if we used herbs?",FINISH_DESCRIPTION:"We learned how to craft medicine from herbs",PREREQUISITES:[kf.MORTAR],FINISH:function(e){e.getRecipeService().enable(sm.HERBAL_MEDICINE)}},PRODUCTION_ZONES:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FOOD,amount:5e3}],RESEARCH_POINT:50,DESCRIPTION:"Would creating production camps help with productivity?",FINISH_DESCRIPTION:"We discovered that groups of production buildings can increase production",PREREQUISITES:[kf.HUMAN_RESOURCES],FINISH:function(e){e.getGameService().enable(Mf.PRODUCTION_ZONES),e.getLogService().log("Unlocked buildings camps")}},BOAT_BUILDING:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:100},{resource:Df.NAILS,amount:50},{resource:Df.FABRIC,amount:20}],RESEARCH_POINT:200,DESCRIPTION:"Could we utilize floating things to find better fishing spots or get from one place to another?",FINISH_DESCRIPTION:"We invented boats and boats builders",PREREQUISITES:[kf.FISHING,kf.COPPER_TOOLS],FINISH:function(e){e.getGameService().enable(Mf.PIER),e.getGameService().enable(Mf.BOAT_BUILDER),e.getLogService().log("Invented boat builder and pier")}},CANNON:{CATEGORY:rm.MILITARY,COST:[{resource:Df.IRON,amount:50},{resource:Df.LOG,amount:50}],RESEARCH_POINT:200,DESCRIPTION:"How can we make our ships perform better in fights?",FINISH_DESCRIPTION:"We invented cannons that we can put on our ships",PREREQUISITES:[kf.MASTER_ORE_PROCESSING,kf.BOAT_BUILDING],FINISH:function(e){e.getRecipeService().enable(sm.CANNON),e.getLogService().log("Invented cannons crafting")}},BIGGER_SHIPS:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:200},{resource:Df.NAILS,amount:200},{resource:Df.HAMMER,amount:40},{resource:Df.FABRIC,amount:50}],RESEARCH_POINT:400,DESCRIPTION:"Could our ships get bigger?",FINISH_DESCRIPTION:"We invented new ship design and construction methods",PREREQUISITES:[kf.BOAT_BUILDING,kf.CANNON],FINISH:function(e){e.getGameService().enable(Mf.HARBOUR),e.getGameService().enable(Mf.SHIPYARD),e.getGameService().enable(Mf.BRIGANTINE),e.getLogService().log("Invented Harbour, Shipyard and Brigantine")}},GALLEON:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:200},{resource:Df.NAILS,amount:200},{resource:Df.HAMMER,amount:40},{resource:Df.FABRIC,amount:60}],RESEARCH_POINT:700,DESCRIPTION:"How can we build even bigger ships?",FINISH_DESCRIPTION:"We learned how to build huge ships",PREREQUISITES:[kf.BIGGER_SHIPS],FINISH:function(e){e.getGameService().enable(Mf.GALLEON),e.getLogService().log("Invented Galleons")}},SEA_NAVIGATION:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.CUT_STONE,amount:50},{resource:Df.BRICKS,amount:50},{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50}],RESEARCH_POINT:300,DESCRIPTION:"Can we improve sea navigation?",FINISH_DESCRIPTION:"We invented lighthouse to guide our ships at the sea",PREREQUISITES:[kf.BIGGER_SHIPS],FINISH:function(e){e.getGameService().enable(Mf.LIGHTHOUSE),e.getLogService().log("Invented Lighthouse")}},SEA_CARTOGRAPHY:{CATEGORY:rm.TECHNOLOGY,COST:[{resource:Df.FOOD,amount:5e3}],RESEARCH_POINT:300,DESCRIPTION:"Can we discover new lands across the sea?",FINISH_DESCRIPTION:"We discovered what data to gather from the sea to help create maps to distant lands",PREREQUISITES:[kf.SEA_NAVIGATION],FINISH:function(e){e.getGameService().enable(Mf.CARTOGRAPHER),e.getResourcesService().makeVisible(Df.MAP),e.getLogService().log("Invented sea cartographer")}},SEA_CUISINE:{CATEGORY:rm.GENERAL,COST:[{resource:Df.FISH,amount:30},{resource:Df.HERBS,amount:20},{resource:Df.BREAD,amount:10}],RESEARCH_POINT:200,DESCRIPTION:"Can we make better dishes from what sea offers?",FINISH_DESCRIPTION:"We invented how to craft Bouillabaisse",PREREQUISITES:[kf.KITCHEN,kf.FISHING,kf.BAKERY],FINISH:function(e){e.getRecipeService().enable(sm.BOUILLABAISSE),e.getLogService().log("Invented Bouillabaisse")}}},Rm={START_CRAFTING_QUEUE_SIZE:2,START_COOKING_QUEUE_SIZE:2,RECIPES:{PLANK:{RESOURCE:Df.PLANK,AMOUNT:1,COST:[{resource:Df.LOG,amount:5}],CRAFTING:5},CUT_STONE:{RESOURCE:Df.CUT_STONE,AMOUNT:1,COST:[{resource:Df.STONE,amount:5}],CRAFTING:10},LEATHER:{RESOURCE:Df.LEATHER,AMOUNT:1,COST:[{resource:Df.FUR,amount:2}],CRAFTING:10},POTTERY:{RESOURCE:Df.POTTERY,AMOUNT:1,COST:[{resource:Df.FUEL,amount:1},{resource:Df.CLAY,amount:4}],CRAFTING:13},BRICKS:{RESOURCE:Df.BRICKS,AMOUNT:1,COST:[{resource:Df.FUEL,amount:1},{resource:Df.CLAY,amount:5},{resource:Df.HAY,amount:1}],CRAFTING:15},STONE_AXE:{NAME:"STONE AXE",RESOURCE:Df.AXE,AMOUNT:1,COST:[{resource:Df.BRUSHWOOD,amount:1},{resource:Df.LOG,amount:2},{resource:Df.STONE,amount:5}],CRAFTING:15},STONE_PICKAXE:{NAME:"STONE PICKAXE",RESOURCE:Df.PICKAXE,AMOUNT:1,COST:[{resource:Df.BRUSHWOOD,amount:1},{resource:Df.LOG,amount:2},{resource:Df.STONE,amount:5}],CRAFTING:15},STONE_SHOVEL:{NAME:"STONE SHOVEL",RESOURCE:Df.SHOVEL,AMOUNT:1,COST:[{resource:Df.BRUSHWOOD,amount:1},{resource:Df.LOG,amount:2},{resource:Df.STONE,amount:5}],CRAFTING:15},STONE_SPEAR:{NAME:"STONE SPEAR",RESOURCE:Df.SPEAR,AMOUNT:1,COST:[{resource:Df.BRUSHWOOD,amount:1},{resource:Df.LOG,amount:2},{resource:Df.STONE,amount:5}],CRAFTING:15},STONE_HAMMER:{NAME:"STONE HAMMER",RESOURCE:Df.HAMMER,AMOUNT:1,COST:[{resource:Df.BRUSHWOOD,amount:1},{resource:Df.LOG,amount:2},{resource:Df.STONE,amount:5}],CRAFTING:15},COPPER_AXE:{NAME:"COPPER AXE",RESOURCE:Df.AXE,AMOUNT:2,COST:[{resource:Df.LOG,amount:2},{resource:Df.COPPER,amount:1}],CRAFTING:12},COPPER_PICKAXE:{NAME:"COPPER PICKAXE",RESOURCE:Df.PICKAXE,AMOUNT:2,COST:[{resource:Df.LOG,amount:2},{resource:Df.COPPER,amount:1}],CRAFTING:12},COPPER_SHOVEL:{NAME:"COPPER SHOVEL",RESOURCE:Df.SHOVEL,AMOUNT:2,COST:[{resource:Df.LOG,amount:2},{resource:Df.COPPER,amount:1}],CRAFTING:12},COPPER_SPEAR:{NAME:"COPPER SPEAR",RESOURCE:Df.SPEAR,AMOUNT:2,COST:[{resource:Df.LOG,amount:2},{resource:Df.COPPER,amount:1}],CRAFTING:12},COPPER_HAMMER:{NAME:"COPPER HAMMER",RESOURCE:Df.HAMMER,AMOUNT:2,COST:[{resource:Df.LOG,amount:2},{resource:Df.COPPER,amount:1}],CRAFTING:12},COPPER_NAILS:{NAME:"COPPER NAILS",RESOURCE:Df.NAILS,AMOUNT:4,COST:[{resource:Df.COPPER,amount:2}],CRAFTING:6},BRONZE_AXE:{NAME:"BRONZE AXE",RESOURCE:Df.AXE,AMOUNT:4,COST:[{resource:Df.LOG,amount:2},{resource:Df.BRONZE,amount:1}],CRAFTING:15},BRONZE_PICKAXE:{NAME:"BRONZE PICKAXE",RESOURCE:Df.PICKAXE,AMOUNT:4,COST:[{resource:Df.LOG,amount:2},{resource:Df.BRONZE,amount:1}],CRAFTING:15},BRONZE_SHOVEL:{NAME:"BRONZE SHOVEL",RESOURCE:Df.SHOVEL,AMOUNT:4,COST:[{resource:Df.LOG,amount:2},{resource:Df.BRONZE,amount:1}],CRAFTING:15},BRONZE_SPEAR:{NAME:"BRONZE SPEAR",RESOURCE:Df.SPEAR,AMOUNT:4,COST:[{resource:Df.LOG,amount:2},{resource:Df.BRONZE,amount:1}],CRAFTING:15},BRONZE_HAMMER:{NAME:"BRONZE HAMMER",RESOURCE:Df.HAMMER,AMOUNT:4,COST:[{resource:Df.LOG,amount:2},{resource:Df.BRONZE,amount:1}],CRAFTING:15},BRONZE_NAILS:{NAME:"BRONZE NAILS",RESOURCE:Df.NAILS,AMOUNT:5,COST:[{resource:Df.BRONZE,amount:1}],CRAFTING:8},IRON_AXE:{NAME:"IRON AXE",RESOURCE:Df.AXE,AMOUNT:8,COST:[{resource:Df.LOG,amount:2},{resource:Df.IRON,amount:1}],CRAFTING:12},IRON_PICKAXE:{NAME:"IRON PICKAXE",RESOURCE:Df.PICKAXE,AMOUNT:8,COST:[{resource:Df.LOG,amount:2},{resource:Df.IRON,amount:1}],CRAFTING:12},IRON_SHOVEL:{NAME:"IRON SHOVEL",RESOURCE:Df.SHOVEL,AMOUNT:8,COST:[{resource:Df.LOG,amount:2},{resource:Df.IRON,amount:1}],CRAFTING:12},IRON_SPEAR:{NAME:"IRON SPEAR",RESOURCE:Df.SPEAR,AMOUNT:8,COST:[{resource:Df.LOG,amount:2},{resource:Df.IRON,amount:1}],CRAFTING:12},IRON_HAMMER:{NAME:"IRON HAMMER",RESOURCE:Df.HAMMER,AMOUNT:8,COST:[{resource:Df.LOG,amount:2},{resource:Df.IRON,amount:1}],CRAFTING:12},IRON_NAILS:{NAME:"IRON NAILS",RESOURCE:Df.NAILS,AMOUNT:15,COST:[{resource:Df.IRON,amount:1}],CRAFTING:6},BOW:{RESOURCE:Df.BOW,AMOUNT:1,COST:[{resource:Df.BRUSHWOOD,amount:5},{resource:Df.LOG,amount:10}],CRAFTING:15},PARCHMENT:{RESOURCE:Df.PAPER,AMOUNT:1,COST:[{resource:Df.FUR,amount:2}],CRAFTING:15},SWORD:{RESOURCE:Df.SWORD,AMOUNT:1,COST:[{resource:Df.COPPER,amount:5},{resource:Df.LOG,amount:1},{resource:Df.FUEL,amount:5}],CRAFTING:20},BRONZE_SWORD:{NAME:"BRONZE SWORD",RESOURCE:Df.SWORD,AMOUNT:2,COST:[{resource:Df.BRONZE,amount:4},{resource:Df.LOG,amount:1},{resource:Df.FUEL,amount:7}],CRAFTING:25},IRON_SWORD:{NAME:"IRON SWORD",RESOURCE:Df.SWORD,AMOUNT:3,COST:[{resource:Df.IRON,amount:3},{resource:Df.LOG,amount:1},{resource:Df.FUEL,amount:10}],CRAFTING:30},WOODEN_SHIELD:{NAME:"WOODEN SHIELD",RESOURCE:Df.SHIELD,AMOUNT:1,COST:[{resource:Df.PLANK,amount:5},{resource:Df.LOG,amount:2},{resource:Df.LEATHER,amount:1}],CRAFTING:20},BRONZE_SHIELD:{NAME:"BRONZE SHIELD",RESOURCE:Df.SHIELD,AMOUNT:2,COST:[{resource:Df.BRONZE,amount:1},{resource:Df.LEATHER,amount:1}],CRAFTING:25},IRON_SHIELD:{NAME:"IRON SHIELD",RESOURCE:Df.SHIELD,AMOUNT:4,COST:[{resource:Df.IRON,amount:1},{resource:Df.LEATHER,amount:1}],CRAFTING:30},LEATHER_ARMOR:{RESOURCE:Df.LEATHER_ARMOR,AMOUNT:1,COST:[{resource:Df.LEATHER,amount:10}],CRAFTING:20},LIGHT_ARMOR:{RESOURCE:Df.LIGHT_ARMOR,AMOUNT:1,COST:[{resource:Df.COPPER,amount:10},{resource:Df.LEATHER,amount:5},{resource:Df.FUEL,amount:10}],CRAFTING:25},HEAVY_ARMOR:{RESOURCE:Df.HEAVY_ARMOR,AMOUNT:1,COST:[{resource:Df.BRONZE,amount:8},{resource:Df.LEATHER,amount:5},{resource:Df.FUEL,amount:10}],CRAFTING:30},CANNON:{RESOURCE:Df.CANNON,AMOUNT:1,COST:[{resource:Df.IRON,amount:10},{resource:Df.PLANK,amount:10},{resource:Df.FUEL,amount:5}],CRAFTING:30},FUEL_BRUSHWOOD:{NAME:"BRUSHWOOD FUEL",RESOURCE:Df.FUEL,AMOUNT:2,COST:[{resource:Df.BRUSHWOOD,amount:4}],CRAFTING:2},FUEL_LOG:{NAME:"LOG FUEL",RESOURCE:Df.FUEL,AMOUNT:4,COST:[{resource:Df.LOG,amount:4}],CRAFTING:5},FUEL_COAL:{NAME:"COAL FUEL",RESOURCE:Df.FUEL,AMOUNT:12,COST:[{resource:Df.COAL,amount:2}],CRAFTING:5},COOKED_FISH:{RESOURCE:Df.COOKED_FISH,AMOUNT:1,COST:[{resource:Df.FISH,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:5},COOKED_MEAT:{RESOURCE:Df.COOKED_MEAT,AMOUNT:1,COST:[{resource:Df.MEAT,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:5},CHEESE:{RESOURCE:Df.CHEESE,AMOUNT:1,COST:[{resource:Df.MILK,amount:3}],CRAFTING:7},OMELETTE:{RESOURCE:Df.OMELETTE,AMOUNT:1,COST:[{resource:Df.EGG,amount:5},{resource:Df.FUEL,amount:1}],CRAFTING:3},PIE:{RESOURCE:Df.PIE,AMOUNT:1,COST:[{resource:Df.APPLE,amount:3},{resource:Df.FLOUR,amount:1},{resource:Df.EGG,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:5},FLOUR:{RESOURCE:Df.FLOUR,AMOUNT:1,COST:[{resource:Df.WHEAT,amount:2}],CRAFTING:3},BREAD:{RESOURCE:Df.BREAD,AMOUNT:1,COST:[{resource:Df.FLOUR,amount:2},{resource:Df.FUEL,amount:1}],CRAFTING:5},BOUILLABAISSE:{RESOURCE:Df.BOUILLABAISSE,AMOUNT:1,COST:[{resource:Df.FISH,amount:3},{resource:Df.BREAD,amount:1},{resource:Df.HERBS,amount:2},{resource:Df.FUEL,amount:1}],CRAFTING:5},VEGETABLE_SOUP_BERRY:{RESOURCE:Df.VEGETABLE_SOUP,AMOUNT:1,COST:[{resource:Df.BERRY,amount:2},{resource:Df.HERBS,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:5},VEGETABLE_SOUP_MUSHROOM:{RESOURCE:Df.VEGETABLE_SOUP,AMOUNT:1,COST:[{resource:Df.MUSHROOM,amount:2},{resource:Df.HERBS,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:5},VEGETABLE_SOUP_BERRY_MUSHROOM:{RESOURCE:Df.VEGETABLE_SOUP,AMOUNT:1,COST:[{resource:Df.BERRY,amount:1},{resource:Df.MUSHROOM,amount:1},{resource:Df.HERBS,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:5},MEAT_SOUP:{RESOURCE:Df.MEAT_SOUP,AMOUNT:1,COST:[{resource:Df.MEAT,amount:1},{resource:Df.HERBS,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:5},FABRIC:{NAME:"COTTON FABRIC",RESOURCE:Df.FABRIC,AMOUNT:1,COST:[{resource:Df.COTTON,amount:2}],CRAFTING:5},FABRIC_WOOL:{NAME:"WOOL FABRIC",RESOURCE:Df.FABRIC,AMOUNT:1,COST:[{resource:Df.WOOL,amount:3}],CRAFTING:5},CLOTHES_FABRIC:{NAME:"FABRIC CLOTHES",RESOURCE:Df.CLOTHES,AMOUNT:1,COST:[{resource:Df.FABRIC,amount:10}],CRAFTING:20},CLOTHES_FUR:{NAME:"FUR CLOTHES",RESOURCE:Df.CLOTHES,AMOUNT:1,COST:[{resource:Df.FUR,amount:15}],CRAFTING:20},GOLD:{RESOURCE:Df.GOLD,AMOUNT:1,COST:[{resource:Df.GOLD_ORE,amount:2},{resource:Df.FUEL,amount:1}],CRAFTING:10},SILVER:{RESOURCE:Df.SILVER,AMOUNT:1,COST:[{resource:Df.SILVER_ORE,amount:2},{resource:Df.FUEL,amount:1}],CRAFTING:10},COPPER:{RESOURCE:Df.COPPER,AMOUNT:1,COST:[{resource:Df.COPPER_ORE,amount:2},{resource:Df.FUEL,amount:1}],CRAFTING:20},TIN:{RESOURCE:Df.TIN,AMOUNT:1,COST:[{resource:Df.TIN_ORE,amount:2},{resource:Df.FUEL,amount:1}],CRAFTING:20},BRONZE:{RESOURCE:Df.BRONZE,AMOUNT:2,COST:[{resource:Df.COPPER,amount:1},{resource:Df.TIN,amount:1},{resource:Df.FUEL,amount:1}],CRAFTING:30},IRON:{RESOURCE:Df.IRON,AMOUNT:1,COST:[{resource:Df.IRON_ORE,amount:3},{resource:Df.FUEL,amount:3}],CRAFTING:30},STEEL:{RESOURCE:Df.STEEL,AMOUNT:1,COST:[{resource:Df.IRON,amount:1},{resource:Df.COAL,amount:5},{resource:Df.FUEL,amount:1}],CRAFTING:40},HERBAL_MEDICINE:{RESOURCE:Df.HERBAL_MEDICINE,AMOUNT:1,COST:[{resource:Df.HERBS,amount:5}],CRAFTING:15},JEWELRY:{RESOURCE:Df.JEWELRY,AMOUNT:1,COST:[{resource:Df.GOLD,amount:1},{resource:Df.SILVER,amount:1},{resource:Df.GEMS,amount:1}],CRAFTING:20}}},Om={getReligion(e){const t=Object.entries(this.RELIGIONS).find(t=>t[0]===Bf[e]);if(t)return t[1];console.warn("Invalid religion: "+Qf.prepareReligionName(e))},RELIGIONS:{NONE:{FAITH_LEVEL:0,FAITH:0,TIME:0,OFFERING:[]},NATURE:{FAITH_LEVEL:1,FAITH:20,TIME:10,OFFERING:[{resource:Df.LOG,amount:40},{resource:Df.BERRY,amount:20},{resource:Df.MUSHROOM,amount:20}]},FERTILITY:{FAITH_LEVEL:1,FAITH:30,TIME:10,OFFERING:[{resource:Df.WHEAT,amount:40},{resource:Df.BERRY,amount:40},{resource:Df.APPLE,amount:40}]},TECHNOLOGY:{FAITH_LEVEL:1,FAITH:40,TIME:10,OFFERING:[{resource:Df.PLANK,amount:20},{resource:Df.CUT_STONE,amount:20},{resource:Df.HAMMER,amount:5},{resource:Df.PICKAXE,amount:5}]},WAR:{FAITH_LEVEL:1,FAITH:50,TIME:10,OFFERING:[{resource:Df.SPEAR,amount:5},{resource:Df.LEATHER_ARMOR,amount:5},{resource:Df.FUR,amount:10},{resource:Df.LEATHER,amount:10},{resource:Df.FOOD,amount:1e3}]}},PRAYERS:{PRAY:{FAITH:20,FAITH_LEVEL:1,RELIGION:Bf.NONE,DESCRIPTION:"We feel better after prayer",FINISH:function(e){e.getHappinessService().addHappinessEffect(0,$f.PRAYER,2,180)}},BLESSING:{FAITH:50,FAITH_LEVEL:2,RELIGION:Bf.NONE,DESCRIPTION:"May everything go according to our plans",FINISH:function(e){const t=[];Object.values(Kf).filter(e=>!isNaN(e)).forEach(i=>{e.getServiceByRegion(i).getBuildings().forEach(e=>{t.includes(e.getBuildingType())||t.push(e.getBuildingType())})});const i=am.randomExcept(t,[Lf.ALL,Lf.CONSTRUCTION,Lf.DECONSTRUCTION,Lf.BARN,Lf.FIELD,Lf.ORCHARD,Lf.PASTURE,Lf.WAREHOUSE,Lf.SMITHY,Lf.ASCENSION_TEMPLE,Lf.COLOSSUS,Lf.GREAT_LIGHTHOUSE,Lf.HANGING_GARDEN,Lf.PYRAMID,Lf.SACRED_GROVE,Lf.STONEHENGE,Lf.UNDERGROUND_CITY,Lf.PIER,Lf.HARBOUR,Lf.LIGHTHOUSE,Lf.TAX_COLLECTOR,Lf.BUILDERS_GUILD,Lf.STASH,Lf.WOODEN_TOWER,Lf.BARRACKS,Lf.STONE_TOWER,Lf.STOCKADE]);e.getLogService().log(Qf.prepareBuildingName(i)+" blessed"),e.getEffectsService().addBuildingEffect(new nm("Blessing",i,25,180))}},PREACH:{FAITH:20,FAITH_LEVEL:1,RELIGION:Bf.NONE,DESCRIPTION:"We shall spread our beliefs to others",FINISH:function(e){e.getService(Zf.RELIGION).increaseFaithLevel(1)}},FAITH_SHIELD:{FAITH:50,FAITH_LEVEL:3,RELIGION:Bf.NONE,DESCRIPTION:"Our faith will protect us from harm",FINISH:function(e){let t=25;t+=e.getService(Zf.RELIGION).getFaithLevel(),e.getService(Zf.RELIGION).increaseFaithShield(t)}},SOLDIER_PRAYER:{FAITH:50,FAITH_LEVEL:5,RELIGION:Bf.NONE,DESCRIPTION:"We shall win any enemy with our faith. All troops buffed 20% for one year",FINISH:function(e){e.getEffectsService().addArmyEffect(new cm("Soldier prayer",Wf.ALL,20,360))}},FAITHFUL_RESEARCH:{FAITH:100,FAITH_LEVEL:5,RELIGION:Bf.TECHNOLOGY,DESCRIPTION:"We live to improve our knowledge. Gain 100 research points spent only on current research",FINISH:function(e){e.getTechService().progressTech(100)}},BABY_BOOM:{FAITH:100,FAITH_LEVEL:5,RELIGION:Bf.FERTILITY,DESCRIPTION:"May we have a lot of children",FINISH:function(e){e.getEffectsService().addBuildingEffect(new nm("Baby boom",Lf.HUT,100,180)),e.getEffectsService().addBuildingEffect(new nm("Baby boom",Lf.HOUSE,100,180)),e.getEffectsService().addBuildingEffect(new nm("Baby boom",Lf.LONGHOUSE,100,180)),e.getEffectsService().addBuildingEffect(new nm("Baby boom",Lf.TUDOR_HOUSE,100,180)),e.getEffectsService().addBuildingEffect(new nm("Baby boom",Lf.SETTLEMENT,100,180))}},LIFE_CYCLE:{FAITH:100,FAITH_LEVEL:5,RELIGION:Bf.NATURE,DESCRIPTION:"We pray for all live to thrive. 10% buff to natural sources for 5 years",FINISH:function(e){e.getEffectsService().addNatureEffect(new lm("Life cycle",10,1800))}},HOLY_WAR:{FAITH:100,FAITH_LEVEL:5,RELIGION:Bf.WAR,DESCRIPTION:"The only true faith must be spread at all cost. All troops buffed 10% for 5 years",FINISH:function(e){e.getEffectsService().addArmyEffect(new cm("Holy War",Wf.ALL,10,1800))}}}},Tm={GOLDEN_ITEMS:{GOLDEN_FISH_CHANCE:3e-4,GOLDEN_EGG_CHANCE:3e-4,GOLDEN_APPLE_CHANCE:3e-4,GOLDEN_FLEECE_CHANCE:3e-4},PERKS:{MOTIVATION_SPEECH:{DESCRIPTION:"Use your royal position to motivate people to harder work.<br>25% production upgrade for all buildings for 100 years or until reset (single use)",USAGES:0,MAX_USAGES:0,COST:20,RESET:function(e,t){},EFFECT:function(e,t){e.getEffectsService().addBuildingEffect(new nm("Motivation speech",Lf.ALL,25,36e3)),e.getRoyalService().unlockCallback(t)}},ROYAL_PROPHECY:{DESCRIPTION:"Your royal blood allows prophets to look into the future.<br>Unlocks certain research for each perk level (awarded immediately and after any soft reset or abdication)",USAGES:0,MAX_USAGES:3,COST:50,RESET:function(e,t){t.usages>=1&&e.getTechService().finishTech(kf.FIRE),t.usages>=2&&e.getTechService().finishTech(kf.COOKING),3===t.usages&&(e.getTechService().finishTech(kf.BOW),e.getTechService().finishTech(kf.HUNTING))},EFFECT:function(e,t){switch(t.usages){case 0:e.getTechService().finishTech(kf.FIRE);break;case 1:e.getTechService().finishTech(kf.COOKING);break;case 2:e.getTechService().finishTech(kf.BOW),e.getTechService().finishTech(kf.HUNTING)}e.getRoyalService().unlockCallback(t)}},HERITAGE:{DESCRIPTION:"Your predecessors ruled better.<br>You start with extra building (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:2,COST:20,RESET:function(e,t){t.usages>=1&&(e.getService(Zf.FOREST).addBuilding(Lf.GATHERER),e.getLandService().takeLand(fm.FOREST.GATHERER.SIZE)),2===t.usages&&(e.getVillageService().addBuilding(Lf.WORKSHOP),e.getLandService().takeLand(fm.VILLAGE.WORKSHOP.SIZE))},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},ROYAL_ARCHIVES:{DESCRIPTION:"With archives unlocked we can schedule one more research to be worked on.",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){e.getTechService().increaseTechQueueSize()},EFFECT:function(e,t){e.getTechService().increaseTechQueueSize(),e.getRoyalService().unlockCallback(t)}},FAMILY_JEWELS:{DESCRIPTION:"Your predecessors left you with more riches.<br>You start with extra resources (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:3,COST:20,RESET:function(e,t){t.usages>=1&&(e.getResourcesService().increaseResource(Df.LOG,20,"Royal",!0),e.getResourcesService().increaseResource(Df.BRUSHWOOD,10,"Royal",!0),e.getResourcesService().increaseResource(Df.BERRY,20,"Royal",!0),e.getResourcesService().increaseResource(Df.MUSHROOM,20,"Royal",!0)),t.usages>=2&&(e.getResourcesService().increaseResource(Df.STONE,30,"Royal",!0),e.getResourcesService().increaseResource(Df.PLANK,20,"Royal",!0),e.getResourcesService().increaseResource(Df.FUEL,5,"Royal",!0),e.getResourcesService().increaseResource(Df.LEATHER,5,"Royal",!0)),3===t.usages&&e.getResourcesService().increaseResource(Df.COINS,300,"Royal",!0)},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_FOREST:{DESCRIPTION:"You rule everything in the forests.<br>You start with a few forest buildings unlocked (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){1===t.usages&&(e.getService(Zf.FOREST).addBuilding(Lf.GATHERER),e.getService(Zf.FOREST).addBuilding(Lf.FORESTER),e.getService(Zf.FOREST).addBuilding(Lf.HUNTER_LODGE),e.getLandService().takeLand(fm.FOREST.GATHERER.SIZE+fm.FOREST.FORESTER.SIZE+fm.FOREST.HUNTER_LODGE.SIZE))},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_PEOPLE:{DESCRIPTION:"People love you unconditionally.<br>You start with House unlocked and built instead of huts (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){1===t.usages&&(e.getTechService().finishTech(kf.HOUSE),e.getVillageService().replaceWithHouses())},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_SEAS:{DESCRIPTION:"Seas obey your will.<br>You start with sea unlocked, pier building built, one boat and 120 coins",USAGES:0,MAX_USAGES:1,COST:100,RESET:function(e,t){e.getGameService().enable(Mf.SEA),e.getGameService().enable(Mf.NAVY),e.getService(Zf.SEA).addBuilding(Lf.PIER),e.getNavyService().addShip(Wf.BOAT),e.getLandService().takeLand(fm.SEA.PIER.SIZE),e.getResourcesService().increaseResource(Df.COINS,120,"Royal",!0)},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_WAR:{DESCRIPTION:"War is your game.<br>You start with military unlocked and small army (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){e.getGameService().enable(Mf.ARMY),e.getGameService().enable(Mf.FORT);const i=e.getArmyService();e.getService(Zf.FORT).addBuilding(Lf.BARRACKS),e.getService(Zf.FORT).addBuilding(Lf.BARRACKS),e.getLandService().takeLand(2*fm.FORT.BARRACKS.SIZE),i.addMilitia(20)},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},CALL_TO_ARMS:{DESCRIPTION:"We will fight till the last of us drops dead.<br>You can convert up to 10 villagers to militia (single use)",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){const i=e.getResourcesService(),s=e.getModalService(),r=e.getArmyService(),n=e.getRoyalService();s.open(Pf.INPUT),s.setModalText("How many villagers would you like to convert to militia?<br>"+i.getPeople()+" recruits available");const o=s.registerForValueResponse().subscribe(e=>{if(o.unsubscribe(),null!==e&&!isNaN(e)){const o=i.getPeople();if(o>10)return void s.info("You can only convert up to 10 villagers");if(r.getFreeBarracks()<e)return void s.info("Not enough barracks space for so many militia");if(e>o)return void s.info("Not enough recruits");if(e<=0)return void s.info("Invalid amount of recruits");if(n.getRoyalPoints()<t.cost)return void s.info("Not enough royal points");i.removeRecruit(Number(e)),r.addMilitia(Number(e)),n.unlockCallback(t)}})}},UNITE_WITH_THE_PEOPLE:{DESCRIPTION:"You step down from your throne and live with others.<br>Permanent 20% upgrade to all buildings (persists through soft resets and abdications)",USAGES:0,MAX_USAGES:0,COST:100,RESET:function(e,t){},EFFECT:function(e,t){e.getEffectsService().addBuildingEffect(new nm("Unite with the people",Lf.ALL,20,om.ROYAL)),e.getRoyalService().unlockCallback(t)}},JESTER:{DESCRIPTION:"You hired jester to entertain you but who knows what can you expect from him?<br>Jester will pick random unlocked resource (except coins) and fill it to max storage.<br>Each time he fills resource or picks already full resource he has 50% chance to pick another one (single use)",USAGES:0,MAX_USAGES:0,COST:25,RESET:function(e,t){},EFFECT:function(e,t){const i=Array.from(e.getResourcesService().getResources().values()).filter(e=>e.isVisible()&&e.resource!==Df.COINS);for(;;){const t=i[am.randomBetween(0,i.length-1)];if(t.amount<t.limit?(t.amount=t.limit,e.getLogService().success("Jester filled "+Qf.prepareResourceName(t.resource)+" storage!")):e.getLogService().warning("Jester couldn't fill "+Qf.prepareResourceName(t.resource)+" storage!"),am.chance(.5))break}e.getRoyalService().unlockCallback(t)}},ASTROLOGICAL_NOTE:{DESCRIPTION:"Royal archives contain notes about old astrological events.<br>You unlock one meteorite in the mountains",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){e.getGameService().isEnabled(Mf.MOUNTAINS)||(e.getGameService().enable(Mf.MOUNTAINS),e.getLogService().log("Mountains unlocked")),e.getService(Zf.MOUNTAINS).addMeteorite(),e.getRoyalService().unlockCallback(t)}},ROYAL_FESTIVAL:{DESCRIPTION:"You organize a royal festival for your people.<br>You gain positive happiness boost for 6 months",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){e.getHappinessService().addHappinessEffect(0,$f.ROYAL_FESTIVAL,10,180),e.getLogService().success("Royal festival has started!"),e.getRoyalService().unlockCallback(t)}},ROYAL_RESERVE:{DESCRIPTION:"You use gold from royal treasury that was reserved for a hard times.<br>You gain 2000 coins",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){e.getResourcesService().increaseResource(Df.COINS,2e3,"Royal reserve",!0),e.getLogService().success("You gained 2000 coins"),e.getRoyalService().unlockCallback(t)}},ANCIENT_SEA_MAPS:{DESCRIPTION:"You found sea maps that show you places on the sea with something interesting.<br>You unlock up to 5 positive sea events",USAGES:0,MAX_USAGES:0,COST:20,RESET:function(e,t){},EFFECT:function(e,t){e.getWorldService().ROYAL_spawnPositiveSeaEvents(),e.getRoyalService().unlockCallback(t)}},ROYAL_ORDERS:{DESCRIPTION:"Your people work harder when you give them orders.<br>Your initial crafting queue is increased by 1 for each perk level",USAGES:0,MAX_USAGES:5,COST:10,RESET:function(e,t){t.usages>0&&e.getService(Zf.CRAFTING).increaseCraftingQueueSize(t.usages)},EFFECT:function(e,t){e.getService(Zf.CRAFTING).increaseCraftingQueueSize(1),e.getRoyalService().unlockCallback(t)}},ROYAL_TRADITIONS:{DESCRIPTION:"You show royal traditions to the people.You gain 10 Heritage Points",USAGES:0,MAX_USAGES:0,COST:50,RESET:function(e,t){},EFFECT:function(e,t){e.getService(Zf.HERITAGE).increaseHeritagePoints(10),e.getRoyalService().unlockCallback(t)}},ROYAL_GARDENS:{DESCRIPTION:"You open royal gardens for public use.<br>Permanent 1 point happiness effect per perk level",USAGES:0,MAX_USAGES:3,COST:25,RESET:function(e,t){1===t.usages?e.getHappinessService().addHappinessEffect(0,$f.ROYAL_GARDENS,1,-1):2===t.usages?e.getHappinessService().addHappinessEffect(0,$f.ROYAL_GARDENS,2,-1):3===t.usages&&e.getHappinessService().addHappinessEffect(0,$f.ROYAL_GARDENS,3,-1)},EFFECT:function(e,t){e.getHappinessService().updateHappiness($f.ROYAL_GARDENS,t.usages+1,-1),e.getLogService().success("Royal gardens unlocked!"),e.getRoyalService().unlockCallback(t)}},HIRE_MERCENARIES:{DESCRIPTION:"Using your royal position you managed to convince mercenaries to fight for you.You gain 10 light cavalry units and 200 coins",USAGES:0,MAX_USAGES:0,COST:30,RESET:function(e,t){},EFFECT:function(e,t){const i=e.getModalService(),s=e.getArmyService(),r=e.getRoyalService();s.getFreeBarracks()<10?i.info("Not enough barracks space for 10 light cavalry units"):r.getRoyalPoints()<t.cost?i.info("Not enough royal points"):(s.addLightCavalry(10),e.getLogService().success("Mercenaries hired!"),e.getResourcesService().increaseResource(Df.COINS,200,"Royal",!0),r.unlockCallback(t))}},HIRE_PIRATES:{DESCRIPTION:"Using your royal position you managed to convince pirates to fight for you.You gain 2 brigantines and 320 coins",USAGES:0,MAX_USAGES:0,COST:30,RESET:function(e,t){},EFFECT:function(e,t){const i=e.getModalService(),s=e.getNavyService(),r=e.getRoyalService();s.getFreeHarbourSpace()<80?i.info("Not enough harbour space for 2 brigantines"):r.getRoyalPoints()<t.cost?i.info("Not enough royal points"):(s.addBrigantines(2),e.getLogService().success("Pirates hired!"),e.getResourcesService().increaseResource(Df.COINS,320,"Royal",!0),r.unlockCallback(t))}},ANCIENT_PROTECTION:{DESCRIPTION:"Using this ancient artifact will prevent any attacks.<br>Enemies won't be able to plunder or conquer your regions for a year.",USAGES:0,MAX_USAGES:0,COST:30,RESET:function(e,t){},EFFECT:function(e,t){const i=e.getLogService(),s=e.getWorldService(),r=e.getRoyalService();s.addProtection(360),i.success("Ancient protection enabled!"),r.unlockCallback(t)}}}},Im={getSeaEvent(e){const t=Object.entries(this.SEA_EVENTS).find(t=>t[0]===jf[e]);if(t)return t[1];console.warn("Invalid sea event: "+e)},KING_DEATH_CHANCE:.02,ROADS_DISTANCE_MODIFIER:.8,REGIONS:[{ID:0,PATH:"m 126.49907,133.07398 7.34991,7.88445 11.67185,8.93323 4.23333,15.875 11.37709,2.64584 7.14375,8.46666 0.26458,8.59896 13.89063,3.96875 15.08125,-9.525 -1.19063,-16.40417 9.78958,-4.36562 11.2448,5.68854 11.77395,-5.42396 17.33021,3.83646 3.57188,-11.50937 -7.80521,-10.58334 0.66146,-10.45104 7.40833,-7.14375 0.79375,-5.15937 -6.48229,-1.32292 -2.24896,-7.40833 -10.05417,-5.29167 -9.12812,3.96875 -1.71979,-6.21771 1.45521,-8.069789 0.66145,-5.89643 -6.04761,-5.858629 -11.90625,-0.944941 -15.11905,5.669645 -13.08608,0.871196 -12.96258,5.345393 -10.28987,7.617185 -5.07812,-7.750818 -10.55715,5.211754 -6.5481,6.681744 8.68626,10.15624 -7.75082,0.53454 z",LAND:500,FOREST:500,MOUNTAINS:100,CENTER:{x:187,y:127},NEIGHBOURS:[-1,1,2,13],WEALTH:0,HARBOUR:!0,TROOPS:[]},{ID:1,PATH:"m 126.49907,133.07398 -24.13484,-2.04836 -6.013569,-14.96709 -11.49259,-7.61718 4.677217,-1.33635 5.479026,-16.971615 -3.608139,-3.073598 3.741775,-19.510677 -2.405428,-3.340867 13.497118,-6.414468 11.22531,10.15624 11.09169,-3.073598 5.21176,5.211754 10.55714,-4.409945 2.53906,1.336347 4.00905,5.211754 -7.61719,5.479026 21.19488,15.545464 -10.28987,7.617183 -5.07812,-7.750816 -10.55715,5.211754 -6.5481,6.681742 8.68626,10.15624 -7.75082,0.53454 -6.41447,17.37252",LAND:80,FOREST:100,MOUNTAINS:0,CENTER:{x:116,y:97},NEIGHBOURS:[0,2,3,4,7,13,15],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:2,PATH:"m 126.49907,133.07398 -24.13484,-2.04836 0.4009,8.01809 -21.782464,-3.60814 -12.828937,12.96257 v 8.95353 l -11.893494,18.04069 -0.80181,16.83798 19.510677,-3.20723 14.03165,-4.67722 2.138156,-10.28988 9.488072,2.40543 6.949,-8.15172 5.61266,-0.80181 1.46999,12.82894 0.13363,11.49259 3.87541,0.53454 3.87541,-3.34087 3.20723,-9.75534 -0.53454,-8.81989 9.62171,2.13815 -6.28084,-10.28987 6.5481,-11.75986 -1.25576,-9.57787 z",LAND:80,FOREST:100,MOUNTAINS:0,CENTER:{x:100,y:155},NEIGHBOURS:[-1,0,1,3,5],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:3,PATH:"m 56.260235,175.39236 -5.233451,-16.73165 -9.827379,-12.28422 11.433778,-11.43378 1.039435,-11.2448 4.346725,-8.59895 0.566965,-9.92188 6.803573,-0.56696 V 92.703868 l 15.119045,1.700893 10.897249,-7.344976 3.608138,3.073598 -5.479026,16.971617 -4.677217,1.33635 11.49259,7.61718 6.01357,14.96709 0.4009,8.01809 -21.782464,-3.60814 -12.828937,12.96257 v 8.95353 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:71,y:125},NEIGHBOURS:[1,2,4,5],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:4,PATH:"m 41.199405,146.37649 -10.997948,-3.99191 -13.363477,-1.33635 4.577637,-11.0537 -3.508559,-16.87597 10.429075,-11.27348 6.676174,-23.33792 1.469982,-7.483546 14.83346,3.741772 2.405425,-8.285356 -1.202711,-5.879928 12.160763,-1.603618 7.617179,8.151722 8.953529,6.548102 13.898015,-6.1472 -3.741774,19.510677 -10.897251,7.344976 -15.119043,-1.700895 v 11.906254 l -6.803573,0.56696 -0.566965,9.92188 -4.346725,8.59895 -1.039435,11.2448 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:48,y:98},NEIGHBOURS:[1,3,5,6,7],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:5,PATH:"m 6.2808339,146.92816 -14.9670935,3.74177 6.2808339,12.02713 2.00452142,12.6953 -10.82441572,8.28536 0.534539,6.68174 8.9535291,6.949 12.1607629,0.66818 5.479026,8.01808 7.082642,5.07812 h 7.082642 l 0.400905,-10.0226 10.958049,-1.87089 6.013566,3.47451 7.082642,-2.93997 0.935442,-7.48355 0.80181,-16.83798 -5.233451,-16.73165 -9.827379,-12.28422 -10.997948,-3.99191 -13.363477,-1.33635 z",LAND:40,FOREST:70,MOUNTAINS:0,CENTER:{x:25,y:175},NEIGHBOURS:[-1,2,3,4,6,25],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:6,PATH:"M 16.83798,141.04823 6.2808339,146.92816 -0.13363471,129.0211 -12.828937,117.39488 l 4.0090427,-7.88446 -9.3544327,-9.48806 9.0871631,-4.810855 -4.2763121,-4.276313 0.133635,-15.234361 10.2898762,-5.746295 10.9580504,-0.935445 1.0690783,-7.349911 3.7417731,-6.414468 8.819894,3.207234 2.939965,4.009044 1.603617,-2.939966 7.483547,-1.603618 2.806329,13.096208 -1.469982,7.483544 -6.676174,23.337922 -10.429075,11.27348 3.508559,16.87597 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:10,y:92},NEIGHBOURS:[4,5,7,25,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:7,PATH:"M 36.482289,71.023614 33.67596,57.927406 26.192413,59.531024 24.588796,62.47099 21.648831,58.461946 12.828937,55.254712 10.824416,52.314747 7.4835466,48.706608 6.8153729,34.674958 19.91158,32.002264 l 9.888972,1.603616 4.81085,-10.289877 4.409948,3.474504 5.746295,1.469982 14.03165,-4.543581 10.423512,5.879928 16.169806,0.133636 4.276313,9.220798 7.082641,-2.405425 3.474503,2.80633 1.20271,6.815372 -7.349906,5.746295 -1.336353,12.294399 2.405428,3.340867 -13.898017,6.1472 -8.953527,-6.548102 -7.617179,-8.151722 -12.160763,1.603618 1.202711,5.879928 -2.405425,8.285356 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:56,y:44},NEIGHBOURS:[1,4,6,15,18,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:8,PATH:"m 130.40178,245.02827 -7.37053,9.26042 -11.33929,2.07887 -2.26785,7.18154 1.32291,11.15031 6.61459,6.42559 -3.96875,9.82737 -6.23661,1.13395 0.94494,2.64583 3.59077,1.70087 6.61459,-2.64583 1.13392,-3.77976 6.23661,-1.7009 7.55953,-0.94493 3.59077,-5.48066 1.88988,-1.13392 6.61458,1.13392 10.01637,-4.72469 6.99256,6.99257 5.85863,-8.12649 -5.10268,-6.04764 v -10.01636 l 2.26786,-7.9375 -7.37053,-6.23661 -11.1503,-1.88988 -5.29167,6.23661 -2.83482,-5.85863 -6.61458,-6.04762 z",LAND:40,FOREST:50,MOUNTAINS:0,CENTER:{x:138,y:265},NEIGHBOURS:[-1,9,10,11],WEALTH:0,HARBOUR:!0,TROOPS:[]},{ID:9,PATH:"m 165.36458,252.02083 6.22245,-3.26298 4.94449,-4.94449 8.41899,0.66817 5.61266,-5.21175 1.46998,-3.87541 1.73726,0.80181 -0.13364,2.80633 2.27179,4.27631 4.54358,0.66817 2.13816,4.54359 4.54358,0.4009 2.13816,4.94449 1.33635,7.61718 -0.66818,6.1472 -3.87541,4.67722 2.40543,0.93544 2.67269,-0.93544 2.6727,1.33633 -0.13364,2.80633 -4.94448,1.20272 -4.54358,-1.33633 -3.34087,-3.60815 -3.0736,-1.20272 -3.60814,2.53908 -0.53454,5.07812 3.20723,3.74176 3.87541,0.93544 -0.13363,3.8754 -4.14268,1.0691 -6.94901,1.46997 -7.21627,-1.73725 -5.47903,-3.8754 -5.61266,0.66817 -8.84536,-1.09132 5.85863,-8.12649 -5.10268,-6.04764 v -10.01636 z",LAND:40,FOREST:40,MOUNTAINS:10,CENTER:{x:186,y:263},NEIGHBOURS:[-1,8,11],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:10,PATH:"m 111.69196,296.43302 -4.51688,2.97241 -4.94449,1.60362 -1.87088,4.40994 v 6.68173 l 3.4745,-1.06907 -0.26727,4.81084 1.06908,4.9445 5.47902,2.93995 -0.8018,5.07812 5.34539,-1.46997 -1.06908,9.75534 -5.07812,4.6772 0.4009,3.47451 3.34087,0.13364 1.46998,-2.93997 5.87993,-1.20272 2.93997,4.40995 5.61266,2.00453 0.66817,5.21177 6.5481,2.53904 2.40543,-2.67269 5.87993,-2.00453 -0.40091,-4.40994 6.54811,-1.60362 -2.00452,-4.40994 1.87088,-3.34087 4.14268,-4.67722 2.13816,-5.87992 -8.01809,-3.47451 -1.73725,-6.28083 1.87089,-7.88445 -0.26727,-5.47902 0.4009,-6.94902 5.07812,-3.60815 -1.33635,-6.01355 -6.61088,-4.82918 -6.61458,-1.13392 -1.88988,1.13392 -3.59077,5.48066 -7.55953,0.94493 -6.23661,1.7009 -1.13392,3.77976 z",LAND:20,FOREST:50,MOUNTAINS:20,CENTER:{x:130,y:316},NEIGHBOURS:[-1,8,11],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:11,PATH:"m 200.58578,287.64555 3.20723,4.67723 6.41447,5.47901 0.13363,5.47905 4.54359,1.06907 1.06908,7.88445 3.60814,8.95353 -3.60814,5.61266 -4.40995,-1.60361 -4.00904,-0.53454 -0.80181,4.00905 -3.47451,4.14266 -11.89349,-0.4009 -0.13363,-4.54358 2.80633,-1.73726 v -4.00904 l -5.7463,-0.4009 -1.60362,3.60815 -2.53906,4.94448 -6.01356,2.4054 -4.14268,-5.34537 1.73725,-5.21176 5.47903,-5.74631 0.13363,-5.34537 -4.54358,-3.74177 -5.47903,4.94448 -0.53453,7.34992 -2.13816,7.88445 -6.94901,-2.80633 -5.74629,1.73725 -8.01809,-3.47451 -1.73725,-6.28083 1.87089,-7.88445 -0.26727,-5.47902 0.4009,-6.94902 5.07812,-3.60815 -1.33635,-6.01355 -6.61088,-4.82918 10.01637,-4.72469 6.99256,6.99257 8.84536,1.09132 5.61266,-0.66817 5.47903,3.8754 7.21627,1.73725 z",LAND:70,FOREST:20,MOUNTAINS:0,CENTER:{x:188,y:303},NEIGHBOURS:[-1,8,9,10],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:12,PATH:"m 263.52775,322.65786 0.26727,9.62171 -7.48355,5.3454 -1.06907,5.87992 3.74177,4.27632 h 7.7508 l 8.0181,6.94899 1.33635,6.68174 8.81989,2.40543 4.27633,-1.60361 10.4235,1.60361 1.33635,-4.2763 -6.94901,-5.87994 -0.53454,-5.87992 4.81084,2.40541 6.94901,0.53454 3.74177,-5.87992 -4.00902,-5.87994 -6.68176,-2.67269 4.54358,-5.07812 -1.87087,-7.75081 -9.08716,-2.67269 -5.07813,3.20723 -6.41447,-6.1472 -8.0181,0.8018 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:282,y:340},NEIGHBOURS:[-1],WEALTH:0,HARBOUR:!0,TROOPS:[]},{ID:13,PATH:"M 177.41392,87.905422 190.5,87.034226 l 15.11905,-5.669645 11.90625,0.944941 6.04761,5.858631 c -1.13392,0.377976 4.15774,-1.511905 4.15774,-1.511905 v -3.401785 l -6.99256,-7.9375 2.64583,-9.449403 h 6.04763 l -1.32292,-6.425597 -15.11905,-2.456844 -12.09524,-6.614583 -13.79613,3.023809 -7.18155,-8.882441 -9.82738,-4.157739 0.37798,-10.016368 -3.59077,-8.126488 -15.49703,-3.590774 -17.76488,13.040178 -0.37797,14.363097 1.32291,13.229166 9.76602,6.42525 2.53906,1.336347 4.00905,5.211752 -7.61719,5.479026 21.19488,15.545464 z",LAND:80,FOREST:40,MOUNTAINS:50,CENTER:{x:169,y:61},NEIGHBOURS:[-1,0,1,15,14],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:14,PATH:"m 228.10863,59.441963 7.18154,-1.700892 5.10268,2.834822 6.4256,-2.456847 -5.10268,-6.236607 -6.99256,-4.535712 10.20536,-1.133931 7.55952,3.590775 2.07887,-6.047619 5.10268,-6.236607 -0.18899,-7.559524 -8.12649,-8.126488 -12.28422,-2.834821 0.56696,-7.181548 -16.06399,1.322917 -26.45833,-2.456846 -6.42559,-5.6696423 -15.875,3.2127975 -7.9375,13.9851188 3.59077,8.126488 -0.37798,10.016368 9.82738,4.157739 7.18155,8.882441 13.79613,-3.023809 12.09524,6.614583 z",LAND:50,FOREST:80,MOUNTAINS:0,CENTER:{x:210,y:32},NEIGHBOURS:[-1,13,15,16],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:15,PATH:"m 85.392611,29.730472 -0.536956,-8.275115 13.985118,-2.267858 9.449407,-5.291666 4.91369,-7.7485118 12.47321,0.9449405 V -4.0580357 l 12.6622,-2.0788691 12.85119,4.7247023 -0.94494,5.6696428 3.96875,2.8348214 6.80358,-3.779762 8.12648,2.2678572 5.66965,2.6458333 -7.9375,13.9851188 -15.49703,-3.590774 -17.76488,13.040178 -0.37797,14.363097 1.32291,13.229166 9.76602,6.42525 -10.55714,4.409943 -5.21176,-5.211752 -11.09169,3.073596 -11.22531,-10.156237 -13.497121,6.414465 1.336355,-12.294399 7.349906,-5.746295 -1.20271,-6.815372 -3.474505,-2.80633 -7.082639,2.405425 z",LAND:50,FOREST:60,MOUNTAINS:50,CENTER:{x:119,y:32},NEIGHBOURS:[1,7,13,14,16,17,18],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:16,PATH:"m 138.33928,-6.1369048 -1.13392,-15.6860122 14.93005,-5.102678 3.2128,5.291667 15.30804,-5.858632 5.29166,-7.9375 12.09524,5.10268 15.30804,-12.662204 13.79613,0.566965 5.10268,10.772322 4.34672,-0.377975 4.34673,-5.291667 4.7247,3.023809 -2.07887,8.315475 1.88988,10.583334 7.9375,12.0952374 -12.47321,9.4494048 -7.37054,6.9925598 -26.45833,-2.456846 -6.42559,-5.6696423 -15.875,3.2127975 -5.66965,-2.6458333 -8.12648,-2.2678572 -6.80358,3.779762 -3.96875,-2.8348214 0.94494,-5.6696428 z",LAND:30,FOREST:30,MOUNTAINS:10,CENTER:{x:194,y:-12},NEIGHBOURS:[-1,14,15,17,108],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:17,PATH:"m 121.38705,-45.729911 -13.47485,-20.883184 -10.016368,9.827382 -14.174107,2.078868 0.755951,8.882441 6.803573,3.96875 3.96875,11.339285 -5.669643,6.047619 0.755952,9.449405 6.614581,7.9374999 0.188989,8.8824402 6.236612,3.0238094 6.04762,-2.6458332 3.77976,3.9687499 12.47321,0.9449405 V -4.0580357 l 12.6622,-2.0788691 -1.13392,-15.6860122 1.96547,-11.320386 z",LAND:20,FOREST:60,MOUNTAINS:50,CENTER:{x:114,y:-21},NEIGHBOURS:[15,16,18,19,20,108],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:18,PATH:"M 0.75595238,29.581845 -3.7797618,20.888392 -13.418155,15.029762 -9.8273808,6.5252975 0.56696427,3.8794642 6.8035714,8.9821426 5.6696427,-1.6011906 l 5.6696433,-2.6458333 4.157738,3.40178565 11.339285,-7.55952375 4.157739,-7.181547 13.229166,-1.133929 7.181546,9.8273808 5.858632,-4.9136908 -2.456844,-5.291666 10.583333,2.267857 5.102677,6.9925592 6.614584,-10.3943452 13.229166,3.212798 6.614583,7.9374997 0.188989,8.8824404 6.23661,3.0238094 6.04762,-2.6458332 3.77976,3.9687499 -4.91369,7.7485118 -9.449407,5.291666 -13.985118,2.267858 0.536956,8.275115 L 69.222807,29.596836 58.799295,23.716908 44.767645,28.260489 39.02135,26.790507 34.611402,23.316003 29.800552,33.60588 19.91158,32.002264 6.8153729,34.674958 Z",LAND:20,FOREST:80,MOUNTAINS:30,CENTER:{x:48,y:7},NEIGHBOURS:[7,15,17,19,22,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:19,PATH:"m 30.994048,-15.586309 -9.638393,-5.858632 -3.02381,-8.598956 -5.386161,-0.472472 2.173363,-3.590774 4.724703,-1.228421 0.377976,-6.331103 4.252232,-7.559522 5.669642,1.41741 7.087055,-1.795388 7.654018,-4.346726 4.630208,3.779763 7.559524,-1.417412 4.157737,-3.779761 3.685267,3.496281 1.228424,5.38616 3.401784,-0.850448 3.02381,-5.008184 4.535715,-2.267857 6.614583,-0.09449 0.755949,8.882441 6.803575,3.96875 3.96875,11.339285 -5.669645,6.047619 0.755954,9.449405 -13.229166,-3.212798 -6.614584,10.3943452 -5.102677,-6.9925592 -10.583333,-2.267857 2.456844,5.291666 -5.858632,4.9136908 -7.181546,-9.8273808 z",LAND:20,FOREST:60,MOUNTAINS:40,CENTER:{x:54,y:-32},NEIGHBOURS:[17,18,20,21,22],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:20,PATH:"m 109.80208,-78.519342 -8.23966,-5.473369 -4.543584,-9.354434 -10.557144,-1.469982 -10.557148,5.078121 -3.340867,6.68174 -11.49259,-0.668176 -4.276312,-7.082642 -13.096208,-0.400904 -7.082642,7.349913 -3.608139,6.681737 -13.363476,-5.078122 -8.018086,8.819896 -2.5390601,9.755339 -10.02260723,6.280832 3.47450383,7.082642 8.8198945,3.207234 8.862771,5.44285 4.252232,-7.559522 5.669642,1.41741 7.087055,-1.795388 7.654018,-4.346726 4.630208,3.779763 7.559524,-1.417412 4.157737,-3.779761 3.685267,3.496281 1.228424,5.38616 3.401784,-0.850448 3.02381,-5.008184 4.535715,-2.267857 6.614583,-0.09449 14.174104,-2.078874 10.016371,-9.827382 z",LAND:20,FOREST:40,MOUNTAINS:20,CENTER:{x:53,y:-68},NEIGHBOURS:[-1,17,19,21,33,108],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:21,PATH:"m -12.428033,-35.483294 -4.944486,-3.340867 -7.216277,0.400904 -4.409947,-4.142676 -1.603618,-7.082645 3.207234,-4.81085 7.884452,-2.672696 8.953529,3.608139 3.8754078,-4.81085 5.74629489,0.935442 3.47450381,7.082642 8.8198945,3.207234 8.862771,5.44285 -0.377976,6.331103 -4.724703,1.228421 -2.173363,3.590774 -8.1348325,-0.02244 -7.884451,5.61266 -4.8108512,-3.60814 0.5345388,-5.211754 z",LAND:10,FOREST:10,MOUNTAINS:20,CENTER:{x:-4,y:-42},NEIGHBOURS:[19,20,22,31,32,33],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:22,PATH:"m 12.945684,-30.516369 -8.1348325,-0.02244 -7.884451,5.61266 -4.8108514,-3.60814 0.534539,-5.211754 -5.0781211,-1.737252 -3.340869,5.61266 0.400904,6.280834 -13.22984,0.133635 -5.345391,5.34539 -9.621702,0.400904 -12.160766,5.345391 -3.741772,6.5481032 0.668174,7.7508163 -4.009044,5.2117558 -7.082641,2.0045214 3.608138,2.9399643 11.091685,6.548104 3.608139,9.888971 8.285356,-0.534537 6.414468,3.608138 6.815373,-0.53454 -0.400905,8.285356 9.354434,3.207234 3.727387,7.811127 6.425596,-6.236608 6.8035709,-3.212798 -0.7559524,-7.9375 5.66964288,-3.401785 -4.53571418,-8.693453 -9.6383932,-5.85863 3.5907742,-8.5044645 10.39434507,-2.6458333 6.23660713,5.1026782 -1.1339287,-10.583333 5.6696433,-2.6458333 4.157738,3.40178565 11.339285,-7.55952375 4.157739,-7.181547 -9.638393,-5.858632 -3.02381,-8.598956 z",LAND:30,FOREST:50,MOUNTAINS:20,CENTER:{x:-25,y:2},NEIGHBOURS:[18,19,21,23,30,31,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:23,PATH:"m -17.386905,50.370536 -3.727387,-7.811127 -9.354434,-3.207234 0.400905,-8.285356 -6.815373,0.53454 -6.414468,-3.608138 -8.285356,0.534537 -3.608139,-9.888971 -11.091685,-6.548104 -12.828936,3.34087 -8.151723,7.617181 -0.801806,10.690781 -8.285356,2.405425 1.069078,6.013564 -11.893495,6.414468 2.27179,2.672697 6.414471,-0.801809 -2.672701,8.953529 -5.21175,6.548104 8.819893,9.087164 3.059332,6.331924 6.614581,-0.755954 5.858634,-10.961307 3.779758,-11.150298 10.016371,2.645833 14.174108,-0.566962 8.504462,8.126487 14.363096,-1.700893 13.418154,-7.181548 z",LAND:30,FOREST:80,MOUNTAINS:0,CENTER:{x:-62,y:44},NEIGHBOURS:[22,24,28,29,30,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:24,PATH:"m -91.848214,135.22619 -10.016366,-6.80357 -2.26786,-8.50447 -10.58333,-7.9375 6.2366,-7.9375 12.851195,2.64584 8.504465,-10.583337 -6.992561,-7.74851 -0.377976,-6.992562 6.614583,-0.755952 5.858632,-10.961309 3.77976,-11.150298 10.016371,2.645833 14.174108,-0.566962 8.504462,8.126487 14.363096,-1.700893 -7.181548,7.748511 -2.267857,12.662204 1.889881,10.77232 -9.449405,5.858628 -4.157737,8.50447 5.669642,7.37053 -7.937499,7.18155 -3.212799,6.23661 -4.724701,3.40178 -13.607143,-3.59077 -9.07143,3.59077 z",LAND:40,FOREST:90,MOUNTAINS:40,CENTER:{x:-68,y:97},NEIGHBOURS:[23,25,26,28,106,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:25,PATH:"m -11.22532,183.67772 -14.855037,-2.33844 -17.197917,2.26786 -3.023809,-6.04762 5.669643,-3.96875 -7.370535,-6.61458 -12.851191,-1.51191 -1.889882,-10.39434 5.858632,-4.34673 4.157739,-11.52827 -5.10268,-5.85863 3.212799,-6.23661 7.937499,-7.18155 9.827382,-1.70089 0.755952,-7.37053 10.016368,-1.7009 7.90603,-9.12347 9.3544327,9.48806 -4.0090427,7.88446 12.69530229,11.62622 6.41446861,17.90706 -14.9670935,3.74177 6.2808339,12.02713 2.00452142,12.6953 z",LAND:30,FOREST:80,MOUNTAINS:20,CENTER:{x:-29,y:146},NEIGHBOURS:[-1,5,6,24,26,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:26,PATH:"m -60.854166,165.46428 -11.528274,8.31548 -4.913691,12.47321 -4.724701,13.04018 -16.063989,0.75595 -14.174109,4.72471 -9.63839,-5.85863 -2.83482,-9.6384 -8.50447,-11.52827 1.32292,-5.85863 0.56697,-10.96131 10.01636,-8.12649 16.63096,-3.40178 -1.13393,-8.12649 4.34672,1.13393 2.834826,4.53571 3.96875,2.83482 3.590774,-6.61458 -0.755954,-7.9375 6.614583,1.5119 9.07143,-3.59077 13.607143,3.59077 4.724701,-3.40178 5.10268,5.85863 -4.157739,11.52827 -5.858632,4.34673 z",LAND:30,FOREST:60,MOUNTAINS:30,CENTER:{x:-96,y:170},NEIGHBOURS:[-1,24,25,27,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:27,PATH:"m -133.23661,177.74851 -6.14445,7.53282 0.93545,7.75082 1.87088,10.15624 -4.54358,9.75534 -8.95353,-3.60814 0.26727,-6.1472 -3.87541,-5.74629 2.13816,-5.61266 -5.34539,0.4009 -5.07812,6.41447 -0.13364,6.54811 -8.68626,-2.53906 -8.01808,1.60361 -4.14268,-6.28083 2.6727,-5.61266 -6.28084,-0.93545 -3.87541,-7.88445 6.1472,-4.27631 4.00905,-9.2208 h 7.08264 l 2.40542,-7.61718 -1.73725,-4.27631 7.48355,-0.80181 3.60814,4.40995 1.73725,5.34539 6.41447,-8.95353 11.22532,-0.53454 2.93996,5.21176 7.76707,-1.90213 -0.56697,10.96131 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-158,y:180},NEIGHBOURS:[-1,26,39,40,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:28,PATH:"m -180.86161,118.40625 0.75596,-10.20536 10.20535,-6.99256 -4.53571,-5.480652 10.96131,1.511903 5.48065,-0.944938 3.59078,-11.150299 16.81994,2.456844 5.29167,-8.693451 -3.96875,-3.96875 1.5119,-3.401785 8.12649,3.401785 6.42559,-1.700893 -0.18899,-8.88244 5.29167,4.157739 8.72048,-2.5679 8.819893,9.087162 3.059332,6.331926 0.377976,6.992562 6.992559,7.748508 -8.504465,10.583339 -12.851195,-2.64584 -6.2366,7.9375 10.58333,7.9375 -9.54722,7.96695 -7.27652,2.27925 -4.4037,-4.96972 -0.28353,-14.18749 -10.61059,6.01356 -1.6838,7.64391 -6.21548,5.63935 -11.19493,3.03235 -8.12649,-7.74851 -11.33929,4.15773 z",LAND:10,FOREST:60,MOUNTAINS:50,CENTER:{x:-130,y:100},NEIGHBOURS:[23,24,29,38,39,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:29,PATH:"m -154.40327,85.144342 -7.18155,-7.748511 2.26786,-8.315476 -10.96131,-9.449403 -1.88988,-13.04018 3.77976,-9.071427 6.61458,-8.693452 -2.07887,-9.071429 11.33929,6.236607 11.71726,0.377976 6.99256,-7.9375 -2.64583,-7.370536 10.58333,3.212798 6.23661,11.90625 10.77232,3.401786 10.205356,-5.669643 11.388283,-0.863468 -0.801804,10.690781 -8.285358,2.405425 1.069078,6.013564 -11.893495,6.414468 2.27179,2.672697 6.414471,-0.801809 -2.672701,8.953529 -5.21175,6.548104 -8.72048,2.5679 -5.29167,-4.157739 0.18899,8.882438 -6.42559,1.700895 -8.12649,-3.401785 -1.5119,3.401785 3.96875,3.96875 -5.29167,8.693449 z",LAND:30,FOREST:80,MOUNTAINS:20,CENTER:{x:-140,y:51},NEIGHBOURS:[23,28,30,37,38,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:30,PATH:"m -59.467469,-5.8163777 -9.220798,-5.8799263 -12.294399,1.603617 -1.603618,-9.087164 4.009043,-4.009043 -6.147199,-2.939964 -7.750815,7.216276 -12.027135,-3.474503 -3.20723,-8.285357 -13.63075,7.483548 -3.20723,8.552625 -15.7689,4.8108514 1.60362,11.7598591 6.94901,4.0090428 -4.68553,5.1175267 10.58333,3.212798 6.23661,11.90625 10.77232,3.401786 10.205356,-5.669643 11.388283,-0.863468 8.151723,-7.617181 12.828936,-3.34087 -3.608138,-2.9399675 7.082641,-2.0045214 4.009044,-5.2117556 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-104,y:-2},NEIGHBOURS:[22,23,29,31,32,36,37],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:31,PATH:"m -84.72444,-26.128858 13.630746,-4.276312 4.276312,-8.285356 -1.603616,-4.810852 5.34539,-1.870887 0.80181,8.018086 4.543581,0.267269 4.810852,-9.354434 22.317004,-3.207234 1.603618,7.082645 4.409947,4.142676 7.216277,-0.400904 4.944486,3.340867 -3.340869,5.612659 0.400904,6.280834 -13.22984,0.133635 -5.345391,5.34539 -9.621702,0.400904 -12.160766,5.345391 -3.741772,6.5481033 -9.220798,-5.8799263 -12.294399,1.603617 -1.603618,-9.087164 4.009043,-4.009043 z",LAND:20,FOREST:60,MOUNTAINS:50,CENTER:{x:-50,y:-28},NEIGHBOURS:[21,22,30,32],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:32,PATH:"m -64.946495,-102.83521 -1.069078,10.42351 -9.888971,5.879928 -5.34539,11.49259 -9.621705,1.336347 -2.138157,8.552627 6.414471,-0.801809 5.879928,3.474503 -2.939965,8.285355 -2.939963,12.561668 -10.156242,-1.870887 -3.207235,8.552624 -7.750818,4.276312 3.20723,8.285357 12.027137,3.474503 7.750813,-7.216276 13.630746,-4.276312 4.276312,-8.285356 -1.603616,-4.810852 5.34539,-1.870887 0.80181,8.018086 4.543581,0.267269 4.810852,-9.354434 22.317004,-3.207234 3.207234,-4.81085 7.884452,-2.672696 8.953529,3.608139 -3.427973,-6.663516 4.1577382,-10.583333 4.5357142,-7.559521 -6.9925594,-6.614581 -5.102679,-1.322919 -9.072777,-2.402073 -15.234365,0.267269 -12.561667,-1.603616 z",LAND:20,FOREST:40,MOUNTAINS:90,CENTER:{x:-57,y:-64},NEIGHBOURS:[21,30,31,33,34,35,36,52],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:33,PATH:"m 56.794775,-90.808084 0.846593,-10.200846 11.339287,-10.01637 -9.092728,-8.51199 -10.075318,-5.00147 -5.635252,-10.79329 -7.313215,1.72579 -1.716291,5.14658 -4.468898,3.86557 -14.384054,0.56892 -4.199661,-7.69708 -6.5002804,4.10109 -3.9743132,9.24176 -7.6666341,4.15346 0.6681736,7.75293 -7.1898919,3.9522 -4.819197,16.252975 5.102679,1.322917 6.9925594,6.614583 -4.5357142,7.559521 -4.1577382,10.583333 3.427973,6.663516 3.8754078,-4.81085 5.74629489,0.935442 10.02260701,-6.280832 2.5390603,-9.755339 8.018086,-8.819896 13.363476,5.078122 3.608139,-6.681737 7.082642,-7.349911 z",LAND:30,FOREST:50,MOUNTAINS:70,CENTER:{x:20,y:-101},NEIGHBOURS:[-1,20,21,32,34],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:34,PATH:"m 5.5949574,-127.62118 -12.8112346,-9.42453 -4.8108518,-9.6217 -10.95805,-2.6727 -5.879928,-10.42351 -9.354434,5.34539 -9.087165,9.88897 -16.83798,-4.00904 -5.612659,7.75082 9.888972,14.43255 2.672696,14.96709 -7.750818,8.55263 10.690781,12.828935 12.561667,1.603616 15.234365,-0.267269 9.072777,2.402073 4.819197,-16.252975 7.189892,-3.9522 -0.6681737,-7.75293 7.6666341,-4.15346 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-34,y:-117},NEIGHBOURS:[-1,32,33,35],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:35,PATH:"m -69.757345,-140.78748 -4.276315,-2.53906 -8.819893,1.46998 -4.142676,8.68626 -7.216278,0.53454 -2.004523,4.94448 -9.88897,1.87089 1.06908,6.28083 7.349908,7.34992 -1.870885,8.81989 7.349911,6.280834 3.741774,8.552624 6.414468,3.207234 0.801812,10.289876 5.345388,-11.49259 9.888971,-5.879928 1.069078,-10.42351 7.750818,-8.55263 -2.672696,-14.96709 z",LAND:20,FOREST:10,MOUNTAINS:20,CENTER:{x:-81,y:-112},NEIGHBOURS:[-1,32,34,52,53],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:36,PATH:"m -121.34037,-23.188894 -6.949,-5.879929 -1.06908,-12.561668 -8.28535,-0.267269 -4.54359,5.34539 -5.61266,-10.423511 5.34539,-10.156243 12.2944,-4.81085 -4.27631,-8.285355 0.53454,-16.570712 4.27631,4.009044 1.87089,5.879928 6.68174,5.078121 9.35443,-4.81085 6.94901,4.009041 3.20723,-7.483546 10.690783,6.414468 -2.138159,8.552627 6.414471,-0.801809 5.879928,3.474503 -2.939965,8.285355 -2.939963,12.561668 -10.15624,-1.870887 -3.207237,8.552624 -7.750818,4.276312 z",LAND:20,FOREST:60,MOUNTAINS:10,CENTER:{x:-114,y:-52},NEIGHBOURS:[30,32,37,50,51,52],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:37,PATH:"m -192.57887,9.1711303 7.37054,2e-7 4.53571,-4.9136905 7.9375,2.8348215 5.29167,3.5907735 5.85863,-3.4017854 5.48066,0.9449403 3.96875,-7.37053545 -6.23661,-5.66964285 -2.07887,-5.2916666 6.42559,0.3779764 4.91369,-3.7797624 -0.18898,-6.236607 h 7.55952 l 6.23661,-3.212797 1.70089,-5.480656 5.5142,-0.631322 6.949,5.879929 -3.20723,8.552625 -15.7689,4.8108514 1.60362,11.7598591 6.94901,4.0090428 -4.68553,5.1175267 2.64583,7.370536 -6.99256,7.9375 -11.71726,-0.377976 -11.33929,-6.236607 -16.28698,1.423383 -20.31248,-8.552624 7.30631,-0.241295 z",LAND:10,FOREST:30,MOUNTAINS:10,CENTER:{x:-146,y:10},NEIGHBOURS:[29,30,36,48,49,50,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:38,PATH:"m -210.91071,87.979162 -16.80293,-8.536559 5.3454,-13.898015 17.35916,-9.795427 17.53764,3.566014 15.30329,-12.724403 1.88988,13.04018 10.96131,9.449403 -2.26786,8.315476 7.18155,7.748511 -3.59078,11.150301 -5.48065,0.944938 -10.96131,-1.511903 4.53571,5.480652 -10.20535,6.99256 -12.66221,-5.85863 -3.0238,-12.095238 -10.20536,-10.961309 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-183,y:80},NEIGHBOURS:[-2,28,29,47,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:39,PATH:"m -249.46428,177.74851 0.75595,-13.41816 16.06399,-11.33928 -5.10268,-10.01637 -5.85863,-12.09524 17.19791,-4.53571 2.64584,-7.74851 -6.4256,-8.12649 6.23661,-2.26786 6.99256,7.9375 -1.51191,12.47321 13.41816,-6.42559 7.55952,-10.58333 16.63095,6.80357 6.04762,11.33928 11.33929,-4.15773 8.12649,7.74851 -3.02381,14.74107 5.09295,10.0761 -6.41447,8.95353 -1.73725,-5.34539 -3.60814,-4.40995 -7.48355,0.80181 1.73725,4.27631 -2.40542,7.61718 h -7.08264 l -4.00905,9.2208 -6.1472,4.27631 -13.29962,-11.84314 -0.18899,8.50441 -14.74107,1.32297 -12.66221,-7.18155 0.56697,9.82733 -13.60714,7.9375 z",LAND:20,FOREST:100,MOUNTAINS:50,CENTER:{x:-202,y:151},NEIGHBOURS:[-2,27,28,40,41,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:40,PATH:"m -182.94599,197.97664 -6.23109,10.57693 5.85863,10.20536 -14.93006,0.18898 -2.91317,-7.67206 -6.15826,-0.0764 -4.7247,6.4256 5.48065,10.20535 -3.21279,10.39435 -8.88244,6.99256 -5.66965,2.45684 -4.34672,-3.59077 -9.82738,-4.53571 1.13392,-13.60715 6.61459,-9.26041 -0.94494,-6.61459 -6.12787,-0.5266 -9.93612,6.76321 -4.15774,10.96131 -7.35164,10.34705 -1.33945,-7.70599 0.5646,-10.76755 -2.06955,-10.52743 6.53439,-10.09117 11.22118,-6.4067 13.60714,-7.9375 -0.56697,-9.82738 12.66221,7.18155 14.74107,-1.32292 0.18899,-8.50446 13.29962,11.84314 3.87541,7.8845 6.28084,0.93545 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-220,y:202},NEIGHBOURS:[-1,27,39,41],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:41,PATH:"m -260.61222,229.9045 -16.25534,-4.53099 0.56697,9.63839 -25.13541,3.40179 -11.71726,-3.02381 -4.72472,-13.98512 4.91371,-13.79613 -8.31548,-13.98512 6.61458,-10.39435 14.1741,4.91369 7.9375,-11.33928 12.28423,-7.55953 2.07886,-11.33928 13.60715,5.10268 0.18899,11.1503 14.93006,3.59077 5.10268,14.36309 -11.22118,6.40675 -6.53439,10.09117 2.06955,10.52738 z",LAND:20,FOREST:60,MOUNTAINS:10,CENTER:{x:-283,y:201},NEIGHBOURS:[-1,-2,39,40,42,43],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:42,PATH:"m -317.87798,221.40476 -5.25087,-3.51654 -10.15624,5.07812 1.60361,10.15624 -5.3454,5.61266 -12.56165,3.74177 -10.42352,-6.949 2.67268,-9.88898 -8.28534,-6.41447 1.33635,-8.28535 7.48356,-9.6217 -3.47451,-8.01809 11.75986,-2.93996 10.15624,-2.13816 6.41445,-8.01809 5.3454,4.00905 11.93819,-0.9831 -6.61458,10.39435 8.31548,13.98512 z",LAND:10,FOREST:60,MOUNTAINS:20,CENTER:{x:-340,y:210},NEIGHBOURS:[-1,41,43,44,65],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:43,PATH:"m -314.66517,183.22916 -11.93819,0.9831 -5.3454,-4.00905 -8.5526,-0.8018 1.60361,-12.02713 -4.27633,-10.15625 7.48356,0.26728 8.28534,8.81989 -1.33633,-10.15624 -7.48355,-9.35444 5.61266,-6.68173 5.87994,1.33634 -4.54358,-11.75986 14.79986,-0.88868 4.15774,12.47322 19.65476,3.77976 12.4732,12.85119 -2.07886,11.33928 -12.28423,7.55953 -7.9375,11.33928 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-308,y:163},NEIGHBOURS:[-2,41,42,44,45],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:44,PATH:"m -339.69957,130.22381 -10.4235,1.60362 -3.74179,7.75082 -8.01806,5.07812 -5.87994,15.50163 8.28534,7.75082 -4.54358,12.56166 -11.49257,7.75082 2.4054,12.2944 8.81991,10.42351 7.48356,-9.6217 -3.47451,-8.01809 21.9161,-5.07812 6.41445,-8.01809 -8.5526,-0.8018 1.60361,-12.02713 -4.27633,-10.15625 7.48356,0.26728 8.28534,8.81989 -1.33633,-10.15624 -7.48355,-9.35444 5.61266,-6.68173 5.87994,1.33634 -4.54358,-11.75986 -4.27633,4.00905 z",LAND:20,FOREST:40,MOUNTAINS:10,CENTER:{x:-351,y:162},NEIGHBOURS:[42,43,45,63,64,65],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:45,PATH:"m -320.45616,56.190154 -13.89801,2.405425 -12.82895,-2.672693 -0.53454,10.958049 -10.4235,12.561668 11.75986,3.207234 -2.40544,13.630746 8.0181,15.768897 8.55263,1.87089 -7.48356,16.30344 6.1472,3.47451 4.27633,-4.00905 14.79986,-0.88868 8.31546,-15.11904 -14.36309,-25.324407 12.85121,-1.13393 -14.11992,-9.116957 -4.00904,-12.561668 z",LAND:20,FOREST:50,MOUNTAINS:0,CENTER:{x:-330,y:97},NEIGHBOURS:[-2,43,44,46,62,63],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:46,PATH:"m -307.6726,87.223213 -14.11992,-9.116957 -4.00904,-12.561668 5.3454,-9.354434 -1.33636,-14.699823 -10.69078,-1.336347 -2.67269,-8.552625 6.41448,-2.138156 19.24341,-3.207235 8.81989,4.810851 13.63075,-10.69078 17.37251,-4.810852 14.16529,4.009043 9.35443,-0.534539 11.75986,-5.61266 10.95805,7.750816 -8.55263,15.501634 -7.21627,-1.870888 -8.8199,-6.147199 -6.41447,9.087165 1.60362,9.888971 -12.56167,0.267269 -10.95804,-4.009043 -8.01809,2.405427 1.60361,11.225318 7.75081,13.898018 -17.90705,7.483546 0.75181,9.827051 z",LAND:30,FOREST:60,MOUNTAINS:80,CENTER:{x:-286,y:38},NEIGHBOURS:[-2,45,47,48,60,61,62,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:47,PATH:"m -292.17559,88.735116 -0.75181,-9.827051 17.90705,-7.483546 -7.75081,-13.898018 -1.60361,-11.225318 8.01809,-2.405427 10.95804,4.009043 12.56167,-0.267269 -1.60362,-9.888971 6.41447,-9.087165 8.8199,6.147199 7.21627,1.870888 8.55263,9.621702 1.06908,19.243405 -5.3454,13.898015 16.80293,8.536559 -21.92262,5.291669 h -15.875 l -9.07143,17.008929 -19.65475,-1.88988 -10.96132,-9.071428 z",LAND:10,FOREST:60,MOUNTAINS:50,CENTER:{x:-254,y:73},NEIGHBOURS:[-2,38,46,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:48,PATH:"m -234.39537,13.427031 1.18406,-11.2484599 -5.66964,-8.5044643 3.77976,-9.4494048 4.15774,2.834822 3.2128,-7.9375 -6.23661,-6.99256 2.83482,-9.071427 13.41816,-4.535715 11.52827,7.9375 2.07887,12.473214 8.50446,0.755952 3.02381,6.992559 -0.37797,12.47321459 -5.48066,2.45684521 5.85863,7.5595237 -0.56696,3.2127975 -7.30631,0.241295 -22.98518,8.552624 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-216,y:-3},NEIGHBOURS:[-3,37,46,49,60,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:49,PATH:"m -149.11161,-13.507441 -8.69345,-3.96875 1.32292,-8.504464 -9.07143,-3.968749 -7.37054,4.157737 -2.64583,-5.85863 -7.18155,-5.669642 -7.74851,0.377976 -5.66964,-6.425597 -7.37054,3.023809 -2.64583,6.803573 2.07887,12.473214 8.50446,0.755952 3.02381,6.992559 -0.37797,12.47321459 -5.48066,2.45684521 5.85863,7.5595235 h 7.37054 l 4.53571,-4.9136903 7.9375,2.8348215 5.29167,3.5907735 5.85863,-3.4017854 5.48066,0.9449401 3.96875,-7.37053525 -6.23661,-5.66964285 -2.07887,-5.2916666 6.42559,0.3779766 z",LAND:20,FOREST:40,MOUNTAINS:0,CENTER:{x:-177,y:-11},NEIGHBOURS:[-3,37,48,50],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:50,PATH:"m -178.02678,-53.572917 8.12648,-2.078869 3.2128,-7.181548 -5.10268,-9.260416 6.99256,0.94494 4.34673,3.590775 3.40178,-5.858632 -3.77976,-4.724702 7.9375,-2.078868 9.6384,0.944941 1.70089,7.370535 7.11551,1.676434 4.27631,8.285353 -12.2944,4.81085 -5.34539,10.156243 5.61266,10.423511 4.54359,-5.34539 8.28535,0.267269 1.06908,12.561668 -5.5142,0.631322 -1.70089,5.480656 -6.23661,3.212797 h -7.55952 l 0.18898,6.236607 -8.69345,-3.96875 1.32292,-8.504464 -9.07143,-3.968749 -0.56696,-6.425597 -10.39435,-1.322917 1.32292,-7.370534 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-159,y:-47},NEIGHBOURS:[-3,36,37,49,51],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:51,PATH:"m -188.23214,-70.581845 4.61798,-8.199109 7.75081,-0.801809 -3.4745,-8.018087 9.88897,-3.474503 -7.21627,-6.147199 3.20723,-2.405425 2.67269,2.405425 5.87993,-1.069078 -0.53454,-6.1472 5.87993,-1.33635 3.47451,-3.74177 8.81989,1.46998 6.28084,4.54359 -3.74178,2.67269 4.54358,5.07812 8.8199,-2.806326 6.81537,1.336346 1.60362,4.27631 4.00904,-1.603616 5.07812,4.409948 -3.34087,3.073601 5.7463,5.612659 -0.26727,4.81085 -9.35443,4.81085 -6.68174,-5.078121 -1.87089,-5.879928 -4.27631,-4.009044 -0.53454,16.570714 -7.11551,-1.676434 -1.70089,-7.370535 -9.6384,-0.944941 -7.9375,2.078868 3.77976,4.724702 -3.40178,5.858632 -4.34673,-3.590775 -6.99256,-0.944938 5.10268,9.260414 -3.2128,7.181548 -8.12648,2.078869 -8.12649,-9.638393 z",LAND:10,FOREST:30,MOUNTAINS:50,CENTER:{x:-153,y:-90},NEIGHBOURS:[-3,36,50,52,55,56],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:52,PATH:"m -111.71866,-76.642798 0.26727,-4.810852 -5.7463,-5.612659 3.34087,-3.073601 -5.07812,-4.409946 -4.00904,1.603616 -1.60362,-4.276312 2.93997,-5.879928 -2.53906,-4.40995 4.67721,-2.13815 1.60362,-5.21176 4.40995,-4.81085 8.41899,0.13363 7.34991,7.34992 -1.870887,8.81989 7.349913,6.280836 3.741772,8.552622 6.414468,3.207234 0.801812,10.289876 -9.621705,1.336347 -10.690783,-6.414466 -3.20723,7.483544 z",LAND:10,FOREST:20,MOUNTAINS:10,CENTER:{x:-107,y:-93},NEIGHBOURS:[35,36,51,53,55],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:53,PATH:"m -82.853553,-141.85656 -4.810852,-2.27179 -0.400902,-7.48355 -4.409948,-3.20723 -10.824415,-0.13364 -4.00904,4.94449 -6.01357,-1.20271 0.53454,-7.88446 -4.94449,0.40091 -9.88897,2.27179 -0.4009,7.21628 -4.67722,5.74629 3.60814,5.34539 7.34991,3.20723 -0.26727,7.88446 2.00452,6.28083 -2.00452,5.7463 4.14268,0.13363 4.40995,-4.81085 8.41899,0.13363 -1.06908,-6.28083 9.88897,-1.87089 2.004523,-4.94448 7.216278,-0.53454 z",LAND:10,FOREST:10,MOUNTAINS:10,CENTER:{x:-111,y:-137},NEIGHBOURS:[-1,35,52,54,55],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:54,PATH:"m -158.08992,-140.25295 -6.94901,-1.60361 -3.20724,-3.34087 -6.68173,-1.06908 -2.00453,-3.87541 -0.26727,-2.27179 2.53907,-5.74629 11.35895,-3.20724 6.5481,4.67722 7.34992,-3.74178 5.34539,3.07361 2.53906,3.74177 6.5481,-4.27631 7.34991,1.46998 -0.4009,7.21628 -4.67722,5.74629 -0.80181,4.81085 -4.14267,0.93545 -7.61719,-0.80181 -4.54358,-4.67722 z",LAND:10,FOREST:10,MOUNTAINS:0,CENTER:{x:-153,y:-150},NEIGHBOURS:[-1,53,55,56],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:55,PATH:"m -124.5476,-97.22255 -6.81537,-1.336349 -8.8199,2.806329 -4.54358,-5.07812 3.74178,-2.67269 -6.28084,-4.54359 -0.53454,-6.949 -8.28535,-2.13816 -4.00904,-5.47903 3.8754,-5.21175 -4.40994,-5.21176 2.53906,-7.21628 8.28535,-2.93996 4.54358,4.67722 7.61719,0.80181 4.14267,-0.93545 0.80181,-4.81085 3.60814,5.34539 7.34991,3.20723 -0.26727,7.88446 2.00452,6.28083 -2.00452,5.7463 4.14268,0.13363 -1.60362,5.21176 -4.67721,2.13815 2.53906,4.40995 z",LAND:10,FOREST:20,MOUNTAINS:0,CENTER:{x:-136,y:-119},NEIGHBOURS:[51,52,53,54,56],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:56,PATH:"m -174.9279,-146.26651 -8.57954,-0.28855 -7.37053,-6.80357 2.64583,-6.04762 -12.47321,0.37798 -7.37054,8.69345 -9.44941,3.40179 -8.12648,7.37053 6.2366,8.12649 8.12649,1.32292 -2.45684,6.61458 -11.52828,2.64583 1.13393,7.37054 -1.88988,10.96131 2.64583,10.016367 4.91369,1.511904 1.88989,10.205357 6.99255,1.511906 -2.07886,3.212798 6.42559,5.669643 17.00893,-0.18899 4.61798,-8.199109 7.75081,-0.801809 -3.4745,-8.018087 9.88897,-3.474503 -7.21627,-6.147197 3.20723,-2.405424 2.67269,2.405424 5.87993,-1.069078 -0.53454,-6.147202 5.87993,-1.33635 3.47451,-3.74177 8.81989,1.46998 -0.53454,-6.949 -8.28535,-2.13816 -4.00904,-5.47903 3.8754,-5.21175 -4.40994,-5.21176 2.53906,-7.21628 -6.94901,-1.60361 -3.20724,-3.34087 z",LAND:10,FOREST:80,MOUNTAINS:40,CENTER:{x:-192,y:-118},NEIGHBOURS:[-1,-3,51,54,55,57,58],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:57,PATH:"m -225.65178,-139.5625 -6.99256,0.94494 -4.15774,-5.29167 1.13393,-5.10267 -4.34673,-7.9375 -8.50446,-0.75596 -10.96131,3.96875 -6.80358,6.04762 3.40179,13.04018 -5.66964,4.7247 -4.53573,10.01637 7.55955,9.6384 9.26041,-1.32292 4.53571,8.69345 7.74851,4.15774 7.74851,-1.32292 5.10268,6.236611 3.2128,3.779761 4.53571,-2.456845 -2.64583,-10.016367 1.88988,-10.96131 -1.13393,-7.37054 11.52828,-2.64583 2.45684,-6.61458 -8.12649,-1.32292 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-248,y:-125},NEIGHBOURS:[-1,56,58,75,76],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:58,PATH:"m -251.73214,-102.89881 -4.15774,4.535716 2.45685,4.913691 -2.26786,7.74851 -4.7247,4.724702 2.26785,6.614583 -4.34672,5.480656 -4.7247,0.755952 0.56697,3.212798 3.21279,2.456847 4.91369,0.566962 -1.32292,4.913691 6.23661,5.480656 6.42559,-4.724705 -4.7247,-7.74851 7.74851,-6.992559 17.76488,0.94494 14.74108,-6.047618 2.07886,-3.212798 -6.99255,-1.511906 -1.88989,-10.205355 -4.91369,-1.511906 -4.53571,2.456847 -8.31548,-10.016374 -7.74851,1.32292 z",LAND:30,FOREST:60,MOUNTAINS:20,CENTER:{x:-241,y:-84},NEIGHBOURS:[-3,56,57,59,75],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:59,PATH:"m -295.86737,-44.035916 0.66797,-5.568251 4.72471,-5.102678 0.37796,-7.181548 7.37055,0.377976 4.5357,-5.858629 0.94496,-6.425597 5.85861,-1.322917 5.66966,-4.346725 7.55951,5.102677 -4.34672,5.480656 -4.7247,0.755954 0.56697,3.212796 3.21279,2.456847 4.91369,0.566962 -1.32292,4.913691 6.23661,5.480656 6.42559,-4.724705 8.31548,1.511906 1.70089,3.96875 -11.15029,3.212799 -4.53572,7.74851 1.51191,7.559524 -7.9375,1.133928 -7.55952,5.291667 -13.98513,-1.322917 -0.86577,-5.963283 9.08716,2.405425 2.40544,-9.087162 -8.55263,-7.216277 -6.68174,-4.276312 z",LAND:10,FOREST:60,MOUNTAINS:0,CENTER:{x:-267,y:-50},NEIGHBOURS:[-3,58,60,61,74,75],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:60,PATH:"m -287.04746,20.376039 -7.77396,-7.614135 3.02382,-10.5833329 -6.23663,-1.1339286 -2.07886,-4.5357142 4.5357,-3.0238094 h 6.42562 l 6.2366,1.3229166 3.49628,-3.9687502 -7.27604,-6.6145833 -1.7009,-6.614583 7.55952,-4.724703 13.98513,1.322917 7.55952,-5.291667 7.9375,-1.133928 3.96875,2.456844 8.31547,-3.77976 h 2.83482 l 2.26786,5.669642 6.23661,6.99256 -3.2128,7.9375 -4.15774,-2.834822 -3.77976,9.4494048 5.66964,8.5044643 -1.18406,11.2484599 -11.75986,5.61266 -9.35443,0.534539 -14.16529,-4.009043 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-262,y:-5},NEIGHBOURS:[-3,46,48,59,61],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:61,PATH:"m -336.22506,9.9525269 1.87089,-6.4144683 -6.14719,-7.216277 2.93994,-9.3544336 6.41448,-6.681738 -5.61266,-9.621702 2.40543,-10.156243 10.15625,-5.078121 10.69078,5.34539 7.21627,-9.087162 10.4235,4.276312 10.42352,-7.216277 6.68174,4.276312 8.55263,7.216277 -2.40544,9.087162 -9.08716,-2.405425 0.86577,5.963283 -7.55952,4.724703 1.7009,6.614583 7.27604,6.6145833 -3.49628,3.9687502 -6.2366,-1.3229166 h -6.42562 l -4.5357,3.0238094 2.07886,4.5357142 6.23663,1.1339286 -3.02382,10.5833329 7.77396,7.614135 -13.63075,10.69078 -8.81989,-4.810851 -6.41448,-9.354433 -12.56167,0.801808 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-313,y:-14},NEIGHBOURS:[46,59,60,62,72,73,74],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:62,PATH:"m -395.36309,71.726189 -0.46307,-6.716139 9.08717,-6.949008 -2.13818,-9.087165 -9.35442,-8.285356 7.48355,-4.00904 8.01809,2.405425 8.28535,-0.534541 2.40543,-6.147196 5.34538,-8.819896 7.48355,-5.61266 7.75081,3.741773 4.27631,-4.276312 2.67271,-9.621703 8.28535,2.1381561 7.75081,7.7508159 12.56167,-0.801808 6.41448,9.354433 -19.24341,3.207235 -6.41448,2.138156 2.67269,8.552625 10.69078,1.336347 1.33636,14.699823 -13.89801,2.405425 -12.82895,-2.672693 -0.53454,10.958049 -15.51744,4.467278 -8.69347,5.291664 z",LAND:40,FOREST:50,MOUNTAINS:50,CENTER:{x:-355,y:44},NEIGHBOURS:[45,46,61,63,70,71,72],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:63,PATH:"m -361.88292,144.65637 -14.95933,1.53113 -10.20535,-6.80357 -6.80358,-11.33929 -19.65476,5.29167 -3.4018,-19.65476 9.44941,-6.4256 4.53573,4.91369 13.60712,-3.02381 2.26788,-10.205354 -9.44941,-15.119048 -11.3393,-4.535715 12.47322,-7.559524 23.43452,4.91369 8.69347,-5.291666 15.51744,-4.467278 -10.4235,12.561668 11.75986,3.207234 -2.40544,13.630746 8.0181,15.768897 8.55263,1.87089 -7.48356,16.30344 -10.4235,1.60362 -3.74179,7.75082 z",LAND:30,FOREST:100,MOUNTAINS:10,CENTER:{x:-370,y:112},NEIGHBOURS:[44,45,62,64,68,69],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:64,PATH:"m -408.65509,185.5486 -2.40543,-5.07812 7.48355,-5.34539 -2.67272,-6.68174 8.81992,-1.06907 3.20722,4.81085 5.34538,-2.6727 -3.20723,-6.41447 -5.07812,-2.13815 0.53454,-6.41447 5.61266,-2.6727 2.67271,-6.68173 1.29501,-5.80698 10.20535,6.80357 14.95933,-1.53113 -5.87994,15.50163 8.28534,7.75082 -4.54358,12.56166 -11.49257,7.75082 2.4054,12.2944 -15.7689,3.74177 -8.5526,-5.61266 -1.33636,-12.02713 z",LAND:10,FOREST:10,MOUNTAINS:40,CENTER:{x:-380,y:174},NEIGHBOURS:[44,63,65,67,68],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:65,PATH:"m -373.10827,200.5157 -15.7689,3.74177 -8.5526,-5.61266 -6.41448,-8.28535 -8.81989,12.56166 -9.6217,6.68174 -0.80182,13.63075 6.68173,10.95805 7.75084,4.54358 1.87087,-6.41447 -4.2763,-4.81085 9.35442,-0.80181 8.01809,4.81085 5.87994,-3.74177 3.74177,9.35443 6.14719,-5.34539 8.01809,-1.06908 12.56165,-5.07812 -8.28534,-6.41447 1.33635,-8.28535 z",LAND:10,FOREST:70,MOUNTAINS:0,CENTER:{x:-392,y:217},NEIGHBOURS:[-1,42,44,64,66,67],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:66,PATH:"m -408.65509,238.73524 -11.75988,4.81085 -2.40541,9.6217 -9.35445,9.35444 2.40543,11.22531 -4.81084,6.68174 -6.68176,2.40543 -11.22532,1.33636 -6.41445,-2.93997 1.33633,-4.54359 7.48356,-0.80182 6.94901,-2.67268 1.06908,-6.1472 -1.8709,-7.48355 -13.09621,1.06908 -6.94899,-4.27631 -5.87994,-14.16529 4.54358,-9.08716 5.07812,-8.55262 7.48356,4.81085 11.75985,0.80181 7.21628,-4.00905 10.69078,-2.93996 6.68173,10.95805 z",LAND:10,FOREST:50,MOUNTAINS:20,CENTER:{x:-444,y:246},NEIGHBOURS:[-1,65,67,90],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:67,PATH:"m -476.80882,228.31173 4.2763,-8.28536 -2.93997,-9.35443 9.35445,-4.00904 v -5.61266 l 4.54358,-8.55263 3.47449,2.6727 -2.13816,6.68174 1.60362,4.00904 9.08717,-4.81085 0.53453,-8.28536 8.81991,-6.949 10.69079,0.8018 6.68173,5.07812 6.41445,-5.61266 7.75084,-0.53454 9.88896,1.06908 1.33636,12.02713 -6.41448,-8.28535 -8.81989,12.56166 -9.6217,6.68174 -0.80182,13.63075 -10.69078,2.93996 -7.21628,4.00905 -11.75985,-0.80181 -7.48356,-4.81085 -5.07812,8.55262 z",LAND:20,FOREST:60,MOUNTAINS:20,CENTER:{x:-443,y:211},NEIGHBOURS:[64,65,66,68,89,90,91],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:68,PATH:"m -449.01281,192.76488 -4.36962,-7.07887 5.48066,-5.48066 -11.52829,-7.55952 -3.77976,-10.39434 16.06399,-4.15774 8.12649,-6.99256 3.40178,-8.88244 -2.45684,-6.99256 6.2366,-6.99256 8.50447,0.37797 -0.18899,-9.07142 -4.72469,-4.91369 5.29167,-1.13393 6.0476,0.18899 3.4018,19.65476 19.65476,-5.29167 6.80358,11.33929 -1.29501,5.80698 -2.67271,6.68173 -5.61266,2.6727 -0.53454,6.41447 5.07812,2.13815 3.20723,6.41447 -5.34538,2.6727 -3.20722,-4.81085 -8.81992,1.06907 2.67272,6.68174 -7.48355,5.34539 2.40543,5.07812 -7.75084,0.53454 -6.41445,5.61266 -6.68173,-5.07812 -10.69079,-0.8018 z",LAND:30,FOREST:50,MOUNTAINS:30,CENTER:{x:-423,y:160},NEIGHBOURS:[63,64,67,69,87,88,89],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:69,PATH:"m -430.78607,119.90506 -6.73414,-7.05377 2.13815,-8.55262 6.41448,-6.949009 -11.22532,-2.672694 -10.15624,5.345393 -1.60364,-7.750818 6.41448,-4.810853 -6.41448,-5.612659 7.2163,-7.483549 10.69078,-2.405425 -4.27633,-4.276312 5.07812,-9.621702 14.16529,4.009043 4.81087,10.423512 6.43144,6.792116 11.3393,4.535715 9.44941,15.119048 -2.26788,10.205354 -13.60712,3.02381 -4.53573,-4.91369 -9.44941,6.4256 -6.0476,-0.18899 -5.29167,1.13393 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-420,y:91},NEIGHBOURS:[63,68,70,87,88],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:70,PATH:"m -407.83631,79.285713 -6.43144,-6.792116 -4.81087,-10.423512 -14.16529,-4.009043 -11.22531,3.474503 -0.53454,-13.096206 8.55263,-7.750818 0.26725,-8.285352 5.34541,-8.285357 -4.54359,-4.810852 15.76891,-0.534539 9.08716,8.819895 10.69078,-5.345391 10.95804,2.405426 6.14722,14.432555 -8.01809,-2.405425 -7.48355,4.00904 9.35442,8.285356 2.13818,9.087165 -9.08717,6.949008 0.46307,6.716139 z",LAND:20,FOREST:60,MOUNTAINS:50,CENTER:{x:-417,y:47},NEIGHBOURS:[62,63,69,71,85,87],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:71,PATH:"m -366.69379,23.583273 -3.72287,-9.876428 -9.82739,-5.1026787 -7.74851,-0.3779764 -1.13393,-6.2366069 0.37799,-6.047619 -6.99257,-0.1889881 -3.40177,4.34672617 -7.74851,-1.88988097 -6.23663,-6.8035713 -4.15774,3.5907736 -5.48063,5.85863105 -10.20538,-4.72470225 -3.21278,-6.4255952 -5.85864,2.6458331 0.37798,6.0476191 6.2366,4.1577381 0.94493,7.3705356 -5.29166,5.1026781 -0.37796,5.858631 -2.45684,6.614585 6.42622,4.900192 5.34541,-8.285357 -4.54359,-4.810852 15.76891,-0.534539 9.08716,8.819895 10.69078,-5.345391 10.95804,2.405426 6.14722,14.432555 8.28535,-0.534541 2.40543,-6.147196 z",LAND:10,FOREST:40,MOUNTAINS:20,CENTER:{x:-405,y:10},NEIGHBOURS:[62,70,72,84,85],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:72,PATH:"m -395.74107,-4.2470241 -2.45684,-6.8035709 4.34673,-4.724703 -3.21281,-6.425595 -7.37052,-2.456845 5.29167,-4.157739 -0.189,-4.157736 4.15775,-2.834823 0.75594,-6.80357 -5.85862,-3.401787 3.77976,-1.511903 3.02379,1.889879 5.48066,-1.133928 2.64583,-4.346726 11.15031,9.638393 6.2366,-1.322917 -1.13393,6.992559 -6.80357,0.755952 -1.32292,3.779763 11.15031,1.511903 3.40178,5.10268 -1.13393,5.858631 7.37053,5.291666 9.07145,-3.023809 9.79868,3.498598 -2.93994,9.3544336 6.14719,7.216277 -1.87089,6.4144683 -8.28535,-2.1381559 -2.67271,9.621703 -4.27631,4.276312 -7.75081,-3.741773 -7.48355,5.61266 -3.72287,-9.876428 -9.82739,-5.1026787 -7.74851,-0.3779766 -1.13393,-6.2366067 0.37799,-6.047619 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-373,y:-5},NEIGHBOURS:[61,62,71,73,83,84],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:73,PATH:"m -337.56142,-13.032652 -9.79868,-3.498598 -9.07145,3.023809 -7.37053,-5.291666 1.13393,-5.858631 -3.40178,-5.10268 -11.15031,-1.511903 1.32292,-3.779763 6.80357,-0.755952 1.13393,-6.992559 -6.42559,-4.346726 7.37052,-7.748513 3.96875,5.669645 9.26042,-1.13393 1.7009,-5.858632 8.88243,-6.992559 7.9375,3.212799 11.3393,-1.889882 6.42559,7.559524 4.72469,6.992559 6.48444,-0.975918 -7.21627,9.087162 -10.69078,-5.34539 -10.15625,5.078121 -2.40543,10.156243 5.61266,9.621702 z",LAND:10,FOREST:60,MOUNTAINS:0,CENTER:{x:-348,y:-39},NEIGHBOURS:[61,72,74,82,83],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:74,PATH:"m -343.20239,-63.21131 -2.10984,-6.883386 3.87541,-3.608139 8.95352,-2.00452 -3.34086,-5.345391 3.8754,-2.138156 5.07812,0.400905 5.21176,-3.34087 2.53908,-4.944486 5.87991,-1.469982 5.47902,-4.944486 3.11206,-1.251249 3.4018,10.583333 -11.3393,5.10268 1.51191,9.449403 9.82739,8.882441 8.50445,-2.267857 2.64583,5.102677 -0.37796,7.181548 -4.72471,5.102678 -0.66797,5.568251 -10.4235,-4.276312 -6.48444,0.975918 -4.72469,-6.992559 -6.42559,-7.559524 -11.3393,1.889882 z",LAND:10,FOREST:60,MOUNTAINS:50,CENTER:{x:-319,y:-67},NEIGHBOURS:[59,61,73,75,77,82],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:75,PATH:"m -273.08781,-119.90774 h -6.99254 l -13.04017,4.15774 -4.53573,-6.04762 -10.01635,3.59078 -2.07889,4.7247 -1.51191,6.80357 5.85865,-2.26786 3.96875,4.15774 -3.21281,6.04762 3.4018,10.583333 -11.3393,5.102678 1.51191,9.449405 9.82739,8.882441 8.50445,-2.267857 2.64583,5.102677 7.37055,0.377976 4.5357,-5.858629 0.94496,-6.425597 5.85861,-1.322917 5.66966,-4.346725 7.55951,5.102677 -2.26785,-6.614583 4.7247,-4.724702 2.26786,-7.748508 -2.45685,-4.913691 4.15774,-4.535718 -4.53571,-8.69345 -9.26041,1.32292 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-282,y:-93},NEIGHBOURS:[57,58,59,74,76,77],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:76,PATH:"m -336.96576,-143.15327 -3.21281,-2.83482 7.37055,-3.40179 v -6.04762 l 4.72469,-5.48065 -3.96875,-6.61459 -7.74851,2.45685 -3.21281,-4.53572 0.56698,-5.85863 3.02382,-6.04762 16.44195,0.37798 9.26041,8.12649 7.37055,-3.59078 7.18154,3.40179 6.80357,9.4494 9.26042,-6.2366 5.29166,4.15774 8.50448,-2.83483 6.23659,-5.48065 6.4256,7.74851 -2.64583,8.31548 -0.18899,4.34672 -6.80358,6.04762 3.40179,13.04018 -5.66964,4.7247 -4.53573,10.01637 h -6.99254 l -13.04017,4.15774 1.88987,-6.80357 -0.56695,-7.9375 -2.26788,-7.9375 -7.37052,3.2128 -9.07143,-1.32292 -7.74851,-5.66964 -6.61458,3.02381 -3.02382,-3.59078 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-300,y:-150},NEIGHBOURS:[-1,57,75,77,78],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:77,PATH:"m -335.82416,-81.052746 -7.18924,-0.301421 -11.33927,0.755954 -5.29167,-6.803572 3.77976,-9.260417 -6.42559,-6.047618 -9.44941,-1.51191 5.85864,-8.69345 12.09522,-2.26785 1.32292,-8.88245 13.22916,-8.31547 2.26788,-10.77232 9.07142,0.37797 3.02382,3.59078 6.61458,-3.02381 7.74851,5.66964 9.07143,1.32292 7.37052,-3.2128 2.26788,7.9375 0.56695,7.9375 -1.88987,6.80357 -4.53573,-6.04762 -10.01635,3.59078 -2.07889,4.7247 -1.51191,6.80357 5.85865,-2.26786 3.96875,4.15774 -3.21281,6.04762 -3.11206,1.251249 -5.47902,4.944488 -5.87991,1.46998 -2.53908,4.944486 -5.21176,3.34087 -5.07812,-0.400905 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-334,y:-112},NEIGHBOURS:[74,75,76,78,81,82],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:78,PATH:"m -343.0134,-169.61161 -4.72469,3.59078 -8.31548,-5.48066 -2.83483,-5.10268 -7.37052,-2.07886 -6.42559,5.29166 -3.77976,-5.48065 -6.23663,8.50446 3.96875,9.63839 6.99257,1.7009 2.83483,6.99256 -4.91369,4.34672 -3.4018,10.01637 -7.18153,3.40179 2.64583,3.96875 6.2366,6.04762 7.9375,-5.85863 5.66965,2.07886 6.80355,-0.56696 2.64584,4.53571 13.22916,-8.31547 2.26788,-10.77232 -3.21281,-2.83482 7.37055,-3.40179 v -6.04762 l 4.72469,-5.48065 -3.96875,-6.61459 -7.74851,2.45685 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-357,y:-147},NEIGHBOURS:[-1,76,77,79,81],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:79,PATH:"m -395.17409,-137.48363 -8.50448,-4.34673 -3.40177,-6.04762 2.83482,-8.88244 -6.42562,-4.7247 0.18899,-9.63839 5.29167,-5.48066 -3.77976,-6.04761 7.18156,-2.64584 5.48066,2.45685 7.37052,-2.64584 6.04761,6.23661 4.72472,-6.04762 7.9375,-3.2128 7.18153,4.34673 4.15774,7.55952 -7.37052,-2.07886 -6.42559,5.29166 -3.77976,-5.48065 -6.23663,8.50446 3.96875,9.63839 6.99257,1.7009 2.83483,6.99256 -4.91369,4.34672 -3.4018,10.01637 -5.29166,-2.83482 -6.04761,-1.32292 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-394,y:-160},NEIGHBOURS:[-1,78,80,81],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:80,PATH:"m -408.97024,-182.65178 -6.42559,-3.77976 0.18899,-4.9137 -3.59076,-7.37053 -10.20538,2.45684 -2.45684,6.04762 -0.75594,9.07143 -9.44941,2.83482 -6.2366,7.18155 -1.7009,6.04762 3.96875,4.91369 -2.64583,8.31547 10.39434,2.26786 -2.64583,5.48066 7.37052,2.07887 5.48066,4.53571 6.99257,-0.18899 4.15774,5.85863 8.69344,-2.26785 8.12649,1.88988 4.53573,-5.29167 -8.50448,-4.34673 -3.40177,-6.04762 2.83482,-8.88244 -6.42562,-4.7247 0.18899,-9.63839 5.29167,-5.48066 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-427,y:-161},NEIGHBOURS:[-1,79,81,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:81,PATH:"m -393.66219,-108.00149 -7.18155,-0.37797 -3.21281,-3.59078 -9.26042,-4.53571 0.94496,-5.66964 -1.88989,-4.72471 6.42559,-7.18154 8.12649,1.88988 4.53573,-5.29167 6.61458,-4.34673 6.04761,1.32292 5.29166,2.83482 -7.18153,3.40179 2.64583,3.96875 6.2366,6.04762 7.9375,-5.85863 5.66965,2.07886 6.80355,-0.56696 2.64584,4.53571 -1.32292,8.88245 -12.09522,2.26785 -9.26041,-4.34672 -3.02382,4.91369 -6.04763,3.96875 z",LAND:10,FOREST:60,MOUNTAINS:40,CENTER:{x:-395,y:-121},NEIGHBOURS:[77,78,79,80,82,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:82,PATH:"m -405.37947,-74.550592 -3.02379,-2.338731 5.33359,-4.84282 -1.64554,-6.324385 -5.19996,-0.290198 3.314,-5.734492 6.70236,-0.880091 1.7009,-6.803571 4.53572,-6.23661 9.44939,-0.37797 6.04763,-3.96875 3.02382,-4.91369 9.26041,4.34672 -5.85864,8.69345 9.44941,1.51191 6.42559,6.047618 -3.77976,9.260417 5.29167,6.803572 11.33927,-0.755954 7.18924,0.301421 3.34086,5.345393 -8.95352,2.004518 -3.87541,3.608139 2.10984,6.883386 -8.88243,6.992559 -1.7009,5.858632 -9.26042,1.13393 1.32292,-7.9375 -6.99254,-6.236607 -2.64583,-7.748514 -3.96875,-5.102677 -6.4256,4.535712 -8.69346,-4.346723 -8.29649,2.953056 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-378,y:-89},NEIGHBOURS:[74,77,81,83,103,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:83,PATH:"m -393.47322,-45.635417 0.18899,-4.913689 -9.63837,-1.322916 -8.50448,-5.291667 0.37799,-6.803572 5.66962,-10.583333 6.63358,1.441152 8.29649,-2.953058 8.69346,4.346725 6.4256,-4.535712 3.96875,5.102677 2.64583,7.748514 6.99254,6.236607 -1.32292,7.9375 -3.96875,-5.669645 -7.37052,7.748513 6.42559,4.346726 -6.2366,1.322917 -11.15031,-9.638393 -2.64583,4.346726 z",LAND:10,FOREST:60,MOUNTAINS:0,CENTER:{x:-388,y:-61},NEIGHBOURS:[72,73,82,84,103],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:84,PATH:"m -411.42708,-57.163689 -4.91368,5.480653 1.32292,4.913691 -4.72472,6.425594 -8.50445,2.078871 -4.72472,6.614583 h -7.9375 l -8.12649,3.779761 -0.37796,-6.047618 -4.34673,-2.267858 -6.2366,10.205357 -0.75597,6.614583 3.4018,6.52009 7.74851,-2.078869 5.00819,-5.197173 7.55952,2.834821 8.59896,-1.984375 3.59076,5.953125 7.55952,8.3154764 4.15774,-3.5907736 6.23663,6.8035713 7.74851,1.88988097 3.40177,-4.34672617 -2.45684,-6.8035709 4.34673,-4.724703 -3.21281,-6.425595 -7.37052,-2.456845 5.29167,-4.157739 -0.189,-4.157736 4.15775,-2.834823 0.75594,-6.80357 -5.85862,-3.401787 3.77976,-1.511903 3.02379,1.889879 0.18899,-4.913689 -9.63837,-1.322916 z",LAND:20,FOREST:40,MOUNTAINS:0,CENTER:{x:-418,y:-28},NEIGHBOURS:[71,72,83,85,102,103],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:85,PATH:"m -480.40774,26.180059 -5.85861,-0.377977 -0.18899,-7.559523 5.57514,-3.212798 1.51191,-7.0870533 3.21278,-6.1421129 9.54392,0.188988 -1.51191,-7.9374999 6.04761,-1.8898809 4.72471,-5.008184 7.74851,-2.078869 5.00819,-5.197173 7.55952,2.834821 8.59896,-1.984375 3.59076,5.953125 7.55952,8.3154764 -5.48063,5.85863105 -10.20538,-4.72470225 -3.21278,-6.4255952 -5.85864,2.6458331 0.37798,6.0476191 6.2366,4.1577381 0.94493,7.3705354 -5.29166,5.1026783 -0.37796,5.858631 -2.45684,6.614585 6.42622,4.900192 -0.26725,8.285352 -5.97001,-5.815009 -7.55951,-2.078869 -9.26042,-2.834822 -8.69344,-0.755952 -9.07143,2.456844 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-457,y:11},NEIGHBOURS:[70,71,84,87,98,99,102],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:86,PATH:"",LAND:0,FOREST:0,MOUNTAINS:0,CENTER:{x:0,y:0},NEIGHBOURS:[],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:87,PATH:"m -450.34914,100.02236 -1.60364,-7.750818 6.41448,-4.810855 -6.41448,-5.612657 7.2163,-7.483549 10.69078,-2.405425 -4.27633,-4.276312 5.07812,-9.621702 -11.22531,3.474503 -0.53454,-13.096206 8.55263,-7.750818 -5.97001,-5.815009 -7.55951,-2.078869 -1.32292,5.102678 1.7009,4.724701 -5.85864,5.480656 -7.9375,-7.9375 -7.37053,2.078869 -3.2128,4.157739 2.64583,4.346725 9.44941,4.157737 0.94493,8.315478 -6.42559,4.535713 -0.18899,5.669642 -1.90236,2.808288 -4.27633,1.870887 -1.46997,3.34087 -3.47451,2.138156 1.33636,8.018084 -3.87543,0.400902 0.13364,6.280838 7.48356,2.138154 3.34086,6.68174 -3.74176,1.87089 -1.47,2.93996 7.08266,-0.13363 2.80633,3.74177 5.74627,-0.93544 5.3454,-0.13364 -2.53907,2.93996 1.47,3.60814 6.94902,-3.60814 6.68173,-0.13363 4.40994,-4.40995 2.13815,-8.55262 6.41448,-6.949009 -11.22532,-2.672694 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-459,y:82},NEIGHBOURS:[69,70,85,88,95,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:88,PATH:"m -437.52021,112.85129 -4.40994,4.40995 -6.68173,0.13363 -6.94902,3.60814 -1.47,-3.60814 2.53907,-2.93996 -5.3454,0.13364 -2.80633,3.74177 -7.34991,3.0736 2.13818,3.0736 -7.34992,4.00904 -7.08265,-3.34087 -2.40541,5.34539 -1.47,8.68626 2.40543,4.14268 2.80633,2.13816 -1.46997,7.75081 6.68173,-7.21627 6.68174,0.53453 5.34538,-9.35443 6.94901,1.87089 9.08717,-0.26727 12.05889,3.44231 -2.45684,-6.99256 6.2366,-6.99256 8.50447,0.37797 -0.18899,-9.07142 -4.72469,-4.91369 -2.53905,5.27857 z",LAND:30,FOREST:30,MOUNTAINS:0,CENTER:{x:-456,y:130},NEIGHBOURS:[68,69,87,89,95],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:89,PATH:"m -466.11804,206.6629 -12.02714,-5.61266 2.40543,-5.87993 -9.6217,-5.34539 -1.8709,-13.89802 3.20723,-9.6217 -7.75081,-6.41447 1.8709,-8.01809 7.48355,1.33635 6.68173,-7.21627 6.68174,0.53453 5.34538,-9.35443 6.94901,1.87089 9.08717,-0.26727 12.05889,3.44231 -3.40178,8.88244 -8.12649,6.99256 -16.06399,4.15774 3.77976,10.39434 11.52829,7.55952 -5.48066,5.48066 4.36962,7.07887 -0.53453,8.28536 -9.08717,4.81085 -1.60362,-4.00904 2.13816,-6.68174 -3.47449,-2.6727 -4.54358,8.55263 z",LAND:10,FOREST:30,MOUNTAINS:40,CENTER:{x:-474,y:170},NEIGHBOURS:[67,68,91,94,95],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:90,PATH:"m -463.97989,256.37503 -7.75081,4.81085 -12.64187,1.22944 -1.7907,-9.24753 -2.6326,-1.87088 -4.75739,0.66817 -3.47451,2.28516 -1.80407,4.07586 -5.5993,4.34313 -10.98477,-4.58367 -0.14701,-8.65954 -3.47448,-9.08716 3.74176,-8.8199 9.35442,-8.01808 9.08717,-3.20724 10.69078,8.01809 h 9.35445 l 11.49257,4.81085 -4.54358,9.08716 z",LAND:20,FOREST:60,MOUNTAINS:20,CENTER:{x:-493,y:237},NEIGHBOURS:[-1,66,67,91],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:91,PATH:"m -519.0374,240.33886 -8.80634,4.50042 -11.71726,-0.18899 -2.07889,-15.30803 2.45687,-8.88244 7.9375,-3.96875 7.9375,-0.94494 5.48063,-6.61459 5.10271,-4.53571 8.69344,0.75595 10.01635,2.83482 9.6384,-2.83482 1.32292,-4.34672 7.31382,-5.63475 -2.40543,5.87993 12.02714,5.61266 -9.35445,4.00904 2.93997,9.35443 -4.2763,8.28536 h -9.35445 l -10.69078,-8.01809 -9.08717,3.20724 -9.35442,8.01808 z",LAND:10,FOREST:50,MOUNTAINS:10,CENTER:{x:-509,y:216},NEIGHBOURS:[-1,67,89,90,92,94],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:92,PATH:"m -539.18302,220.45982 1.43674,-6.84792 -1.06907,-8.28535 -6.68174,1.33635 -10.42352,0.53454 -7.21627,-6.94901 -1.33636,-8.01809 9.6217,-4.27631 8.28535,-7.48355 9.35445,3.20724 8.81989,-5.07812 5.87994,-9.88898 7.75081,3.47451 5.34537,9.6217 2.67272,10.15624 6.41445,7.48355 6.31367,8.53998 -10.01635,-2.83482 -8.69344,-0.75595 -5.10271,4.53571 -5.48063,6.61459 -7.9375,0.94494 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-529,y:196},NEIGHBOURS:[-1,91,93,94],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:93,PATH:"m -517.96833,134.23285 -3.20725,-6.949 -12.02711,-4.00904 -7.75084,3.74177 -3.74176,-7.48355 -8.81989,-2.13816 -5.61266,11.49259 8.01809,8.28536 -0.80182,8.28536 -7.21627,-4.00905 -5.07812,-6.68173 -8.81991,-2.40543 -2.93995,3.74177 2.40541,9.88898 -4.2763,13.0962 5.34538,8.28536 -5.07813,11.49259 -10.15621,3.74177 4.2763,5.34539 6.1472,9.88897 6.68173,-4.27631 7.48356,6.68174 -1.33636,-8.01809 9.6217,-4.27631 8.28535,-7.48355 9.35445,3.20724 8.81989,-5.07812 5.87994,-9.88898 -0.80182,-7.75081 -4.2763,-8.01809 6.14719,-6.949 z",LAND:20,FOREST:60,MOUNTAINS:20,CENTER:{x:-550,y:161},NEIGHBOURS:[-1,92,94,95,96],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:94,PATH:"m -522.51191,168.71062 -0.80182,-7.75081 -4.2763,-8.01809 6.14719,-6.949 3.47451,-11.75987 7.75081,-1.33634 2.13815,8.55262 6.41448,5.07812 1.60361,10.15625 10.15625,-4.81086 -1.8709,8.01809 7.75081,6.41447 -3.20723,9.6217 1.8709,13.89802 9.6217,5.34539 -7.31382,5.63475 -1.32292,4.34672 -9.6384,2.83482 -6.31367,-8.53998 -6.41445,-7.48355 -2.67272,-10.15624 -5.34537,-9.6217 z",LAND:10,FOREST:20,MOUNTAINS:40,CENTER:{x:-504,y:168},NEIGHBOURS:[89,91,92,93,95],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:95,PATH:"m -521.17558,127.28385 3.34819,-4.90885 10.20538,-0.56697 2.83483,-7.9375 -1.70091,-6.2366 6.4256,0.37797 0.56697,2.83483 6.2366,-2.64584 1.32292,-5.85863 8.31548,0.37798 1.88987,7.18154 7.72816,-0.92589 -1.47,2.93996 7.08266,-0.13363 2.80633,3.74177 5.74627,-0.93544 -2.80633,3.74177 -7.34991,3.0736 2.13818,3.0736 -7.34992,4.00904 -7.08265,-3.34087 -2.40541,5.34539 -1.47,8.68626 2.40543,4.14268 2.80633,2.13816 -1.46997,7.75081 -7.48355,-1.33635 -10.15625,4.81086 -1.60361,-10.15625 -6.41448,-5.07812 -2.13815,-8.55262 -7.75081,1.33634 z",LAND:30,FOREST:40,MOUNTAINS:0,CENTER:{x:-495,y:127},NEIGHBOURS:[87,88,89,93,94,96,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:96,PATH:"m -544.69529,119.53303 3.43339,-6.04047 -5.29167,-6.61458 -2.07886,-9.638399 -6.61458,-3.779761 3.59077,-3.401785 4.15774,2.645833 7.55951,-1.322916 h 8.31549 l 6.2366,-4.535715 7.9375,5.291666 3.59076,-3.590774 1.7009,-3.96875 6.99257,3.023809 8.12649,-0.566962 -0.75596,7.181546 5.10267,2.834822 0.75597,5.291666 -1.32292,5.85863 -6.2366,2.64584 -0.56697,-2.83483 -6.4256,-0.37797 1.70091,6.2366 -2.83483,7.9375 -10.20538,0.56697 -3.34819,4.90885 -12.02711,-4.00904 -7.75084,3.74177 z",LAND:20,FOREST:30,MOUNTAINS:10,CENTER:{x:-523,y:107},NEIGHBOURS:[-1,93,95,97,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:97,PATH:"m -539.93899,91.380952 -2.26784,-5.669643 -4.26125,-5.654448 1.71228,-5.871928 -2.26978,-6.225209 -0.18896,-10.919524 8.65927,-2.642033 5.31982,5.061077 3.69081,-2.096149 0.93544,-3.320824 -0.36278,-5.33464 4.5566,-4.339129 7.15497,5.813044 0.37798,8.504465 8.69344,2.83482 7.18156,10.583331 -8.12649,5.480658 -3.02382,6.992557 -1.7009,3.96875 -3.59076,3.590774 -7.9375,-5.291664 -6.2366,4.535715 z",LAND:20,FOREST:20,MOUNTAINS:20,CENTER:{x:-523,y:74},NEIGHBOURS:[-1,96,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:98,PATH:"m -512.15774,84.577377 3.02382,-6.992557 8.12649,-5.480656 -7.18156,-10.583333 -8.69344,-2.83482 -0.37798,-8.504465 7.18156,-9.827381 -0.94496,-8.126487 10.39434,-2.078868 12.09524,5.102677 8.12649,-9.071428 3.4018,5.480654 9.07143,-2.456844 8.69344,0.755952 9.26042,2.834822 -1.32292,5.102678 1.7009,4.724701 -5.85864,5.480656 -7.9375,-7.9375 -7.37053,2.078869 -3.2128,4.157739 2.64583,4.346725 9.44941,4.157737 0.94493,8.315478 -6.42559,4.535713 -0.18899,5.669642 -1.90236,2.808288 -4.27633,1.870887 -1.46997,3.34087 -3.47451,2.138156 1.33636,8.018084 -3.87543,0.400902 0.13364,6.280838 7.48356,2.138154 3.34086,6.68174 -3.74176,1.87089 -7.72816,0.92589 -1.88987,-7.18154 -8.31548,-0.37798 -0.75597,-5.291668 -5.10267,-2.83482 0.75596,-7.181546 -8.12649,0.56696 z",LAND:30,FOREST:60,MOUNTAINS:30,CENTER:{x:-488,y:62},NEIGHBOURS:[-1,85,87,95,96,97,99],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:99,PATH:"m -500.62947,30.14881 -3.02379,-4.724703 -9.07142,0.377976 -10.01639,-1.700893 -5.48066,-5.480655 -0.18899,-8.315476 3.59079,-5.6696427 -7.18156,-2.6458333 -6.80357,1.7008928 -0.94493,-6.0476189 7.37052,-4.7247022 3.21281,-8.3154767 7.9375,3.401786 7.37052,-3.023809 12.47323,0.94494 3.40177,6.4255951 13.79615,-4.9136901 3.59076,7.3705355 4.44122,6.9925593 -3.21278,6.1421129 -1.51191,7.0870533 -5.57514,3.212798 0.18899,7.559523 5.85861,0.377977 -8.12649,9.071428 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-507,y:8},NEIGHBOURS:[-1,85,98,100,102],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:100,PATH:"m -497.03868,-59.431546 -8.31548,0.944941 -6.04761,4.724701 -5.1027,-4.157739 -0.94493,-4.913691 -7.37053,1.13393 -7.55954,5.102678 -5.48063,-3.96875 -4.91371,1.700892 v 3.779763 l 4.34673,2.456845 2.26785,5.858631 4.15774,3.401785 5.66966,-0.377976 3.40177,2.645834 -0.18899,2.078868 -3.40178,0.188989 -6.42559,-0.944941 -7.55951,2.456847 -8.1265,-0.377979 -3.77975,6.047621 3.40177,4.535713 5.48066,2.267858 4.5357,1.889881 -0.18897,6.992559 3.96875,3.96875 6.04761,-3.401786 7.9375,3.401786 7.37052,-3.023809 12.47323,0.94494 3.77976,-3.023809 -6.04761,-6.425596 -1.32292,-8.504462 6.04761,-4.346729 1.13393,-7.9375 -2.26785,-6.047618 z",LAND:20,FOREST:50,MOUNTAINS:0,CENTER:{x:-517,y:-32},NEIGHBOURS:[-1,99,101,102],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:101,PATH:"m -478.13989,-71.526785 -4.91368,-2.078869 -2.26785,-4.157739 -5.48066,-3.401785 -8.50447,1.700893 -3.96875,-5.480656 -6.04761,1.700895 -5.66965,-1.700895 -1.88987,-5.102677 -5.10267,-1.511906 -12.09524,3.590774 0.37795,4.535715 5.10271,2.456844 1.70087,5.858631 -3.40177,3.212799 2.45684,4.913691 3.02381,5.291666 7.37053,-1.13393 0.94493,4.913691 5.1027,4.157739 6.04761,-4.724701 8.31548,-0.944941 5.85862,-5.858632 7.37055,-1.133927 z",LAND:20,FOREST:20,MOUNTAINS:0,CENTER:{x:-509,y:-69},NEIGHBOURS:[-1,100,102,104],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:102,PATH:"m -457.35118,-12.845982 -3.4018,-6.52009 0.75597,-6.614583 6.2366,-10.205357 -1.51191,-6.614583 4.91368,-3.212798 0.189,-7.559524 -3.40178,-4.157737 -2.26785,-8.504465 6.2366,-4.157736 -0.18899,-3.968753 -6.04761,0.188989 -5.48066,3.212799 -5.66965,1.133927 -3.40177,-5.669642 -6.23663,0.377975 -1.51191,3.590775 -5.66962,5.10268 -7.37055,1.133927 -5.85862,5.858632 -3.02381,9.071427 2.26785,6.047618 -1.13393,7.9375 -6.04761,4.346729 1.32292,8.504462 6.04761,6.425596 -3.77976,3.023809 3.40177,6.4255951 13.79615,-4.9136901 3.59076,7.3705355 4.44122,6.9925593 9.54392,0.188988 -1.51191,-7.9374999 6.04761,-1.8898809 z",LAND:50,FOREST:60,MOUNTAINS:0,CENTER:{x:-480,y:-37},NEIGHBOURS:[84,85,99,100,101,103,104],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:103,PATH:"m -409.91517,-88.346726 -6.04763,-1.700892 -5.29167,4.346725 -1.32292,5.480656 -5.66962,2.078868 -6.80358,3.401785 -0.56697,5.669645 -3.96875,8.126487 -6.61458,1.322916 -3.21279,-4.157736 -6.42559,-2.456847 2.26785,8.504465 3.40178,4.157737 -0.189,7.559524 -4.91368,3.212798 1.51191,6.614583 4.34673,2.267858 0.37796,6.047618 8.12649,-3.779761 h 7.9375 l 4.72472,-6.614583 8.50445,-2.078871 4.72472,-6.425594 -1.32292,-4.913691 4.91368,-5.480653 0.37799,-6.803572 5.66962,-10.583331 -3.02379,-2.338731 5.3336,-4.84282 -1.64555,-6.324383 z",LAND:10,FOREST:30,MOUNTAINS:0,CENTER:{x:-429,y:-54},NEIGHBOURS:[82,83,84,102,104,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:104,PATH:"m -485.32142,-77.763393 2.07886,-5.480653 6.04763,-1.889882 6.42559,-3.023809 2.07886,-3.779763 4.91371,-4.157737 5.85862,-0.188989 5.66965,-0.755952 6.61458,4.157737 5.29167,3.590774 5.48066,-3.401785 7.18153,1.700893 -0.75594,-5.102678 -2.64584,-3.023809 3.96875,-0.944944 4.5357,2.645837 0.56698,3.77976 6.99257,-0.377975 -0.94496,3.968752 -5.29167,4.346723 -1.32292,5.480656 -5.66962,2.078868 -6.80358,3.401785 -0.56697,5.669645 -3.96875,8.126487 -6.61458,1.322916 -3.21279,-4.157736 -6.42559,-2.456847 6.2366,-4.157736 -0.18899,-3.968753 -6.04761,0.188989 -5.48066,3.212799 -5.66965,1.133927 -3.40177,-5.669642 -6.23663,0.377975 -1.51191,3.590775 -4.91368,-2.078869 z",LAND:20,FOREST:30,MOUNTAINS:30,CENTER:{x:-449,y:-82},NEIGHBOURS:[-1,101,102,103,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:105,PATH:"m -452.2485,-97.040178 2.26785,-6.236602 -2.64584,-6.04762 6.04764,-4.34673 0.37796,-4.7247 -4.91369,-7.55953 3.21281,-6.04762 -2.45687,-5.29166 0.94496,-6.23661 8.88244,-0.56696 7.37052,2.07887 5.48066,4.53571 6.99257,-0.18899 4.15774,5.85863 8.69344,-2.26785 -6.42559,7.18154 1.88989,4.72471 -0.94496,5.66964 9.26042,4.53571 3.21281,3.59078 7.18155,0.37797 -4.53572,6.23661 -1.7009,6.803573 -6.70235,0.880089 -3.31401,5.734492 -6.04763,-1.70089 0.94496,-3.96875 -6.99257,0.377973 -0.56698,-3.779758 -4.5357,-2.645839 -3.96875,0.944944 2.64584,3.023809 0.75594,5.10268 -7.18153,-1.700895 -5.48066,3.401785 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-429,y:-115},NEIGHBOURS:[-1,80,81,82,103,104],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:106,PATH:"m -46.680059,119.91815 -5.669642,-7.37053 4.157737,-8.50447 9.449405,-5.858628 -1.889881,-10.77232 2.267857,-12.662204 7.181548,-7.748511 13.418154,-7.181548 0.377976,-9.449403 6.425596,-6.236608 6.8035709,-3.212798 -0.7559524,-7.9375 5.66964288,-3.401785 6.05942052,5.093113 0.6681737,14.03165 3.3408694,3.608139 2.004521,2.939965 -3.7417733,6.414468 -1.0690783,7.349911 -10.9580502,0.935445 -10.2898762,5.746295 -0.133635,15.234359 4.2763123,4.276315 -9.0871633,4.810855 -7.90603,9.12347 -10.016368,1.7009 -0.755952,7.37053 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-20,y:75},NEIGHBOURS:[6,7,18,22,23,24,25],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:107,PATH:"m -231.98995,36.679481 8.55263,9.621702 1.06908,19.243405 17.35916,-9.795428 17.53764,3.566015 15.30329,-12.724403 3.77976,-9.071427 6.61458,-8.693452 -2.07887,-9.071429 -16.28698,1.423383 -20.31248,-8.552624 -22.98518,8.552624 z",LAND:20,FOREST:50,MOUNTAINS:0,CENTER:{x:-200,y:36},NEIGHBOURS:[29,37,38,46,47,48],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:108,PATH:"m 175.94791,-35.43006 4.49792,-4.781399 9.12813,-5.423958 -3.3073,-6.746875 -6.35,-0.132292 -6.61458,-3.307292 -1.45521,-5.688541 5.95313,-5.291667 -0.66146,-4.630208 -5.15938,-6.35 -1.5875,4.7625 0.66146,3.96875 -3.57187,4.233333 -6.21771,-0.132292 -9.12813,-3.968749 0.66146,-7.672917 -4.63021,-5.688542 -11.64166,-4.365625 -4.49792,2.778125 -10.31875,3.836459 -5.29166,-1.719792 -6.61459,3.2317 -1.88988,11.906247 13.47485,20.883184 17.78378,12.586608 -1.96547,11.320386 14.93005,-5.102678 3.2128,5.291667 15.30804,-5.858632 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:150,y:-48},NEIGHBOURS:[-1,16,17,20],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:109,PATH:"m -155.34821,133.33631 -3.02381,14.74107 5.09295,10.0761 11.22532,-0.53454 2.93996,5.21176 7.76707,-1.90213 10.01636,-8.12649 16.63096,-3.40178 -1.13393,-8.12649 4.34672,1.13393 2.834826,4.53571 3.96875,2.83482 3.590774,-6.61458 -0.755954,-7.9375 -10.016366,-6.80357 -2.26786,-8.50447 -9.54722,7.96695 -7.27652,2.27925 -4.4037,-4.96972 -0.28353,-14.18749 -10.61059,6.01356 -1.6838,7.64391 -6.21548,5.63935 z",LAND:20,FOREST:30,MOUNTAINS:0,CENTER:{x:-129,y:140},NEIGHBOURS:[24,26,27,28,39],WEALTH:0,HARBOUR:!1,TROOPS:[]}],COUNTRIES:[{COUNTRY:zf.PLAYER,NAME:"Player nation",DIPLOMACY:0,POTENTIAL:0,COLOUR:"darkgreen",FOCUS:Vf.NONE,REGIONS:[0],CAPITAL:0},{COUNTRY:zf.NEUTRAL,NAME:"none",DIPLOMACY:0,COLOUR:"gray",FOCUS:Vf.NONE,REGIONS:[1,2,3,4,5,7,13,14,15,16,17,18,22,27,30,31,37,38,39,40,41,42,43,44,45,47,48,49,50,51,53,54,55,56,58,59,63,64,69,73,74,82,83,87,88,93,95,96,97,98,99,100,101,102,103,104,107,108],CAPITAL:-1},{COUNTRY:zf.CLEADAL,NAME:"Cleadal",DIPLOMACY:0,COLOUR:"darkred",FOCUS:Vf.ECONOMY,REGIONS:[6,23,24,25,26,28,29,106,109],CAPITAL:24},{COUNTRY:zf.GRIERIA,NAME:"Grieria",DIPLOMACY:0,COLOUR:"#bcaa4f",FOCUS:Vf.PEACE,REGIONS:[8,9,10,11,12],CAPITAL:10},{COUNTRY:zf.BOTHIL,NAME:"Bothil",DIPLOMACY:0,COLOUR:"#286fbc",FOCUS:Vf.DEFENSE,REGIONS:[19,20,21,32,33,34,35,36,52],CAPITAL:34},{COUNTRY:zf.DOSHOR,NAME:"Doshor",DIPLOMACY:0,COLOUR:"#a163bc",FOCUS:Vf.OFFENSE,REGIONS:[57,75,76,77,78,79,80,81,105],CAPITAL:80},{COUNTRY:zf.CREURUS,NAME:"Creurus",DIPLOMACY:0,COLOUR:"#bc6935",FOCUS:Vf.OFFENSE,REGIONS:[65,66,67,68,89,90,91,92,94],CAPITAL:90},{COUNTRY:zf.ESTRAILA,NAME:"Estraila",DIPLOMACY:0,COLOUR:"#49a37e",FOCUS:Vf.ECONOMY,REGIONS:[46,60,61,62,70,71,72,84,85],CAPITAL:71}],SEA_AREAS:[{ID:-1,CENTER:{x:226,y:203},R:15,NEIGHBOURS:[-2,-46,-55,0,9]},{ID:-2,CENTER:{x:273,y:172},R:15,NEIGHBOURS:[-1,-3,-55,-57,-58]},{ID:-3,CENTER:{x:275,y:110},R:15,NEIGHBOURS:[-2,-4,-58,13]},{ID:-4,CENTER:{x:286,y:66},R:15,NEIGHBOURS:[-3,-5,-58,-59,14,13]},{ID:-5,CENTER:{x:280,y:9},R:15,NEIGHBOURS:[-4,-6,-59,14]},{ID:-6,CENTER:{x:256,y:-49},R:15,NEIGHBOURS:[-5,-7,-59,-60,16]},{ID:-7,CENTER:{x:210,y:-89},R:15,NEIGHBOURS:[-6,-8,-60,16]},{ID:-8,CENTER:{x:149,y:-118},R:15,NEIGHBOURS:[-7,-9,-60,-61,20,108]},{ID:-9,CENTER:{x:94,y:-137},R:15,NEIGHBOURS:[-8,-10,-61,20]},{ID:-10,CENTER:{x:33,y:-161},R:15,NEIGHBOURS:[-9,-11,-61,-62,33]},{ID:-11,CENTER:{x:-17,y:-182},R:15,NEIGHBOURS:[-10,-12,-62,35,34]},{ID:-12,CENTER:{x:-76,y:-176},R:15,NEIGHBOURS:[-11,-13,-62,-63,54,53,35,34]},{ID:-13,CENTER:{x:-131,y:-187},R:15,NEIGHBOURS:[-12,-14,-63,56,54]},{ID:-14,CENTER:{x:-185,y:-189},R:15,NEIGHBOURS:[-13,-15,-63,56,54]},{ID:-15,CENTER:{x:-224,y:-170},R:15,NEIGHBOURS:[-14,-16,57,56,54]},{ID:-16,CENTER:{x:-262,y:-190},R:15,NEIGHBOURS:[-15,-17,-64,76]},{ID:-17,CENTER:{x:-318,y:-196},R:15,NEIGHBOURS:[-16,-18,-64,78,76]},{ID:-18,CENTER:{x:-367,y:-209},R:15,NEIGHBOURS:[-17,-19,-64,79,78]},{ID:-19,CENTER:{x:-417,y:-214},R:15,NEIGHBOURS:[-18,-20,-65,80,79]},{ID:-20,CENTER:{x:-460,y:-202},R:15,NEIGHBOURS:[-19,-21,-65,-66,80]},{ID:-21,CENTER:{x:-469,y:-161},R:15,NEIGHBOURS:[-20,-22,-66,80]},{ID:-22,CENTER:{x:-471,y:-121},R:15,NEIGHBOURS:[-21,-23,104,105,80]},{ID:-23,CENTER:{x:-507,y:-105},R:15,NEIGHBOURS:[-22,-24,-66,104]},{ID:-24,CENTER:{x:-544,y:-102},R:15,NEIGHBOURS:[-23,-25,-66,-67]},{ID:-25,CENTER:{x:-563,y:-63},R:15,NEIGHBOURS:[-24,-26,-67,101]},{ID:-26,CENTER:{x:-570,y:-15},R:15,NEIGHBOURS:[-25,-27,-67,100]},{ID:-27,CENTER:{x:-553,y:20},R:15,NEIGHBOURS:[-26,-28,97,98,99]},{ID:-28,CENTER:{x:-563,y:60},R:15,NEIGHBOURS:[-27,-29,-68,97,98]},{ID:-29,CENTER:{x:-582,y:105},R:15,NEIGHBOURS:[-28,-30,-68,96]},{ID:-30,CENTER:{x:-597,y:154},R:15,NEIGHBOURS:[-29,-31,-69,93,96]},{ID:-31,CENTER:{x:-599,y:204},R:15,NEIGHBOURS:[-30,-32,-69,91]},{ID:-32,CENTER:{x:-570,y:242},R:15,NEIGHBOURS:[-31,-33,-70,91,92]},{ID:-33,CENTER:{x:-527,y:280},R:15,NEIGHBOURS:[-32,-34,-70,66,90,91]},{ID:-34,CENTER:{x:-476,y:294},R:15,NEIGHBOURS:[-33,-35,-71,66,90]},{ID:-35,CENTER:{x:-424,y:296},R:15,NEIGHBOURS:[-34,-36,-71,-72]},{ID:-36,CENTER:{x:-395,y:259},R:15,NEIGHBOURS:[-35,-37,42,65]},{ID:-37,CENTER:{x:-338,y:259},R:15,NEIGHBOURS:[-36,-38,-72,41,42]},{ID:-38,CENTER:{x:-279,y:261},R:15,NEIGHBOURS:[-37,-39,-72,40,41]},{ID:-39,CENTER:{x:-234,y:265},R:15,NEIGHBOURS:[-38,-40,-73]},{ID:-40,CENTER:{x:-174,y:250},R:15,NEIGHBOURS:[-39,-41,-73,27]},{ID:-41,CENTER:{x:-126,y:232},R:15,NEIGHBOURS:[-40,-42,26]},{ID:-42,CENTER:{x:-67,y:224},R:15,NEIGHBOURS:[-41,-43,-74,25,26]},{ID:-43,CENTER:{x:-10,y:223},R:15,NEIGHBOURS:[-42,-44,-74]},{ID:-44,CENTER:{x:48,y:233},R:15,NEIGHBOURS:[-43,-45,-47,2,5]},{ID:-45,CENTER:{x:103,y:229},R:15,NEIGHBOURS:[-44,-46,-47,2,5]},{ID:-46,CENTER:{x:167,y:215},R:15,NEIGHBOURS:[-45,-1]},{ID:-47,CENTER:{x:75,y:280},R:15,NEIGHBOURS:[-44,-45,-48,-74,8]},{ID:-48,CENTER:{x:76,y:338},R:15,NEIGHBOURS:[-47,-49,-74,-75]},{ID:-49,CENTER:{x:124,y:381},R:15,NEIGHBOURS:[-48,-50,-75,10]},{ID:-50,CENTER:{x:192,y:367},R:15,NEIGHBOURS:[-49,-51,-56,-76,11]},{ID:-51,CENTER:{x:250,y:381},R:15,NEIGHBOURS:[-50,-52,-56,-76]},{ID:-52,CENTER:{x:316,y:384},R:15,NEIGHBOURS:[-51,-53,-77]},{ID:-53,CENTER:{x:330,y:331},R:15,NEIGHBOURS:[-52,-54,-78]},{ID:-54,CENTER:{x:287,y:293},R:15,NEIGHBOURS:[-53,-55,-56,-57,12]},{ID:-55,CENTER:{x:243,y:253},R:15,NEIGHBOURS:[-54,-1,-2,-56,-57,9]},{ID:-56,CENTER:{x:237,y:334},R:15,NEIGHBOURS:[-50,-54,-55,-51,11]},{ID:-57,CENTER:{x:350,y:229},R:58,NEIGHBOURS:[-78,-58,-79,-54,-55,-2]},{ID:-58,CENTER:{x:366,y:97},R:58,NEIGHBOURS:[-57,-58,-59,-79,-80,-2,-3,-4]},{ID:-59,CENTER:{x:361,y:-30},R:58,NEIGHBOURS:[-58,-60,-80,-4,-5,-6]},{ID:-60,CENTER:{x:271,y:-144},R:58,NEIGHBOURS:[-59,-61,-81,-6,-7,-8]},{ID:-61,CENTER:{x:147,y:-212},R:58,NEIGHBOURS:[-60,-62,-81,-82,-8,-9,-10]},{ID:-62,CENTER:{x:4,y:-256},R:58,NEIGHBOURS:[-61,-63,-82,-83,-10,-11,-12]},{ID:-63,CENTER:{x:-146,y:-265},R:58,NEIGHBOURS:[-62,-64,-83,-12,-13,-14]},{ID:-64,CENTER:{x:-289,y:-271},R:58,NEIGHBOURS:[-63,-65,-83,-84,-16,-17,-18]},{ID:-65,CENTER:{x:-433,y:-291},R:58,NEIGHBOURS:[-64,-66,-84,-85,-19,-20]},{ID:-66,CENTER:{x:-556,y:-189},R:58,NEIGHBOURS:[-65,-67,-85,-86,-20,-21,-23,-24]},{ID:-67,CENTER:{x:-648,y:-80},R:58,NEIGHBOURS:[-66,-68,-86,-87,-24,-25,-26]},{ID:-68,CENTER:{x:-663,y:58},R:58,NEIGHBOURS:[-67,-69,-87,-28,-29]},{ID:-69,CENTER:{x:-688,y:195},R:58,NEIGHBOURS:[-68,-70,-87,-88,-30,-31]},{ID:-70,CENTER:{x:-609,y:320},R:58,NEIGHBOURS:[-69,-71,-88,-89,-32,-33]},{ID:-71,CENTER:{x:-476,y:370},R:58,NEIGHBOURS:[-70,-72,-89,-90,-35,-34]},{ID:-72,CENTER:{x:-336,y:341},R:58,NEIGHBOURS:[-71,-73,-90,-91,-35,-37,-38]},{ID:-73,CENTER:{x:-185,y:332},R:58,NEIGHBOURS:[-72,-74,-90,-91,-39,-40]},{ID:-74,CENTER:{x:-37,y:307},R:58,NEIGHBOURS:[-73,-75,-91,-42,-43,-47,-48]},{ID:-75,CENTER:{x:52,y:423},R:58,NEIGHBOURS:[-74,-76,-91,-92,-48,-49]},{ID:-76,CENTER:{x:202,y:456},R:58,NEIGHBOURS:[-75,-77,-92,-50,-51]},{ID:-77,CENTER:{x:348,y:455},R:58,NEIGHBOURS:[-76,-78,-92,-93,-94,-52]},{ID:-78,CENTER:{x:421,y:339},R:58,NEIGHBOURS:[-77,-79,-94,-53,-57]},{ID:-79,CENTER:{x:575,y:187},R:120,NEIGHBOURS:[-80,-94,-57,-58,-78,-9999]},{ID:-80,CENTER:{x:552,y:-76},R:120,NEIGHBOURS:[-79,-81,-58,-59]},{ID:-81,CENTER:{x:401,y:-296},R:120,NEIGHBOURS:[-80,-82,-60,-61]},{ID:-82,CENTER:{x:165,y:-412},R:120,NEIGHBOURS:[-81,-83,-61,-62]},{ID:-83,CENTER:{x:-97,y:-460},R:120,NEIGHBOURS:[-82,-84,-62,-63,-64]},{ID:-84,CENTER:{x:-358,y:-479},R:120,NEIGHBOURS:[-83,-85,-64,-65]},{ID:-85,CENTER:{x:-614,y:-397},R:120,NEIGHBOURS:[-84,-86,-65,-66]},{ID:-86,CENTER:{x:-809,y:-216},R:120,NEIGHBOURS:[-85,-87,-66,-67]},{ID:-87,CENTER:{x:-873,y:47},R:120,NEIGHBOURS:[-86,-88,-67,-68,-69]},{ID:-88,CENTER:{x:-863,y:312},R:120,NEIGHBOURS:[-87,-89,-69,-70]},{ID:-89,CENTER:{x:-654,y:515},R:120,NEIGHBOURS:[-88,-90,-70,-71]},{ID:-90,CENTER:{x:-379,y:552},R:120,NEIGHBOURS:[-89,-91,-71,-72,-73]},{ID:-91,CENTER:{x:-111,y:534},R:120,NEIGHBOURS:[-90,-92,-72,-73,-74,-75]},{ID:-92,CENTER:{x:150,y:643},R:120,NEIGHBOURS:[-91,-93,-75,-76,-77]},{ID:-93,CENTER:{x:420,y:654},R:120,NEIGHBOURS:[-92,-94,-77]},{ID:-94,CENTER:{x:598,y:456},R:120,NEIGHBOURS:[-93,-79,-77,-78]},{ID:0,CENTER:{x:203,y:161},R:0,NEIGHBOURS:[-1]},{ID:2,CENTER:{x:112,y:169},R:0,NEIGHBOURS:[-45,-44]},{ID:5,CENTER:{x:31,y:202},R:0,NEIGHBOURS:[-44,-45]},{ID:25,CENTER:{x:-48,y:168},R:0,NEIGHBOURS:[-42]},{ID:26,CENTER:{x:-98,y:201},R:0,NEIGHBOURS:[-41,-42]},{ID:27,CENTER:{x:-156,y:193},R:0,NEIGHBOURS:[-40]},{ID:40,CENTER:{x:-233,y:211},R:0,NEIGHBOURS:[-38]},{ID:41,CENTER:{x:-305,y:238},R:0,NEIGHBOURS:[-38,-37]},{ID:42,CENTER:{x:-350,y:243},R:0,NEIGHBOURS:[-37,-36]},{ID:65,CENTER:{x:-388,y:229},R:0,NEIGHBOURS:[-36]},{ID:66,CENTER:{x:-445,y:260},R:0,NEIGHBOURS:[-34,-33]},{ID:90,CENTER:{x:-489,y:252},R:0,NEIGHBOURS:[-34,-33]},{ID:91,CENTER:{x:-540,y:245},R:0,NEIGHBOURS:[-33,-32,-31]},{ID:92,CENTER:{x:-539,y:206},R:0,NEIGHBOURS:[-32]},{ID:93,CENTER:{x:-574,y:167},R:0,NEIGHBOURS:[-30]},{ID:96,CENTER:{x:-549,y:98},R:0,NEIGHBOURS:[-29,-30]},{ID:97,CENTER:{x:-530,y:48},R:0,NEIGHBOURS:[-28,-27]},{ID:98,CENTER:{x:-511,y:36},R:0,NEIGHBOURS:[-28,-27]},{ID:99,CENTER:{x:-526,y:5},R:0,NEIGHBOURS:[-27]},{ID:100,CENTER:{x:-540,y:-22},R:0,NEIGHBOURS:[-26]},{ID:101,CENTER:{x:-528,y:-76},R:0,NEIGHBOURS:[-25]},{ID:104,CENTER:{x:-472,y:-89},R:0,NEIGHBOURS:[-23,-22]},{ID:105,CENTER:{x:-447,y:-115},R:0,NEIGHBOURS:[-22]},{ID:80,CENTER:{x:-449,y:-171},R:0,NEIGHBOURS:[-21,-20,-19,-22]},{ID:79,CENTER:{x:-396,y:-184},R:0,NEIGHBOURS:[-19,-18]},{ID:78,CENTER:{x:-355,y:-172},R:0,NEIGHBOURS:[-17,-18]},{ID:76,CENTER:{x:-270,y:-169},R:0,NEIGHBOURS:[-16,-17]},{ID:57,CENTER:{x:-232,y:-140},R:0,NEIGHBOURS:[-15]},{ID:56,CENTER:{x:-195,y:-160},R:0,NEIGHBOURS:[-15,-14,-13]},{ID:54,CENTER:{x:-149,y:-161},R:0,NEIGHBOURS:[-15,-14,-13,-12]},{ID:53,CENTER:{x:-112,y:-152},R:0,NEIGHBOURS:[-12]},{ID:35,CENTER:{x:-80,y:-143},R:0,NEIGHBOURS:[-12,-11]},{ID:34,CENTER:{x:-48,y:-146},R:0,NEIGHBOURS:[-12,-11]},{ID:33,CENTER:{x:17,y:-125},R:0,NEIGHBOURS:[-10]},{ID:20,CENTER:{x:86,y:-96},R:0,NEIGHBOURS:[-9,-8]},{ID:108,CENTER:{x:167,y:-66},R:0,NEIGHBOURS:[-8]},{ID:16,CENTER:{x:221,y:-35},R:0,NEIGHBOURS:[-7,-6]},{ID:14,CENTER:{x:256,y:44},R:0,NEIGHBOURS:[-5,-4]},{ID:13,CENTER:{x:222,y:75},R:0,NEIGHBOURS:[-4,-3]},{ID:8,CENTER:{x:115,y:281},R:0,NEIGHBOURS:[-47]},{ID:9,CENTER:{x:203,y:247},R:0,NEIGHBOURS:[-1,-55]},{ID:10,CENTER:{x:128,y:348},R:0,NEIGHBOURS:[-49]},{ID:11,CENTER:{x:209,y:326},R:0,NEIGHBOURS:[-50,-56]},{ID:12,CENTER:{x:287,y:323},R:0,NEIGHBOURS:[-54]},{ID:-9999,CENTER:{x:1204,y:149},R:0,NEIGHBOURS:[-79]}],SEA_EVENTS:{FISH:{FOR_RADIUS:0,NUMBER_INIT:5,SPAWN_CHANCE:.01,SPAWN_DECREASE:5e-4,NUMBER_MIN:1,NUMBER_MAX:15,POWER_MIN:500,POWER_MAX:1e3,TIME_MIN:10,TIME_MAX:0},SHARK:{FOR_RADIUS:0,NUMBER_INIT:4,SPAWN_CHANCE:.005,SPAWN_DECREASE:4e-4,NUMBER_MIN:0,NUMBER_MAX:10,POWER_MIN:250,POWER_MAX:750,TIME_MIN:0,TIME_MAX:0},TREASURE:{FOR_RADIUS:0,NUMBER_INIT:2,SPAWN_CHANCE:.001,SPAWN_DECREASE:3e-4,NUMBER_MIN:1,NUMBER_MAX:3,POWER_MIN:500,POWER_MAX:2e3,TIME_MIN:0,TIME_MAX:0},PIRATES:{FOR_RADIUS:0,NUMBER_INIT:3,SPAWN_CHANCE:.002,SPAWN_DECREASE:2e-4,NUMBER_MIN:1,NUMBER_MAX:7,POWER_MIN:100,POWER_MAX:1e3,TIME_MIN:0,TIME_MAX:0},PIRATES_BASE:{FOR_RADIUS:100,NUMBER_INIT:0,SPAWN_CHANCE:5e-4,SPAWN_DECREASE:4e-4,NUMBER_MIN:0,NUMBER_MAX:1,POWER_MIN:2e3,POWER_MAX:3e3,TIME_MIN:100,TIME_MAX:300},WHIRLPOOL:{FOR_RADIUS:0,NUMBER_INIT:2,SPAWN_CHANCE:.012,SPAWN_DECREASE:.002,NUMBER_MIN:0,NUMBER_MAX:5,POWER_MIN:1,POWER_MAX:1,TIME_MIN:100,TIME_MAX:360},CARTOGRAPHY:{FOR_RADIUS:20,NUMBER_INIT:1,SPAWN_CHANCE:.1,SPAWN_DECREASE:.03,NUMBER_MIN:1,NUMBER_MAX:3,POWER_MIN:50,POWER_MAX:300,TIME_MIN:0,TIME_MAX:0}},REGION_BUILDINGS:{DEFENSES:{REGION_BUILDING:gm.DEFENSES,NAME:"Defenses",DESCRIPTION:"Each defense level decreases attacking unit strength by 1 but only up to half of that unit total strength",COST:[]},ROADS:{REGION_BUILDING:gm.ROADS,NAME:"Roads",DESCRIPTION:"Roads allow troops to travel faster through the region",COST:[{resource:Df.LOG,amount:20},{resource:Df.PLANK,amount:10},{resource:Df.STONE,amount:100},{resource:Df.CUT_STONE,amount:50}]},WATCHTOWER:{REGION_BUILDING:gm.WATCHTOWER,NAME:"Watchtower",DESCRIPTION:"Watchtower allows to gain insight into enemy neighbour regions troops information",COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:80},{resource:Df.BRICKS,amount:20}]},GUARD_TOWER:{REGION_BUILDING:gm.GUARD_TOWER,NAME:"Guard tower",DESCRIPTION:"Guard tower adds passive defenses forces that cannot move to another region",COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50},{resource:Df.BOW,amount:5}]},HARBOUR:{REGION_BUILDING:gm.HARBOUR,NAME:"Harbour",DESCRIPTION:"Harbour allow your ships to station in this region",COST:[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:50},{resource:Df.COPPER,amount:20}]}}},bm={getSickness(e){const t=Object.entries(this.SICKNESS).find(t=>t[0]===Yf[e]);if(t)return t[1];console.warn("Invalid sickness: "+Qf.prepareSicknessName(e))},SICKNESS:{COLD:{CHANCE:20,DURATION:20,LETHALITY:20},FLU:{CHANCE:10,DURATION:30,LETHALITY:40},PNEUMONIA:{CHANCE:5,DURATION:60,LETHALITY:70}}},Cm={SMALL_REFUGEE:{EVENT:um.SMALL_REFUGEE,CHANCE:.0023,MIN_POWER:3,MAX_POWER:7,PREREQUISITES:[],LOG:{MESSAGE:"Small group of refugees came to your village",LOG_TYPE:hm.LOG}},MEDIUM_REFUGEE:{EVENT:um.MEDIUM_REFUGEE,CHANCE:33e-5,MIN_POWER:10,MAX_POWER:20,PREREQUISITES:[Mf.LONGHOUSE],LOG:{MESSAGE:"Medium group of refugees came to your village",LOG_TYPE:hm.LOG}},METEORITE:{EVENT:um.METEORITE,CHANCE:18e-5,MIN_POWER:100,MAX_POWER:200,PREREQUISITES:[Mf.MOUNTAINS],LOG:{MESSAGE:"A meteoroid has fallen somewhere in the mountains",LOG_TYPE:hm.SUCCESS}}};var ym=(()=>(function(e){e[e.DEV=0]="DEV",e[e.KONGREGATE=1]="KONGREGATE",e[e.VK=2]="VK",e[e.ITCH=3]="ITCH"}(ym||(ym={})),ym))();const Am={production:!0,target:ym.ITCH,gameName:"Villager Kings",saveName:"VillagerKingsSave",versionString:"1.3.10",saveVersion:tm.V1_0_0},Nm={name:"New King",building:Lf.ALL,effect:100,duration:90},_m=360,wm=pm,Pm={VILLAGE_TUTORIAL:[{text:"Welcome to this quick tutorial that will guide you through basic controls of Villager Kings",position:{width:"250px",top:"180px",left:"275px"}},{text:'To the left you can see navigation menu that will allow you to browse tabs representing different aspects of your village<br><div class="tutorialCenter"><img src="assets/pictures/tutorials/village2.png"></div>',position:{width:"400px",top:"50px",left:"110px"}},{text:"Right now we are in the village tab and using top menu you can navigate between village regions",position:{width:"200px",top:"65px",left:"130px"}},{text:'In the middle of the village region you can see your buildings.<div class="tutorialCenter"><img src="assets/pictures/tutorials/village3.png"></div>There are many different types of buildings in this game. <br> Some of them produce items, others consume them to produce more advanced items. <br>Currently in your village there are only Huts which produce workers for your village.<br>Housing buildings cannot be stopped and require constant supply of food, fuel (in winter) and clothes',position:{width:"600px",top:"220px",left:"200px"}},{text:'Above your buildings you can see most important metrics for current region.<div class="tutorialCenter"><img src="assets/pictures/tutorials/village4.png"></div>For village those are:<br>1. Population of your village/max population<br>2. Free workers that can be assigned to work<br>3. Size of your empty land where you can build<br>4. Size of your whole village (all regions)<br>5. Your people happiness, which will influence their productivity<br>',position:{width:"400px",top:"130px",left:"110px"}},{text:"That's all here for now let's move into the Forest region using top menu and continue the tutorial there<br><img src=\"assets/pictures/tutorials/village1.png\">",position:{width:"400px",top:"180px",left:"200px"}}],FOREST_TUTORIAL:[{text:"In the forest you have two working buildings<br>Logger's hut that cuts forest trees and produces logs<br>and Gatherer that collects various resources when wandering in the forest.<br><br>Gatherer has two operating modes<br>Worker working here can either focus on looking for food or useful and sometimes rare resources",position:{width:"400px",top:"240px",left:"200px"}},{text:'There are two icons on both sides of building name.<br>To the left there is details icon. If you hover over it, <br>a tooltip with more technical details regarding a building will popup (not active during tutorial).<div class="tutorialCenter"><img src="assets/pictures/tutorials/forest1.png"></div><br>To the right you can see a cog icon which allows you to stop and start production by hiring or firing worker<div class="tutorialCenter"><img src="assets/pictures/tutorials/forest2.png"></div>',position:{width:"450px",top:"200px",left:"150px"}},{text:"Above buildings you can see 'Build' and 'Demolish' buttons.<br>First one opens a window with all buildings you can build in this region.<br>In future you will discover many more types of building to build.<br>Second one allows you to set buildings to be demolished by free worker<br>You will receive small portion of resources used to build demolished building",position:{width:"450px",top:"100px",left:"50px"}},{text:"Now let's order your people to build more gatherers and continue to the 'Resources' tab in the left menu",position:{width:"250px",top:"180px",left:"275px"}}],FIELD_TUTORIAL:[{text:"Field region has many buildings with different mechanics than other regions.<br>Field, Orchard and Pasture buildings require Farm with workers <br>who will work on planting, sowing, harvesting and tending to animals.<br><br>Fields yearly cycle starts in spring, after you have selected what type of crops should be planted,<br>your Farm workers will start plowing the land and then sowing selected crop.<br>After sowing is completed your crops will start to grow until Autumn.<br>On autumn all crops will stop growing and will be ready for harvest performed by Farm workers.<br>If there are any crops not harvested by the beginning of winter they will wither and will be lost.<br><br>",position:{width:"400px",top:"150px",left:"200px"}},{text:"Orchards are a bit different. Those also need to be plowed and plants need to be planted,<br>after that they keep growing for several years without any work input.<br>Once they matured they will fruit every year with only harvest work required.<br><br>",position:{width:"400px",top:"150px",left:"200px"}},{text:"Pastures allow animals breeding. They require work input for the whole year (chores)<br>and animals require Hay to eat during winter.<br>If no hay is available animals can starve to death.<br> They eat grass and other natural food during other seasons.<br>Some animals produce animals products like eggs and milk which add to your food supplies.<br>All animals can be butchered for meat when butcher building is built.<br>Once animals are researched Hunters can try to tame animals for which there is empty pasture space.",position:{width:"400px",top:"150px",left:"200px"}}],MOUNTAINS_TUTORIAL:[{text:"Most mountains buildings require mountains space instead of free land.<br>This mountain area is finite and after the building deplete resources it can be demolished to add empty land instead of back to mountains.<br><br>To gain more mountains areas you will need to run expeditions or conquer enemies (Army).<br><br>After geologist is unlocked and built he will start looking for ores deposits which is very slow process.<br>Once 20 deposits of certain resource has been found Pit Mine can be used to mine it.",position:{width:"400px",top:"150px",left:"200px"}}],PLATEAU_TUTORIAL:[{text:"In this special area Wonder buildings can be constructed.<br>These require much more resources and much more work to be completed.<br>Each Wonder building adds permanent buff corresponding to it's nature.<br>Wonder building also allows you to abdicate what performs soft reset and additionally award you with Royal Points to spend on Royal perks.<br>Wonder building and it's buff persist through soft resets and abdications.",position:{width:"400px",top:"150px",left:"200px"}}],SEA_TUTORIAL:[{text:"By the sea fishers can catch fish from the sea.<br>",position:{width:"400px",top:"150px",left:"200px"}}],RESOURCES_TUTORIAL:[{text:"In this tab you can browse all of the resources that you have discovered<br>Next to the resource icon there is current amount that you have and storage limit for that resource.<br><br>Storage can be extended by building warehouses in the village",position:{width:"400px",top:"150px",left:"200px"}},{text:"To the right there are two additional icons present for each resource<br>First one allows you to set amount that will be reserved and no automated action can use them<br>Player initiated action can on the other hand use reserved resources<br>(keep in mind that some actions like for example invasion can still reduce resources below reserved amount!)<br><br>Second icon toggles which resources should be highlighted in the game header",position:{width:"400px",top:"150px",left:"200px"}},{text:"In the header you can highlight resources to know their amounts in any tab of the game",position:{width:"400px",top:"30px",left:"30px"}},{text:"That's all for the basics.<br>To really start progressing you should work towards building Workshop in the village which will open new opportunities<br>",position:{width:"400px",top:"150px",left:"200px"}}],WINTER_TUTORIAL:[{text:"<br>Winter is coming!<br>",position:{width:"400px",top:"150px",left:"200px"}},{text:"During winter things get much harder.<br><br>Your people will need to start heating their houses or they will freeze, get sick and die.<br><br> To stop freezing your people will need a good supply of things to burn.<br>To heat houses villagers can use Fuel, coal, logs or brushwood",position:{width:"400px",top:"150px",left:"200px"}},{text:"It may be a good idea to reserve or entirely block your people from burning some important resources that you need for building or cooking food.",position:{width:"400px",top:"30px",left:"30px"}},{text:"If your people get sick you will need medicine to increase their chance for getting better.<br><br>Pasture animals may also die during winter when you do not have enough hay to feed them.",position:{width:"400px",top:"150px",left:"200px"}}]},Mm=!0,Lm=!0,Dm=2,xm=1,km=1,Fm=0,Um=!0,Hm=!0,Gm=!0,Bm=!0,Wm=!1,Vm=!1,zm=!1,Ym=!1,Km=!1,jm=!1,$m=!1,Qm=!1,qm=!1,Xm=!1,Zm=!1,Jm=!0,eS=!0,tS=!0,iS=!1,sS={START_LAND:500,START_FOREST:500,START_MOUNTAINS:100,FOREST_GROW_PERCENTAGE:.05,MINIMAL_FOREST_GROWTH:100,FOREST_GROW_TICKS:3600},rS=[{population:0,name:"Village"},{population:2e3,name:"Town"}],nS=fm,oS=mm,aS=Sm,cS=Em,lS=vm,uS=Rm,hS=Om,dS=Tm,gS=Im,pS=bm,fS=Cm;class mS{constructor(e,t,i,s,r){this.forestSizeRule=e,this.forestSizeRuleEnabled=t,this.landSizeRule=i,this.landSizeRuleEnabled=s,this.forestSizeReserved=r}}var SS=(()=>(function(e){e[e.SPRING=0]="SPRING",e[e.SUMMER=1]="SUMMER",e[e.AUTUMN=2]="AUTUMN",e[e.WINTER=3]="WINTER"}(SS||(SS={})),SS))();class ES{constructor(e,t){this.day=e,this.year=t}}let vS=(()=>{class e{constructor(e){this.servicesService=e,this.optionsSubject=new b,this.options=new Map}init(){this.options.set(Xf.AUTO_SAVE_STATUS,wm.AUTO_SAVE_STATUS),this.options.set(Xf.AUTO_SAVE_PERIOD,wm.AUTO_SAVE_PERIOD),this.options.set(Xf.METRIC,wm.METRIC),this.options.set(Xf.SAVE_LOGS,wm.SAVE_LOGS),this.options.set(Xf.PAUSE_ON_INIT,wm.PAUSE_ON_INIT),this.options.set(Xf.KEEP_RESERVATION_SETTINGS_ON_RESET,wm.KEEP_RESERVATION_SETTINGS_ON_RESET),this.options.set(Xf.KEEP_MANAGEMENT_SETTINGS_ON_RESET,wm.KEEP_MANAGEMENT_SETTINGS_ON_RESET),this.options.set(Xf.KEEP_AUTO_TRADE_ON_RESET,wm.KEEP_AUTO_TRADE_ON_RESET),this.options.set(Xf.SOUND_MASTER,wm.SOUND_MASTER),this.options.set(Xf.SOUND_MASTER_VOLUME,wm.SOUND_MASTER_VOLUME),this.options.set(Xf.SOUND_MUSIC,wm.SOUND_MUSIC),this.options.set(Xf.SOUND_MUSIC_VOLUME,wm.SOUND_MUSIC_VOLUME),this.options.set(Xf.SOUND_EFFECTS,wm.SOUND_EFFECTS),this.options.set(Xf.SOUND_EFFECTS_VOLUME,wm.SOUND_EFFECTS_VOLUME),this.options.set(Xf.SOUND_EFFECT_MARKET,wm.SOUND_EFFECT_MARKET),this.options.set(Xf.SOUND_EFFECT_RESEARCH,wm.SOUND_EFFECT_RESEARCH),this.options.set(Xf.SOUND_EFFECT_INVASION,wm.SOUND_EFFECT_INVASION),this.options.set(Xf.SOUND_EFFECT_SEASON,wm.SOUND_EFFECT_SEASON),this.options.set(Xf.VISUAL_PROGRESS_BARS,wm.VISUAL_PROGRESS_BARS),this.options.set(Xf.AUTO_TEXT_FITTING,wm.AUTO_TEXT_FITTING),this.options.set(Xf.PAGED_VIEW,wm.PAGED_VIEW),this.options.set(Xf.BUILDINGS_PER_PAGE,wm.BUILDINGS_PER_PAGE),this.options.set(Xf.POSITIVE_COLOUR,wm.POSITIVE_COLOUR),this.options.set(Xf.NEGATIVE_COLOUR,wm.NEGATIVE_COLOUR),this.options.set(Xf.PLAYER_COLOUR,wm.PLAYER_COLOUR),this.options.set(Xf.AI_DIFFICULTY,wm.AI_DIFFICULTY),this.changePositiveColour(),this.changeNegativeColour(),this.optionsSubject.next()}getName(){return"OptionsService"}load(e){this.options=new Map(JSON.parse(e.options)),this.options.has(Xf.KEEP_RESERVATION_SETTINGS_ON_RESET)||this.options.set(Xf.KEEP_RESERVATION_SETTINGS_ON_RESET,wm.KEEP_RESERVATION_SETTINGS_ON_RESET),this.options.has(Xf.KEEP_MANAGEMENT_SETTINGS_ON_RESET)||this.options.set(Xf.KEEP_MANAGEMENT_SETTINGS_ON_RESET,wm.KEEP_MANAGEMENT_SETTINGS_ON_RESET),this.options.has(Xf.KEEP_AUTO_TRADE_ON_RESET)||this.options.set(Xf.KEEP_AUTO_TRADE_ON_RESET,wm.KEEP_AUTO_TRADE_ON_RESET),this.options.has(Xf.VISUAL_PROGRESS_BARS)||this.options.set(Xf.VISUAL_PROGRESS_BARS,wm.VISUAL_PROGRESS_BARS),this.options.has(Xf.SOUND_MASTER)||this.options.set(Xf.SOUND_MASTER,wm.SOUND_MASTER),this.options.has(Xf.SOUND_MASTER_VOLUME)||this.options.set(Xf.SOUND_MASTER_VOLUME,wm.SOUND_MASTER_VOLUME),this.options.has(Xf.SOUND_MUSIC)||this.options.set(Xf.SOUND_MUSIC,wm.SOUND_MUSIC),this.options.has(Xf.SOUND_MUSIC_VOLUME)||this.options.set(Xf.SOUND_MUSIC_VOLUME,wm.SOUND_MUSIC_VOLUME),this.options.has(Xf.SOUND_EFFECTS)||this.options.set(Xf.SOUND_EFFECTS,wm.SOUND_EFFECTS),this.options.has(Xf.SOUND_EFFECTS_VOLUME)||this.options.set(Xf.SOUND_EFFECTS_VOLUME,wm.SOUND_EFFECTS_VOLUME),this.options.has(Xf.SOUND_EFFECT_MARKET)||this.options.set(Xf.SOUND_EFFECT_MARKET,wm.SOUND_EFFECT_MARKET),this.options.has(Xf.SOUND_EFFECT_RESEARCH)||this.options.set(Xf.SOUND_EFFECT_RESEARCH,wm.SOUND_EFFECT_RESEARCH),this.options.has(Xf.SOUND_EFFECT_INVASION)||this.options.set(Xf.SOUND_EFFECT_INVASION,wm.SOUND_EFFECT_INVASION),this.options.has(Xf.SOUND_EFFECT_SEASON)||this.options.set(Xf.SOUND_EFFECT_SEASON,wm.SOUND_EFFECT_SEASON),this.options.has(Xf.AUTO_TEXT_FITTING)||this.options.set(Xf.AUTO_TEXT_FITTING,wm.AUTO_TEXT_FITTING),this.options.has(Xf.PAGED_VIEW)||this.options.set(Xf.PAGED_VIEW,wm.PAGED_VIEW),this.options.has(Xf.BUILDINGS_PER_PAGE)||this.options.set(Xf.BUILDINGS_PER_PAGE,wm.BUILDINGS_PER_PAGE),this.options.has(Xf.POSITIVE_COLOUR)||this.options.set(Xf.POSITIVE_COLOUR,wm.POSITIVE_COLOUR),this.options.has(Xf.NEGATIVE_COLOUR)||this.options.set(Xf.NEGATIVE_COLOUR,wm.NEGATIVE_COLOUR),this.options.has(Xf.PLAYER_COLOUR)||this.options.set(Xf.PLAYER_COLOUR,wm.PLAYER_COLOUR),this.options.has(Xf.PAUSE_ON_INIT)||this.options.set(Xf.PAUSE_ON_INIT,wm.PAUSE_ON_INIT),this.options.has(Xf.AI_DIFFICULTY)||this.options.set(Xf.AI_DIFFICULTY,wm.AI_DIFFICULTY),this.changePositiveColour(),this.changeNegativeColour(),this.changePlayerColour(),this.optionsSubject.next()}save(){return{options:JSON.stringify(Array.from(this.options.entries()))}}reset(e,t){}registerForOptionsChange(){return this.optionsSubject.asObservable()}setOption(e,t){this.options.set(e,t),this.optionsSubject.next()}setOptions(e){for(const t of e)this.options.set(t.option,t.value);this.optionsSubject.next()}getOption(e){return this.options.get(e)}setPositiveColour(e){this.options.set(Xf.POSITIVE_COLOUR,e),this.changePositiveColour()}setNegativeColour(e){this.options.set(Xf.NEGATIVE_COLOUR,e),this.changeNegativeColour()}setPlayerColour(e){this.options.set(Xf.PLAYER_COLOUR,e),this.changePlayerColour()}changePositiveColour(){document.getElementById("VillagerKings").style.setProperty("--positive-colour",this.options.get(Xf.POSITIVE_COLOUR))}changeNegativeColour(){document.getElementById("VillagerKings").style.setProperty("--negative-colour",this.options.get(Xf.NEGATIVE_COLOUR))}changePlayerColour(){this.servicesService.getService(Zf.WORLD).setPlayerColour(this.options.get(Xf.PLAYER_COLOUR))}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),RS=(()=>{class e{constructor(e,t){this.servicesService=e,this.optionsService=t,this.audios=[],this.musicFiles=["assets/sounds/medieval_life.mp3","assets/sounds/medieval_village.mp3"],e.addService(Zf.SOUND,this),this.optionsService.registerForOptionsChange().subscribe(()=>{const e=this.optionsService.getOption(Xf.SOUND_MASTER)&&this.optionsService.getOption(Xf.SOUND_MUSIC),t=this.optionsService.getOption(Xf.SOUND_MASTER)&&this.optionsService.getOption(Xf.SOUND_EFFECTS);this.audios.forEach(i=>{i.audio.volume=i.effect?t?this.optionsService.getOption(Xf.SOUND_MASTER_VOLUME)/100*(this.optionsService.getOption(Xf.SOUND_EFFECTS_VOLUME)/100):0:e?this.optionsService.getOption(Xf.SOUND_MASTER_VOLUME)/100*(this.optionsService.getOption(Xf.SOUND_MUSIC_VOLUME)/100):0})})}playAudio(e,t=!0){this.audios=this.audios.filter(e=>!e.audio.ended),e.load();const i=this.optionsService.getOption(Xf.SOUND_MASTER)&&this.optionsService.getOption(Xf.SOUND_MUSIC),s=this.optionsService.getOption(Xf.SOUND_MASTER)&&this.optionsService.getOption(Xf.SOUND_EFFECTS);return e.volume=t?s?this.optionsService.getOption(Xf.SOUND_MASTER_VOLUME)/100*(this.optionsService.getOption(Xf.SOUND_EFFECTS_VOLUME)/100):0:i?this.optionsService.getOption(Xf.SOUND_MASTER_VOLUME)/100*(this.optionsService.getOption(Xf.SOUND_MUSIC_VOLUME)/100):0,e.play(),this.audios.push({audio:e,effect:t}),e}playMarket(){this.optionsService.getOption(Xf.SOUND_EFFECT_MARKET)&&this.playAudio(new Audio("assets/sounds/village_bells.mp3"))}playResearch(){this.optionsService.getOption(Xf.SOUND_EFFECT_RESEARCH)&&this.playAudio(new Audio("assets/sounds/village_bells.mp3"))}playBattle(){this.optionsService.getOption(Xf.SOUND_EFFECT_INVASION)&&this.playAudio(new Audio("assets/sounds/battle.mp3"))}playSeason(e){if(this.optionsService.getOption(Xf.SOUND_EFFECT_SEASON))switch(e){case SS.SPRING:this.playAudio(new Audio("assets/sounds/spring.mp3"));break;case SS.SUMMER:this.playAudio(new Audio("assets/sounds/summer.mp3"));break;case SS.AUTUMN:this.playAudio(new Audio("assets/sounds/autumn.mp3"));break;case SS.WINTER:this.playAudio(new Audio("assets/sounds/winter.mp3"))}}playMusic(){const e=this.servicesService;this.playAudio(new Audio(am.randomArrayElement(this.musicFiles)),!1).addEventListener("ended",function(){e.getService(Zf.SOUND).checkForMusic()})}checkForMusic(){this.audios=this.audios.filter(e=>!e.audio.ended),this.audios.find(e=>!e.effect)||this.playMusic()}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(vS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),OS=(()=>{class e{constructor(e,t){this.servicesService=e,this.soundService=t,this.daySubject=new b,this.monthSubject=new b,this.yearSubject=new b,this.year=1,this.day=1,this.tickInDay=1,this.season=SS.SPRING,e.addService(Zf.CALENDAR,this)}getName(){return"CalendarService"}load(e){this.day=e.day,this.year=e.year,this.season=e.season,this.tickInDay=e.tickInDay}save(){return{day:this.day,year:this.year,season:this.season,tickInDay:this.tickInDay}}reset(e,t){this.day=1,this.tickInDay=1,this.season=SS.SPRING,e?this.year=1:this.year+=1}tick(e){this.tickInDay+=1,11===this.tickInDay&&(this.tickInDay=1,this.day+=1,361===this.day&&(this.day=1,this.year+=1,this.servicesService.getGameService().isEnabled(Mf.CALENDAR)&&(this.servicesService.getLogService().success("New Year!"),this.monthSubject.next(Math.floor(this.day/30+1))),this.yearSubject.next(this.year)),this.daySubject.next(this.day),this.day%30==1&&0!==Math.floor(this.day/30)&&this.monthSubject.next(Math.floor(this.day/30+1)));const t=this.season;this.day>=1&&this.day<=90?this.season=SS.SPRING:this.day>90&&this.day<=180?this.season=SS.SUMMER:this.day>180&&this.day<=270?(this.season!==SS.AUTUMN&&(this.servicesService.getResourcesService().checkResourcesBeforeWinter(),this.servicesService.getService(Zf.TUTORIAL).checkWinterTutorial()),this.season=SS.AUTUMN):this.day>270&&this.day<=_m&&(this.season=SS.WINTER),t!==this.season&&this.soundService.playSeason(this.season)}getDay(){return this.day}getYear(){return this.year}getSeason(){return this.season}getAbsoluteDay(){return(this.year-1)*_m+this.day}getSeasonForAbsoluteDay(e){const t=(e-1)%_m+1;return t>=1&&t<=90?SS.SPRING:t>90&&t<=180?SS.SUMMER:t>180&&t<=270?SS.AUTUMN:t>270&&t<=_m?SS.WINTER:void 0}registerForDayChange(){return this.daySubject.asObservable()}registerForMonthChange(){return this.monthSubject.asObservable()}registerForYearChange(){return this.yearSubject.asObservable()}getDate(){return new ES(this.day,this.year)}progressDays(e){this.day+=10}getTickInDay(){return this.tickInDay}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(RS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class TS{constructor(e,t,i,s=null){this.type=t,this.day=i,this.message=e,this.data=s}}let IS=(()=>{class e{constructor(e,t,i){this.servicesService=e,this.calendarService=t,this.optionsService=i,this.entries=[],this.servicesService.addService(Zf.LOG,this),this.logSubject=new b}customLog(e,t){this.entries.push(new TS(e,t,this.calendarService.getDay())),this.logSubject.next()}log(e){this.entries.push(new TS(e,hm.LOG,this.calendarService.getDay())),this.logSubject.next()}warning(e){this.entries.push(new TS(e,hm.WARNING,this.calendarService.getDay())),this.logSubject.next()}success(e){this.entries.push(new TS(e,hm.SUCCESS,this.calendarService.getDay())),this.logSubject.next()}mystical(e){this.entries.push(new TS(e,hm.MYSTICAL,this.calendarService.getDay())),this.logSubject.next()}fightReport(e){this.entries.push(new TS(e.message,hm.FIGHT_REPORT,this.calendarService.getDay(),e)),this.logSubject.next()}errorReport(e){this.entries.push(new TS(e.message,hm.ERROR,this.calendarService.getDay(),e)),this.logSubject.next()}autoSave(){if(this.entries.length>0){const e=this.entries[this.entries.length-1];if(e.message&&e.message.includes("Auto saved")){let t=2;const i=e.message.replace("Auto saved","").replace(" ","");i.length>0&&(t=Number(i)+1),e.message="Auto saved "+t,this.logSubject.next()}else this.log("Auto saved")}else this.log("Auto saved")}registerForLogs(){return this.logSubject.asObservable()}getEntries(){return this.entries}clearEntries(){this.entries=[],this.logSubject.next()}getName(){return"LogService"}load(e){this.entries=e.logs}reset(e,t){this.entries=e?[]:this.entries.slice(-5).filter(e=>e.type===hm.MYSTICAL)}save(){return this.optionsService.getOption(Xf.SAVE_LOGS)?{logs:this.entries.slice(Math.max(0,this.entries.length-100),this.entries.length)}:{logs:[]}}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(OS),gs(vS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),bS=(()=>{class e{constructor(e,t,i){this.servicesService=e,this.calendarService=t,this.logService=i,this.buildingEffects=[],this.natureEffects=[],this.armyEffects=[],e.addService(Zf.EFFECTS,this),this.daySubscription=t.registerForDayChange().subscribe(e=>{this.buildingEffects.forEach(e=>{e.duration>0&&(e.duration-=1)}),this.armyEffects.forEach(e=>{e.duration>0&&(e.duration-=1)}),this.natureEffects.forEach(e=>{e.duration>0&&(e.duration-=1)})})}getName(){return"EffectsService"}load(e){this.buildingEffects=[],e.buildingEffects.forEach(e=>{this.buildingEffects.push(new nm(e.name,e.building,e.effect,e.duration,e.buff))}),this.armyEffects=[],e.armyEffects.forEach(e=>{this.armyEffects.push(new cm(e.name,e.troop,e.effect,e.duration))}),this.natureEffects=[],e.natureEffects.forEach(e=>{this.natureEffects.push(new lm(e.name,e.effect,e.duration))})}save(){return{buildingEffects:this.buildingEffects,armyEffects:this.armyEffects,natureEffects:this.natureEffects}}reset(e,t){e?(this.buildingEffects=[],this.armyEffects=[],this.natureEffects=[]):t?(this.buildingEffects=this.buildingEffects.filter(e=>e.isRoyal()),this.armyEffects=this.armyEffects.filter(e=>e.isRoyal()),this.natureEffects=this.natureEffects.filter(e=>e.isRoyal())):(this.buildingEffects=this.buildingEffects.filter(e=>e.isRoyal()||e.isWonder()),this.armyEffects=this.armyEffects.filter(e=>e.isRoyal()||e.isWonder()),this.natureEffects=this.natureEffects.filter(e=>e.isRoyal()||e.isWonder()))}tick(e){this.buildingEffects=this.buildingEffects.filter(e=>0!==e.duration),this.armyEffects=this.armyEffects.filter(e=>0!==e.duration),this.natureEffects=this.natureEffects.filter(e=>0!==e.duration)}getBuildingEffectsValue(e,t=!1,i=-1){let s=0;return i>0?this.buildingEffects.filter(t=>t.building===e||t.building===Lf.ALL).filter(e=>e.isPermanent()===t).filter(e=>!e.isBuff()||e.isBuff()&&e.buff===i).forEach(e=>s+=e.effect):this.buildingEffects.filter(t=>t.building===e||t.building===Lf.ALL).filter(e=>e.isPermanent()===t).forEach(e=>s+=e.effect),s}getBuildingEffects(e,t=-1){return e?t>0?this.buildingEffects.filter(t=>t.building===e||t.building===Lf.ALL).filter(e=>e.buff===t):this.buildingEffects.filter(t=>t.building===e||t.building===Lf.ALL):this.buildingEffects}hasWonderEffects(e){return this.buildingEffects.filter(t=>t.name===e).length>0||this.armyEffects.filter(t=>t.name===e).length>0||this.natureEffects.filter(t=>t.name===e).length>0}getNatureEffectsValue(){let e=0;return this.natureEffects.forEach(t=>e+=t.effect),e}getNatureEffects(){return this.natureEffects}addNatureEffect(e,t=!0){if(this.natureEffects.push(e),t){let t=e.name;e.isPermanent()?t+=" will permanently affect ":t+=" will affect ",t+="most natural sources with ",t+=e.effect>0?"+"+e.effect+"%":e.effect+"%",t+=" of their base power",e.isPermanent()||(t+=" for "+e.duration+" days"),this.logService.log(t)}}addBuildingEffect(e,t=!0){if(this.buildingEffects.push(e),t){let t=e.name;e.isPermanent()?t+=" will permanently affect ":t+=" will affect ",t+=e.building===Lf.ALL?"all buildings with ":Qf.prepareBuildingName(e.building)+" with ",t+=e.effect>0?"+"+e.effect+"%":e.effect+"%",t+=e.building===Lf.ALL?" of their base power":" of its base power",e.isPermanent()||(t+=e.duration%_m==0?e.duration===_m?" for "+e.duration/_m+" year":" for "+e.duration/_m+" years":" for "+e.duration+" days"),this.logService.log(t)}}addArmyEffect(e,t=!0){if(this.armyEffects.push(e),t){let t=e.name;e.isPermanent()?t+=" will permanently affect ":t+=" will affect ",t+=e.troop===Wf.ALL?"all troops with ":Qf.prepareTroopName(e.troop)+" with ",t+=e.effect>0?"+"+e.effect+"%":e.effect+"%",t+=" of their base strength and defense",e.isPermanent()||(t+=" for "+e.duration+" days"),this.logService.log(t)}}getArmyEffects(){return this.armyEffects}hasBuildingEffect(e,t){return void 0!==this.buildingEffects.find(i=>i.name===e&&i.building===t)}hasArmyEffect(e,t){return void 0!==this.armyEffects.find(i=>i.name===e&&i.troop===t)}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(OS),gs(IS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const CS=[{VERSION:"v1.0.1",MESSAGE:['<ul><li>Fixed barracks not unlocking after being researched</li><li>Fixed weather research description</li><li>Shrine and Church will be available earlier</li><li>"New year!" message will appear on day 1 and only after researching calendar</li><li>Shrine and Church will now log when they become available</li><li>Fixed wrapper boxes sizes</li><li>Pit mine research description changed</li><li>Reduced building button and dropdown font size to prevent overflow</li><li>Aligned building icon and text</li><li>Reduced amount of fur produced by hunter</li><li>Fixed merchant buying items for 0 coins</li><li>Reduced required research points for forestry</li><li>Last tutorial step no longer has "skip tutorial" button</li><li>Available nutrition metric doesn\'t include reserved food</li><li>Researching animals require hay</li><li>Fixed geologist last find description</li></ul>']},{VERSION:"v1.0.2",MESSAGE:["<ul><li>Fixed building line icons alignment</li><li>Refactored dev message window into changelog</li><li>Reduced low happiness severity</li><li>Doubled starting food amount</li><li>Buffed berry and mushroom find chance</li></ul>"]},{VERSION:"v1.0.3",MESSAGE:["<ul><li><b>Famine is now satisfied with 50% less food</b></li><li><b>Refactored happiness so that multiple things combined cannot bring it down to 0</b></li><li>It is now possible to pause the game through settings dropdown menu</li><li>The game is now paused during tutorials</li><li>Reduced brushwood cost of stone tools and bow.</li><li>Buildings are now taking action in random order instead of left to right top to bottom</li><li>Tavern decrease happiness over 75% when no alcohol is available</li><li>Changed Tavern building lines to show amount of alcohols</li><li>Added option to produce fish food for fishers</li><li>Added option to boost school of fish with fish food</li><li>Fixed new school of fish not spawning</li><li>Fixed new sharks not spawning</li><li>Added new Research for Fish Food</li><li>Added tutorials for Field, Mountains, Sea and Plateau regions</li><li>Added close button for royal points modal</li><li>Greatly increased animal taming chance <br>(Taming is supposed to be slow, as this only to be used to kick-start pastures. Another method is to buy animals on the market)</li><li>Fixed animal amount calculation errors resulting in negative, doubled<br> or over the limit amount of animals</li><li>Added notification to market tab if there is no marketplace</li><li>Changed marketplace bribe button text</li></ul>"]},{VERSION:"v1.0.4",MESSAGE:["<ul><li><b>Fixed demolishing huts and houses</b></li><li>Fixed Crafting tab display for Chrome and Edge</li><li>Increased gatherer chance for finding stone and brushwood</li><li>Added several warning for low forest size</li><li>Increased minimal yearly forest growth</li></ul>"]},{VERSION:"v1.0.5",MESSAGE:['<ul><li><b>Fixed wrong army mission being started</b></li><li><b>Fixed Food nutrition value displaying NaN and blocking anything that requires FOOD nutrition as cost</b></li><li>Fixed "Spy" mission not displaying enemy power</li><li>Church will now unlock Religion tab when built</li><li>Urban Planning no longer require house to be researched</li></ul>']},{VERSION:"v1.0.6",MESSAGE:["Bug fixes:<ul><li><b>Fixed King of the People royal perk not allowing to build houses</b></li><li><b>Fixed royal perks not processing unlocked research correctly</b></li><li><b>Fixed research permanent effects not to persist through soft reset and abdication</b></li><li><b>Fixed geologist not finding gold, silver and iron</b></li><li><b>Fixed Tavern not appearing after being researched</b></li><li><b>Fixed fields, orchards and pastures splitting value</b></li><li><b>Fixed 'Blessing' prayer and excluded a lot of buildings that would not benefit from it</b></li><li><b>Fixed changing religion to be player action</b></li></ul>Performance:<ul><li>Improved performance for reloading region<br>It will still take regular time on the first visit but after that I got about 3 times better loading time for region with 36 buildings</li></ul>Other:<ul><li>Improved butcher meat transporting. It no longer requires whole warehouse space to be available at once</li><li>Increased geologist deposits find chances</li><li>Renamed 'Entertainment' research to 'Alcohol'</li><li>Housing buildings show when they are using fuel</li><li>Added research tab warning when no workshop is set to research</li><li>Added button to show finished research projects</li><li>Increased average meat production for hunter lodge</li><li>Improved scrolling in modals</li><li>Urban planning research points requirement greatly reduced</li><li>Improved some prayers descriptions</li><li>Nature effects are now logged when added</li><li>Decreased recruitment times for all troops</li><li>Fishers huts will now work during rain (apparently fish can catch even better during rain due to more oxygen in the water)</li></ul>"]},{VERSION:"v1.0.7",MESSAGE:["Bug fixes:<ul><li><b>Fixed forecast period saving. It will no longer go back to one day after researching weather and reloading game</b></li><li><b>Fixed pastures filling only one butcher. Pasture will now give animal to butcher with shortest queue</b></li><li><b>Fixed demolishing buildings other than housing buildings</b></li><li><b>Fixed work management output to start with maxed output resources</b></li><li><b>Fixed mission not returning troops</b></li><li><b>Fixed possibility to build next wonder without researching</b></li><li><b>Lost wonder effects will be restored on abdication or soft reset</b></li><li><b>Fixed harvesting from field in summer</b></li><li><b>Fixed buying animal filling entire pasture</b></li><li><b>Fixed animals produce filling warehouse when chores went over 50</b></li></ul>Other:<ul><li><b>Changed expedition to take longer and cost more but give more land and kill less troops</b></li><li><b>Improved building filtering and made it persistent</b></li><li><b>Increased game size by about 25%</b></li><li><b>Arrange doesn't require to be researched anymore</b></li><li><b>New option to change visual progress bars to text progress value</b></li><li>Workshops show what is being researched</li><li>Geologist is no longer limited by mountains size</li><li>Slightly improved Royal perks descriptions</li><li>Added special warning for demolishing housing building when there is no enough free space to move all occupants to</li><li>Increased amount of fuel crafted from coal and heating power of coal</li><li>Pit mine now warn that it requires 20 deposits</li><li>Slightly corrected research display</li><li>Changes for Royal Points granting events</li><li>Disabled Ascension temple until it will be fixed</li></ul>Information:<ul><li>Drag and drop arrange seems to work on some computers and not on others. I have tested on a PC and laptop with the same operating system and browser version and it does work on PC and not on laptop.</li></ul>"]},{VERSION:"v1.0.8",MESSAGE:['Bug fixes:<ul><li><b>Fixed workshop display that caused buildings to display in two columns</b></li><li><b>Changes regarding workshop logic that might fix locking issue</b></li><li><b>Fixed "R Quarry" and "R Smithy" prerequisites display</b></li><li><b>Fixed incorrect animals moving when splitting or demolishing pasture</b></li><li><b>Gatherers won\'t lock on warehouse. Locking resource will be removed</b></li><li><b>Fixed field and orchard harvest scale display</b></li><li><b>Fixed bread recipe wheat cost to 2 instead of 1</b></li><li><b>Work management will fire worker after finishing work cycle if rules are not satisfied</b></li><li><b>Fixed and enabled Ascension Temple (requires conditions to be met to become available)</b></li><li><b>Fixed Missions again</b></li><li><b>Fixed some metals recipes not adding after research and smithy built</b></li><li><b>Fixed smithy demolishing</b></li></ul>Other:<ul><li><b>Added tooltips to resources in resource tab.<br>Consumable resources display nutrition<br>Fuel resources display heating power</b></li><li><b>Resources tooltip will now show what building/action used each resource in previous 30 days.</b></li><li>Increased hay consumption of animals by 30%</li><li>Increased apples nutrition value</li><li>Increased apples harvest multiplier</li><li>Increased great lighthouse royal points temporary (to make up for no effects)</li></ul>']},{VERSION:"v1.0.9",MESSAGE:["New features<ul><li><b>Implemented new extended reserver that can define different limit for most of the consumers</b></li></ul>Bug fixes:<ul><li><b>Fixed building Smithy required to research tech allowing to build it</b></li><li><b>Fixed limited buildings allowed to build over the limit</b></li><li><b>Fixed missions finishing without calculating outcome</b></li><li><b>Most probably fixed overscrolling from game to kongregate window</b></li></ul>Other:<ul><li>Doubled iron deposit find chance</li><li>Ore deposits found limited at 50 each</li><li>Troops multiplier now shows multiplied required resources in tooltip. If you cannot afford - troop turns grey</li><li>Slightly increased happiness reduction from half food rations</li><li>Buildings number limit is now added to build window</li><li>Decreased brushwood fuel cost and increased brushwood energy</li></ul>"]},{VERSION:"v1.0.10",MESSAGE:["New features<ul><li><b>Added more production details to buildings in build window</b></li><li><b>Added Manufacture building for specialised crafting</b></li><li><b>Added Specialised production research to unlock manufacture</b></li></ul>Bug fixes:<ul><li><b>Fixed and improved building power modifier display to include permanent effects and correctly use weather multiplier</b></li><li><b>Fixed pastures limits updating to resources tab</b></li><li><b>Fixed wooden tower starting with decreased health</b></li><li><b>Fixed metallurgy to add bronze recipe</b></li><li><b>Fixed orchard harvest calculation when in autumn</b></li><li><b>Fixed bug with New King buff lasting 0 days after reset or abdication</b></li></ul>Other:<ul><li>Changed work management option description (management tab) and added description message after researching Human Resources</li><li>Extended some buildings descriptions</li><li>Increased fur production from hunters</li></ul>"]},{VERSION:"v1.0.11",MESSAGE:["New features<ul><li><b>Forest management improved and moved into management tab</b></li></ul>Bug fixes:<ul><li><b>Fixed some wonders add effects after each reset</b></li><li><b>Fixed Forester not returning land when demolished</b></li></ul>Other:<ul><li>Added option to show only current view tutorial</li><li>Added buttons to hire/fire workers in all currently viewed buildings</li><li>Removed autofill '1' for crafting amount input</li><li>Increased expeditions cost</li><li>Decreased chicken and pigs breeding speed </li><li>Forestry research now requires management to be researched</li><li>Added Stonehenge effect for manufacture</li><li>Changed wonders to reapply missing effects on soft reset or abdication</li><li>Changed some missions times</li><li>Added troops list to mission in progress</li></ul>"]},{VERSION:"v1.0.12",MESSAGE:["New features<ul><li><b>Added new housing building</b></li><li><b>Added crafting cheese from milk (might require new run)</b></li><li><b>Added new army troop</b></li></ul>Bug fixes:<ul><li><b>Fixed huts and houses ignoring fuel items reserved amounts</b></li><li><b>Smithy can no longer be blessed</b></li><li><b>Fixed manufacture producing even when there are no required resources</b></li><li><b>Fixed pastures not producing when there is more than 1000 animals</b></li><li><b>Fixed some imperfections on the background image</b></li><li><b>Fixed orchard resources not available in resources and market before discovered via harvest</b></li></ul>Other:<ul><li><b>Warehouses can be combined and split</b></li><li>Warehouse building size increased (resource storage stays the same)</li><li>Nutrition display has been moved to header (might cause highlighted items to overflow)</li><li>Increased hay required by animals during winter</li><li>Animals now require food for the whole year ( less food required during spring, summer and autumn than in winter )</li><li>Added tooltip to market offers to show more information regarding the offer</li><li>Removed horse cost from expeditions</li><li>Manufacture moved closer in the research tree and has cost decreased</li><li>Mint now requires gold and silver to make coins</li><li>Added nutrition usage to header nutrition tooltip</li><li>Forest low size warnings will now display only when forestry is not researched</li><li>Crafting tab orders will now display how many workshops are crafting particular item</li></ul>"]},{VERSION:"v1.0.13",MESSAGE:["New features<ul><li><b>Added new health resources (no use yet)</b></li><li><b>It's now possible to switch reserved value to be interpreted as reserve % of total limit</b></li><li><b>Added possibility to add second row to header through management menu</b></li><li><b>Added Heritage system that awards points based on population size on reset</b></li></ul>Performance<ul><li><b>Big performance improvement</b></li><li><b>New performance option in settings (give current default performance a try before changing options)</b></li></ul>Bug fixes:<ul><li><b>Fixed wonder construction not benefiting from construction effects</b></li><li><b>Church will employ worker when finished building</b></li></ul>Other:<ul><li><b>Changed arrange drag and drop to click and click</b></li><li>Researching windmill will now make fabric visible and tradeable</li><li>Upgrade arrow will now have green outline</li><li>Farm can now be upgraded to level 2</li><li>Shrine and Church now have diminishing return from population size</li><li>Apples growth time reduced by 25%</li><li>Greatly reduced alcohol consumption rate</li><li>Invasions will now only happen when village reach certain size</li><li>Invasions will now have a recharge period when invasion threat will not grow</li><li>Workers and population can now be added to header</li><li>Nutrition value will show in the header from the start</li></ul>"]},{VERSION:"v1.0.14",MESSAGE:["New features<ul><li><b>Army troops will now require soldiers pay every 30 days.<br>If there is no enough coins to pay soldier has 25% chance to desert</b></li><li><b>Added new buildings filter for all/working/idle buildings</b></li></ul>Bug fixes:<ul><li><b>Fixed iron recipe not added after researching</b></li></ul>Other:<ul><li>Renamed 'Leather' research to 'Tannery' and removed it from tailor prerequisites</li><li>Added warning about low heating resources on start of autumn</li><li>Added herbs to gatherer building description</li><li>Vegetable and meat soups now require herbs</li><li>Increased high (90-100) happiness effect from 35% to 50%</li><li>Prioritized resources have higher chance to appear on market</li><li>Added new royal perk</li><li>Added a window for nature effects in effects management</li><li>Increased workshops building size</li><li>Decreased animals reproduction rate</li><li>Farm upgrade increases farm power</li></ul>"]},{VERSION:"v1.0.15",MESSAGE:["New features<ul><li><b>Added 'Herbalism' research that allows to plant herbs at fields</b></li></ul>Bug fixes:<ul><li><b>Fixed field harvest display and yield calculation</b></li><li><b>Fixed House building awarded with King of the People perk. It now starts with 3 occupants</b></li><li><b>Fixed game freeze when coins were reserved</b></li></ul>Other:<ul><li>Manufacture no longer stops production during storm</li><li>Mint building size increased, power decreased, output coins increased to be worth more than input resources</li><li>Initial housing buildings start equipped with clothes</li><li>Mathematics research will now also buff deconstructions</li><li>Added pause/resume button in the footer</li><li>Added options to change positive and negative colours to user defined</li></ul>"]},{VERSION:"v1.0.16",MESSAGE:["New features<ul><li><b>Added food priority to management</b></li></ul>Performance<ul><li><b>Added settings option that allows to paginate buildings in regions.<br>Number of buildings per page can be also defined in settings</b></li></ul>Bug fixes:<ul><li><b>Fixed king of the people House building having too much population from start (6 instead of 3)</b></li><li><b>Fixed selling animals removing more than it should</b></li><li><b>Fixed pit mine mining only 199 resources</b></li></ul>Other:<ul><li>Pit mine base power reduced</li><li>Workshops now show what resource they are waiting to deposit</li><li>Workshops won't start crafting if there is no space in warehouse or if warehouse will be filled to full by other workshops</li></ul>"]},{VERSION:"v1.0.17",MESSAGE:["New features<ul><li><b>Resources tooltips will now show who produced that item in the last 30 days</b></li></ul>Bug fixes:<ul><li><b>Fixed mountains tab deposits causing scroll bar to go below the screen</b></li><li><b>Tooltips should no longer go under the screen</b></li><li><b>Probably fixed tavern bug</b></li><li><b>Fixed army payday countdown stuck and invasions being tied to this countdown</b></li><li><b>Fixed day being 11 ticks instead of 10</b></li><li><b>Fixed golden items not resetting correctly</b></li></ul>Other:<ul><li>Changed 'Royal prophecy' 3rd perk to grant 'Bow' and 'Hunting' research instead of 'Mortar'</li><li>Added display of what golden items have been found during current run</li><li>Farms will now work on pastures during rain</li><li>Pastures details now show how much meat current animals will yield</li><li>Alcohol unlocks beer and wine resources</li><li>Windmill power and flour amount doubled, flour recipe cost reduced</li><li>Longhouse require hay instead of fabric (for roof), House require brushwood (also for roof)</li><li>Limited tavern to 1 (having more might be bad if they lack alcohol as negative/positive effects would be applied multiple times)</li></ul>"]},{VERSION:"v1.0.18",MESSAGE:["Bug fixes:<ul><li><b>Fixed huts not arranging correctly</b></li><li><b>Fixed importing showing researches blocked and as done</b></li><li><b>Fixed temperature in weather tab not showing in fahrenheit</b></li><li><b>Fixed workshop waiting for warehouse text breaking buildings order</b></li></ul>Other:<ul><li>Added description to finished research projects describing what has been learned</li></ul>"]},{VERSION:"v1.0.19",MESSAGE:["New features<ul><li><b>Added cooked fish. Researching 'cooking' required to get recipe</b></li><li><b>Added sheep and wool. Wool can be used to craft fabric</b></li></ul>Bug fixes:<ul></ul>Other:<ul><li><b>Reservation settings carry over soft resets/abdications but are deactivated. Added settings option to carry over activated reservations.</b></li><li><b>Management menu options carry over soft resets/abdications if settings option is enabled. Some options require research to become available so until they are researched default values will be used.</b></li><li>Mushrooms can now be planted on farms</li><li>Increased shrine building power</li><li>Increased single buildings buffs power from 5% to 10%. Added more buff information to buff tooltip</li><li>Added agriculture as prerequisite for alcohol</li><li>Unlocking shrine or church will log in green</li><li>Leather recipe no longer available from start</li><li>Removed 'waiting for trees' from loggers hut if forest is available</li><li>Added management option to display research progress in the header</li><li>Quarry and pit mine will log when resources finished</li><li>Increased bigger housing buildings food and fuel storage. Changed their cost to that value.</li></ul>"]},{VERSION:"v1.0.20",MESSAGE:["Bug fixes:<ul><li><b>Produced/used by data will no longer persist through resets</b></li></ul>Other:<ul><li>Added pasture description to hint where to find first animals</li><li>Added management option to display faith in the header</li><li>Added new royal perk to increase initial crafting queue size</li><li>Increased 'Motivation Speech' perk to last 5 years instead of just 1 year</li><li>Soft reset and abdication now shows how many people are needed for the next heritage point</li><li>Chores cap now scale with pasture size</li><li>Hay nutrition for animals reduced from 25 to 10</li><li>'Auto save' messages will now combine into one with number of total saves</li><li>Added log message when worker is removed from the building. This can be disabled in management</li><li>Used up building (quarry, pit mine) will now have greyed out background</li><li>Greatly increased fruiting rate for all orchard crops. Orchards can now fruit also in summer</li></ul>"]},{VERSION:"v1.1.0",MESSAGE:["New Features:<ul><li><b>Introduced world map tab with new mechanics and reworked army missions</b></li><li><b>New buildings: Embassy, Paper mill, Deep mine</b></li><li><b>A few new researches</b></li><li><b>Added average daily nutrition production display to nutrition tooltip</b></li></ul>Bug fixes:<ul><li>Lack of alcohol now reduces happiness again down to 75%</li><li>Added better verification to auto save period input</li><li>Fixed stuck payday counter when no pay is due</li></ul>Other:<ul><li><b>New level of 'Family jewels' that add coins to starting resources</b></li><li>'Motivation speech' duration increased to 100 years</li><li>Reduced alcohol consumption and happiness increase/decrease</li><li>Used up buildings (quarry, pit mine) will not require demolish confirmation anymore</li><li>Wiki link added to footer</li><li>Pit mine base power decreased</li></ul>"]},{VERSION:"v1.1.1",MESSAGE:["Bug fixes:<ul><li><b>Fixed deep mine not working after upgrade</b></li><li><b>Underground City will now also buff deep mine</b></li><li><b>Player plunder and conquer no longer will fight player region when conquered</b></li><li><b>Fixed issue with region selection moving map instead</b></li></ul>Other:<ul><li><b>Increased cost for AI colonization (so that it happens less frequently)</b></li><li><b>Increased cost for AI troops</b></li><li>Deep mine will take longer to find new ores and longer to upgrade</li><li>Royal perks split into permanent and one time use groups</li><li>When demolishing housing buildings villagers will take their share of food, fuel and clothes to the new building</li><li>There are reports about golden apples in the orchards!</li><li>Removed stone from colonization cost</li></ul>"]},{VERSION:"v1.1.2",MESSAGE:["New Features:<ul><li><b>Auto trade options in resource settings window</b></li></ul>Bug fixes:<ul><li><b>Fixed pasture chores to use farm power bonus</b></li><li><b>Fixed player regions being attacked even with friendly standing</b></li></ul>Other:<ul><li>Reduced troops training time</li><li>Reduced AI attacks chance</li><li>Removed fabric from paper mill cost</li><li>Pit mine require only 20 mountains again</li><li>Added confirm window when trying to buy resource over the limit</li></ul>"]},{VERSION:"v1.1.3",MESSAGE:["New Features:<ul><li><b>Work management has now a season rule</b></li><li><b>Work management can be set to craft always to max</b></li><li><b>Work management for training square added</b></li><li><b>Work management can be set to all buildings of the same type</b></li><li><b>Work management for farm added</b></li></ul>Bug fixes:<ul><li><b>Added Paper mill to resource settings</b></li><li><b>Fixed spy mission</b></li><li><b>'Move' mission troops will return if target region has been conquered</b></li></ul>Other:<ul><li><b>Reduced AI income</b></li><li>Reduced number of AI starting regions</li><li>Changed shrine cost to raw resources</li><li>Deep mine ore finding rate per ore increase with each building level</li><li>Added logs when player region is conquered</li></ul>"]},{VERSION:"v1.1.4",MESSAGE:["New Features:<ul><li><b>Added fight reports</b></li></ul>Other:<ul><li>Diplomacy will be decreased much more after hostile actions towards friendly kingdoms</li><li>AI regions will start with 2 archers to slow down early rush</li><li>Added settings option that will pause the game on page open/refresh</li></ul>"]},{VERSION:"v1.1.5",MESSAGE:["Bug fixes:<ul><li><b>Added missing fight reports on won defense</b></li><li><b>Fixed missing path connection from one of the regions</b></li><li><b>Fixed farm work management not saving</b></li><li><b>Added scroll bar to general management tab to prevent food priority hiding</b></li><li><b>Fixed player kingdom name changing</b></li><li><b>Loot message will combine the same resources</b></li><li><b>'Pickaxe design' will now add bonus to deep mine</b></li></ul>Other:<ul><li>Max colonists set to 20 (as there is no point in sending more)</li><li>Reduced hay yield multiplier from 2 to 1.5</li><li>Reduced the cost of 'specialised production' research</li><li>Increased pit mine base power</li><li>Reduced wine fermenting time from 1 year to 30 days</li><li>Recruits can be 'drag and drop' arranged</li><li>Soft reset/abdication message will now say on what year current run has started</li></ul>"]},{VERSION:"v1.1.6",MESSAGE:["New Features:<ul><li><b>Added research crafting queue</b></li><li><b>Added Buildings auto-sort.<br>Order of buildings will be the same as the order of appearance.</b></li></ul>Bug fixes:<ul><li><b>Chrome map bugs should be fixed now</b></li><li><b>Fixed building confirmation (triggered by button) to work incorrectly when confirmed with enter</b></li></ul>Other:<ul><li>Village region will be now remembered and redirected on reentry</li><li>Added management switch to change default workshop mode</li><li>Added management switch to prevent hunters stop taming</li></ul>"]},{VERSION:"v1.1.7",MESSAGE:["New Features:<ul><li><b>Added percentage auto trade</b></li></ul>Bug fixes:<ul><li><b>Fixed research progress resetting on load. Might not work for research already in the queue (finish or cancel and add again)</b></li></ul>Other:<ul><li>Added queue size display to research tab</li><li>Added pause 'p' and world map 'm' hotkeys</li><li>Improved pasture, field and orchard splitting and combining</li><li>Added management option to allow summer plowing</li><li>Added focus on input to some popup windows</li><li>Added settings option to keep auto trade on after reset</li><li>Added management option to disable auto trade logs</li><li>Changed skirmish win chance calculation</li><li>Added army bonus to each skirmish if army is at least twice the size of the enemy army</li><li>Reduce attack/defense of troop that won skirmish by 1 (tiredness)</li></ul>"]},{VERSION:"v1.1.8",MESSAGE:["Bug fixes:<ul><li><b>Fixed winter happiness from clothes not being applied</b></li></ul>Other:<ul><li>Soft reset renamed to abdication</li><li>World map regions ownership won't reset on abdications unless ordered to</li><li>Added map switch to show capitals, armies and spies</li></ul>"]},{VERSION:"v1.1.9",MESSAGE:["New Features:<ul><li><b>Added Gatherers camp (upgrades will come in future patches)</b></li><li><b>Added sickness mechanic. Freezing villagers will get sick.<br>Each sickness has a chance that sick villager will die.<br>Sick villagers cannot work<br>Herbal medicine reduces sickness time (and indirectly lethality)</b></li><li><b>Added research unlocking with Heritage Points</b></li></ul>Bug fixes:<ul><li><b>Fixed research queue entry canceling when selecting 'no' in confirmation window</b></li><li><b>Fixed header size when importing save with 2-line header on 1-line header state</b></li><li><b>Added Gatherers camp (upgrades will come in future patches)</b></li></ul>Other:<ul><li>Added heating efficiency descriptions to house building</li><li>Auto sort should now also consider manufacture recipe while sorting</li><li>Added log message when faith is full</li><li>Added header entries that list all resources of each category</li><li>Slightly changed buildings sizes</li></ul>"]},{VERSION:"v1.1.10",MESSAGE:["Bug fixes:<ul><li><b>Added Gatherers camp effect from sacred grove</b></li><li><b>Removed 'reset heritage' from abdication</b></li><li><b>Fixed auto sort buildings disappearing when sorting with manufacture without recipe</b></li><li><b>Gatherers camp local storage cleared when mode is changed</b></li><li><b>Fixed colonizing player owned regions would gain extra land</b></li><li><b>Fixed tavern not applying negative alcohol happiness when disabled</b></li><li><b>Fixed research unlocking blocked by buildings prerequisites even if those are fulfilled</b></li></ul>Other:<ul><li>Moved food priority section of management tab higher</li><li>Doubled amount of alcohol added to tavern (1 beer adds 2 beer in tavern, same for wine)</li><li>Increased amount of hay consumed by animals during winter by 50%</li></ul>"]},{VERSION:"v1.1.11",MESSAGE:["New Features:<ul><li><b>Added cloud(server) saving to settings window. Can only be triggered manually during testing period</b></li></ul>Bug fixes:<ul><li><b>QUICKFIX: fixed critical population related bug that could cause game being stuck in infinite loop</b></li><li><b>Fixed research spending HPs when prerequisites are not met</b></li><li><b>More fixes to auto sort function (for manufactures)</b></li></ul>Other:<ul><li>Loot will be sorted alphabetically</li></ul>"]},{VERSION:"v1.1.12",MESSAGE:["New Features:<ul><li><b>Added AI difficulty settings to options menu</b></li></ul>Bug fixes:<ul><li><b>QUICKFIX: Fixed report of defeated units showing for enemy colonisation</b></li><li><b>Fixed AI bug that caused AI daily code to be executed multiple times a day after abdication</b></li><li><b>Fixed server related popups</b></li><li><b>Fixed move army mission not to return from neutral regions</b></li><li><b>Fixed land, forest and mountains not being reset correctly on abdication</b></li><li><b>Fixed gatherers camps, their local storage can now store 1 of each item they can find in current mode.<br>Workers assigned here will work until local storage has all of the resources they can find</b></li></ul>Other:<ul><li>Slightly changed Troops stats</li><li>Militia can no longer be used to attack enemy</li><li>Reduced Spy troop gold cost</li><li>Work management buildings will start with output resources 'full' enabled</li><li>Reduced troops training time</li><li>Removed 50% progress start from gatherer when no resource is found</li></ul>"]},{VERSION:"v1.1.13",MESSAGE:["New Features:<ul><li><b>Added option to build multiple buildings at once</b></li></ul>Bug fixes:<ul><li><b>King of kingdom that has been conquered will no longer die</b></li><li><b>Fixed army effects not applying correctly to troops</b></li><li><b>Pasture will now add 'produced by' and 'used by' data to resources</b></li><li><b>Fixed some of the world map army sending bugs</b></li></ul>Other:<ul><li>World map display option will now be saved</li><li>Changed troops skirmish win calculation to linear function to benefit from army effects</li><li>Changed pig icon to one that looks more like a pig</li><li>Added new vegetable soup recipe that takes 1 berry and 1 mushroom (abdication required to enable)</li><li>Deep mine can now also mine stone</li></ul>"]},{VERSION:"v1.1.14",MESSAGE:["New Features:<ul><li><b>Added 'Royal Archives' royal perk</b></li><li><b>Added 'Barn' building for specialised storage of some crops<br>and a research project to unlock it</b></li><li><b>Added 'Golden fleece'</b></li><li><b>Tools can now be crafted also from copper, bronze and iron</b></li></ul>Other:<ul><li>'Stone' removed from tools names</li><li>Improved crafting recipe naming for some recipes</li></ul>"]},{VERSION:"v1.1.15",MESSAGE:["New Features:<ul><li><b>Added background music and new settings to control sound volume</b></li><li><b>Added different sound effect for invasion</b></li></ul>Bug fixes:<ul><li><b>Fixed one of the regions not being connected to the other one (Creurus land)</b></li></ul>Other:<ul><li>Each sound effect can be enabled/disabled in settings</li></ul>"]},{VERSION:"v1.1.16",MESSAGE:["New Features:<ul><li><b>Added Kitchen building and separate cooking order list in Crafting menu</b></li><li><b>Added Clay pit building</b></li><li><b>Added Tudor House building</b></li><li><b>Added clay, pottery and bricks resources</b></li></ul>Bug fixes:<ul><li><b>Research projects unlocked by royal perks will now correctly show as finished</b></li><li><b>Fixed adding research to queue over queue size</b></li></ul>Other:<ul><li>Reduced brushwood fuel crafting difficulty</li><li>Added Herbs and Berries to Barn storage options</li><li>Increased amount of alcohol added to tavern by 25%</li><li>Winery and Brewery now require pottery to build</li><li>Heating fuel used by housing building will now be affected by building size and heating efficiency</li><li>Bakery now needs to be researched separately after researching cooking</li><li>Increased food rations can now increase happiness more than regular rations <br>(1.5 rations up to 30 happiness and double rations up to 40 happiness)</li></ul>"]},{VERSION:"v1.1.17",MESSAGE:["Bug fixes:<ul><li><b>Digging will now unlock field region</b></li></ul>Other:<ul><li>Changed heritage points calculation to make it harder to acquire the more HPs player has</li><li>Abdicating through top right menu will now add RPs for wonder buildings</li><li>Pasture can breed animals into another pasture of the same type with free space for animals</li><li>Iron prospecting and processing technologies have been moved higher in the tech tree</li><li>Butchers will now acquire fur from animals</li><li>Planks can no longer be burned to heat houses</li><li>Added first winter tutorial</li><li>Improved village and forest tutorials</li></ul>"]},{VERSION:"v1.1.18",MESSAGE:["New Features:<ul><li><b>Added new food recipes: omelette and pie</b></li><li><b>Added new research for cooking recipes</b></li><li><b>Housing buildings can be disabled when there is no occupants inside</b></li></ul>Bug fixes:<ul><li><b>Fixed animals transforming to another animals when switching pasture type</b></li></ul>Other:<ul><li>Changed heritage points algorithm to allows for partial progress carry over</li><li>Decreased heritage points acquiring difficulty</li><li>Decreased land amount from heritage</li><li>Deep mine require ore deposits to recharge</li><li>Kitchen is now faster</li><li>Added resources list filter for empty and non active resources</li></ul>"]},{VERSION:"v1.1.19",MESSAGE:["New Features:<ul><li><b>Added troops speed stat that influence travel speed</b></li><li><b>It's now possible to cancel move, plunder and conquer missions before they reach their target</b></li><li><b>New troop: Horse archer</b></li></ul>Bug fixes:<ul><li><b>Ascension is no longer possible through abdication menu</b></li><li><b>Fixed heritage points xp calculation</b></li></ul>Other:<ul><li>Unite with the people now shows how much times it has been acquired</li><li>Added 'clear all' and 'select all' buttons to troops selection in mission window</li><li>AI will not attack player troops in neutral regions if diplomacy standing allows to</li><li>AI won't send militia to attack</li><li>AI returning army will try to conquer it's origin region if it has been conquered while army was on mission</li><li>AI capitals will keep being displayed after conquered <br>(this can prevent capitals from displaying at all before reset/abdication)</li><li>AI will try to reclaim their capital with high priority</li><li>AI and player missions can now evaluate paths to find shorter path during mission</li><li>AI and player missions will need to fight enemy if passing through enemy region</li></ul>"]},{VERSION:"v1.1.20",MESSAGE:["New Features:<ul><li><b>Housing buildings can be upgraded to the next tier building once it is unlocked</b></li></ul>Bug fixes:<ul><li><b>Added missing resource reservation entry for 'Tudor house' and moved kitchen reservation <br>to separate entry instead of included in crafting</b></li><li><b>Fixed headers entry text in effects management</b></li><li><b>Fixed strength calculation not including defender \"defense\" stat for first attacker troop</b></li><li><b>Fixed defense building mission from freezing the game</b></li></ul>Other:<ul><li>Doubled production output of brewery and winery</li><li>Reduced coins value of beer and wine</li></ul>"]},{VERSION:"v1.1.21",MESSAGE:["New Features:<ul><li><b>Added loggers camps building</b></li><li><b>Added simple summary page for buildings (management menu)</b></li><li><b>Added events engine with a few initial events (more to come in the future)</b></li></ul>Bug fixes:<ul><li><b>Fixed gatherer camps not to get stuck on resources</b></li><li><b>Fixed and improved win chance calculation</b></li></ul>Other:<ul><li>Gatherer camps will get small bonus chance to find resources that are not in the local storage already</li><li>Added log message after researching kitchen that says where to place orders</li><li>Improved butcher resources transport logic and  status reporting</li></ul>"]},{VERSION:"v1.1.22",MESSAGE:['New Features:<ul><li><b>Crafting to % percent of total storage</b></li></ul>Bug fixes:<ul><li><b>Added missing buff for loggers camp from Sacred grove</b></li><li><b>Fixed meteorite not to allow mining below 0</b></li><li><b>Fixed Unite with the people perk not displaying usages when RPs 100 or more</b></li></ul>Other:<ul><li>Added management option to disable "merchant arrived" logging</li></ul>']},{VERSION:"v1.1.23",MESSAGE:["Bug fixes:<ul><li><b>Blessing won't target Barn building anymore</b></li><li><b>'all on' button will now fill up partially staffed multi workers buildings</b></li></ul>Other:<ul><li>Changed basic tools icons (hammer, pickaxe, axe and shovel)</li><li>Bakery research now requires Scientific Method to be researched</li><li>Technical changes regarding buildings with multiple workers</li><li>Added 'reset' button to resource management window</li><li>Changed heritage menu display</li></ul>"]},{VERSION:"v1.1.24",MESSAGE:["New Features:<ul><li><b>It's now possible to dismiss army and recruits</b></li></ul>Bug fixes:<ul><li><b>Fixed Cooking % crafting order showing warnings for missing resources</b></li><li><b>Fixed gatherer camps not being able to collect more than 1 of each resource in each cycle</b></li><li><b>Changed ascension temple stages cost (and number of stages) to avoid icons overflow building box.<br>Total cost remains unchanged</b></li></ul>Other:<ul><li>Added management option to switch default gatherers mode</li><li>Changed Orchard status text to avoid confusion</li><li>Improved Butcher status reporting and added local storage to details list</li><li>Doubled pasture animals produce progress each tick</li><li>Nation name in world map will include Kongregate username by default</li></ul>"]},{VERSION:"v1.1.25",MESSAGE:["Bug fixes:<ul><li><b>Baby boom prayer will now also affect Tudor house</b></li></ul>Other:<ul><li>It's now possible to add crafting and cooking orders to the top of the list by shift clicking on the recipe</li><li>Added help tooltips to crafting and cooking tabs</li><li>Fixed text align to icons for food priority</li><li>Added upgrades to loggers camp</li><li>Added local storage display to loggers camp details</li><li>In build window header with filters and number of buildings will follow when buildings are scrolled</li></ul>"]},{VERSION:"v1.2.0",MESSAGE:["<b>The Sea Update!</b><br><br>New Features:<ul><li><b>Reworked sea region with many new buildings</b></li><li><b>New sea based events and missions</b></li><li><b>New tools resources</b></li><li><b>New Royal perk to unlock</b></li></ul>Bug fixes:<ul><li><b>Fixed deep mine mining below 0 resources</b></li><li><b>Changed recipes filters to also match recipe name</b></li></ul>Other:<ul><li>Changed missions to follow shortest path in terms of real distance and not number of regions 'hops'</li><li>Great Lighthouse RP bonus reduced but bonus effects added that affect some sea buildings and ships</li></ul>"]},{VERSION:"v1.2.1",MESSAGE:["Bug fixes:<ul><li><b>Fixed navy related data being \"NaN\"</b></li><li><b>Fixed doubled report for sea conquer mission</b></li><li><b>Fixed sea missions travel speed being influenced by land troops</b></li><li><b>Fixed 'sea move' mission button not visible when no land troops are present</b></li><li><b>Fixed fight reports breaking after page reload</b></li><li><b>QUICKFIX: Fixed pre 1.2.0 save files loading</b></li></ul>Other:<ul><li>Added 'cancel mission' to all sea missions</li><li>Added tooltip to ships in navy tab and shipyard window</li><li>It's now possible to decommission navy units</li><li>Added total cargo display to the sea mission description</li></ul>"]},{VERSION:"v1.2.2",MESSAGE:["Bug fixes:<ul><li><b>Fixed pirates sea event freezing the game</b></li><li><b>Fixed sea cartography research freezing the game</b></li></ul>"]},{VERSION:"v1.2.3",MESSAGE:["Bug fixes:<ul><li><b>Fixed boat builder and shipyard invalid values freezing game</b></li><li><b>Fixed fisher huts being stuck on waiting for fish after update</b></li><li><b>Added logic to clear corrupted save of pirates and pirates base events</b></li><li><b>Fixed expedition not consuming correct amount of resources</b></li><li><b>Probably fixed negative amount of mountains from expeditions</b></li><li><b>Fixed shipyard turning off on load and destroying employed people</b></li><li><b>Fixed ascension temple being available too soon</b></li></ul>Other:<ul><li>Improved game error handling to reduce chance for game freezing (game will now pause due to internal errors)</li><li>Land discovered on expeditions will be preserved through abdication</li><li>Expedition mission cargo is also restricted by the amount of food required for the mission</li><li>Ships no longer cost food on missions</li><li>Reduced small components wraps in resources, crafting and cooking tabs</li><li>Improved mission progress display to be calculated based on total distance to travel and not 20% per region</li></ul>"]},{VERSION:"v1.2.4",MESSAGE:["Bug fixes:<ul><li><b>Fixed some buildings showing error message on upgrade</b></li><li><b>Fixed butcher being stuck on waiting for fur warehouse space</b></li><li><b>Fixed mission movement attack friendly region when passing by sometimes</b></li><li><b>Fixed port size calculation when selecting ship to build</b></li><li><b>Fixed loggers camp consuming land on upgrade</b></li><li><b>Buildings from royal perks will now take correct amount of land</b></li><li><b>QUICKFIX: Additional fix for buildings upgrading issues</b></li></ul>Other:<ul><li>'Village' text changes depending on population cap</li><li>Build window will now focus text filter input by default</li><li>Added effective speed display to mission description</li></ul>"]},{VERSION:"v1.2.5",MESSAGE:["New Features:<ul><li><b>Added new housing building</b></li><li><b>Added new research building</b></li></ul>Bug fixes:<ul><li><b>Fixed forest and mountains from expedition not being saved</b></li><li><b>Fixed food cargo space being required for sea missions other than expeditions</b></li><li><b>Fixed sea plunder and sea conquer icons not displayed in world map buttons</b></li><li><b>Fixed NaN cargo value for some sea missions</b></li><li><b>Fixed cooking menu not showing number of items being crafted</b></li></ul>Other:<ul><li>Added circle ticker for next day</li><li>It's now possible to dismiss market offers</li><li>Added sounds for season changes</li><li>Crafting type selection won't change when switching tabs</li><li>Market filter selection won't change when switching tabs</li><li>When a spy is killed it will generate a fight report so that players can remember the last known army size</li><li>Added display option to change player regions colour</li></ul>"]},{VERSION:"v1.2.6",MESSAGE:["Bug fixes:<ul><li><b>Added missing settlement resource reservation</b></li><li><b>Fixed forest found on expeditions reducing land</b></li></ul></ul>"]},{VERSION:"v1.3.0",MESSAGE:["<b>The Happiness Update!</b><br><br>New Features:<ul><li><b>Reworked happiness system</b></li><li><b>Added new prayer</b></li><li><b>Added tax collector building and tax settings to management</b></li><li><b>Added new resources</b></li><li><b>New Royal perks</b></li></ul>Bug fixes:<ul><li><b>Fixed orchard grown crops switching</b></li><li><b>Added additional value checks for boat builder and shipyard</b></li><li><b>Fixed world map issue that reset world map progress</b></li></ul></ul>"]},{VERSION:"v1.3.1",MESSAGE:["Bug fixes:<ul><li><b>Fixed happiness effects calculation causing NaN happiness value</b></li><li><b>Added additional check for invalid value in building progress data</b></li></ul></ul>"]},{VERSION:"v1.3.2",MESSAGE:["Bug fixes:<ul><li><b>Fixed fired worker log message reporting wrong building</b></li><li><b>Fixed deep mine not starting after upgrade is finished</b></li><li><b>Fixed tavern happiness effect causing NaN and not clearing after tavern is disabled</b></li><li><b>Fixed fur clothes happiness effect getting stuck</b></li></ul>Other:<ul><li>Happiness management show duration setting will now save it's state</li><li>Surplus animals added to storage will be sent to butchers</li><li>Reduced refugees events chance</li><li>Combinable buildings that are compatible will no longer require confirmation</li><li>Added auto merge option that combines all compatible buildings in the region</li><li>Limited number of log entries being saved to 100</li><li>Added error reports that show more error information for better reporting<br>(this will be extended with option to send error reports to the server)</li></ul>"]},{VERSION:"v1.3.3",MESSAGE:["Bug fixes:<ul><li><b>Fixed festivals being blocked after abdication due to locked resources</b></li><li><b>Fixed sea missions calculating failing when previous mission removed the event</b></li><li><b>Fixed pirates base negative happiness effect not removed after defeating pirates base</b></li></ul>Other:<ul><li>Reduced gem chance for deep mine</li></ul>"]},{VERSION:"v1.3.4",MESSAGE:["New Features:<ul><li><b>Added new options to world map region build mission (roads, watchtower, guard towers and harbour)</b></li></ul>Bug fixes:<ul><li><b>Fixed settlement buildings consuming food faster than restocking causing famine while there was food available</b></li></ul>Other:<ul><li>Added action buttons to switch all workshops to crafting or researching</li><li>Added new recipes to craft swords, shields from bronze and iron</li><li>Changed heavy armor cost from copper to bronze</li></ul>"]},{VERSION:"v1.3.5",MESSAGE:["Bug fixes:<ul><li><b>Fixed sea missions causing type error while calculating distance</b></li></ul>"]},{VERSION:"v1.3.6",MESSAGE:["Bug fixes:<ul><li><b>Fixed stuck AI missions</b></li></ul>Other:<ul><li>Added text reason for why mission cannot be started to most reasons</li></ul>"]},{VERSION:"v1.3.7",MESSAGE:["Bug fixes:<ul><li><b>Fixed building buffing affecting every building of that type after reloading</b></li><li><b>Fixed disabled housing building accepting occupants but not resuming resources consumption</b></li><li><b>Probably fixed unexpected negative fur clothes issue (could not reproduce the issue)</b></li></ul>Other:<ul><li>AI can no longer build new guard towers</li><li>Changed watchtowers cost from nails to bricks</li></ul>"]},{VERSION:"v1.3.8",MESSAGE:['New Features:<ul><li><b>Added builders guild building</b></li></ul>Bug fixes:<ul><li><b>Fixed tax collector demolishing decreasing faith cap</b></li><li><b>Fixed corrupted missions data loading and freezing game</b></li><li><b>Fixed error in builders guild research</b></li><li><b>Fixed "Arrange" not working</b></li></ul>Other:<ul><li>Upgraded Angular version 8->10</li></ul>']},{VERSION:"v1.3.9",MESSAGE:["Bug fixes:<ul><li><b>Fixed a bug allowing to build fraction of buildings</b></li><li><b>Fixed two regions border connection working only in one direction</b></li><li><b>Marketplace should no longer report removed workers</b></li><li><b>Fixed some log typos</b></li><li><b>Fixed stuck Fur clothes negative happiness effect</b></li><li><b>Fixed world map build missions disappearing after loading game save</b></li></ul>"]},{VERSION:"v1.3.10",MESSAGE:["Bug fixes:<ul><li><b>Refugees won't occupy disabled houses</b></li><li><b>Fixed one of the borders above south lake</b></li><li><b>Fixed doubled text on heritage page</b></li></ul>Other:<ul><li>Game can now scale with screen size</li><li>Upgraded Angular version 10->12</li><li>Made changes to allow for standalone offline builds</li></ul>"]}];let yS=(()=>{class e{constructor(e,t,i){this.modalService=e,this.servicesService=t,this.router=i,this.tutorialsEnabled=!1,this.villageTutorialState=0,this.forestTutorialState=0,this.fieldTutorialState=0,this.mountainsTutorialState=0,this.plateauTutorialState=0,this.seaTutorialState=0,this.resourcesTutorialState=0,this.winterTutorialState=0,t.addService(Zf.TUTORIAL,this)}getName(){return"TutorialService"}load(e){this.villageTutorialState=void 0!==e.villageTutorialState?e.villageTutorialState:0,this.forestTutorialState=void 0!==e.forestTutorialState?e.forestTutorialState:0,this.resourcesTutorialState=void 0!==e.resourcesTutorialState?e.resourcesTutorialState:0,this.fieldTutorialState=void 0!==e.fieldTutorialState?e.fieldTutorialState:0,this.mountainsTutorialState=void 0!==e.mountainsTutorialState?e.mountainsTutorialState:0,this.plateauTutorialState=void 0!==e.plateauTutorialState?e.plateauTutorialState:0,this.seaTutorialState=void 0!==e.seaTutorialState?e.seaTutorialState:0,this.winterTutorialState=void 0!==e.winterTutorialState?e.winterTutorialState:0}save(){return{villageTutorialState:this.villageTutorialState,forestTutorialState:this.forestTutorialState,resourcesTutorialState:this.resourcesTutorialState,fieldTutorialState:this.fieldTutorialState,mountainsTutorialState:this.mountainsTutorialState,plateauTutorialState:this.plateauTutorialState,seaTutorialState:this.seaTutorialState,winterTutorialState:this.winterTutorialState}}reset(e,t){}checkRegionTutorial(e){if(this.tutorialsEnabled)switch(e){case Kf.VILLAGE:if(0===this.villageTutorialState){this.startTutorial(Pm.VILLAGE_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.villageTutorialState=t})}break;case Kf.FOREST:if(0===this.forestTutorialState){this.startTutorial(Pm.FOREST_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.forestTutorialState=t})}break;case Kf.FIELD:if(0===this.fieldTutorialState){this.startTutorial(Pm.FIELD_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.fieldTutorialState=t})}break;case Kf.MOUNTAINS:if(0===this.mountainsTutorialState){this.startTutorial(Pm.MOUNTAINS_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.mountainsTutorialState=t})}break;case Kf.PLATEAU:if(0===this.plateauTutorialState){this.startTutorial(Pm.PLATEAU_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.plateauTutorialState=t})}break;case Kf.SEA:if(0===this.seaTutorialState){this.startTutorial(Pm.SEA_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.seaTutorialState=t})}}}checkResourcesTutorial(){if(0===this.resourcesTutorialState){this.startTutorial(Pm.RESOURCES_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.resourcesTutorialState=t})}}enableTutorials(){this.tutorialsEnabled=!0}resetTutorials(){this.villageTutorialState=0,this.forestTutorialState=0,this.fieldTutorialState=0,this.mountainsTutorialState=0,this.plateauTutorialState=0,this.seaTutorialState=0,this.resourcesTutorialState=0,this.winterTutorialState=0,this.router.url.endsWith("village")?this.checkRegionTutorial(Kf.VILLAGE):this.router.url.endsWith("forest")?this.checkRegionTutorial(Kf.FOREST):this.router.url.endsWith("field")?this.checkRegionTutorial(Kf.FIELD):this.router.url.endsWith("mountains")?this.checkRegionTutorial(Kf.MOUNTAINS):this.router.url.endsWith("plateau")?this.checkRegionTutorial(Kf.PLATEAU):this.router.url.endsWith("sea")?this.checkRegionTutorial(Kf.SEA):this.router.url.endsWith("resources")?this.checkResourcesTutorial():this.modalService.info("Tutorials have been enabled")}startTutorial(e){this.modalService.setTutorial(e),this.servicesService.getService(Zf.TICKER).stop(),this.modalService.openTutorialModal(e[0].position)}showCurrentViewTutorial(){this.router.url.endsWith("village")?this.startTutorial(Pm.VILLAGE_TUTORIAL):this.router.url.endsWith("forest")?this.startTutorial(Pm.FOREST_TUTORIAL):this.router.url.endsWith("field")?this.startTutorial(Pm.FIELD_TUTORIAL):this.router.url.endsWith("mountains")?this.startTutorial(Pm.MOUNTAINS_TUTORIAL):this.router.url.endsWith("plateau")?this.startTutorial(Pm.PLATEAU_TUTORIAL):this.router.url.endsWith("sea")?this.startTutorial(Pm.SEA_TUTORIAL):this.router.url.endsWith("resources")?this.startTutorial(Pm.RESOURCES_TUTORIAL):this.modalService.info("There is no tutorial for this tab")}checkWinterTutorial(){if(0===this.winterTutorialState){this.startTutorial(Pm.WINTER_TUTORIAL);const e=this.modalService.registerForTutorialResponse().subscribe(t=>{e.unsubscribe(),this.winterTutorialState=t})}}}return e.\u0275fac=function(t){return new(t||e)(gs(em),gs(Jf),gs(af))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),AS=(()=>{class e{constructor(e,t,i,s,r){this.servicesService=e,this.modalService=t,this.logService=i,this.calendarService=s,this.tutorialsService=r,this.flags=[],this.gameState=0,this.abdicationLevel=0,this.gameStartedYear=1,this.devMessage=Number.MAX_SAFE_INTEGER,this.headerRowsSubject=new b,this.demolishReturn=nS.DEMOLITION_RETURN,this.servicesService.addService(Zf.GAME,this)}init(){Am.production?this.flags=[]:(this.flags=[],Object.keys(Mf).filter(e=>!isNaN(e)).map(e=>Number(e)).forEach(e=>{this.flags.push(e)}))}getName(){return"GameService"}load(e){this.flags=e.flags,this.gameState=e.gameState,this.demolishReturn=e.demolishReturn,this.devMessage=e.devMessage,this.abdicationLevel=e.abdicationLevel,this.gameStartedYear=void 0!==e.gameStartedYear?e.gameStartedYear:1}save(){return{flags:this.flags,gameState:this.gameState,demolishReturn:this.demolishReturn,devMessage:this.devMessage,abdicationLevel:this.abdicationLevel,gameStartedYear:this.gameStartedYear}}reset(e,t){this.flags=[],this.gameState=0,this.gameStartedYear=this.calendarService.getYear(),this.demolishReturn=nS.DEMOLITION_RETURN,this.init(),e&&(this.devMessage=Number.MAX_SAFE_INTEGER,this.abdicationLevel=0,this.gameStartedYear=1),t&&(this.abdicationLevel=0)}isEnabled(e){return this.flags.includes(e)}enable(e){this.flags.includes(e)||this.flags.push(e)}disable(e){this.flags.includes(e)&&this.flags.splice(this.flags.indexOf(e),1)}setGameState(e){this.gameState=e}getGameState(){return this.gameState}tick(e){0===this.getGameState()&&(this.displayWelcomeModal(),this.addStartBoost(),this.tutorialsService.checkRegionTutorial(Kf.VILLAGE),this.setGameState(1)),this.displayDevMessage()}displayWelcomeModal(){this.modalService.info("Welcome to <b>Villager Kings</b><br>You start as a leader of a small village.<br>Will you manage to lead your people to greatness? <br>First thing you need to focus on is to make sure that your people will survive winter.<br>You will need to increase food production and have some wood to heat houses.<br>Remember that winter is not the only threat to your people!<br>Good luck!");const e=this.modalService.registerForCloseModal().subscribe(()=>{this.devMessage===Number.MAX_SAFE_INTEGER&&(this.devMessage=0),e.unsubscribe()})}displayDevMessage(){const e=CS.length;this.devMessage<e&&(this.showDevNotes(),this.devMessage=e)}showDevNotes(){this.modalService.open(Pf.CHANGELOG)}addStartBoost(){Nm&&this.servicesService.getEffectsService().addBuildingEffect(new nm(Nm.name,Nm.building,Nm.effect,Nm.duration))}getAbdicationLevel(){return this.abdicationLevel}incrementAbdicationLevel(){this.abdicationLevel+=1,this.abdicationLevel>=7&&this.logService.mystical("As you finish last wonder building strange thoughts of ancient structures appear in your head. Who knows what purpose this building serve")}updateHeader(e){this.headerRowsSubject.next(e)}registerForHeaderRowsChange(){return this.headerRowsSubject.asObservable()}getGameStartedYear(){return this.gameStartedYear}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(em),gs(IS),gs(OS),gs(yS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),NS=(()=>{class e{constructor(e,t,i,s,r){this.servicesService=e,this.effectsService=t,this.gameService=i,this.optionsService=s,this.logService=r,this.land=sS.START_LAND,this.forest=sS.START_FOREST,this.mountains=sS.START_MOUNTAINS,this.takenLand=0,this.ores=[[Df.COAL,0],[Df.GOLD_ORE,0],[Df.SILVER_ORE,0],[Df.COPPER_ORE,0],[Df.TIN_ORE,0],[Df.IRON_ORE,0]],this.forestGrowTick=0,this.forestGrowTicks=sS.FOREST_GROW_TICKS,this.forestGrowPercentage=sS.FOREST_GROW_PERCENTAGE,this.defaultForestOptions=new mS(0,!1,25,!0,0),this.forestOptions=new mS(0,!1,25,!0,0),this.servicesService.addService(Zf.LAND,this)}getName(){return"LandService"}load(e){this.land=e.land,this.forest=e.forest,this.mountains=e.mountains,this.forestGrowTick=e.forestGrowTick,this.takenLand=e.takenLand,e.forestLandLimit&&(this.forestOptions=new mS(0,!1,e.forestLandLimit,!0,0)),e.forestOptions&&(this.forestOptions=e.forestOptions),this.ores=e.ores}save(){return{land:this.land,forest:this.forest,mountains:this.mountains,forestGrowTick:this.forestGrowTick,takenLand:this.takenLand,forestOptions:this.forestOptions,ores:this.ores}}reset(e,t){if(this.land=sS.START_LAND,this.forest=sS.START_FOREST,this.mountains=sS.START_MOUNTAINS,this.takenLand=0,(!this.optionsService.getOption(Xf.KEEP_MANAGEMENT_SETTINGS_ON_RESET)||e)&&(this.forestOptions=new mS(0,!1,25,!0,0)),!e&&!t){const e=this.servicesService.getWorldService();this.increaseLand(e.getDiscoveredLand(),!0),this.increaseForest(e.getDiscoveredForest(),!1),this.increaseMountains(e.getDiscoveredMountains())}this.ores=[[Df.COAL,0],[Df.GOLD_ORE,0],[Df.SILVER_ORE,0],[Df.COPPER_ORE,0],[Df.TIN_ORE,0],[Df.IRON_ORE,0]]}tick(e){this.growForest()}growForest(){if(this.forestGrowTick<this.forestGrowTicks&&(this.forestGrowTick+=1),this.forestGrowTick===this.forestGrowTicks){let e=Math.floor(this.forestGrowPercentage*this.forest*(1+this.effectsService.getNatureEffectsValue()/100));e<sS.MINIMAL_FOREST_GROWTH&&(e=sS.MINIMAL_FOREST_GROWTH),this.increaseForest(e),this.forestGrowTick=0}}removeForest(e){this.forest>=e&&(this.forest-=e)}reduceForest(e){const t=this.forest;return this.forest-e>=this.forestOptions.forestSizeReserved&&(this.forest-=e,this.gameService.isEnabled(Mf.FORESTER)||(t>=400&&this.forest<400&&this.logService.warning("There are less than 400 trees in the forest!"),t>=250&&this.forest<250&&this.logService.warning("There are less than 250 trees in the forest!"),t>=100&&this.forest<100&&(this.logService.warning("Critical forest size!"),this.logService.warning("There are less than 100 trees in the forest!"))),!0)}increaseForest(e,t=!0){if(t){let t=0;this.forestOptions.landSizeRuleEnabled&&(t=this.forestOptions.landSizeRule),t<0&&(t=0);let i=this.land-t;return i<0&&(i=0),i-e>=0?(this.forest+=e,this.land-=e,0):(this.forest+=i,this.land-=i,e-i)}return this.forest+=e,0}removeLand(e){this.land>=e&&(this.land-=e)}reduceLand(e){let t=0;return this.forestOptions.landSizeRuleEnabled&&(t=this.forestOptions.landSizeRule),t<0&&(t=0),this.land-t-e>=0&&(this.land-=e,!0)}increaseLand(e,t=!1){return this.land+=e,t||(this.takenLand-=e),!0}increaseMountains(e){return this.mountains+=e,!0}getForest(){return this.forest}decreaseLand(e){if(!(this.land-e>=0))return e-this.land;this.takenLand+=e,this.land-=e}hasLand(e){return this.land-e>=0}getLand(){return this.land}getMountains(){return this.mountains}hasMountains(e){return this.mountains-e>=0}removeMountains(e){this.mountains>=e&&(this.mountains-=e)}decreaseMountains(e){if(!(this.mountains-e>=0))return e-this.mountains;this.mountains-=e,this.takenLand+=e}getOre(e){return this.ores.find(t=>t[0]===e)[1]}hasOre(e,t){return this.ores.find(t=>t[0]===e)[1]>=t}increaseOre(e,t){this.ores.find(t=>t[0]===e)[1]+=t}decreaseOre(e,t){const i=this.ores.find(t=>t[0]===e);if(i[1]>=t)return i[1]-=t,0;{const e=t-i[1];return i[1]=0,e}}getTakenLand(){return this.takenLand}takeLand(e){this.land-=e,this.takenLand+=e}getForestOptions(){return this.gameService.isEnabled(Mf.FORESTER)?this.forestOptions:this.defaultForestOptions}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(bS),gs(AS),gs(vS),gs(IS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _S=(()=>(function(e){e[e.TEXT=0]="TEXT",e[e.PROGRESS_BAR=1]="PROGRESS_BAR",e[e.BUTTON=2]="BUTTON",e[e.CHECKBOX=3]="CHECKBOX",e[e.BUTTON_CHECKBOX=4]="BUTTON_CHECKBOX",e[e.TWO_BUTTON=5]="TWO_BUTTON",e[e.DROPDOWN=6]="DROPDOWN",e[e.ICON=7]="ICON"}(_S||(_S={})),_S))();class wS{constructor(e,t){this.valueType=e,this.value=t}static emptyValue(){return new wS(_S.TEXT,"")}static textValue(e){return new wS(_S.TEXT,e)}static progressValue(e,t=""){return new wS(_S.PROGRESS_BAR,{value:e,label:t})}static buttonValue(e,t){return new wS(_S.BUTTON,{buttonText:e,callbackValue:t})}static buttonCheckboxValue(e,t,i,s,r){return new wS(_S.BUTTON_CHECKBOX,{buttonText:e,callbackValue:t,checkboxState:s,checkboxLabel:i,checkboxCallbackValue:r})}static checkboxValue(e,t,i){return new wS(_S.CHECKBOX,{checkboxState:t,checkboxLabel:e,checkboxCallbackValue:i})}static twoButtonValue(e,t,i,s,r){return new wS(_S.TWO_BUTTON,{button1Text:e,callback1Value:t,textBetween:i,button2Text:s,callback2Value:r})}static dropdownValue(e,t){return new wS(_S.DROPDOWN,{values:e,selected:t})}static iconValue(e){return new wS(_S.ICON,e)}getValueType(){return this.valueType}getValue(){return this.value}}var PS=(()=>(function(e){e[e.FIRST=0]="FIRST",e[e.SECOND=1]="SECOND",e[e.THIRD=2]="THIRD",e[e.FOURTH=3]="FOURTH"}(PS||(PS={})),PS))();class MS{constructor(e,t,i,s){this.name=e,this.effect=t,this.duration=i,this.cost=s}}class LS{constructor(e,t,i,s,r,n,o,a){this.servicesService=i,this.id=e,this.buildingType=t,this.demolishable=n,this.settings=s,this.stoppable=o,this.working=r,this.level=a,this.size=s.SIZE,this.complexity=s.COMPLEXITY,i&&(this.resourcesService=i.getResourcesService(),this.effectsService=i.getEffectsService(),this.happinessService=i.getHappinessService(),this.gameService=i.getGameService(),this.logService=i.getLogService(),this.modalService=i.getModalService(),this.weatherService=i.getWeatherService())}build(){return this.startProduction(),this}getBuildingId(){return this.id}callback(e){}finishDemolish(){Array.from(this.getCost().entries()).forEach(e=>this.resourcesService.increaseResource(e[0],Math.floor(.3*e[1]),"Demolition"))}fireWorker(){return!!this.working&&(this.resourcesService.fireWorker(),this.working=!1,!0)}getBuildingType(){return this.buildingType}getComplexity(){return this.complexity}getCost(){const e=new Map;return this.settings.COST.forEach(t=>e.set(t.resource,t.amount)),e}getDescription(){return this.settings.DESCRIPTION}hasDetails(){return!0}getDetails(){let e="";(this.getBuildingLevel()>1||this.hasUpgrade())&&(e+="building level: "+this.level+"<br>");let t=0;return 1===this.level||this.buildingType===Lf.CONSTRUCTION?t=this.settings.BASE_POWER:this.settings.UPGRADES&&(t=this.settings.UPGRADES[this.level-2].BASE_POWER),e+="building base power: "+t+"<br>",this.getPower()%1==0?e+="building power: "+this.getPower()+"<br>":e+="building power: "+Qf.round(this.getPower(),2)+"<br>",0!==this.getPermanentEffects()&&(e+="permanent effects: "+this.getPermanentEffects()+"%<br>"),0!==this.getEffects()&&(e+="temporary effects: "+this.getEffects()+"%<br>"),0!==this.getHappinessEffect()&&(e+="happiness effects: "+this.getHappinessEffect()+"%<br>"),0!==this.getWeatherMultiplier()&&(e+="weather multiplier: "+this.getWeatherMultiplier()+"%<br>"),e}getEffects(){return this.effectsService.getBuildingEffectsValue(this.buildingType,!1,this.id)}getPermanentEffects(){return this.effectsService.getBuildingEffectsValue(this.buildingType,!0)}getHappinessEffect(){return this.happinessService.getHappinessEffect()}getWeatherMultiplier(){const e=(this.settings.WEATHER?this.settings.WEATHER:[]).find(e=>this.weatherService.isWeather(e.weather));return e?e.effect:0}getDisplayableEffectsValue(){let e=0;return 1===this.level||this.buildingType===Lf.CONSTRUCTION?e=this.settings.BASE_POWER:this.settings.UPGRADES&&(e=this.settings.UPGRADES[this.level-2].BASE_POWER),Number(Qf.round(100*(this.getPower()/e-1),2))}getPower(){let e=0;return 1===this.level||this.buildingType===Lf.CONSTRUCTION?e=this.settings.BASE_POWER:this.settings.UPGRADES&&(e=this.settings.UPGRADES[this.level-2].BASE_POWER),e*(1+(this.getPermanentEffects()+this.getEffects()+this.getHappinessEffect())/100)*(1+this.getWeatherMultiplier()/100)}isUsedUp(){return!1}getLine(e){switch(e){case PS.FIRST:case PS.SECOND:case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}getName(){return Qf.titleCase(Qf.prepareBuildingName(this.buildingType))}getSize(){return this.size}buildOnMountain(){return!1}getWorkers(){return this.working?1:0}hireWorker(){return!(this.working||!this.resourcesService.hireWorker()||(this.working=!0,0))}isDemolishable(){return this.demolishable}isStoppable(){return this.stoppable}isComplexManagement(){return!1}getWorkSettings(){return null}setWorkSettings(e){}isWorking(){return this.working}prepareDemolish(){return this.stopProduction(),!0}startProduction(){return!(this.working||!this.resourcesService.hireWorker()||(this.working=!0,0))}stopProduction(){this.working&&(this.resourcesService.fireWorker(),this.working=!1)}tick(e){}isCombinable(){return!1}isSplittable(){return!1}hasBuff(){return this.settings.BUFF}isBuffed(){return!!this.hasBuff()&&this.effectsService.getBuildingEffects(this.buildingType).filter(e=>e.buff===this.id).length>0}getBuff(){if(this.settings.BUFF){const e=new Map;return this.settings.BUFF.cost.forEach(t=>e.set(t.resource,t.amount)),new MS(this.settings.BUFF.name,this.settings.BUFF.effect,this.settings.BUFF.duration,e)}return null}hasUpgrade(){if(this.settings.UPGRADES&&this.settings.UPGRADES.length>=this.getBuildingLevel()){if(this.settings.UPGRADES[this.getBuildingLevel()-1].PREREQUISITES){let e=!0;return this.settings.UPGRADES[this.getBuildingLevel()-1].PREREQUISITES.forEach(t=>{this.gameService.isEnabled(t)||(e=!1)}),e}return!0}return!1}getUpgradeSettings(){return this.settings.UPGRADES&&this.settings.UPGRADES.length>=this.getBuildingLevel()?this.settings.UPGRADES[this.getBuildingLevel()-1]:null}getUpgradeCost(){const e=new Map;return this.hasUpgrade()&&this.settings.UPGRADES[this.level-1].COST.forEach(t=>e.set(t.resource,t.amount)),e}setBuildingLevel(e){this.level=e}getBuildingLevel(){return this.level}getBuildingData(){return null}setBuildingData(e){}}class DS extends LS{constructor(e,t,i=null,s,r,n,o,a,c,l,u){super(e,t,i,s,r,n,o,a),this.progress=c,this.buildingComplexity=l,this.workingAt=u}getProgress(){return this.progress}increaseProgress(e){this.progress+=e/this.buildingComplexity,this.progress>100&&(this.progress=100)}getWorkingAt(){return this.workingAt}getComplexity(){return 0}}class xS extends DS{constructor(e=null,t,i,s,r=1,n=1,o=0,a=!1){super(t,Lf.DECONSTRUCTION,e,nS.DECONSTRUCTION_SITE,a,!1,!0,1,o,r,s),this.region=i,this.buildingSize=n,this.servicesService&&(this.regionService=e.getServiceByRegion(i))}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:return wS.textValue("deconstructing "+Qf.prepareBuildingName(this.workingAt));case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}tick(){this.progress>=100&&this.regionService.finishDeconstruction(this),this.working&&(this.progress<100?(this.progress+=this.getPower()/this.buildingComplexity,this.progress>100&&(this.progress=100)):this.regionService.finishDeconstruction(this))}toJSON(){return{id:this.id,buildingType:this.buildingType,region:this.region,deconstructing:this.workingAt,buildingComplexity:this.buildingComplexity,progress:this.progress,working:this.working,buildingSize:this.buildingSize}}getSize(){return this.buildingSize}prepareDemolish(){return!1}finishDemolish(){}getBuildingBeingDemolished(){return this.workingAt}}function kS(e){return null!=e&&"false"!=`${e}`}function FS(e){return e instanceof La?e.nativeElement:e}function US(e,t,i,r){return s(i)&&(r=i,i=void 0),r?US(e,t,i).pipe(A(e=>c(e)?r(...e):r(e))):new v(s=>{HS(e,t,function(e){s.next(arguments.length>1?Array.prototype.slice.call(arguments):e)},s,i)})}function HS(e,t,i,s,r){let n;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){const s=e;e.addEventListener(t,i,r),n=()=>s.removeEventListener(t,i,r)}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){const s=e;e.on(t,i),n=()=>s.off(t,i)}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){const s=e;e.addListener(t,i),n=()=>s.removeListener(t,i)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let n=0,o=e.length;n<o;n++)HS(e[n],t,i,s,r)}s.add(n)}class GS extends h{constructor(e,t){super()}schedule(e,t=0){return this}}class BS extends GS{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,s=!1;try{this.work(e)}catch(r){s=!0,i=!!r&&r||new Error(r)}if(s)return this.unsubscribe(),i}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,s=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==s&&i.splice(s,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let WS=(()=>{class e{constructor(t,i=e.now){this.SchedulerAction=t,this.now=i}schedule(e,t=0,i){return new this.SchedulerAction(this,e).schedule(i,t)}}return e.now=()=>Date.now(),e})();class VS extends WS{constructor(e,t=WS.now){super(e,()=>VS.delegate&&VS.delegate!==this?VS.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return VS.delegate&&VS.delegate!==this?VS.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const zS=new class extends VS{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,s=-1,r=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++s<r&&(e=t.shift()));if(this.active=!1,i){for(;++s<r&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends BS{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let YS=1;const KS=Promise.resolve(),jS={};function $S(e){return e in jS&&(delete jS[e],!0)}const QS={setImmediate(e){const t=YS++;return jS[t]=!0,KS.then(()=>$S(t)&&e()),t},clearImmediate(e){$S(e)}},qS=(new class extends VS{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,s=-1,r=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++s<r&&(e=t.shift()));if(this.active=!1,i){for(;++s<r&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends BS{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=QS.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(QS.clearImmediate(t),e.scheduled=void 0)}}),new VS(BS));class XS{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new ZS(e,this.durationSelector))}}class ZS extends U{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1}_next(e){if(this.value=e,this.hasValue=!0,!this.throttled){let i;try{const{durationSelector:t}=this;i=t(e)}catch(t){return this.destination.error(t)}const s=H(i,new F(this));!s||s.closed?this.clearThrottle():this.add(this.throttled=s)}}clearThrottle(){const{value:e,hasValue:t,throttled:i}=this;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),t&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function JS(e){return!c(e)&&e-parseFloat(e)+1>=0}function eE(e){const{index:t,period:i,subscriber:s}=e;if(s.next(t),!s.closed){if(-1===i)return s.complete();e.index=t+1,this.schedule(e,i)}}function tE(e,t=qS){return function(e){return function(t){return t.lift(new XS(e))}}(()=>function(e=0,t,i){let s=-1;return JS(t)?s=Number(t)<1?1:Number(t):y(t)&&(i=t),y(i)||(i=qS),new v(t=>{const r=JS(e)?e:+e-i.now();return i.schedule(eE,r,{index:0,period:s,subscriber:t})})}(e,t))}function iE(e){return t=>t.lift(new sE(e))}class sE{constructor(e){this.notifier=e}call(e,t){const i=new rE(e),s=H(this.notifier,new F(i));return s&&!i.seenValue?(i.add(s),t.subscribe(i)):i}}class rE extends U{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function nE(e,t){return new v(t?i=>t.schedule(oE,0,{error:e,subscriber:i}):t=>t.error(e))}function oE({error:e,subscriber:t}){t.error(e)}new class extends VS{}(class extends BS{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}});class aE{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return xh(this.value);case"E":return nE(this.error);case"C":return Kh()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new aE("N",e):aE.undefinedValueNotification}static createError(e){return new aE("E",void 0,e)}static createComplete(){return aE.completeNotification}}let cE;aE.completeNotification=new aE("C"),aE.undefinedValueNotification=new aE("N",void 0);try{cE="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(d){cE=!1}let lE,uE,hE=(()=>{class e{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function(e){return e===eh}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!cE)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return e.\u0275fac=function(t){return new(t||e)(gs(pl))},e.\u0275prov=de({factory:function(){return new e(gs(pl))},token:e,providedIn:"root"}),e})();function dE(e){return function(){if(null==lE&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>lE=!0}))}finally{lE=lE||!1}return lE}()?e:!!e.capture}const gE=new ji("cdk-dir-doc",{providedIn:"root",factory:function(){return ps(cu)}});let pE=(()=>{class e{constructor(e){if(this.value="ltr",this.change=new Vc,e){const t=e.documentElement?e.documentElement.dir:null,i=(e.body?e.body.dir:null)||t;this.value="ltr"===i||"rtl"===i?i:"ltr"}}ngOnDestroy(){this.change.complete()}}return e.\u0275fac=function(t){return new(t||e)(gs(gE,8))},e.\u0275prov=de({factory:function(){return new e(gs(gE,8))},token:e,providedIn:"root"}),e})(),fE=(()=>{class e{constructor(e,t,i){this._ngZone=e,this._platform=t,this._scrolled=new b,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const t=this.scrollContainers.get(e);t&&(t.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new v(t=>{this._globalSubscription||this._addGlobalListener();const i=e>0?this._scrolled.pipe(tE(e)).subscribe(t):this._scrolled.subscribe(t);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):xh()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,t)=>this.deregister(t)),this._scrolled.complete()}ancestorScrolled(e,t){const i=this.getAncestorScrollContainers(e);return this.scrolled(t).pipe(nd(e=>!e||i.indexOf(e)>-1))}getAncestorScrollContainers(e){const t=[];return this.scrollContainers.forEach((i,s)=>{this._scrollableContainsElement(s,e)&&t.push(s)}),t}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_scrollableContainsElement(e,t){let i=t.nativeElement,s=e.getElementRef().nativeElement;do{if(i==s)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>US(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return e.\u0275fac=function(t){return new(t||e)(gs(_l),gs(hE),gs(cu,8))},e.\u0275prov=de({factory:function(){return new e(gs(_l),gs(hE),gs(cu,8))},token:e,providedIn:"root"}),e})(),mE=(()=>{class e{constructor(e,t,i){this._platform=e,this._change=new b,this._changeListener=e=>{this._change.next(e)},this._document=i,t.runOutsideAngular(()=>{if(e.isBrowser){const e=this._getWindow();e.addEventListener("resize",this._changeListener),e.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:t,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+t,height:i,width:t}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._getDocument(),t=this._getWindow(),i=e.documentElement,s=i.getBoundingClientRect();return{top:-s.top||e.body.scrollTop||t.scrollY||i.scrollTop||0,left:-s.left||e.body.scrollLeft||t.scrollX||i.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(tE(e)):this._change}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return e.\u0275fac=function(t){return new(t||e)(gs(hE),gs(_l),gs(cu,8))},e.\u0275prov=de({factory:function(){return new e(gs(hE),gs(_l),gs(cu,8))},token:e,providedIn:"root"}),e})(),SE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({}),e})();function EE(e){const{subscriber:t,counter:i,period:s}=e;t.next(i),this.schedule({subscriber:t,counter:i+1,period:s},s)}function vE(e,t){for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function RE(e,t){const i=t?"":"none";vE(e.style,{touchAction:t?"":"none",webkitUserDrag:t?"":"none",webkitTapHighlightColor:t?"":"transparent",userSelect:i,msUserSelect:i,webkitUserSelect:i,MozUserSelect:i})}function OE(e){const t=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*t}function TE(e,t){return e.getPropertyValue(t).split(",").map(e=>e.trim())}function IE(e){const t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}}function bE(e,t,i){const{top:s,bottom:r,left:n,right:o}=e;return i>=s&&i<=r&&t>=n&&t<=o}function CE(e,t,i){e.top+=t,e.bottom=e.top+e.height,e.left+=i,e.right=e.left+e.width}function yE(e,t,i,s){const{top:r,right:n,bottom:o,left:a,width:c,height:l}=e,u=c*t,h=l*t;return s>r-h&&s<o+h&&i>a-u&&i<n+u}class AE{constructor(e,t){this._document=e,this._viewportRuler=t,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),e.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:IE(e)})})}handleScroll(e){const t=e.target,i=this.positions.get(t);if(!i)return null;const s=t===this._document?t.documentElement:t,r=i.scrollPosition;let n,o;if(t===this._document){const e=this._viewportRuler.getViewportScrollPosition();n=e.top,o=e.left}else n=t.scrollTop,o=t.scrollLeft;const a=r.top-n,c=r.left-o;return this.positions.forEach((e,i)=>{e.clientRect&&t!==i&&s.contains(i)&&CE(e.clientRect,a,c)}),r.top=n,r.left=o,{top:a,left:c}}}function NE(e){const t=e.cloneNode(!0),i=t.querySelectorAll("[id]"),s=e.nodeName.toLowerCase();t.removeAttribute("id");for(let r=0;r<i.length;r++)i[r].removeAttribute("id");return"canvas"===s?PE(e,t):("input"===s||"select"===s||"textarea"===s)&&wE(e,t),_E("canvas",e,t,PE),_E("input, textarea, select",e,t,wE),t}function _E(e,t,i,s){const r=t.querySelectorAll(e);if(r.length){const t=i.querySelectorAll(e);for(let e=0;e<r.length;e++)s(r[e],t[e])}}function wE(e,t){t.value=e.value}function PE(e,t){const i=t.getContext("2d");if(i)try{i.drawImage(e,0,0)}catch(s){}}const ME=dE({passive:!0}),LE=dE({passive:!1});class DE{constructor(e,t,i,s,r,n){this._config=t,this._document=i,this._ngZone=s,this._viewportRuler=r,this._dragDropRegistry=n,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new b,this._pointerMoveSubscription=h.EMPTY,this._pointerUpSubscription=h.EMPTY,this._scrollSubscription=h.EMPTY,this._resizeSubscription=h.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new b,this.started=new b,this.released=new b,this.ended=new b,this.entered=new b,this.exited=new b,this.dropped=new b,this.moved=this._moveEvents.asObservable(),this._pointerDown=e=>{if(this.beforeStarted.next(),this._handles.length){const t=this._handles.find(t=>{const i=e.target;return!!i&&(i===t||t.contains(i))});t&&!this._disabledHandles.has(t)&&!this.disabled&&this._initializeDragSequence(t,e)}else this.disabled||this._initializeDragSequence(this._rootElement,e)},this._pointerMove=e=>{e.preventDefault();const t=this._getPointerPositionOnPage(e);if(!this._hasStartedDragging){if(Math.abs(t.x-this._pickupPositionOnPage.x)+Math.abs(t.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){if(!(Date.now()>=this._dragStartTime+this._getDragStartDelay(e)))return void this._endDragSequence(e);(!this._dropContainer||!this._dropContainer.isDragging())&&(this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(e)))}return}this._boundaryElement&&(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect());const i=this._getConstrainedPointerPosition(t);if(this._hasMoved=!0,this._lastKnownPointerPosition=t,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,t);else{const e=this._activeTransform;e.x=i.x-this._pickupPositionOnPage.x+this._passiveTransform.x,e.y=i.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(e.x,e.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${e.x} ${e.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:e,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})},this._pointerUp=e=>{this._endDragSequence(e)},this.withRootElement(e),this._parentPositions=new AE(i,r),n.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(e){const t=kS(e);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions())}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){return this._handles=e.map(e=>FS(e)),this._handles.forEach(e=>RE(e,!1)),this._toggleNativeDragInteractions(),this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){const t=FS(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,LE),t.addEventListener("touchstart",this._pointerDown,ME)}),this._initialTransform=void 0,this._rootElement=t),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?FS(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&FE(this._rootElement),FE(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){this._handles.indexOf(e)>-1&&this._disabledHandles.add(e)}enableHandle(e){this._disabledHandles.delete(e)}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){const e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}_sortFromLastPointerPosition(){const e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&FE(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&FE(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){!this._dragDropRegistry.isDragging(this)||(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)})):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(this._getPointerPositionOnPage(e))})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}_startDragSequence(e){UE(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const e=this._rootElement,i=e.parentNode,s=this._preview=this._createPreviewElement(),r=this._placeholder=this._createPlaceholderElement(),n=this._anchor=this._anchor||this._document.createComment("");i.insertBefore(n,e),e.style.display="none",this._document.body.appendChild(i.replaceChild(r,e)),function(e){return e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement||e.body}(this._document).appendChild(s),this.started.next({source:this}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(e,t){t.stopPropagation();const i=this.isDragging(),s=UE(t),r=!s&&0!==t.button,n=this._rootElement,o=!s&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(t.target&&t.target.draggable&&"mousedown"===t.type&&t.preventDefault(),i||r||o)return;this._handles.length&&(this._rootElementTapHighlight=n.style.webkitTapHighlightColor||"",n.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe(e=>{this._updateOnScroll(e)}),this._boundaryElement&&(this._boundaryRect=IE(this._boundaryElement));const a=this._previewTemplate;this._pickupPositionInElement=a&&a.template&&!a.matchSize?{x:0,y:0}:this._getPointerPositionInElement(e,t);const c=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:c.x,y:c.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),s=this._getPointerPositionOnPage(e),r=this._getDragDistance(this._getPointerPositionOnPage(e)),n=t._isOverContainer(s.x,s.y);this.ended.next({source:this,distance:r}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:n,distance:r}),t.drop(this,i,this._initialContainer,n,r,this._initialIndex),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:i,y:s}){let r=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=r,this._dropContainer.enter(this,e,t,r===this._initialContainer&&r.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:r,currentIndex:r.getItemIndex(this)})}),this._dropContainer._startScrollingIfNecessary(i,s),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this._preview.style.transform=xE(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y)}_createPreviewElement(){const e=this._previewTemplate,t=this.previewClass,i=e?e.template:null;let s;if(i&&e){const t=e.matchSize?this._rootElement.getBoundingClientRect():null,r=e.viewContainer.createEmbeddedView(i,e.context);r.detectChanges(),s=HE(r,this._document),this._previewRef=r,e.matchSize?GE(s,t):s.style.transform=xE(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const e=this._rootElement;s=NE(e),GE(s,e.getBoundingClientRect())}return vE(s.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:`${this._config.zIndex||1e3}`}),RE(s,!1),s.classList.add("cdk-drag-preview"),s.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(e=>s.classList.add(e)):s.classList.add(t)),s}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const e=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=xE(e.left,e.top);const t=function(e){const t=getComputedStyle(e),i=TE(t,"transition-property"),s=i.find(e=>"transform"===e||"all"===e);if(!s)return 0;const r=i.indexOf(s),n=TE(t,"transition-duration"),o=TE(t,"transition-delay");return OE(n[r])+OE(o[r])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(e=>{const i=t=>{(!t||t.target===this._preview&&"transform"===t.propertyName)&&(this._preview.removeEventListener("transitionend",i),e(),clearTimeout(s))},s=setTimeout(i,1.5*t);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const e=this._placeholderTemplate,t=e?e.template:null;let i;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),i=HE(this._placeholderRef,this._document)):i=NE(this._rootElement),i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(e,t){const i=this._rootElement.getBoundingClientRect(),s=e===this._rootElement?null:e,r=s?s.getBoundingClientRect():i,n=UE(t)?t.targetTouches[0]:t,o=this._getViewportScrollPosition();return{x:r.left-i.left+(n.pageX-r.left-o.left),y:r.top-i.top+(n.pageY-r.top-o.top)}}_getPointerPositionOnPage(e){const t=this._getViewportScrollPosition(),i=UE(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,s=i.pageX-t.left,r=i.pageY-t.top;if(this._ownerSVGElement){const e=this._ownerSVGElement.getScreenCTM();if(e){const t=this._ownerSVGElement.createSVGPoint();return t.x=s,t.y=r,t.matrixTransform(e.inverse())}}return{x:s,y:r}}_getConstrainedPointerPosition(e){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:s}=this.constrainPosition?this.constrainPosition(e,this):e;if("x"===this.lockAxis||"x"===t?s=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(i=this._pickupPositionOnPage.x),this._boundaryRect){const{x:e,y:t}=this._pickupPositionInElement,r=this._boundaryRect,n=this._previewRect,o=r.top+t,a=r.bottom-(n.height-t);i=kE(i,r.left+e,r.right-(n.width-e)),s=kE(s,o,a)}return{x:i,y:s}}_updatePointerDirectionDelta(e){const{x:t,y:i}=e,s=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,n=Math.abs(t-r.x),o=Math.abs(i-r.y);return n>this._config.pointerDirectionChangeThreshold&&(s.x=t>r.x?1:-1,r.x=t),o>this._config.pointerDirectionChangeThreshold&&(s.y=i>r.y?1:-1,r.y=i),s}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,RE(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,LE),e.removeEventListener("touchstart",this._pointerDown,ME)}_applyRootElementTransform(e,t){const i=xE(e,t);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?i+" "+this._initialTransform:i}_getDragDistance(e){const t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(0===e&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._boundaryElement.getBoundingClientRect(),s=this._rootElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===s.width&&0===s.height)return;const r=i.left-s.left,n=s.right-i.right,o=i.top-s.top,a=s.bottom-i.bottom;i.width>s.width?(r>0&&(e+=r),n>0&&(e-=n)):e=0,i.height>s.height?(o>0&&(t+=o),a>0&&(t-=a)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){const t=this.dragStartDelay;return"number"==typeof t?t:UE(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){const t=this._parentPositions.handleScroll(e);if(t){const i=e.target;this._boundaryRect&&(i===this._document||i!==this._boundaryElement&&i.contains(this._boundaryElement))&&CE(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const e=this._parentPositions.positions.get(this._document);return e?e.scrollPosition:this._viewportRuler.getViewportScrollPosition()}}function xE(e,t){return`translate3d(${Math.round(e)}px, ${Math.round(t)}px, 0)`}function kE(e,t,i){return Math.max(t,Math.min(i,e))}function FE(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function UE(e){return"t"===e.type[0]}function HE(e,t){const i=e.rootNodes;if(1===i.length&&i[0].nodeType===t.ELEMENT_NODE)return i[0];const s=t.createElement("div");return i.forEach(e=>s.appendChild(e)),s}function GE(e,t){e.style.width=`${t.width}px`,e.style.height=`${t.height}px`,e.style.transform=xE(t.left,t.top)}function BE(e,t,i){const s=WE(t,e.length-1),r=WE(i,e.length-1);if(s===r)return;const n=e[s],o=r<s?-1:1;for(let a=s;a!==r;a+=o)e[a]=e[a+o];e[r]=n}function WE(e,t){return Math.max(0,Math.min(t,e))}class VE{constructor(e,t,i,s,r){this._dragDropRegistry=t,this._ngZone=s,this._viewportRuler=r,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=()=>!0,this.beforeStarted=new b,this.entered=new b,this.exited=new b,this.dropped=new b,this.sorted=new b,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=h.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new b,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(e=0,t=qS){return(!JS(e)||e<0)&&(e=0),(!t||"function"!=typeof t.schedule)&&(t=qS),new v(i=>(i.add(t.schedule(EE,e,{subscriber:i,counter:0,period:e})),i))}(0,zS).pipe(iE(this._stopScrollTimers)).subscribe(()=>{const e=this._scrollNode;1===this._verticalScrollDirection?YE(e,-2):2===this._verticalScrollDirection&&YE(e,2),1===this._horizontalScrollDirection?KE(e,-2):2===this._horizontalScrollDirection&&KE(e,2)})},this.element=FS(e),this._document=i,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new AE(i,r)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){const e=FS(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach(e=>e._startReceiving(this)),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}enter(e,t,i,s){let r;this.start(),null==s?(r=this.sortingDisabled?this._draggables.indexOf(e):-1,-1===r&&(r=this._getItemIndexFromPointerPosition(e,t,i))):r=s;const n=this._activeDraggables,o=n.indexOf(e),a=e.getPlaceholderElement();let c=n[r];if(c===e&&(c=n[r+1]),o>-1&&n.splice(o,1),c&&!this._dragDropRegistry.isDragging(c)){const t=c.getRootElement();t.parentElement.insertBefore(a,t),n.splice(r,0,e)}else if(this._shouldEnterAsFirstChild(t,i)){const t=n[0].getRootElement();t.parentNode.insertBefore(a,t),n.unshift(e)}else FS(this.element).appendChild(a),n.push(e);a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,i,s,r,n){this._reset(),null==n&&(n=i.getItemIndex(e)),this.dropped.next({item:e,currentIndex:t,previousIndex:n,container:this,previousContainer:i,isPointerOverContainer:s,distance:r})}withItems(e){const t=this._draggables;return this._draggables=e,e.forEach(e=>e._withDropContainer(this)),this.isDragging()&&(t.filter(e=>e.isDragging()).every(t=>-1===e.indexOf(t))?this._reset():this._cacheItems()),this}withDirection(e){return this._direction=e,this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){return this._orientation=e,this}withScrollableParents(e){const t=FS(this.element);return this._scrollableElements=-1===e.indexOf(t)?[t,...e]:e.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?zE("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,t=>t.drag===e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,i,s){if(this.sortingDisabled||!yE(this._clientRect,.05,t,i))return;const r=this._itemPositions,n=this._getItemIndexFromPointerPosition(e,t,i,s);if(-1===n&&r.length>0)return;const o="horizontal"===this._orientation,a=zE(r,t=>t.drag===e),c=r[n],l=c.clientRect,u=a>n?1:-1,h=this._getItemOffsetPx(r[a].clientRect,l,u),d=this._getSiblingOffsetPx(a,r,u),g=r.slice();BE(r,a,n),this.sorted.next({previousIndex:a,currentIndex:n,container:this,item:e}),r.forEach((t,i)=>{if(g[i]===t)return;const s=t.drag===e,r=s?h:d,n=s?e.getPlaceholderElement():t.drag.getRootElement();t.offset+=r,o?(n.style.transform=`translate3d(${Math.round(t.offset)}px, 0, 0)`,CE(t.clientRect,0,r)):(n.style.transform=`translate3d(0, ${Math.round(t.offset)}px, 0)`,CE(t.clientRect,r,0))}),this._previousSwap.overlaps=bE(l,t,i),this._previousSwap.drag=c.drag,this._previousSwap.delta=o?s.x:s.y}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let i,s=0,r=0;if(this._parentPositions.positions.forEach((n,o)=>{o===this._document||!n.clientRect||i||yE(n.clientRect,.05,e,t)&&([s,r]=function(e,t,i,s){const r=jE(t,s),n=$E(t,i);let o=0,a=0;if(r){const t=e.scrollTop;1===r?t>0&&(o=1):e.scrollHeight-t>e.clientHeight&&(o=2)}if(n){const t=e.scrollLeft;1===n?t>0&&(a=1):e.scrollWidth-t>e.clientWidth&&(a=2)}return[o,a]}(o,n.clientRect,e,t),(s||r)&&(i=o))}),!s&&!r){const{width:n,height:o}=this._viewportRuler.getViewportSize(),a={width:n,height:o,top:0,right:n,bottom:o,left:0};s=jE(a,t),r=$E(a,e),i=window}i&&(s!==this._verticalScrollDirection||r!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=s,this._horizontalScrollDirection=r,this._scrollNode=i,(s||r)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_cacheParentPositions(){const e=FS(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(e).clientRect}_cacheItemPositions(){const e="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(e=>{const t=e.getVisibleElement();return{drag:e,offset:0,clientRect:IE(t)}}).sort((t,i)=>e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_reset(){this._isDragging=!1;const e=FS(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(e=>{const t=e.getRootElement();t&&(t.style.transform="")}),this._siblings.forEach(e=>e._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(e,t,i){const s="horizontal"===this._orientation,r=t[e].clientRect,n=t[e+-1*i];let o=r[s?"width":"height"]*i;if(n){const e=s?"left":"top",t=s?"right":"bottom";-1===i?o-=n.clientRect[e]-r[t]:o+=r[e]-n.clientRect[t]}return o}_getItemOffsetPx(e,t,i){const s="horizontal"===this._orientation;let r=s?t.left-e.left:t.top-e.top;return-1===i&&(r+=s?t.width-e.width:t.height-e.height),r}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,s="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){const r=i[i.length-1].clientRect;return s?e>=r.right:t>=r.bottom}{const r=i[0].clientRect;return s?e<=r.left:t<=r.top}}_getItemIndexFromPointerPosition(e,t,i,s){const r="horizontal"===this._orientation;return zE(this._itemPositions,({drag:n,clientRect:o},a,c)=>{if(n===e)return c.length<2;if(s){const e=r?s.x:s.y;if(n===this._previousSwap.drag&&this._previousSwap.overlaps&&e===this._previousSwap.delta)return!1}return r?t>=Math.floor(o.left)&&t<Math.floor(o.right):i>=Math.floor(o.top)&&i<Math.floor(o.bottom)})}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(e,t){return bE(this._clientRect,e,t)}_getSiblingContainerFromPosition(e,t,i){return this._siblings.find(s=>s._canReceive(e,t,i))}_canReceive(e,t,i){if(!bE(this._clientRect,t,i)||!this.enterPredicate(e,this))return!1;const s=this._getShadowRoot().elementFromPoint(t,i);if(!s)return!1;const r=FS(this.element);return s===r||r.contains(s)}_startReceiving(e){const t=this._activeSiblings;t.has(e)||(t.add(e),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe(e=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(e);t&&(this._itemPositions.forEach(({clientRect:e})=>{CE(e,t.top,t.left)}),this._itemPositions.forEach(({drag:e})=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const e=function(e){if(function(){if(null==uE){const e="undefined"!=typeof document?document.head:null;uE=!(!e||!e.createShadowRoot&&!e.attachShadow)}return uE}()){const t=e.getRootNode?e.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(FS(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}}function zE(e,t){for(let i=0;i<e.length;i++)if(t(e[i],i,e))return i;return-1}function YE(e,t){e===window?e.scrollBy(0,t):e.scrollTop+=t}function KE(e,t){e===window?e.scrollBy(t,0):e.scrollLeft+=t}function jE(e,t){const{top:i,bottom:s,height:r}=e,n=.05*r;return t>=i-n&&t<=i+n?1:t>=s-n&&t<=s+n?2:0}function $E(e,t){const{left:i,right:s,width:r}=e,n=.05*r;return t>=i-n&&t<=i+n?1:t>=s-n&&t<=s+n?2:0}const QE=dE({passive:!1,capture:!0});let qE=(()=>{class e{constructor(e,t){this._ngZone=e,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new b,this.pointerUp=new b,this.scroll=new b,this._preventDefaultWhileDragging=e=>{this._activeDragInstances.size&&e.preventDefault()},this._document=t}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._preventDefaultWhileDragging,QE)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,QE)}startDragging(e,t){if(!this._activeDragInstances.has(e)&&(this._activeDragInstances.add(e),1===this._activeDragInstances.size)){const e=t.type.startsWith("touch"),i=e?"touchend":"mouseup";this._globalListeners.set(e?"touchmove":"mousemove",{handler:e=>this.pointerMove.next(e),options:QE}).set(i,{handler:e=>this.pointerUp.next(e),options:!0}).set("scroll",{handler:e=>this.scroll.next(e),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:QE}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((e,t)=>{this._document.addEventListener(t,e.handler,e.options)})})}}stopDragging(e){this._activeDragInstances.delete(e),0===this._activeDragInstances.size&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances.has(e)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((e,t)=>{this._document.removeEventListener(t,e.handler,e.options)}),this._globalListeners.clear()}}return e.\u0275fac=function(t){return new(t||e)(gs(_l),gs(cu))},e.\u0275prov=de({factory:function(){return new e(gs(_l),gs(cu))},token:e,providedIn:"root"}),e})();const XE={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let ZE=(()=>{class e{constructor(e,t,i,s){this._document=e,this._ngZone=t,this._viewportRuler=i,this._dragDropRegistry=s}createDrag(e,t=XE){return new DE(e,t,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new VE(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return e.\u0275fac=function(t){return new(t||e)(gs(cu),gs(_l),gs(mE),gs(qE))},e.\u0275prov=de({factory:function(){return new e(gs(cu),gs(_l),gs(mE),gs(qE))},token:e,providedIn:"root"}),e})();const JE=new ji("CdkDropListGroup"),ev=new ji("CDK_DRAG_CONFIG");let tv=0;const iv=new ji("CdkDropList");let sv=(()=>{class e{constructor(t,i,s,r,n,o,a){this.element=t,this._changeDetectorRef=s,this._dir=r,this._group=n,this._scrollDispatcher=o,this._destroyed=new b,this.connectedTo=[],this.id="cdk-drop-list-"+tv++,this.enterPredicate=()=>!0,this.dropped=new Vc,this.entered=new Vc,this.exited=new Vc,this.sorted=new Vc,this._unsortedItems=new Set,this._dropListRef=i.createDropList(t),this._dropListRef.data=this,a&&this._assignDefaults(a),this._dropListRef.enterPredicate=(e,t)=>this.enterPredicate(e.data,t.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),n&&n._items.add(this)}get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=kS(e)}addItem(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((e,t)=>e._dragRef.getVisibleElement().compareDocumentPosition(t._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=e._dropLists.indexOf(this);t>-1&&e._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe(td(this._dir.value),iE(this._destroyed)).subscribe(e=>t.withDirection(e)),t.beforeStarted.subscribe(()=>{const i=function(e){return Array.isArray(e)?e:[e]}(this.connectedTo).map(t=>{if("string"==typeof t){const i=e._dropLists.find(e=>e.id===t);return!i&&Wl()&&console.warn(`CdkDropList could not find connected drop list with id "${t}"`),i}return t});if(this._group&&this._group._items.forEach(e=>{-1===i.indexOf(e)&&i.push(e)}),!this._scrollableParentsResolved&&this._scrollDispatcher){const e=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(e=>e.getElementRef().nativeElement);this._dropListRef.withScrollableParents(e),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=kS(this.sortingDisabled),t.autoScrollDisabled=kS(this.autoScrollDisabled),t.connectedTo(i.filter(e=>e&&e!==this).map(e=>e._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(e=>{this.entered.emit({container:this,item:e.item.data,currentIndex:e.currentIndex})}),e.exited.subscribe(e=>{this.exited.emit({container:this,item:e.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(e=>{this.sorted.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,container:this,item:e.item.data})}),e.dropped.subscribe(e=>{this.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,item:e.item.data,isPointerOverContainer:e.isPointerOverContainer,distance:e.distance}),this._changeDetectorRef.markForCheck()})}_assignDefaults(e){const{lockAxis:t,draggingDisabled:i,sortingDisabled:s,listAutoScrollDisabled:r,listOrientation:n}=e;this.disabled=null!=i&&i,this.sortingDisabled=null!=s&&s,this.autoScrollDisabled=null!=r&&r,this.orientation=n||"vertical",t&&(this.lockAxis=t)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(e=>e._dragRef))}}return e.\u0275fac=function(t){return new(t||e)(Mo(La),Mo(ZE),Mo(nc),Mo(pE,8),Mo(JE,12),Mo(fE),Mo(ev,8))},e.\u0275dir=Qe({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(e,t){2&e&&(ca("id",t.id),Zo("cdk-drop-list-disabled",t.disabled)("cdk-drop-list-dragging",t._dropListRef.isDragging())("cdk-drop-list-receiving",t._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Ca([{provide:JE,useValue:void 0},{provide:iv,useExisting:e}])]}),e._dropLists=[],e})();const rv=new ji("CDK_DRAG_PARENT"),nv=new ji("CdkDragHandle"),ov=new ji("CdkDragPlaceholder"),av=new ji("CdkDragPreview");let cv=(()=>{class e{constructor(e,t,i,s,r,n,o,a,c,l){this.element=e,this.dropContainer=t,this._document=i,this._ngZone=s,this._viewContainerRef=r,this._dir=o,this._changeDetectorRef=c,this._selfHandle=l,this._destroyed=new b,this.started=new Vc,this.released=new Vc,this.ended=new Vc,this.entered=new Vc,this.exited=new Vc,this.dropped=new Vc,this.moved=new v(e=>{const t=this._dragRef.moved.pipe(A(e=>({source:this,pointerPosition:e.pointerPosition,event:e.event,delta:e.delta,distance:e.distance}))).subscribe(e);return()=>{t.unsubscribe()}}),this._dragRef=a.createDrag(e,{dragStartThreshold:n&&null!=n.dragStartThreshold?n.dragStartThreshold:5,pointerDirectionChangeThreshold:n&&null!=n.pointerDirectionChangeThreshold?n.pointerDirectionChangeThreshold:5,zIndex:null==n?void 0:n.zIndex}),this._dragRef.data=this,n&&this._assignDefaults(n),t&&(this._dragRef._withDropContainer(t._dropListRef),t.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(e){this._disabled=kS(e),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.onStable.asObservable().pipe(Zh(1),iE(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._handles.changes.pipe(td(this._handles),bd(e=>{const t=e.filter(e=>e._parentDrag===this).map(e=>e.element);this._selfHandle&&this.rootElementSelector&&t.push(this.element),this._dragRef.withHandles(t)}),$h(e=>Y(...e.map(e=>e._stateChanges.pipe(td(e))))),iE(this._destroyed)).subscribe(e=>{const t=this._dragRef,i=e.element.nativeElement;e.disabled?t.disableHandle(i):t.enableHandle(i)}),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})}ngOnChanges(e){const t=e.rootElementSelector,i=e.freeDragPosition;t&&!t.firstChange&&this._updateRootElement(),i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()}_updateRootElement(){const e=this.element.nativeElement,t=this.rootElementSelector?lv(e,this.rootElementSelector):e;if(t&&t.nodeType!==this._document.ELEMENT_NODE)throw Error(`cdkDrag must be attached to an element node. Currently attached to "${t.nodeName}".`);this._dragRef.withRootElement(t||e)}_getBoundaryElement(){const e=this.boundaryElement;if(!e)return null;if("string"==typeof e)return lv(this.element.nativeElement,e);const t=FS(e);if(Wl()&&!t.contains(this.element.nativeElement))throw Error("Draggable element is not inside of the node passed into cdkDragBoundary.");return t}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const t=this._dir,i=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,r=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay="object"==typeof i&&i?i:function(e,t=0){return function(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(r),t&&e.withDirection(t.value)}})}_handleEvents(e){e.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(()=>{this.released.emit({source:this})}),e.ended.subscribe(e=>{this.ended.emit({source:this,distance:e.distance}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(e=>{this.entered.emit({container:e.container.data,item:this,currentIndex:e.currentIndex})}),e.exited.subscribe(e=>{this.exited.emit({container:e.container.data,item:this})}),e.dropped.subscribe(e=>{this.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,isPointerOverContainer:e.isPointerOverContainer,item:this,distance:e.distance})})}_assignDefaults(e){const{lockAxis:t,dragStartDelay:i,constrainPosition:s,previewClass:r,boundaryElement:n,draggingDisabled:o,rootElementSelector:a}=e;this.disabled=null!=o&&o,this.dragStartDelay=i||0,t&&(this.lockAxis=t),s&&(this.constrainPosition=s),r&&(this.previewClass=r),n&&(this.boundaryElement=n),a&&(this.rootElementSelector=a)}}return e.\u0275fac=function(t){return new(t||e)(Mo(La),Mo(iv,12),Mo(cu),Mo(_l),Mo(Sc),Mo(ev,8),Mo(pE,8),Mo(ZE),Mo(nc),Mo(nv,10))},e.\u0275dir=Qe({type:e,selectors:[["","cdkDrag",""]],contentQueries:function(e,t,i){if(1&e&&(sl(i,av,5),sl(i,ov,5),sl(i,nv,5)),2&e){let e;tl(e=rl())&&(t._previewTemplate=e.first),tl(e=rl())&&(t._placeholderTemplate=e.first),tl(e=rl())&&(t._handles=e)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(e,t){2&e&&Zo("cdk-drag-disabled",t.disabled)("cdk-drag-dragging",t._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Ca([{provide:rv,useExisting:e}]),ct]}),e})();function lv(e,t){let i=e.parentElement;for(;i;){if(i.matches?i.matches(t):i.msMatchesSelector(t))return i;i=i.parentElement}return null}let uv=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({providers:[ZE],imports:[SE]}),e})();class hv extends DS{constructor(e=null,t,i,s,r=1,n=1,o=1,a=0,c=!1,l=null){super(t,Lf.CONSTRUCTION,e,nS.CONSTRUCTION_SITE,c,1===o,!0,o,a,r,s),this.region=i,this.buildingSize=n,this.upgradeLevel=o,this.data=l,this.servicesService&&(this.resourcesService=this.servicesService.getResourcesService(),this.buildingFactoryService=this.servicesService.getService(Zf.BUILDING_FACTORY),this.regionService=this.servicesService.getServiceByRegion(i))}isUpgrade(){return 1!==this.upgradeLevel}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:return this.isUpgrade()?wS.textValue("upgrading "+Qf.prepareBuildingName(this.workingAt)):wS.textValue("constructing "+Qf.prepareBuildingName(this.workingAt));case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}tick(){0===this.buildingComplexity&&(this.isUpgrade()?this.regionService.finishUpgrade(this,this.workingAt):this.regionService.finishConstruction(this,this.workingAt)),this.progress>=100&&(this.isUpgrade()?this.regionService.finishUpgrade(this,this.workingAt):this.regionService.finishConstruction(this,this.workingAt)),this.working&&(this.progress<100?(this.progress+=this.getPower()/this.buildingComplexity,this.progress>100&&(this.progress=100)):this.isUpgrade()?this.regionService.finishUpgrade(this,this.workingAt):this.regionService.finishConstruction(this,this.workingAt))}build(){return!this.startProduction()&&0!==this.buildingComplexity&&this.servicesService.getModalService().info("Couldn't unlock construction. Not enough free workers."),this}toJSON(){return{id:this.id,upgradeLevel:this.upgradeLevel,buildingType:this.buildingType,region:this.region,constructing:this.workingAt,buildingComplexity:this.buildingComplexity,progress:this.progress,working:this.working,buildingSize:this.buildingSize,data:this.data}}getSize(){return this.buildingSize}finishDemolish(){Array.from(this.buildingFactoryService.createBuildingShell(this.workingAt).getCost().entries()).forEach(e=>this.resourcesService.increaseResource(e[0],Math.floor(e[1]*(1-this.progress/100)+e[1]*(this.progress/100*.3)),"Cancel construction"))}getBuildingData(){return this.data}}class dv{constructor(e,t,i,s,r,n,o){this.buildings=[],this.filterBuilding=Lf.ALL,this.filterWorking=qf.ALL,this.thisRegion=n,this.buildingFactoryService=e,this.resourcesService=t,this.servicesService=i,this.landService=s,this.idService=r,t.addCallback(this,n),i.addService(o,this)}init(){}getBuildings(){return this.buildings}tick(e){this.shuffleArray(this.buildings).forEach(t=>t.tick(e))}shuffleArray(e){const t=e.slice();for(let i=t.length-1;i>0;i--){const e=Math.floor(Math.random()*(i+1));[t[i],t[e]]=[t[e],t[i]]}return t}getName(){return"AbstractRegionService"}save(){return{buildings:this.buildings,filterBuilding:this.filterBuilding,filterWorking:this.filterWorking}}reset(e,t){this.buildings=[],this.filterBuilding=Lf.ALL,this.filterWorking=qf.ALL,this.init()}load(e){this.buildings=[],this.filterBuilding=void 0!==e.filterBuilding?e.filterBuilding:Lf.ALL,this.filterWorking=void 0!==e.filterWorking?e.filterWorking:qf.ALL;for(const t of e.buildings)-1===t.id&&(t.id=this.idService.getNextId()),this.buildings.push(this.buildingFactoryService.loadBuilding(t))}getFilterBuilding(){return this.filterBuilding}setFilterBuildings(e){this.filterBuilding=e}setFilterWorking(e){this.filterWorking=e}getFilterWorking(){return this.filterWorking}getUnemployed(){return this.resourcesService.getPeople()}finishConstruction(e,t){const i=this.buildings.indexOf(e);-1!==i&&(this.buildings[i].stopProduction(),this.buildings[i]=this.buildingFactoryService.createBuilding(t,this.buildings[i].getBuildingId()))}createConstruction(e){this.buildings.push(e)}demolish(e){const t=this.buildings.indexOf(e);-1!==t&&(this.buildings[t].getBuildingType()===Lf.CONSTRUCTION?(this.buildings[t].stopProduction(),this.buildings[t].finishDemolish(),this.landService.increaseLand(this.buildings[t].getSize()),this.buildings.splice(t,1)):this.buildings[t]=new xS(this.servicesService,this.buildings[t].getBuildingId(),this.thisRegion,this.buildings[t].getBuildingType(),this.buildings[t].getComplexity(),this.buildings[t].getSize()).build())}finishDeconstruction(e){const t=this.buildings.indexOf(e);-1!==t&&(this.buildings[t].stopProduction(),this.buildingFactoryService.createBuildingShell(this.buildings[t].getBuildingBeingDemolished()).finishDemolish(),this.landService.increaseLand(this.buildings[t].getSize()),this.buildings.splice(t,1))}finishUpgrade(e,t){const i=this.buildings.indexOf(e);if(-1!==i){this.buildings[i].stopProduction();let e=this.buildingFactoryService.createBuildingShell(t,this.buildings[i].getBuildingId());e.getUpgradeSettings().NEW_BUILDING&&(e=this.buildingFactoryService.createBuildingShell(e.getUpgradeSettings().NEW_BUILDING,this.buildings[i].getBuildingId())),e.setBuildingData(this.buildings[i].getBuildingData()),e.setBuildingLevel(this.buildings[i].getBuildingLevel()),e.build(),this.buildings[i]=e}}fireRandomWorker(){const e=this.buildings.filter(e=>void 0===e.getOccupants&&e.isWorking()&&e.getWorkers()>0);if(e.length>0){const t=Math.floor(Math.random()*e.length);return e[t].fireWorker(),this.servicesService.getManagementService().getLogFiredWorkers()&&this.servicesService.getLogService().warning("Worker removed from "+e[t].getName()),!0}return!1}moveBuildingInList(e,t){BE(this.buildings,e,t)}moveBuildingInListByBuildingId(e,t){const i=this.buildings.findIndex(t=>e===t.getBuildingId()),s=this.buildings.findIndex(e=>t===e.getBuildingId());BE(this.buildings,i,s)}canCombine(e){if(this.buildings.filter(e=>e.isCombinable()).length>1)return this.toCombine?this.toCombine!==e&&this.toCombine.getBuildingType()===e.getBuildingType():!!this.buildings.find(t=>t!==e&&t.getBuildingType()===e.getBuildingType())}combine(e){if(!this.toCombine)return this.toCombine=e,!1;e.combine(this.toCombine,this)}finaliseCombine(e){if(e){const e=this.buildings.indexOf(this.toCombine);if(e>=0)return this.buildings[e].prepareDemolish()?(this.toCombine=null,this.buildings.splice(e,1),!0):(this.toCombine=null,!1)}else this.toCombine=null}clearCombineMode(){this.toCombine=null}split(e){e.isSplittable()&&e.split(this)}finaliseSplit(e){this.buildings.push(e)}addBuilding(e){this.buildings.push(this.buildingFactoryService.createBuilding(e))}upgradeBuilding(e){const t=this.buildings.find(t=>t.getBuildingId()===e),i=this.servicesService.getModalService(),s=this.servicesService.getVillageService();if(t)if(t.hasUpgrade())if(t.getOccupants)if(void 0!==t.getMaxSize&&s.getPopulation()>s.getPopulationCap()-t.getMaxSize()){i.open(Pf.CONFIRM),i.setModalText("You don't have enough housing space to move this building occupants.<br> People that won't find new home will leave the village<br>Do you still want to upgrade this building?");const e=i.registerForConfirmation().subscribe(s=>{e.unsubscribe(),s&&this.upgrade(t,i)})}else this.upgrade(t,i);else this.upgrade(t,i);else i.info("This building cannot be upgraded");else i.info("Error! Building not found")}upgrade(e,t){if(e.getUpgradeSettings().SIZE&&!this.landService.hasLand(e.getUpgradeSettings().SIZE))return void t.info("Not enough empty land to upgrade!");if(!this.resourcesService.hasResources(e.getUpgradeCost(),"Upgrade",1,!0))return void t.info("Not enough resources to upgrade!");this.landService.decreaseLand(e.getUpgradeSettings().SIZE),this.resourcesService.decreaseResources(e.getUpgradeCost(),"Upgrade",!0);const i=this.buildings.indexOf(e),s=nS.getBuilding(e.getBuildingType());e.stopProduction();const r=new hv(this.servicesService,e.getBuildingId(),this.thisRegion,e.getBuildingType(),s.UPGRADES[e.getBuildingLevel()-1].COMPLEXITY,e.getSize(),e.getBuildingLevel()+1,0,!1,e.getBuildingData()).build();e.prepareDemolish(),this.buildings[i]=r}move(e){if(!this.toArrange)return this.toArrange=e,!1;this.moveBuildingInListByBuildingId(this.toArrange.getBuildingId(),e.getBuildingId()),this.toArrange=null}canMove(e){return!(this.toArrange&&e.getBuildingId()===this.toArrange.getBuildingId())}autoSort(){let e=[];const t=this.buildings;for(;this.buildings.length>0;){const t=this.buildings[0].getBuildingType();if(t===Lf.MANUFACTURE){let i=this.buildings.filter(e=>e.getBuildingType()===t||e.getBuildingType()===Lf.CONSTRUCTION&&e.getWorkingAt()===t).map(e=>e);for(this.buildings=this.buildings.filter(e=>!(e.getBuildingType()===t||e.getBuildingType()===Lf.CONSTRUCTION&&e.getWorkingAt()===t));i.length>0;){const t=i[0].getRecipe&&null!==i[0].getRecipe()?i[0].getRecipe().id:null;e=e.concat(i.filter(e=>e.getBuildingType()===Lf.CONSTRUCTION||null===e.getRecipe()?null===t:e.getRecipe().id===t)),i=i.filter(e=>e.getBuildingType()===Lf.CONSTRUCTION||null===e.getRecipe()?null!==t:e.getRecipe().id!==t)}}else e=e.concat(this.buildings.filter(e=>e.getBuildingType()===t||e.getBuildingType()===Lf.CONSTRUCTION&&e.getWorkingAt()===t)),this.buildings=this.buildings.filter(e=>!(e.getBuildingType()===t||e.getBuildingType()===Lf.CONSTRUCTION&&e.getWorkingAt()===t))}this.buildings=t.length===e.length?e:t}hasBuilding(e){return void 0!==this.buildings.find(t=>t.getBuildingId()===e)}autoMerge(){let e=!1;const t=this.buildings.filter(e=>e.isCombinable());if(t.length>1){const i=new Map;t.forEach(e=>{i.has(e.getBuildingType())?i.get(e.getBuildingType()).push(e):i.set(e.getBuildingType(),[e])}),i.forEach(t=>{for(;t.length>1;){const i=t.shift(),s=[];for(let e=0;e<t.length;e++)t[e].isCompatible(i)&&s.push(t[e]);s.forEach(t=>{e=!0,this.clearCombineMode(),this.combine(t),this.combine(i)}),t=t.filter(e=>this.hasBuilding(e.getBuildingId()))}})}e||this.servicesService.getModalService().info("No buildings to combine")}}let gv=(()=>{class e{constructor(e,t,i,s,r,n,o,a){this.modalService=e,this.landService=t,this.gameService=i,this.regionService=s,this.tutorialService=r,this.optionsService=n,this.changeDetectorRef=o,this.thisRegion=a,this.demolishMode=!1,this.arrangeMode=!1,this.combineMode=!1,this.splitMode=!1,this.filterBuilding=this.regionService.getFilterBuilding(),this.filterWorking=this.regionService.getFilterWorking(),this.currentPage=0,this.allBuildings=Lf.ALL,this.buildingStates=qf}ngOnInit(){this.tutorialService.checkRegionTutorial(this.thisRegion)}getUniqueBuildingsFromCurrentView(){const e=[];return this.regionService.buildings.forEach(t=>{e.includes(t.getBuildingType())||e.push(t.getBuildingType()),(t.getBuildingType()===Lf.CONSTRUCTION&&!e.includes(t.getWorkingAt())||t.getBuildingType()===Lf.DECONSTRUCTION&&!e.includes(t.getWorkingAt()))&&e.push(t.getWorkingAt())}),e}getBuildings(){const e=this.regionService.getBuildings().filter(e=>this.filterWorking===qf.ALL||this.filterWorking===qf.WORKING&&e.isWorking()||this.filterWorking===qf.IDLE&&!e.isWorking()&&e.isStoppable()).filter(e=>this.filterBuilding===Lf.ALL||e.getBuildingType()===Lf.CONSTRUCTION&&e.getWorkingAt()===this.filterBuilding||e.getBuildingType()===Lf.DECONSTRUCTION&&e.getWorkingAt()===this.filterBuilding||e.getBuildingType()===this.filterBuilding);return 0===e.length&&this.filterBuilding!==Lf.ALL&&!this.getUniqueBuildingsFromCurrentView().includes(this.filterBuilding)&&(this.filterBuilding=Lf.ALL,this.regionService.setFilterBuildings(Lf.ALL)),e}getBuildingName(e){return Qf.prepareBuildingName(e)}updateFilter(e){this.filterBuilding=Lf[Lf[e.target.value]],this.regionService.setFilterBuildings(this.filterBuilding),this.currentPage=0}updateFilter2(e){this.filterWorking=Lf[Lf[e.target.value]],this.regionService.setFilterWorking(this.filterWorking),this.currentPage=0}openBuildModal(){this.demolishMode=!1,this.arrangeMode=!1,this.modalService.setRegion(this.thisRegion),this.modalService.open(Pf.BUILD)}getUnemployed(){return this.regionService.getUnemployed()}getFreeLand(){return this.landService.getLand()}toggleDemolishMode(){this.demolishMode=!this.demolishMode,this.arrangeMode=!1,this.splitMode=!1,this.clearCombineMode()}toggleArrangeMode(){this.arrangeMode=!this.arrangeMode,this.demolishMode=!1,this.splitMode=!1,this.clearCombineMode()}toggleCombineMode(){this.combineMode=!this.combineMode,this.splitMode=!1,this.demolishMode=!1,this.arrangeMode=!1}toggleSplitMode(){this.splitMode=!this.splitMode,this.combineMode=!1,this.demolishMode=!1,this.arrangeMode=!1}clearCombineMode(){this.combineMode=!1,this.regionService.clearCombineMode()}isUrbanPlanningEnabled(){return this.gameService.isEnabled(Mf.URBAN_PLANNING)}hasCombinableBuildings(){return this.getBuildings().filter(e=>e.isCombinable()).length>1}hasSplittableBuildings(){return this.getBuildings().filter(e=>e.isSplittable()).length>=1}onKeydownHandler(e){this.demolishMode=!1,this.arrangeMode=!1,this.clearCombineMode()}enableAll(){this.getBuildings().filter(e=>e.isStoppable()).forEach(e=>{e.stopProduction(),e.startProduction()})}disableAll(){this.getBuildings().filter(e=>e.isStoppable()).forEach(e=>e.stopProduction())}isPagedViewEnabled(){return this.optionsService.getOption(Xf.PAGED_VIEW)}getBuildingPerPage(){return this.optionsService.getOption(Xf.BUILDINGS_PER_PAGE)}getPagesNumber(){let e=Math.ceil(this.getBuildings().length/this.getBuildingPerPage());return 0===e&&(e=1),Array.apply(null,Array(e)).map(function(e,t){return t})}setPage(e){this.currentPage=e}getPagedBuildings(){const e=this.getBuildingPerPage();return this.getBuildings().slice(this.currentPage*e,this.currentPage*e+e)}autoSort(){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to <b>auto sort</b> buildings?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&this.regionService.autoSort()})}autoMerge(){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to <b>auto merge</b> buildings?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&this.regionService.autoMerge()})}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(dv),Mo(yS),Mo(vS),Mo(nc),Mo(Kf))},e.\u0275cmp=Ve({type:e,selectors:[["ng-component"]],hostBindings:function(e,t){1&e&&Vo("keydown.escape",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class pv extends LS{constructor(e=null,t,i,s,r,n,o,a,c,l,u){super(t,i,e,s,!1,!0,!1,l),this.occupants=r,this.progress=n,this.food=o,this.fuel=a,this.clothes=c,this.enabled=u,this.maxSize=s.MAX_OCCUPANTS,this.servicesService&&(this.villageService=e.getVillageService(),this.weatherService=e.getWeatherService(),this.religionService=e.getService(Zf.RELIGION),this.managementService=e.getManagementService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,occupants:this.occupants,maxSize:this.maxSize,progress:this.progress,food:this.food,fuel:this.fuel,clothes:this.clothes,enabled:this.enabled}}getLine(e){switch(e){case PS.FIRST:return wS.textValue("occupants: "+this.occupants+"/"+this.maxSize);case PS.SECOND:return wS.progressValue(this.occupants<this.maxSize?this.progress:-1);case PS.THIRD:return this.food>0||0===this.occupants?wS.emptyValue():wS.progressValue(Math.abs(this.food),"famine");case PS.FOURTH:return this.fuel>=0?this.weatherService.getCurrentTemperature()<10&&this.occupants>0?wS.textValue("heating"):wS.emptyValue():wS.progressValue(Math.abs(this.fuel),"freezing")}}tick(){if(!this.enabled)return;if(this.occupants>0){const e=this.getHousingQuality(this.getBuildingType()),t=this.getBestHousingQualityPossible();e<t&&this.happinessService.registerHouseQualityHappiness((e-t)*this.occupants,this.occupants)}this.clothes<50&&(this.resourcesService.decreaseResource(Df.CLOTHES,1,this.getName()+" clothing")?(this.clothes+=50,this.happinessService.updateFurClothes(this.getBuildingId(),!1)):this.managementService.getFurClothes()&&this.resourcesService.decreaseResource(Df.FUR,1,this.getName()+" clothing")?(this.clothes+=2,this.happinessService.updateFurClothes(this.getBuildingId(),!0)):0===this.clothes&&this.happinessService.clearFurClothes(this.getBuildingId()));let e=!0;for(;this.food<=this.settings.STORAGE-50&&e;){let t=this.resourcesService.getPriorityFood(this.getName());if(0===t&&(e=!1),this.food<0){const e=Math.abs(this.food)/2;t>=e?(t-=e,this.food=0):(this.food-=2*t,t=0)}this.food+=t}const t=Number(this.managementService.getRations());for(let r=0;r<this.occupants;r++)this.food>0?(this.food-=.5*t,1===t?this.happinessService.registerFoodHappiness(-1):this.happinessService.getHappiness()<75&&(2===t||(3===t?this.happinessService.registerFoodHappiness(2):4===t&&this.happinessService.registerFoodHappiness(3)))):(this.food-=.5,this.happinessService.registerFoodHappiness(-3));this.food<0&&0===this.occupants&&(this.food=0),this.food<-100&&this.occupants>0&&(this.occupants-=1,this.food=-1,this.resourcesService.removePeople(1)),this.food<0&&this.occupants>0&&this.religionService.getFaithShield()>0&&(this.food=100*this.religionService.decreaseFaithShield(Math.abs(this.food)/100)),this.fuel<=this.settings.STORAGE-50&&(this.fuel+=this.resourcesService.getFuel(this.getName()));const i=this.weatherService.getCurrentTemperature(),s=this.managementService.getClothesRations();if(i<10&&this.occupants>0){let e=.2*(10-i)/10*(this.settings.SIZE/10*(1-this.settings.FUEL_EFFICIENCY));if(this.clothes>0?(this.clothes-=.01*this.occupants*s,e/=s+1,this.clothes<0&&(this.clothes=0),this.happinessService.registerClothesHappiness(s*this.occupants,this.occupants)):this.happinessService.registerClothesHappiness(-3*this.occupants,this.occupants),this.fuel-e<-100&&this.resourcesService.getPeople()+this.resourcesService.getWorkers()>0){const e=[{item:Yf.COLD,chance:pS.getSickness(Yf.COLD).CHANCE},{item:Yf.FLU,chance:pS.getSickness(Yf.FLU).CHANCE},{item:Yf.PNEUMONIA,chance:pS.getSickness(Yf.PNEUMONIA).CHANCE}],t=am.randomElement(e,!0);null!=t&&(this.managementService.getLogSickness()&&this.logService.warning(t===Yf.PNEUMONIA?"Villager developed "+Qf.prepareSicknessName(t):"Villager caught a "+Qf.prepareSicknessName(t)),this.resourcesService.addSick(t)),this.fuel=0}else this.fuel-=e;if(this.fuel<0&&this.occupants>0&&this.religionService.getFaithShield()>0)return void(this.fuel=200*this.religionService.decreaseFaithShield(Math.abs(this.food)/200));this.fuel<0&&this.happinessService.registerFreezingHappiness(-1*this.occupants,this.occupants)}else this.fuel<0&&(this.fuel=0),i>10&&(this.clothes>0?(this.clothes-=.005*this.occupants*s,this.clothes<0&&(this.clothes=0),this.happinessService.registerClothesHappiness(s*this.occupants,this.occupants)):this.happinessService.registerClothesHappiness(-3*this.occupants,this.occupants));this.progress<100&&this.occupants<this.maxSize&&this.food>0?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):this.occupants<this.maxSize&&100===this.progress?(this.occupants+=1,this.resourcesService.createPeople(1),this.progress=0):this.progress>0&&this.food<=0&&(this.progress-=this.getPower())}build(){return this.resourcesService.increasePopulationCap(this.maxSize),this}prepareDemolish(){if(this.occupants>0){const e=this.villageService.moveOccupants(this,this.occupants,this.food,this.fuel,this.clothes);this.resourcesService.removePeople(e)}return this.resourcesService.decreasePopulationCap(this.maxSize),!0}getDetails(){return"occupants: "+this.occupants+"/"+this.maxSize+"<br>food nutrition: "+Qf.round(this.food,2)+"<br>heating fuel: "+Qf.round(this.fuel,2)+"<br>clothes: "+Qf.round(this.clothes,2)+"<br>"+super.getDetails()}hasDetails(){return!0}stopProduction(){this.enabled=!1}startProduction(){return this.enabled=!0,!0}isStoppable(){return 0===this.occupants||!this.enabled}isWorking(){return this.enabled}getMaxSize(){return this.maxSize}getOccupants(){return this.occupants}addOccupant(){return this.occupants<this.maxSize&&(this.occupants+=1,this.occupants===this.maxSize&&(this.progress=0),!0)}removeOccupant(){return this.occupants>0&&(this.occupants-=1,!0)}addFood(e){this.food+=e}addFuel(e){this.fuel+=e}addClothes(e){this.clothes+=e}fireWorker(){return!1}hireWorker(){return!1}getWorkers(){return 0}setBuildingLevel(e){}getBuildingData(){return{food:this.food,fuel:this.fuel,clothes:this.clothes,enabled:this.enabled}}setBuildingData(e){this.food=e.food,this.fuel=e.fuel,this.clothes=e.clothes,this.enabled=e.enabled}getHousingQuality(e){switch(e){case Lf.HUT:return 1;case Lf.HOUSE:return 2;case Lf.LONGHOUSE:return 3;case Lf.TUDOR_HOUSE:return 4;case Lf.SETTLEMENT:return 5;default:return 0}}getBestHousingQualityPossible(){return this.gameService.isEnabled(Mf.SETTLEMENT)?this.getHousingQuality(Lf.SETTLEMENT):this.gameService.isEnabled(Mf.TUDOR_HOUSE)?this.getHousingQuality(Lf.TUDOR_HOUSE):this.gameService.isEnabled(Mf.LONGHOUSE)?this.getHousingQuality(Lf.LONGHOUSE):this.gameService.isEnabled(Mf.HOUSE)?this.getHousingQuality(Lf.HOUSE):this.getHousingQuality(Lf.HUT)}}class fv extends pv{constructor(e=null,t=-1,i=0,s=0,r=100,n=100,o=0,a=1,c=!0){super(e,t,Lf.HUT,nS.VILLAGE.HUT,i,s,r,n,o,a,c)}}class mv extends pv{constructor(e=null,t=-1,i=0,s=0,r=100,n=100,o=0,a=1,c=!0){super(e,t,Lf.HOUSE,nS.VILLAGE.HOUSE,i,s,r,n,o,a,c)}}class Sv{constructor(e,t=!1,i=0,s=!1){this.name=e,this.enabled=t,this.reserved=i,this.reservedPercent=s}}class Ev{constructor(e=!1,t=0,i=!1,s=0,r=!1,n=0,o=!1,a=0){this.autoSellEnabled=e,this.autoSellAmount=t,this.autoSellPercentage=i,this.autoSellOrder=s,this.autoBuyEnabled=r,this.autoBuyAmount=n,this.autoBuyPercentage=o,this.autoBuyOrder=a}static clone(e){return new Ev(e.autoSellEnabled,e.autoSellAmount,e.autoSellPercentage,e.autoSellOrder,e.autoBuyEnabled,e.autoBuyAmount,e.autoBuyPercentage,e.autoBuyOrder)}}class vv{constructor(e,t=0,i=[new Sv("Crafting"),new Sv("Kitchen"),new Sv("Manufacture"),new Sv("Hut"),new Sv("House"),new Sv("Longhouse"),new Sv("Tudor house"),new Sv("Settlement"),new Sv("Bakery"),new Sv("Tailor"),new Sv("Tavern"),new Sv("Tannery"),new Sv("Sawmill"),new Sv("Windmill"),new Sv("Cotton mill"),new Sv("Brewery"),new Sv("Winery"),new Sv("Stonemason"),new Sv("Mint"),new Sv("Fishers hut"),new Sv("Paper mill")].sort((e,t)=>e.name.localeCompare(t.name)),s=!1,r=null){this.resource=e,this.reserve=t,this.reservePercent=s,this.consumers=i,this.autoTrade=null===r?new Ev:r}static clone(e){const t=[];return e.consumers.forEach(e=>t.push(new Sv(e.name,e.enabled,e.reserved,e.reservedPercent))),new vv(e.resource,e.reserve,t,e.reservePercent,Ev.clone(e.autoTrade))}getReservedAmountBySource(e,t,i){let s=0,r=!1;return i?0:(s=this.reserve,r=this.reservePercent,this.consumers.forEach(t=>{t.enabled&&t.name===e&&(s=t.reserved,r=t.reservedPercent)}),r?Math.floor(s/100*t.getLimit()):s)}isUsed(){let e=!1;return 0!==this.reserve||(this.consumers.forEach(t=>{t.enabled&&(e=!0)}),(this.autoTrade.autoSellEnabled||this.autoTrade.autoBuyEnabled)&&(e=!0),e)}}class Rv{constructor(e,t,i,s,r,n,o,a){this.resource=e,this.name=t,this.amount=i,this.limit=s,this.resourceTypes=r,this.visible=n,this.highlighted=o,this.prioritise=a,this.options=new vv(e)}toJSON(){return{amount:this.amount,limit:this.limit,visible:this.visible,highlighted:this.highlighted,prioritise:this.prioritise,options:this.options}}addResource(e){return this.amount+e>this.limit?(this.amount=this.limit,this.amount):(this.amount+=e,this.amount)}removeResource(e){return this.amount-e>0&&(this.amount-=e,!0)}getResource(){return this.resource}getName(){return this.name}getAmount(){return this.amount}getLimit(){return this.limit}getResourceTypes(){return this.resourceTypes}hasResourceType(e){return this.resourceTypes.indexOf(e)>-1}isVisible(){return this.visible}toggleVisible(){return this.visible=!this.visible,this.visible}isHighlighted(){return this.highlighted}toggleHighlighted(){return this.highlighted=!this.highlighted,this.highlighted}getFreeSpace(){return this.limit-this.amount}}class Ov{constructor(){this.amount=0,this.limit=0,this.resourceTypes=[],this.visible=!1,this.highlighted=!1,this.prioritise=!1}forResource(e){return this.resource=e,this}withName(e){return this.name=e,this}withAmount(e){return this.amount=e,this}withLimit(e){return this.limit=e,this}withResourceTypes(e){return e.forEach(e=>this.resourceTypes.push(e)),this}withResourceType(e){return this.resourceTypes.push(e),this}withVisible(e){return this.visible=e,this}withHighlighted(e){return this.highlighted=e,this}withPrioritise(e){return this.prioritise=e,this}build(){const e=new Rv(this.resource,this.name,this.amount,this.limit,this.resourceTypes,this.visible,this.highlighted,this.prioritise);return this.resource=void 0,this.name=void 0,this.amount=0,this.limit=0,this.resourceTypes=[],this.visible=!1,this.highlighted=!1,this.prioritise=!1,e}}var Tv=(()=>(function(e){e.ERROR_1="ERROR_1: Copying failed",e.ERROR_2="ERROR_2: Resource limit below 0",e.ERROR_3="ERROR_3: Workers below 0",e.ERROR_4="ERROR_4: Population Cap below 0",e.ERROR_5="ERROR_5: ",e.ERROR_6="ERROR_6: ",e.ERROR_7="ERROR_7: ",e.ERROR_8="ERROR_8: "}(Tv||(Tv={})),Tv))();class Iv{constructor(e,t,i=0){this.userName=e,this.value=t,this.daysAgo=i}incrementDaysAgo(){this.daysAgo+=1}}class bv{constructor(e,t,i=0){this.producerName=e,this.value=t,this.daysAgo=i}incrementDaysAgo(){this.daysAgo+=1}}class Cv{constructor(e,t=0,i=0){this.sickness=e,this.progress=t,this.medicine=i}}class yv{constructor(e,t,i,s){this.id=e,this.effect=t,this.value=i,this.duration=s}}let Av=(()=>{class e{constructor(e,t){this.servicesService=e,this.calendarService=t,this.happiness=15,this.happinessEffects=[],this.foodHappiness={value:0,weight:0},this.clothesHappiness={value:0,weight:0},this.freezingHappiness={value:0,weight:0},this.housingQuality={value:0,weight:0},this.furClothes=[],this.showDuration=!1,e.addService(Zf.HAPPINESS,this),t.registerForDayChange().subscribe(e=>{this.servicesService.getGameService().isEnabled(Mf.GALLEON)&&this.servicesService.getWorldService().hasPiratesBase()?this.updateHappiness($f.PIRATES_BASE_PRESENT,-3,-1):this.updateHappiness($f.PIRATES_BASE_PRESENT,0,-1),this.happinessEffects.filter(e=>e.duration>0).forEach(e=>e.duration-=1),this.happinessEffects=this.happinessEffects.filter(e=>0!==e.duration)})}getName(){return"HappinessService"}load(e){const t=this.servicesService.getVillageService();this.happiness=null==e.happiness||isNaN(e.happiness)?15:e.happiness,this.happinessEffects=void 0!==e.effects?e.effects:[],this.furClothes=void 0!==e.furClothes?e.furClothes.filter(e=>t.hasBuilding(e.id)):[],this.foodHappiness=void 0!==e.foodHappiness?e.foodHappiness:{value:0,weight:0},this.clothesHappiness=void 0!==e.clothesHappiness?e.clothesHappiness:{value:0,weight:0},this.freezingHappiness=void 0!==e.freezingHappiness?e.freezingHappiness:{value:0,weight:0},this.housingQuality=void 0!==e.housingQuality?e.housingQuality:{value:0,weight:0},this.showDuration=void 0!==e.showDuration&&e.showDuration}save(){return{happiness:this.happiness,effects:this.happinessEffects,foodHappiness:this.foodHappiness,clothesHappiness:this.clothesHappiness,freezingHappiness:this.freezingHappiness,housingQuality:this.housingQuality,furClothes:this.furClothes,showDuration:this.showDuration}}reset(e,t){this.happiness=15,this.happinessEffects=[],this.furClothes=[],this.foodHappiness={value:0,weight:0},this.clothesHappiness={value:0,weight:0},this.freezingHappiness={value:0,weight:0}}processSpecialHappiness(e,t){const i=Math.floor(e.value/(0!==e.weight?e.weight:1)),s=this.getHappinessEffectByEffect(t);0!==i?s?s.value=i:this.addHappinessEffect(0,t,i,-1):this.happinessEffects=this.happinessEffects.filter(e=>e.effect!==t),e.value=0,e.weight=0}tick(e){if(this.processSpecialHappiness(this.foodHappiness,$f.FOOD),this.processSpecialHappiness(this.clothesHappiness,$f.CLOTHES),this.processSpecialHappiness(this.freezingHappiness,$f.FREEZING),this.processSpecialHappiness(this.housingQuality,$f.LOW_QUALITY_HOUSING),this.furClothes=this.furClothes.filter(e=>this.servicesService.getVillageService().hasBuilding(e.id)&&void 0!==this.servicesService.getVillageService().getBuildings().find(t=>t.getBuildingId()===e.id).getOccupants&&this.servicesService.getVillageService().getBuildings().find(t=>t.getBuildingId()===e.id).isWorking()),this.furClothes.length>0){let e=0;if(this.furClothes.forEach(t=>{t.fur&&(e-=1)}),0!==e){const t=this.furClothes.length+e;e=Math.floor(e/(0!==t?t:-e)),this.updateHappiness($f.FUR_CLOTHES,e,-1)}else this.updateHappiness($f.FUR_CLOTHES,0,-1)}else this.updateHappiness($f.FUR_CLOTHES,0,-1);this.happiness+=this.calculateDailyChange()/10,this.happiness<0?this.happiness=0:this.happiness>100&&(this.happiness=100)}updateHappiness(e,t,i){const s=this.getHappinessEffectByEffect(e);s?(s.value=t,s.duration=i):this.addHappinessEffect(0,e,t,i)}getHappiness(){return this.happiness}updateFurClothes(e,t){const i=this.furClothes.find(t=>t.id===e);i?i.fur=t:this.furClothes.push({id:e,fur:t})}clearFurClothes(e){this.furClothes=this.furClothes.filter(t=>t.id!==e)}getHappinessEffect(){return this.happiness>=0&&this.happiness<=10?-10:this.happiness>10&&this.happiness<=40?0:this.happiness>40&&this.happiness<=60?10:this.happiness>60&&this.happiness<=90?20:this.happiness>90&&this.happiness<=100?50:void 0}registerFoodHappiness(e){this.foodHappiness.value+=e,this.foodHappiness.weight+=1}registerClothesHappiness(e,t){this.clothesHappiness.value+=e,this.clothesHappiness.weight+=t}registerFreezingHappiness(e,t){this.freezingHappiness.value+=e,this.freezingHappiness.weight+=t}registerHouseQualityHappiness(e,t){this.housingQuality.value+=e,this.housingQuality.weight+=t}resetHappiness(){this.happiness<15&&(this.happiness=15),this.clear()}addHappinessEffect(e,t,i,s){this.happinessEffects.push(new yv(e,t,i,s))}getHappinessEffectById(e){return this.happinessEffects.filter(t=>t.id===e)}getHappinessEffects(){return this.happinessEffects.filter(e=>0!==e.value)}getHappinessEffectByEffect(e){return this.happinessEffects.find(t=>t.effect===e)}calculateDailyChange(){let e=0;return this.happinessEffects.forEach(t=>e+=t.value),e/300}clear(){this.happinessEffects=[]}toggleShowDuration(){this.showDuration=!this.showDuration}getShowDuration(){return this.showDuration}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(OS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Nv{constructor(e,t,i,s,r,n,o){this.perk=e,this.usages=t,this.maxUsages=i,this.description=s,this.cost=r,this.reset=n,this.effect=o}}let _v=(()=>{class e{constructor(e,t,i){this.modalService=e,this.logService=t,this.servicesService=i,this.royalPoints=0,this.perks=[],this.goldenFish=!1,this.goldenEgg=!1,this.goldenApple=!1,this.goldenFleece=!1,this.servicesService.addService(Zf.ROYAL,this),this.initPerks()}initPerks(){this.perks=[],Object.entries(dS.PERKS).forEach(e=>{this.perks.push(new Nv(xf[e[0]],e[1].USAGES,e[1].MAX_USAGES,e[1].DESCRIPTION,e[1].COST,e[1].RESET,e[1].EFFECT))})}getName(){return"RoyalService"}load(e){this.royalPoints=e.royalPoints,this.goldenFish=void 0!==e.goldenFish&&e.goldenFish,this.goldenEgg=void 0!==e.goldenEgg&&e.goldenEgg,this.goldenApple=void 0!==e.goldenApple&&e.goldenApple,this.goldenFleece=void 0!==e.goldenFleece&&e.goldenFleece,e.progress.forEach(e=>{const t=this.perks.find(t=>t.perk===e[0]);t&&(t.usages=e[1])})}save(){const e=[];return this.perks.forEach(t=>e.push([t.perk,t.usages])),{royalPoints:this.royalPoints,progress:e,goldenFish:this.goldenFish,goldenEgg:this.goldenEgg,goldenApple:this.goldenApple,goldenFleece:this.goldenFleece}}reset(e,t){e?(this.royalPoints=0,this.initPerks()):this.perks.forEach(e=>{e.reset&&e.usages>0&&e.reset(this.servicesService,e)}),this.goldenFish=!1,this.goldenEgg=!1,this.goldenApple=!1,this.goldenFleece=!1}getRoyalPoints(){return this.royalPoints}buyRoyalPoints(){this.modalService.open(Pf.ROYAL)}increaseRoyalPoints(e){this.royalPoints+=e}getRoyalPerks(){return this.perks}unlock(e){(0===e.maxUsages||e.usages<e.maxUsages)&&(this.royalPoints>=e.cost?this.perks.find(t=>e===t).effect(this.servicesService,e):this.modalService.info("Not enough Royal Points!<br>"+e.cost+" RP required but only "+this.royalPoints+" available"))}unlockCallback(e){this.royalPoints-=Number(e.cost),e.usages+=1}isGoldenFishCaught(){return this.goldenFish}isGoldenEggLaid(){return this.goldenEgg}isGoldenApplePicked(){return this.goldenApple}isGoldenFleeceFound(){return this.goldenFleece}catchGoldenFish(){return!(this.goldenFish||!am.chance(dS.GOLDEN_ITEMS.GOLDEN_FISH_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("You have caught a golden fish. You let it go and it granted you 5 Royal Points"),this.goldenFish=!0,0))}layGoldenEgg(){return!(this.goldenEgg||!am.chance(dS.GOLDEN_ITEMS.GOLDEN_EGG_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("Your chicken laid golden egg. You decided to keep it and was granted 5 Royal Points"),this.goldenEgg=!0,0))}pickGoldenApple(){return!(this.goldenApple||!am.chance(dS.GOLDEN_ITEMS.GOLDEN_APPLE_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("You picked golden apple in the orchard. You decided to keep it and was granted 5 Royal Points"),this.goldenApple=!0,0))}getGoldenFleece(){return!(this.goldenFleece||!am.chance(dS.GOLDEN_ITEMS.GOLDEN_FLEECE_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("You got a golden fleece from one of your sheep. You decided to keep it and was granted 5 Royal Points"),this.goldenFleece=!0,0))}}return e.\u0275fac=function(t){return new(t||e)(gs(em),gs(IS),gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),wv=(()=>{class e{constructor(e,t,i,s){this.servicesService=e,this.modalService=t,this.royalService=i,this.logService=s,e.addService(Zf.KONGREGATE,this);try{kongregateAPI.loadAPI(function(){window.kongregate=kongregateAPI.getAPI();const e=[],t=function(t){if(t.success){const s=e.find(e=>e[0]===t.id);s&&i.increaseRoyalPoints(s[1])}};window.kongregate.mtx.requestUserItemList(null,function(i){if(i.success)for(let s=0;s<i.data.length;s++){const r=i.data[s];e.push([r.id,Number(r.identifier.replace("rp_pack",""))]),window.kongregate.mtx.useItemInstance(r.id,t)}})})}catch(r){console.error(r)}}isSet(){return!!window.kongregate}isAvailable(){return window.kongregate&&0!==this.getUserId()}submitStat(e,t){window.kongregate.stats.submit(e,t)}getUsername(){if(this.isSet())return window.kongregate.services.getUsername()}isGuest(){return!this.isSet()||window.kongregate.services.isGuest()}getUserId(){if(this.isSet())return window.kongregate.services.getUserId()}getGameAuthToken(){if(this.isSet())return window.kongregate.services.getGameAuthToken()}buyItem(e){const t=this.modalService,i=this.royalService,s=this.logService,r=[],n=function(e){if(e.success){const t=r.find(t=>t[0]===e.id);t&&(i.increaseRoyalPoints(t[1]),s.log("Added "+t[1]+" Royal Points"))}},o=function(e){if(e.success)for(let t=0;t<e.data.length;t++){const i=e.data[t];r.push([i.id,Number(i.identifier.replace("rp_pack",""))]),window.kongregate.mtx.useItemInstance(i.id,n)}};window.kongregate.mtx.purchaseItems([e],function(e){e.success&&(t.close(Pf.ROYAL),window.kongregate.mtx.requestUserItemList(null,o))})}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(em),gs(_v),gs(IS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Pv=(()=>{class e{constructor(e,t,i,s,r,n,o,a){this.logService=e,this.servicesService=t,this.gameService=i,this.modalService=s,this.optionsService=r,this.happinessService=n,this.calendarService=o,this.kongregateService=a,this.resources=new Map,this.resourcesUse=new Map,this.resourcesProduction=new Map,this.sick=[],this.populationScore=0,this.resourcesSubject=new b,this.callbacks=new Map,this.hideEmpty=!1,t.addService(Zf.RESOURCES,this),this.init(),o.registerForDayChange().subscribe(()=>{Array.from(this.resourcesUse.keys()).forEach(e=>{this.resourcesUse.set(e,this.resourcesUse.get(e).filter(e=>e.daysAgo<30)),this.resourcesUse.get(e).forEach(e=>e.incrementDaysAgo()),0===this.resourcesUse.get(e).length&&this.resourcesUse.delete(e)}),Array.from(this.resourcesProduction.keys()).forEach(e=>{this.resourcesProduction.set(e,this.resourcesProduction.get(e).filter(e=>e.daysAgo<30)),this.resourcesProduction.get(e).forEach(e=>e.incrementDaysAgo()),0===this.resourcesProduction.get(e).length&&this.resourcesProduction.delete(e)})})}init(){const e=new Ov;oS.getResources().forEach(t=>{this.resources.set(Df[t[0]],e.forResource(Df[t[0]]).withName(Qf.prepareResourceName(Df[t[0]])).withAmount(void 0!==t[1].AMOUNT?t[1].AMOUNT:oS.DEFAULT_AMOUNT).withLimit(void 0!==t[1].LIMIT?t[1].LIMIT:oS.DEFAULT_LIMIT).withResourceTypes(t[1].TYPES).withResourceType(Gf.ALL).withVisible(void 0!==t[1].VISIBLE?t[1].VISIBLE:oS.DEFAULT_VISIBLE).withHighlighted(void 0!==t[1].HIGHLIGHTED?t[1].HIGHLIGHTED:oS.DEFAULT_HIGHLIGHTED).build())}),this.people=1,this.workers=0,this.populationCap=1,Am.production||this.resources.forEach(e=>e.visible=!0)}getResource(e){return this.resources.get(e)}makeVisible(e){this.resources.get(e).visible=!0}increaseResource(e,t,i,s=!1){if(e===Df.FOOD||e===Df.NOTHING)return!0;const r=this.resources.get(e);if(r.getResourceTypes().includes(Gf.ANIMAL)){const r=this.servicesService.getServiceByRegion(Kf.FIELD),n=r.getBuildings().filter(e=>e.getBuildingType()===Lf.PASTURE).map(e=>e).filter(t=>t.getResourceType()===e);let o=0;if(n.forEach(e=>o+=e.getMaxAnimals()-e.getAnimals()),t>o&&!s)return!1;if(s&&t>o){let i=t-o;t=o;let s=r.getBuildings().filter(e=>e.getBuildingType()===Lf.BUTCHER).map(e=>e).filter(e=>e.getFreeSpace()>0);for(;s.length>0&&i>0;)s[0].addAnimalToButcher(e),i-=1,s=s.filter(e=>e.getFreeSpace()>0)}for(;t>0&&o>0;)for(const s of n){for(;s.getAnimals()<s.getMaxAnimals()&&t>0;)s.increaseAnimal(1),t-=1,this.addResourceProduction(e,i,1),o-=1;if(0===t)return!0}return!0}return!(!s&&r.amount+t>r.limit||(r.amount+=t,this.addResourceProduction(e,i,t),r.amount>r.limit&&(r.amount=r.limit),this.resourcesSubject.next(this.resources),r.isVisible()||(r.toggleVisible(),this.logService.log("New resource discovered: "+Qf.prepareResourceName(e))),0))}decreaseResource(e,t,i,s=!1){if(e===Df.FOOD)return this.getFoodValue(i,s)>=t&&(this.getFood(t,i,s),!0);const r=this.resources.get(e);if(r.getResourceTypes().includes(Gf.ANIMAL)){const s=this.servicesService.getServiceByRegion(Kf.FIELD).getBuildings().filter(e=>e.getBuildingType()===Lf.PASTURE).map(e=>e).filter(t=>t.getResourceType()===e&&t.getAnimals()>0);let r=0;if(s.forEach(e=>r+=e.getAnimals()),r>=t){for(const r of s){for(;t>0&&r.getAnimals()>0;)r.decreaseAnimal(1),this.addResourceUse(e,i,1),t-=1;if(0===t)return!0}return!0}return!1}return 0!==this.hasResource(e,t,i,s)?(this.resourcesSubject.next(this.resources),!1):(r.amount-=t,this.addResourceUse(e,i,t),this.resourcesSubject.next(this.resources),!0)}hasResource(e,t,i,s=!1){if(e===Df.FOOD)return this.getFoodValue(i,s)>=t?0:t-this.getFoodValue(i,s);const r=this.resources.get(e);return s?r.amount>=t?0:t-this.resources.get(e).amount:r.amount-r.options.getReservedAmountBySource(i,r,s)>=t?0:t-(r.amount-r.options.getReservedAmountBySource(i,r,s))}hasLimit(e){return this.resources.get(e).amount<this.resources.get(e).limit}decreaseResources(e,t,i=!1,s=1,r=!1){let n="",o=!0;for(const[a,c]of Array.from(e)){const e=this.hasResource(a,c*s,t,i);0!==e&&(n+="Missing "+e+" "+Qf.prepareResourceName(a)+"<br>",o=!1)}if(!o)return r||this.modalService.info(n),!1;for(const[a,c]of Array.from(e))this.decreaseResource(a,c*s,t,i);return!0}hasResources(e,t,i=1,s=!1){let r=!0;for(const[n,o]of Array.from(e))0!==this.hasResource(n,o*i,t,s)&&(r=!1);return r}increaseLimit(e,t){this.resources.forEach(i=>{i.getResourceTypes().includes(e)&&!i.getResourceTypes().includes(Gf.ANIMAL)&&(i.limit+=t)})}increaseResourceLimit(e,t){this.resources.get(e).limit+=t}decreaseLimit(e,t){this.resources.forEach(i=>{i.getResourceTypes().includes(e)&&!i.getResourceTypes().includes(Gf.ANIMAL)&&(i.limit-=t,i.limit<0&&(i.limit=0,console.error(Tv.ERROR_2,i.getResource(),i.limit)),i.amount>i.limit&&(i.amount=i.limit))})}decreaseResourceLimit(e,t){const i=this.resources.get(e);i.limit-=t,i.limit<0&&(i.limit=0,console.error(Tv.ERROR_2,i.getResource(),i.limit)),i.amount>i.limit&&(i.amount=i.limit)}getResources(){return this.resources}save(){let e="[";return this.resources.forEach(t=>{e+="["+t.resource+","+JSON.stringify(t)+"],"}),e=e.slice(0,-1)+"]",{resources:e,people:this.people,workers:this.workers,sick:this.sick,populationCap:this.populationCap}}getName(){return"ResourcesService"}load(e){JSON.parse(e.resources).forEach(e=>{if(this.resources.get(e[0]).amount=e[1].amount,this.resources.get(e[0]).limit=e[1].limit,this.resources.get(e[0]).visible=e[1].visible,this.resources.get(e[0]).highlighted=e[1].highlighted,this.resources.get(e[0]).prioritise=e[1].prioritise,e[1].reserved)this.resources.get(e[0]).options=new vv(this.resources.get(e[0]).resource,e[1].reserved);else if(e[1].options){let t=[];const i=new Ev;e[1].options.consumers.forEach(e=>{t.push(new Sv(e.name,e.enabled,e.reserved,void 0!==e.reservedPercent&&e.reservedPercent))}),t.find(e=>"Paper mill"===e.name)||t.push(new Sv("Paper mill")),t.find(e=>"Tudor house"===e.name)||t.push(new Sv("Tudor house")),t.find(e=>"Settlement"===e.name)||t.push(new Sv("Settlement")),t.find(e=>"Kitchen"===e.name)||t.push(new Sv("Kitchen")),e[1].options.autoTrade&&(i.autoSellEnabled=e[1].options.autoTrade.autoSellEnabled,i.autoSellAmount=e[1].options.autoTrade.autoSellAmount,i.autoSellOrder=e[1].options.autoTrade.autoSellOrder,i.autoBuyEnabled=e[1].options.autoTrade.autoBuyEnabled,i.autoBuyAmount=e[1].options.autoTrade.autoBuyAmount,i.autoBuyOrder=e[1].options.autoTrade.autoBuyOrder,void 0!==e[1].options.autoTrade.autoSellPercentage?(i.autoSellPercentage=e[1].options.autoTrade.autoSellPercentage,i.autoBuyPercentage=e[1].options.autoTrade.autoBuyPercentage):(i.autoSellPercentage=!1,i.autoBuyPercentage=!1)),t=t.sort((e,t)=>e.name.localeCompare(t.name)),this.resources.get(e[0]).options=new vv(e[1].options.resource,e[1].options.reserve,t,void 0!==e[1].options.reservePercent&&e[1].options.reservePercent,i)}else this.resources.get(e[0]).options=new vv(this.resources.get(e[0]).resource)}),this.sick=void 0!==e.sick?e.sick:[],this.people=e.people,this.workers=e.workers,this.populationCap=e.populationCap,this.resourcesSubject.next(this.resources)}reset(e,t){if(!e){const e=this.servicesService.getService(Zf.HERITAGE).calculateHeritagePoints(!0);e.hp>0&&this.servicesService.getService(Zf.HERITAGE).increaseHeritagePoints(e.hp),e.xp>0&&this.servicesService.getService(Zf.HERITAGE).increaseXP(e.xp)}const i=this.resources;this.resources=new Map,this.people=1,this.workers=0,this.populationCap=1,this.sick=[],this.populationScore=0,this.resourcesUse=new Map,this.resourcesProduction=new Map,this.init(),e||Array.from(this.resources.values()).forEach(e=>{this.optionsService.getOption(Xf.KEEP_RESERVATION_SETTINGS_ON_RESET)?e.options=i.get(e.resource).options:(e.options=i.get(e.resource).options,e.options.reservePercent=!1,e.options.reserve=0,e.options.consumers.forEach(e=>e.enabled=!1)),this.optionsService.getOption(Xf.KEEP_AUTO_TRADE_ON_RESET)||(e.options.autoTrade.autoSellEnabled=!1,e.options.autoTrade.autoBuyEnabled=!1)}),this.resourcesSubject.next(this.resources)}registerForResourcesChange(){return this.resourcesSubject.asObservable()}createPeople(e){this.people+=e}removePeople(e){if(this.people-=e,this.people-e<0)for(;this.people<0;)if(this.sick.length>0)this.sick.shift(),this.people+=1;else{const e=Math.floor(Math.random()*this.callbacks.size);Array.from(this.callbacks.values())[e].fireRandomWorker()}}hireWorker(){return this.people>0&&(this.people-=1,this.workers+=1,!0)}fireWorker(e=1){0===this.workers&&console.error(Tv.ERROR_3),this.workers-=e,this.people+=e}getPeople(){return this.people}getWorkers(){return this.workers}getPopulationCap(){return this.populationCap}increasePopulationCap(e){return this.populationCap+=e}decreasePopulationCap(e){return this.populationCap-e<0&&console.error(Tv.ERROR_4),this.populationCap-=e}addCallback(e,t){this.callbacks.set(t,e)}tick(e){this.kongregateService.isAvailable()&&this.getTotalPeople()>this.populationScore&&(this.populationScore=this.getTotalPeople(),this.kongregateService.submitStat("Population",this.populationScore)),1===this.getTotalPeople()&&this.happinessService.resetHappiness(),this.people+this.workers>=nS.VILLAGE.SHRINE.POPULATION&&(this.gameService.isEnabled(Mf.SHRINE)||(this.gameService.enable(Mf.SHRINE),this.logService.success("Shrine unlocked"))),this.people+this.workers>=nS.VILLAGE.CHURCH.POPULATION&&(this.gameService.isEnabled(Mf.CHURCH)||(this.gameService.enable(Mf.CHURCH),this.logService.success("Church unlocked"))),this.getTotalPeople()>1500?this.happinessService.updateHappiness($f.POPULATION_SIZE,-3,-1):this.getTotalPeople()>500?this.happinessService.updateHappiness($f.POPULATION_SIZE,-2,-1):this.getTotalPeople()>100&&this.happinessService.updateHappiness($f.POPULATION_SIZE,-1,-1),this.sick=this.sick.filter(e=>!am.chance(pS.getSickness(e.sickness).LETHALITY/100/(10*pS.getSickness(e.sickness).DURATION))||(this.callbacks.get(Kf.VILLAGE).removeRecruit(1,!1),this.servicesService.getManagementService().getLogSickness()&&(this.logService.warning("Villager died from "+Qf.prepareSicknessName(e.sickness)),this.happinessService.addHappinessEffect(0,$f.SICKNESS_DEATH,-2,am.randomBetween(20,40))),!1)),this.sick.forEach(e=>{0===e.medicine&&this.decreaseResource(Df.HERBAL_MEDICINE,1,"Sickness")&&(e.medicine=1),e.progress+=e.medicine>0?100/(10*pS.getSickness(e.sickness).DURATION)*2:100/(10*pS.getSickness(e.sickness).DURATION)}),this.sick.forEach(e=>{e.progress>=100&&(this.people+=1)}),this.sick=this.sick.filter(e=>e.progress<100)}getPriorityFood(e,t=!1){const i=this.servicesService.getManagementService().getFoodPriority();for(const s in i){const r=i[s].filter(i=>this.getAvailableAmount(i,e,t)>0);if(r.length>0&&r.length>0){const i=r[Math.floor(Math.random()*r.length)];return this.decreaseResource(i,1,e,t),oS.getResource(i).POWER}}return 0}getFood(e,t,i=!1){for(;e>0;)e-=this.getPriorityFood(t,i)}getFoodValue(e,t=!1){let i,s=0;return t?(i=Array.from(this.resources.entries()).filter(e=>e[1].resourceTypes.includes(Gf.CONSUMABLE)&&e[1].amount>0),i.forEach(e=>s+=oS.getResource(e[0]).POWER*e[1].amount)):(i=Array.from(this.resources.entries()).filter(i=>i[1].resourceTypes.includes(Gf.CONSUMABLE)&&i[1].amount-i[1].options.getReservedAmountBySource(e,i[1],t)>0),i.forEach(e=>s+=oS.getResource(e[0]).POWER*(e[1].amount-e[1].options.reserve))),s}getResourceTypes(e){return this.resources.get(e).getResourceTypes()}increaseResources(e,t,i=!1){for(const[s,r]of Array.from(e))this.increaseResource(s,r,t,i)}removeRecruit(e){return this.people>=e&&this.callbacks.get(Kf.VILLAGE).removeRecruit(e)}getFuel(e){const t=oS.getResourcesByType(Gf.FUEL).sort((e,t)=>e[1].FUEL_PRIORITY-t[1].FUEL_PRIORITY);for(const i of t)if(this.decreaseResource(Df[String(i[0])],1,e))return i[1].POWER;return 0}getTotalPeople(){return this.people+this.workers+this.sick.length}getResourcesValue(){let e=0;return this.resources.forEach(t=>{t.amount>0&&(e+=oS.getResource(t.resource).TRADE_VALUE*t.getAmount())}),e}getAvailableAmount(e,t,i=!1){const s=this.resources.get(e);let r=s.amount-s.options.getReservedAmountBySource(t,s,i);return r<0&&(r=0),r}updateAnimals(){const e=Array.from(this.getResources().values()).filter(e=>e.getResourceTypes().includes(Gf.ANIMAL)),t=this.servicesService.getServiceByRegion(Kf.FIELD).getBuildings().filter(e=>e.getBuildingType()===Lf.PASTURE).map(e=>e);e.forEach(e=>{let i=0,s=0;t.filter(t=>t.getResourceType()===e.resource).forEach(e=>{i+=e.getAnimals(),s+=e.getMaxAnimals()}),e.amount=i,e.limit=s})}getLimit(e){const t=this.resources.get(e);return t.limit-t.amount}addResourceUse(e,t,i){this.resourcesUse.has(e)?this.resourcesUse.get(e).push(new Iv(t,i)):this.resourcesUse.set(e,[new Iv(t,i)])}addResourceProduction(e,t,i){this.resourcesProduction.has(e)?this.resourcesProduction.get(e).push(new bv(t,i)):this.resourcesProduction.set(e,[new bv(t,i)])}getResourceUses(e){return this.resourcesUse.get(e)}getResourceProductions(e){return this.resourcesProduction.get(e)}getResourcesByType(e){return Array.from(this.resources.values()).filter(t=>t.getResourceTypes().includes(e))}getFuelValue(){let e=0;return Array.from(this.resources.values()).filter(e=>e.getResourceTypes().includes(Gf.FUEL)).forEach(t=>e+=t.amount*oS.getResource(t.resource).POWER),e}checkResourcesBeforeWinter(){160*this.servicesService.getVillageService().getHousingBuildings().length>this.getFuelValue()&&this.logService.warning("We might not have enough available resources to heat our homes during winter!")}getAverageNutritionProduction(){let e=0,t=1;return this.getResourcesByType(Gf.CONSUMABLE).forEach(i=>{const s=this.getResourceProductions(i.resource);s&&s.forEach(s=>{s.daysAgo>t&&(t=s.daysAgo),e+=s.value*oS.getResource(i.resource).POWER})}),e/t}addSick(e){if(this.people-=1,this.sick.push(new Cv(e)),this.people-1<0)for(;this.people<0;){const e=Math.floor(Math.random()*this.callbacks.size);Array.from(this.callbacks.values())[e].fireRandomWorker()}}getSick(){return this.sick}addAnimalProducedData(e,t,i){this.addResourceProduction(e,t,i)}addAnimalUsedData(e,t,i){this.addResourceUse(e,t,i)}getHideEmpty(){return this.hideEmpty}toggleHideEmpty(){this.hideEmpty=!this.hideEmpty}}return e.\u0275fac=function(t){return new(t||e)(gs(IS),gs(Jf),gs(AS),gs(em),gs(vS),gs(Av),gs(OS),gs(wv))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Mv=(()=>(function(e){e.CHOPPING_TREES="chopping trees",e.WAITING_FOR_TREES="waiting for trees",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING_LOG="transporting log"}(Mv||(Mv={})),Mv))();class Lv extends LS{constructor(e=null,t=-1,i=0,s=0,r=Mv.WAITING_FOR_TREES,n=!1,o=1){super(t,Lf.LOGGERS_HUT,e,nS.FOREST.LOGGERS_HUT,n,!0,!0,o),this.progress=i,this.reservedTrees=s,this.status=r,this.servicesService&&(this.landService=e.getLandService())}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}tick(){!this.working||(this.status===Mv.WAITING_FOR_TREES?this.landService.reduceForest(1)&&(this.status=Mv.CHOPPING_TREES):this.status===Mv.CHOPPING_TREES?this.progress<100&&(this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.status=Mv.TRANSPORTING_LOG)):(this.status===Mv.TRANSPORTING_LOG||this.status===Mv.WAITING_FOR_WAREHOUSE_SPACE)&&(this.resourcesService.increaseResource(Df.LOG,1,this.getName())?(this.landService.increaseLand(1,!0),this.status=this.landService.reduceForest(1)?Mv.CHOPPING_TREES:Mv.WAITING_FOR_TREES):this.status=Mv.WAITING_FOR_WAREHOUSE_SPACE))}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,reservedTrees:this.reservedTrees}}}var Dv=(()=>(function(e){e.PLANTING_TREES="planting trees",e.WAITING_FOR_LAND="waiting for land",e.NO_ENOUGH_LAND="no enough free land",e.FOREST_TOO_BIG="forest too big"}(Dv||(Dv={})),Dv))();class xv extends LS{constructor(e=null,t=-1,i=0,s=0,r=Dv.WAITING_FOR_LAND,n=1,o=!1,a=1){super(t,Lf.FORESTER,e,nS.FOREST.FORESTER,o,!0,!0,a),this.progress=i,this.localStorage=s,this.status=r,this.effectiveness=n,this.servicesService&&(this.landService=e.getLandService(),this.modalService=e.getModalService())}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}tick(){if(this.working){if(0===this.localStorage){const e=this.landService.getForestOptions();if(e.forestSizeRuleEnabled&&this.landService.getForest()>=e.forestSizeRule)return void(this.status=Dv.FOREST_TOO_BIG);if(e.landSizeRuleEnabled&&this.landService.getLand()<=e.landSizeRule)return void(this.status=Dv.NO_ENOUGH_LAND);this.landService.reduceLand(this.effectiveness)?(this.localStorage=this.effectiveness,this.status=Dv.PLANTING_TREES):this.status=Dv.WAITING_FOR_LAND}this.localStorage>0&&(this.progress<100?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):(this.landService.increaseForest(this.localStorage,!1),this.progress=0,this.localStorage=0))}}prepareDemolish(){return this.localStorage>0&&this.landService.increaseLand(this.localStorage,!0),super.prepareDemolish()}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,localStorage:this.localStorage,status:this.status,effectiveness:this.effectiveness,working:this.working}}}class kv{constructor(e,t,i,s,r,n=!1,o=!1,a=""){this.enabled=e,this.buildingType=t,this.seasons=i,this.inputSettings=s,this.outputSettings=r,this.customRuleEnabled=o,this.hasCustomRule=n,this.customRuleText=a}static clone(e){let t=null,i=null;return e.inputSettings&&(t=[],e.inputSettings.forEach(e=>{t.push([e[0],e[1]])})),e.outputSettings&&(i=[],e.outputSettings.forEach(e=>{i.push([e[0],e[1],e[2]])})),new kv(e.enabled,e.buildingType,[e.seasons[0],e.seasons[1],e.seasons[2],e.seasons[3]],t,i,e.hasCustomRule,e.customRuleEnabled,e.customRuleText)}}var Fv=(()=>(function(e){e.FETCHING_INPUT="fetching {in}",e.WAITING_FOR_INPUT="waiting for {wait}",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.PREPARING="preparing {out}",e.PRODUCING_OUTPUT="{prod} {out}",e.TRANSPORTING_OUTPUT="transporting {out}"}(Fv||(Fv={})),Fv))();class Uv extends LS{constructor(e=null,t,i,s,r,n=0,o=[],a=[],c=!1,l=null,u){if(super(t,i,e,s,c,!0,!0,u),this.status=r,this.progress=n,this.inputStorage=o,this.outputStorage=a,this.workSettings=l,this.productionText=s.TEXT,e)if(this.managementService=e.getManagementService(),this.calendarService=e.getCalendarService(),null===this.workSettings){const e=s.INPUT_RESOURCES.map(e=>[e.resource,0]),t=s.OUTPUT_RESOURCES.map(e=>e.resource===Df.COINS?[e.resource,0,!0]:[e.resource,this.resourcesService.getResource(e.resource).getLimit(),!0]);this.workSettings=new kv(!0,i,[!0,!0,!0,!0],e,t)}else if(!this.workSettings.seasons){const e=[!0,!0,!0,!0],t=[];l.outputSettings.forEach(e=>t.push([e[0],e[1],void 0===e[2]||e[2]])),this.workSettings=new kv(!0,i,e,l.inputSettings,t)}}toJSON(){return{id:this.id,level:this.level,workSettings:this.workSettings,buildingType:this.buildingType,progress:this.progress,status:this.status,inputStorage:this.inputStorage,outputStorage:this.outputStorage,working:this.working}}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:const e=Qf.resourcesArraysDiff(this.settings.INPUT_RESOURCES,this.inputStorage);let t=String(this.status);return e.length>0&&(t=t.replace("{wait}",Qf.prepareResourcesNamesList(e))),t=t.replace("{in}",Qf.prepareResourcesNamesList(this.settings.INPUT_RESOURCES)),t=t.replace("{out}",Qf.prepareResourcesNamesList(this.settings.OUTPUT_RESOURCES)),t=t.replace("{prod}",this.productionText+" "),wS.textValue(t);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}isMet(){let e=!0;return this.workSettings.seasons[this.calendarService.getSeason()]||e&&(e=!1),this.workSettings.inputSettings.forEach(t=>{e&&(e=this.resourcesService.getResource(t[0]).amount>t[1])}),this.workSettings.outputSettings.forEach(t=>{e&&(e=t[2]?this.resourcesService.getResource(t[0]).amount<this.resourcesService.getResource(t[0]).limit:this.resourcesService.getResource(t[0]).amount<t[1])}),e}tick(){this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.isWorking()||this.hireWorker():this.isWorking()&&this.status!==Fv.PRODUCING_OUTPUT&&this.status!==Fv.TRANSPORTING_OUTPUT&&this.fireWorker()),this.isWorking()&&(this.outputStorage.length>0?this.collectOutputResources():this.inputStorage.length<this.settings.INPUT_RESOURCES.length&&0===this.outputStorage.length?this.collectInputResources():this.progress<100?(this.status=Fv.PRODUCING_OUTPUT,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.inputStorage=[],this.outputStorage=Qf.copyResourceArray(this.settings.OUTPUT_RESOURCES),this.status=Fv.TRANSPORTING_OUTPUT))}collectInputResources(){let e=!0;return this.settings.INPUT_RESOURCES.forEach(t=>{this.inputStorage.find(e=>e.resource===t.resource)||(this.resourcesService.decreaseResource(t.resource,t.amount,this.getName())?this.inputStorage.push({resource:t.resource,amount:t.amount}):e=!1)}),e?(this.status=Fv.FETCHING_INPUT,!0):(this.status=Fv.WAITING_FOR_INPUT,!1)}collectOutputResources(){let e=!0;return this.outputStorage.forEach(t=>{this.resourcesService.increaseResource(t.resource,t.amount,this.getName())?t.amount=0:e=!1}),this.outputStorage=this.outputStorage.filter(e=>e.amount>0),e?0===this.outputStorage.length?(this.status=Fv.FETCHING_INPUT,!0):void 0:(this.status=Fv.WAITING_FOR_WAREHOUSE_SPACE,!1)}isComplexManagement(){return!0}getWorkSettings(){return this.workSettings}setWorkSettings(e){this.workSettings=e}}class Hv extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.SAWMILL,nS.FOREST.SAWMILL,s,i,r,n,o,a,c)}}var Gv=(()=>(function(e){e.GATHERING_FOOD="gathering food",e.GATHERING_RESOURCES="gathering resources",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting"}(Gv||(Gv={})),Gv))(),Bv=(()=>(function(e){e[e.FOOD=0]="FOOD",e[e.RESOURCES=1]="RESOURCES"}(Bv||(Bv={})),Bv))();class Wv extends LS{constructor(e=null,t=-1,i=0,s=Gv.GATHERING_FOOD,r=!1,n=Bv.FOOD,o=[null,0],a=1){super(t,Lf.GATHERER,e,nS.FOREST.GATHERER,r,!0,!0,a),this.progress=i,this.status=s,this.mode=n,this.storage=o,this.lastFind=null,this.servicesService&&(this.weatherService=e.getWeatherService())}rollForFind(){let e=null;return this.mode===Bv.FOOD?e=am.randomElement([{item:Df.BERRY,chance:this.settings.BERRY_CHANCE},{item:Df.MUSHROOM,chance:this.settings.MUSHROOM_CHANCE},{item:Df.WHEAT,chance:this.settings.WHEAT_CHANCE},{item:Df.HERBS,chance:this.settings.HERBS_CHANCE}]):this.mode===Bv.RESOURCES&&(e=am.randomElement([{item:Df.BRUSHWOOD,chance:this.settings.BRUSHWOOD_CHANCE},{item:Df.STONE,chance:this.settings.STONE_CHANCE},{item:Df.LOG,chance:this.settings.LOG_CHANCE},{item:Df.COPPER,chance:this.settings.COPPER_CHANCE},{item:Df.HERBS,chance:this.settings.HERBS_CHANCE}])),e}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,mode:this.mode}}build(){return this.servicesService.getManagementService().getDefaultGathererFood()||(this.mode=Bv.RESOURCES,this.status=Gv.GATHERING_RESOURCES),super.build()}callback(e){e===Bv.FOOD?(this.mode=Bv.FOOD,this.progress=0,this.status=Gv.GATHERING_FOOD):e===Bv.RESOURCES&&(this.mode=Bv.RESOURCES,this.progress=0,this.status=Gv.GATHERING_RESOURCES)}getLine(e){switch(e){case PS.FIRST:return this.mode===Bv.FOOD?wS.buttonValue("gather resources",Bv.RESOURCES):wS.buttonValue("gather food",Bv.FOOD);case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return null!=this.lastFind?wS.textValue("last find: "+Qf.prepareResourceName(this.lastFind)):wS.emptyValue()}}tick(e){if(this.working)if(this.storage[1]>0)this.resourcesService.increaseResource(this.storage[0],this.storage[1],this.getName()),this.storage=[null,0],this.setStatus();else if(this.progress<100)this.progress+=this.getPower(),this.progress>100&&(this.progress=100);else if(100===this.progress){this.progress=0;let e=this.rollForFind();if(null!==e&&!this.resourcesService.hasLimit(e))return void(e=null);e?(this.lastFind=e,this.storage=[e,1],this.status=Gv.TRANSPORTING):(this.lastFind=Df.NOTHING,this.progress=0)}}setStatus(){this.status=this.mode===Bv.FOOD?Gv.GATHERING_FOOD:Gv.GATHERING_RESOURCES}}var Vv=(()=>(function(e){e.MINING_STONE="mining stone",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more resources",e.TRANSPORTING="transporting"}(Vv||(Vv={})),Vv))();class zv extends LS{constructor(e=null,t=-1,i=0,s=Vv.MINING_STONE,r=!1,n=0,o=200,a=1){super(t,Lf.QUARRY,e,nS.MOUNTAINS.QUARRY,r,!0,!0,a),this.progress=i,this.status=s,this.storage=n,this.resources=o,this.servicesService&&(this.gameService=e.getGameService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,resources:this.resources}}build(){return this.startProduction(),this.gameService.enable(Mf.BUILT_QUARRY),this}buildOnMountain(){return!0}getLine(e){switch(e){case PS.FIRST:return wS.textValue("stone: "+this.resources);case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}isStoppable(){return this.resources>0}isUsedUp(){return this.status===Vv.NO_MORE_RESOURCES}hasBuff(){return!this.isUsedUp()&&super.hasBuff()}tick(e){this.resources<=0&&(this.status!==Vv.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Quarry mined all stone"),this.status=Vv.NO_MORE_RESOURCES,this.stopProduction()),this.working&&(this.storage>0?this.resourcesService.increaseResource(Df.STONE,this.storage,this.getName())?(this.storage=0,this.status=Vv.MINING_STONE):this.status=Vv.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=Vv.MINING_STONE,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=Vv.TRANSPORTING))}}var Yv=(()=>(function(e){e.RESEARCHING="researching",e.CRAFTING="crafting {craft}",e.WAITING_FOR_WAREHOUSE="waiting for {craft} space",e.NO_RESEARCH="nothing to research",e.NO_CRAFTING="nothing to craft"}(Yv||(Yv={})),Yv))(),Kv=(()=>(function(e){e[e.RESEARCH=0]="RESEARCH",e[e.CRAFT=1]="CRAFT",e[e.SWITCH_TO_RESEARCH=2]="SWITCH_TO_RESEARCH"}(Kv||(Kv={})),Kv))();class jv extends LS{constructor(e=null,t=-1,i=0,s=Yv.NO_RESEARCH,r=Kv.RESEARCH,n=!1,o=-1,a=null,c=1,l=0){super(t,Lf.WORKSHOP,e,nS.VILLAGE.WORKSHOP,n,!0,!0,c),this.progress=i,this.status=s,this.mode=r,this.storage=l,this.recipe=null,this.icon=null,this.servicesService&&(a?this.recipe=a:o>=0&&(this.recipe=this.servicesService.getRecipeService().getRecipeById(o)),this.craftingService=e.getService(Zf.CRAFTING),this.techService=e.getTechService(),this.gameService=e.getGameService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,mode:this.mode,working:this.working,recipeId:null!==this.recipe?this.recipe.id:-1,storage:this.storage}}build(){this.servicesService.getManagementService().getDefaultWorkshopResearch()||(this.mode=Kv.CRAFT),this.startProduction();const e=this.servicesService.getLogService();return this.gameService.isEnabled(Mf.RESEARCH)||(this.gameService.enable(Mf.RESEARCH),e.log("Researching unlocked")),this.gameService.isEnabled(Mf.CRAFTING)||(this.gameService.enable(Mf.CRAFTING),e.log("Crafting unlocked")),this.craftingService.increaseCraftingQueueSize(1),this}prepareDemolish(){return this.craftingService.decreaseCraftingQueueSize(1),super.prepareDemolish()}callback(e){if("switch"===e){if(this.mode===Kv.RESEARCH)this.progress=0,this.mode=Kv.CRAFT,this.recipe=this.craftingService.getCraftingOrder(),this.icon=null,this.status=null!==this.recipe?Yv.CRAFTING:Yv.NO_CRAFTING;else if(this.mode===Kv.SWITCH_TO_RESEARCH)this.mode=Kv.CRAFT,this.status=null!==this.recipe?Yv.CRAFTING:Yv.NO_CRAFTING;else if(this.mode===Kv.CRAFT)if(this.recipe){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Workshop will switch to research after finishing current craft.");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&(this.mode=Kv.SWITCH_TO_RESEARCH)})}else this.progress=0,this.mode=Kv.RESEARCH,this.status=this.techService.isResearchStarted()?Yv.RESEARCHING:Yv.NO_RESEARCH}else"cancel"===e&&(this.recipe=null,this.progress=0,this.mode===Kv.SWITCH_TO_RESEARCH?(this.mode=Kv.RESEARCH,this.status=this.techService.isResearchStarted()?Yv.RESEARCHING:Yv.NO_RESEARCH):this.status=Yv.NO_CRAFTING)}switchToResearch(){this.mode===Kv.CRAFT&&(this.recipe?this.mode=Kv.SWITCH_TO_RESEARCH:(this.progress=0,this.mode=Kv.RESEARCH,this.status=this.techService.isResearchStarted()?Yv.RESEARCHING:Yv.NO_RESEARCH))}switchToCrafting(){this.mode===Kv.RESEARCH?(this.progress=0,this.mode=Kv.CRAFT,this.recipe=this.craftingService.getCraftingOrder(),this.icon=null,this.status=null!==this.recipe?Yv.CRAFTING:Yv.NO_CRAFTING):this.mode===Kv.SWITCH_TO_RESEARCH&&(this.mode=Kv.CRAFT,this.status=null!==this.recipe?Yv.CRAFTING:Yv.NO_CRAFTING)}getLine(e){switch(e){case PS.FIRST:return this.firstLine();case PS.SECOND:return this.recipe?(this.icon||(this.prepareIcon(),this.status===Yv.CRAFTING?this.icon[0].prefix="crafting ":this.status===Yv.WAITING_FOR_WAREHOUSE&&(this.icon[0].prefix="waiting for ",this.icon[0].suffix=" space")),wS.iconValue(this.icon)):wS.textValue(this.status.replace("{craft}","warehouse"));case PS.THIRD:if(this.recipe)return wS.buttonValue("cancel crafting","cancel");{let e="";return this.techService.getCurrentResearch()&&(e=Qf.prepareTechName(this.techService.getCurrentResearch().getTech())),wS.textValue(e)}case PS.FOURTH:return wS.progressValue(this.progress)}}firstLine(){return wS.buttonValue(this.mode===Kv.RESEARCH||this.mode===Kv.SWITCH_TO_RESEARCH?"craft":"research","switch")}tick(e){if(this.working)if(this.mode===Kv.RESEARCH)this.techService.isResearchStarted()?(this.status!==Yv.RESEARCHING&&(this.progress=0),this.status=Yv.RESEARCHING,this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.techService.progressTech(nS.VILLAGE.WORKSHOP.RESEARCH_POWER))):(this.status=Yv.NO_RESEARCH,this.progress=0);else if(this.mode===Kv.CRAFT||this.mode===Kv.SWITCH_TO_RESEARCH)if(null===this.recipe&&(this.recipe=this.craftingService.getCraftingOrder(),this.icon=null,this.progress=0),null===this.recipe)this.status=Yv.NO_CRAFTING;else if(this.status===Yv.WAITING_FOR_WAREHOUSE){const e=this.resourcesService.getLimit(this.recipe.resource);this.storage>e?(this.storage-=e,this.resourcesService.increaseResource(this.recipe.resource,e,this.getName())):(this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName()),this.status=Yv.CRAFTING,this.progress=0,this.recipe=null)}else if(this.status=Yv.CRAFTING,this.progress<100&&(this.progress+=this.getPower()/this.recipe.craftingDifficulty*nS.VILLAGE.WORKSHOP.CRAFTING_POWER),this.progress>=100){this.progress=100,this.storage=this.recipe.amount;const e=this.resourcesService.getLimit(this.recipe.resource);this.storage>e?(this.storage-=e,this.resourcesService.increaseResource(this.recipe.resource,e,this.getName()),this.status=Yv.WAITING_FOR_WAREHOUSE,this.icon=null):this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName())?(this.progress=0,this.storage=0,this.recipe=null,this.mode===Kv.SWITCH_TO_RESEARCH&&(this.mode=Kv.RESEARCH,this.status=this.techService.isResearchStarted()?Yv.RESEARCHING:Yv.NO_RESEARCH)):(this.status=Yv.WAITING_FOR_WAREHOUSE,this.icon=null)}}getRecipe(){return this.recipe}cancelCrafting(){this.recipe=null}willResearch(){return this.mode===Kv.RESEARCH||this.mode===Kv.SWITCH_TO_RESEARCH}prepareIcon(){this.recipe&&(this.icon=[{name:Qf.prepareResourceName(this.recipe.resource),path:"resources",prefix:"",suffix:""}])}}class $v extends LS{constructor(e=null,t=-1,i=Gf.NONE,s=50,r=1){super(t,Lf.WAREHOUSE,e,nS.VILLAGE.WAREHOUSE,!1,!0,!1,r),this.resource=i,this.storage=s,this.servicesService&&(this.modalService=e.getModalService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,resource:this.resource,storage:this.storage}}callback(e){if(this.resource===Gf.NONE)this.resource=Gf[String(e.target.value)],this.resourcesService.increaseLimit(this.resource,this.storage);else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to switch warehouse storage type?<br>All excess resources will be lost");const t=this.modalService.registerForConfirmation().subscribe(i=>{i?(this.resourcesService.decreaseLimit(this.resource,this.storage),this.resource=Gf[String(e.target.value)],this.resourcesService.increaseLimit(this.resource,this.storage)):e.target.selectedIndex=this.resource-1,t.unsubscribe()})}}getComplexity(){return super.getComplexity()*(this.storage/this.settings.SIZE)}getSize(){return this.storage}getLine(e){switch(e){case PS.FIRST:return this.firstLine();case PS.SECOND:return wS.textValue("storage: "+this.storage);case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}firstLine(){const e=[];return e.push(Gf[Gf.NONE]),e.push(Gf[Gf.RAW]),e.push(Gf[Gf.PROCESSED]),e.push(Gf[Gf.FOOD]),e.push(Gf[Gf.TOOLS]),wS.dropdownValue(e,Gf[this.resource])}prepareDemolish(){return this.resourcesService.decreaseLimit(this.resource,this.storage),!0}startProduction(){return!1}stopProduction(){}fireWorker(){return!1}hireWorker(){return!1}getWorkers(){return 0}getHappinessEffect(){return 0}isCombinable(){return!0}isSplittable(){return!0}combine(e,t){if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will store <b>"+Qf.prepareResourceTypeName(this.resource)+" resources</b><br>All resources exceeding decreased limit of <b>"+Qf.prepareResourceTypeName(e.resource)+"</b> will be lost");const i=this.modalService.registerForConfirmation().subscribe(s=>{i.unsubscribe(),s?this.doCombine(e,t):t.finaliseCombine(!1)})}}doCombine(e,t){this.storage+=e.getSize(),this.resource!==Gf.NONE&&this.resourcesService.increaseLimit(this.resource,e.getSize()),t.finaliseCombine(!0)}split(e){this.modalService.open(Pf.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");const t=this.modalService.registerForValueResponse().subscribe(i=>{t.unsubscribe(),null!==i&&!isNaN(i)&&0!==i&&(i>=1&&i<this.getSize()?(this.storage-=Number(i),e.finaliseSplit(new $v(this.servicesService,this.servicesService.getIdService().getNextId(),this.resource,Number(i)).build())):this.modalService.info("Invalid size value!"))})}isCompatible(e){return this.resource===e.resource}}var Qv=(()=>(function(e){e.HUNTING="hunting",e.TAME="taming animals",e.WAITING_FOR_PASTURE_SPACE="waiting for pasture space",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting"}(Qv||(Qv={})),Qv))(),qv=(()=>(function(e){e[e.HUNTING=0]="HUNTING",e[e.TAMING=1]="TAMING"}(qv||(qv={})),qv))();class Xv extends LS{constructor(e=null,t=-1,i=0,s=Qv.HUNTING,r=qv.HUNTING,n=!1,o=0,a=0,c=null,l=1){super(t,Lf.HUNTER_LODGE,e,nS.FOREST.HUNTER_LODGE,n,!0,!0,l),this.progress=i,this.status=s,this.mode=r,this.storage=o,this.storage2=a,this.animal=c,this.lastFind=null,this.servicesService&&(this.weatherService=e.getWeatherService(),this.gameService=e.getGameService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,mode:this.mode,working:this.working,storage:this.storage,storage2:this.storage2,animal:this.animal}}callback(e){"tame"===e?(this.mode=qv.TAMING,this.progress=0,this.storage=0,this.storage2=0,this.status=Qv.TAME):(this.mode=qv.HUNTING,this.progress=0,this.storage=0,this.storage2=0,this.lastFind=null,this.status=Qv.HUNTING)}getLine(e){switch(e){case PS.FIRST:return this.gameService.isEnabled(Mf.PASTURE)?this.mode===qv.HUNTING?wS.buttonValue("tame animals","tame"):wS.buttonValue("hunt","hunt"):wS.emptyValue();case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return null!==this.lastFind?wS.textValue("last tamed: "+Qf.prepareResourceName(this.lastFind)):wS.emptyValue()}}tick(e){if(this.working)if(this.mode===qv.HUNTING)this.status=0!==this.storage&&0!==this.storage2?Qv.TRANSPORTING:Qv.HUNTING,this.status===Qv.HUNTING?this.progress<100&&(this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.storage<5&&(this.storage+=am.randomBetween(1,3),this.storage>5&&(this.storage=5)),this.storage2<5&&(this.storage2+=am.randomBetween(0,2),this.storage2>5&&(this.storage2=5)),this.status=Qv.TRANSPORTING)):(this.status===Qv.TRANSPORTING||this.status===Qv.WAITING_FOR_WAREHOUSE_SPACE)&&(0!==this.storage&&this.resourcesService.increaseResource(Df.MEAT,this.storage,this.getName())&&(this.storage=0),0!==this.storage2&&this.resourcesService.increaseResource(Df.FUR,this.storage2,this.getName())&&(this.storage2=0),0!==this.storage&&0!==this.storage2&&(this.status=Qv.WAITING_FOR_WAREHOUSE_SPACE));else if(this.mode===qv.TAMING)if(this.status===Qv.TAME){if(this.progress<100&&(this.progress+=this.getPower(),this.progress>=100)){this.progress=0;const e=[];this.resourcesService.hasLimit(Df.CHICKEN)&&e.push({item:Df.CHICKEN,chance:6}),this.resourcesService.hasLimit(Df.SHEEP)&&e.push({item:Df.SHEEP,chance:5}),this.resourcesService.hasLimit(Df.PIG)&&e.push({item:Df.PIG,chance:5}),this.resourcesService.hasLimit(Df.COW)&&e.push({item:Df.COW,chance:4}),this.resourcesService.hasLimit(Df.HORSE)&&e.push({item:Df.HORSE,chance:3}),0===e.length&&!this.servicesService.getManagementService().getSwitchHunterFromTaming()&&(this.logService.log("No more space for animals. Hunter switched to hunting"),this.callback("hunt"));const t=am.randomElement(e);null!=t?(this.lastFind=t,this.animal=t,this.status=Qv.TRANSPORTING):(this.lastFind=Df.NOTHING,this.animal=null)}}else(this.status===Qv.TRANSPORTING||this.status===Qv.WAITING_FOR_PASTURE_SPACE)&&this.animal&&(this.resourcesService.increaseResource(this.animal,1,this.getName())?(this.animal=null,this.status=Qv.TAME):this.status=Qv.WAITING_FOR_PASTURE_SPACE)}}class Zv extends LS{constructor(e=null,t=-1,i=0,s=1){super(t,Lf.SHRINE,e,nS.VILLAGE.SHRINE,!1,!0,!1,s),this.progress=i,this.servicesService&&(this.religionService=e.getService(Zf.RELIGION))}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress}}build(){return this.religionService.increaseFaithCap(10),this.servicesService.getGameService().enable(Mf.RELIGION),this}getLine(e){switch(e){case PS.FIRST:case PS.SECOND:return wS.emptyValue();case PS.THIRD:return wS.progressValue(this.progress,"prayers");case PS.FOURTH:return wS.emptyValue()}}prepareDemolish(){return this.religionService.decreaseFaithCap(10),!0}startProduction(){return!0}stopProduction(){}tick(e){const t=this.servicesService.getVillageService().getPopulation();this.progress+=.01*(Math.pow(Math.log(t),2)+1)*this.getPower(),this.progress>100&&(this.progress=0,this.religionService.increaseFaith(1))}fireWorker(){return!1}hireWorker(){return!1}getWorkers(){return 0}}var Jv=(()=>(function(e){e.WORKING="working",e.BAD_WEATHER="bad weather",e.STOPPED="stopped"}(Jv||(Jv={})),Jv))();class eR extends LS{constructor(e=null,t=-1,i=0,s=4,r=1,n=Jv.WORKING,o=null){super(t,Lf.FARM,e,nS.FIELD.FARM,i>0,!0,!0,r),this.workers=i,this.maxWorkers=s,this.status=n,this.workSettings=o,this.servicesService&&(this.weatherService=e.getWeatherService(),this.calendarService=e.getCalendarService(),this.managementService=e.getManagementService(),this.fieldService=e.getServiceByRegion(Kf.FIELD),null===o&&(this.workSettings=new kv(!0,this.getBuildingType(),[!0,!0,!0,!0],null,null)))}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,workers:this.workers,maxWorkers:this.maxWorkers,workSettings:this.workSettings}}callback(e){"hire"===e&&this.workers<this.maxWorkers&&this.resourcesService.hireWorker()?this.workers+=1:"fire"===e&&this.workers>0&&(this.resourcesService.fireWorker(),this.workers-=1)}getLine(e){switch(e){case PS.FIRST:return wS.textValue("workers: "+this.workers+"/"+this.maxWorkers);case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.twoButtonValue("hire worker","hire","","fire worker","fire");case PS.FOURTH:return wS.emptyValue()}}isWorking(){return this.workers>0}startProduction(){if(0===this.workers){for(;this.workers<this.maxWorkers&&this.resourcesService.hireWorker();)this.workers+=1;if(this.workers>0)return!0}return!1}stopProduction(){this.workers>0&&(this.resourcesService.fireWorker(this.workers),this.workers=0)}isMet(){let e=!0;return this.workSettings.seasons[this.calendarService.getSeason()]||e&&(e=!1),e}tick(e){if(this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.workers<this.maxWorkers&&this.hireWorker():this.isWorking()&&this.stopProduction()),this.workers>0)if(this.weatherService.isWeather(im.RAIN,im.STORM))if(this.weatherService.isWeather(im.STORM))this.status=Jv.BAD_WEATHER;else{this.status=Jv.WORKING;let e=this.workers;for(;e>0;){const t=this.fieldService.getBuildings().filter(e=>e.getBuildingType()===Lf.PASTURE&&e.hasWork());if(0===t.length){this.status=Jv.BAD_WEATHER;break}t.forEach(t=>{e>0&&t.work(this.getPower())&&(e-=1)})}}else{this.status=Jv.WORKING;let e=this.workers;for(;e>0;){const t=this.fieldService.getBuildings().filter(e=>(e.getBuildingType()===Lf.FIELD||e.getBuildingType()===Lf.ORCHARD||e.getBuildingType()===Lf.PASTURE)&&e.hasWork());if(0===t.length)break;t.forEach(t=>{e>0&&t.work(this.getPower())&&(e-=1)})}}else this.status=Jv.STOPPED}fireWorker(){return this.workers>0&&(this.resourcesService.fireWorker(1),this.workers-=1,!0)}hireWorker(){return!!(this.workers<this.maxWorkers&&this.resourcesService.hireWorker())&&(this.workers+=1,!0)}getWorkers(){return this.workers}setBuildingLevel(e){super.setBuildingLevel(e),this.maxWorkers=2+2*e}isComplexManagement(){return!0}getWorkSettings(){return this.workSettings}setWorkSettings(e){this.workSettings=e}}var tR=(()=>(function(e){e.PLOW_FIELD="plowing {crop} field",e.SOWING="sowing {crop}",e.GROWING="{crop} growing",e.HARVEST="harvesting {crop}",e.FALLOW="fallow"}(tR||(tR={})),tR))();class iR extends LS{constructor(e=null,t=-1,i=nS.FIELD.FIELD.SIZE,s=Hf.NONE,r=tR.FALLOW,n=0,o=!0,a=0,c=1){super(t,Lf.FIELD,e,nS.FIELD.FIELD,o,!0,!0,c),this.currentSize=i,this.crop=s,this.status=r,this.progress=n,this.growth=a,this.servicesService&&(this.gameService=e.getGameService(),this.modalService=e.getModalService(),this.weatherService=e.getWeatherService(),this.calendarService=e.getCalendarService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,size:this.currentSize,crop:this.crop,status:this.status,progress:this.progress,working:this.working,growth:this.growth}}getSize(){return this.currentSize}getComplexity(){return super.getComplexity()*(this.getSize()/this.settings.SIZE)}callback(e){if(this.crop===Hf.NONE||this.status===tR.FALLOW)this.crop=Hf[String(e.target.value)],this.status=tR.FALLOW,this.progress=0;else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to switch field crop type?<br>All field progress will be lost");const t=this.modalService.registerForConfirmation().subscribe(i=>{i?(this.crop=Hf[String(e.target.value)],this.status=tR.FALLOW,this.progress=0):e.target.selectedIndex=this.crop,t.unsubscribe()})}}finishDemolish(){}getLine(e){switch(e){case PS.FIRST:return wS.textValue("size: "+this.getSize());case PS.SECOND:const e=[];return e.push(Hf[Hf.NONE]),Object.entries(Object(cS.FIELD)).forEach(t=>{cS.getCrop(Hf[t[0]]).PREREQUISITE?this.gameService.isEnabled(cS.getCrop(Hf[t[0]]).PREREQUISITE)&&e.push(t[0]):e.push(t[0])}),wS.dropdownValue(e,Hf[this.crop]);case PS.THIRD:return wS.textValue(this.status.replace("{crop}",Hf[this.crop].toLowerCase()));case PS.FOURTH:return this.status===tR.HARVEST?wS.progressValue(Math.floor(this.growth/(cS.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize())*100),"harvest: "+this.growth):wS.progressValue(this.progress)}}getName(){return this.crop===Hf.NONE?"Field":Hf[this.crop].charAt(0).toUpperCase()+Hf[this.crop].slice(1).toLowerCase()+" field"}startProduction(){return this.working=!0,!0}stopProduction(){this.working=!1}tick(e){if(this.calendarService.getSeason()===SS.WINTER&&(this.status=tR.FALLOW,this.growth=0,this.progress=0),this.status===tR.GROWING)if(this.calendarService.getSeason()===SS.AUTUMN)this.status=tR.HARVEST,this.growth=Math.floor(this.progress*cS.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize()/100),this.progress=0;else if(this.progress<100){let e=this.getPower()*(1+this.effectsService.getNatureEffectsValue()/100)/cS.getCrop(this.crop).GROWTH;this.weatherService.getCurrentTemperature()<=5?e*=0:this.weatherService.getCurrentTemperature()<=10?e*=.2:this.weatherService.getCurrentTemperature()<=15?e*=.5:this.weatherService.getCurrentTemperature()<=20?e*=.8:this.weatherService.getCurrentTemperature()<=25?e*=1:this.weatherService.getCurrentTemperature()<=27?e*=.8:this.weatherService.getCurrentTemperature()<=29?e*=.6:this.weatherService.getCurrentTemperature()<=31?e*=.4:this.weatherService.getCurrentTemperature()<=33?e*=.2:this.weatherService.getCurrentTemperature()<=35&&(e*=0),this.progress+=e,this.progress>100&&(this.progress=100)}else 100===this.progress&&(this.growth=this.getSize()*cS.getCrop(this.crop).YIELD_MULTIPLIER,this.progress=0,this.status=tR.HARVEST)}work(e){if(this.isWorking()&&this.status!==tR.GROWING&&this.crop!==Hf.NONE){if(this.status===tR.FALLOW&&this.calendarService.getSeason()===SS.SPRING)return this.status=tR.PLOW_FIELD,!0;if(this.status===tR.PLOW_FIELD&&(this.calendarService.getSeason()===SS.SPRING||this.calendarService.getSeason()===SS.SUMMER&&this.servicesService.getManagementService().getPlowInSummer()))return this.progress<100&&(this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=tR.SOWING)),!0;if(this.status===tR.SOWING&&(this.calendarService.getSeason()===SS.SPRING||this.calendarService.getSeason()===SS.SUMMER))return this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=tR.GROWING),!0;if(this.status===tR.HARVEST){const e=Df[Hf[this.crop]];if(this.resourcesService.hasLimit(e))return this.resourcesService.increaseResource(e,1,this.getName()),this.growth-=1,this.growth<=0&&(this.status=tR.FALLOW),!0}}return!1}fireWorker(){return!1}hireWorker(){return!1}getWorkers(){return 0}hasWork(){return this.isWorking()&&this.status!==tR.GROWING&&this.crop!==Hf.NONE&&(this.status===tR.FALLOW&&this.calendarService.getSeason()===SS.SPRING||this.status===tR.PLOW_FIELD&&(this.calendarService.getSeason()===SS.SPRING||this.calendarService.getSeason()===SS.SUMMER&&this.servicesService.getManagementService().getPlowInSummer())||this.status===tR.SOWING&&(this.calendarService.getSeason()===SS.SPRING||this.calendarService.getSeason()===SS.SUMMER)||this.status===tR.HARVEST&&this.resourcesService.hasLimit(Df[Hf[this.crop]]))}getDetails(){return this.crop!==Hf.NONE?"growing difficulty: "+cS.getCrop(this.crop).GROWTH+"<br>yield multiplier: "+cS.getCrop(this.crop).YIELD_MULTIPLIER+"<br>"+super.getDetails():super.getDetails()}getHappinessEffect(){return 0}isCombinable(){return!0}isSplittable(){return!0}combine(e,t){if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{let i;if(this.modalService.open(Pf.CONFIRM),this.crop===e.crop?(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow if both are in different stages"),i=!0):(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow"),i=!0),i){const i=this.modalService.registerForConfirmation().subscribe(s=>{i.unsubscribe(),s?this.doCombine(e,t):t.finaliseCombine(!1)})}}}doCombine(e,t){if(this.crop===e.crop)if(this.status===e.status)if(this.status===tR.HARVEST)this.growth+=e.growth;else{let t=this.progress*this.getSize();t+=e.progress*e.getSize(),this.progress=t/(this.getSize()+e.getSize())}else this.status=tR.FALLOW,this.progress=0,this.growth=0;else this.status=tR.FALLOW,this.progress=0,this.growth=0;this.currentSize+=e.getSize(),t.finaliseCombine(!0)}split(e){this.modalService.open(Pf.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");const t=this.modalService.registerForValueResponse().subscribe(i=>{if(t.unsubscribe(),null!==i&&!isNaN(i)&&0!==i)if(i>=1&&i<this.getSize()){const t=Math.floor(this.growth*i/this.currentSize);this.growth-=t,this.currentSize-=Number(i),e.finaliseSplit(new iR(this.servicesService,this.servicesService.getIdService().getNextId(),Number(i),this.crop,this.status,this.progress,!0,t,this.level).build())}else this.modalService.info("Invalid size value!")})}isCompatible(e){return this.crop===e.crop&&this.status===e.status}}var sR=(()=>(function(e){e.FALLOW="fallow",e.PLANTING="planting {crop}",e.GROWING="{crop} growing",e.FRUITING="{crop} fruiting",e.HARVEST="picking {crop}",e.NO_FRUITS="no fruits",e.CLEAR="clear old plants"}(sR||(sR={})),sR))();class rR extends LS{constructor(e=null,t=-1,i=nS.FIELD.ORCHARD.SIZE,s=Hf.NONE,r=sR.FALLOW,n=0,o=!0,a=0,c=1){super(t,Lf.ORCHARD,e,nS.FIELD.ORCHARD,o,!0,!0,c),this.currentSize=i,this.crop=s,this.status=r,this.progress=n,this.growth=a,this.servicesService&&(this.modalService=e.getModalService(),this.weatherService=e.getWeatherService(),this.calendarService=e.getCalendarService(),this.royalService=e.getRoyalService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,size:this.currentSize,crop:this.crop,status:this.status,progress:this.progress,working:this.working,growth:this.growth}}getSize(){return this.currentSize}getComplexity(){return super.getComplexity()*(this.getSize()/this.settings.SIZE)}callback(e){if(this.crop===Hf.NONE||this.status===sR.FALLOW)this.crop=Hf[String(e.target.value)],this.status=sR.FALLOW,this.progress=0;else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to switch orchard plant type?<br>All orchard progress will be lost");const t=this.modalService.registerForConfirmation().subscribe(i=>{t.unsubscribe(),i?(this.crop=Hf[String(e.target.value)],this.status=this.status===sR.FALLOW||this.status===sR.PLANTING?sR.FALLOW:sR.CLEAR,this.progress=0):e.target.selectedIndex=this.prepareParams().indexOf(Hf[this.crop])})}}prepareParams(){const e=[];return e.push(Hf[Hf.NONE]),Object.entries(Object(cS.ORCHARD)).forEach(t=>{cS.getCrop(Hf[t[0]]).PREREQUISITE?this.gameService.isEnabled(cS.getCrop(Hf[t[0]]).PREREQUISITE)&&e.push(t[0]):e.push(t[0])}),e}finishDemolish(){}getLine(e){switch(e){case PS.FIRST:return wS.textValue("size: "+this.getSize());case PS.SECOND:return wS.dropdownValue(this.prepareParams(),Hf[this.crop]);case PS.THIRD:return wS.textValue(this.status.replace("{crop}",Hf[this.crop].toLowerCase()));case PS.FOURTH:return this.status===sR.HARVEST?wS.progressValue(Math.floor(this.growth/(cS.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize())*100),"harvest: "+this.growth):this.status===sR.NO_FRUITS?wS.emptyValue():wS.progressValue(this.progress)}}getName(){return this.crop===Hf.NONE?"Orchard":Hf[this.crop].charAt(0).toUpperCase()+Hf[this.crop].slice(1).toLowerCase()+" orchard"}startProduction(){return this.working=!0,!0}stopProduction(){this.working=!1}tick(e){if(this.crop!==Hf.NONE){if(this.status!==sR.FALLOW&&this.status!==sR.CLEAR&&this.calendarService.getSeason()===SS.WINTER){if(this.status===sR.GROWING)return;this.status=sR.NO_FRUITS,this.growth=0,this.progress=0}else this.status===sR.NO_FRUITS&&(this.calendarService.getSeason()===SS.SPRING||this.calendarService.getSeason()===SS.SUMMER)&&(this.status=sR.FRUITING);if(this.status===sR.GROWING||this.status===sR.FRUITING)if(this.calendarService.getSeason()===SS.AUTUMN&&this.status===sR.FRUITING)this.status=sR.HARVEST,this.growth=Math.floor(this.progress*cS.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize()/100),this.progress=0;else if(this.progress<100){let e=this.getPower()*(1+this.effectsService.getNatureEffectsValue()/100);this.status===sR.GROWING?e/=cS.getCrop(this.crop).GROWTH:this.status===sR.FRUITING&&(e/=cS.getCrop(this.crop).FRUITING),this.weatherService.getCurrentTemperature()<=5?e*=0:this.weatherService.getCurrentTemperature()<=10?e*=.2:this.weatherService.getCurrentTemperature()<=15?e*=.5:this.weatherService.getCurrentTemperature()<=20?e*=.8:this.weatherService.getCurrentTemperature()<=25?e*=1:this.weatherService.getCurrentTemperature()<=27?e*=.8:this.weatherService.getCurrentTemperature()<=29?e*=.6:this.weatherService.getCurrentTemperature()<=31?e*=.4:this.weatherService.getCurrentTemperature()<=33?e*=.2:this.weatherService.getCurrentTemperature()<=35&&(e*=0),this.progress+=e,this.progress>100&&(this.progress=100)}else 100===this.progress&&(this.status===sR.GROWING?this.status=sR.FRUITING:this.status===sR.FRUITING&&(this.growth=cS.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize(),this.status=sR.HARVEST),this.progress=0)}}work(e){if(this.isWorking()&&this.status!==sR.GROWING&&this.crop!==Hf.NONE)if(this.status===sR.FALLOW){if(this.calendarService.getSeason()===SS.SPRING)return this.status=sR.PLANTING,!0}else{if(this.status===sR.PLANTING)return this.progress<100&&(this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=sR.GROWING)),!0;if(this.status===sR.HARVEST){const e=Df[Hf[this.crop]];if(this.resourcesService.hasLimit(e))return e===Df.APPLE&&this.royalService.pickGoldenApple()||(this.resourcesService.increaseResource(e,1,this.getName()),this.growth-=1,this.growth<=0&&(this.status=sR.NO_FRUITS)),!0}else if(this.status===sR.CLEAR)return this.progress<100&&(this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=sR.FALLOW)),!0}return!1}fireWorker(){return!1}hireWorker(){return!1}getWorkers(){return 0}hasWork(){return this.isWorking()&&this.status!==sR.GROWING&&this.crop!==Hf.NONE&&(this.status===sR.FALLOW&&this.calendarService.getSeason()===SS.SPRING||this.status===sR.PLANTING||this.status===sR.CLEAR||this.status===sR.HARVEST&&this.resourcesService.hasLimit(Df[Hf[this.crop]]))}getDetails(){return this.crop!==Hf.NONE?"growing difficulty: "+cS.getCrop(this.crop).GROWTH+"<br>fruiting difficulty: "+cS.getCrop(this.crop).FRUITING+"<br>yield multiplier: "+cS.getCrop(this.crop).YIELD_MULTIPLIER+"<br>"+super.getDetails():super.getDetails()}getHappinessEffect(){return 0}isCombinable(){return!0}isSplittable(){return!0}combine(e,t){if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{let i;if(this.modalService.open(Pf.CONFIRM),this.crop===e.crop?(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow if both are in different stages"),i=!0):(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow"),i=!0),i){const i=this.modalService.registerForConfirmation().subscribe(s=>{i.unsubscribe(),s?this.doCombine(e,t):t.finaliseCombine(!1)})}}}doCombine(e,t){if(this.crop===e.crop)if(this.status===e.status)if(this.status===sR.HARVEST)this.growth+=e.growth;else{let t=this.progress*this.getSize();t+=e.progress*e.getSize(),this.progress=t/(this.getSize()+e.getSize())}else this.status=sR.FALLOW,this.progress=0,this.growth=0;else this.status=sR.FALLOW,this.progress=0,this.growth=0;this.currentSize+=e.getSize(),t.finaliseCombine(!0)}split(e){this.modalService.open(Pf.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");const t=this.modalService.registerForValueResponse().subscribe(i=>{if(t.unsubscribe(),null!==i&&!isNaN(i)&&0!==i)if(i>=1&&i<this.getSize()){const t=Math.floor(this.growth*i/this.currentSize);this.growth-=t,this.currentSize-=Number(i),e.finaliseSplit(new rR(this.servicesService,this.servicesService.getIdService().getNextId(),Number(i),this.crop,this.status,this.progress,!0,t,this.level).build())}else this.modalService.info("Invalid size value!")})}isCompatible(e){return this.crop===e.crop&&this.status===e.status}}class nR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.WINDMILL,nS.FIELD.WINDMILL,s,i,r,n,o,a,c)}}class oR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.BAKERY,nS.VILLAGE.BAKERY,s,i,r,n,o,a,c)}}var aR=(()=>(function(e){e.FISHING="fishing",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING_FISH="transporting fish"}(aR||(aR={})),aR))();class cR extends LS{constructor(e=null,t=-1,i=0,s=aR.FISHING,r=!1,n=1){super(t,Lf.FISHERS_HUT,e,nS.SEA.FISHERS_HUT,r,!0,!0,n),this.progress=i,this.status=s,this.status!==aR.FISHING&&this.status!==aR.WAITING_FOR_WAREHOUSE_SPACE&&this.status!==aR.TRANSPORTING_FISH&&(this.status=aR.FISHING)}getLine(e){switch(e){case PS.FIRST:return wS.textValue(this.status);case PS.SECOND:return wS.progressValue(this.progress);case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}tick(){if(this.working)if(this.status===aR.FISHING){if(this.progress<100&&(this.progress+=this.getPower(),this.progress>=100)){if(this.progress=0,this.servicesService.getRoyalService().catchGoldenFish())return;this.status=aR.TRANSPORTING_FISH}}else(this.status===aR.TRANSPORTING_FISH||this.status===aR.WAITING_FOR_WAREHOUSE_SPACE)&&(this.status=this.resourcesService.increaseResource(Df.FISH,1,this.getName())?aR.FISHING:aR.WAITING_FOR_WAREHOUSE_SPACE)}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working}}}class lR extends LS{constructor(e=null,t=-1,i=nS.FORT.BARRACKS.SIZE,s=1){super(t,Lf.BARRACKS,e,nS.FORT.BARRACKS,!1,!0,!1,s),this.barracksSize=i,this.servicesService&&(this.armyService=e.getArmyService(),this.modalService=e.getModalService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,barracksSize:this.barracksSize}}build(){return this.servicesService.getGameService().isEnabled(Mf.ARMY)||this.servicesService.getGameService().enable(Mf.ARMY),this.armyService.increaseBarracks(this.barracksSize),this}prepareDemolish(){return this.armyService.getFreeBarracks()>=this.barracksSize?(this.armyService.decreaseBarracks(this.barracksSize),!0):(this.modalService.info("Your troops would have nowhere to sleep!<br>You cannot demolish barracks right now!"),!1)}getLine(e){switch(e){case PS.FIRST:return wS.textValue("capacity: "+this.barracksSize);case PS.SECOND:case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}getHappinessEffect(){return 0}getEffects(){return 0}getPermanentEffects(){return 0}}var uR=(()=>(function(e){e.TRAINING="training",e.NO_RECRUITS="no recruits"}(uR||(uR={})),uR))();class hR extends LS{constructor(e=null,t=-1,i=0,s=!1,r=uR.NO_RECRUITS,n=1,o=null){super(t,Lf.TRAINING_SQUARE,e,nS.FORT.TRAINING_SQUARE,s,!0,!0,n),this.progress=i,this.status=r,this.workSettings=o,this.servicesService&&(this.armyService=e.getArmyService(),this.managementService=e.getManagementService(),this.calendarService=e.getCalendarService(),null===this.workSettings)&&(this.workSettings=new kv(!0,this.buildingType,[!0,!0,!0,!0],null,null,!0,!0,"work when there are troops to train"))}customWorkRule(){return this.armyService.hasRecruits()}getWorkSettings(){return this.workSettings}setWorkSettings(e){this.workSettings=e}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,working:this.working,workSettings:this.workSettings}}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return this.status===uR.TRAINING?wS.progressValue(this.progress):wS.emptyValue();case PS.FOURTH:return wS.emptyValue()}}tick(e){this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.isWorking()||this.hireWorker():this.isWorking()&&(this.status!==uR.TRAINING||0===this.progress)&&this.fireWorker()),this.working&&(this.armyService.hasRecruits()?(this.status=uR.TRAINING,this.progress<100&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.armyService.progressRecruitment(1))):(this.status=uR.NO_RECRUITS,this.progress=0))}isMet(){let e=!0;return this.workSettings.seasons[this.calendarService.getSeason()]||e&&(e=!1),this.workSettings.customRuleEnabled&&e&&(e=this.customWorkRule()),e}isComplexManagement(){return!0}}class dR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.TANNERY,nS.FOREST.TANNERY,s,i,r,n,o,a,c)}}class gR extends LS{constructor(e=null,t=-1,i=nS.FORT.STOCKADE.DURABILITY,s=nS.FORT.STOCKADE.DURABILITY,r=0,n=!1,o=1){super(t,Lf.STOCKADE,e,nS.FORT.STOCKADE,n,!0,!1,o),this.health=i,this.durability=s,this.progress=r,this.servicesService&&(this.armyService=e.getArmyService(),this.modalService=e.getModalService(),this.worldService=e.getWorldService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,health:this.health,durability:this.durability,progress:this.progress,working:this.working}}build(){return this.worldService.getRegion(0).defense+=nS.FORT.STOCKADE.DEFENSE,this}prepareDemolish(){return this.worldService.getRegion(0).defense-=nS.FORT.STOCKADE.DEFENSE,!0}callback(e){if("repair"===e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to repair "+this.getName()+" for 1 log for each durability point missing?");const e=this.modalService.registerForConfirmation().subscribe(t=>{t&&(this.startProduction()||this.modalService.info("No free worker to repair stockade!")),e.unsubscribe()})}else"stop"===e&&this.fireWorker()}getLine(e){switch(e){case PS.FIRST:return wS.textValue("durability: "+this.health+"/"+this.durability);case PS.SECOND:return wS.textValue("defense: "+nS.FORT.STOCKADE.DEFENSE);case PS.THIRD:return this.health<this.durability&&!this.working?wS.buttonValue("repair","repair"):this.health<this.durability&&this.working?wS.buttonValue("stop repair","stop"):wS.emptyValue();case PS.FOURTH:return this.working?wS.progressValue(this.progress):wS.emptyValue()}}tick(e){!this.working||(this.progress<100&&(0===this.progress&&this.resourcesService.decreaseResource(Df.LOG,1,this.getName())||this.progress>0)&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.health+=1),this.health===this.durability&&this.fireWorker())}getHappinessEffect(){return 0}}class pR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.COTTON_MILL,nS.FIELD.COTTON_MILL,s,i,r,n,o,a,c)}}class fR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.TAILOR,nS.VILLAGE.TAILOR,s,i,r,n,o,a,c)}}class mR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.BREWERY,nS.FIELD.BREWERY,s,i,r,n,o,a,c)}}class SR extends LS{constructor(e=null,t=-1,i=nS.FORT.WOODEN_TOWER.DURABILITY,s=nS.FORT.WOODEN_TOWER.DURABILITY,r=0,n=!1,o=1){super(t,Lf.WOODEN_TOWER,e,nS.FORT.WOODEN_TOWER,n,!0,!1,o),this.health=i,this.durability=s,this.progress=r,this.servicesService&&(this.armyService=e.getArmyService(),this.modalService=e.getModalService(),this.worldService=e.getWorldService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,health:this.health,durability:this.durability,progress:this.progress,working:this.working}}build(){return this.worldService.getRegion(0).defense+=nS.FORT.STOCKADE.DEFENSE,this}prepareDemolish(){return this.worldService.getRegion(0).defense-=nS.FORT.STOCKADE.DEFENSE,!0}callback(e){if("repair"===e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to repair "+this.getName()+" for 1 log for each durability point missing?");const e=this.modalService.registerForConfirmation().subscribe(t=>{t&&(this.startProduction()||this.modalService.info("No free worker to repair wooden tower!")),e.unsubscribe()})}else"stop"===e&&this.fireWorker()}getLine(e){switch(e){case PS.FIRST:return wS.textValue("durability: "+this.health+"/"+this.durability);case PS.SECOND:return wS.textValue("defense: "+nS.FORT.WOODEN_TOWER.DEFENSE);case PS.THIRD:return this.health<this.durability&&!this.working?wS.buttonValue("repair","repair"):this.health<this.durability&&this.working?wS.buttonValue("stop repair","stop"):wS.emptyValue();case PS.FOURTH:return this.working?wS.progressValue(this.progress):wS.emptyValue()}}tick(e){!this.working||(this.progress<100&&(0===this.progress&&this.resourcesService.decreaseResource(Df.LOG,1,this.getName())||this.progress>0)&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.health+=1),this.health===this.durability&&this.fireWorker())}getHappinessEffect(){return 0}}class ER extends LS{constructor(e=null,t=-1,i=nS.FORT.STONE_TOWER.DURABILITY,s=nS.FORT.STONE_TOWER.DURABILITY,r=0,n=!1,o=1){super(t,Lf.STONE_TOWER,e,nS.FORT.STONE_TOWER,n,!0,!1,o),this.health=i,this.durability=s,this.progress=r,this.servicesService&&(this.armyService=e.getArmyService(),this.modalService=e.getModalService(),this.worldService=e.getWorldService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,health:this.health,durability:this.durability,progress:this.progress,working:this.working}}build(){return this.worldService.getRegion(0).defense+=nS.FORT.STOCKADE.DEFENSE,this}prepareDemolish(){return this.worldService.getRegion(0).defense-=nS.FORT.STOCKADE.DEFENSE,!0}callback(e){if("repair"===e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to repair "+this.getName()+" for 1 stone for each durability point missing?");const e=this.modalService.registerForConfirmation().subscribe(t=>{t&&(this.startProduction()||this.modalService.info("No free worker to repair stone tower!")),e.unsubscribe()})}else"stop"===e&&this.fireWorker()}getLine(e){switch(e){case PS.FIRST:return wS.textValue("durability: "+this.health+"/"+this.durability);case PS.SECOND:return wS.textValue("defense: "+nS.FORT.STONE_TOWER.DEFENSE);case PS.THIRD:return this.health<this.durability&&!this.working?wS.buttonValue("repair","repair"):this.health<this.durability&&this.working?wS.buttonValue("stop repair","stop"):wS.emptyValue();case PS.FOURTH:return this.working?wS.progressValue(this.progress):wS.emptyValue()}}tick(e){!this.working||(this.progress<100&&(0===this.progress&&this.resourcesService.decreaseResource(Df.STONE,1,this.getName())||this.progress>0)&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.health+=1),this.health===this.durability&&this.fireWorker())}getHappinessEffect(){return 0}}class vR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.WINERY,nS.FIELD.WINERY,s,i,r,n,o,a,c),e&&(this.managementService=e.getManagementService())}tick(){this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.isWorking()||this.hireWorker():this.isWorking()&&this.fireWorker()),this.working&&(this.outputStorage.length>0?this.collectOutputResources():this.inputStorage.length<this.settings.INPUT_RESOURCES.length&&0===this.outputStorage.length?this.collectInputResources()&&(this.status=Fv.PREPARING):this.progress<100&&this.status===Fv.PREPARING?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&this.status===Fv.PREPARING?(this.progress=0,this.status=Fv.PRODUCING_OUTPUT):this.progress<100&&this.status===Fv.PRODUCING_OUTPUT?(this.progress+=100/300,this.progress>=100&&(this.progress=100)):100===this.progress&&this.status===Fv.PRODUCING_OUTPUT&&(this.progress=0,this.inputStorage=[],this.outputStorage=Qf.copyResourceArray(this.settings.OUTPUT_RESOURCES),this.status=Fv.TRANSPORTING_OUTPUT))}}class RR extends LS{constructor(e=null,t=-1,i=0,s=0,r=0,n=!1,o=1){super(t,Lf.TAVERN,e,nS.VILLAGE.TAVERN,n,!0,!0,o),this.progress=i,this.beer=s,this.wine=r,this.servicesService&&(this.resourcesService=e.getResourcesService(),this.happinessService=e.getHappinessService(),this.managementService=e.getManagementService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,beer:this.beer,wine:this.wine,working:this.working}}getLine(e){switch(e){case PS.FIRST:return wS.textValue(this.beer<.001&&this.wine<.001?"waiting for alcohol":this.working?"open":"closed");case PS.SECOND:return wS.emptyValue();case PS.THIRD:return wS.textValue("beer: "+Qf.round(this.beer,2));case PS.FOURTH:return wS.textValue("wine: "+Qf.round(this.wine,2))}}tick(e){const t=this.resourcesService.getTotalPeople(),i=this.managementService.getAlcoholRations();if(this.working&&this.happinessService.getHappiness()<=100&&t>1&&(this.beer>.002||this.wine>.002)){for(let e=t;e>0;e--){const e=am.randomBetween(0,1);(0===e||this.wine<.002)&&this.beer>=.002*i?(this.beer-=.005*i,this.happinessService.updateHappiness($f.ALCOHOL,Number(i),-1)):(1===e||this.beer<.002)&&this.wine>=.002*i&&(this.wine-=.005*i,this.happinessService.updateHappiness($f.ALCOHOL,Number(i),-1))}this.beer<0&&(this.beer=0),this.wine<0&&(this.wine=0)}else this.happinessService.getHappiness()>75&&t>1&&this.happinessService.updateHappiness($f.ALCOHOL,0,-1);if(this.working){for(;this.beer<10*Math.ceil(t/100)&&this.resourcesService.decreaseResource(Df.BEER,1,this.getName());)this.beer+=2.5;for(;this.wine<10*Math.ceil(t/100)&&this.resourcesService.decreaseResource(Df.WINE,1,this.getName());)this.wine+=2.5}else this.happinessService.updateHappiness($f.ALCOHOL,0,-1)}}class OR extends LS{constructor(e=null,t=-1,i=0,s=!1,r=1){super(t,Lf.GEOLOGIST,e,nS.MOUNTAINS.GEOLOGIST,s,!0,!0,r),this.progress=i,this.servicesService&&(this.gameService=e.getGameService(),this.resourcesService=e.getResourcesService(),this.landService=e.getLandService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,working:this.working}}getLine(e){switch(e){case PS.FIRST:return wS.textValue("looking for ores");case PS.SECOND:return wS.progressValue(this.progress);case PS.THIRD:return wS.textValue(this.lastFind?"last find: "+Qf.prepareResourceName(this.lastFind)+" deposit":"last find: nothing");case PS.FOURTH:return wS.emptyValue()}}tick(e){if(this.working)if(this.progress<100)this.progress+=this.getPower(),this.progress>100&&(this.progress=100);else{const e=[];if(this.landService.getOre(Df.COAL)<50&&e.push({item:Df.COAL,chance:this.settings.COAL_CHANCE}),this.landService.getOre(Df.COPPER_ORE)<50&&e.push({item:Df.COPPER_ORE,chance:this.settings.COPPER_CHANCE}),this.landService.getOre(Df.TIN_ORE)<50&&e.push({item:Df.TIN_ORE,chance:this.settings.TIN_CHANCE}),this.gameService.isEnabled(Mf.GOLD)&&this.landService.getOre(Df.GOLD_ORE)<50&&e.push({item:Df.GOLD_ORE,chance:this.settings.GOLD_CHANCE}),this.gameService.isEnabled(Mf.SILVER)&&this.landService.getOre(Df.SILVER_ORE)<50&&e.push({item:Df.SILVER_ORE,chance:this.settings.SILVER_CHANCE}),this.gameService.isEnabled(Mf.IRON)&&this.landService.getOre(Df.IRON_ORE)<50&&e.push({item:Df.IRON_ORE,chance:this.settings.IRON_CHANCE}),e.length>0){this.progress=0;const t=am.randomElement(e);t?(this.landService.increaseOre(t,1),this.lastFind=t):this.lastFind=null}}}}class TR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.STONEMASON,nS.MOUNTAINS.STONEMASON,s,i,r,n,o,a,c)}}var IR=(()=>(function(e){e.MINING="mining {res}",e.WAITING_FOR_SELECTION="waiting for ore selection",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more {res}",e.TRANSPORTING="transporting {res}"}(IR||(IR={})),IR))();class bR extends LS{constructor(e=null,t=-1,i=0,s=IR.WAITING_FOR_SELECTION,r=!1,n=0,o=200,a=Df.NOTHING,c=1){super(t,Lf.PIT_MINE,e,nS.MOUNTAINS.PIT_MINE,r,!0,!0,c),this.progress=i,this.status=s,this.storage=n,this.resources=o,this.ore=a,this.servicesService&&(this.modalService=e.getModalService(),this.landService=e.getLandService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,resources:this.resources,ore:this.ore}}callback(e){if(this.ore===Df.NOTHING)if(this.landService.hasOre(Df[String(e.target.value).replace(" ","_")],20)){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to mine "+Qf.prepareResourceName(Df[String(e.target.value).replace(" ","_")])+" in this mine?");const t=this.modalService.registerForConfirmation().subscribe(i=>{i?(this.landService.decreaseOre(Df[String(e.target.value).replace(" ","_")],20),this.ore=Df[String(e.target.value).replace(" ","_")],this.status=IR.MINING,this.progress=0):e.target.selectedIndex=this.ore,t.unsubscribe()})}else this.modalService.info("Not enough "+Qf.prepareResourceName(Df[String(e.target.value).replace(" ","_")])+" deposits available<br>20 "+Qf.prepareResourceName(Df[String(e.target.value).replace(" ","_")])+" deposits required to start mining."),e.target.selectedIndex=this.ore}buildOnMountain(){return!0}isUsedUp(){return this.status===IR.NO_MORE_RESOURCES}hasBuff(){return!this.isUsedUp()&&super.hasBuff()}getLine(e){switch(e){case PS.FIRST:return this.ore!==Df.NOTHING?wS.textValue(Qf.prepareResourceName(this.ore).toLowerCase()+": "+this.resources):wS.emptyValue();case PS.SECOND:return wS.textValue(this.status.replace("{res}",Qf.prepareResourceName(this.ore).toLowerCase()));case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:if(this.ore===Df.NOTHING){const e=[];return e.push(Df[Df.NOTHING].replace("_"," ")),e.push(Df[Df.COAL].replace("_"," ")),e.push(Df[Df.GOLD_ORE].replace("_"," ")),e.push(Df[Df.SILVER_ORE].replace("_"," ")),e.push(Df[Df.COPPER_ORE].replace("_"," ")),e.push(Df[Df.TIN_ORE].replace("_"," ")),e.push(Df[Df.IRON_ORE].replace("_"," ")),wS.dropdownValue(e,Df[this.ore])}return wS.emptyValue()}}isStoppable(){return this.resources>0}tick(e){if(this.ore!==Df.NOTHING){if(this.resources<=0&&0===this.storage&&(this.status!==IR.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Pit mine mined all "+Qf.prepareResourceName(this.ore)),this.status=IR.NO_MORE_RESOURCES,this.stopProduction()),!this.working)return;this.storage>0?this.resourcesService.increaseResource(this.ore,this.storage,this.getName())?(this.storage=0,am.chance(this.settings.GEM_CHANCE)&&this.resourcesService.increaseResource(Df.GEMS,1,this.getName()),this.status=IR.MINING):this.status=IR.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=IR.MINING,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=IR.TRANSPORTING)}}}var CR=(()=>(function(e){e[e.NONE=0]="NONE",e[e.COW=1]="COW",e[e.CHICKEN=2]="CHICKEN",e[e.PIG=3]="PIG",e[e.HORSE=4]="HORSE",e[e.SHEEP=5]="SHEEP"}(CR||(CR={})),CR))();class yR extends LS{constructor(e=null,t=-1,i=nS.FIELD.PASTURE.SIZE,s=CR.NONE,r=0,n=0,o=!0,a=0,c=0,l=0,u=!1,h=1){super(t,Lf.PASTURE,e,nS.FIELD.PASTURE,o,!0,!0,h),this.currentSize=i,this.animal=s,this.progress=r,this.produceProgress=n,this.animals=a,this.food=c,this.chores=l,this.autoButcher=u,this.servicesService&&(this.modalService=e.getModalService(),this.weatherService=e.getWeatherService(),this.calendarService=e.getCalendarService(),this.fieldService=e.getService(Zf.FIELD))}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,size:this.currentSize,animal:this.animal,progress:this.progress,produceProgress:this.produceProgress,working:this.working,animals:this.animals,food:this.food,chores:this.chores,autoButcher:this.autoButcher}}build(){return this.resourcesService.getResource(Df.CHICKEN).isVisible()||(this.resourcesService.makeVisible(Df.CHICKEN),this.logService.log("New resource discovered: "+Qf.prepareResourceName(Df.CHICKEN)),this.resourcesService.makeVisible(Df.SHEEP),this.logService.log("New resource discovered: "+Qf.prepareResourceName(Df.SHEEP)),this.resourcesService.makeVisible(Df.COW),this.logService.log("New resource discovered: "+Qf.prepareResourceName(Df.COW)),this.resourcesService.makeVisible(Df.PIG),this.logService.log("New resource discovered: "+Qf.prepareResourceName(Df.PIG)),this.resourcesService.makeVisible(Df.HORSE),this.logService.log("New resource discovered: "+Qf.prepareResourceName(Df.HORSE))),this.resourcesService.updateAnimals(),super.build()}getSize(){return this.currentSize}getComplexity(){return super.getComplexity()*(this.getSize()/this.settings.SIZE)}findButcher(){return this.fieldService.getBuildings().filter(e=>e.getBuildingType()===Lf.BUTCHER).map(e=>e).sort((e,t)=>e.getAnimalsNumber()-t.getAnimalsNumber())[0]}butcher(e=!0){const t=this.findButcher();t?t.addAnimalToButcher(this.getResourceType())&&(this.resourcesService.addAnimalUsedData(this.getResourceType(),"Butcher",1),this.decreaseAnimal(1)):e||this.modalService.info("No butcher available or their work queue is full")}callback(e){if("butcher"===e&&this.animals>0)this.butcher(!1);else if("x"===e)this.autoButcher=!this.autoButcher;else if(this.animal===CR.NONE||0===this.animals)this.animal!==CR.NONE&&this.resourcesService.decreaseResourceLimit(this.getResourceType(),this.getMaxAnimals()),this.animal=CR[String(e.target.value)],this.progress=0,this.animal!==CR.NONE&&this.resourcesService.increaseResourceLimit(this.getResourceType(),this.getMaxAnimals()),this.resourcesService.updateAnimals();else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to change animals?<br>All current animals will be moved to other pastures and if there is no enough space they will be lost");const t=this.modalService.registerForConfirmation().subscribe(i=>{i?(this.resourcesService.decreaseResourceLimit(this.getResourceType(),this.getMaxAnimals()),this.moveAnimals(this.animals),this.animal=CR[String(e.target.value)],this.progress=0,this.animals=0,this.animal!==CR.NONE&&this.resourcesService.increaseResourceLimit(this.getResourceType(),this.getMaxAnimals()),this.resourcesService.updateAnimals()):e.target.selectedIndex=this.animal-1,t.unsubscribe()})}}finishDemolish(){}prepareDemolish(){return this.stopProduction(),this.animal!==CR.NONE&&(this.moveAnimals(this.animals),this.resourcesService.decreaseResourceLimit(this.getResourceType(),this.getMaxAnimals())),!0}getLine(e){switch(e){case PS.FIRST:return this.animal!==CR.NONE?wS.textValue(CR[this.animal].toLowerCase()+": "+this.animals+"/"+this.getMaxAnimals()):wS.emptyValue();case PS.SECOND:if(this.animals>0&&this.food<0)return wS.progressValue(Math.abs(this.food),"famine");{const e=[];return e.push(CR[CR.NONE]),e.push(CR[CR.CHICKEN]),e.push(CR[CR.SHEEP]),e.push(CR[CR.COW]),e.push(CR[CR.PIG]),e.push(CR[CR.HORSE]),wS.dropdownValue(e,CR[this.animal])}case PS.THIRD:return this.animals>0&&this.findButcher()?wS.buttonCheckboxValue("butcher","butcher","auto butcher",this.autoButcher,"x"):wS.emptyValue();case PS.FOURTH:return wS.emptyValue()}}getName(){return this.animal===CR.NONE?"Pasture":CR[this.animal].charAt(0).toUpperCase()+CR[this.animal].slice(1).toLowerCase()+" pasture"}startProduction(){return this.working=!0,!0}stopProduction(){this.working=!1}tick(e){if(this.food<0&&this.calendarService.getSeason()!==SS.WINTER&&(this.food=0),this.autoButcher&&this.animals>0&&this.animals===this.getMaxAnimals()&&this.butcher(),this.animals>0?this.calendarService.getSeason()===SS.WINTER?(this.food-=.0015*this.getAnimalSettings().SIZE*this.animals,this.food<=-100&&(this.food=0,this.decreaseAnimal(1))):(this.food-=2e-4*this.getAnimalSettings().SIZE*this.animals,this.food<=-100&&(this.food=0,this.decreaseAnimal(1))):this.food<0&&(this.food=0),this.food>=0&&this.animals>1&&this.chores<this.getSize()&&(this.animals<this.getMaxAnimals()||this.resourcesService.hasLimit(this.getResourceType()))&&this.progress<100&&(this.progress+=.05/(10/this.getAnimalSettings().REPRODUCTION_SPEED)*this.animals*(1+this.effectsService.getNatureEffectsValue()/100),this.progress>=100&&(this.animals<this.getMaxAnimals()||this.resourcesService.hasLimit(this.getResourceType()))&&(this.progress=0,this.animals<this.getMaxAnimals()?(this.resourcesService.addAnimalProducedData(this.getResourceType(),"Pasture",1),this.increaseAnimal(1)):this.resourcesService.hasLimit(this.getResourceType())&&this.resourcesService.increaseResource(this.getResourceType(),1,"Pasture",!0))),(this.animal===CR.CHICKEN||this.animal===CR.COW||this.animal===CR.SHEEP)&&(0===this.animals&&(this.produceProgress=0),this.produceProgress<100&&this.chores<this.getSize()&&(this.produceProgress+=.2*this.animals*(1+this.effectsService.getNatureEffectsValue()/100),this.produceProgress>=100)))if(this.produceProgress=0,this.animal===CR.CHICKEN){if(this.servicesService.getRoyalService().layGoldenEgg())return;this.resourcesService.increaseResource(Df.EGG,1,this.getName())}else if(this.animal===CR.COW)this.resourcesService.increaseResource(Df.MILK,1,this.getName());else if(this.animal===CR.SHEEP){if(this.servicesService.getRoyalService().getGoldenFleece())return;this.resourcesService.increaseResource(Df.WOOL,1,this.getName())}this.chores+=.05*this.animals,this.chores>2*this.getSize()&&(this.chores=2*this.getSize())}work(e){return this.food<100&&0===this.resourcesService.hasResource(Df.HAY,1,this.getName())?(this.resourcesService.decreaseResource(Df.HAY,1,this.getName())&&(this.food+=10),!0):this.chores>=1&&(this.chores-=e/nS.FIELD.FARM.BASE_POWER,this.chores<0&&(this.chores=0),!0)}fireWorker(){return!1}hireWorker(){return!1}getWorkers(){return 0}hasWork(){return!!this.isWorking()&&(this.food<50&&0===this.resourcesService.hasResource(Df.HAY,1,this.getName())||this.chores>=1)}getDetails(){return this.animal!==CR.NONE?"pasture size: "+Qf.round(this.getSize(),0)+"<br>progress: "+Qf.round(this.progress,2)+"%<br>produce progress: "+Qf.round(this.produceProgress,2)+"%<br>food: "+Qf.round(this.food,2)+"<br>chores: "+Qf.round(this.chores,2)+"<br>"+Qf.prepareResourceName(this.getResourceType())+" meat: "+this.getAnimalSettings().MEAT+"<br>"+Qf.prepareResourceName(this.getResourceType())+" fur: "+this.getAnimalSettings().FUR+"<br>"+Qf.prepareResourceName(this.getResourceType()).toLowerCase()+" size: "+this.getAnimalSettings().SIZE+"<br>"+super.getDetails():super.getDetails()}getHappinessEffect(){return 0}isCombinable(){return!0}isSplittable(){return!0}moveAnimals(e){const t=this.fieldService.getBuildings().filter(e=>e.getBuildingType()===Lf.PASTURE&&e!==this&&e.getAnimals()<e.getMaxAnimals()).map(e=>e).filter(e=>e.getResourceType()===this.getResourceType());for(const i of t){for(;e>0&&i.getAnimals()<i.getMaxAnimals();)i.increaseAnimal(1),e-=1,this.decreaseAnimal(1);if(0===e)return}}getResourceType(){return this.animal!==CR.NONE?Df[CR[this.animal]]:Df.NOTHING}getAnimals(){return this.animals}getAnimalSettings(){return oS.getResource(this.getResourceType())}getMaxAnimals(){return this.getResourceType()!==Df.NOTHING?Math.floor(this.currentSize/this.getAnimalSettings().SIZE):0}increaseAnimal(e){this.animals+=e,this.resourcesService.updateAnimals()}decreaseAnimal(e){this.animals-=e,this.resourcesService.updateAnimals()}combine(e,t){if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will keep animals");const i=this.modalService.registerForConfirmation().subscribe(s=>{i.unsubscribe(),s?this.doCombine(e,t):t.finaliseCombine(!1),this.resourcesService.updateAnimals()})}}doCombine(e,t){this.currentSize+=e.getSize(),e.animal===this.animal?this.increaseAnimal(e.getAnimals()):this.animal===CR.NONE&&e.animal!==CR.NONE?(this.animal=e.animal,this.increaseAnimal(e.getAnimals())):e.moveAnimals(e.getAnimals()),e.animals=0,t.finaliseCombine(!0)}split(e){this.modalService.open(Pf.INPUT),this.modalService.setModalText("Set new pasture size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");const t=this.modalService.registerForValueResponse().subscribe(i=>{if(t.unsubscribe(),null!==i){if(!isNaN(i)&&0!==i)if(i>=1&&i<this.getSize()){this.currentSize-=Number(i);const t=new yR(this.servicesService,this.servicesService.getIdService().getNextId(),Number(i)).build();e.finaliseSplit(t),t.animal=this.animal,this.animals>this.getMaxAnimals()&&(this.moveAnimals(this.animals-this.getMaxAnimals()),this.animals>this.getMaxAnimals()&&this.decreaseAnimal(this.animals-this.getMaxAnimals()))}else this.modalService.info("Invalid size value!");this.resourcesService.updateAnimals()}})}isCompatible(e){return this.animal===e.animal}}var AR=(()=>(function(e){e.BUTCHERING="butchering {animal}",e.WAITING_FOR_ANIMALS="waiting for animals",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting goods"}(AR||(AR={})),AR))();class NR extends LS{constructor(e=null,t=-1,i=AR.WAITING_FOR_ANIMALS,s=0,r=!0,n=0,o=0,a=[],c=!0,l=1){super(t,Lf.BUTCHER,e,nS.FIELD.BUTCHER,r,!0,!0,l),this.status=i,this.progress=s,this.outputStorage=n,this.outputFurStorage=o,this.animals=a,this.discardExcessFur=c}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,status:this.status,progress:this.progress,working:this.working,outputStorage:this.outputStorage,animals:this.animals,discardExcessFur:this.discardExcessFur,outputFurStorage:this.outputFurStorage}}callback(e){"toggleDiscard"===e&&(this.discardExcessFur=!this.discardExcessFur)}getLine(e){switch(e){case PS.FIRST:return wS.textValue(this.animals.length>0?this.status.replace("{animal}",Qf.prepareResourceName(this.animals[0])):this.status);case PS.SECOND:return wS.progressValue(this.progress);case PS.THIRD:return wS.textValue("queue: "+this.animals.length+"/10");case PS.FOURTH:return wS.checkboxValue("discard excess fur",this.discardExcessFur,"toggleDiscard")}}getAnimalsNumber(){return this.animals.length}getFreeSpace(){return 10-this.getAnimalsNumber()}addAnimalToButcher(e){return this.animals.length<10&&(this.animals.push(e),!0)}tick(e){if(this.working)if(this.animals.length>0&&0===this.outputStorage&&0===this.outputFurStorage)if(this.status=AR.BUTCHERING,this.progress<100)this.progress+=this.getPower()/oS.getResource(this.animals[0]).BUTCHERING_DIFFICULTY,this.progress>100&&(this.progress=100);else{this.status=AR.TRANSPORTING,this.progress=0;const e=this.animals.shift();this.outputStorage=oS.getResource(e).MEAT,this.resourcesService.increaseResource(Df.MEAT,this.outputStorage,this.getName())?this.outputStorage=0:this.status=AR.WAITING_FOR_WAREHOUSE_SPACE,this.outputFurStorage=oS.getResource(e).FUR,this.resourcesService.increaseResource(Df.FUR,this.outputFurStorage,this.getName())||this.discardExcessFur?this.outputFurStorage=0:this.status=AR.WAITING_FOR_WAREHOUSE_SPACE}else{if(0!==this.outputStorage){const e=this.resourcesService.getResource(Df.MEAT).getFreeSpace(),t=Math.max(Math.min(e,this.outputStorage),0);this.resourcesService.increaseResource(Df.MEAT,t,this.getName())&&(this.outputStorage-=t,0===this.outputFurStorage&&0===this.outputStorage&&(this.status=AR.WAITING_FOR_ANIMALS))}if(0!==this.outputFurStorage){const e=this.resourcesService.getResource(Df.FUR).getFreeSpace(),t=Math.max(Math.min(e,this.outputFurStorage),0);this.resourcesService.increaseResource(Df.FUR,t,this.getName())&&(this.outputFurStorage-=t,0===this.outputFurStorage&&0===this.outputStorage&&(this.status=AR.WAITING_FOR_ANIMALS)),this.discardExcessFur&&(this.outputFurStorage=0,this.status=AR.WAITING_FOR_ANIMALS)}0===this.outputStorage&&0===this.outputFurStorage&&(this.status=AR.WAITING_FOR_ANIMALS)}}getDetails(){return super.getDetails()+"local storage:<br>&nbsp;&nbsp;meat: "+this.outputStorage+"<br>&nbsp;&nbsp;fur: "+this.outputFurStorage}}class _R extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.MINT,nS.MOUNTAINS.MINT,s,i,r,n,o,a,c)}}class wR extends LS{constructor(e,t,i,s,r,n,o,a,c){super(e,t,i,s,r>0,o,a,c),this.servicesService=i,this.workers=r,this.maxWorkers=n}fireWorker(){return this.workers>0&&(this.resourcesService.fireWorker(1),this.workers-=1,!0)}hireWorker(){return!!(this.workers<this.maxWorkers&&this.resourcesService.hireWorker())&&(this.workers+=1,!0)}getWorkers(){return this.workers}isWorking(){return this.workers>0}startProduction(){if(0===this.workers){for(;this.workers<this.maxWorkers&&this.resourcesService.hireWorker();)this.workers+=1;if(this.workers>0)return!0}return!1}stopProduction(){this.workers>0&&(this.resourcesService.fireWorker(this.workers),this.workers=0)}}var PR=(()=>(function(e){e[e.CONSTRUCTION=0]="CONSTRUCTION",e[e.BUILT=1]="BUILT",e[e.ABDICATED=2]="ABDICATED",e[e.USED=3]="USED"}(PR||(PR={})),PR))();let MR=(()=>{class e extends wR{constructor(t,i,s,r,n,o,a,c,l,u){super(t,i,s,r,u,e.maxWorkers,!1,!0,1),this.progress=n,this.maxProgress=o,this.stage=a,this.state=c,this.year=l,this.prepareIcons()}toJSON(){return{id:this.id,buildingType:this.buildingType,progress:this.progress,maxProgress:this.maxProgress,stage:this.stage,state:this.state,year:this.year,workers:this.workers}}prepareIcons(){this.iconsValue=[],this.settings.STAGES[this.stage]&&this.settings.STAGES[this.stage].cost.forEach(e=>this.iconsValue.push({name:Df[e.resource],path:"resources",prefix:e.amount,suffix:""}))}callback(e){if("add"===e){const e=this.settings.STAGES[this.stage];if(void 0===this.settings.STAGES[this.stage]&&this.maxProgress<100)return void(this.maxProgress=100);const t=new Map;e.cost.forEach(e=>t.set(e.resource,e.amount)),this.resourcesService.decreaseResources(t,this.getName(),!0)&&(this.stage+=1,this.maxProgress+=e.progress,this.maxProgress>100&&(this.maxProgress=100),this.prepareIcons())}else if("abdicate"===e){this.modalService.open(Pf.ABDICATION);const e=this.modalService.registerForAbdication().subscribe(t=>{e.unsubscribe(),t&&(this.state=PR.ABDICATED,this.servicesService.getGameService().incrementAbdicationLevel())})}else"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}forceAbdicate(){this.state===PR.BUILT&&(this.state=PR.ABDICATED,this.servicesService.getGameService().incrementAbdicationLevel())}getName(){return this.progress>=100?super.getName():super.getName()+" construction"}getLine(e){switch(e){case PS.FIRST:return this.state===PR.CONSTRUCTION?wS.progressValue(this.progress,Qf.round(this.progress,2)+"% / "+this.maxProgress+"%"):wS.textValue("built in year "+this.year);case PS.SECOND:return this.state===PR.CONSTRUCTION?wS.iconValue(this.iconsValue):this.state===PR.BUILT?wS.buttonValue(this.getAbdicationText(),"abdicate"):wS.emptyValue();case PS.THIRD:return this.maxProgress<100?wS.buttonValue("add materials","add"):wS.emptyValue();case PS.FOURTH:return this.state===PR.CONSTRUCTION?wS.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire"):wS.emptyValue()}}getAbdicationText(){return"abdicate"}tick(e){!this.isWorking()||(this.progress>=100&&(this.stopProduction(),this.addPermanentEffect(),this.progress=100,this.state=PR.BUILT,this.year=this.servicesService.getCalendarService().getYear(),this.getBuildingType()===Lf.ASCENSION_TEMPLE&&this.servicesService.getLogService().mystical("As you enter the temple you have strange feeling of many eyes watching you, <br>however there is nobody there. At the end of a big hall you find a golden altar.<br>This is it, your whole life lead you here. You feel safe.")),this.progress<this.maxProgress&&(this.progress+=.001*this.getPower()*this.workers))}getEffects(){return this.state===PR.CONSTRUCTION?this.effectsService.getBuildingEffectsValue(Lf.CONSTRUCTION,!1):super.getEffects()}getPermanentEffects(){return this.state===PR.CONSTRUCTION?this.effectsService.getBuildingEffectsValue(Lf.CONSTRUCTION,!0):super.getPermanentEffects()}getHappinessEffect(){return this.state===PR.CONSTRUCTION?super.getHappinessEffect():0}isStoppable(){return this.state===PR.CONSTRUCTION}isFinished(){return this.state!==PR.CONSTRUCTION}addPermanentEffect(){this.addBuildingEffects(),this.addArmyEffects()}addBuildingEffects(){if(this.settings.BUILDING_EFFECTS&&this.settings.BUILDING_EFFECTS.length>0){const e=this.servicesService.getEffectsService();this.settings.BUILDING_EFFECTS.forEach(t=>{e.addBuildingEffect(new nm(this.getName(),t.building,Number(t.value),om.WONDER))})}}addArmyEffects(){if(this.settings.ARMY_EFFECTS&&this.settings.ARMY_EFFECTS.length>0){const e=this.servicesService.getEffectsService();this.settings.ARMY_EFFECTS.forEach(t=>{e.addArmyEffect(new cm(this.getName(),t.troop,Number(t.value),om.WONDER))})}}verifyWonderEffects(){if(this.isFinished()){if(this.settings.BUILDING_EFFECTS){const e=this.servicesService.getEffectsService();this.settings.BUILDING_EFFECTS.forEach(t=>{this.effectsService.hasBuildingEffect(this.getName(),t.building)||e.addBuildingEffect(new nm(this.getName(),t.building,Number(t.value),om.WONDER))})}if(this.settings.ARMY_EFFECTS){const e=this.servicesService.getEffectsService();this.settings.ARMY_EFFECTS.forEach(t=>{this.effectsService.hasArmyEffect(this.getName(),t.troop)||e.addArmyEffect(new cm(this.getName(),t.troop,Number(t.value),om.WONDER))})}}}}return e.maxWorkers=5,e})();class LR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.STONEHENGE,e,nS.PLATEAU.STONEHENGE,i,s,r,n,o,a)}tick(e){if(super.tick(e),this.state===PR.ABDICATED){this.state=PR.USED,this.servicesService.getGameService().enable(Mf.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Stonehenge",!0)}}}class DR extends LS{constructor(e=null,t=-1,i=0,s=1){super(t,Lf.MARKETPLACE,e,nS.VILLAGE.MARKETPLACE,!0,!0,!1,s),this.progress=i,this.callMerchantPrice=[{name:"coins",path:"resources",prefix:"",suffix:"25"}]}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress}}build(){return this.servicesService.getGameService().enable(Mf.MARKET),super.build()}callback(e){"bribe"===e&&(this.resourcesService.decreaseResource(Df.COINS,25,this.getName(),!0)?1===am.randomBetween(1,2)&&(this.progress+=50,this.progress>=100&&(this.progress=0,this.servicesService.getService(Zf.MARKET).callMerchant())):this.modalService.info("Not enough coins for a bribe"))}getLine(e){switch(e){case PS.FIRST:return wS.progressValue(this.progress,"merchant arrival");case PS.SECOND:return wS.emptyValue();case PS.THIRD:return wS.iconValue(this.callMerchantPrice);case PS.FOURTH:return wS.buttonValue("bribe merchant (50% chance)","bribe")}}tick(e){1===am.randomBetween(1,10)&&(this.progress+=this.getPower()),this.progress>=100&&(this.servicesService.getService(Zf.MARKET).callMerchant(),this.progress=0)}getWorkers(){return 0}}class xR extends LS{constructor(e=null,t=-1,i=1){super(t,Lf.SMITHY,e,nS.MOUNTAINS.SMITHY,!1,!0,!1,i),e&&(this.gameService=e.getGameService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType}}build(){return this.settings.RECIPES.forEach(e=>{this.gameService.isEnabled(e.prerequisite)&&this.servicesService.getRecipeService().enable(e.recipe)}),this.gameService.enable(Mf.BUILT_SMITHY),this}prepareDemolish(){return this.settings.RECIPES.forEach(e=>this.servicesService.getRecipeService().disable(e.recipe)),this.gameService.disable(Mf.BUILT_SMITHY),this.servicesService.getService(Zf.CRAFTING).filterCraftingQueue(this.settings.RECIPES),this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.WORKSHOP).map(e=>e).forEach(e=>{e.getRecipe()&&this.settings.RECIPES.includes(e.getRecipe().id)&&e.cancelCrafting()}),this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.MANUFACTURE).map(e=>e).forEach(e=>{e.getRecipe()&&this.settings.RECIPES.includes(e.getRecipe().id)&&e.cancelCrafting()}),!0}getLine(e){switch(e){case PS.FIRST:return wS.textValue("Allows workshops");case PS.SECOND:return wS.textValue("to smelt ore");case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}getEffects(){return 0}getHappinessEffect(){return 0}getPermanentEffects(){return 0}}class kR extends LS{constructor(e=null,t=-1,i=!1,s=0,r=1){super(t,Lf.CHURCH,e,nS.VILLAGE.CHURCH,i,!0,!0,r),this.progress=s,this.servicesService&&(this.religionService=e.getService(Zf.RELIGION))}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,working:this.working,progress:this.progress}}build(){return this.religionService.increaseFaithCap(50),this.servicesService.getGameService().enable(Mf.RELIGION),this.startProduction(),this}getLine(e){switch(e){case PS.FIRST:case PS.SECOND:return wS.emptyValue();case PS.THIRD:return wS.progressValue(this.progress,"prayers");case PS.FOURTH:return wS.emptyValue()}}prepareDemolish(){return this.religionService.decreaseFaithCap(50),!0}tick(e){if(!this.working)return;const t=this.servicesService.getVillageService().getPopulation();this.progress+=.1*(Math.pow(Math.log(t),2)+1)*this.getPower(),this.progress>100&&(this.progress=0,this.religionService.increaseFaith(1))}}class FR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.PYRAMID,e,nS.PLATEAU.PYRAMID,i,s,r,n,o,a)}tick(e){if(super.tick(e),this.state===PR.ABDICATED){this.state=PR.USED,this.servicesService.getGameService().enable(Mf.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Pyramid",!0)}}}class UR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.HANGING_GARDEN,e,nS.PLATEAU.HANGING_GARDEN,i,s,r,n,o,a)}tick(e){if(super.tick(e),this.state===PR.ABDICATED){this.state=PR.USED,this.servicesService.getGameService().enable(Mf.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Hanging Garden",!0)}}}class HR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.COLOSSUS,e,nS.PLATEAU.COLOSSUS,i,s,r,n,o,a)}tick(e){if(super.tick(e),this.state===PR.ABDICATED){this.state=PR.USED,this.servicesService.getGameService().enable(Mf.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Colossus",!0)}}}class GR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.ASCENSION_TEMPLE,e,nS.PLATEAU.ASCENSION_TEMPLE,i,s,r,n,o,a)}callback(e){if("abdicate"===e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to ascend?<br><br>You will start from the beginning and all progress except for</br>royal points, heritage points and permanent royal upgrades will be deleted.");const e=this.modalService.registerForConfirmation().subscribe(t=>{if(e.unsubscribe(),t){this.state=PR.ABDICATED,this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.mystical("Your ascension granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Ascension Temple",!0),this.servicesService.getService(Zf.SERIALIZER).ascensionReset()}})}else super.callback(e)}getAbdicationText(){return"ascend"}forceAbdicate(){}}class BR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.UNDERGROUND_CITY,e,nS.PLATEAU.UNDERGROUND_CITY,i,s,r,n,o,a)}tick(e){if(super.tick(e),this.state===PR.ABDICATED){this.state=PR.USED,this.servicesService.getGameService().enable(Mf.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Underground City",!0)}}}class WR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.GREAT_LIGHTHOUSE,e,nS.PLATEAU.GREAT_LIGHTHOUSE,i,s,r,n,o,a)}tick(e){if(super.tick(e),this.state===PR.ABDICATED){this.state=PR.USED,this.servicesService.getGameService().enable(Mf.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Great Lighthouse",!0)}}}class VR extends MR{constructor(e=null,t=-1,i=0,s=0,r=0,n=PR.CONSTRUCTION,o=-1,a=0){super(t,Lf.SACRED_GROVE,e,nS.PLATEAU.SACRED_GROVE,i,s,r,n,o,a)}tick(e){if(super.tick(e),this.state===PR.ABDICATED){this.state=PR.USED,this.servicesService.getGameService().enable(Mf.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");const e=this.servicesService.getKongregateService();e.isAvailable()&&e.submitStat("Sacred Grove",!0)}}}class zR extends LS{constructor(e=null,t=-1,i=1){super(t,Lf.STASH,e,nS.FORT.STASH,!1,!0,!1,i),this.servicesService&&(this.armyService=e.getArmyService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType}}build(){return this.armyService.increaseStash(nS.FORT.STASH.SIZE),this}prepareDemolish(){return this.armyService.decreaseStash(nS.FORT.STASH.SIZE),!0}getLine(e){switch(e){case PS.FIRST:return wS.textValue("stash size: "+nS.FORT.STASH.SIZE);case PS.SECOND:case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}}var YR=(()=>(function(e){e.CRAFTING="crafting {craft}",e.WAITING_FOR_RESOURCES="waiting for resources",e.WAITING_FOR_WAREHOUSE="waiting for warehouse space",e.NO_CRAFTING="no crafting recipe",e.PRODUCTION_SETUP="production setup",e.FETCHING_MATERIALS="fetching materials",e.TRANSPORTING="transporting goods"}(YR||(YR={})),YR))();class KR extends LS{constructor(e=null,t=-1,i=0,s=YR.NO_CRAFTING,r=!1,n=-1,o=1,a=0){super(t,Lf.MANUFACTURE,e,nS.VILLAGE.MANUFACTURE,r,!0,!0,o),this.progress=i,this.status=s,this.storage=a,this.recipe=null,this.iconsValue=[],e&&(this.resourcesService=e.getResourcesService(),this.modalService=e.getModalService(),this.recipeService=e.getRecipeService(),n>=0&&(this.recipe=this.recipeService.getRecipeById(n),this.prepareIcons()))}prepareIcons(){this.iconsValue=[],this.recipe&&Array.from(this.recipe.cost.entries()).forEach(e=>{this.iconsValue.push({name:Df[e[0]],path:"resources",prefix:e[1],suffix:""})})}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,recipe:null!==this.recipe?this.recipe.id:-1,storage:this.storage}}build(){return this.startProduction(),this}prepareDemolish(){return super.prepareDemolish()}callback(e){if("select"===e){this.modalService.open(Pf.RECIPE);const e=this.modalService.registerForValueResponse().subscribe(t=>{e.unsubscribe(),null!==t&&(this.recipe=this.recipeService.getRecipeById(t),this.prepareIcons(),this.status=YR.PRODUCTION_SETUP)})}else if("change"===e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to change production recipe?");const e=this.modalService.registerForConfirmation().subscribe(t=>{if(e.unsubscribe(),t){this.modalService.open(Pf.RECIPE),this.modalService.setModalValue(this.recipe.id);const e=this.modalService.registerForValueResponse().subscribe(t=>{e.unsubscribe(),null!==t&&(this.progress=0,this.recipe=this.recipeService.getRecipeById(t),this.prepareIcons(),this.status=YR.PRODUCTION_SETUP)})}})}}getLine(e){switch(e){case PS.FIRST:return wS.textValue(this.recipe?this.status.replace("{craft}",Qf.prepareResourceName(this.recipe.resource)):this.status);case PS.SECOND:return wS.progressValue(this.progress);case PS.THIRD:return this.recipe?wS.iconValue(this.iconsValue):wS.emptyValue();case PS.FOURTH:return null===this.recipe?wS.buttonValue("select recipe","select"):wS.buttonValue(Qf.prepareResourceName(this.recipe.resource),"change")}}tick(e){if(this.working)if(this.status===YR.PRODUCTION_SETUP)this.progress<100?(this.progress+=.5*this.getPower()/this.recipe.craftingDifficulty,this.progress>100&&(this.progress=100)):(this.progress=0,this.status=YR.FETCHING_MATERIALS);else if(this.status===YR.CRAFTING)this.progress<100?(this.progress+=this.getPower()/this.recipe.craftingDifficulty*nS.VILLAGE.MANUFACTURE.CRAFTING_POWER,this.progress>100&&(this.progress=100)):(this.progress=0,this.storage=this.recipe.amount,this.status=YR.TRANSPORTING);else if(this.status===YR.FETCHING_MATERIALS||this.status===YR.WAITING_FOR_RESOURCES)this.status=this.resourcesService.decreaseResources(this.recipe.cost,this.getName(),!1,1,!0)?YR.CRAFTING:YR.WAITING_FOR_RESOURCES;else if(this.status===YR.TRANSPORTING||this.status===YR.WAITING_FOR_WAREHOUSE){const e=this.resourcesService.getLimit(this.recipe.resource);this.storage>e?(this.storage-=e,this.resourcesService.increaseResource(this.recipe.resource,e,this.getName()),this.status=YR.WAITING_FOR_WAREHOUSE):this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName())&&(this.status=YR.FETCHING_MATERIALS)}}getRecipe(){return this.recipe}cancelCrafting(){this.recipe=null,this.progress=0,this.status=YR.NO_CRAFTING}}class jR extends pv{constructor(e=null,t=-1,i=0,s=0,r=100,n=100,o=0,a=1,c=!0){super(e,t,Lf.LONGHOUSE,nS.VILLAGE.LONGHOUSE,i,s,r,n,o,a,c)}}class $R extends LS{constructor(e=null,t=-1,i=0,s=!1,r=zf.NONE,n=0,o=1){super(t,Lf.EMBASSY,e,nS.FORT.EMBASSY,s,!0,!0,o),this.progress=i,this.country=r,this.paper=n,this.servicesService&&(this.worldService=e.getWorldService())}toJSON(){return{id:this.id,level:this.level,working:this.working,progress:this.progress,country:this.country,paper:this.paper,buildingType:this.buildingType}}callback(e){this.country=zf[String(e.target.value)],this.progress=0}getLine(e){switch(e){case PS.FIRST:const e=this.worldService.getCountriesList();return e.includes(zf[this.country])||(this.country=zf.NONE),wS.dropdownValue(e,zf[this.country]);case PS.SECOND:return this.country===zf.NONE?wS.emptyValue():wS.textValue("current standing: "+this.worldService.getCountry(this.country).diplomacy);case PS.THIRD:return this.country===zf.NONE?wS.emptyValue():wS.progressValue(this.progress);case PS.FOURTH:return this.paper<.5?wS.textValue("No enough paper"):wS.emptyValue()}}tick(e){!this.working||(this.paper<5&&this.resourcesService.decreaseResource(Df.PAPER,1,this.getName())&&(this.paper+=1),this.country!==zf.NONE&&this.paper>=1&&this.worldService.getCountry(this.country).diplomacy<100&&(this.progress<100?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):(this.progress=0,this.paper-=.5,this.worldService.getCountry(this.country).increaseDiplomacy(1))))}getDetails(){return super.getDetails()+"paper: "+this.paper}}class QR extends Uv{constructor(e=null,t=-1,i=0,s=Fv.FETCHING_INPUT,r=[],n=[],o=!1,a=null,c=1){super(e,t,Lf.PAPER_MILL,nS.FOREST.PAPER_MILL,s,i,r,n,o,a,c)}}var qR=(()=>(function(e){e.MINING="mining {res}",e.WAITING_FOR_SELECTION="waiting for ore selection",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.LOOKING_FOR_NEW_ORE_VEIN="looking for new ore vein",e.WAITING_FOR_ORE_DEPOSIT="waiting for ore deposit",e.TRANSPORTING="transporting {res}"}(qR||(qR={})),qR))();let XR=(()=>{class e extends wR{constructor(t=null,i=-1,s=0,r=qR.WAITING_FOR_SELECTION,n=0,o=0,a=20,c=0,l=Df.NOTHING,u=1){super(i,Lf.DEEP_MINE,t,nS.MOUNTAINS.DEEP_MINE,o,e.maxWorkers,!0,!0,u),this.progress=s,this.status=r,this.storage=n,this.resources=a,this.oreToFind=c,this.ore=l,this.maxResources=20*u,this.servicesService&&(this.modalService=t.getModalService(),this.landService=t.getLandService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,storage:this.storage,workers:this.workers,resources:this.resources,oreToFind:this.oreToFind,ore:this.ore}}callback(e){if(this.ore===Df.NOTHING)if(Df[String(e.target.value).replace(" ","_")]===Df.STONE){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to mine "+Qf.prepareResourceName(Df[String(e.target.value).replace(" ","_")])+" in this mine?");const t=this.modalService.registerForConfirmation().subscribe(i=>{i?(this.ore=Df[String(e.target.value).replace(" ","_")],this.status=qR.MINING,this.progress=0):e.target.selectedIndex=this.ore,t.unsubscribe()})}else if(this.landService.hasOre(Df[String(e.target.value).replace(" ","_")],20)){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to mine "+Qf.prepareResourceName(Df[String(e.target.value).replace(" ","_")])+" in this mine?");const t=this.modalService.registerForConfirmation().subscribe(i=>{i?(this.landService.decreaseOre(Df[String(e.target.value).replace(" ","_")],20),this.ore=Df[String(e.target.value).replace(" ","_")],this.status=qR.MINING,this.progress=0,this.startProduction()):e.target.selectedIndex=this.ore,t.unsubscribe()})}else this.modalService.info("Not enough "+Qf.prepareResourceName(Df[String(e.target.value).replace(" ","_")])+" deposits available<br>20 "+Qf.prepareResourceName(Df[String(e.target.value).replace(" ","_")])+" deposits required to start mining."),e.target.selectedIndex=this.ore;else"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}hasBuff(){return!this.isUsedUp()&&super.hasBuff()}getLine(e){switch(e){case PS.FIRST:if(this.ore!==Df.NOTHING)return wS.textValue(Qf.prepareResourceName(this.ore).toLowerCase()+": "+this.resources+"/"+this.maxResources);{const e=[];return e.push(Df[Df.NOTHING].replace("_"," ")),e.push(Df[Df.STONE].replace("_"," ")),e.push(Df[Df.COAL].replace("_"," ")),e.push(Df[Df.GOLD_ORE].replace("_"," ")),e.push(Df[Df.SILVER_ORE].replace("_"," ")),e.push(Df[Df.COPPER_ORE].replace("_"," ")),e.push(Df[Df.TIN_ORE].replace("_"," ")),e.push(Df[Df.IRON_ORE].replace("_"," ")),wS.dropdownValue(e,Df[this.ore])}case PS.SECOND:return wS.textValue(this.status.replace("{res}",Qf.prepareResourceName(this.ore).toLowerCase()));case PS.THIRD:return this.ore!==Df.NOTHING?wS.progressValue(this.progress):wS.emptyValue();case PS.FOURTH:return this.ore!==Df.NOTHING?wS.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire"):wS.emptyValue()}}tick(e){if(this.ore!==Df.NOTHING){if(!this.isWorking())return;if(this.status===qR.LOOKING_FOR_NEW_ORE_VEIN||this.status===qR.WAITING_FOR_ORE_DEPOSIT){if(0===this.oreToFind)if(this.ore===Df.STONE)this.oreToFind=this.maxResources;else{const e=this.landService.getOre(this.ore);if(!(e>0))return void(this.status=qR.WAITING_FOR_ORE_DEPOSIT);10*e>this.maxResources?(this.landService.decreaseOre(this.ore,this.maxResources/10),this.oreToFind=this.maxResources):(this.landService.decreaseOre(this.ore,e),this.oreToFind=10*e)}this.progress<100?(this.progress+=this.getPower()*this.workers/(this.oreToFind/this.getBuildingLevel()),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources=this.oreToFind,this.oreToFind=0,this.status=qR.MINING)}else this.storage>0?this.resourcesService.increaseResource(this.ore,this.storage,this.getName())?(this.storage=0,am.chance(this.settings.GEM_CHANCE)&&this.resourcesService.increaseResource(Df.GEMS,1,this.getName()),this.status=this.resources<=0?qR.LOOKING_FOR_NEW_ORE_VEIN:qR.MINING):this.status=qR.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=qR.MINING,this.progress+=this.getPower()*this.workers,this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=qR.TRANSPORTING)}}build(){return this.startProduction(),this}isStoppable(){return this.status!==qR.WAITING_FOR_SELECTION}setBuildingLevel(e){super.setBuildingLevel(e),this.maxResources=20*this.getBuildingLevel()}getBuildingData(){return[this.ore,this.resources,this.status]}setBuildingData(e){this.ore=e[0],this.resources=e[1],this.status=e[2],this.resources>0&&(this.status=qR.MINING)}}return e.maxWorkers=4,e})();var ZR=(()=>(function(e){e.GATHERING_FOOD="gathering food",e.GATHERING_RESOURCES="gathering resources",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting"}(ZR||(ZR={})),ZR))(),JR=(()=>(function(e){e[e.FOOD=0]="FOOD",e[e.RESOURCES=1]="RESOURCES"}(JR||(JR={})),JR))();let eO=(()=>{class e extends wR{constructor(t=null,i=-1,s=0,r=ZR.GATHERING_FOOD,n=0,o=JR.FOOD,a=[],c=1){super(i,Lf.GATHERERS_CAMP,t,nS.FOREST.GATHERERS_CAMP,n,e.maxWorkers,!0,!0,c),this.progress=s,this.status=r,this.mode=o,this.storage=a,this.lastFind=[],this.servicesService&&(this.weatherService=t.getWeatherService())}rollForFind(){const e=[],t=1+this.storage.length/20;return this.mode===JR.FOOD?(this.storage.find(e=>e[0]===Df.BERRY)||e.push({item:Df.BERRY,chance:this.settings.BERRY_CHANCE*t}),this.storage.find(e=>e[0]===Df.MUSHROOM)||e.push({item:Df.MUSHROOM,chance:this.settings.MUSHROOM_CHANCE*t}),this.storage.find(e=>e[0]===Df.WHEAT)||e.push({item:Df.WHEAT,chance:this.settings.WHEAT_CHANCE*t}),this.storage.find(e=>e[0]===Df.HERBS)||e.push({item:Df.HERBS,chance:this.settings.HERBS_CHANCE*t})):this.mode===JR.RESOURCES&&(this.storage.find(e=>e[0]===Df.BRUSHWOOD)||e.push({item:Df.BRUSHWOOD,chance:this.settings.BRUSHWOOD_CHANCE*t}),this.storage.find(e=>e[0]===Df.STONE)||e.push({item:Df.STONE,chance:this.settings.STONE_CHANCE*t}),this.storage.find(e=>e[0]===Df.LOG)||e.push({item:Df.LOG,chance:this.settings.LOG_CHANCE*t}),this.storage.find(e=>e[0]===Df.COPPER)||e.push({item:Df.COPPER,chance:this.settings.COPPER_CHANCE*t}),this.storage.find(e=>e[0]===Df.HERBS)||e.push({item:Df.HERBS,chance:this.settings.HERBS_CHANCE*t})),am.randomElement(e)}build(){return this.servicesService.getManagementService().getDefaultGathererFood()||(this.mode=JR.RESOURCES,this.status=ZR.GATHERING_RESOURCES),super.build()}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,workers:this.workers,storage:this.storage,mode:this.mode}}callback(e){e===JR.FOOD?(this.mode=JR.FOOD,this.progress=0,this.storage=[],this.lastFind=[],this.status=ZR.GATHERING_FOOD):e===JR.RESOURCES?(this.mode=JR.RESOURCES,this.progress=0,this.storage=[],this.lastFind=[],this.status=ZR.GATHERING_RESOURCES):"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}getLine(e){switch(e){case PS.FIRST:return this.mode===JR.FOOD?wS.buttonValue("gather resources",JR.RESOURCES):wS.buttonValue("gather food",JR.FOOD);case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire")}}tick(e){if(this.isWorking())if(this.status===ZR.TRANSPORTING||this.status===ZR.WAITING_FOR_WAREHOUSE_SPACE)this.storage.forEach(e=>{this.resourcesService.increaseResource(e[0],1,this.getName())&&(e[1]-=1)}),this.storage=this.storage.filter(e=>e[1]>0),this.storage.length>=this.canFindN()?this.status=ZR.WAITING_FOR_WAREHOUSE_SPACE:this.setStatus();else if(this.storage.length<this.canFindN()){if(this.progress<100)this.setStatus(),this.progress+=this.getPower(),this.progress>100&&(this.progress=100);else if(100===this.progress){this.progress=0,this.lastFind=[];for(let e=0;e<this.workers;e++){let e=this.rollForFind();null!==e&&this.resourcesService.increaseResource(e,1,this.getName())?this.lastFind.push(e):null===e||this.storage.find(t=>t[0]===e)?e=null:(this.storage.push([e,1]),this.status=ZR.TRANSPORTING),this.storage.length>0&&(this.status=ZR.TRANSPORTING),this.progress=0}}}else this.progress=0,this.status=ZR.WAITING_FOR_WAREHOUSE_SPACE}canFindN(){return this.mode===JR.FOOD?4:5}getDetails(){let e="last find:<br>";this.lastFind&&this.lastFind.length>0?this.lastFind.forEach(t=>{e+=Qf.prepareResourceName(t)+"<br>"}):e+="nothing<br>";let t="";return e.length>"last find:<br>".length&&(t=e),t+="local storage:<br>",this.storage.forEach(e=>{t+=Qf.prepareResourceName(e[0])+": "+e[1]+"<br>"}),super.getDetails()+t}setStatus(){this.status=this.mode===JR.FOOD?ZR.GATHERING_FOOD:ZR.GATHERING_RESOURCES}}return e.maxWorkers=5,e})();class tO extends LS{constructor(e=null,t=-1,i=Hf.NONE,s=50,r=1){super(t,Lf.BARN,e,nS.FIELD.BARN,!1,!0,!1,r),this.crop=i,this.storage=s,this.servicesService&&(this.modalService=e.getModalService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,crop:this.crop,storage:this.storage}}callback(e){if(this.crop===Hf.NONE)this.crop=Hf[String(e.target.value)],this.resourcesService.increaseResourceLimit(Df[Hf[this.crop]],6*this.storage);else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to switch barn storage type?<br>All excess resources will be lost");const t=this.modalService.registerForConfirmation().subscribe(i=>{i?(this.resourcesService.decreaseResourceLimit(Df[Hf[this.crop]],6*this.storage),this.crop=Hf[String(e.target.value)],this.resourcesService.increaseResourceLimit(Df[Hf[this.crop]],6*this.storage)):e.target.selectedIndex=this.crop-1,t.unsubscribe()})}}getComplexity(){return super.getComplexity()*(this.storage/this.settings.SIZE)}getSize(){return this.storage}getLine(e){switch(e){case PS.FIRST:return this.firstLine();case PS.SECOND:return wS.textValue("storage: "+6*this.storage);case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}firstLine(){const e=[];return e.push(Hf[Hf.NONE]),e.push(Hf[Hf.WHEAT]),e.push(Hf[Hf.HAY]),e.push(Hf[Hf.BERRY]),e.push(Hf[Hf.MUSHROOM]),this.resourcesService.getResource(Df.BARLEY).isVisible()&&e.push(Hf[Hf.BARLEY]),this.resourcesService.getResource(Df.HOP).isVisible()&&e.push(Hf[Hf.HOP]),this.resourcesService.getResource(Df.COTTON).isVisible()&&e.push(Hf[Hf.COTTON]),this.resourcesService.getResource(Df.HERBS).isVisible()&&e.push(Hf[Hf.HERBS]),wS.dropdownValue(e,Hf[this.crop])}prepareDemolish(){return this.crop!==Hf.NONE&&this.resourcesService.decreaseResourceLimit(Df[Hf[this.crop]],6*this.storage),!0}startProduction(){return!1}stopProduction(){}fireWorker(){return!1}hireWorker(){return!1}getWorkers(){return 0}getHappinessEffect(){return 0}isCombinable(){return!0}isSplittable(){return!0}combine(e,t){if(this.getBuildingType()===e.getBuildingType()){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will store <b>"+Qf.prepareCropName(this.crop)+"</b><br>All resources exceeding decreased limit of <b>"+Qf.prepareCropName(e.crop)+"</b> will be lost");const i=this.modalService.registerForConfirmation().subscribe(s=>{i.unsubscribe(),s?(this.storage+=e.getSize(),this.crop!==Hf.NONE&&this.resourcesService.increaseResourceLimit(Df[Hf[this.crop]],6*e.getSize()),t.finaliseCombine(!0)):t.finaliseCombine(!1)})}}split(e){this.modalService.open(Pf.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");const t=this.modalService.registerForValueResponse().subscribe(i=>{t.unsubscribe(),null!==i&&!isNaN(i)&&0!==i&&(i>=1&&i<this.getSize()?(this.storage-=Number(i),e.finaliseSplit(new tO(this.servicesService,this.servicesService.getIdService().getNextId(),this.crop,Number(i)).build())):this.modalService.info("Invalid size value!"))})}}var iO=(()=>(function(e){e.COOKING="cooking {craft}",e.WAITING_FOR_WAREHOUSE="waiting for {craft} space",e.NO_COOKING="nothing to cook"}(iO||(iO={})),iO))();class sO extends LS{constructor(e=null,t=-1,i=0,s=iO.NO_COOKING,r=!1,n=-1,o=null,a=1,c=0){super(t,Lf.KITCHEN,e,nS.VILLAGE.KITCHEN,r,!0,!0,a),this.progress=i,this.status=s,this.storage=c,this.recipe=null,this.icon=null,this.servicesService&&(o?this.recipe=o:n>=0&&(this.recipe=this.servicesService.getRecipeService().getRecipeById(n)),this.craftingService=e.getService(Zf.CRAFTING),this.gameService=e.getGameService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,recipeId:null!==this.recipe?this.recipe.id:-1,storage:this.storage}}build(){return this.startProduction(),this.craftingService.increaseCookingQueueSize(1),this}prepareDemolish(){return this.craftingService.decreaseCookingQueueSize(1),super.prepareDemolish()}callback(e){"cancel"===e&&(this.recipe=null,this.progress=0,this.status=iO.NO_COOKING)}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:return this.recipe?(this.icon||(this.prepareIcon(),this.status===iO.COOKING?this.icon[0].prefix="cooking ":this.status===iO.WAITING_FOR_WAREHOUSE&&(this.icon[0].prefix="waiting for ",this.icon[0].suffix=" space")),wS.iconValue(this.icon)):wS.textValue(this.status.replace("{craft}","warehouse"));case PS.THIRD:return this.recipe?wS.buttonValue("cancel cooking","cancel"):wS.emptyValue();case PS.FOURTH:return wS.progressValue(this.progress)}}tick(e){if(this.working)if(null===this.recipe&&(this.recipe=this.craftingService.getCookingOrder(),this.icon=null,this.progress=0),null===this.recipe)this.status=iO.NO_COOKING;else if(this.status===iO.WAITING_FOR_WAREHOUSE){const e=this.resourcesService.getLimit(this.recipe.resource);this.storage>e?(this.storage-=e,this.resourcesService.increaseResource(this.recipe.resource,e,this.getName())):(this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName()),this.status=iO.COOKING,this.progress=0,this.recipe=null)}else if(this.status=iO.COOKING,this.progress<100&&(this.progress+=this.getPower()/this.recipe.craftingDifficulty*nS.VILLAGE.KITCHEN.CRAFTING_POWER),this.progress>=100){this.progress=100,this.storage=this.recipe.amount;const e=this.resourcesService.getLimit(this.recipe.resource);this.storage>e?(this.storage-=e,this.resourcesService.increaseResource(this.recipe.resource,e,this.getName()),this.status=iO.WAITING_FOR_WAREHOUSE,this.icon=null):this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName())?(this.progress=0,this.storage=0,this.recipe=null):(this.status=iO.WAITING_FOR_WAREHOUSE,this.icon=null)}}getRecipe(){return this.recipe}cancelCooking(){this.recipe=null}prepareIcon(){this.recipe&&(this.icon=[{name:Qf.prepareResourceName(this.recipe.resource),path:"resources",prefix:"",suffix:""}])}}var rO=(()=>(function(e){e.DIGGING_CLAY="digging clay",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more resources",e.TRANSPORTING="transporting"}(rO||(rO={})),rO))();class nO extends LS{constructor(e=null,t=-1,i=0,s=rO.DIGGING_CLAY,r=!1,n=0,o=400,a=1){super(t,Lf.CLAY_PIT,e,nS.FIELD.CLAY_PIT,r,!0,!0,a),this.progress=i,this.status=s,this.storage=n,this.resources=o}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,resources:this.resources}}getLine(e){switch(e){case PS.FIRST:return wS.textValue("clay: "+this.resources);case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}isStoppable(){return this.resources>0}isUsedUp(){return this.status===rO.NO_MORE_RESOURCES}hasBuff(){return!this.isUsedUp()&&super.hasBuff()}tick(e){this.resources<=0&&(this.status!==rO.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Clay pit has no more clay"),this.status=rO.NO_MORE_RESOURCES,this.stopProduction()),this.working&&(this.storage>0?this.resourcesService.increaseResource(Df.CLAY,this.storage,this.getName())?(this.storage=0,this.status=rO.DIGGING_CLAY):this.status=rO.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=rO.DIGGING_CLAY,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=rO.TRANSPORTING))}}class oO extends pv{constructor(e=null,t=-1,i=0,s=0,r=100,n=100,o=0,a=1,c=!0){super(e,t,Lf.TUDOR_HOUSE,nS.VILLAGE.TUDOR_HOUSE,i,s,r,n,o,a,c)}}var aO=(()=>(function(e){e.CHOPPING_TREES="chopping {amount} tree{plural}",e.WAITING_FOR_TREES="waiting for trees",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING_LOG="transporting log"}(aO||(aO={})),aO))();let cO=(()=>{class e extends wR{constructor(t=null,i=-1,s=0,r=0,n=aO.WAITING_FOR_TREES,o=0,a=1){super(i,Lf.LOGGERS_CAMP,t,nS.FOREST.LOGGERS_CAMP,o,e.maxWorkers,!0,!0,a),this.progress=s,this.reservedTrees=r,this.status=n,this.servicesService&&(this.landService=t.getLandService())}getLine(e){switch(e){case PS.FIRST:return wS.emptyValue();case PS.SECOND:let e=this.status.replace("{amount}",""+this.reservedTrees);return e=e.replace("{plural}",1===this.reservedTrees?"":"s"),wS.textValue(e);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire")}}callback(e){"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}tick(){if(this.isWorking())if(this.status===aO.WAITING_FOR_TREES){const e=Math.min(this.workers,this.landService.getForest(),this.landService.getForest());this.landService.reduceForest(e)&&(this.reservedTrees=e,this.status=aO.CHOPPING_TREES)}else if(this.status===aO.CHOPPING_TREES)this.progress<100?(this.progress+=this.getPower()*(this.getWorkers()/this.reservedTrees),this.progress>=100&&(this.progress=100)):(this.progress=0,this.status=aO.TRANSPORTING_LOG);else if(this.status===aO.TRANSPORTING_LOG||this.status===aO.WAITING_FOR_WAREHOUSE_SPACE)if(this.resourcesService.increaseResource(Df.LOG,this.reservedTrees,this.getName())){this.landService.increaseLand(this.reservedTrees,!0);const e=Math.min(this.workers,this.landService.getForest(),this.landService.getForest());this.landService.reduceForest(e)?(this.reservedTrees=e,this.status=aO.CHOPPING_TREES):this.status=aO.WAITING_FOR_TREES}else{const e=this.resourcesService.getLimit(Df.LOG),t=Math.min(e,this.reservedTrees);this.reservedTrees-=t,this.landService.increaseLand(t,!0),this.resourcesService.increaseResource(Df.LOG,t,this.getName()),this.status=aO.WAITING_FOR_WAREHOUSE_SPACE}}prepareDemolish(){return this.landService.increaseForest(this.reservedTrees,!1),this.stopProduction(),!0}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,workers:this.workers,reservedTrees:this.reservedTrees}}getDetails(){return this.status===aO.WAITING_FOR_WAREHOUSE_SPACE?super.getDetails()+"local storage:<br>&nbsp;&nbsp;logs: "+this.reservedTrees:super.getDetails()}}return e.maxWorkers=5,e})();var lO=(()=>(function(e){e.MINING="mining {res}",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more {res}",e.TRANSPORTING="transporting {res}"}(lO||(lO={})),lO))();let uO=(()=>{class e extends wR{constructor(t=null,i=-1,s=20,r=Df.NOTHING,n=0,o=lO.MINING,a=0,c=0,l=1){super(i,Lf.METEORITE,t,nS.MOUNTAINS.METEORITE,c,e.maxWorkers,!0,!0,l),this.resources=s,this.ore=r,this.progress=n,this.status=o,this.storage=a}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,storage:this.storage,workers:this.workers,resources:this.resources,ore:this.ore}}isUsedUp(){return this.status===lO.NO_MORE_RESOURCES}callback(e){"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}getLine(e){switch(e){case PS.FIRST:return wS.textValue(Qf.prepareResourceName(this.ore).toLowerCase()+": "+this.resources);case PS.SECOND:return wS.textValue(this.status.replace("{res}",Qf.prepareResourceName(this.ore).toLowerCase()));case PS.THIRD:return this.resources>0?wS.progressValue(this.progress):wS.emptyValue();case PS.FOURTH:return this.resources>0?wS.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire"):wS.emptyValue()}}tick(e){this.resources<=0&&0===this.storage&&(this.status!==lO.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Meteorite fully mined "+Qf.prepareResourceName(this.ore)),this.status=lO.NO_MORE_RESOURCES,this.stopProduction()),this.isWorking()&&(this.storage>0?this.resourcesService.increaseResource(this.ore,this.storage,this.getName())?(this.storage=0,this.status=lO.MINING):this.status=lO.WAITING_FOR_WAREHOUSE_SPACE:this.resources>0&&this.progress<100?(this.status=lO.MINING,this.progress+=this.getPower()*this.workers,this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=lO.TRANSPORTING))}build(){return this}isStoppable(){return this.resources>0}}return e.maxWorkers=4,e})();class hO extends LS{constructor(e=null,t=-1,i=1){super(t,Lf.PIER,e,nS.SEA.PIER,!1,!0,!1,i)}getLine(e){switch(e){case PS.FIRST:return wS.textValue("size: "+this.getSize());case PS.SECOND:return wS.textValue("space for ships: "+this.settings.HARBOUR_SIZE);case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}toJSON(){return{buildingType:this.buildingType,id:this.id,level:this.level}}build(){return this.servicesService.getNavyService().increaseHarbourSize(this.settings.HARBOUR_SIZE),this}prepareDemolish(){return this.servicesService.getNavyService().decreaseHarbourSize(this.settings.HARBOUR_SIZE),super.prepareDemolish()}}class dO extends LS{constructor(e=null,t=-1,i=1){super(t,Lf.HARBOUR,e,nS.SEA.HARBOUR,!1,!0,!1,i)}getLine(e){switch(e){case PS.FIRST:return wS.textValue("size: "+this.getSize());case PS.SECOND:return wS.textValue("space for ships: "+this.settings.HARBOUR_SIZE);case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}toJSON(){return{buildingType:this.buildingType,id:this.id,level:this.level}}build(){return this.servicesService.getNavyService().increaseHarbourSize(this.settings.HARBOUR_SIZE),this}prepareDemolish(){return this.servicesService.getNavyService().decreaseHarbourSize(this.settings.HARBOUR_SIZE),super.prepareDemolish()}}var gO=(()=>(function(e){e.LIGHT_BURNING="light burning",e.WAITING_FOR_FUEL="waiting for fuel"}(gO||(gO={})),gO))();class pO extends LS{constructor(e=null,t=-1,i=gO.LIGHT_BURNING,s=0,r=!1,n=1){super(t,Lf.LIGHTHOUSE,e,nS.SEA.LIGHTHOUSE,r,!0,!0,n),this.status=i,this.fuel=s,e&&(this.worldService=e.getWorldService())}getLine(e){switch(e){case PS.FIRST:return wS.textValue("size: "+this.getSize());case PS.SECOND:return wS.textValue(this.status);case PS.THIRD:return wS.textValue("fuel: "+Qf.round(this.fuel,2));case PS.FOURTH:return wS.emptyValue()}}tick(e){!this.working||(this.fuel<5?this.resourcesService.decreaseResource(Df.FUEL,1,this.getName())&&(this.fuel+=1):this.fuel<=0&&(this.status=gO.WAITING_FOR_FUEL),this.worldService.getPlayerSeaMissions().length>0&&this.fuel>=.005&&(this.fuel-=.005))}isBurning(){return this.status===gO.LIGHT_BURNING&&this.isWorking()}toJSON(){return{buildingType:this.buildingType,id:this.id,status:this.status,working:this.working,fuel:this.fuel,level:this.level}}}var fO=(()=>(function(e){e.BUILDING_SHIP="building {ship}",e.WAITING_FOR_ORDER="waiting for order"}(fO||(fO={})),fO))();class mO extends LS{constructor(e=null,t=-1,i=0,s=fO.WAITING_FOR_ORDER,r=!1,n=null,o=1){super(t,Lf.BOAT_BUILDER,e,nS.SEA.BOAT_BUILDER,r,!0,!0,o),this.progress=i,this.status=s,this.ship=n,e&&(this.resourcesService=e.getResourcesService(),this.modalService=e.getModalService(),this.navyService=e.getNavyService())}toJSON(){return{buildingType:this.buildingType,id:this.id,progress:this.progress,status:this.status,working:this.working,ship:this.ship,level:this.level}}build(){return this.startProduction(),this.gameService.isEnabled(Mf.NAVY)||(this.gameService.enable(Mf.NAVY),this.logService.log("Navy tab unlocked")),this}callback(e){if("select"===e){this.modalService.open(Pf.SHIPYARD),this.modalService.setShipyardLimitBoat(!0);const e=this.modalService.registerForValueResponse().subscribe(t=>{e.unsubscribe(),null!==t&&(this.ship=t,this.status=fO.BUILDING_SHIP)})}else if("cancel"===e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel building "+Qf.prepareTroopName(this.ship)+"?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&(this.ship=null,this.progress=0,this.status=fO.WAITING_FOR_ORDER)})}}getLine(e){switch(e){case PS.FIRST:return wS.textValue(this.ship?this.status.replace("{ship}",Qf.prepareTroopName(this.ship)):this.status);case PS.SECOND:return this.ship?wS.progressValue(this.progress):wS.emptyValue();case PS.THIRD:return null===this.ship?wS.buttonValue("select ship","select"):wS.buttonValue("cancel "+Qf.prepareTroopName(this.ship),"cancel");case PS.FOURTH:return wS.emptyValue()}}tick(e){(null==this.ship||this.ship!==Wf.BOAT)&&(this.ship=null,this.status=fO.WAITING_FOR_ORDER),this.working&&this.status===fO.BUILDING_SHIP&&(this.progress<100?(this.progress+=this.getPower()/aS.getTroop(this.ship).SIZE,this.progress>100&&(this.progress=100)):(this.progress=0,this.navyService.addShip(this.ship),this.ship=null,this.status=fO.WAITING_FOR_ORDER))}getShipSize(){return(null==this.ship||this.ship!==Wf.BOAT&&this.ship!==Wf.BRIGANTINE&&this.ship!==Wf.GALLEON)&&(this.ship=null,this.status=fO.WAITING_FOR_ORDER),this.ship?aS.getTroop(this.ship).SIZE:0}}var SO=(()=>(function(e){e.BUILDING_SHIP="building {ship}",e.WAITING_FOR_ORDER="waiting for order"}(SO||(SO={})),SO))();let EO=(()=>{class e extends wR{constructor(t=null,i=-1,s=0,r=SO.WAITING_FOR_ORDER,n=0,o=null,a=1){super(i,Lf.SHIPYARD,t,nS.SEA.SHIPYARD,n,e.maxWorkers,!0,!0,a),this.progress=s,this.status=r,this.ship=o,t&&(this.resourcesService=t.getResourcesService(),this.modalService=t.getModalService(),this.navyService=t.getNavyService())}toJSON(){return{buildingType:this.buildingType,id:this.id,progress:this.progress,status:this.status,workers:this.workers,ship:this.ship,level:this.level}}build(){return this.startProduction(),this.gameService.isEnabled(Mf.NAVY)||(this.gameService.enable(Mf.NAVY),this.logService.log("Navy tab unlocked")),this}callback(e){if("select"===e){this.modalService.open(Pf.SHIPYARD),this.modalService.setShipyardLimitBoat(!1);const e=this.modalService.registerForValueResponse().subscribe(t=>{e.unsubscribe(),null!==t&&(this.ship=t,this.status=SO.BUILDING_SHIP)})}else if("cancel"===e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel building "+Qf.prepareTroopName(this.ship)+"?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&(this.ship=null,this.progress=0,this.status=SO.WAITING_FOR_ORDER)})}else"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}getLine(e){switch(e){case PS.FIRST:return wS.textValue(this.ship?this.status.replace("{ship}",Qf.prepareTroopName(this.ship)):this.status);case PS.SECOND:return this.ship?wS.progressValue(this.progress):wS.emptyValue();case PS.THIRD:return null===this.ship?wS.buttonValue("select ship","select"):wS.buttonValue("cancel "+Qf.prepareTroopName(this.ship),"cancel");case PS.FOURTH:return wS.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire")}}tick(e){(null==this.ship||this.ship!==Wf.BOAT&&this.ship!==Wf.BRIGANTINE&&this.ship!==Wf.GALLEON)&&(this.ship=null,this.status=SO.WAITING_FOR_ORDER),this.isWorking()&&this.status===SO.BUILDING_SHIP&&(this.progress<100?(this.progress+=this.getPower()/aS.getTroop(this.ship).SIZE*this.workers,this.progress>100&&(this.progress=100)):(this.progress=0,this.navyService.addShip(this.ship),this.ship=null,this.status=SO.WAITING_FOR_ORDER))}getShipSize(){return(null==this.ship||this.ship!==Wf.BOAT&&this.ship!==Wf.BRIGANTINE&&this.ship!==Wf.GALLEON)&&(this.ship=null,this.status=SO.WAITING_FOR_ORDER),this.ship?aS.getTroop(this.ship).SIZE:0}}return e.maxWorkers=10,e})();var vO=(()=>(function(e){e.DRAWING_MAP="drawing map",e.WAITING_FOR_CARTOGRAPHY_DATA="waiting for cartography data",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space"}(vO||(vO={})),vO))();class RO extends LS{constructor(e=null,t=-1,i=0,s=vO.WAITING_FOR_CARTOGRAPHY_DATA,r=!1,n=1){super(t,Lf.CARTOGRAPHER,e,nS.SEA.CARTOGRAPHER,r,!0,!0,n),this.progress=i,this.status=s,this.servicesService&&(this.resourcesService=e.getResourcesService(),this.navyService=e.getNavyService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,working:this.working,status:this.status}}build(){return this.servicesService.getResourcesService().makeVisible(Df.MAP),super.build()}getLine(e){switch(e){case PS.FIRST:return wS.textValue(this.status);case PS.SECOND:return wS.progressValue(this.progress);case PS.THIRD:return wS.progressValue(this.navyService.getMapProgress(),"map progress");case PS.FOURTH:return wS.emptyValue()}}tick(e){!this.working||(this.status===vO.WAITING_FOR_CARTOGRAPHY_DATA?this.navyService.decreaseCartographyData(1)&&(this.status=vO.DRAWING_MAP):this.status===vO.DRAWING_MAP?this.progress<100?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):this.navyService.getMapProgress()<100?(this.navyService.addMapProgress(),this.progress=0,this.status=vO.WAITING_FOR_CARTOGRAPHY_DATA):this.status=vO.WAITING_FOR_WAREHOUSE_SPACE:this.status===vO.WAITING_FOR_WAREHOUSE_SPACE&&(this.navyService.getMapProgress()>=100?this.navyService.createMap()&&(this.status=vO.WAITING_FOR_CARTOGRAPHY_DATA):this.status=vO.WAITING_FOR_CARTOGRAPHY_DATA))}}class OO extends pv{constructor(e=null,t=-1,i=0,s=0,r=100,n=100,o=0,a=1,c=!0){super(e,t,Lf.SETTLEMENT,nS.VILLAGE.SETTLEMENT,i,s,r,n,o,a,c)}}var TO=(()=>(function(e){e.RESEARCHING="researching",e.NO_RESEARCH="nothing to research"}(TO||(TO={})),TO))();class IO extends LS{constructor(e=null,t=-1,i=0,s=TO.NO_RESEARCH,r=!1,n=1){super(t,Lf.SCHOLARS_LAB,e,nS.VILLAGE.SCHOLARS_LAB,r,!0,!0,n),this.progress=i,this.status=s,this.servicesService&&(this.techService=e.getTechService(),this.gameService=e.getGameService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working}}build(){return this.startProduction(),this}getLine(e){switch(e){case PS.FIRST:let e="";return this.techService.getCurrentResearch()&&(e=Qf.prepareTechName(this.techService.getCurrentResearch().getTech())),wS.textValue(e);case PS.SECOND:return wS.progressValue(this.progress);case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}tick(e){!this.working||(this.techService.isResearchStarted()?(this.status!==TO.RESEARCHING&&(this.progress=0),this.status=TO.RESEARCHING,this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.techService.progressTech(nS.VILLAGE.SCHOLARS_LAB.RESEARCH_POWER))):(this.status=TO.NO_RESEARCH,this.progress=0))}}var bO=(()=>(function(e){e.COLLECTING_TAX="collecting tax",e.GIVING_DONATIONS="giving donations",e.WAITING_FOR_COINS="waiting for coins"}(bO||(bO={})),bO))();class CO extends LS{constructor(e=null,t=-1,i=!1,s=bO.COLLECTING_TAX,r=0,n=1){super(t,Lf.TAX_COLLECTOR,e,nS.VILLAGE.TAX_COLLECTOR,i,!0,!0,n),this.status=s,this.progress=r,this.servicesService&&(this.happinessService=e.getHappinessService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,status:this.status,working:this.working,progress:this.progress}}callback(e){"tax"===e?(this.progress=0,this.status=bO.COLLECTING_TAX):"donate"===e&&(this.progress=0,this.status=bO.GIVING_DONATIONS)}getLine(e){switch(e){case PS.FIRST:return this.status===bO.COLLECTING_TAX?wS.buttonValue("give donations","donate"):wS.buttonValue("collect tax","tax");case PS.SECOND:return 0===Number(this.servicesService.getManagementService().getTaxRate())?wS.textValue("0% tax/donation"):wS.textValue(this.status);case PS.THIRD:return wS.progressValue(this.progress);case PS.FOURTH:return wS.emptyValue()}}tick(e){if(!this.working)return;const t=this.servicesService.getManagementService();if(0!==Number(t.getTaxRate()))if(this.status===bO.WAITING_FOR_COINS&&this.resourcesService.decreaseResource(Df.COINS,this.calculateTax(),this.getName())&&(this.status=bO.GIVING_DONATIONS),this.progress<100)this.progress+=100/300,this.progress>100&&(this.progress=100);else{this.progress=0;const e=this.calculateTax(),t=Number(this.servicesService.getManagementService().getTaxRate());e>0&&(this.status===bO.COLLECTING_TAX?(this.resourcesService.increaseResource(Df.COINS,e,this.getName()),this.updateHappinessEffect(-2*t,$f.TAX)):(this.updateHappinessEffect(t,$f.DONATION),this.resourcesService.decreaseResource(Df.COINS,e,this.getName()),this.resourcesService.decreaseResource(Df.COINS,e,this.getName())||(this.status=bO.WAITING_FOR_COINS)))}else this.progress=0}calculateTax(){let e=0;return this.servicesService.getVillageService().getHousingBuildings().map(e=>e).forEach(t=>e+=nS.getBuilding(t.getBuildingType()).TAX*t.getOccupants()),e*=Number(this.servicesService.getManagementService().getTaxRate()),e}updateHappinessEffect(e,t){const i=this.servicesService.getHappinessService(),s=i.getHappinessEffectByEffect(t);s?s.value=e:i.addHappinessEffect(0,t,e,29)}getHappinessEffect(){return 0}getEffects(){return 0}getPermanentEffects(){return 0}}var yO=(()=>(function(e){e.WORKING_AT_CONSTRUCTION="working at {}",e.WAITING_FOR_BUILDINGS="waiting for building sites",e.NO_SUPERVISOR="no supervisor"}(yO||(yO={})),yO))();class AO extends LS{constructor(e=null,t=-1,i=!0,s=yO.WAITING_FOR_BUILDINGS,r=1){super(t,Lf.BUILDERS_GUILD,e,nS.VILLAGE.BUILDERS_GUILD,!0,!0,!0,r),this.status=s,this.currentWorkplaceName="",this.servicesService&&(this.happinessService=e.getHappinessService(),this.regionsService=e.getRegionsService())}toJSON(){return{id:this.id,level:this.level,buildingType:this.buildingType,status:this.status,working:this.working}}getLine(e){switch(e){case PS.FIRST:return this.working?wS.textValue("available workers: "+this.resourcesService.getPeople()):wS.emptyValue();case PS.SECOND:return wS.textValue(this.status.replace("{}",this.currentWorkplaceName));case PS.THIRD:case PS.FOURTH:return wS.emptyValue()}}tick(e){if(!this.working)return;const t=this.resourcesService.getPeople();if(t>0){let e=this.regionsService.getAllBuildingSites();if(e=e.sort((e,t)=>e.isWorking()&&t.isWorking()?e.getProgress()-t.getProgress():e.isWorking()&&!t.isWorking()?1:-1),0===e.length)this.status=yO.WAITING_FOR_BUILDINGS;else{this.status=yO.WORKING_AT_CONSTRUCTION;const i=e[0];this.currentWorkplaceName=Qf.prepareBuildingName(i.getWorkingAt()),i.increaseProgress(t*this.getPower())}}}stopProduction(){this.status=yO.NO_SUPERVISOR,super.stopProduction()}}let NO=(()=>{class e{constructor(e){this.servicesService=e,this.nextId=1,e.addService(Zf.ID,this)}getNextId(){const e=this.nextId;return this.nextId+=1,e}getName(){return"IdService"}load(e){this.nextId=void 0===e.nextId||isNaN(e.nextId)?1:e.nextId}reset(e,t){e&&(this.nextId=1)}save(){return{nextId:this.nextId}}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),_O=(()=>{class e{constructor(e,t){this.servicesService=e,this.idService=t,e.addService(Zf.BUILDING_FACTORY,this)}loadBuilding(e){return null==e.id&&(e.id=this.idService.getNextId()),void 0!==e.progress&&null===e.progress&&(e.progress=0),e.buildingType===Lf.HUT?new fv(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Lf.HOUSE?new mv(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Lf.LONGHOUSE?new jR(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Lf.TUDOR_HOUSE?new oO(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Lf.SETTLEMENT?new OO(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Lf.BAKERY?new oR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.TAILOR?new fR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.WORKSHOP?new jv(this.servicesService,e.id,e.progress,e.status,e.mode,e.working,void 0!==e.recipeId?e.recipeId:-1,e.recipe,e.level,void 0!==e.storage?e.storage:0):e.buildingType===Lf.SCHOLARS_LAB?new IO(this.servicesService,e.id,e.progress,e.status,e.working,e.level):e.buildingType===Lf.KITCHEN?new sO(this.servicesService,e.id,e.progress,e.status,e.working,e.recipeId,e.recipe,e.level,e.storage):e.buildingType===Lf.MANUFACTURE?new KR(this.servicesService,e.id,e.progress,e.status,e.working,e.recipe,e.level,e.storage):e.buildingType===Lf.WAREHOUSE?new $v(this.servicesService,e.id,e.resource,void 0!==e.storage?e.storage:50,e.level):e.buildingType===Lf.MARKETPLACE?new DR(this.servicesService,e.id,e.progress,e.level):e.buildingType===Lf.TAX_COLLECTOR?new CO(this.servicesService,e.id,e.working,e.status,e.progress,e.level):e.buildingType===Lf.BUILDERS_GUILD?new AO(this.servicesService,e.id,e.working,e.status,e.level):e.buildingType===Lf.TAVERN?new RR(this.servicesService,e.id,e.progress,e.beer,e.wine,e.working,e.level):e.buildingType===Lf.SHRINE?new Zv(this.servicesService,e.id,e.progress,e.level):e.buildingType===Lf.CHURCH?new kR(this.servicesService,e.id,e.working,e.progress,e.level):e.buildingType===Lf.BARRACKS?new lR(this.servicesService,e.id,e.barracksSize,e.level):e.buildingType===Lf.EMBASSY?new $R(this.servicesService,e.id,e.progress,e.working,e.country,e.paper,e.level):e.buildingType===Lf.TRAINING_SQUARE?new hR(this.servicesService,e.id,e.progress,e.working,e.status,e.level,void 0!==e.workSettings?e.workSettings:null):e.buildingType===Lf.STOCKADE?new gR(this.servicesService,e.id,e.health,e.durability,e.progress,e.working,e.level):e.buildingType===Lf.WOODEN_TOWER?new SR(this.servicesService,e.id,e.health,e.durability,e.progress,e.working,e.level):e.buildingType===Lf.STONE_TOWER?new ER(this.servicesService,e.id,e.health,e.durability,e.progress,e.working,e.level):e.buildingType===Lf.STASH?new zR(this.servicesService,e.id,e.level):e.buildingType===Lf.LOGGERS_HUT?new Lv(this.servicesService,e.id,e.progress,void 0!==e.reservedTrees?e.reservedTrees:0,e.status,e.working,e.level):e.buildingType===Lf.LOGGERS_CAMP?new cO(this.servicesService,e.id,e.progress,e.reservedTrees,e.status,e.workers,e.level):e.buildingType===Lf.GATHERER?new Wv(this.servicesService,e.id,e.progress,e.status,e.working,e.mode,e.storage,e.level):e.buildingType===Lf.GATHERERS_CAMP?new eO(this.servicesService,e.id,e.progress,e.status,e.workers,e.mode,e.storage,e.level):e.buildingType===Lf.HUNTER_LODGE?new Xv(this.servicesService,e.id,e.progress,e.status,e.mode,e.working,e.storage,e.storage2,e.animal,e.level):e.buildingType===Lf.TANNERY?new dR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.PAPER_MILL?new QR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.FORESTER?new xv(this.servicesService,e.id,e.progress,e.localStorage,e.status,e.effectiveness,e.working,e.level):e.buildingType===Lf.SAWMILL?new Hv(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.FARM?new eR(this.servicesService,e.id,e.workers,e.maxWorkers,e.level,e.status,void 0!==e.workSettings?e.workSettings:null):e.buildingType===Lf.WINDMILL?new nR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.BUTCHER?new NR(this.servicesService,e.id,e.status,e.progress,e.working,e.outputStorage,null!==e.outputFurStorage?e.outputFurStorage:0,e.animals,void 0===e.discardExcessFur||e.discardExcessFur,e.level):e.buildingType===Lf.COTTON_MILL?new pR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.BREWERY?new mR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.CLAY_PIT?new nO(this.servicesService,e.id,e.progress,e.status,e.working,e.storage,e.resources,e.level):e.buildingType===Lf.WINERY?new vR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.BARN?new tO(this.servicesService,e.id,e.crop,e.storage,e.level):e.buildingType===Lf.FIELD?new iR(this.servicesService,e.id,e.size,e.crop,e.status,e.progress,e.working,e.growth,e.level):e.buildingType===Lf.ORCHARD?new rR(this.servicesService,e.id,e.size,e.crop,e.status,e.progress,e.working,e.growth,e.level):e.buildingType===Lf.PASTURE?new yR(this.servicesService,e.id,e.size,e.animal,e.progress,e.produceProgress,e.working,e.animals,e.food,e.chores,e.autoButcher,e.level):e.buildingType===Lf.QUARRY?new zv(this.servicesService,e.id,e.progress,e.status,e.working,e.storage,e.resources,e.level):e.buildingType===Lf.GEOLOGIST?new OR(this.servicesService,e.id,e.progress,e.working,e.level):e.buildingType===Lf.STONEMASON?new TR(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.MINT?new _R(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Lf.SMITHY?new xR(this.servicesService,e.id,e.level):e.buildingType===Lf.PIT_MINE?new bR(this.servicesService,e.id,e.progress,e.status,e.working,e.storage,e.resources,e.ore,e.level):e.buildingType===Lf.METEORITE?new uO(this.servicesService,e.id,e.resources,e.ore,e.progress,e.status,e.storage,e.workers,e.level):e.buildingType===Lf.DEEP_MINE?new XR(this.servicesService,e.id,e.progress,e.status,e.storage,e.workers,e.resources,void 0!==e.oreToFind?e.oreToFind:0,e.ore,e.level):e.buildingType===Lf.STONEHENGE?new LR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.PYRAMID?new FR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.HANGING_GARDEN?new UR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.COLOSSUS?new HR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.UNDERGROUND_CITY?new BR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.GREAT_LIGHTHOUSE?new WR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.BOAT_BUILDER?new mO(this.servicesService,e.id,e.progress,e.status,e.working,e.ship,e.level):e.buildingType===Lf.SHIPYARD?new EO(this.servicesService,e.id,e.progress,e.status,e.workers,e.ship,e.level):e.buildingType===Lf.CARTOGRAPHER?new RO(this.servicesService,e.id,e.progress,e.status,e.working,e.level):e.buildingType===Lf.SACRED_GROVE?new VR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.ASCENSION_TEMPLE?new GR(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Lf.FISHERS_HUT?new cR(this.servicesService,e.id,e.progress,e.status,e.working,e.level):e.buildingType===Lf.PIER?new hO(this.servicesService,e.id,e.level):e.buildingType===Lf.HARBOUR?new dO(this.servicesService,e.id,e.level):e.buildingType===Lf.LIGHTHOUSE?new pO(this.servicesService,e.id,e.status,e.fuel,e.working,e.level):e.buildingType===Lf.CONSTRUCTION?new hv(this.servicesService,e.id,e.region,e.constructing,e.buildingComplexity,e.buildingSize,e.upgradeLevel,e.progress,e.working,void 0!==e.data?e.data:null):e.buildingType===Lf.DECONSTRUCTION?new xS(this.servicesService,e.id,e.region,e.deconstructing,e.buildingComplexity,e.buildingSize,e.progress,e.working):void console.error("Couldn't load building of type ["+e.buildingType+"]")}createBuilding(e,t=this.idService.getNextId()){return this.createBuildingShell(e,t).build()}createBuildingShell(e,t=this.idService.getNextId()){switch(e){case Lf.HUT:return new fv(this.servicesService,t);case Lf.HOUSE:return new mv(this.servicesService,t);case Lf.LONGHOUSE:return new jR(this.servicesService,t);case Lf.TUDOR_HOUSE:return new oO(this.servicesService,t);case Lf.SETTLEMENT:return new OO(this.servicesService,t);case Lf.BAKERY:return new oR(this.servicesService,t);case Lf.TAILOR:return new fR(this.servicesService,t);case Lf.WORKSHOP:return new jv(this.servicesService,t);case Lf.SCHOLARS_LAB:return new IO(this.servicesService,t);case Lf.KITCHEN:return new sO(this.servicesService,t);case Lf.MANUFACTURE:return new KR(this.servicesService,t);case Lf.WAREHOUSE:return new $v(this.servicesService,t);case Lf.MARKETPLACE:return new DR(this.servicesService,t);case Lf.TAX_COLLECTOR:return new CO(this.servicesService,t);case Lf.BUILDERS_GUILD:return new AO(this.servicesService,t);case Lf.TAVERN:return new RR(this.servicesService,t);case Lf.SHRINE:return new Zv(this.servicesService,t);case Lf.CHURCH:return new kR(this.servicesService,t);case Lf.BARRACKS:return new lR(this.servicesService,t);case Lf.EMBASSY:return new $R(this.servicesService,t);case Lf.TRAINING_SQUARE:return new hR(this.servicesService,t);case Lf.STOCKADE:return new gR(this.servicesService,t);case Lf.WOODEN_TOWER:return new SR(this.servicesService,t);case Lf.STONE_TOWER:return new ER(this.servicesService,t);case Lf.STASH:return new zR(this.servicesService,t);case Lf.LOGGERS_HUT:return new Lv(this.servicesService,t);case Lf.LOGGERS_CAMP:return new cO(this.servicesService,t);case Lf.GATHERER:return new Wv(this.servicesService,t);case Lf.GATHERERS_CAMP:return new eO(this.servicesService,t);case Lf.HUNTER_LODGE:return new Xv(this.servicesService,t);case Lf.TANNERY:return new dR(this.servicesService,t);case Lf.PAPER_MILL:return new QR(this.servicesService,t);case Lf.FORESTER:return new xv(this.servicesService,t);case Lf.SAWMILL:return new Hv(this.servicesService,t);case Lf.FARM:return new eR(this.servicesService,t);case Lf.WINDMILL:return new nR(this.servicesService,t);case Lf.BUTCHER:return new NR(this.servicesService,t);case Lf.COTTON_MILL:return new pR(this.servicesService,t);case Lf.BREWERY:return new mR(this.servicesService,t);case Lf.WINERY:return new vR(this.servicesService,t);case Lf.CLAY_PIT:return new nO(this.servicesService,t);case Lf.BARN:return new tO(this.servicesService,t);case Lf.FIELD:return new iR(this.servicesService,t);case Lf.ORCHARD:return new rR(this.servicesService,t);case Lf.PASTURE:return new yR(this.servicesService,t);case Lf.QUARRY:return new zv(this.servicesService,t);case Lf.GEOLOGIST:return new OR(this.servicesService,t);case Lf.STONEMASON:return new TR(this.servicesService,t);case Lf.MINT:return new _R(this.servicesService,t);case Lf.SMITHY:return new xR(this.servicesService,t);case Lf.PIT_MINE:return new bR(this.servicesService,t);case Lf.METEORITE:return new uO(this.servicesService,t);case Lf.DEEP_MINE:return new XR(this.servicesService,t);case Lf.STONEHENGE:return new LR(this.servicesService,t);case Lf.PYRAMID:return new FR(this.servicesService,t);case Lf.HANGING_GARDEN:return new UR(this.servicesService,t);case Lf.COLOSSUS:return new HR(this.servicesService,t);case Lf.UNDERGROUND_CITY:return new BR(this.servicesService,t);case Lf.GREAT_LIGHTHOUSE:return new WR(this.servicesService,t);case Lf.SACRED_GROVE:return new VR(this.servicesService,t);case Lf.ASCENSION_TEMPLE:return new GR(this.servicesService,t);case Lf.FISHERS_HUT:return new cR(this.servicesService,t);case Lf.PIER:return new hO(this.servicesService,t);case Lf.HARBOUR:return new dO(this.servicesService,t);case Lf.LIGHTHOUSE:return new pO(this.servicesService,t);case Lf.BOAT_BUILDER:return new mO(this.servicesService,t);case Lf.SHIPYARD:return new EO(this.servicesService,t);case Lf.CARTOGRAPHER:return new RO(this.servicesService,t);case Lf.CONSTRUCTION:console.error("Building factory cannot create construction sites!");break;case Lf.DECONSTRUCTION:console.error("Building factory cannot create deconstruction sites!");break;default:console.error("Couldn't construct building of type ["+Lf[e]+"]!")}}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(NO))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),wO=(()=>{class e extends dv{constructor(e,t,i,s,r){super(t,e,i,r,s,Kf.VILLAGE,Zf.VILLAGE)}init(){this.buildings.push(new fv(this.servicesService,this.idService.getNextId(),2,0,100,100,100).build()),this.buildings.push(new fv(this.servicesService,this.idService.getNextId(),1,0,100,100,100).build()),this.resourcesService.createPeople(3),this.buildings.forEach(e=>this.landService.takeLand(e.getSize()))}getPopulation(){return this.resourcesService.getTotalPeople()}getPopulationCap(){return this.resourcesService.getPopulationCap()}moveOccupants(e,t,i,s,r){const n=t;let o=0;const a=this.buildings.filter(t=>t!==e&&void 0!==t.getOccupants&&t.getOccupants()<t.getMaxSize()).sort((e,t)=>e.isWorking()&&!t.isWorking()?-1:t.isWorking()&&!e.isWorking()?1:t.getMaxSize()!==e.getMaxSize()?t.getMaxSize()-e.getMaxSize():0);for(;t>0&&o<a.length;){const e=a[o];for(;e.getOccupants()<e.getMaxSize()&&t>0;)e.addOccupant()&&(e.isWorking()||e.startProduction(),e.addFood(i/n),e.addFuel(s/n),e.addClothes(r/n),t-=1);o+=1}return t}removeRecruit(e,t=!0){const i=this.buildings.filter(e=>void 0!==e.getOccupants).map(e=>e).sort((e,t)=>e.getOccupants()===e.getMaxSize()&&t.getOccupants()===t.getMaxSize()?e.getMaxSize()>t.getMaxSize()?-1:1:e.getOccupants()===e.getMaxSize()&&t.getOccupants()<t.getMaxSize()?-1:e.getOccupants()<e.getMaxSize()&&t.getOccupants()===t.getMaxSize()?1:void 0);let s=0;if(i.forEach(e=>s+=e.getOccupants()),s>=e){for(;e>0;)for(const s of i){if(!(e>0))return!0;s.removeOccupant()&&(t&&this.resourcesService.removePeople(1),e-=1)}if(0===e)return!0}return!1}replaceWithHouses(){this.buildings.push(new mv(this.servicesService,this.idService.getNextId(),0,0,100,100,200).build()),this.landService.takeLand(nS.VILLAGE.HOUSE.SIZE),this.buildings.filter(e=>e.getBuildingType()===Lf.HUT).forEach(e=>{e.prepareDemolish(),this.demolish(e)}),this.buildings.filter(e=>e.getBuildingType()===Lf.DECONSTRUCTION).forEach(e=>this.finishDeconstruction(e))}getHousingBuildings(){return this.buildings.filter(e=>e.getBuildingType()===Lf.HUT||e.getBuildingType()===Lf.HOUSE||e.getBuildingType()===Lf.LONGHOUSE||e.getBuildingType()===Lf.TUDOR_HOUSE||e.getBuildingType()===Lf.SETTLEMENT)}addVillagers(e){let t=this.getHousingBuildings().map(e=>e).filter(e=>e.isWorking()).filter(e=>e.getOccupants()<e.getMaxSize()),i=e;for(;i>0&&t.length>0;)t.forEach(e=>{e.addOccupant()&&(this.resourcesService.createPeople(1),i-=1)}),t=t.filter(e=>e.getOccupants()<e.getMaxSize())}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(_O),gs(Jf),gs(NO),gs(NS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),PO=(()=>{class e{constructor(e,t,i){this.servicesService=e,this.optionsService=t,this.gameService=i,this.rations=Dm,this.clothes=xm,this.alcohol=km,this.tax=Fm,this.logFiredWorkers=Um,this.logAutoTrade=Hm,this.logSickness=Gm,this.logMerchant=Bm,this.furClothes=Mm,this.foodNutrition=Lm,this.complexWorkers=Wm,this.secondHeaderRow=Vm,this.showFreeWorkers=zm,this.showPopulation=Ym,this.showResearchProgress=Km,this.showHappiness=$m,this.showFaith=jm,this.showRaw=Qm,this.showProcessed=qm,this.showFood=Xm,this.showTools=Zm,this.defaultWorkshopResearch=Jm,this.defaultGathererFood=eS,this.switchHunterFromTaming=Jm,this.plowInSummer=iS,e.addService(Zf.MANAGEMENT,this),this.initFoodPriority()}initFoodPriority(){return this.foodPriority=[[]],this.servicesService.getResourcesService().getResourcesByType(Gf.CONSUMABLE).forEach(e=>this.foodPriority[0].push(e.resource)),this.foodPriority}getName(){return"ManagementService"}load(e){this.rations=e.rations,this.clothes=e.clothes,this.alcohol=e.alcohol,this.tax=void 0!==e.tax?e.tax:Fm,this.furClothes=e.furClothes,this.foodNutrition=e.foodNutrition,this.showRaw=void 0!==e.showRaw?e.showRaw:Qm,this.showProcessed=void 0!==e.showProcessed?e.showProcessed:qm,this.showFood=void 0!==e.showFood?e.showFood:Xm,this.showTools=void 0!==e.showTools?e.showTools:Zm,this.complexWorkers=e.complexWorkers,this.logFiredWorkers=void 0!==e.logFiredWorkers?e.logFiredWorkers:Um,this.logAutoTrade=void 0!==e.logAutoTrade?e.logAutoTrade:Hm,this.logSickness=void 0!==e.logSickness?e.logSickness:Gm,this.logMerchant=void 0!==e.logMerchant?e.logMerchant:Bm,this.secondHeaderRow=void 0!==e.secondHeaderRow?e.secondHeaderRow:Vm,this.showFreeWorkers=void 0!==e.showFreeWorkers?e.showFreeWorkers:zm,this.showPopulation=void 0!==e.showPopulation?e.showPopulation:Ym,this.foodPriority=void 0!==e.foodPriority?e.foodPriority:this.initFoodPriority(),this.showResearchProgress=void 0!==e.showResearchProgress?e.showResearchProgress:Km,this.showFaith=void 0!==e.showFaith?e.showFaith:jm,this.showHappiness=void 0!==e.showHappiness?e.showHappiness:$m,this.defaultWorkshopResearch=void 0!==e.defaultWorkshopResearch?e.defaultWorkshopResearch:Jm,this.defaultGathererFood=void 0!==e.defaultGathererFood?e.defaultGathererFood:eS,this.switchHunterFromTaming=void 0!==e.switchHunterFromTaming?e.switchHunterFromTaming:tS,this.plowInSummer=void 0!==e.plowInSummer?e.plowInSummer:iS,this.validateFoodPriority(),this.gameService.updateHeader(this.secondHeaderRow)}save(){return{rations:this.rations,clothes:this.clothes,alcohol:this.alcohol,tax:this.tax,furClothes:this.furClothes,foodNutrition:this.foodNutrition,showRaw:this.showRaw,showProcessed:this.showProcessed,showFood:this.showFood,showTools:this.showTools,complexWorkers:this.complexWorkers,logFiredWorkers:this.logFiredWorkers,logAutoTrade:this.logAutoTrade,logSickness:this.logSickness,logMerchant:this.logMerchant,secondHeaderRow:this.secondHeaderRow,showFreeWorkers:this.showFreeWorkers,showPopulation:this.showPopulation,foodPriority:this.foodPriority,showResearchProgress:this.showResearchProgress,showFaith:this.showFaith,showHappiness:this.showHappiness,defaultWorkshopResearch:this.defaultWorkshopResearch,defaultGathererFood:this.defaultGathererFood,switchHunterFromTaming:this.switchHunterFromTaming,plowInSummer:this.plowInSummer}}reset(e,t){!this.optionsService.getOption(Xf.KEEP_MANAGEMENT_SETTINGS_ON_RESET)||e?(this.rations=Dm,this.clothes=xm,this.alcohol=km,this.tax=Fm,this.furClothes=Mm,this.foodNutrition=Lm,this.showRaw=Qm,this.showProcessed=qm,this.showFood=Xm,this.showTools=Zm,this.complexWorkers=Wm,this.logFiredWorkers=Um,this.logAutoTrade=Hm,this.logSickness=Gm,this.secondHeaderRow=Vm,this.showFreeWorkers=zm,this.showPopulation=Ym,this.showResearchProgress=Km,this.showFaith=jm,this.showHappiness=$m,this.defaultWorkshopResearch=Jm,this.defaultGathererFood=eS,this.switchHunterFromTaming=tS,this.plowInSummer=iS,this.initFoodPriority()):(this.complexWorkers=Wm,this.validateFoodPriority()),e&&(this.complexWorkers=Wm,this.initFoodPriority()),this.gameService.updateHeader(this.secondHeaderRow)}getRations(){return this.rations}getClothesRations(){return this.clothes}getAlcoholRations(){return this.alcohol}setRations(e){this.rations=e}setClothesRations(e){this.clothes=e}setAlcoholRations(e){this.alcohol=e}getTaxRate(){return this.tax}setTaxRate(e){this.tax=e}toggleFurClothes(){this.furClothes=!this.furClothes}getFurClothes(){return this.furClothes}toggleFoodNutrition(){this.foodNutrition=!this.foodNutrition}getFoodNutrition(){return this.foodNutrition}toggleComplexWorkers(){this.complexWorkers=!this.complexWorkers}getComplexWorkers(){return this.complexWorkers}getSecondHeaderRow(){return this.secondHeaderRow}toggleSecondHeaderRow(){this.secondHeaderRow=!this.secondHeaderRow,this.gameService.updateHeader(this.secondHeaderRow)}getShowFreeWorkers(){return this.showFreeWorkers}toggleShowFreeWorkers(){this.showFreeWorkers=!this.showFreeWorkers}getShowPopulation(){return this.showPopulation}toggleShowPopulation(){this.showPopulation=!this.showPopulation}getShowResearchProgress(){return this.showResearchProgress}toggleShowResearchProgress(){this.showResearchProgress=!this.showResearchProgress}getFoodPriority(){if(this.gameService.isEnabled(Mf.MANAGEMENT))return this.foodPriority;{const e=[[]];return this.servicesService.getResourcesService().getResourcesByType(Gf.CONSUMABLE).forEach(t=>e[0].push(t.resource)),e}}up(e,t){const i=this.foodPriority[t].findIndex(t=>t===e);t>0?(i>=0&&(this.foodPriority[t-1].push(this.foodPriority[t][i]),this.foodPriority[t].splice(i,1)),this.clearList(this.foodPriority)):(this.foodPriority.unshift([]),this.foodPriority[0].push(this.foodPriority[1][i]),this.foodPriority[1].splice(i,1))}down(e,t){const i=this.foodPriority[t].findIndex(t=>t===e);i>=0&&t+1<9&&(this.foodPriority.length<t+2&&this.foodPriority.push([]),this.foodPriority[t+1].push(this.foodPriority[t][i]),this.foodPriority[t].splice(i,1)),this.clearList(this.foodPriority)}clearList(e){for(;e.length>0&&0===e[e.length-1].length;)e.splice(e.length-1,1);for(;e.length>0&&0===e[0].length;)e.splice(0,1)}validateFoodPriority(){const e=[];this.foodPriority.forEach(t=>t.forEach(t=>e.push(t))),oS.getResourcesByType(Gf.CONSUMABLE).forEach(t=>{e.find(e=>e===Df[t[0]])||this.foodPriority[0].push(Df[t[0]])})}getShowFaith(){return this.showFaith}toggleShowFaith(){this.showFaith=!this.showFaith}getShowHappiness(){return this.showHappiness}toggleShowHappiness(){this.showHappiness=!this.showHappiness}getLogFiredWorkers(){return this.logFiredWorkers}toggleLogFiredWorkers(){this.logFiredWorkers=!this.logFiredWorkers}getDefaultWorkshopResearch(){return this.defaultWorkshopResearch}toggleDefaultWorkshopResearch(){this.defaultWorkshopResearch=!this.defaultWorkshopResearch}getDefaultGathererFood(){return this.defaultGathererFood}toggleDefaultGathererFood(){this.defaultGathererFood=!this.defaultGathererFood}getSwitchHunterFromTaming(){return this.switchHunterFromTaming}toggleSwitchHunterFromTaming(){this.switchHunterFromTaming=!this.switchHunterFromTaming}getPlowInSummer(){return this.plowInSummer}togglePlowInSummer(){this.plowInSummer=!this.plowInSummer}getLogAutoTrade(){return this.logAutoTrade}toggleLogAutoTrade(){this.logAutoTrade=!this.logAutoTrade}getShowRaw(){return this.showRaw}toggleShowRaw(){this.showRaw=!this.showRaw}getShowProcessed(){return this.showProcessed}toggleShowProcessed(){this.showProcessed=!this.showProcessed}getShowFood(){return this.showFood}toggleShowFood(){this.showFood=!this.showFood}getShowTools(){return this.showTools}toggleShowTools(){this.showTools=!this.showTools}getLogSickness(){return this.logSickness}toggleLogSickness(){this.logSickness=!this.logSickness}getLogMerchant(){return this.logMerchant}toggleLogMerchant(){this.logMerchant=!this.logMerchant}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(vS),gs(AS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function MO(e,t){1&e&&(xo(0,"a",8),sa(1,"Fort"),ko())}function LO(e,t){1&e&&(xo(0,"a",9),sa(1,"Field"),ko())}function DO(e,t){1&e&&(xo(0,"a",10),sa(1,"Mountains"),ko())}function xO(e,t){1&e&&(xo(0,"a",11),sa(1,"Plateau"),ko())}function kO(e,t){1&e&&(xo(0,"a",12),sa(1,"Sea"),ko())}let FO=(()=>{class e{constructor(e,t){this.gameService=e,this.resourcesService=t}ngOnInit(){}isFortEnabled(){return this.gameService.isEnabled(Mf.FORT)}isFieldEnabled(){return this.gameService.isEnabled(Mf.FIELD)}isSeaEnabled(){return this.gameService.isEnabled(Mf.SEA)}isMountainsEnabled(){return this.gameService.isEnabled(Mf.MOUNTAINS)}isPlateauEnabled(){return this.gameService.isEnabled(Mf.PLATEAU)}getVillageStageName(){let e="Village";return rS.forEach(t=>{this.resourcesService.getPopulationCap()>=t.population&&(e=t.name)}),e}}return e.\u0275fac=function(t){return new(t||e)(Mo(AS),Mo(Pv))},e.\u0275cmp=Ve({type:e,selectors:[["app-top-menu"]],decls:10,vars:6,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","routerLink","/regions/village","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/fort","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/regions/forest","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/field","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/mountains","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/plateau","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/sea","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/regions/fort","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/field","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/mountains","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/plateau","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/sea","routerLinkActive","active",1,"entry"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"a",1),sa(2),ko(),Po(3,MO,2,0,"a",2),xo(4,"a",3),sa(5,"Forest"),ko(),Po(6,LO,2,0,"a",4),Po(7,DO,2,0,"a",5),Po(8,xO,2,0,"a",6),Po(9,kO,2,0,"a",7),ko()),2&e&&(Jr(2),ra(t.getVillageStageName()),Jr(1),Lo("ngIf",t.isFortEnabled()),Jr(3),Lo("ngIf",t.isFieldEnabled()),Jr(1),Lo("ngIf",t.isMountainsEnabled()),Jr(1),Lo("ngIf",t.isPlateauEnabled()),Jr(1),Lo("ngIf",t.isSeaEnabled()))},directives:[lf,hf,Gu],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:row}.entry[_ngcontent-%COMP%]{flex:auto;display:flex;justify-content:center;flex-direction:column;height:100%;text-align:center;border-right:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1.1em}.entry[_ngcontent-%COMP%]:last-of-type{border:none}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour)}"]}),e})();function UO(e,t){return new v(i=>{const s=e.length;if(0===s)return void i.complete();const r=new Array(s);let n=0,o=0;for(let a=0;a<s;a++){const c=k(e[a]);let l=!1;i.add(c.subscribe({next:e=>{l||(l=!0,o++),r[a]=e},error:e=>i.error(e),complete:()=>{n++,(n===s||!l)&&(o===s&&i.next(t?t.reduce((e,t,i)=>(e[t]=r[i],e),{}):r),i.complete())}}))}})}let HO=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}setProperty(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(ka),Mo(La))},e.\u0275dir=Qe({type:e}),e})(),GO=(()=>{class e extends HO{}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,features:[fo]}),e})();const BO=new ji("NgValueAccessor"),WO={provide:BO,useExisting:re(()=>VO),multi:!0};let VO=(()=>{class e extends GO{writeValue(e){this.setProperty("checked",e)}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&Vo("change",function(e){return t.onChange(e.target.checked)})("blur",function(){return t.onTouched()})},features:[Ca([WO]),fo]}),e})();const zO={provide:BO,useExisting:re(()=>KO),multi:!0},YO=new ji("CompositionEventMode");let KO=(()=>{class e extends HO{constructor(e,t,i){super(e,t),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const e=au()?au().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(ka),Mo(La),Mo(YO,8))},e.\u0275dir=Qe({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&Vo("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[Ca([zO]),fo]}),e})();function jO(e){return null==e||0===e.length}const $O=new ji("NgValidators"),QO=new ji("NgAsyncValidators");function qO(e){return null}function XO(e){return null!=e}function ZO(e){const t=Bo(e)?k(e):e;return Wo(t),t}function JO(e){let t={};return e.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function eT(e,t){return t.map(t=>t(e))}function tT(e){return e.map(e=>function(e){return!e.validate}(e)?e:t=>e.validate(t))}function iT(e){return null!=e?function(e){if(!e)return null;const t=e.filter(XO);return 0==t.length?null:function(e){return JO(eT(e,t))}}(tT(e)):null}function sT(e){return null!=e?function(e){if(!e)return null;const t=e.filter(XO);return 0==t.length?null:function(e){return function(...e){if(1===e.length){const t=e[0];if(c(t))return UO(t,null);if(l(t)&&Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);return UO(e.map(e=>t[e]),e)}}if("function"==typeof e[e.length-1]){const t=e.pop();return UO(e=1===e.length&&c(e[0])?e[0]:e,null).pipe(A(e=>t(...e)))}return UO(e,null)}(eT(e,t).map(ZO)).pipe(A(JO))}}(tT(e)):null}function rT(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function nT(e){return e?Array.isArray(e)?e:[e]:[]}function oT(e,t){return Array.isArray(e)?e.includes(t):e===t}function aT(e,t){const i=nT(t);return nT(e).forEach(e=>{oT(i,e)||i.push(e)}),i}function cT(e,t){return nT(t).filter(t=>!oT(e,t))}let lT=(()=>{class e{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=iT(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=sT(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e}),e})(),uT=(()=>{class e extends lT{get formDirective(){return null}get path(){return null}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,features:[fo]}),e})();class hT extends lT{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let dT=(()=>{class e extends class{constructor(e){this._cd=e}is(e){var t,i,s;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(s=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===s?void 0:s[e])}}{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(hT,2))},e.\u0275dir=Qe({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Zo("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[fo]}),e})();function gT(e,t){(function(e,t){const i=function(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(rT(i,t.validator)):"function"==typeof i&&e.setValidators([i]);const s=function(e){return e._rawAsyncValidators}(e);null!==t.asyncValidator?e.setAsyncValidators(rT(s,t.asyncValidator)):"function"==typeof s&&e.setAsyncValidators([s]);const r=()=>e.updateValueAndValidity();pT(t._rawValidators,r),pT(t._rawAsyncValidators,r)})(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(i=>{e._pendingValue=i,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&fT(e,t)})}(e,t),function(e,t){const i=(e,i)=>{t.valueAccessor.writeValue(e),i&&t.viewToModelUpdate(e)};e.registerOnChange(i),t._registerOnDestroy(()=>{e._unregisterOnChange(i)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&fT(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){const i=e=>{t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(i),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(i)})}}(e,t)}function pT(e,t){e.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function fT(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function mT(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}const ST="VALID",ET="INVALID",vT="PENDING",RT="DISABLED";function OT(e){return(CT(e)?e.validators:e)||null}function TT(e){return Array.isArray(e)?iT(e):e||null}function IT(e,t){return(CT(t)?t.asyncValidators:e)||null}function bT(e){return Array.isArray(e)?sT(e):e||null}function CT(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class yT{constructor(e,t){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=TT(this._rawValidators),this._composedAsyncValidatorFn=bT(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===ST}get invalid(){return this.status===ET}get pending(){return this.status==vT}get disabled(){return this.status===RT}get enabled(){return this.status!==RT}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=TT(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=bT(e)}addValidators(e){this.setValidators(aT(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(aT(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(cT(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(cT(e,this._rawAsyncValidators))}hasValidator(e){return oT(this._rawValidators,e)}hasAsyncValidator(e){return oT(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=vT,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=RT,this.errors=null,this._forEachChild(t=>{t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ST,this._forEachChild(t=>{t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ST||this.status===vT)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?RT:ST}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=vT,this._hasOwnPendingAsyncValidator=!0;const t=ZO(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(t=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(t,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(e,t,i){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;let s=e;return t.forEach(e=>{s=s instanceof NT?s.controls.hasOwnProperty(e)?s.controls[e]:null:s instanceof _T&&s.at(e)||null}),s}(this,e)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Vc,this.statusChanges=new Vc}_calculateStatus(){return this._allControlsDisabled()?RT:this.errors?ET:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vT)?vT:this._anyControlsHaveStatus(ET)?ET:ST}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){CT(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class AT extends yT{constructor(e=null,t,i){super(OT(t),IT(i,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(e=>e(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){mT(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){mT(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class NT extends yT{constructor(e,t,i){super(OT(t),IT(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(i=>{this._throwIfControlMissing(i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,s)=>{i.reset(e[s],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t instanceof AT?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(e,t)=>!!t._syncPendingControls()||e);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const i=this.controls[t];if(this.contains(t)&&e(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,i)=>((t.enabled||this.disabled)&&(e[i]=t.value),e))}_reduceChildren(e,t){let i=e;return this._forEachChild((e,s)=>{i=t(i,e,s)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,i)=>{if(void 0===e[i])throw new Error(`Must supply a value for form control with name: '${i}'.`)})}}class _T extends yT{constructor(e,t,i){super(OT(t),IT(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((e,i)=>{this._throwIfControlMissing(i),this.at(i).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((e,i)=>{this.at(i)&&this.at(i).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,s)=>{i.reset(e[s],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof AT?e.value:e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((e,t)=>!!t._syncPendingControls()||e,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error(`Cannot find form control at index ${e}`)}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,i)=>{if(void 0===e[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const wT={provide:hT,useExisting:re(()=>MT)},PT=(()=>Promise.resolve(null))();let MT=(()=>{class e extends hT{constructor(e,t,i,s){super(),this.control=new AT,this._registered=!1,this.update=new Vc,this._parent=e,this._setValidators(t),this._setAsyncValidators(i),this.valueAccessor=function(e,t){if(!t)return null;let i,s,r;return Array.isArray(t),t.forEach(e=>{e.constructor===KO?i=e:function(e){return Object.getPrototypeOf(e.constructor)===GO}(e)?s=e:r=e}),r||s||i||null}(0,s)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;const i=e.model;return!!i.isFirstChange()||!Object.is(t,i.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(e,t){return[...t.path,e]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){gT(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){PT.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const t=e.isDisabled.currentValue,i=""===t||t&&"false"!==t;PT.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable()})}}return e.\u0275fac=function(t){return new(t||e)(Mo(uT,9),Mo($O,10),Mo(QO,10),Mo(BO,10))},e.\u0275dir=Qe({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ca([wT]),fo,ct]}),e})();const LT={provide:BO,useExisting:re(()=>DT),multi:!0};let DT=(()=>{class e extends GO{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&Vo("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[Ca([LT]),fo]}),e})();const xT={provide:BO,useExisting:re(()=>UT),multi:!0};let kT=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({}),e})(),FT=(()=>{class e{constructor(){this._accessors=[]}add(e,t){this._accessors.push([e,t])}remove(e){for(let t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}select(e){this._accessors.forEach(t=>{this._isSameGroup(t,e)&&t[1]!==e&&t[1].fireUncheck(e.value)})}_isSameGroup(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({factory:function(){return new e},token:e,providedIn:kT}),e})(),UT=(()=>{class e extends GO{constructor(e,t,i,s){super(e,t),this._registry=i,this._injector=s,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(hT),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return e.\u0275fac=function(t){return new(t||e)(Mo(ka),Mo(La),Mo(FT),Mo(go))},e.\u0275dir=Qe({type:e,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&Vo("change",function(){return t.onChange()})("blur",function(){return t.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Ca([xT]),fo]}),e})();const HT={provide:BO,useExisting:re(()=>GT),multi:!0};let GT=(()=>{class e extends GO{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&Vo("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[Ca([HT]),fo]}),e})();const BT={provide:BO,useExisting:re(()=>VT),multi:!0};function WT(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let VT=(()=>{class e extends GO{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);const i=WT(t,e);this.setProperty("value",i)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&Vo("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ca([BT]),fo]}),e})(),zT=(()=>{class e{constructor(e,t,i){this._element=e,this._renderer=t,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(WT(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(Mo(La),Mo(ka),Mo(VT,9))},e.\u0275dir=Qe({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const YT={provide:BO,useExisting:re(()=>jT),multi:!0};function KT(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let jT=(()=>{class e extends GO{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let t;if(this.value=e,Array.isArray(e)){const i=e.map(e=>this._getOptionId(e));t=(e,t)=>{e._setSelected(i.indexOf(t.toString())>-1)}}else t=(e,t)=>{e._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{const i=[];if(void 0!==t.selectedOptions){const e=t.selectedOptions;for(let t=0;t<e.length;t++){const s=e.item(t),r=this._getOptionValue(s.value);i.push(r)}}else{const e=t.options;for(let t=0;t<e.length;t++){const s=e.item(t);if(s.selected){const e=this._getOptionValue(s.value);i.push(e)}}}this.value=i,e(i)}}_registerOption(e){const t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&Vo("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ca([YT]),fo]}),e})(),$T=(()=>{class e{constructor(e,t,i){this._element=e,this._renderer=t,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(KT(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(KT(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(Mo(La),Mo(ka),Mo(jT,9))},e.\u0275dir=Qe({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})(),QT=(()=>{class e{constructor(){this._validator=qO}handleChanges(e){if(this.inputName in e){const t=this.normalizeInput(e[this.inputName].currentValue);this._validator=this.createValidator(t),this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e}),e})();const qT={provide:$O,useExisting:re(()=>XT),multi:!0};let XT=(()=>{class e extends QT{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>parseFloat(e),this.createValidator=e=>function(e){return t=>{if(jO(t.value)||jO(e))return null;const i=parseFloat(t.value);return!isNaN(i)&&i>e?{max:{max:e,actual:t.value}}:null}}(e)}ngOnChanges(e){this.handleChanges(e)}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,t){if(2&e){let e;No("max",null!==(e=t.max)&&void 0!==e?e:null)}},inputs:{max:"max"},features:[Ca([qT]),fo,ct]}),e})();const ZT={provide:$O,useExisting:re(()=>JT),multi:!0};let JT=(()=>{class e extends QT{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>parseFloat(e),this.createValidator=e=>function(e){return t=>{if(jO(t.value)||jO(e))return null;const i=parseFloat(t.value);return!isNaN(i)&&i<e?{min:{min:e,actual:t.value}}:null}}(e)}ngOnChanges(e){this.handleChanges(e)}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=Wi(e)))(i||e)}}(),e.\u0275dir=Qe({type:e,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,t){if(2&e){let e;No("min",null!==(e=t.min)&&void 0!==e?e:null)}},inputs:{min:"min"},features:[Ca([ZT]),fo,ct]}),e})(),eI=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({imports:[[kT]]}),e})(),tI=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({imports:[eI]}),e})();const iI=function(e){return{margin:e}};let sI=(()=>{class e{constructor(){this.margin="0"}ngOnInit(){}getTitle(){return""===this.title?"":this.title?this.title:"Food"===this.name?"Food nutrition":Qf.titleCase(this.name).replace("_"," ")}getPath(){let e="assets/";return this.path&&(e+=this.path+"/"),e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ve({type:e,selectors:[["app-icon"]],inputs:{name:"name",path:"path",title:"title",margin:"margin"},decls:2,vars:6,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","onerror","if (this.src !== 'assets/question_mark.svg') this.src = 'assets/question_mark.svg';",1,"resourceIcon",3,"ngStyle","src","title","alt"]],template:function(e,t){1&e&&(xo(0,"div",0),Fo(1,"img",1),ko()),2&e&&(Jr(1),Qo("src","",t.getPath()+t.name.replace(" ","_").toLowerCase(),".svg",er),$o("title",t.getTitle()),$o("alt",t.name),Lo("ngStyle",Mc(4,iI,t.margin)))},directives:[Ku],styles:["[_nghost-%COMP%]{display:inline-block;vertical-align:middle;height:24px}#wrapper[_ngcontent-%COMP%]{display:inline-block;height:24px;margin:0;padding:0}img[_ngcontent-%COMP%]{display:inline-block;margin:0;padding:0;height:24px;width:24px}"]}),e})(),rI=(()=>{class e{constructor(){this.xMargin=20,this.yMargin=20}onmousemove(e){const t=document.getElementById(this.elementId);if(t){const i=e.clientX+this.xMargin;let s=e.clientY+this.yMargin;s+t.offsetHeight>740&&(s-=t.offsetHeight+2*this.yMargin),t.style.top=s+"px",t.style.left=i+"px"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e,selectors:[["","appTooltip",""]],hostBindings:function(e,t){1&e&&Vo("mousemove",function(e){return t.onmousemove(e)})},inputs:{elementId:"elementId"}}),e})();function nI(e,t){1&e&&Fo(0,"app-icon",9),2&e&&Lo("name","angry")("path","happiness")("title","")("margin","0 0 0 4px")}function oI(e,t){1&e&&Fo(0,"app-icon",9),2&e&&Lo("name","sad")("path","happiness")("title","")("margin","0 0 0 4px")}function aI(e,t){1&e&&Fo(0,"app-icon",9),2&e&&Lo("name","neutral")("path","happiness")("title","")("margin","0 0 0 4px")}function cI(e,t){1&e&&Fo(0,"app-icon",9),2&e&&Lo("name","happy")("path","happiness")("title","")("margin","0 0 0 4px")}function lI(e,t){1&e&&Fo(0,"app-icon",9),2&e&&Lo("name","overjoyed")("path","happiness")("title","")("margin","0 0 0 4px")}const uI=function(e,t){return{negativeColor:e,positiveColor:t}};let hI=(()=>{class e{constructor(e){this.happinessService=e,this.id=Math.random()}ngOnInit(){}getHappiness(){return Qf.round(this.happinessService.getHappiness(),2)}getHappinessValue(){return this.happinessService.getHappiness()}getSum(){return this.happinessService.calculateDailyChange()}getSumText(){return Qf.round(this.getSum(),2)}getHappinessBonus(){return this.happinessService.getHappinessEffect()}}return e.\u0275fac=function(t){return new(t||e)(Mo(Av))},e.\u0275cmp=Ve({type:e,selectors:[["app-happiness"]],decls:23,vars:22,consts:[["appTooltip","",1,"tooltip",3,"elementId"],[3,"id"],["id","title"],[1,"center"],[1,"inline",3,"ngClass"],[1,"center","inline"],[1,"center","inline",3,"ngClass"],["id","wrapper",1,"icon"],[3,"name","path","title","margin",4,"ngIf"],[3,"name","path","title","margin"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"span",1),xo(2,"div",2),xo(3,"div"),sa(4,"Happiness"),ko(),ko(),Fo(5,"br"),xo(6,"div",3),sa(7," (bonus: "),xo(8,"div",4),sa(9),ko(),sa(10,") "),ko(),xo(11,"div",5),xo(12,"div",6),sa(13),ko(),sa(14," per day "),ko(),ko(),xo(15,"div",7),Po(16,nI,1,4,"app-icon",8),Po(17,oI,1,4,"app-icon",8),Po(18,aI,1,4,"app-icon",8),Po(19,cI,1,4,"app-icon",8),Po(20,lI,1,4,"app-icon",8),xo(21,"div",4),sa(22),ko(),ko(),ko()),2&e&&(Lo("elementId","happiness-"+t.id),Jr(1),Qo("id","happiness-",t.id,""),Jr(7),Lo("ngClass",Lc(13,uI,t.getHappinessBonus()<0,t.getHappinessBonus()>0)),Jr(1),na("",t.getHappinessBonus(),"%"),Jr(3),Lo("ngClass",Lc(16,uI,t.getSum()<0,t.getSum()>0)),Jr(1),na("",t.getSumText(),"%"),Jr(3),Lo("ngIf",t.getHappinessValue()>=0&&t.getHappinessValue()<=10),Jr(1),Lo("ngIf",t.getHappinessValue()>10&&t.getHappinessValue()<=40),Jr(1),Lo("ngIf",t.getHappinessValue()>40&&t.getHappinessValue()<=60),Jr(1),Lo("ngIf",t.getHappinessValue()>60&&t.getHappinessValue()<=90),Jr(1),Lo("ngIf",t.getHappinessValue()>90&&t.getHappinessValue()<=100),Jr(1),Lo("ngClass",Lc(19,uI,t.getHappinessBonus()<=0,t.getHappinessBonus()>0)),Jr(1),na("",t.getHappiness(),"%"))},directives:[rI,ku,Gu,sI],styles:["[_nghost-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.inline[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.center[_ngcontent-%COMP%]{text-align:center}.positiveColor[_ngcontent-%COMP%]{color:var(--positive-colour)}.negativeColor[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e})();function dI(e,t){if(1&e&&(xo(0,"div"),sa(1),Fo(2,"app-icon",8),ko()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),na("",e.value," "),Jr(1),Lo("name",t.getResourceName(e.key))("path","resources")}}function gI(e,t){if(1&e&&(xo(0,"div",9),sa(1),Fo(2,"app-icon",8),ko()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),na("",e.value," "),Jr(1),Lo("name",t.getResourceName(e.key))("path","resources")}}function pI(e,t){if(1&e&&(xo(0,"div"),Po(1,dI,3,3,"div",6),Po(2,gI,3,3,"div",7),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("ngIf",i.hasResource(e)),Jr(1),Lo("ngIf",!i.hasResource(e))}}function fI(e,t){if(1&e){const e=Go();xo(0,"div",2),Vo("click",function(){return Dt(e),Ko().buff()}),Fo(1,"img",3),xo(2,"span",4),sa(3),Fo(4,"br"),sa(5),Fo(6,"hr"),Po(7,pI,3,2,"div",5),Fc(8,"keyvalue"),ko(),ko()}if(2&e){const e=Ko();Lo("elementId",-e.id),Jr(2),$o("id",-e.id),Jr(1),na(" ",e.buildingBuff.name,""),Jr(2),oa(" ",e.buildingBuff.effect,"% buff for ",e.buildingBuff.duration," days "),Jr(2),Lo("ngForOf",Uc(8,6,e.buildingBuff.cost))}}let mI=(()=>{class e{constructor(e,t,i,s){this.servicesService=e,this.resourcesService=t,this.effectsService=i,this.gameService=s,this.id=Math.random()}ngOnInit(){this.building.hasBuff()&&(this.buildingBuff=this.building.getBuff())}hasResource(e){return 0===this.resourcesService.hasResource(e.key,e.value,"Building buff",!0)}getResourceName(e){return Qf.prepareResourceName(e)}buff(){const e=this.servicesService.getModalService();if(this.building.hasBuff()&&this.buffsEnabled())if(this.building.isBuffed())e.info("This building is already buffed");else{const e=this.building.getBuff();this.resourcesService.decreaseResources(e.cost,"Building buff",!0)&&this.effectsService.addBuildingEffect(new nm(e.name,this.building.getBuildingType(),e.effect,e.duration,this.building.id))}else e.info("This building cannot be buffed")}buffsEnabled(){return this.gameService.isEnabled(Mf.BUFFS)}}return e.\u0275fac=function(t){return new(t||e)(Mo(Jf),Mo(Pv),Mo(bS),Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-building-buff"]],inputs:{building:"building"},decls:2,vars:1,consts:[["id","wrapper"],["id","buff","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","buff","appTooltip","",1,"tooltip",3,"elementId","click"],["draggable","false","ondragstart","return false;","src","assets/buff.svg"],[3,"id"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","notMet",4,"ngIf"],[3,"name","path"],[1,"notMet"]],template:function(e,t){1&e&&(xo(0,"div",0),Po(1,fI,9,8,"div",1),ko()),2&e&&(Jr(1),Lo("ngIf",t.buffsEnabled()&&t.building.hasBuff()&&!t.building.isBuffed()))},directives:[Gu,rI,Uu,sI],pipes:[qu],styles:["#wrapper[_ngcontent-%COMP%]{cursor:pointer}img[_ngcontent-%COMP%]{height:24px;width:24px}hr[_ngcontent-%COMP%]{border-color:#000}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e})();function SI(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na("Upgrade to ",e.getBuildingName(e.building.getUpgradeSettings().NEW_BUILDING),"")}}function EI(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na("Upgrade to level ",e.building.getBuildingLevel()+1,"")}}const vI=function(e){return{notMet:e}};function RI(e,t){if(1&e&&(xo(0,"div",8),sa(1),Fo(2,"app-icon",9),ko()),2&e){const e=Ko(2);Lo("ngClass",Mc(3,vI,!e.landService.hasLand(e.building.getUpgradeSettings().SIZE))),Jr(1),na(" ",e.building.getUpgradeSettings().SIZE,""),Jr(1),Lo("name","land")}}function OI(e,t){if(1&e&&(xo(0,"div"),sa(1),Fo(2,"app-icon",11),ko()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),na("",e.value," "),Jr(1),Lo("name",t.getResourceName(e.key))("path","resources")}}function TI(e,t){if(1&e&&(xo(0,"div",12),sa(1),Fo(2,"app-icon",11),ko()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),na("",e.value," "),Jr(1),Lo("name",t.getResourceName(e.key))("path","resources")}}function II(e,t){if(1&e&&(xo(0,"div"),Po(1,OI,3,3,"div",5),Po(2,TI,3,3,"div",10),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("ngIf",i.hasResource(e)),Jr(1),Lo("ngIf",!i.hasResource(e))}}function bI(e,t){if(1&e){const e=Go();xo(0,"div",2),Vo("click",function(){return Dt(e),Ko().upgrade()}),Fo(1,"img",3),xo(2,"span",4),Po(3,SI,2,1,"div",5),Po(4,EI,2,1,"div",5),Fo(5,"hr"),Po(6,RI,3,5,"div",6),Po(7,II,3,2,"div",7),Fc(8,"keyvalue"),ko(),ko()}if(2&e){const e=Ko();Lo("elementId",-e.id),Jr(2),$o("id",-e.id),Jr(1),Lo("ngIf",e.building.getUpgradeSettings()&&e.building.getUpgradeSettings().NEW_BUILDING),Jr(1),Lo("ngIf",e.building.getUpgradeSettings()&&void 0===e.building.getUpgradeSettings().NEW_BUILDING),Jr(2),Lo("ngIf",e.building.getUpgradeSettings()&&e.building.getUpgradeSettings().SIZE),Jr(1),Lo("ngForOf",Uc(8,6,e.building.getUpgradeCost()))}}let CI=(()=>{class e{constructor(e,t,i){this.resourcesService=e,this.landService=t,this.servicesService=i,this.id=Math.random()}ngOnInit(){}hasResource(e){return 0===this.resourcesService.hasResource(e.key,e.value,this.building.getName()+" upgrade",!0)}getResourceName(e){return Qf.prepareResourceName(e)}upgrade(){this.parentRegion.upgradeBuilding(this.building.getBuildingId())}getBuildingName(e){return Qf.prepareBuildingName(e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(Pv),Mo(NS),Mo(Jf))},e.\u0275cmp=Ve({type:e,selectors:[["app-building-upgrade"]],inputs:{building:"building",parentRegion:"parentRegion"},decls:2,vars:1,consts:[["id","wrapper"],["id","upgrade","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","upgrade","appTooltip","",1,"tooltip",3,"elementId","click"],["draggable","false","ondragstart","return false;","src","assets/upgrade.svg"],[3,"id"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"name"],["class","notMet",4,"ngIf"],[3,"name","path"],[1,"notMet"]],template:function(e,t){1&e&&(xo(0,"div",0),Po(1,bI,9,8,"div",1),ko()),2&e&&(Jr(1),Lo("ngIf",t.building.hasUpgrade()))},directives:[Gu,rI,Uu,ku,sI],pipes:[qu],styles:["#wrapper[_ngcontent-%COMP%]{cursor:pointer}img[_ngcontent-%COMP%]{height:24px;width:24px}hr[_ngcontent-%COMP%]{border-color:#000}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e})();const yI=["progress"],AI=["label"],NI=["label2"];function _I(e,t){1&e&&(xo(0,"div",2),Fo(1,"div",3,4),Fo(3,"div",5,6),ko())}function wI(e,t){1&e&&(xo(0,"div",7),Fo(1,"div",8,9),ko())}let PI=(()=>{class e{constructor(e){this.optionsService=e,this.progress=0,this.text=""}set progressReInput(e){this.progressRef=e,this.ngOnChanges()}set labelRefInput(e){this.labelRef=e,this.ngOnChanges()}set label2RefInput(e){this.label2Ref=e,this.ngOnChanges()}ngOnInit(){}ngOnChanges(){this.progressBarsEnabled()?(this.progressRef&&(this.progressRef.nativeElement.style.width=this.progress+"%"),this.labelRef&&(this.labelRef.nativeElement.innerHTML=this.text&&""!==this.text?this.text:this.progress.toFixed(2)+"%")):this.label2Ref&&(this.label2Ref.nativeElement.innerHTML=this.text,this.label2Ref.nativeElement.innerHTML=this.progress.toFixed(2)+"%")}progressBarsEnabled(){return this.optionsService.getOption(Xf.VISUAL_PROGRESS_BARS)}}return e.\u0275fac=function(t){return new(t||e)(Mo(vS))},e.\u0275cmp=Ve({type:e,selectors:[["app-progress-bar"]],viewQuery:function(e,t){if(1&e&&(il(yI,5),il(AI,5),il(NI,5)),2&e){let e;tl(e=rl())&&(t.progressReInput=e.first),tl(e=rl())&&(t.labelRefInput=e.first),tl(e=rl())&&(t.label2RefInput=e.first)}},inputs:{progress:"progress",text:"text"},features:[ct],decls:2,vars:2,consts:[["id","progressBar",4,"ngIf"],["id","progressBar2",4,"ngIf"],["id","progressBar"],["id","progress"],["progress",""],["id","label"],["label",""],["id","progressBar2"],["id","label2"],["label2",""]],template:function(e,t){1&e&&(Po(0,_I,5,0,"div",0),Po(1,wI,3,0,"div",1)),2&e&&(Lo("ngIf",t.progressBarsEnabled()),Jr(1),Lo("ngIf",!t.progressBarsEnabled()))},directives:[Gu],styles:["#progressBar[_ngcontent-%COMP%]{position:relative;width:95%;height:100%;display:inline-block;text-align:center;background-color:#ddd;border:black solid 1px;margin-top:-1px}#progressBar2[_ngcontent-%COMP%]{position:relative;width:95%;height:100%;display:inline-block;text-align:center;margin-top:-1px}#progress[_ngcontent-%COMP%]{height:100%;background-color:var(--active-colour);text-align:center;color:#fff}#label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;font-size:1em;text-align:center}#label2[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;font-size:1em;text-align:center;font-weight:bold}"],changeDetection:0}),e})();function MI(e,t){if(1&e&&(xo(0,"span"),xo(1,"span",7),Fo(2,"span",8),Fo(3,"app-icon",9),Fo(4,"span",8),ko(),ko()),2&e){const e=t.$implicit;Jr(2),Lo("innerHTML",e.prefix,Js),Jr(1),Lo("name",e.name)("path",e.path),Jr(1),Lo("innerHTML",e.suffix,Js)}}function LI(e,t){if(1&e&&(xo(0,"span",5),Po(1,MI,5,4,"span",6),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngForOf",e.building.getLine(e.line).getValue())}}function DI(e,t){if(1&e&&Fo(0,"span",10),2&e){const e=Ko(2);Lo("innerHTML",e.building.getLine(e.line).getValue(),Js)}}function xI(e,t){if(1&e){const e=Go();xo(0,"span",11),xo(1,"button",12),Vo("click",function(){Dt(e);const t=Ko(2);return t.buildingCallback(t.building.getLine(t.line).getValue().callbackValue)}),sa(2),ko(),ko()}if(2&e){const e=Ko(2);Jr(2),na("",e.building.getLine(e.line).getValue().buttonText," ")}}function kI(e,t){if(1&e){const e=Go();xo(0,"span",11),xo(1,"button",12),Vo("click",function(){Dt(e);const t=Ko(2);return t.buildingCallback(t.building.getLine(t.line).getValue().callbackValue)}),sa(2),ko(),xo(3,"label"),xo(4,"input",13),Vo("ngModelChange",function(t){Dt(e);const i=Ko(2);return i.building.getLine(i.line).getValue().checkboxState=t})("click",function(){Dt(e);const t=Ko(2);return t.buildingCallback(t.building.getLine(t.line).getValue().checkboxCallbackValue)}),ko(),sa(5),ko(),ko()}if(2&e){const e=Ko(2);Jr(2),na("",e.building.getLine(e.line).getValue().buttonText," "),Jr(2),Lo("ngModel",e.building.getLine(e.line).getValue().checkboxState),Jr(1),na("",e.building.getLine(e.line).getValue().checkboxLabel," ")}}function FI(e,t){if(1&e){const e=Go();xo(0,"span",11),xo(1,"label"),xo(2,"input",13),Vo("ngModelChange",function(t){Dt(e);const i=Ko(2);return i.building.getLine(i.line).getValue().checkboxState=t})("click",function(){Dt(e);const t=Ko(2);return t.buildingCallback(t.building.getLine(t.line).getValue().checkboxCallbackValue)}),ko(),sa(3),ko(),ko()}if(2&e){const e=Ko(2);Jr(2),Lo("ngModel",e.building.getLine(e.line).getValue().checkboxState),Jr(1),na("",e.building.getLine(e.line).getValue().checkboxLabel," ")}}function UI(e,t){if(1&e){const e=Go();xo(0,"span",11),xo(1,"button",12),Vo("click",function(){Dt(e);const t=Ko(2);return t.buildingCallback(t.building.getLine(t.line).getValue().callback1Value)}),sa(2),ko(),Fo(3,"span",8),xo(4,"button",12),Vo("click",function(){Dt(e);const t=Ko(2);return t.buildingCallback(t.building.getLine(t.line).getValue().callback2Value)}),sa(5),ko(),ko()}if(2&e){const e=Ko(2);Jr(2),ra(e.building.getLine(e.line).getValue().button1Text),Jr(1),Lo("innerHTML",e.building.getLine(e.line).getValue().textBetween,Js),Jr(2),ra(e.building.getLine(e.line).getValue().button2Text)}}function HI(e,t){if(1&e&&(xo(0,"option",16),sa(1),ko()),2&e){const e=t.$implicit;Lo("value",e),Jr(1),ra(e)}}function GI(e,t){if(1&e){const e=Go();xo(0,"span",11),xo(1,"select",14),Vo("change",function(t){return Dt(e),Ko(2).buildingCallback(t)})("ngModelChange",function(t){Dt(e);const i=Ko(2);return i.building.getLine(i.line).getValue().selected=t}),Po(2,HI,2,2,"option",15),ko(),ko()}if(2&e){const e=Ko(2);Jr(1),Lo("ngModel",e.building.getLine(e.line).getValue().selected),Jr(1),Lo("ngForOf",e.building.getLine(e.line).getValue().values)}}function BI(e,t){if(1&e&&Fo(0,"app-progress-bar",18),2&e){const e=Ko(3);Lo("progress",e.building.getLine(e.line).getValue().value)("text",e.building.getLine(e.line).getValue().label)}}function WI(e,t){if(1&e&&(xo(0,"span",11),Po(1,BI,1,2,"app-progress-bar",17),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngIf",e.building.getLine(e.line).getValue().value>=0)}}function VI(e,t){if(1&e&&(xo(0,"span",1),Po(1,LI,2,1,"span",2),Po(2,DI,1,1,"span",3),Po(3,xI,3,1,"span",4),Po(4,kI,6,3,"span",4),Po(5,FI,4,2,"span",4),Po(6,UI,6,3,"span",4),Po(7,GI,3,2,"span",4),Po(8,WI,2,1,"span",4),ko()),2&e){const e=Ko();Jr(1),Lo("ngIf",e.isIconValue(e.building.getLine(e.line).getValueType())),Jr(1),Lo("ngIf",e.isTextValue(e.building.getLine(e.line).getValueType())),Jr(1),Lo("ngIf",e.isButtonValue(e.building.getLine(e.line).getValueType())),Jr(1),Lo("ngIf",e.isButtonCheckboxValue(e.building.getLine(e.line).getValueType())),Jr(1),Lo("ngIf",e.isCheckboxValue(e.building.getLine(e.line).getValueType())),Jr(1),Lo("ngIf",e.isTwoButtonValue(e.building.getLine(e.line).getValueType())),Jr(1),Lo("ngIf",e.isDropdownValue(e.building.getLine(e.line).getValueType())),Jr(1),Lo("ngIf",e.isProgressValue(e.building.getLine(e.line).getValueType()))}}let zI=(()=>{class e{constructor(){}ngOnInit(){}isTextValue(e){return e===_S.TEXT}isButtonValue(e){return e===_S.BUTTON}isTwoButtonValue(e){return e===_S.TWO_BUTTON}isProgressValue(e){return e===_S.PROGRESS_BAR}isDropdownValue(e){return e===_S.DROPDOWN}isIconValue(e){return e===_S.ICON}isButtonCheckboxValue(e){return e===_S.BUTTON_CHECKBOX}isCheckboxValue(e){return e===_S.CHECKBOX}buildingCallback(e){this.building.callback(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ve({type:e,selectors:[["app-building-line"]],inputs:{line:"line",building:"building"},decls:1,vars:1,consts:[["id","wrapper",4,"ngIf"],["id","wrapper"],["class","line iconsLine",4,"ngIf"],["class","line",3,"innerHTML",4,"ngIf"],["class","line",4,"ngIf"],[1,"line","iconsLine"],[4,"ngFor","ngForOf"],[1,"icon"],[3,"innerHTML"],[3,"name","path"],[1,"line",3,"innerHTML"],[1,"line"],[3,"click"],["type","checkbox",3,"ngModel","ngModelChange","click"],[3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"progress","text",4,"ngIf"],[3,"progress","text"]],template:function(e,t){1&e&&Po(0,VI,9,8,"span",0),2&e&&Lo("ngIf",null!=t.line&&t.building)},directives:[Gu,Uu,sI,VO,dT,MT,VT,zT,$T,PI],styles:["#wrapper[_ngcontent-%COMP%]{font-size:1.3em}.iconsLine[_ngcontent-%COMP%]{display:flex;flex-direction:row}.iconsLine[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:auto}.line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:1px 4px}button[_ngcontent-%COMP%]{font-size:.9em}select[_ngcontent-%COMP%]{font-size:.9em}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}.icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:2px;flex:0 0 auto}"]}),e})();const YI=["center"];function KI(e,t){if(1&e&&(xo(0,"span",18),Fo(1,"img",19),xo(2,"span",20),xo(3,"div",21),sa(4),ko(),Fo(5,"hr"),Fo(6,"div",22),ko(),ko()),2&e){const e=Ko();Lo("elementId",e.id),Jr(2),$o("id",e.id),Jr(2),ra(e.building.getName()),Jr(2),Lo("innerHTML",e.building.getDetails(),Js)}}function jI(e,t){if(1&e&&(xo(0,"span",23),sa(1),ko()),2&e){const e=Ko();Jr(1),na("(+",e.round(e.getDisplayableEffectsValue()),"%)")}}function $I(e,t){if(1&e&&(xo(0,"span",24),sa(1),ko()),2&e){const e=Ko();Jr(1),na("(",e.round(e.getDisplayableEffectsValue()),"%)")}}function QI(e,t){if(1&e){const e=Go();xo(0,"span",26),Vo("click",function(){return Dt(e),Ko(2).stop()}),Fo(1,"img",27),ko()}}function qI(e,t){if(1&e){const e=Go();xo(0,"span",26),Vo("click",function(){return Dt(e),Ko(2).stop()}),Fo(1,"img",28),ko()}}function XI(e,t){if(1&e&&(Uo(0),Po(1,QI,2,0,"span",25),Po(2,qI,2,0,"span",25),Ho()),2&e){const e=Ko();Jr(1),Lo("ngIf",e.isStoppable()&&e.isWorking()),Jr(1),Lo("ngIf",e.isStoppable()&&!e.isWorking())}}function ZI(e,t){1&e&&Fo(0,"img",33)}function JI(e,t){1&e&&Fo(0,"img",34)}function eb(e,t){1&e&&Fo(0,"img",35)}function tb(e,t){1&e&&Fo(0,"img",36)}function ib(e,t){if(1&e){const e=Go();xo(0,"span",26),Vo("click",function(t){return Dt(e),Ko(2).openWorkersManagement(t)}),Po(1,ZI,1,0,"img",29),Po(2,JI,1,0,"img",30),Po(3,eb,1,0,"img",31),Po(4,tb,1,0,"img",32),ko()}if(2&e){const e=Ko(2);Jr(1),Lo("ngIf",e.building.getWorkSettings().enabled&&e.building.isWorking()),Jr(1),Lo("ngIf",e.building.getWorkSettings().enabled&&!e.building.isWorking()),Jr(1),Lo("ngIf",!e.building.getWorkSettings().enabled&&e.building.isWorking()),Jr(1),Lo("ngIf",!e.building.getWorkSettings().enabled&&!e.building.isWorking())}}function sb(e,t){if(1&e&&(Uo(0),Po(1,ib,5,4,"span",25),Ho()),2&e){const e=Ko();Jr(1),Lo("ngIf",e.isStoppable())}}function rb(e,t){if(1&e){const e=Go();xo(0,"div",37),Vo("click",function(){return Dt(e),Ko().demolish()}),xo(1,"span",38),sa(2,"Demolish"),ko(),ko()}}function nb(e,t){if(1&e){const e=Go();xo(0,"div",39),Vo("click",function(){return Dt(e),Ko().combine()}),xo(1,"span",40),sa(2,"Combine"),ko(),ko()}}function ob(e,t){if(1&e){const e=Go();xo(0,"div",41),Vo("click",function(){return Dt(e),Ko().split()}),xo(1,"span",40),sa(2,"Split"),ko(),ko()}}function ab(e,t){if(1&e){const e=Go();xo(0,"div",42),Vo("click",function(){return Dt(e),Ko().arrange()}),xo(1,"span",40),sa(2,"Move"),ko(),ko()}}const cb=function(e){return{usedUp:e}};let lb=(()=>{class e{constructor(e,t,i,s,r,n){this.modalService=e,this.servicesService=t,this.resourcesService=i,this.managementService=s,this.villageService=r,this.optionsService=n,this.demolishMode=!1,this.combineMode=!1,this.splitMode=!1,this.arrangeMode=!1,this.lines=PS,this.id=Math.random(),this.lastEffectsDisplayValue=0,this.hasEffectsDisplayChanged=!1}ngOnInit(){}fitText(){if(this.centerRef){this.hasEffectsDisplayChanged=!1;const e=15,t=this.centerRef.nativeElement;let i=t.clientWidth,s=t.scrollWidth,r=parseInt(window.getComputedStyle(t,null).getPropertyValue("font-size"),10);if(s>i)r=Math.ceil(r*i/s),r=r>e?r=e:r-1,t.style.fontSize=r+"px";else for(;s===i&&r<e;)r=Math.ceil(r)+1,r=r>e?r=e:r,t.style.fontSize=r+"px",i=t.clientWidth,s=t.scrollWidth,s>i&&(t.style.fontSize=r-1+"px")}}stop(){this.building.isWorking()?this.building.stopProduction():this.building.startProduction()||this.modalService.info("Cannot unlock production of "+this.building.getName()+". Number of free workers: "+this.resourcesService.getPeople())}isStoppable(){return this.building.isStoppable()}isWorking(){return this.building.isWorking()}demolish(){if(void 0!==this.building.getMaxSize&&this.villageService.getPopulation()>this.villageService.getPopulationCap()-this.building.getMaxSize()){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("You don't have enough housing space to move this building occupants.<br> People that won't find new home will leave the village<br>Do you still want to demolish this building?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&this.building.prepareDemolish()&&this.parentRegion.demolish(this.building)})}else if(this.building.isUsedUp())this.building.prepareDemolish()&&this.parentRegion.demolish(this.building);else{this.modalService.setModalText("Are you sure you want to demolish "+this.building.getName()+"?"),this.modalService.open(Pf.CONFIRM);const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&this.building.prepareDemolish()&&this.parentRegion.demolish(this.building)})}}canCombine(){return this.parentRegion.canCombine(this.building)}combine(){this.parentRegion.combine(this.building)}split(){this.parentRegion.split(this.building)}areComplexWorkersEnabled(){return this.managementService.getComplexWorkers()}openWorkersManagement(e){e.ctrlKey?this.building.getWorkSettings().enabled?(this.building.getWorkSettings().enabled=!1,this.stop()):this.stop():e.shiftKey?this.building.getWorkSettings().enabled=!this.building.getWorkSettings().enabled:(this.modalService.open(Pf.WORK_MANAGEMENT),this.modalService.setBuilding(this.building))}round(e){return e%1!=0?Qf.round(e,2):e}arrange(){this.parentRegion.move(this.building)}canMove(){return this.parentRegion.canMove(this.building)}getDisplayableEffectsValue(){const e=this.building.getDisplayableEffectsValue();return this.lastEffectsDisplayValue!==e&&(this.lastEffectsDisplayValue=e,this.hasEffectsDisplayChanged=!0),e}isTextFittingEnabled(){return this.optionsService.getOption(Xf.AUTO_TEXT_FITTING)}ngAfterViewChecked(){this.hasEffectsDisplayChanged&&this.isTextFittingEnabled()&&this.fitText()}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(Jf),Mo(Pv),Mo(PO),Mo(wO),Mo(vS))},e.\u0275cmp=Ve({type:e,selectors:[["app-building"]],viewQuery:function(e,t){if(1&e&&il(YI,5),2&e){let e;tl(e=rl())&&(t.centerRef=e.first)}},inputs:{demolishMode:"demolishMode",combineMode:"combineMode",splitMode:"splitMode",arrangeMode:"arrangeMode",building:"building",parentRegion:"parentRegion"},decls:23,vars:24,consts:[["id","wrapper",3,"ngClass"],["id","nameBar"],["id","left"],["class","details tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","center"],["center",""],["class","positiveEffects",4,"ngIf"],["class","negativeEffects",4,"ngIf"],["id","right"],[4,"ngIf"],["id","lines"],[3,"building"],[3,"building","parentRegion"],[3,"line","building"],["id","demolish",3,"click",4,"ngIf"],["id","combine",3,"click",4,"ngIf"],["id","split",3,"click",4,"ngIf"],["id","arrange",3,"click",4,"ngIf"],["appTooltip","",1,"details","tooltip",3,"elementId"],["draggable","false","ondragstart","return false;","src","assets/details.svg","alt","details"],[1,"tooltipSpan",3,"id"],["id","title"],[3,"innerHTML"],[1,"positiveEffects"],[1,"negativeEffects"],["class","control",3,"click",4,"ngIf"],[1,"control",3,"click"],["draggable","false","ondragstart","return false;","src","assets/gear.svg","title","disable","alt","on"],["draggable","false","ondragstart","return false;","src","assets/gear_off.svg","title","enable","alt","off"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_on.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_off.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_on.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_off.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_on.svg","title","work settings"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_off.svg","title","work settings"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_on.svg","title","work settings"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_off.svg","title","work settings"],["id","demolish",3,"click"],["id","demolishText"],["id","combine",3,"click"],[1,"combineText"],["id","split",3,"click"],["id","arrange",3,"click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),xo(2,"div",2),Po(3,KI,7,4,"span",3),ko(),xo(4,"div",4,5),sa(6),Po(7,jI,2,1,"span",6),Po(8,$I,2,1,"span",7),ko(),xo(9,"div",8),Po(10,XI,3,2,"ng-container",9),Po(11,sb,2,1,"ng-container",9),ko(),ko(),xo(12,"div",10),Fo(13,"app-building-buff",11),Fo(14,"app-building-upgrade",12),Fo(15,"app-building-line",13),Fo(16,"app-building-line",13),Fo(17,"app-building-line",13),Fo(18,"app-building-line",13),ko(),Po(19,rb,3,0,"div",14),Po(20,nb,3,0,"div",15),Po(21,ob,3,0,"div",16),Po(22,ab,3,0,"div",17),ko()),2&e&&(Lo("ngClass",Mc(22,cb,t.building.isUsedUp())),Jr(3),Lo("ngIf",t.building.hasDetails()),Jr(3),na("",t.building.getName()," "),Jr(1),Lo("ngIf",t.getDisplayableEffectsValue()>0),Jr(1),Lo("ngIf",t.getDisplayableEffectsValue()<0),Jr(2),Lo("ngIf",!t.building.isComplexManagement()||t.building.isComplexManagement()&&!t.areComplexWorkersEnabled()),Jr(1),Lo("ngIf",t.building.isComplexManagement()&&t.areComplexWorkersEnabled()),Jr(2),Lo("building",t.building),Jr(1),Lo("building",t.building)("parentRegion",t.parentRegion),Jr(1),Lo("line",t.lines.FIRST)("building",t.building),Jr(1),Lo("line",t.lines.SECOND)("building",t.building),Jr(1),Lo("line",t.lines.THIRD)("building",t.building),Jr(1),Lo("line",t.lines.FOURTH)("building",t.building),Jr(1),Lo("ngIf",t.demolishMode&&t.building.isDemolishable()),Jr(1),Lo("ngIf",t.combineMode&&t.building.isCombinable()&&t.canCombine()),Jr(1),Lo("ngIf",t.splitMode&&t.building.isSplittable()),Jr(1),Lo("ngIf",t.arrangeMode&&t.canMove()))},directives:[ku,Gu,mI,CI,zI,rI],styles:["@media screen and (min-width : 0px) and (max-width : 1200px){[_nghost-%COMP%]{height:125px;width:206px;border:black solid 1px;overflow:hidden}}@media screen and (min-width : 1200px) and (max-width: 1500px){[_nghost-%COMP%]{height:138px;width:227px;border:black solid 1px;overflow:hidden}}@media screen and (min-width : 1500px){[_nghost-%COMP%]{height:150px;width:247px;border:black solid 1px;overflow:hidden}}#wrapper[_ngcontent-%COMP%]{position:relative;height:100%;text-align:center;font-size:.7em;overflow:hidden}.usedUp[_ngcontent-%COMP%]{background-color:#7e7a7999}#demolish[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}#demolishText[_ngcontent-%COMP%]{display:block}#combine[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}#split[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}#arrange[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}.combineText[_ngcontent-%COMP%]{display:block}#nameBar[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;height:24px;font-size:1.4em;font-weight:bold;border-bottom:black solid 1px;white-space:nowrap}#left[_ngcontent-%COMP%]{flex:1 0 24px}#center[_ngcontent-%COMP%]{flex:1 0 152px;font-size:.8em;overflow:hidden;line-height:24px}#right[_ngcontent-%COMP%]{flex:1 0 24px}.control[_ngcontent-%COMP%]{float:right;font-size:.6em;margin-right:2px;cursor:pointer}.control[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px}#lines[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column}app-progress-bar[_ngcontent-%COMP%]{display:block;height:18px}app-building-line[_ngcontent-%COMP%]{height:20px;display:block;margin-top:3px;flex:1 0 auto}img[_ngcontent-%COMP%]{height:24px}.details[_ngcontent-%COMP%]{float:left;font-size:.75em;margin-right:2px}.positiveEffects[_ngcontent-%COMP%]{font-size:.7em;color:var(--positive-colour)}.negativeEffects[_ngcontent-%COMP%]{font-size:.7em;color:var(--negative-colour)}.tooltipSpan[_ngcontent-%COMP%]{font-size:1.5em;font-weight:100;text-align:left}.tooltipSpan[_ngcontent-%COMP%]   #title[_ngcontent-%COMP%]{text-align:center}.tooltipSpan[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border-color:#000}app-building-buff[_ngcontent-%COMP%]{position:absolute;right:0;top:0}app-building-upgrade[_ngcontent-%COMP%]{position:absolute;left:-2px;top:0}"]}),e})();function ub(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Demolish"),ko()}}function hb(e,t){if(1&e){const e=Go();xo(0,"button",23),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Stop"),ko()}}function db(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Arrange"),ko()}}function gb(e,t){if(1&e){const e=Go();xo(0,"button",23),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Stop"),ko()}}function pb(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Combine"),ko()}}function fb(e,t){if(1&e){const e=Go();xo(0,"button",23),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Stop"),ko()}}function mb(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Split"),ko()}}function Sb(e,t){if(1&e){const e=Go();xo(0,"button",23),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Stop"),ko()}}function Eb(e,t){if(1&e&&(xo(0,"option",13),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("value",e),Jr(1),ra(i.getBuildingName(e))}}function vb(e,t){1&e&&(Uo(0),Fo(1,"img",28),Ho())}function Rb(e,t){if(1&e&&(xo(0,"div"),sa(1),Fc(2,"number"),Po(3,vb,2,0,"ng-container",27),ko()),2&e){const e=t.$implicit,i=t.index,s=Ko(2);Jr(1),aa(" ",i+1,". ",s.getSicknessName(e.sickness)," ",Hc(2,4,e.progress,"0.0-0"),"% "),Jr(2),Lo("ngIf",e.medicine>0)}}function Ob(e,t){if(1&e&&(xo(0,"span",24),Fo(1,"app-icon",17),sa(2),xo(3,"span",25),sa(4),Fo(5,"hr"),Po(6,Rb,4,7,"div",26),ko(),sa(7," \xa0\xa0\xa0 "),ko()),2&e){const e=Ko();Lo("elementId","sick"),Jr(1),Lo("name","sick")("title","")("margin","0 0 0 2px"),Jr(1),na(" ",e.getSick().length," "),Jr(2),na(" Sick: ",e.getSick().length," "),Jr(2),Lo("ngForOf",e.getSick())}}function Tb(e,t){if(1&e&&(xo(0,"span",33),Fo(1,"app-building",34),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.villageService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function Ib(e,t){if(1&e&&(xo(0,"div",29),xo(1,"div",30),xo(2,"span"),sa(3,"Buildings"),ko(),ko(),xo(4,"div",31),Po(5,Tb,2,6,"span",32),ko(),ko()),2&e){const e=Ko();Jr(5),Lo("ngForOf",e.getBuildings())}}const bb=function(e){return{activePage:e}};function Cb(e,t){if(1&e){const e=Go();xo(0,"span",37),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).setPage(t)}),sa(1),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(2,bb,i.currentPage===e)),Jr(1),na("page ",e+1,"")}}function yb(e,t){if(1&e&&(xo(0,"span",33),Fo(1,"app-building",34),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.villageService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function Ab(e,t){if(1&e&&(xo(0,"div",29),xo(1,"div",35),Po(2,Cb,2,4,"span",36),ko(),xo(3,"div",31),Po(4,yb,2,6,"span",32),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getPagesNumber()),Jr(2),Lo("ngForOf",e.getPagedBuildings())}}const Nb=function(e){return{pointer:e}};let _b=(()=>{class e extends gv{constructor(e,t,i,s,r,n,o,a,c,l){super(e,t,i,s,a,n,c,Kf.VILLAGE),this.landService=t,this.villageService=s,this.resourcesService=r,this.managementService=o,this.router=l}getPopulation(){return this.villageService.getPopulation()}getPopulationCap(){return this.villageService.getPopulationCap()}getTakenLand(){return this.landService.getTakenLand()}getSick(){return this.resourcesService.getSick()}getSicknessName(e){return Qf.prepareSicknessName(e)}openHappinessManagement(){this.isManagementUnlocked()&&this.router.navigate(["/management/happiness"])}isManagementUnlocked(){return this.gameService.isEnabled(Mf.MANAGEMENT)}workshopsResearch(){this.villageService.getBuildings().filter(e=>e.getBuildingType()===Lf.WORKSHOP).forEach(e=>e.switchToResearch()),this.modalService.info("Workshops switched to researching")}workshopsCraft(){this.villageService.getBuildings().filter(e=>e.getBuildingType()===Lf.WORKSHOP).forEach(e=>e.switchToCrafting()),this.modalService.info("Workshops switched to crafting")}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(wO),Mo(Pv),Mo(vS),Mo(PO),Mo(yS),Mo(nc),Mo(af))},e.\u0275cmp=Ve({type:e,selectors:[["app-village"]],features:[fo],decls:60,vars:34,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name"],[3,"name","title","margin"],["class","icon tooltip","appTooltip","",3,"elementId",4,"ngIf"],[3,"name","title"],[3,"ngClass","click"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],["appTooltip","",1,"icon","tooltip",3,"elementId"],["id","sick"],[4,"ngFor","ngForOf"],[4,"ngIf"],["src","assets/resources/herbal_medicine.svg","alt","",1,"herbal"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"button",4),Vo("click",function(){return t.openBuildModal()}),sa(6,"Build"),ko(),Po(7,ub,2,0,"button",5),Po(8,hb,2,0,"button",6),Po(9,db,2,0,"button",5),Po(10,gb,2,0,"button",6),Po(11,pb,2,0,"button",5),Po(12,fb,2,0,"button",6),Po(13,mb,2,0,"button",5),Po(14,Sb,2,0,"button",6),xo(15,"button",7),sa(16,"Actions "),Fo(17,"img",8),xo(18,"ul",9),xo(19,"li",4),Vo("click",function(){return t.autoSort()}),sa(20,"Sort"),ko(),xo(21,"li",4),Vo("click",function(){return t.autoMerge()}),sa(22,"Merge"),ko(),xo(23,"li",4),Vo("click",function(){return t.workshopsResearch()}),sa(24,"Workshops research"),ko(),xo(25,"li",4),Vo("click",function(){return t.workshopsCraft()}),sa(26,"Workshops craft"),ko(),ko(),ko(),xo(27,"div",10),sa(28," Filter:"),Fo(29,"br"),xo(30,"div",11),xo(31,"select",12),Vo("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),xo(32,"option",13),sa(33),ko(),Po(34,Eb,2,2,"option",14),ko(),xo(35,"select",12),Vo("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),xo(36,"option",13),sa(37,"All"),ko(),xo(38,"option",13),sa(39,"Working"),ko(),xo(40,"option",13),sa(41,"Idle"),ko(),ko(),ko(),ko(),ko(),xo(42,"div",15),Fo(43,"app-icon",16),sa(44),Fo(45,"app-icon",17),sa(46),Po(47,Ob,8,7,"span",18),Fo(48,"app-icon",16),sa(49),Fo(50,"app-icon",19),sa(51),xo(52,"app-happiness",20),Vo("click",function(){return t.openHappinessManagement()}),ko(),xo(53,"div",21),xo(54,"button",4),Vo("click",function(){return t.enableAll()}),sa(55,"all on"),ko(),xo(56,"button",4),Vo("click",function(){return t.disableAll()}),sa(57,"all off"),ko(),ko(),ko(),Po(58,Ib,6,1,"div",22),Po(59,Ab,5,2,"div",22),ko(),ko()),2&e&&(Jr(7),Lo("ngIf",!t.demolishMode),Jr(1),Lo("ngIf",t.demolishMode),Jr(1),Lo("ngIf",!t.arrangeMode&&t.getBuildings().length>1),Jr(1),Lo("ngIf",t.arrangeMode),Jr(1),Lo("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),Jr(1),Lo("ngIf",t.combineMode),Jr(1),Lo("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),Jr(1),Lo("ngIf",t.splitMode),Jr(17),Lo("ngModel",t.filterBuilding),Jr(1),Lo("value",t.allBuildings),Jr(1),ra(t.getBuildingName(t.allBuildings)),Jr(1),Lo("ngForOf",t.getUniqueBuildingsFromCurrentView()),Jr(1),Lo("ngModel",t.filterWorking),Jr(1),Lo("value",t.buildingStates.ALL),Jr(2),Lo("value",t.buildingStates.WORKING),Jr(2),Lo("value",t.buildingStates.IDLE),Jr(3),Lo("name","population"),Jr(1),oa(" ",t.getPopulation(),"/",t.getPopulationCap()," \xa0\xa0 "),Jr(1),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na(" ",t.getUnemployed()," \xa0\xa0\xa0 "),Jr(1),Lo("ngIf",t.getSick().length>0),Jr(1),Lo("name","land"),Jr(1),na(" ",t.getFreeLand()," \xa0\xa0\xa0 "),Jr(1),Lo("name","village")("title","Village size"),Jr(1),na("\xa0",t.getTakenLand()," \xa0\xa0\xa0 "),Jr(1),Lo("ngClass",Mc(32,Nb,t.isManagementUnlocked())),Jr(6),Lo("ngIf",!t.isPagedViewEnabled()),Jr(1),Lo("ngIf",t.isPagedViewEnabled()))},directives:[FO,Gu,VT,dT,MT,zT,$T,Uu,sI,hI,ku,rI,lb],pipes:[Zu],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",".herbal[_ngcontent-%COMP%]{height:16px}.pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e})();function wb(e,t){if(1&e){const e=Go();xo(0,"button",30),Vo("click",function(t){Dt(e);const i=Ko(2).$implicit;return Ko(2).addDevRes(i.resource,t)}),sa(1,"+"),ko()}}function Pb(e,t){if(1&e&&(Uo(0,31),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),oa("",e.getAmount(),"/",e.getLimit(),"")}}function Mb(e,t){if(1&e&&(Uo(0,32),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),oa("",e.getAmount(),"/",e.getLimit(),"")}}function Lb(e,t){if(1&e&&(Uo(0,32),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),ra(e.getAmount())}}const Db=function(e){return{greyout:e}};function xb(e,t){if(1&e){const e=Go();xo(0,"span"),xo(1,"span",33),Vo("click",function(){Dt(e);const t=Ko(2).$implicit;return t.prioritise=!t.prioritise}),Fo(2,"img",34),ko(),ko()}if(2&e){const e=Ko(2).$implicit;Jr(1),Lo("ngClass",Mc(1,Db,!e.prioritise))}}function kb(e,t){if(1&e){const e=Go();xo(0,"div",14),xo(1,"span",15),xo(2,"span",16),xo(3,"span",17),xo(4,"div",18),sa(5),ko(),Fo(6,"div",19),Fo(7,"div",19),ko(),Fo(8,"app-icon",20),ko(),Po(9,wb,2,0,"button",21),Po(10,Pb,2,2,"ng-container",22),Po(11,Mb,2,2,"ng-container",23),Po(12,Lb,2,1,"ng-container",23),ko(),xo(13,"span",24),xo(14,"span",25),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko(2).openManageModal(t)}),Fo(15,"img",26),ko(),Po(16,xb,3,3,"span",27),xo(17,"span",28),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko(2).highlightResource(t)}),Fo(18,"img",29),ko(),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko(2);Jr(2),Lo("elementId",e.resource),Jr(1),$o("id",e.resource),Jr(2),ra(e.name),Jr(1),Lo("innerHTML",t.getResourceDescription(e),Js),Jr(1),Lo("innerHTML",t.getResourceConsumers(e),Js),Jr(1),Lo("name",e.getName())("path","resources")("title",""),Jr(1),Lo("ngIf",t.isDev()),Jr(1),Lo("ngIf",e.getAmount()===e.getLimit()),Jr(1),Lo("ngIf",t.isNotCoins(e)&&e.getAmount()!==e.getLimit()),Jr(1),Lo("ngIf",!t.isNotCoins(e)),Jr(2),Lo("ngClass",Mc(15,Db,!e.options.isUsed())),Jr(2),Lo("ngIf",t.isMarketEnabled()),Jr(1),Lo("ngClass",Mc(17,Db,!e.highlighted))}}function Fb(e,t){if(1&e&&(xo(0,"div"),Po(1,kb,19,19,"div",13),ko()),2&e){const e=t.$implicit;Jr(1),Lo("ngIf",e.visible)}}function Ub(e,t){if(1&e&&(xo(0,"div",10),xo(1,"span",11),sa(2),ko(),Po(3,Fb,2,1,"div",12),ko()),2&e){const e=t.$implicit,i=Ko();Jr(2),ra(e),Jr(1),Lo("ngForOf",i.getResourcesList(e))}}let Hb=(()=>{class e{constructor(e,t,i,s){this.resourcesService=e,this.modalService=t,this.tutorialService=i,this.gameService=s,this.filterText=""}ngOnInit(){this.categories=Object.keys(Gf),this.categories=[Gf[Gf.RAW],Gf[Gf.PROCESSED],Gf[Gf.FOOD],Gf[Gf.TOOLS]],this.resources=this.resourcesService.getResources(),this.resourcesService.registerForResourcesChange().subscribe(e=>{this.resources=e}),this.tutorialService.checkResourcesTutorial()}getResourcesList(e){return Array.from(this.resourcesService.getResources().entries()).filter(t=>t[1].getResourceTypes().includes(Gf[e])&&Qf.prepareResourceName(t[1].getResource()).toLowerCase().includes(this.filterText)).filter(e=>!this.resourcesService.getHideEmpty()||0!==e[1].amount||!!this.resourcesService.getResourceProductions(e[0])&&!!this.resourcesService.getResourceUses(e[0])).map(e=>e[1])}openManageModal(e){this.modalService.open(Pf.RESOURCE_MANAGEMENT),this.modalService.setResourceOptions(e.options);const t=this.modalService.registerForResourceOptionsResponse().subscribe(i=>{t.unsubscribe(),i&&(e.options=i)})}isMarketEnabled(){return this.gameService.isEnabled(Mf.MARKET)}highlightResource(e){e.highlighted?e.highlighted=!1:(Array.from(this.resourcesService.getResources().values()).filter(e=>e.highlighted),e.highlighted=!0)}isNotCoins(e){return e.resource!==Df.COINS}isDev(){return!Am.production}addDevRes(e,t){this.resourcesService.increaseResource(e,e===Df.COINS?1e3:t.shiftKey?200:5,"Dev",!0)}getResourceDescription(e){let t="";return e.hasResourceType(Gf.CONSUMABLE)&&(t+="nutrition: "+oS.getResource(e.resource).POWER),e.hasResourceType(Gf.FUEL)&&(t+="heating energy: "+oS.getResource(e.resource).POWER),""!==t?"<hr>"+t:t}getResourceConsumers(e){let t="",i="<b>used by:</b><br>";const s=this.resourcesService.getResourceUses(e.resource),r=[];s&&(s.slice().forEach(e=>{const t=r.find(t=>t[0]===e.userName);t?t[1]+=e.value:r.push([e.userName,e.value])}),r.sort((e,t)=>e[0].localeCompare(t[0])).forEach(e=>{i+=e[0]+": "+e[1]+"<br>"})),"<b>used by:</b><br>"!==i&&(t+="<hr>"+i),i="<b>produced by:</b><br>";const n=this.resourcesService.getResourceProductions(e.resource),o=[];return n&&(n.slice().forEach(e=>{const t=o.find(t=>t[0]===e.producerName);t?t[1]+=e.value:o.push([e.producerName,e.value])}),o.sort((e,t)=>e[0].localeCompare(t[0])).forEach(e=>{i+=e[0]+": "+e[1]+"<br>"})),"<b>produced by:</b><br>"!==i&&(t+="<hr>"+i),t}}return e.\u0275fac=function(t){return new(t||e)(Mo(Pv),Mo(em),Mo(yS),Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-resources"]],decls:14,vars:3,consts:[["id","wrapper"],["id","resourcesTitle"],[1,"side"],["id","center"],[1,"inline"],["for","hideEmpty"],["id","hideEmpty","type","checkbox",3,"checked","change"],["type","text","placeholder","filter",3,"ngModel","ngModelChange"],["id","categories"],["class","category",4,"ngFor","ngForOf"],[1,"category"],[1,"title"],[4,"ngFor","ngForOf"],["class","resource",4,"ngIf"],[1,"resource"],[1,"icon"],["appTooltip","",1,"tooltip",3,"elementId"],[3,"id"],[1,"center"],[1,"center",3,"innerHTML"],[3,"name","path","title"],[3,"click",4,"ngIf"],["class","text","class","full",4,"ngIf"],["class","text",4,"ngIf"],[1,"highlight"],[1,"manage",3,"ngClass","click"],["draggable","false","title","management","ondragstart","return false;","src","assets/manage.svg"],[4,"ngIf"],[3,"ngClass","click"],["draggable","false","ondragstart","return false;","src","assets/eye.svg","title","add to header"],[3,"click"],[1,"full"],[1,"text"],[1,"prioritise",3,"ngClass","click"],["draggable","false","ondragstart","return false;","src","assets/trade.svg","title","prioritise on market"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"span",1),Fo(2,"span",2),xo(3,"span",3),sa(4,"Resources"),ko(),xo(5,"span",2),xo(6,"span",4),xo(7,"label",5),sa(8,"hide empty"),ko(),xo(9,"input",6),Vo("change",function(){return t.resourcesService.toggleHideEmpty()}),ko(),ko(),xo(10,"span",4),xo(11,"input",7),Vo("ngModelChange",function(e){return t.filterText=e}),ko(),ko(),ko(),ko(),xo(12,"div",8),Po(13,Ub,4,2,"div",9),ko(),ko()),2&e&&(Jr(9),Lo("checked",t.resourcesService.getHideEmpty()),Jr(2),Lo("ngModel",t.filterText),Jr(2),Lo("ngForOf",t.categories))},directives:[KO,dT,MT,Uu,Gu,rI,sI,ku],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em;margin:.7%;text-align:center}#resourcesTitle[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-size:1.3em;font-weight:bolder;vertical-align:middle}#center[_ngcontent-%COMP%]{flex:10 0 auto}.side[_ngcontent-%COMP%]{flex:0 0 38%;flex-direction:row;font-size:.6em;width:15%;margin:3px;display:inline-block}#categories[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:94.8%;text-align:center}.category[_ngcontent-%COMP%]{text-align:left;flex:1 0 0;display:flex;flex-direction:column;border:black solid 1px}.resource[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-left:3px;width:100%;vertical-align:middle;margin-top:-1px}.title[_ngcontent-%COMP%]{text-align:center;padding:2px 0;width:100%;font-weight:bolder;font-size:1em;margin-bottom:5px;display:block;border-bottom:black solid 1px}.highlight[_ngcontent-%COMP%]{flex:1 0 auto;text-align:right;margin-right:3px}.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer}app-icon[_ngcontent-%COMP%]{flex:0 0 auto;margin-right:3px}.manage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:22px;width:22px}.greyout[_ngcontent-%COMP%]{opacity:.3}.prioritise[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:22px;width:22px}.full[_ngcontent-%COMP%]{font-weight:600}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}hr[_ngcontent-%COMP%]{border-color:#000}.center[_ngcontent-%COMP%]{text-align:center}"]}),e})();class Gb{constructor(e,t,i,s,r,n,o,a,c=function(){},l=0){this.tech=e,this.category=t,this.prerequisites=i,this.flagPrerequisites=s,this.cost=r,this.requiredResearchPoints=n,this.description=o,this.finishDescription=a,this.researchPoints=l,this.finishFunction=c}getTech(){return this.tech}getTechName(){return Qf.prepareTechName(this.tech)}isResearched(){return this.researchPoints>=this.requiredResearchPoints&&(this.researchPoints=this.requiredResearchPoints),this.researchPoints===this.requiredResearchPoints}getCategory(){return this.category}getDescription(){return this.description}getResearchPointsDue(){return this.requiredResearchPoints-this.researchPoints}addResearchPoints(e){this.researchPoints+=e,this.researchPoints>this.requiredResearchPoints&&(this.researchPoints=this.requiredResearchPoints)}getResearchPoints(){return this.researchPoints}setResearchPoints(e){this.researchPoints=e}setResearched(){this.researchPoints=this.requiredResearchPoints}getCost(){return this.cost}clearCost(){this.cost=new Map}getPrerequisites(){return this.prerequisites}getFlagPrerequisites(){return this.flagPrerequisites}getFinishFunction(){return this.finishFunction}getRequiredResearchPoints(){return this.requiredResearchPoints}getFinishDescription(){return this.finishDescription}}class Bb{constructor(){this.prerequisites=[],this.flagPrerequisites=[],this.cost=new Map,this.researchPoints=0,this.finishFunction=function(){}}forTech(e){return this.tech=e,this}withCategory(e){return this.category=e,this}withPrerequisite(e){return this.prerequisites.push(e),this}withPrerequisites(e){return e.forEach(e=>this.prerequisites.push(e)),this}withFlagPrerequisite(e){return this.flagPrerequisites.push(e),this}withFlagPrerequisites(e){return e.forEach(e=>this.flagPrerequisites.push(e)),this}withCost(e,t){return this.cost.set(e,t),this}withCosts(e){return e.forEach((e,t)=>this.cost.set(t,e)),this}withResearchPoints(e){return this.researchPoints=e,this}withDescription(e){return this.description=e,this}withFinishDescription(e){return this.finishDescription=e,this}withFinishFunction(e){return this.finishFunction=e,this}build(){const e=new Gb(this.tech,this.category,this.prerequisites,this.flagPrerequisites,this.cost,this.researchPoints,this.description,this.finishDescription,this.finishFunction);return this.tech=void 0,this.category=void 0,this.prerequisites=[],this.flagPrerequisites=[],this.cost=new Map,this.researchPoints=0,this.description=void 0,this.finishDescription=void 0,this.finishFunction=function(){},e}}let Wb=(()=>{class e{constructor(e,t,i,s,r,n){this.servicesService=e,this.modalService=t,this.resourcesService=i,this.logService=s,this.soundService=r,this.gameService=n,this.techUpdate=new b,this.techList=[],this.techDone=[],this.techQueue=[],this.techStarted=[],this.techQueueSize=1,this.foresight=0,this.showDone=!1,this.servicesService.addService(Zf.RESEARCH,this),this.init()}init(){this.techList=[];const e=new Bb;Object.entries(lS).forEach(t=>{e.forTech(kf[t[0]]).withCategory(t[1].CATEGORY).withFinishFunction(t[1].FINISH).withResearchPoints(t[1].RESEARCH_POINT).withPrerequisites(t[1].PREREQUISITES).withFlagPrerequisites(t[1].FLAG_PREREQUISITES?t[1].FLAG_PREREQUISITES:[]).withDescription(t[1].DESCRIPTION).withFinishDescription(t[1].FINISH_DESCRIPTION),t[1].COST.forEach(t=>e.withCost(t.resource,t.amount)),this.techList.push(e.build())})}isResearched(e){return null!=this.techDone.find(t=>t===e)}startResearch(e){if(this.techQueue.find(t=>t.getTech()===e))return;const t=this.techList.find(t=>t.getTech()===e);let i=!0,s="";if(t.getPrerequisites().forEach(e=>{!this.techDone.includes(e)&&!this.techQueue.find(t=>t.getTech()===e)&&(i=!1,s+=Qf.prepareTechName(e)+" not researched!<br>")}),t.getFlagPrerequisites().forEach(e=>{this.gameService.isEnabled(e)||(i=!1,s+=Qf.prepareFlagName(e)+" not unlocked!<br>")}),!i)return void this.modalService.info(s);this.modalService.open(Pf.RESEARCH_UNLOCK),this.modalService.setTech(this.techList.find(t=>t.getTech()===e));const r=this.modalService.registerForConfirmation().subscribe(t=>{if(r.unsubscribe(),t){const t=this.techList.find(t=>t.getTech()===e);if(!this.techStarted.find(t=>t[0]===e)){let e=!0,i="";if(Array.from(t.getCost().entries()).forEach(t=>{const s=this.resourcesService.hasResource(t[0],t[1],"Research",!0);0!==s&&(i+="Missing "+s+" "+Qf.prepareResourceName(t[0])+"!<br>",e=!1)}),!e)return void this.modalService.info(i)}let i=!0,s="";if(Array.from(t.getCost().entries()).forEach(e=>{const t=this.resourcesService.hasResource(e[0],e[1],"Research",!0);0!==t&&(s+="Missing "+t+" "+Qf.prepareResourceName(e[0])+"!<br>",i=!1)}),!i)return void this.modalService.info(s);this.resourcesService.decreaseResources(t.getCost(),"Research",!0);const r=this.techList.find(t=>t.getTech()===e);r.clearCost(),this.techStarted.find(e=>e[0]===r.getTech())||this.techStarted.push([r.getTech(),r.getResearchPoints()]),this.techQueue.push(r)}})}progressTech(e){this.techQueue.length>0&&(this.techQueue[0].addResearchPoints(e),this.techQueue[0].isResearched()&&(this.logService.log(this.techQueue[0].getTechName()+" researched"),this.soundService.playResearch(),this.techQueue[0].getFinishFunction()(this.servicesService),this.techDone.push(this.techQueue[0].getTech()),this.techStarted=this.techStarted.filter(e=>e[0]!==this.techQueue[0].getTech()),this.techQueue.shift()),this.techUpdate.next())}save(){const e=[];return this.techQueue.forEach(t=>{e.push(t.getTech());const i=this.techStarted.find(e=>e[0]===t.getTech());i&&(i[1]=t.getResearchPoints())}),{foresight:this.foresight,showDone:this.showDone,techDone:this.techDone,techStarted:this.techStarted,techQueue:e,techQueueSize:this.techQueueSize}}getName(){return"TechService"}load(e){this.init(),this.foresight=e.foresight,this.showDone=void 0!==e.showDone&&e.showDone,this.techDone=e.techDone,this.techStarted=e.techStarted,this.techQueueSize=void 0!==e.techQueueSize?e.techQueueSize:1,this.techDone.forEach(e=>{const t=this.techList.find(t=>t.getTech()===e);t&&t.setResearched()}),this.techStarted.forEach(e=>{const t=this.techList.find(t=>t.getTech()===e[0]);t&&(t.clearCost(),t.setResearchPoints(e[1]))}),this.techQueue=[],e.techQueue?e.techQueue.forEach(e=>{this.techQueue.push(this.techList.find(t=>t.getTech()===e))}):e.currentResearchTech&&this.techQueue.push(this.techList.find(t=>t.getTech()===e.currentResearchTech)),this.techDone.includes(kf.BARRACKS)&&!this.gameService.isEnabled(Mf.BARRACKS)&&(this.gameService.enable(Mf.BARRACKS),this.logService.log("Barracks invented")),this.techDone.includes(kf.COPPER_TOOLS)&&this.servicesService.getRecipeService().enable(sm.COPPER_NAILS),this.techDone.includes(kf.BRONZE_TOOLS)&&this.servicesService.getRecipeService().enable(sm.BRONZE_NAILS),this.techDone.includes(kf.IRON_TOOLS)&&this.servicesService.getRecipeService().enable(sm.IRON_NAILS)}reset(e,t){this.techList=[],this.techDone=[],this.techStarted=[],this.techQueue=[],this.techQueueSize=1,this.foresight=0,this.showDone=!1,this.init()}getTech(){return this.techList.filter(e=>{if(this.techDone.includes(e.getTech()))return this.showDone;let t=!0;return e.getPrerequisites().forEach(e=>{this.checkPrerequisite(e,this.foresight)||(t=!1)}),t})}checkPrerequisite(e,t){if(this.techDone.includes(e))return!0;if(t>0){let i=!0;return this.techList.find(t=>t.getTech()===e).getPrerequisites().forEach(e=>{this.checkPrerequisite(e,t-1)||(i=!1)}),i}return!1}getCurrentResearch(){return this.techQueue.length>0?this.techQueue[0]:null}increaseForesight(e){this.foresight+=e}isResearchStarted(){return this.techQueue.length>0}getTechPrerequisites(e){const t=[];return e.getPrerequisites().forEach(e=>{this.techDone.includes(e)||t.push(e)}),t}registerForUpdate(){return this.techUpdate.asObservable()}getForesight(){return this.foresight}getTechFlagPrerequisites(e){const t=[];return e.getFlagPrerequisites().forEach(e=>{this.gameService.isEnabled(e)||t.push(e)}),t}finishTech(e){this.techDone.push(e);const t=this.techList.find(t=>t.getTech()===e);t&&(this.logService.log(t.getTechName()+" researched"),t.setResearchPoints(t.getRequiredResearchPoints()),t.getFinishFunction()(this.servicesService)),this.techQueue=this.techQueue.filter(t=>t.getTech()!==e),this.techUpdate.next()}toggleShowDone(){this.showDone=!this.showDone}shouldShowDone(){return this.showDone}getTechQueue(){return this.techQueue}removeFromQueue(e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Remove research from the queue?");const t=this.modalService.registerForConfirmation().subscribe(i=>{if(t.unsubscribe(),i){const t=this.techStarted.find(t=>t[0]===e.getTech());t?t[1]=e.getResearchPoints():this.techStarted.push([e.getTech(),e.getResearchPoints()]),this.techQueue.splice(this.techQueue.indexOf(e),1);let i=null;do{i&&(this.techQueue.splice(this.techQueue.indexOf(i),1),i=null),this.techQueue.forEach(e=>{if(null===i){const t=this.techList.find(t=>t.getTech()===e.getTech());let s=!0;t.getPrerequisites().forEach(e=>{!this.techDone.includes(e)&&!this.techQueue.find(t=>t.getTech()===e)&&(s=!1)}),t.getFlagPrerequisites().forEach(e=>{this.gameService.isEnabled(e)||(s=!1)}),s||(i=e)}})}while(null!==i)}})}increaseTechQueueSize(){this.techQueueSize+=1}getTechQueueSize(){return this.techQueueSize}hasQueueSpace(){return this.getTechQueue().length<this.techQueueSize+this.foresight}getTechDone(){return this.techDone}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(em),gs(Pv),gs(IS),gs(RS),gs(AS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Vb=["progress"];function zb(e,t){if(1&e&&(xo(0,"div",3),Fo(1,"div",4,5),xo(3,"div",6),sa(4),ko(),xo(5,"span",7),sa(6),Fo(7,"br"),ko(),ko()),2&e){const e=Ko();Lo("elementId",e.id),Jr(4),ra(e.tech.getTechName()),Jr(1),$o("id",e.id),Jr(1),na(" ",e.tech.getFinishDescription(),"")}}function Yb(e,t){1&e&&(xo(0,"div",10),sa(1,"Cost:"),Fo(2,"br"),ko())}function Kb(e,t){if(1&e&&(Uo(0),xo(1,"div"),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function jb(e,t){if(1&e&&(Uo(0),xo(1,"div",17),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function $b(e,t){if(1&e&&(xo(0,"div",14),Po(1,Kb,3,1,"ng-container",15),Po(2,jb,3,1,"ng-container",15),Fo(3,"app-icon",16),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("ngIf",i.hasResource(e)),Jr(1),Lo("ngIf",!i.hasResource(e)),Jr(1),Lo("name",i.getResourceName(e.key))("path","resources")}}function Qb(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),na(" ",i.getPrerequisiteName(e)," ")}}function qb(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),na(" ",i.getFlagPrerequisiteName(e)," ")}}function Xb(e,t){if(1&e&&(xo(0,"div",18),xo(1,"div",10),sa(2,"Prerequisites:"),Fo(3,"br"),ko(),Po(4,Qb,2,1,"div",19),Po(5,qb,2,1,"div",19),ko()),2&e){const e=Ko(2);Jr(4),Lo("ngForOf",e.getMissingPrerequisites()),Jr(1),Lo("ngForOf",e.getMissingFlagPrerequisites())}}function Zb(e,t){if(1&e){const e=Go();xo(0,"div",8),Vo("click",function(){return Dt(e),Ko().start()}),Fo(1,"div",9,5),xo(3,"div",6),sa(4),ko(),xo(5,"span",7),sa(6),Fo(7,"br"),Fo(8,"hr"),xo(9,"div",10),sa(10),ko(),Po(11,Yb,3,0,"div",11),Po(12,$b,4,4,"div",12),Fc(13,"keyvalue"),Po(14,Xb,6,2,"div",13),ko(),ko()}if(2&e){const e=Ko();Lo("elementId",e.id),Jr(4),ra(e.tech.getTechName()),Jr(1),$o("id",e.id),Jr(1),na(" ",e.tech.getDescription(),""),Jr(4),oa("Research points: ",e.tech.getResearchPoints(),"/",e.tech.getRequiredResearchPoints(),""),Jr(1),Lo("ngIf",e.tech.getCost().size>0),Jr(1),Lo("ngForOf",Uc(13,9,e.tech.getCost())),Jr(2),Lo("ngIf",e.getMissingPrerequisites().length>0||e.getMissingFlagPrerequisites().length>0)}}function Jb(e,t){1&e&&(xo(0,"div",10),sa(1,"Cost:"),Fo(2,"br"),ko())}function eC(e,t){if(1&e&&(Uo(0),xo(1,"div"),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function tC(e,t){if(1&e&&(Uo(0),xo(1,"div",17),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function iC(e,t){if(1&e&&(xo(0,"div",14),Po(1,eC,3,1,"ng-container",15),Po(2,tC,3,1,"ng-container",15),Fo(3,"app-icon",16),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("ngIf",i.hasResource(e)),Jr(1),Lo("ngIf",!i.hasResource(e)),Jr(1),Lo("name",i.getResourceName(e.key))("path","resources")}}function sC(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),na(" ",i.getPrerequisiteName(e)," ")}}function rC(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),na(" ",i.getFlagPrerequisiteName(e)," ")}}function nC(e,t){if(1&e&&(xo(0,"div",18),xo(1,"div",10),sa(2,"Prerequisites:"),Fo(3,"br"),ko(),Po(4,sC,2,1,"div",19),Po(5,rC,2,1,"div",19),ko()),2&e){const e=Ko(2);Jr(4),Lo("ngForOf",e.getMissingPrerequisites()),Jr(1),Lo("ngForOf",e.getMissingFlagPrerequisites())}}function oC(e,t){if(1&e){const e=Go();xo(0,"div",20),Vo("click",function(){return Dt(e),Ko().start()}),xo(1,"div",21),sa(2),ko(),xo(3,"span",7),sa(4),Fo(5,"br"),Fo(6,"hr"),xo(7,"div",10),sa(8),ko(),Po(9,Jb,3,0,"div",11),Po(10,iC,4,4,"div",12),Fc(11,"keyvalue"),Po(12,nC,6,2,"div",13),ko(),ko()}if(2&e){const e=Ko();Lo("elementId",e.id),Jr(2),ra(e.tech.getTechName()),Jr(1),$o("id",e.id),Jr(1),na(" ",e.tech.getDescription(),""),Jr(4),oa("Research points: ",e.tech.getResearchPoints(),"/",e.tech.getRequiredResearchPoints(),""),Jr(1),Lo("ngIf",e.tech.getCost().size>0),Jr(1),Lo("ngForOf",Uc(11,9,e.tech.getCost())),Jr(2),Lo("ngIf",e.getMissingPrerequisites().length>0||e.getMissingFlagPrerequisites().length>0)}}let aC=(()=>{class e{constructor(t,i){this.techService=t,this.resourcesService=i,this.id=e.randomId()}static randomId(){return Math.random()}ngOnDestroy(){this.updateSubscription&&this.updateSubscription.unsubscribe()}ngOnInit(){this.updateSubscription=this.techService.registerForUpdate().subscribe(()=>{this.progressRef&&(this.progressRef.nativeElement.style.width=this.tech.getResearchPoints()/this.tech.getRequiredResearchPoints()*100+"%")})}ngAfterViewInit(){this.progressRef&&(this.progressRef.nativeElement.style.width=this.tech.getResearchPoints()/this.tech.getRequiredResearchPoints()*100+"%")}ngOnChanges(){this.progressRef&&(this.progressRef.nativeElement.style.width=this.tech.getResearchPoints()/this.tech.getRequiredResearchPoints()*100+"%")}getResourceName(e){return Qf.prepareResourceName(e)}start(){this.techService.startResearch(this.tech.getTech())}getPrerequisiteName(e){return Qf.prepareTechName(e)}getMissingPrerequisites(){return this.techService.getTechPrerequisites(this.tech)}hasResource(e){return 0===this.resourcesService.hasResource(e.key,e.value,"Research",!0)}getMissingFlagPrerequisites(){return this.techService.getTechFlagPrerequisites(this.tech)}getFlagPrerequisiteName(e){return Qf.prepareFlagName(e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(Wb),Mo(Pv))},e.\u0275cmp=Ve({type:e,selectors:[["app-tech"]],viewQuery:function(e,t){if(1&e&&il(Vb,5),2&e){let e;tl(e=rl())&&(t.progressRef=e.first)}},inputs:{tech:"tech"},features:[ct],decls:3,vars:3,consts:[["id","researched","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapper","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","researched","appTooltip","",1,"tooltip",3,"elementId"],["id","finished"],["progress",""],["id","text"],[3,"id"],["id","wrapper","appTooltip","",1,"tooltip",3,"elementId","click"],["id","progress"],[1,"title"],["class","title",4,"ngIf"],["class","icon",4,"ngFor","ngForOf"],["class","prerequisites",4,"ngIf"],[1,"icon"],[4,"ngIf"],[3,"name","path"],[1,"notMet"],[1,"prerequisites"],[4,"ngFor","ngForOf"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"elementId","click"],["id","titleGrey"]],template:function(e,t){1&e&&(Po(0,zb,8,4,"div",0),Po(1,Zb,15,11,"div",1),Po(2,oC,13,11,"div",2)),2&e&&(Lo("ngIf",t.tech.isResearched()),Jr(1),Lo("ngIf",0===t.getMissingPrerequisites().length&&!t.tech.isResearched()),Jr(1),Lo("ngIf",t.getMissingPrerequisites().length>0&&!t.tech.isResearched()))},directives:[Gu,rI,Uu,sI],pipes:[qu],styles:["#wrapper[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:black solid 1px}#researched[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;cursor:auto;cursor:initial;border:black solid 1px}#wrapperNotAvailable[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:#57575a solid 1px}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#57575a}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#finished[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e})();function cC(e,t){if(1&e){const e=Go();xo(0,"app-tech",12),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).removeFromQueue(t)}),ko()}2&e&&Lo("tech",t.$implicit)}function lC(e,t){if(1&e&&(xo(0,"span"),xo(1,"div",10),Po(2,cC,1,1,"app-tech",11),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getTechQueue())}}function uC(e,t){1&e&&(xo(0,"span"),sa(1,"nothing"),ko())}function hC(e,t){if(1&e){const e=Go();xo(0,"button",13),Vo("click",function(){return Dt(e),Ko().research(10)}),sa(1,"Research"),ko()}}function dC(e,t){1&e&&(xo(0,"span",14),sa(1,"No workshop set to research."),ko())}function gC(e,t){if(1&e){const e=Go();xo(0,"button",15),Vo("click",function(){return Dt(e),Ko().showDone()}),sa(1,"show finished"),ko()}}function pC(e,t){if(1&e){const e=Go();xo(0,"button",15),Vo("click",function(){return Dt(e),Ko().showDone()}),sa(1,"hide finished"),ko()}}function fC(e,t){1&e&&Fo(0,"app-tech",20),2&e&&Lo("tech",t.$implicit)}function mC(e,t){if(1&e&&(xo(0,"div",16),xo(1,"span",17),sa(2),ko(),xo(3,"span",18),Po(4,fC,1,1,"app-tech",19),ko(),ko()),2&e){const e=t.$implicit,i=Ko();Jr(2),ra(e),Jr(2),Lo("ngForOf",i.getTechList(e))}}let SC=(()=>{class e{constructor(e,t){this.techService=e,this.villageService=t}ngOnInit(){this.categories=Object.keys(rm),this.categories=this.categories.slice(this.categories.length/2)}getTechList(e){return this.techService.getTech().filter(t=>t.getCategory()===rm[e])}getCurrentResearch(){return this.techService.getCurrentResearch()}research(e){this.techService.progressTech(e)}isDev(){return!Am.production}getForesight(){return this.techService.getForesight()}isResearcher(){return this.villageService.getBuildings().filter(e=>e.getBuildingType()===Lf.WORKSHOP).map(e=>e).filter(e=>e.willResearch()).length>0}shouldShowDone(){return this.techService.shouldShowDone()}showDone(){this.techService.toggleShowDone()}getTechQueue(){return this.techService.getTechQueue()}removeFromQueue(e){this.techService.removeFromQueue(e)}getTechQueueSize(){return this.techService.getTechQueueSize()}}return e.\u0275fac=function(t){return new(t||e)(Mo(Wb),Mo(wO))},e.\u0275cmp=Ve({type:e,selectors:[["app-research"]],decls:14,vars:11,consts:[["id","wrapper"],["id","researching"],[4,"ngIf"],[3,"click",4,"ngIf"],[1,"icon"],[3,"name"],["id","noResearchers",4,"ngIf"],["class","showHiddenButton",3,"click",4,"ngIf"],["id","categories"],["class","category",4,"ngFor","ngForOf"],["id","techQueue"],["class","techQueueEntry",3,"tech","click",4,"ngFor","ngForOf"],[1,"techQueueEntry",3,"tech","click"],[3,"click"],["id","noResearchers"],[1,"showHiddenButton",3,"click"],[1,"category"],[1,"title"],["id","categoryBody"],["class","tech",3,"tech",4,"ngFor","ngForOf"],[1,"tech",3,"tech"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),sa(2),Po(3,lC,3,1,"span",2),Po(4,uC,2,0,"span",2),Po(5,hC,2,0,"button",3),ko(),xo(6,"div",4),Fo(7,"app-icon",5),sa(8),Po(9,dC,2,0,"span",6),Po(10,gC,2,0,"button",7),Po(11,pC,2,0,"button",7),ko(),xo(12,"div",8),Po(13,mC,5,2,"div",9),ko(),ko()),2&e&&(Jr(2),oa(" Research queue (",t.getTechQueue().length,"/",t.getTechQueueSize()+t.getForesight(),"): \xa0 "),Jr(1),Lo("ngIf",t.getCurrentResearch()),Jr(1),Lo("ngIf",!t.getCurrentResearch()),Jr(1),Lo("ngIf",t.isDev()),Jr(2),Lo("name","foresight"),Jr(1),na("\xa0",t.getForesight()," "),Jr(1),Lo("ngIf",!t.isResearcher()),Jr(1),Lo("ngIf",!t.shouldShowDone()),Jr(1),Lo("ngIf",t.shouldShowDone()),Jr(2),Lo("ngForOf",t.categories))},directives:[Gu,sI,Uu,aC],styles:["#wrapper[_ngcontent-%COMP%]{margin:.7%;height:100%}#categories[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;border:black solid 1px;height:86%;width:100%;text-align:center}.category[_ngcontent-%COMP%]{text-align:center;flex:0 0 19.75%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}#categoryBody[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden}.title[_ngcontent-%COMP%]{padding:2px;width:100%;font-weight:bolder;font-size:1em;margin-bottom:5px;display:block;border-bottom:black solid 1px}app-tech[_ngcontent-%COMP%]{display:inline-block;margin-bottom:4px;margin-top:4px;margin-left:-4px;width:75%;font-size:.7em}#researching[_ngcontent-%COMP%]{margin-bottom:8px}#currentTech[_ngcontent-%COMP%]{display:inline-block;width:auto;margin-right:10px}.tech[_ngcontent-%COMP%]{cursor:pointer}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#noResearchers[_ngcontent-%COMP%]{margin-left:175px;color:var(--negative-colour)}.showHiddenButton[_ngcontent-%COMP%]{font-size:.8em;padding:4px;margin-left:auto}#techQueue[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row}.techQueueEntry[_ngcontent-%COMP%]{width:110px;margin-right:20px;cursor:pointer}"]}),e})(),EC=(()=>{class e extends dv{constructor(e,t,i,s,r){super(t,e,i,r,s,Kf.FOREST,Zf.FOREST)}init(){this.buildings.push(new Lv(this.servicesService,this.idService.getNextId()).build()),this.buildings.push(new Wv(this.servicesService,this.idService.getNextId()).build()),this.buildings.forEach(e=>this.landService.takeLand(e.getSize()))}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(_O),gs(Jf),gs(NO),gs(NS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function vC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Demolish"),ko()}}function RC(e,t){if(1&e){const e=Go();xo(0,"button",22),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Stop"),ko()}}function OC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Arrange"),ko()}}function TC(e,t){if(1&e){const e=Go();xo(0,"button",22),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Stop"),ko()}}function IC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Combine"),ko()}}function bC(e,t){if(1&e){const e=Go();xo(0,"button",22),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Stop"),ko()}}function CC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Split"),ko()}}function yC(e,t){if(1&e){const e=Go();xo(0,"button",22),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Stop"),ko()}}function AC(e,t){if(1&e&&(xo(0,"option",13),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("value",e),Jr(1),ra(i.getBuildingName(e))}}function NC(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko();Jr(1),ra(e.getForestSize())}}function _C(e,t){if(1&e&&(xo(0,"span",23),sa(1),ko()),2&e){const e=Ko();Jr(1),ra(e.getForestSize())}}function wC(e,t){if(1&e&&(xo(0,"span",28),Fo(1,"app-building",29),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.forestService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function PC(e,t){if(1&e&&(xo(0,"div",24),xo(1,"div",25),xo(2,"span"),sa(3,"Buildings"),ko(),ko(),xo(4,"div",26),Po(5,wC,2,6,"span",27),ko(),ko()),2&e){const e=Ko();Jr(5),Lo("ngForOf",e.getBuildings())}}const MC=function(e){return{activePage:e}};function LC(e,t){if(1&e){const e=Go();xo(0,"span",32),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).setPage(t)}),sa(1),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(2,MC,i.currentPage===e)),Jr(1),na("page ",e+1,"")}}function DC(e,t){if(1&e&&(xo(0,"span",28),Fo(1,"app-building",29),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.forestService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function xC(e,t){if(1&e&&(xo(0,"div",24),xo(1,"div",30),Po(2,LC,2,4,"span",31),ko(),xo(3,"div",26),Po(4,DC,2,6,"span",27),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getPagesNumber()),Jr(2),Lo("ngForOf",e.getPagedBuildings())}}let kC=(()=>{class e extends gv{constructor(e,t,i,s,r,n,o){super(e,t,i,r,s,n,o,Kf.FOREST),this.landService=t,this.forestService=r}getForestSize(){return this.landService.getForest()}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(yS),Mo(EC),Mo(vS),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-forest"]],features:[fo],decls:52,vars:27,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name"],[4,"ngIf"],["class","critical",4,"ngIf"],[3,"name","title","margin"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"critical"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"button",4),Vo("click",function(){return t.openBuildModal()}),sa(6,"Build"),ko(),Po(7,vC,2,0,"button",5),Po(8,RC,2,0,"button",6),Po(9,OC,2,0,"button",5),Po(10,TC,2,0,"button",6),Po(11,IC,2,0,"button",5),Po(12,bC,2,0,"button",6),Po(13,CC,2,0,"button",5),Po(14,yC,2,0,"button",6),xo(15,"button",7),sa(16,"Actions "),Fo(17,"img",8),xo(18,"ul",9),xo(19,"li",4),Vo("click",function(){return t.autoSort()}),sa(20,"Sort"),ko(),ko(),ko(),xo(21,"div",10),sa(22," Filter:"),Fo(23,"br"),xo(24,"div",11),xo(25,"select",12),Vo("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),xo(26,"option",13),sa(27),ko(),Po(28,AC,2,2,"option",14),ko(),xo(29,"select",12),Vo("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),xo(30,"option",13),sa(31,"All"),ko(),xo(32,"option",13),sa(33,"Working"),ko(),xo(34,"option",13),sa(35,"Idle"),ko(),ko(),ko(),ko(),ko(),xo(36,"div",15),Fo(37,"app-icon",16),Po(38,NC,2,1,"span",17),Po(39,_C,2,1,"span",18),sa(40," \xa0\xa0 "),Fo(41,"app-icon",19),sa(42),Fo(43,"app-icon",16),sa(44),xo(45,"div",20),xo(46,"button",4),Vo("click",function(){return t.enableAll()}),sa(47,"all on"),ko(),xo(48,"button",4),Vo("click",function(){return t.disableAll()}),sa(49,"all off"),ko(),ko(),ko(),Po(50,PC,6,1,"div",21),Po(51,xC,5,2,"div",21),ko(),ko()),2&e&&(Jr(7),Lo("ngIf",!t.demolishMode),Jr(1),Lo("ngIf",t.demolishMode),Jr(1),Lo("ngIf",!t.arrangeMode),Jr(1),Lo("ngIf",t.arrangeMode),Jr(1),Lo("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),Jr(1),Lo("ngIf",t.combineMode),Jr(1),Lo("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),Jr(1),Lo("ngIf",t.splitMode),Jr(11),Lo("ngModel",t.filterBuilding),Jr(1),Lo("value",t.allBuildings),Jr(1),ra(t.getBuildingName(t.allBuildings)),Jr(1),Lo("ngForOf",t.getUniqueBuildingsFromCurrentView()),Jr(1),Lo("ngModel",t.filterWorking),Jr(1),Lo("value",t.buildingStates.ALL),Jr(2),Lo("value",t.buildingStates.WORKING),Jr(2),Lo("value",t.buildingStates.IDLE),Jr(3),Lo("name","forest"),Jr(1),Lo("ngIf",t.getForestSize()>=400),Jr(1),Lo("ngIf",t.getForestSize()<400),Jr(2),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na(" ",t.getUnemployed()," \xa0\xa0\xa0 "),Jr(1),Lo("name","land"),Jr(1),na(" ",t.getFreeLand()," "),Jr(6),Lo("ngIf",!t.isPagedViewEnabled()),Jr(1),Lo("ngIf",t.isPagedViewEnabled()))},directives:[FO,Gu,VT,dT,MT,zT,$T,Uu,sI,lb,ku],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",".critical[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e})(),FC=(()=>{class e extends dv{constructor(e,t,i,s,r){super(t,e,i,r,s,Kf.FIELD,Zf.FIELD)}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(_O),gs(Jf),gs(NO),gs(NS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function UC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Demolish"),ko()}}function HC(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Stop"),ko()}}function GC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Arrange"),ko()}}function BC(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Stop"),ko()}}function WC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Combine"),ko()}}function VC(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Stop"),ko()}}function zC(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Split"),ko()}}function YC(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Stop"),ko()}}function KC(e,t){if(1&e&&(xo(0,"option",13),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("value",e),Jr(1),ra(i.getBuildingName(e))}}function jC(e,t){if(1&e&&(xo(0,"span",25),Fo(1,"app-building",26),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.fieldService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function $C(e,t){if(1&e&&(xo(0,"div",21),xo(1,"div",22),xo(2,"span"),sa(3,"Buildings"),ko(),ko(),xo(4,"div",23),Po(5,jC,2,6,"span",24),ko(),ko()),2&e){const e=Ko();Jr(5),Lo("ngForOf",e.getBuildings())}}const QC=function(e){return{activePage:e}};function qC(e,t){if(1&e){const e=Go();xo(0,"span",29),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).setPage(t)}),sa(1),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(2,QC,i.currentPage===e)),Jr(1),na("page ",e+1,"")}}function XC(e,t){if(1&e&&(xo(0,"span",25),Fo(1,"app-building",26),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.fieldService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function ZC(e,t){if(1&e&&(xo(0,"div",21),xo(1,"div",27),Po(2,qC,2,4,"span",28),ko(),xo(3,"div",23),Po(4,XC,2,6,"span",24),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getPagesNumber()),Jr(2),Lo("ngForOf",e.getPagedBuildings())}}let JC=(()=>{class e extends gv{constructor(e,t,i,s,r,n,o){super(e,t,i,r,s,n,o,Kf.FIELD),this.landService=t,this.fieldService=r}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(yS),Mo(FC),Mo(vS),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-field"]],features:[fo],decls:50,vars:24,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"button",4),Vo("click",function(){return t.openBuildModal()}),sa(6,"Build"),ko(),Po(7,UC,2,0,"button",5),Po(8,HC,2,0,"button",6),Po(9,GC,2,0,"button",5),Po(10,BC,2,0,"button",6),Po(11,WC,2,0,"button",5),Po(12,VC,2,0,"button",6),Po(13,zC,2,0,"button",5),Po(14,YC,2,0,"button",6),xo(15,"button",7),sa(16,"Actions "),Fo(17,"img",8),xo(18,"ul",9),xo(19,"li",4),Vo("click",function(){return t.autoSort()}),sa(20,"Sort"),ko(),xo(21,"li",4),Vo("click",function(){return t.autoMerge()}),sa(22,"Merge"),ko(),ko(),ko(),xo(23,"div",10),sa(24," Filter:"),Fo(25,"br"),xo(26,"div",11),xo(27,"select",12),Vo("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),xo(28,"option",13),sa(29),ko(),Po(30,KC,2,2,"option",14),ko(),xo(31,"select",12),Vo("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),xo(32,"option",13),sa(33,"All"),ko(),xo(34,"option",13),sa(35,"Working"),ko(),xo(36,"option",13),sa(37,"Idle"),ko(),ko(),ko(),ko(),ko(),xo(38,"div",15),Fo(39,"app-icon",16),sa(40),Fo(41,"app-icon",17),sa(42),xo(43,"div",18),xo(44,"button",4),Vo("click",function(){return t.enableAll()}),sa(45,"all on"),ko(),xo(46,"button",4),Vo("click",function(){return t.disableAll()}),sa(47,"all off"),ko(),ko(),ko(),Po(48,$C,6,1,"div",19),Po(49,ZC,5,2,"div",19),ko(),ko()),2&e&&(Jr(7),Lo("ngIf",!t.demolishMode),Jr(1),Lo("ngIf",t.demolishMode),Jr(1),Lo("ngIf",!t.arrangeMode&&t.getBuildings().length>1),Jr(1),Lo("ngIf",t.arrangeMode),Jr(1),Lo("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),Jr(1),Lo("ngIf",t.combineMode),Jr(1),Lo("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),Jr(1),Lo("ngIf",t.splitMode),Jr(13),Lo("ngModel",t.filterBuilding),Jr(1),Lo("value",t.allBuildings),Jr(1),ra(t.getBuildingName(t.allBuildings)),Jr(1),Lo("ngForOf",t.getUniqueBuildingsFromCurrentView()),Jr(1),Lo("ngModel",t.filterWorking),Jr(1),Lo("value",t.buildingStates.ALL),Jr(2),Lo("value",t.buildingStates.WORKING),Jr(2),Lo("value",t.buildingStates.IDLE),Jr(3),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na(" ",t.getUnemployed()," \xa0\xa0\xa0 "),Jr(1),Lo("name","land"),Jr(1),na(" ",t.getFreeLand()," "),Jr(6),Lo("ngIf",!t.isPagedViewEnabled()),Jr(1),Lo("ngIf",t.isPagedViewEnabled()))},directives:[FO,Gu,VT,dT,MT,zT,$T,Uu,sI,lb,ku],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",""]}),e})(),ey=(()=>{class e extends dv{constructor(e,t,i,s,r,n){super(t,e,i,r,s,Kf.MOUNTAINS,Zf.MOUNTAINS),this.logService=n}addMeteorite(){let e=am.randomElement([{item:Df.STONE,chance:35},{item:Df.COPPER_ORE,chance:30},{item:Df.TIN_ORE,chance:20},{item:Df.GOLD_ORE,chance:5},{item:Df.SILVER_ORE,chance:5},{item:Df.IRON_ORE,chance:5}]);null===e&&(e=Df.STONE),this.buildings.push(new uO(this.servicesService,this.idService.getNextId(),am.randomBetween(100,200),e)),this.logService.success("Old meteorite found in the mountains!")}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(_O),gs(Jf),gs(NO),gs(NS),gs(IS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ty(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Demolish"),ko()}}function iy(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Stop"),ko()}}function sy(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Arrange"),ko()}}function ry(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Stop"),ko()}}function ny(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Combine"),ko()}}function oy(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Stop"),ko()}}function ay(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Split"),ko()}}function cy(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Stop"),ko()}}function ly(e,t){if(1&e&&(xo(0,"option",13),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("value",e),Jr(1),ra(i.getBuildingName(e))}}function uy(e,t){if(1&e&&(xo(0,"span",22),sa(1," \xa0\xa0\xa0 "),Fo(2,"app-icon",23),sa(3),ko()),2&e){const e=Ko();Jr(2),Lo("name","coal")("path","resources")("title","coal deposit"),Jr(1),na(": ",e.getCoal()," ")}}function hy(e,t){if(1&e&&(xo(0,"span",22),sa(1," \xa0\xa0\xa0 "),Fo(2,"app-icon",23),sa(3),ko()),2&e){const e=Ko();Jr(2),Lo("name","gold_ore")("path","resources")("title","gold deposit"),Jr(1),na(": ",e.getGoldOre()," ")}}function dy(e,t){if(1&e&&(xo(0,"span",22),sa(1," \xa0\xa0\xa0 "),Fo(2,"app-icon",23),sa(3),ko()),2&e){const e=Ko();Jr(2),Lo("name","silver_ore")("path","resources")("title","silver deposit"),Jr(1),na(": ",e.getSilverOre()," ")}}function gy(e,t){if(1&e&&(xo(0,"span",22),sa(1," \xa0\xa0\xa0 "),Fo(2,"app-icon",23),sa(3),ko()),2&e){const e=Ko();Jr(2),Lo("name","copper_ore")("path","resources")("title","copper deposit"),Jr(1),na(": ",e.getCopperOre()," ")}}function py(e,t){if(1&e&&(xo(0,"span",22),sa(1," \xa0\xa0\xa0 "),Fo(2,"app-icon",23),sa(3),ko()),2&e){const e=Ko();Jr(2),Lo("name","tin_ore")("path","resources")("title","tin deposit"),Jr(1),na(": ",e.getTinOre()," ")}}function fy(e,t){if(1&e&&(xo(0,"span",22),sa(1," \xa0\xa0\xa0 "),Fo(2,"app-icon",23),sa(3),ko()),2&e){const e=Ko();Jr(2),Lo("name","iron_ore")("path","resources")("title","iron deposit"),Jr(1),na(": ",e.getIronOre()," ")}}function my(e,t){if(1&e&&(xo(0,"span",28),Fo(1,"app-building",29),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.mountainsService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function Sy(e,t){if(1&e&&(xo(0,"div",24),xo(1,"div",25),xo(2,"span"),sa(3,"Buildings"),ko(),ko(),xo(4,"div",26),Po(5,my,2,6,"span",27),ko(),ko()),2&e){const e=Ko();Jr(5),Lo("ngForOf",e.getBuildings())}}const Ey=function(e){return{activePage:e}};function vy(e,t){if(1&e){const e=Go();xo(0,"span",32),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).setPage(t)}),sa(1),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(2,Ey,i.currentPage===e)),Jr(1),na("page ",e+1,"")}}function Ry(e,t){if(1&e&&(xo(0,"span",28),Fo(1,"app-building",29),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.mountainsService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function Oy(e,t){if(1&e&&(xo(0,"div",24),xo(1,"div",30),Po(2,vy,2,4,"span",31),ko(),xo(3,"div",26),Po(4,Ry,2,6,"span",27),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getPagesNumber()),Jr(2),Lo("ngForOf",e.getPagedBuildings())}}let Ty=(()=>{class e extends gv{constructor(e,t,i,s,r,n,o){super(e,t,i,r,s,n,o,Kf.MOUNTAINS),this.landService=t,this.mountainsService=r}getMountains(){return this.landService.getMountains()}getCoal(){return this.landService.getOre(Df.COAL)}getGoldOre(){return this.landService.getOre(Df.GOLD_ORE)}getSilverOre(){return this.landService.getOre(Df.SILVER_ORE)}getCopperOre(){return this.landService.getOre(Df.COPPER_ORE)}getTinOre(){return this.landService.getOre(Df.TIN_ORE)}getIronOre(){return this.landService.getOre(Df.IRON_ORE)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(yS),Mo(ey),Mo(vS),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-mountains"]],features:[fo],decls:56,vars:32,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name"],[3,"name","title","margin"],["class","deposit",4,"ngIf"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"deposit"],[3,"name","path","title"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"button",4),Vo("click",function(){return t.openBuildModal()}),sa(6,"Build"),ko(),Po(7,ty,2,0,"button",5),Po(8,iy,2,0,"button",6),Po(9,sy,2,0,"button",5),Po(10,ry,2,0,"button",6),Po(11,ny,2,0,"button",5),Po(12,oy,2,0,"button",6),Po(13,ay,2,0,"button",5),Po(14,cy,2,0,"button",6),xo(15,"button",7),sa(16,"Actions "),Fo(17,"img",8),xo(18,"ul",9),xo(19,"li",4),Vo("click",function(){return t.autoSort()}),sa(20,"Sort"),ko(),ko(),ko(),xo(21,"div",10),sa(22," Filter:"),Fo(23,"br"),xo(24,"div",11),xo(25,"select",12),Vo("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),xo(26,"option",13),sa(27),ko(),Po(28,ly,2,2,"option",14),ko(),xo(29,"select",12),Vo("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),xo(30,"option",13),sa(31,"All"),ko(),xo(32,"option",13),sa(33,"Working"),ko(),xo(34,"option",13),sa(35,"Idle"),ko(),ko(),ko(),ko(),ko(),xo(36,"div",15),Fo(37,"app-icon",16),sa(38),Fo(39,"app-icon",17),sa(40),Fo(41,"app-icon",16),sa(42),Po(43,uy,4,4,"span",18),Po(44,hy,4,4,"span",18),Po(45,dy,4,4,"span",18),Po(46,gy,4,4,"span",18),Po(47,py,4,4,"span",18),Po(48,fy,4,4,"span",18),xo(49,"div",19),xo(50,"button",4),Vo("click",function(){return t.enableAll()}),sa(51,"all on"),ko(),xo(52,"button",4),Vo("click",function(){return t.disableAll()}),sa(53,"all off"),ko(),ko(),ko(),Po(54,Sy,6,1,"div",20),Po(55,Oy,5,2,"div",20),ko(),ko()),2&e&&(Jr(7),Lo("ngIf",!t.demolishMode),Jr(1),Lo("ngIf",t.demolishMode),Jr(1),Lo("ngIf",!t.arrangeMode&&t.getBuildings().length>1),Jr(1),Lo("ngIf",t.arrangeMode),Jr(1),Lo("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),Jr(1),Lo("ngIf",t.combineMode),Jr(1),Lo("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),Jr(1),Lo("ngIf",t.splitMode),Jr(11),Lo("ngModel",t.filterBuilding),Jr(1),Lo("value",t.allBuildings),Jr(1),ra(t.getBuildingName(t.allBuildings)),Jr(1),Lo("ngForOf",t.getUniqueBuildingsFromCurrentView()),Jr(1),Lo("ngModel",t.filterWorking),Jr(1),Lo("value",t.buildingStates.ALL),Jr(2),Lo("value",t.buildingStates.WORKING),Jr(2),Lo("value",t.buildingStates.IDLE),Jr(3),Lo("name","mountains"),Jr(1),na(" ",t.getMountains()," \xa0\xa0 "),Jr(1),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na(" ",t.getUnemployed()," \xa0\xa0\xa0 "),Jr(1),Lo("name","land"),Jr(1),na(" ",t.getFreeLand()," "),Jr(1),Lo("ngIf",t.getCoal()>0),Jr(1),Lo("ngIf",t.getGoldOre()>0),Jr(1),Lo("ngIf",t.getSilverOre()>0),Jr(1),Lo("ngIf",t.getCopperOre()>0),Jr(1),Lo("ngIf",t.getTinOre()>0),Jr(1),Lo("ngIf",t.getIronOre()>0),Jr(6),Lo("ngIf",!t.isPagedViewEnabled()),Jr(1),Lo("ngIf",t.isPagedViewEnabled()))},directives:[FO,Gu,VT,dT,MT,zT,$T,Uu,sI,lb,ku],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",".deposit[_ngcontent-%COMP%]{display:inline-flex;font-size:.8em;height:24px;align-items:center}"]}),e})(),Iy=(()=>{class e extends dv{constructor(e,t,i,s,r){super(t,e,i,r,s,Kf.SEA,Zf.SEA)}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(_O),gs(Jf),gs(NO),gs(NS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class by{constructor(e,t){this.troop=e,this.size=t}getTroopStrength(){return aS.getTroop(this.troop).STRENGTH}getTroopDefense(){return aS.getTroop(this.troop).DEFENSE}getTroopSpeed(){return aS.getTroop(this.troop).SPEED}getTroopPay(){return aS.getTroop(this.troop).PAY}getRecruitTime(){return aS.getTroop(this.troop).RECRUIT_TIME}getTroopSize(){return aS.getTroop(this.troop).SIZE}getTroopCargo(){return aS.getTroop(this.troop).CARGO}isNavy(){return this.troop===Wf.BOAT||this.troop===Wf.BRIGANTINE||this.troop===Wf.GALLEON}}class Cy{constructor(e){this.units=e}static clone(e){const t=new Cy([]);return e.units.forEach(e=>t.addTroop(e.troop,e.size)),t}toJSON(){this.removeEmptyUnits();const e=[];return this.units.forEach(t=>{e.push({troop:t.troop,size:t.size})}),{units:e}}getLandUnits(e){const t=new Cy([]);return this.units.forEach(i=>{i.isNavy()||(t.addTroop(i.troop,i.size),e&&(i.size=0))}),this.removeEmptyUnits(),t}getNavy(e){const t=new Cy([]);return this.units.forEach(i=>{i.isNavy()&&(t.addTroop(i.troop,i.size),e&&(i.size=0))}),t}getRandomUnit(){return am.randomArrayElement(this.units.filter(e=>e.size>=0))}getUnit(e){return this.units.find(t=>t.troop===e)}removeEmptyUnits(){this.units=this.units.filter(e=>e.size>0)}hasAny(){return this.removeEmptyUnits(),!(0===this.units.length||1===this.units.length&&this.units[0].troop===Wf.GUARD_TOWER)}addTroop(e,t){const i=this.units.find(t=>t.troop===e);i?i.size+=t:this.units.push(new by(e,t))}getArmySize(){let e=0;return this.removeEmptyUnits(),this.units.filter(e=>e.troop!==Wf.COLONIST).forEach(t=>e+=t.size),e}getArmyPower(e){let t=0;return this.units.forEach(i=>{t+=e?i.size*i.getTroopStrength():i.size*i.getTroopDefense()}),t}removeTroop(e,t){const i=this.units.find(t=>t.troop===e);i&&(i.size-=t),this.removeEmptyUnits()}addArmy(e){e.units.forEach(e=>this.addTroop(e.troop,e.size))}getArmyPay(){let e=0;return this.units.filter(e=>e.troop!==Wf.COLONIST).forEach(t=>e+=t.getTroopPay()*t.size),e}clearArmy(){this.units=[]}getArmySpeed(){this.removeEmptyUnits();let e=0;return this.units.forEach(t=>{0===e&&(e=t.getTroopSpeed()),t.getTroopSpeed()<e&&(e=t.getTroopSpeed())}),e}getArmyCargo(){let e=0;return this.units.forEach(t=>e+=t.getTroopCargo()*t.size),e}hasTroop(e){return this.removeEmptyUnits(),void 0!==this.units.find(t=>t.troop===e)}}let yy=(()=>{class e{constructor(e,t,i,s,r,n){this.servicesService=e,this.resourcesService=t,this.logService=i,this.seaService=s,this.modalService=r,this.calendarService=n,this.maxHarbourSpace=0,this.cartographyData=0,this.mapProgress=0,this.paydayCounter=30,this.navy=new Cy([]),e.addService(Zf.NAVY,this),this.calendarService.registerForDayChange().subscribe(e=>{this.calculatePayday()})}getName(){return"NavyService"}load(e){this.maxHarbourSpace=void 0===e.maxHarbourSpace||isNaN(e.maxHarbourSpace)?0:e.maxHarbourSpace,this.cartographyData=void 0===e.cartographyData||isNaN(e.cartographyData)?0:e.cartographyData,this.mapProgress=void 0===e.mapProgress||isNaN(e.mapProgress)?0:e.mapProgress,this.paydayCounter=void 0!==e.paydayCounter?e.paydayCounter:30,this.navy.units=[],void 0!==e.navy&&e.navy.forEach(e=>{this.navy.addTroop(e[0],e[1])})}reset(e,t){this.maxHarbourSpace=0,this.cartographyData=0,this.mapProgress=0,this.navy=new Cy([]),this.paydayCounter=30}save(){const e=[];return this.navy.units.forEach(t=>e.push([t.troop,t.size])),{maxHarbourSpace:this.maxHarbourSpace,cartographyData:this.cartographyData,mapProgress:this.mapProgress,navy:e,paydayCounter:this.paydayCounter}}getWorldService(){return this.servicesService.getWorldService()}tick(e){}increaseHarbourSize(e){this.maxHarbourSpace+=e}decreaseHarbourSize(e){this.maxHarbourSpace-=e,this.maxHarbourSpace<0&&(this.maxHarbourSpace=0)}getHarbourSpace(){let e=0;return[Wf.BOAT,Wf.BRIGANTINE,Wf.GALLEON].forEach(t=>{e+=this.getTotalShips(t)*aS.getTroop(t).SIZE}),e+this.getSizeOfShipsInConstruction()}getSizeOfShipsInConstruction(){let e=0;return this.seaService.getBuildings().filter(e=>e.getBuildingType()===Lf.BOAT_BUILDER||e.getBuildingType()===Lf.SHIPYARD).map(e=>e).forEach(t=>e+=t.getShipSize()),e}getFreeHarbourSpace(){return this.maxHarbourSpace-this.getHarbourSpace()-this.getSizeOfShipsInConstruction()}getMaxHarbourSpace(){return this.maxHarbourSpace}addShip(e){this.navy.addTroop(e,1)}getAvailableShips(e){const t=this.navy.getUnit(e);return void 0!==t?t.size:0}getTotalShips(e){let t=0;const i=this.navy.getUnit(e);return t+=void 0!==i?i.size:0,this.getWorldService().getPlayerSeaMissions().forEach(i=>{const s=i.army.getUnit(e);t+=void 0!==s?s.size:0}),this.getWorldService().getStationedNavy().forEach(i=>{const s=i.getUnit(e);s&&(t+=s.size)}),t}getCartographyData(){return this.cartographyData}increaseCartographyData(e){this.cartographyData+=e}decreaseCartographyData(e){return this.cartographyData>=e&&(this.cartographyData-=e,!0)}addMapProgress(){this.mapProgress+=1}getMapProgress(){return this.mapProgress}createMap(){return!!(this.mapProgress>=100&&this.resourcesService.increaseResource(Df.MAP,1,"Cartographer"))&&(this.mapProgress-=100,!0)}calculateNavyPay(){let e=0;return[Wf.BOAT,Wf.BRIGANTINE,Wf.GALLEON].forEach(t=>{e+=this.getTotalShips(t)*aS.getTroop(t).PAY}),e}getNavy(){return this.navy}getPaydayCounter(){return this.paydayCounter}calculatePayday(){if(this.getPaydayCounter()<=0){const e=this.calculateNavyPay();if(e>0){let t=this.resourcesService.hasResource(Df.COINS,e,"Navy");if(t>e&&(t=e),t>0){this.resourcesService.decreaseResource(Df.COINS,e-t,"Navy");const i=[];for(;t>0&&(this.navy.units.forEach(e=>{if(t>0&&e.getTroopPay()>0&&e.size>0&&(t-=e.getTroopPay(),am.chance(.25))){e.size-=1;const t=i.find(t=>t[0]===e.troop);t?t[1]+=1:i.push([e.troop,1])}}),!(t<=0));){const e=[];this.getWorldService().getPlayerSeaMissions().forEach(t=>{t.army.getNavy(!1).getArmySize()>0&&e.push(t.army.getNavy(!1))}),this.getWorldService().getStationedNavy().forEach(t=>{t.getArmySize()>0&&e.push(t)}),e.forEach(e=>{t>0&&e.units.forEach(e=>{if(t>0&&e.getTroopPay()>0&&e.size>0&&(t-=e.getTroopPay(),am.chance(.25))){e.size-=1;const t=i.find(t=>t[0]===e.troop);t?t[1]+=1:i.push([e.troop,1])}}),e.removeEmptyUnits()})}if(i.length>0){let e="Deserters:<br>";i.forEach(t=>e+="&emsp;"+t[1]+" "+Qf.prepareTroopName(t[0])+"<br>"),this.logService.warning(e)}}else this.resourcesService.decreaseResource(Df.COINS,e,"Navy")}this.paydayCounter=30}else this.paydayCounter-=1}dismiss(e,t){const i=this.resourcesService.getPopulationCap()-this.resourcesService.getTotalPeople(),s=void 0!==this.navy.getUnit(e)?this.navy.getUnit(e).size:0;0!==s?t>s?this.modalService.info("There are not enough ships to decommission"):i>=t?(this.navy.removeTroop(e,t),this.servicesService.getVillageService().addVillagers(t)):this.modalService.info("There are not enough housing space for sailors from decommissioned ships!"):this.modalService.info("No ship to decommission")}addBrigantines(e){this.navy.addTroop(Wf.BRIGANTINE,e)}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(Pv),gs(IS),gs(Iy),gs(em),gs(OS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Ay(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Demolish"),ko()}}function Ny(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Stop"),ko()}}function _y(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Arrange"),ko()}}function wy(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Stop"),ko()}}function Py(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Combine"),ko()}}function My(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Stop"),ko()}}function Ly(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Split"),ko()}}function Dy(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Stop"),ko()}}function xy(e,t){if(1&e&&(xo(0,"option",13),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("value",e),Jr(1),ra(i.getBuildingName(e))}}function ky(e,t){if(1&e&&(xo(0,"span",26),Fo(1,"app-building",27),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.seaService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function Fy(e,t){if(1&e&&(xo(0,"div",22),xo(1,"div",23),xo(2,"span"),sa(3,"Buildings"),ko(),ko(),xo(4,"div",24),Po(5,ky,2,6,"span",25),ko(),ko()),2&e){const e=Ko();Jr(5),Lo("ngForOf",e.getBuildings())}}const Uy=function(e){return{activePage:e}};function Hy(e,t){if(1&e){const e=Go();xo(0,"span",30),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).setPage(t)}),sa(1),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(2,Uy,i.currentPage===e)),Jr(1),na("page ",e+1,"")}}function Gy(e,t){if(1&e&&(xo(0,"span",26),Fo(1,"app-building",27),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.seaService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function By(e,t){if(1&e&&(xo(0,"div",22),xo(1,"div",28),Po(2,Hy,2,4,"span",29),ko(),xo(3,"div",24),Po(4,Gy,2,6,"span",25),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getPagesNumber()),Jr(2),Lo("ngForOf",e.getPagedBuildings())}}let Wy=(()=>{class e extends gv{constructor(e,t,i,s,r,n,o,a){super(e,t,i,r,s,n,o,Kf.SEA),this.landService=t,this.seaService=r,this.navyService=a}getHarbourSpace(){return this.navyService.getHarbourSpace()}getMaxHarbourSpace(){return this.navyService.getMaxHarbourSpace()}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(yS),Mo(Iy),Mo(vS),Mo(nc),Mo(yy))},e.\u0275cmp=Ve({type:e,selectors:[["app-sea"]],features:[fo],decls:50,vars:28,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],[3,"name","path"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"button",4),Vo("click",function(){return t.openBuildModal()}),sa(6,"Build"),ko(),Po(7,Ay,2,0,"button",5),Po(8,Ny,2,0,"button",6),Po(9,_y,2,0,"button",5),Po(10,wy,2,0,"button",6),Po(11,Py,2,0,"button",5),Po(12,My,2,0,"button",6),Po(13,Ly,2,0,"button",5),Po(14,Dy,2,0,"button",6),xo(15,"button",7),sa(16,"Actions "),Fo(17,"img",8),xo(18,"ul",9),xo(19,"li",4),Vo("click",function(){return t.autoSort()}),sa(20,"Sort"),ko(),ko(),ko(),xo(21,"div",10),sa(22," Filter:"),Fo(23,"br"),xo(24,"div",11),xo(25,"select",12),Vo("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),xo(26,"option",13),sa(27),ko(),Po(28,xy,2,2,"option",14),ko(),xo(29,"select",12),Vo("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),xo(30,"option",13),sa(31,"All"),ko(),xo(32,"option",13),sa(33,"Working"),ko(),xo(34,"option",13),sa(35,"Idle"),ko(),ko(),ko(),ko(),ko(),xo(36,"div",15),Fo(37,"app-icon",16),sa(38),Fo(39,"app-icon",17),sa(40),Fo(41,"app-icon",18),sa(42),xo(43,"div",19),xo(44,"button",4),Vo("click",function(){return t.enableAll()}),sa(45,"all on"),ko(),xo(46,"button",4),Vo("click",function(){return t.disableAll()}),sa(47,"all off"),ko(),ko(),ko(),Po(48,Fy,6,1,"div",20),Po(49,By,5,2,"div",20),ko(),ko()),2&e&&(Jr(7),Lo("ngIf",!t.demolishMode),Jr(1),Lo("ngIf",t.demolishMode),Jr(1),Lo("ngIf",!t.arrangeMode&&t.getBuildings().length>1),Jr(1),Lo("ngIf",t.arrangeMode),Jr(1),Lo("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),Jr(1),Lo("ngIf",t.combineMode),Jr(1),Lo("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),Jr(1),Lo("ngIf",t.splitMode),Jr(11),Lo("ngModel",t.filterBuilding),Jr(1),Lo("value",t.allBuildings),Jr(1),ra(t.getBuildingName(t.allBuildings)),Jr(1),Lo("ngForOf",t.getUniqueBuildingsFromCurrentView()),Jr(1),Lo("ngModel",t.filterWorking),Jr(1),Lo("value",t.buildingStates.ALL),Jr(2),Lo("value",t.buildingStates.WORKING),Jr(2),Lo("value",t.buildingStates.IDLE),Jr(3),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na(" ",t.getUnemployed()," \xa0\xa0\xa0 "),Jr(1),Lo("name","land"),Jr(1),na(" ",t.getFreeLand()," \xa0\xa0\xa0 "),Jr(1),Lo("name","port")("path","sea"),Jr(1),oa(" ",t.getHarbourSpace(),"/",t.getMaxHarbourSpace()," "),Jr(6),Lo("ngIf",!t.isPagedViewEnabled()),Jr(1),Lo("ngIf",t.isPagedViewEnabled()))},directives:[FO,Gu,VT,dT,MT,zT,$T,Uu,sI,lb,ku],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",""]}),e})();class Vy{constructor(){this.skirmish=[]}}class zy{constructor(e,t,i,s,r){this.attackerTroop=e,this.defenderTroop=t,this.attack=i,this.defense=s,this.result=r}}let Yy=(()=>{class e{constructor(e,t,i,s,r,n,o,a){this.resourcesService=e,this.modalService=t,this.logService=i,this.landService=s,this.soundService=r,this.calendarService=n,this.effectsService=o,this.servicesService=a,this.barracksSize=0,this.defense=0,this.stashSize=0,this.paydayCounter=30,this.army=new Cy([]),this.recruits=[],this.recruitsUpdate=new b,a.addService(Zf.ARMY,this),this.calendarService.registerForDayChange().subscribe(e=>{this.calculatePayday()})}tick(e){}getName(){return"ArmyService"}load(e){this.barracksSize=e.barracksSize,this.defense=e.defense,this.paydayCounter=void 0!==e.paydayCounter?e.paydayCounter:30,this.stashSize=e.stashSize,this.army.units=[],void 0!==e.troops?e.troops.forEach(e=>{this.army.addTroop(e[0],e[1])}):void 0!==e.army&&e.army.forEach(e=>{this.army.addTroop(e[0],e[1])}),this.recruits=[],e.recruits.forEach(e=>{this.recruits.push([new by(e[0],e[1]),e[2]])}),void 0!==e.missionsInProgress&&e.missionsInProgress.forEach(e=>{e[4].forEach(e=>{this.army.addTroop(e[0],e[1])})})}save(){const e=[];this.army.units.forEach(t=>e.push([t.troop,t.size]));const t=[];return this.recruits.forEach(e=>t.push([e[0].troop,e[0].size,e[1]])),{barracksSize:this.barracksSize,army:e,recruits:t,defense:this.defense,stashSize:this.stashSize,paydayCounter:this.paydayCounter}}reset(e,t){this.recruits=[],this.barracksSize=0,this.defense=0,this.stashSize=0,this.paydayCounter=30,this.army.units=[]}progressRecruitment(e){this.recruits.length>0&&(this.recruits[0][1]+=e,this.recruits[0][1]>=this.recruits[0][0].getRecruitTime()&&(this.army.addTroop(this.recruits[0][0].troop,1),this.recruits[0][0].size-=1,this.recruits[0][1]=0,this.recruits[0][0].size<=0&&this.recruits.shift()),this.recruitsUpdate.next())}recruit(e,t){if(this.getFreeBarracks()>=t)if(this.resourcesService.getPeople()>=t){const i=new Map;aS.getTroop(e).COST.forEach(e=>i.set(e.resource,e.amount)),this.resourcesService.decreaseResources(i,"Army",!0,t)&&(this.resourcesService.removeRecruit(t),this.recruits.push([new by(e,t),0]))}else this.modalService.info("Not enough unemployed people to recruit!");else this.modalService.info("Not enough space in barracks for so many recruits")}dismiss(e,t){const i=this.resourcesService.getPopulationCap()-this.resourcesService.getTotalPeople(),s=void 0!==this.army.getUnit(e)?this.army.getUnit(e).size:0;0!==s?t>s?this.modalService.info("There are not enough troops to dismiss"):i>=t?(this.army.removeTroop(e,t),this.servicesService.getVillageService().addVillagers(t)):this.modalService.info("There are not enough housing space for dismissed troops!"):this.modalService.info("No troops to dismiss")}dismissRecruit(e,t){const i=this.resourcesService.getPopulationCap()-this.resourcesService.getTotalPeople();t>this.recruits[e][0].size?this.modalService.info("There are not enough recruits to dismiss"):i>=t?(this.recruits[e][0].size-=t,this.recruits[e][0].size<=0&&this.recruits.splice(e,1),this.servicesService.getVillageService().addVillagers(t)):this.modalService.info("There are not enough housing space for dismissed troops!")}getRecruits(){return this.recruits}getUnits(){return this.army.units}getWorldService(){return this.servicesService.getWorldService()}getArmySize(){let e=this.army.getArmySize();return this.recruits.forEach(t=>e+=t[0].size),this.getWorldService().getPlayerLandMissions().forEach(t=>{e+=t.army.getArmySize()}),this.getWorldService().getPlayerSeaMissions().forEach(t=>{e+=t.army.getLandUnits(!1).getArmySize()}),this.getWorldService().getStationedArmies().forEach(t=>{e+=t.getArmySize()}),e}getFreeBarracks(){return this.barracksSize-this.getArmySize()}increaseBarracks(e){this.barracksSize+=e}decreaseBarracks(e){this.barracksSize-=e}getBarracksSize(){return this.barracksSize}getDefenseStrength(){let e=this.defense;return this.army.units.forEach(t=>e+=t.getTroopDefense()*t.size),e}increaseDefense(e){this.defense+=e}decreaseDefense(e){this.defense-=e}hasRecruits(){return this.recruits.length>0}registerForRecruitsUpdate(){return this.recruitsUpdate.asObservable()}getAttackStrength(){let e=0;return this.army.units.forEach(t=>e+=t.getTroopStrength()*t.size),e}increaseStash(e){this.stashSize+=e}decreaseStash(e){this.stashSize-=e}calculateSoldiersPay(){let e=0;return e+=this.army.getArmyPay(),this.getWorldService().getPlayerLandMissions().forEach(t=>{e+=t.army.getArmyPay()}),this.getWorldService().getPlayerSeaMissions().forEach(t=>{e+=t.army.getLandUnits(!1).getArmyPay()}),this.getWorldService().getStationedArmies().forEach(t=>{e+=t.getArmyPay()}),e}getPaydayCounter(){return this.paydayCounter}calculatePayday(){if(this.paydayCounter<=0){const e=this.calculateSoldiersPay();if(e>0){let t=this.resourcesService.hasResource(Df.COINS,e,"Army");if(t>e&&(t=e),t>0){this.resourcesService.decreaseResource(Df.COINS,e-t,"Army");const i=[];for(;t>0&&(this.army.units.forEach(e=>{if(t>0&&e.getTroopPay()>0&&e.size>0&&(t-=e.getTroopPay(),am.chance(.25))){e.size-=1;const t=i.find(t=>t[0]===e.troop);t?t[1]+=1:i.push([e.troop,1])}}),!(t<=0));){const e=[];this.getWorldService().getPlayerLandMissions().forEach(t=>{t.army.getArmySize()>0&&e.push(t.army)}),this.getWorldService().getPlayerSeaMissions().forEach(t=>{t.army.getLandUnits(!1).getArmySize()>0&&e.push(t.army.getLandUnits(!1))}),this.getWorldService().getStationedArmies().forEach(t=>{t.getArmySize()>0&&e.push(t)}),e.forEach(e=>{t>0&&e.units.forEach(e=>{if(t>0&&e.getTroopPay()>0&&e.size>0&&(t-=e.getTroopPay(),am.chance(.25))){e.size-=1;const t=i.find(t=>t[0]===e.troop);t?t[1]+=1:i.push([e.troop,1])}})})}if(i.length>0){let e="Deserters:<br>";i.forEach(t=>e+="&emsp;"+t[1]+" "+Qf.prepareTroopName(t[0])+"<br>"),this.logService.warning(e)}}else this.resourcesService.decreaseResource(Df.COINS,e,"Army")}this.paydayCounter=30}else this.paydayCounter-=1}getTroopEffectsMultiplier(e){return 1+this.getTroopEffectsValue(e)/100}getTroopEffectsValue(e){let t=0;return this.effectsService.getArmyEffects().filter(t=>t.troop===Wf.ALL||t.troop===e).forEach(e=>t+=e.effect),t}addMilitia(e){this.army.addTroop(Wf.MILITIA,e)}addLightCavalry(e){this.army.addTroop(Wf.LIGHT_CAVALRY,e)}calculateAttack(e,t,i,s,r){const n=new Vy;n.attackerArmy=Cy.clone(e),n.defenderArmy=Cy.clone(t),n.defense=i;let o=0,a=0,c=0;if(e.getArmySize()>t.getArmySize()?(a=Math.floor(e.getArmySize()/t.getArmySize())-1,a>3&&(a=3)):t.getArmySize()>e.getArmySize()&&(c=Math.floor(t.getArmySize()/e.getArmySize())-1,c>3&&(c=3)),n.attackerArmySizeBonus=a,n.defenderArmySizeBonus=c,e.units.length>0&&t.units.length>0){let l=t.getRandomUnit(),u=l.getTroopDefense(),h=e.getRandomUnit(),d=h.getTroopStrength();const g=Math.floor(d/2);for(d-=g<i?g:i;e.units.length>0&&t.units.length>0;){if(o+=1,null===h){h=e.getRandomUnit(),d=h.getTroopStrength();const t=Math.floor(d/2);d-=t<i?t:i}null===l&&(l=t.getRandomUnit(),u=l.getTroopDefense());let g=0,p=0,f=0;if(s)g=d*this.getTroopEffectsMultiplier(h.troop)+a,p=g,f=u+c,g-=u+c;else if(r){const e=u*this.getTroopEffectsMultiplier(l.troop)+c;f=e,p=d+a,g=-e+d+a}else g=d+a,p=g,f=u+c,g-=u+c;const m=this.calculateWinChance(g);am.chance(m/100)?(n.skirmish.push(new zy(h.troop,l.troop,p,f,!0)),l.size-=1,t.removeEmptyUnits(),l=null,d-=1):(n.skirmish.push(new zy(h.troop,l.troop,p,f,!1)),h.size-=1,e.removeEmptyUnits(),h=null,u-=1)}}return e.units.length>0?(n.result=!0,n.armyAfterFight=Cy.clone(e)):(n.result=!1,n.armyAfterFight=Cy.clone(t)),n}calculateWinChance(e){let t=50;if(e>0){let i=e;e>1&&(i=1),e-=i,t+=10*i}return Math.min(95,Math.max(5,5*e+t))}getArmy(){return this.army}loot(e){const t=new Map;let i="Loot:<br>";const s=Array.from(this.resourcesService.getResources().values()).filter(e=>e.isVisible()).map(e=>({item:e.resource,chance:e.prioritise?10:1}));for(;e>5;){const i=am.randomWeightedExcept(s,[]),r=oS.getResource(i);let n=0;for(n=am.randomBetween(1,r.TRADE_VALUE<10?20:r.TRADE_VALUE<50?10:r.TRADE_VALUE<300?5:2);r.TRADE_VALUE*n>e;)n-=1;n>0&&(t.has(i)?t.set(i,t.get(i)+n):t.set(i,n),e-=n*r.TRADE_VALUE)}Array.from(t.keys()).sort((e,t)=>{const i=this.resourcesService.getResource(e).name.toLowerCase(),s=this.resourcesService.getResource(t).name.toLowerCase();return i<s?-1:i>s?1:0}).forEach(e=>{i+="&emsp;"+t.get(e)+" "+Qf.prepareResourceName(e)+"<br>"}),this.logService.success(i),this.resourcesService.increaseResources(t,"Plunder",!0)}lootPlayer(e){let t="<br>";const i=[];for(;e>0;){const t=Array.from(this.resourcesService.getResources().values()).filter(e=>e.amount>this.stashSize),s=am.randomExcept(t,[]);if(void 0===s){e=0;break}const r=oS.getResource(s.resource);let n=0;n=am.randomBetween(1,r.TRADE_VALUE<10?20:r.TRADE_VALUE<50?10:r.TRADE_VALUE<300?5:2),s.amount-this.stashSize<n&&(n=s.amount-this.stashSize),e-=r.TRADE_VALUE*n;const o=i.find(e=>e.resource===s.resource);o?o.amount+=n:i.push({resource:s.resource,amount:n}),this.resourcesService.decreaseResource(s.resource,n,"Invasion",!0)}let s=0;return i.sort((e,t)=>{const i=this.resourcesService.getResource(e.resource).name.toLowerCase(),s=this.resourcesService.getResource(t.resource).name.toLowerCase();return i<s?-1:i>s?1:0}).forEach(e=>{t+="&emsp;"+e.amount+" "+Qf.prepareResourceName(e.resource)+"<br>",s+=e.amount*oS.getResource(e.resource).TRADE_VALUE}),this.logService.warning(i.length>0?"Plundered: "+t:"Nothing has been stolen"),Math.floor(s/100)}moveRecipeInQueue(e){BE(this.recruits,e.previousIndex,e.currentIndex)}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(em),gs(IS),gs(NS),gs(RS),gs(OS),gs(bS),gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ky=(()=>{class e extends dv{constructor(e,t,i,s,r){super(t,e,i,r,s,Kf.FORT,Zf.FORT)}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(_O),gs(Jf),gs(NO),gs(NS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const jy=["progressId"];function $y(e,t){1&e&&(xo(0,"div",13),sa(1,"dismiss "),ko())}function Qy(e,t){1&e&&(xo(0,"div",13),sa(1,"recruit "),ko())}function qy(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),ra(e.amount*t.multiplier)}}function Xy(e,t){if(1&e&&(Uo(0,16),xo(1,"div",16),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(2),ra(e.amount*t.multiplier)}}function Zy(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",8),Po(2,qy,2,1,"ng-container",14),Po(3,Xy,3,1,"ng-container",15),Fo(4,"app-icon",9),ko(),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(2),Lo("ngIf",i.checkResource(e)),Jr(1),Lo("ngIf",!i.checkResource(e)),Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources")}}const Jy=function(e){return{dismiss:e}};function eA(e,t){if(1&e){const e=Go();xo(0,"div",2),Vo("click",function(){return Dt(e),Ko().dismissRecruit()}),Fo(1,"div",3,4),xo(3,"span",5),Po(4,$y,2,0,"div",6),Po(5,Qy,2,0,"div",6),sa(6),Fc(7,"titlecase"),Fo(8,"hr"),xo(9,"div",7),sa(10,"Stats (per soldier):"),ko(),xo(11,"div",8),Fo(12,"app-icon",9),sa(13),ko(),xo(14,"div",8),Fo(15,"app-icon",9),sa(16),ko(),xo(17,"div",8),Fo(18,"app-icon",9),sa(19),ko(),xo(20,"div",8),Fo(21,"app-icon",9),sa(22),ko(),xo(23,"div",10),sa(24,"Cost:"),ko(),Po(25,Zy,5,4,"div",11),ko(),xo(26,"div",12),sa(27),ko(),ko()}if(2&e){const e=Ko();Lo("ngClass",Mc(24,Jy,e.dismiss&&e.count>0))("elementId",e.id),Jr(3),$o("id",e.id),Jr(1),Lo("ngIf",e.dismiss),Jr(1),Lo("ngIf",!e.dismiss&&!e.recruit),Jr(1),oa(" ",e.multiplier," x ",Uc(7,22,e.getTroopName())," "),Jr(6),Lo("name","attack")("path","army"),Jr(1),na(": ",e.getTroopStrength(),""),Jr(2),Lo("name","defense")("path","army"),Jr(1),na(": ",e.getTroopDefense(),""),Jr(2),Lo("name","speed")("path","army"),Jr(1),na(": ",e.getTroopSpeed(),""),Jr(2),Lo("name","coins")("path","resources"),Jr(1),na(": ",e.getTroopPay(),""),Jr(3),Lo("ngForOf",e.getRecruitCost()),Jr(2),oa("",e.getTroopName()," - ",e.count,"")}}function tA(e,t){1&e&&(xo(0,"div",13),sa(1,"dismiss "),ko())}function iA(e,t){1&e&&(xo(0,"div",13),sa(1,"recruit "),ko())}function sA(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),ra(e.amount*t.multiplier)}}function rA(e,t){if(1&e&&(Uo(0,16),xo(1,"div",16),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(2),ra(e.amount*t.multiplier)}}function nA(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",8),Po(2,sA,2,1,"ng-container",14),Po(3,rA,3,1,"ng-container",15),Fo(4,"app-icon",9),ko(),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(2),Lo("ngIf",i.checkResource(e)),Jr(1),Lo("ngIf",!i.checkResource(e)),Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources")}}function oA(e,t){if(1&e&&(xo(0,"div",17),Fo(1,"div",3,4),xo(3,"span",5),Po(4,tA,2,0,"div",6),Po(5,iA,2,0,"div",6),sa(6),Fc(7,"titlecase"),Fo(8,"hr"),xo(9,"div",7),sa(10,"Stats (per soldier):"),ko(),xo(11,"div",8),Fo(12,"app-icon",9),sa(13),ko(),xo(14,"div",8),Fo(15,"app-icon",9),sa(16),ko(),xo(17,"div",8),Fo(18,"app-icon",9),sa(19),ko(),xo(20,"div",8),Fo(21,"app-icon",9),sa(22),ko(),xo(23,"div",10),sa(24,"Cost:"),ko(),Po(25,nA,5,4,"div",11),ko(),xo(26,"div",18),sa(27),ko(),ko()),2&e){const e=Ko();Lo("ngClass",Mc(24,Jy,e.dismiss&&e.count>0))("elementId",e.id),Jr(3),$o("id",e.id),Jr(1),Lo("ngIf",e.dismiss),Jr(1),Lo("ngIf",!e.dismiss&&!e.recruit),Jr(1),oa(" ",e.multiplier," x ",Uc(7,22,e.getTroopName())," "),Jr(6),Lo("name","attack")("path","army"),Jr(1),na(": ",e.getTroopStrength(),""),Jr(2),Lo("name","defense")("path","army"),Jr(1),na(": ",e.getTroopDefense(),""),Jr(2),Lo("name","speed")("path","army"),Jr(1),na(": ",e.getTroopSpeed(),""),Jr(2),Lo("name","coins")("path","resources"),Jr(1),na(": ",e.getTroopPay(),""),Jr(3),Lo("ngForOf",e.getRecruitCost()),Jr(2),oa("",e.getTroopName()," - ",e.count,"")}}let aA=(()=>{class e{constructor(e,t){this.armyService=e,this.resourcesService=t,this.id=Math.random(),this.recruit=!1,this.progress=0,this.multiplier=0,this.recruitIndex=-1,this.dismiss=!1}ngOnInit(){this.updateSubscription=this.armyService.registerForRecruitsUpdate().subscribe(()=>{this.progressRef&&(this.progressRef.nativeElement.style.width=this.progress/this.getRecruitTime()*100+"%")})}ngAfterViewInit(){this.progressRef&&(this.progressRef.nativeElement.style.width=this.progress/this.getRecruitTime()*100+"%")}getTroopName(){return Qf.prepareTroopName(this.troop)}getResourceName(e){return Qf.prepareResourceName(e)}checkResource(e){return 0===this.resourcesService.hasResource(e.resource,e.amount*this.multiplier,"Army",!0)}isAvailable(){if(this.dismiss&&this.count>this.multiplier||this.recruit)return!0;const e=new Map;return this.getRecruitCost().forEach(t=>e.set(t.resource,t.amount)),this.resourcesService.hasResources(e,"Army",this.multiplier,!0)}getRecruitTime(){return aS.getTroop(this.troop).RECRUIT_TIME}getRecruitCost(){return aS.getTroop(this.troop).COST}getTroopStrength(){return aS.getTroop(this.troop).STRENGTH}getTroopDefense(){return aS.getTroop(this.troop).DEFENSE}getTroopPay(){return aS.getTroop(this.troop).PAY}getTroopSpeed(){return aS.getTroop(this.troop).SPEED}dismissRecruit(){this.recruit&&this.dismiss&&this.armyService.dismissRecruit(this.recruitIndex,this.multiplier)}}return e.\u0275fac=function(t){return new(t||e)(Mo(Yy),Mo(Pv))},e.\u0275cmp=Ve({type:e,selectors:[["app-troop"]],viewQuery:function(e,t){if(1&e&&il(jy,5),2&e){let e;tl(e=rl())&&(t.progressRef=e.first)}},inputs:{id:"id",troop:"troop",count:"count",recruit:"recruit",progress:"progress",multiplier:"multiplier",recruitIndex:"recruitIndex",dismiss:"dismiss"},decls:2,vars:2,consts:[["id","wrapper","class","tooltip","appTooltip","",3,"ngClass","elementId","click",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"ngClass","elementId",4,"ngIf"],["id","wrapper","appTooltip","",1,"tooltip",3,"ngClass","elementId","click"],["id","progressId"],["progressId",""],[1,"tooltipSpan",3,"id"],["class","inline",4,"ngIf"],[1,"statsTitle"],[1,"icon"],[3,"name","path"],[1,"costTitle"],[4,"ngFor","ngForOf"],["id","text"],[1,"inline"],[4,"ngIf"],["class","missing",4,"ngIf"],[1,"missing"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"ngClass","elementId"],["id","textNotAvailable"]],template:function(e,t){1&e&&(Po(0,eA,28,26,"div",0),Po(1,oA,28,26,"div",1)),2&e&&(Lo("ngIf",t.isAvailable()),Jr(1),Lo("ngIf",!t.isAvailable()))},directives:[Gu,rI,ku,sI,Uu],pipes:[Qu],styles:["#wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%;padding:3px;text-align:center;border:black solid 1px;font-size:1.2em}#wrapperNotAvailable[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%;padding:3px;text-align:center;border:#57575a solid 1px;font-size:1.2em}.dismiss[_ngcontent-%COMP%]{border:var(--negative-colour) solid 1px!important}#text[_ngcontent-%COMP%]{position:relative;z-index:2}#textNotAvailable[_ngcontent-%COMP%]{position:relative;z-index:2;color:#57575a}#progressId[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}hr[_ngcontent-%COMP%]{border-color:#000}.costTitle[_ngcontent-%COMP%]{text-align:left}.statsTitle[_ngcontent-%COMP%]{text-align:left}.tooltipSpan[_ngcontent-%COMP%]{min-width:125px}.missing[_ngcontent-%COMP%]{color:var(--negative-colour)}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}.inline[_ngcontent-%COMP%]{display:inline-block}"]}),e})();function cA(e,t){if(1&e&&(xo(0,"div"),sa(1," \xa0\xa0 "),Fo(2,"app-icon",3),sa(3),ko()),2&e){const e=Ko();Jr(2),Lo("name","protection")("path","army")("title","regions protection"),Jr(1),na("\xa0",e.getProtection()," ")}}function lA(e,t){1&e&&(xo(0,"span",19),sa(1,"No Training square available"),ko())}function uA(e,t){if(1&e){const e=Go();xo(0,"span",20),Vo("click",function(){return Dt(e),Ko().changeSelection(1)}),sa(1,"1x"),ko()}}function hA(e,t){if(1&e){const e=Go();xo(0,"span",21),Vo("click",function(){return Dt(e),Ko().changeSelection(1)}),sa(1,"1x"),ko()}}function dA(e,t){if(1&e){const e=Go();xo(0,"span",20),Vo("click",function(){return Dt(e),Ko().changeSelection(5)}),sa(1,"5x"),ko()}}function gA(e,t){if(1&e){const e=Go();xo(0,"span",21),Vo("click",function(){return Dt(e),Ko().changeSelection(5)}),sa(1,"5x"),ko()}}function pA(e,t){if(1&e){const e=Go();xo(0,"span",20),Vo("click",function(){return Dt(e),Ko().changeSelection(10)}),sa(1,"10x"),ko()}}function fA(e,t){if(1&e){const e=Go();xo(0,"span",21),Vo("click",function(){return Dt(e),Ko().changeSelection(10)}),sa(1,"10x"),ko()}}function mA(e,t){if(1&e){const e=Go();xo(0,"span",20),Vo("click",function(){return Dt(e),Ko().changeDismiss(!0)}),sa(1,"dismiss"),ko()}}function SA(e,t){if(1&e){const e=Go();xo(0,"span",21),Vo("click",function(){return Dt(e),Ko().changeDismiss(!1)}),sa(1,"dismiss"),ko()}}function EA(e,t){if(1&e){const e=Go();xo(0,"app-troop",22),Vo("click",function(){const t=Dt(e).$implicit;return Ko().recruit(t)}),ko()}if(2&e){const e=t.$implicit,i=Ko();Lo("troop",e)("multiplier",i.selection)("dismiss",i.dismiss)("count",i.getTroopSize(e))}}function vA(e,t){if(1&e){const e=Go();xo(0,"button",23),Vo("click",function(){return Dt(e),Ko().progress()}),sa(1,"recruit"),ko()}}function RA(e,t){if(1&e&&Fo(0,"app-troop",24),2&e){const e=t.$implicit,i=t.index,s=Ko();Lo("troop",e[0].troop)("recruit",!0)("count",e[0].size)("progress",e[1])("multiplier",s.selection)("recruitIndex",i)("dismiss",s.dismiss)}}function OA(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),oa(" ",i.getTroopName(e.troop),": ",e.size," ")}}function TA(e,t){if(1&e){const e=Go();xo(0,"div",25),Vo("click",function(){const t=Dt(e).$implicit;return Ko().selectMission(t)}),sa(1),xo(2,"span",26),sa(3),Fo(4,"hr"),sa(5),Fc(6,"number"),Po(7,OA,2,2,"div",27),ko(),ko()}if(2&e){const e=t.$implicit;Lo("elementId","mission-"+e.id),Jr(1),na(" ",e.getMissionName()," "),Jr(1),Qo("id","mission-",e.id,""),Jr(1),na(" ",e.getMissionName()," "),Jr(2),oa(" ",e.getStatus()," : ",Hc(6,7,e.getDisplayProgress(),"0.0-0"),"% "),Jr(2),Lo("ngForOf",e.army.units)}}let IA=(()=>{class e{constructor(e,t,i,s,r,n){this.servicesService=e,this.armyService=t,this.resourcesService=i,this.fortService=s,this.router=r,this.changeDetectorRef=n,this.selection=1,this.dismiss=!1,this.troops=[Wf.MILITIA,Wf.SPY,Wf.SPEARMAN,Wf.ARCHER,Wf.SWORDSMAN,Wf.LIGHT_CAVALRY,Wf.HORSE_ARCHER]}ngOnInit(){this.armyService.registerForRecruitsUpdate().subscribe(()=>{this.changeDetectorRef.destroyed||this.changeDetectorRef.detectChanges()})}changeSelection(e){this.selection=e}changeDismiss(e){this.dismiss=e}getTroops(){return this.armyService.getUnits()}getRecruits(){return this.armyService.getRecruits()}recruit(e){this.dismiss?this.armyService.dismiss(e,this.selection):this.armyService.recruit(e,this.selection)}isDev(){return!Am.production}progress(){this.armyService.progressRecruitment(10)}getBarracksSize(){return this.armyService.getBarracksSize()}getTroopsSize(){return this.armyService.getArmySize()}getUnemployed(){return this.resourcesService.getPeople()}getDefenseStrength(){return this.armyService.getDefenseStrength()}getAttackStrength(){return this.armyService.getAttackStrength()}checkForTrainingSquare(){return void 0!==this.fortService.getBuildings().find(e=>e.getBuildingType()===Lf.TRAINING_SQUARE)}getSoldiersPay(){return this.armyService.calculateSoldiersPay()}getPaydayCounter(){return this.armyService.getPaydayCounter()}getMissions(){return this.servicesService.getWorldService().getPlayerLandMissions().concat(this.servicesService.getWorldService().getPlayerSeaMissions().filter(e=>e.army&&e.army.getLandUnits(!1).getArmySize()>0))}selectMission(e){this.servicesService.getWorldService().setSelectedMission(e),this.router.navigate(["/world"])}getTroopSize(e){const t=this.armyService.getArmy().getUnit(e);return t?t.size:0}getTroopName(e){return Qf.prepareTroopName(e)}drop(e){this.armyService.moveRecipeInQueue(e)}getProtection(){return this.servicesService.getWorldService().getProtection()}}return e.\u0275fac=function(t){return new(t||e)(Mo(Jf),Mo(Yy),Mo(Pv),Mo(Ky),Mo(af),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-army"]],decls:41,vars:36,consts:[["id","wrapper"],["id","title"],[1,"icon"],[3,"name","path","title"],[3,"name","title","margin"],[4,"ngIf"],["id","noTrainingSquare",4,"ngIf"],["id","categories"],[1,"category"],[1,"title"],["id","numbers"],["class","number",3,"click",4,"ngIf"],["class","number active",3,"click",4,"ngIf"],[3,"troop","multiplier","dismiss","count","click",4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["id","recruitsList","cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"troop","recruit","count","progress","multiplier","recruitIndex","dismiss",4,"ngFor","ngForOf"],["id","missionsScroll"],["class","mission tooltip","appTooltip","",3,"elementId","click",4,"ngFor","ngForOf"],["id","noTrainingSquare"],[1,"number",3,"click"],[1,"number","active",3,"click"],[3,"troop","multiplier","dismiss","count","click"],[3,"click"],["cdkDrag","",3,"troop","recruit","count","progress","multiplier","recruitIndex","dismiss"],["appTooltip","",1,"mission","tooltip",3,"elementId","click"],[3,"id"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),sa(2,"Army"),ko(),xo(3,"div",2),Fo(4,"app-icon",3),sa(5),Fo(6,"app-icon",4),sa(7),Fo(8,"app-icon",3),sa(9),Fo(10,"app-icon",3),sa(11),Fo(12,"app-icon",3),sa(13),Po(14,cA,4,4,"div",5),Po(15,lA,2,0,"span",6),ko(),xo(16,"div",7),xo(17,"div",8),xo(18,"span",9),sa(19,"GARRISON"),ko(),xo(20,"div",10),Po(21,uA,2,0,"span",11),Po(22,hA,2,0,"span",12),Po(23,dA,2,0,"span",11),Po(24,gA,2,0,"span",12),Po(25,pA,2,0,"span",11),Po(26,fA,2,0,"span",12),Po(27,mA,2,0,"span",11),Po(28,SA,2,0,"span",12),ko(),Po(29,EA,1,4,"app-troop",13),ko(),xo(30,"div",8),xo(31,"span",9),sa(32,"RECRUITS"),ko(),Po(33,vA,2,0,"button",14),xo(34,"div",15),Vo("cdkDropListDropped",function(e){return t.drop(e)}),Po(35,RA,1,7,"app-troop",16),ko(),ko(),xo(36,"div",8),xo(37,"span",9),sa(38,"MISSIONS IN PROGRESS"),ko(),xo(39,"div",17),Po(40,TA,8,10,"div",18),ko(),ko(),ko(),ko()),2&e&&(Jr(4),Lo("name","barracks")("path","army")("title","Barracks"),Jr(1),oa("\xa0",t.getTroopsSize()," /",t.getBarracksSize()," \xa0\xa0 "),Jr(1),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na("\xa0",t.getUnemployed()," \xa0\xa0 "),Jr(1),Lo("name","attack")("path","army")("title","Attack strength"),Jr(1),na("\xa0",t.getAttackStrength()," \xa0\xa0 "),Jr(1),Lo("name","defense")("path","army")("title","Defense strength"),Jr(1),na("\xa0",t.getDefenseStrength()," \xa0\xa0 "),Jr(1),Lo("name","coins")("path","resources")("title","Soldiers pay (collected every 30 days)"),Jr(1),oa("\xa0",t.getSoldiersPay()," in ",t.getPaydayCounter()+1," days "),Jr(1),Lo("ngIf",t.getProtection()>0),Jr(1),Lo("ngIf",!t.checkForTrainingSquare()),Jr(6),Lo("ngIf",1!==t.selection),Jr(1),Lo("ngIf",1===t.selection),Jr(1),Lo("ngIf",5!==t.selection),Jr(1),Lo("ngIf",5===t.selection),Jr(1),Lo("ngIf",10!==t.selection),Jr(1),Lo("ngIf",10===t.selection),Jr(1),Lo("ngIf",!t.dismiss),Jr(1),Lo("ngIf",t.dismiss),Jr(1),Lo("ngForOf",t.troops),Jr(4),Lo("ngIf",t.isDev()),Jr(2),Lo("ngForOf",t.getRecruits()),Jr(5),Lo("ngForOf",t.getMissions()))},directives:[sI,Gu,Uu,sv,aA,cv,rI],pipes:[Zu],styles:["#wrapper[_ngcontent-%COMP%]{margin:.7%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#categories[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:91.5%;text-align:center}.category[_ngcontent-%COMP%]{text-align:center;flex:0 0 33%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.recruits[_ngcontent-%COMP%]{text-align:center;flex:0 0 50%;display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;border-bottom:black solid 1px}.title[_ngcontent-%COMP%]{padding:2px;width:100%;font-weight:bolder;font-size:.9em;margin-bottom:5px;display:block;border-bottom:black solid 1px}#numbers[_ngcontent-%COMP%]{margin-top:-6px;padding:0;margin-bottom:5px}.number[_ngcontent-%COMP%]{border:black solid 1px;padding:2px 4px;background-color:var(--passive-colour);font-size:.75em;cursor:pointer}.number[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}.active[_ngcontent-%COMP%]{background-color:var(--active-colour)}app-troop[_ngcontent-%COMP%]{display:inline-block;margin:4px;width:75%;font-size:.7em;cursor:pointer}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#noTrainingSquare[_ngcontent-%COMP%]{margin-left:4px;color:var(--negative-colour)}#missionsScroll[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;overflow-y:auto;align-items:center}.mission[_ngcontent-%COMP%]{padding:4px;border:black solid 1px;width:80%;cursor:pointer;margin:3px}#recruitsList[_ngcontent-%COMP%]{height:100%;width:100%}"]}),e})();class bA{constructor(e,t,i,s,r,n){this.prayer=e,this.cost=t,this.requiredFaithLevel=i,this.religion=s,this.description=r,this.effect=n}}let CA=(()=>{class e{constructor(e,t,i,s){this.servicesService=e,this.modalService=t,this.logService=i,this.resourcesService=s,this.faith=0,this.faithCap=40,this.faithLevel=1,this.faithShield=0,this.religion=Bf.NONE,this.prayers=[],e.addService(Zf.RELIGION,this),this.initPrayers()}initPrayers(){this.prayers=[],Object.entries(hS.PRAYERS).forEach(e=>{this.prayers.push(new bA(Ff[e[0]],e[1].FAITH,e[1].FAITH_LEVEL,e[1].RELIGION,e[1].DESCRIPTION,e[1].FINISH))})}getName(){return"ReligionService"}load(e){this.faith=e.faith,this.faithCap=e.faithCap,this.faithLevel=e.faithLevel,this.religion=e.religion,this.faithShield=e.faithShield,this.prayers.find(e=>e.prayer===Ff.PREACH).cost=e.preachCost}save(){return{faith:this.faith,faithCap:this.faithCap,faithLevel:this.faithLevel,religion:this.religion,faithShield:this.faithShield,preachCost:this.prayers.find(e=>e.prayer===Ff.PREACH).cost}}reset(e,t){this.faith=0,this.faithCap=40,this.faithLevel=1,this.faithShield=0,this.religion=Bf.NONE,this.prayers=[],this.initPrayers()}getFaith(){return this.faith}increaseFaith(e){this.faith<this.faithCap&&(this.faith+=e,this.faith===this.faithCap&&this.logService.success("Full faith"),this.faith>this.faithCap&&(this.faith=this.faithCap))}increaseFaithCap(e){this.faithCap+=e}decreaseFaithCap(e){this.faithCap-=e,this.faith>this.faithCap&&(this.faith=this.faithCap)}decreaseFaith(e){return this.faith-e>=0?(this.faith-=e,0):e-this.faith}getFaithCap(){return this.faithCap}getPrayers(){return this.prayers.filter(e=>(e.religion===Bf.NONE||e.religion===this.religion)&&e.requiredFaithLevel<=this.faithLevel)}pray(e){e.cost<=this.faith?(this.faith-=e.cost,e.effect(this.servicesService),e.prayer===Ff.PREACH&&(this.prayers.find(e=>e.prayer===Ff.PREACH).cost+=10)):this.modalService.info("Not enough faith for this prayer!")}increaseFaithLevel(e){this.faithLevel+=e}increaseFaithShield(e){this.faithShield+=e}decreaseFaithShield(e){if(this.faithShield>=e)return this.faithShield-=e,0;{const t=e-this.faithShield;return this.faithShield=0,t}}getFaithLevel(){return this.faithLevel}getFaithShield(){return this.faithShield}getCurrentReligion(){return this.religion}getReligionSettings(e){return hS.getReligion(e)}changeReligion(e){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to change religion?");const t=this.modalService.registerForConfirmation().subscribe(i=>{if(t.unsubscribe(),i){const t=this.getReligionSettings(e);if(this.faith<t.FAITH)return void this.modalService.info("Not enough faith");const i=new Map;if(t.OFFERING.forEach(e=>i.set(e.resource,e.amount)),!this.resourcesService.hasResources(i,"Religion",1,!0))return void this.modalService.info("Not enough offering resources");this.faith-=t.FAITH,this.resourcesService.decreaseResources(i,"Religion",!0),this.religion=e}})}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(em),gs(IS),gs(Pv))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function yA(e,t){if(1&e&&(xo(0,"div",2),xo(1,"div",3),sa(2),ko(),xo(3,"span",4),sa(4),Fo(5,"hr"),sa(6),Fo(7,"app-icon",5),ko(),ko()),2&e){const e=Ko();Lo("elementId",e.id),Jr(2),ra(e.getPrayerName()),Jr(1),$o("id",e.id),Jr(1),na(" ",e.prayer.description," "),Jr(2),na(" ",e.prayer.cost," "),Jr(1),Lo("name","faith")("path","religion")}}function AA(e,t){if(1&e&&(xo(0,"div",6),xo(1,"div",7),sa(2),ko(),xo(3,"span",4),sa(4),Fo(5,"hr"),xo(6,"div",8),sa(7),Fo(8,"app-icon",5),ko(),ko(),ko()),2&e){const e=Ko();Lo("elementId",e.id),Jr(2),ra(e.getPrayerName()),Jr(1),$o("id",e.id),Jr(1),na(" ",e.prayer.description," "),Jr(3),na(" ",e.prayer.cost," "),Jr(1),Lo("name","faith")("path","religion")}}let NA=(()=>{class e{constructor(e){this.religionService=e}ngOnInit(){}getPrayerName(){return Qf.preparePrayerName(this.prayer.prayer)}isAvailable(){return this.religionService.getFaith()>=this.prayer.cost}}return e.\u0275fac=function(t){return new(t||e)(Mo(CA))},e.\u0275cmp=Ve({type:e,selectors:[["app-prayer"]],inputs:{prayer:"prayer",id:"id"},decls:2,vars:2,consts:[["id","wrapper","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapper","appTooltip","",1,"tooltip",3,"elementId"],["id","title"],[3,"id"],[3,"name","path"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"elementId"],["id","titleGrey"],[1,"icon"]],template:function(e,t){1&e&&(Po(0,yA,8,7,"div",0),Po(1,AA,9,7,"div",1)),2&e&&(Lo("ngIf",t.isAvailable()),Jr(1),Lo("ngIf",!t.isAvailable()))},directives:[Gu,rI,sI],styles:["#wrapper[_ngcontent-%COMP%]{display:inline-block;width:47%;padding:3px;margin:3px;text-align:center;border:black solid 1px}#wrapperNotAvailable[_ngcontent-%COMP%]{display:inline-block;width:47%;padding:3px;margin:3px;text-align:center;border:#646464 solid 1px}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#646464}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e})();function _A(e,t){if(1&e){const e=Go();xo(0,"button",12),Vo("click",function(){return Dt(e),Ko().increaseFaith(10)}),sa(1,"Increase faith"),ko()}}function wA(e,t){if(1&e){const e=Go();xo(0,"div",13),xo(1,"app-prayer",14),Vo("click",function(){const t=Dt(e).$implicit;return Ko().pray(t)}),ko(),ko()}if(2&e){const e=t.$implicit,i=t.index;Jr(1),Lo("prayer",e)("id",i)}}function PA(e,t){if(1&e&&(xo(0,"div",17),sa(1),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(1),na(" ",t.getReligionName(e)," ")}}function MA(e,t){if(1&e&&(xo(0,"div",25),sa(1),ko()),2&e){const e=Ko(2).$implicit,t=Ko();Jr(1),ra(t.getReligionSettings(e).FAITH)}}function LA(e,t){if(1&e&&(xo(0,"div",26),sa(1),ko()),2&e){const e=Ko(2).$implicit,t=Ko();Jr(1),ra(t.getReligionSettings(e).FAITH)}}function DA(e,t){1&e&&(xo(0,"div"),sa(1,"offering:"),ko())}function xA(e,t){if(1&e&&(xo(0,"div",25),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.amount," ")}}function kA(e,t){if(1&e&&(xo(0,"div",26),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.amount," ")}}function FA(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",20),Po(2,xA,2,1,"div",21),Po(3,kA,2,1,"div",22),Fo(4,"app-icon",23),ko(),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(2),Lo("ngIf",i.hasResource(e)),Jr(1),Lo("ngIf",!i.hasResource(e)),Jr(1),Lo("name",i.getResourceString(e.resource))("path","resources")}}function UA(e,t){if(1&e){const e=Go();xo(0,"div",18),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().changeReligion(t)}),sa(1),xo(2,"span",19),sa(3),Fo(4,"hr"),xo(5,"div",20),Po(6,MA,2,1,"div",21),Po(7,LA,2,1,"div",22),Fo(8,"app-icon",23),ko(),Po(9,DA,2,0,"div",24),Po(10,FA,5,4,"div",11),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko();Lo("elementId",-e),Jr(1),na(" ",t.getReligionName(e)," "),Jr(1),$o("id",-e),Jr(1),na(" ",t.getReligionName(e)," "),Jr(3),Lo("ngIf",t.getFaith()>=t.getReligionSettings(e).FAITH),Jr(1),Lo("ngIf",t.getFaith()<t.getReligionSettings(e).FAITH),Jr(1),Lo("name","faith")("path","religion"),Jr(1),Lo("ngIf",t.getReligionSettings(e).OFFERING.length>0),Jr(1),Lo("ngForOf",t.getReligionSettings(e).OFFERING)}}function HA(e,t){if(1&e&&(xo(0,"div"),Po(1,PA,2,1,"div",15),Po(2,UA,11,10,"div",16),ko()),2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngIf",e===i.getCurrentReligion()),Jr(1),Lo("ngIf",e!==i.getCurrentReligion())}}let GA=(()=>{class e{constructor(e,t){this.religionService=e,this.resourcesService=t}ngOnInit(){}getFaith(){return this.religionService.getFaith()}getFaithCap(){return this.religionService.getFaithCap()}increaseFaith(e){this.religionService.increaseFaith(e)}isDev(){return!Am.production}getPrayers(){return this.religionService.getPrayers()}pray(e){this.religionService.pray(e)}getFaithShield(){return Qf.round(this.religionService.getFaithShield(),2)}getReligions(){return[Bf.NONE,Bf.FERTILITY,Bf.NATURE,Bf.TECHNOLOGY,Bf.WAR]}getReligionName(e){return Qf.prepareReligionName(e)}getCurrentReligion(){return this.religionService.getCurrentReligion()}getCurrentReligionName(){return Bf[this.getCurrentReligion()]}getCurrentReligionDisplayName(){return Qf.prepareReligionName(this.getCurrentReligion())}changeReligion(e){this.religionService.changeReligion(e)}getReligionSettings(e){return hS.getReligion(e)}getResourceString(e){return Df[e]}hasResource(e){return 0===this.resourcesService.hasResource(e.resource,e.amount,"Religion",!0)}}return e.\u0275fac=function(t){return new(t||e)(Mo(CA),Mo(Pv))},e.\u0275cmp=Ve({type:e,selectors:[["app-religion"]],decls:27,vars:14,consts:[["id","wrapper"],["id","title"],[1,"faith",3,"name","path"],[3,"click",4,"ngIf"],[1,"prayer",3,"name","title","path"],["id","table"],["id","prayers",1,"column"],[1,"tableTitle"],[3,"name","path","title"],["class","prayer",4,"ngFor","ngForOf"],["id","religions",1,"column"],[4,"ngFor","ngForOf"],[3,"click"],[1,"prayer"],[3,"prayer","id","click"],["class","religion active",4,"ngIf"],["class","religion tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],[1,"religion","active"],["appTooltip","",1,"religion","tooltip",3,"elementId","click"],[3,"id"],[1,"icon2"],["class","inline",4,"ngIf"],["class","inline notMet",4,"ngIf"],[3,"name","path"],[4,"ngIf"],[1,"inline"],[1,"inline","notMet"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),xo(2,"span"),sa(3,"Religion"),ko(),ko(),xo(4,"div"),Uo(5),sa(6,"Faith"),Ho(),Fo(7,"app-icon",2),Uo(8),sa(9,":"),Ho(),sa(10),Po(11,_A,2,0,"button",3),ko(),xo(12,"div"),sa(13," Faith shield "),Fo(14,"app-icon",4),sa(15),ko(),xo(16,"div",5),xo(17,"div",6),xo(18,"span",7),sa(19," Prayers "),Fo(20,"app-icon",8),ko(),xo(21,"div"),Po(22,wA,2,2,"div",9),ko(),ko(),xo(23,"div",10),xo(24,"span",7),sa(25,"Religions"),ko(),Po(26,HA,3,2,"div",11),ko(),ko(),ko()),2&e&&(Jr(7),Lo("name","faith")("path","religion"),Jr(3),oa(" ",t.getFaith(),"/",t.getFaithCap()," "),Jr(1),Lo("ngIf",t.isDev()),Jr(3),Lo("name","faith_shield")("title","Faith shield")("path","religion"),Jr(1),na(" : ",t.getFaithShield()," "),Jr(5),Lo("name",t.getCurrentReligionName())("path","religion")("title",t.getCurrentReligionDisplayName()),Jr(2),Lo("ngForOf",t.getPrayers()),Jr(4),Lo("ngForOf",t.getReligions()))},directives:[sI,Gu,Uu,NA,rI],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;margin:.5%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#table[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:85%}.column[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:auto;border:black solid 1px}#prayers[_ngcontent-%COMP%]{flex:0 0 70%;overflow-y:auto}#religions[_ngcontent-%COMP%]{flex:1 0 auto;overflow-y:auto}.prayer[_ngcontent-%COMP%]{display:inline}.tableTitle[_ngcontent-%COMP%]{border-bottom:black solid 1px;text-align:center}app-prayer[_ngcontent-%COMP%]{cursor:pointer}.faith[_ngcontent-%COMP%]{margin-right:-2px}.religion[_ngcontent-%COMP%]{border:black solid 1px;text-align:center;margin:3px;cursor:pointer}.active[_ngcontent-%COMP%]{background-color:var(--active-colour);cursor:auto}.tooltip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100px}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.inline[_ngcontent-%COMP%]{display:inline}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.icon2[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e})();function BA(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Demolish"),ko()}}function WA(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleDemolishMode()}),sa(1,"Stop"),ko()}}function VA(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Arrange"),ko()}}function zA(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Stop"),ko()}}function YA(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Combine"),ko()}}function KA(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleCombineMode()}),sa(1,"Stop"),ko()}}function jA(e,t){if(1&e){const e=Go();xo(0,"button",4),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Split"),ko()}}function $A(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){return Dt(e),Ko().toggleSplitMode()}),sa(1,"Stop"),ko()}}function QA(e,t){if(1&e&&(xo(0,"option",13),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("value",e),Jr(1),ra(i.getBuildingName(e))}}function qA(e,t){if(1&e&&(xo(0,"span",25),Fo(1,"app-building",26),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.fortService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function XA(e,t){if(1&e&&(xo(0,"div",21),xo(1,"div",22),xo(2,"span"),sa(3,"Buildings"),ko(),ko(),xo(4,"div",23),Po(5,qA,2,6,"span",24),ko(),ko()),2&e){const e=Ko();Jr(5),Lo("ngForOf",e.getBuildings())}}const ZA=function(e){return{activePage:e}};function JA(e,t){if(1&e){const e=Go();xo(0,"span",29),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).setPage(t)}),sa(1),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(2,ZA,i.currentPage===e)),Jr(1),na("page ",e+1,"")}}function eN(e,t){if(1&e&&(xo(0,"span",25),Fo(1,"app-building",26),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.fortService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function tN(e,t){if(1&e&&(xo(0,"div",21),xo(1,"div",27),Po(2,JA,2,4,"span",28),ko(),xo(3,"div",23),Po(4,eN,2,6,"span",24),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getPagesNumber()),Jr(2),Lo("ngForOf",e.getPagedBuildings())}}let iN=(()=>{class e extends gv{constructor(e,t,i,s,r,n,o){super(e,t,i,r,s,n,o,Kf.FORT),this.landService=t,this.fortService=r}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(yS),Mo(Ky),Mo(vS),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-fort"]],features:[fo],decls:48,vars:24,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"button",4),Vo("click",function(){return t.openBuildModal()}),sa(6,"Build"),ko(),Po(7,BA,2,0,"button",5),Po(8,WA,2,0,"button",6),Po(9,VA,2,0,"button",5),Po(10,zA,2,0,"button",6),Po(11,YA,2,0,"button",5),Po(12,KA,2,0,"button",6),Po(13,jA,2,0,"button",5),Po(14,$A,2,0,"button",6),xo(15,"button",7),sa(16,"Actions "),Fo(17,"img",8),xo(18,"ul",9),xo(19,"li",4),Vo("click",function(){return t.autoSort()}),sa(20,"Sort"),ko(),ko(),ko(),xo(21,"div",10),sa(22," Filter:"),Fo(23,"br"),xo(24,"div",11),xo(25,"select",12),Vo("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),xo(26,"option",13),sa(27),ko(),Po(28,QA,2,2,"option",14),ko(),xo(29,"select",12),Vo("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),xo(30,"option",13),sa(31,"All"),ko(),xo(32,"option",13),sa(33,"Working"),ko(),xo(34,"option",13),sa(35,"Idle"),ko(),ko(),ko(),ko(),ko(),xo(36,"div",15),Fo(37,"app-icon",16),sa(38),Fo(39,"app-icon",17),sa(40),xo(41,"div",18),xo(42,"button",4),Vo("click",function(){return t.enableAll()}),sa(43,"all on"),ko(),xo(44,"button",4),Vo("click",function(){return t.disableAll()}),sa(45,"all off"),ko(),ko(),ko(),Po(46,XA,6,1,"div",19),Po(47,tN,5,2,"div",19),ko(),ko()),2&e&&(Jr(7),Lo("ngIf",!t.demolishMode),Jr(1),Lo("ngIf",t.demolishMode),Jr(1),Lo("ngIf",!t.arrangeMode&&t.getBuildings().length>1),Jr(1),Lo("ngIf",t.arrangeMode),Jr(1),Lo("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),Jr(1),Lo("ngIf",t.combineMode),Jr(1),Lo("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),Jr(1),Lo("ngIf",t.splitMode),Jr(11),Lo("ngModel",t.filterBuilding),Jr(1),Lo("value",t.allBuildings),Jr(1),ra(t.getBuildingName(t.allBuildings)),Jr(1),Lo("ngForOf",t.getUniqueBuildingsFromCurrentView()),Jr(1),Lo("ngModel",t.filterWorking),Jr(1),Lo("value",t.buildingStates.ALL),Jr(2),Lo("value",t.buildingStates.WORKING),Jr(2),Lo("value",t.buildingStates.IDLE),Jr(3),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na(" ",t.getUnemployed()," \xa0\xa0\xa0 "),Jr(1),Lo("name","land"),Jr(1),na(" ",t.getFreeLand()," "),Jr(6),Lo("ngIf",!t.isPagedViewEnabled()),Jr(1),Lo("ngIf",t.isPagedViewEnabled()))},directives:[FO,Gu,VT,dT,MT,zT,$T,Uu,sI,lb,ku],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",""]}),e})();class sN{constructor(e,t,i,s,r,n){this.id=e,this.resource=t,this.amount=i,this.buy=s,this.price=r,this.duration=n}}let rN=(()=>{class e{constructor(e,t,i,s,r,n,o){this.servicesService=e,this.calendarService=t,this.managementService=i,this.resourcesService=s,this.logService=r,this.soundService=n,this.modalService=o,this.offers=[],this.id=10,this.typeRadio="all",this.servicesService.addService(Zf.MARKET,this),this.calendarService.registerForDayChange().subscribe(e=>{this.offers.forEach(e=>{e.duration-=1,0===e.duration&&this.autoBuy([e])}),this.offers=this.offers.filter(e=>e.duration>0)})}autoBuy(e){e.forEach(e=>{let t=e.amount;const i=this.resourcesService.getResource(e.resource);if(e.buy&&i.options.autoTrade.autoBuyEnabled){let s=i.options.autoTrade.autoBuyAmount;i.options.autoTrade.autoBuyPercentage&&(s=Math.floor(i.limit*i.options.autoTrade.autoBuyAmount/100));let r=i.options.autoTrade.autoBuyOrder;i.amount+r<s&&s-i.amount>r&&(r=s-i.amount),t>r&&(t=r);const n=this.resourcesService.getLimit(e.resource);t>n&&(t=n),t>0&&this.resourcesService.decreaseResource(Df.COINS,this.calculatePrice(e,t),"Auto trade",!0)&&(this.resourcesService.increaseResource(e.resource,t,"Auto trade",!0),i.options.autoTrade.autoBuyOrder>0&&(i.options.autoTrade.autoBuyOrder-=t,i.options.autoTrade.autoBuyOrder<0&&(i.options.autoTrade.autoBuyOrder=0)),this.managementService.getLogAutoTrade()&&this.logService.log("auto bought "+t+" "+Qf.prepareResourceName(e.resource))),e.amount===Number(t)?this.offers.splice(this.offers.indexOf(e),1):(e.price=this.calculatePrice(e,e.amount-t),e.amount-=t)}else if(!e.buy&&i.options.autoTrade.autoSellEnabled){let s=i.options.autoTrade.autoSellAmount;i.options.autoTrade.autoSellPercentage&&(s=Math.floor(i.limit*i.options.autoTrade.autoSellAmount/100));let r=i.options.autoTrade.autoSellOrder;s<i.amount-r&&(r=i.amount-s),t>r&&(t=r),t>0&&this.resourcesService.decreaseResource(e.resource,t,"Auto trade",!0)&&(this.resourcesService.increaseResource(Df.COINS,this.calculatePrice(e,t),"Auto trade",!0),i.options.autoTrade.autoSellOrder>0&&(i.options.autoTrade.autoSellOrder-=t,i.options.autoTrade.autoSellOrder<0&&(i.options.autoTrade.autoSellOrder=0)),this.managementService.getLogAutoTrade()&&this.logService.log("auto sold "+t+" "+Qf.prepareResourceName(e.resource))),e.amount===Number(t)?this.offers.splice(this.offers.indexOf(e),1):(e.price=this.calculatePrice(e,e.amount-t),e.amount-=t)}})}nextId(){return this.id+=1,this.id-1}getName(){return"MarketService"}load(e){this.offers=e.offers,this.id=e.id}save(){return{offers:this.offers,id:this.id}}reset(e,t){this.offers=[],this.id=10}getOffers(){return this.offers}accept(e){const t=this.offers.find(t=>t.id===e);let i=!1;if(t){this.modalService.open(Pf.MARKET),this.modalService.setModalValue(t);const e=this.modalService.registerForValueResponse().subscribe(s=>{if(e.unsubscribe(),null!==s&&!isNaN(s)){if(s>t.amount&&(s=t.amount),t.buy)if(s>this.resourcesService.getLimit(t.resource)){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Selected amount exceeds available warehouse space.<br>Would you like to buy anyway?");const e=this.modalService.registerForConfirmation().subscribe(i=>{if(e.unsubscribe(),i){if(!this.resourcesService.decreaseResource(Df.COINS,this.calculatePrice(t,s),"Market",!0))return void this.modalService.info("Not enough coins to buy "+s+" "+Qf.prepareResourceName(t.resource));this.resourcesService.increaseResource(t.resource,s,"Market",!0),t.amount===Number(s)?this.offers.splice(this.offers.indexOf(t),1):(t.price=this.calculatePrice(t,t.amount-s),t.amount-=s)}})}else{if(!this.resourcesService.decreaseResource(Df.COINS,this.calculatePrice(t,s),"Market",!0))return void this.modalService.info("Not enough coins to buy "+s+" "+Qf.prepareResourceName(t.resource));this.resourcesService.increaseResource(t.resource,s,"Market",!0),i=!0}else{if(!this.resourcesService.decreaseResource(t.resource,s,"Market",!0))return void this.modalService.info("Not enough resources to sell");this.resourcesService.increaseResource(Df.COINS,this.calculatePrice(t,s),"Market",!0),i=!0}i&&(t.amount===Number(s)?this.offers.splice(this.offers.indexOf(t),1):(t.price=this.calculatePrice(t,t.amount-s),t.amount-=s))}})}else this.modalService.info("Market offer not found")}callMerchant(){const e=Array.from(this.resourcesService.getResources().values()).filter(e=>e.isVisible()).map(e=>({item:e.resource,chance:e.prioritise?15:1})),t=am.randomBetween(3,8),i=am.randomBetween(50,180);for(let s=0;s<t;s++){const t=am.randomWeightedExcept(e,[Df.COINS]),r=am.randomBetween(5,20),n=am.randomBetween(0,1),o=am.randomBetween(-5,25);let a=oS.getResource(t).TRADE_VALUE*r;a=n?Math.floor(a*(1+o/100)):Math.floor(a*(1-o/100)),0===a?s--:this.offers.push(new sN(this.nextId(),t,r,!!n,a,i))}this.managementService.getLogMerchant()&&this.logService.log("Merchant arrived"),this.soundService.playMarket(),this.autoBuy(this.offers)}calculatePrice(e,t){return e.buy?Math.ceil(t/e.amount*e.price):Math.floor(t/e.amount*e.price)}dismiss(e){this.offers=this.offers.filter(t=>t.id!==e)}getTypeRadio(){return this.typeRadio}setTypeRadio(e){this.typeRadio=e}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(OS),gs(PO),gs(Pv),gs(IS),gs(RS),gs(em))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function nN(e,t){1&e&&(xo(0,"span",18),sa(1,"No Marketplace available. No merchant will visit."),ko())}function oN(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(1),na("",t.getResourceName(e.resource)," buy offer")}}function aN(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(1),na("",t.getResourceName(e.resource)," sell offer")}}function cN(e,t){if(1&e){const e=Go();xo(0,"button",24),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().accept(t.id)}),sa(1,"Buy"),ko()}}function lN(e,t){if(1&e){const e=Go();xo(0,"button",24),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().accept(t.id)}),sa(1,"Sell"),ko()}}function uN(e,t){if(1&e){const e=Go();xo(0,"button",24),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().dismiss(t.id)}),sa(1,"Dismiss"),ko()}}function hN(e,t){if(1&e&&(xo(0,"div",19),xo(1,"span",20),Po(2,oN,2,1,"div",21),Po(3,aN,2,1,"div",21),Fo(4,"hr"),sa(5),Fo(6,"br"),sa(7),Fo(8,"br"),Fo(9,"br"),sa(10),ko(),xo(11,"div",22),sa(12),Fo(13,"app-icon",3),ko(),xo(14,"div",22),sa(15),Fo(16,"app-icon",3),ko(),xo(17,"div",22),sa(18),ko(),xo(19,"div"),Po(20,cN,2,0,"button",23),Po(21,lN,2,0,"button",23),Po(22,uN,2,0,"button",23),ko(),ko()),2&e){const e=t.$implicit,i=Ko();Lo("elementId",e.id),Jr(1),$o("id",e.id),Jr(1),Lo("ngIf",e.buy),Jr(1),Lo("ngIf",!e.buy),Jr(2),na(" total price: ",e.price,""),Jr(2),na(" piece price: ",i.calculatePiecePrice(e),""),Jr(3),oa(" storage: ",i.getResourceAmount(e),"/",i.getResourceLimit(e)," "),Jr(2),na(" ",e.amount," "),Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources"),Jr(2),na(" ",e.price," "),Jr(1),Lo("name","coins")("path","resources"),Jr(2),na(" ",e.duration," days "),Jr(2),Lo("ngIf",e.buy),Jr(1),Lo("ngIf",!e.buy),Jr(1),Lo("ngIf",i.dismissMode)}}let dN=(()=>{class e{constructor(e,t,i){this.marketService=e,this.villageService=t,this.resourcesService=i,this.filterText="",this.typeRadio="all",this.dismissMode=!1}ngOnInit(){this.typeRadio=this.marketService.getTypeRadio()}getOffers(){let e;return e=null!==this.filterText&&this.filterText.length>0?this.marketService.getOffers().filter(e=>Qf.prepareResourceName(e.resource).toLowerCase().includes(this.filterText)):this.marketService.getOffers(),"buy"===this.typeRadio?e=e.filter(e=>e.buy):"sell"===this.typeRadio&&(e=e.filter(e=>!e.buy)),e}getCoins(){return this.resourcesService.getResource(Df.COINS).amount}accept(e){this.marketService.accept(e)}isMarketBuilt(){return void 0!==this.villageService.getBuildings().find(e=>e.getBuildingType()===Lf.MARKETPLACE)}getResourceName(e){return Qf.prepareResourceName(e)}calculatePiecePrice(e){return this.marketService.calculatePrice(e,1)}getResourceAmount(e){return this.resourcesService.getResource(e.resource).amount}getResourceLimit(e){return this.resourcesService.getResource(e.resource).limit}dismiss(e){this.marketService.dismiss(e)}updateTypeRadio(){this.marketService.setTypeRadio(this.typeRadio)}}return e.\u0275fac=function(t){return new(t||e)(Mo(rN),Mo(wO),Mo(Pv))},e.\u0275cmp=Ve({type:e,selectors:[["app-market"]],decls:47,vars:10,consts:[["id","wrapper"],["id","title"],[1,"icon"],[3,"name","path"],["id","noMarket",4,"ngIf"],["id","market"],["id","offersBox"],[1,"boxTitle"],["id","headers"],["id","offers"],["class","offer tooltip","appTooltip","",3,"elementId",4,"ngFor","ngForOf"],["id","filterBox"],["id","filters"],["id","filter","type","text","placeholder","search",3,"ngModel","ngModelChange"],["type","radio","name","type","value","all",3,"ngModel","ngModelChange","change"],["type","radio","name","type","value","buy",3,"ngModel","ngModelChange","change"],["type","radio","name","type","value","sell",3,"ngModel","ngModelChange","change"],["type","checkbox","name","type","value","dismiss",3,"ngModel","ngModelChange"],["id","noMarket"],["appTooltip","",1,"offer","tooltip",3,"elementId"],[1,"tooltipOffer",3,"id"],[4,"ngIf"],[1,"icon2"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),xo(2,"span"),sa(3,"Market"),ko(),ko(),xo(4,"div",2),Fo(5,"app-icon",3),sa(6),Po(7,nN,2,0,"span",4),ko(),xo(8,"div",5),xo(9,"div",6),xo(10,"div",7),xo(11,"span"),sa(12,"Offers"),ko(),ko(),xo(13,"div",8),xo(14,"span"),sa(15,"offer"),ko(),xo(16,"span"),sa(17,"price"),ko(),xo(18,"span"),sa(19,"duration"),ko(),xo(20,"span"),sa(21,"action"),ko(),ko(),xo(22,"div",9),Po(23,hN,23,18,"div",10),ko(),ko(),xo(24,"div",11),xo(25,"div",7),xo(26,"span"),sa(27,"Filters"),ko(),ko(),xo(28,"div",12),xo(29,"input",13),Vo("ngModelChange",function(e){return t.filterText=e}),ko(),xo(30,"div"),xo(31,"label"),xo(32,"input",14),Vo("ngModelChange",function(e){return t.typeRadio=e})("change",function(){return t.updateTypeRadio()}),ko(),sa(33," All "),ko(),Fo(34,"br"),xo(35,"label"),xo(36,"input",15),Vo("ngModelChange",function(e){return t.typeRadio=e})("change",function(){return t.updateTypeRadio()}),ko(),sa(37," Buy "),ko(),Fo(38,"br"),xo(39,"label"),xo(40,"input",16),Vo("ngModelChange",function(e){return t.typeRadio=e})("change",function(){return t.updateTypeRadio()}),ko(),sa(41," Sell "),ko(),Fo(42,"br"),Fo(43,"br"),xo(44,"label"),xo(45,"input",17),Vo("ngModelChange",function(e){return t.dismissMode=e}),ko(),sa(46," Dismiss "),ko(),ko(),ko(),ko(),ko(),ko()),2&e&&(Jr(5),Lo("name","coins")("path","resources"),Jr(1),na(" ",t.getCoins()," "),Jr(1),Lo("ngIf",!t.isMarketBuilt()),Jr(16),Lo("ngForOf",t.getOffers()),Jr(6),Lo("ngModel",t.filterText),Jr(3),Lo("ngModel",t.typeRadio),Jr(4),Lo("ngModel",t.typeRadio),Jr(4),Lo("ngModel",t.typeRadio),Jr(5),Lo("ngModel",t.dismissMode))},directives:[sI,Gu,Uu,KO,dT,MT,UT,VO,rI],styles:["#wrapper[_ngcontent-%COMP%]{margin:.5%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.boxTitle[_ngcontent-%COMP%]{text-align:center;border-bottom:black solid 2px}#side[_ngcontent-%COMP%]{float:right;font-size:1em;width:25%;margin:.5%;display:inline-block;vertical-align:bottom}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}#headers[_ngcontent-%COMP%]{margin:3px 3px 0;display:flex;flex-direction:row;width:96.5%;text-align:center;font-size:1em;font-weight:bold}#headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:0 0 24%;padding:2px;border:black solid 1px;border-left:none}#headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{border-left:black solid 1px}#market[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 2px;height:91.5%}#offersBox[_ngcontent-%COMP%]{display:flex;flex:0 0 85%;flex-direction:column;border-right:black solid 2px;height:100%;font-size:1.2em}#filterBox[_ngcontent-%COMP%]{display:flex;flex:0 0 15%;flex-direction:column;height:100%;font-size:1.2em}#offers[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:100%;overflow-y:auto}.offer[_ngcontent-%COMP%]{flex:0 0 auto;width:98%;display:flex;flex-direction:row;border:black solid 1px;margin:3px}.offer[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:0 0 24%;padding:2px}.offer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.8em}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}#filter[_ngcontent-%COMP%]{width:90%}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.icon2[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}#noMarket[_ngcontent-%COMP%]{margin-left:112px;color:var(--negative-colour)}"]}),e})(),gN=(()=>{class e{constructor(e,t,i){this.servicesService=e,this.calendarService=t,this.optionsService=i,this.forecastPeriod=1,this.forecast=[],e.addService(Zf.WEATHER,this),this.tick(0)}getName(){return"WeatherService"}load(e){this.forecastPeriod=void 0!==e.forecastPeriod?e.forecastPeriod:1,this.forecast=e.forecast}save(){return{forecastPeriod:this.forecastPeriod,forecast:this.forecast}}reset(e,t){this.forecastPeriod=1,this.forecast=[],this.today=null,this.tick(0)}tick(e){const t=this.calendarService.getAbsoluteDay();for(;this.forecast.length>0&&this.forecast[0][0]<t;)this.forecast.shift();for(;this.forecast.length<this.forecastPeriod;){let e=t;0!==this.forecast.length&&(e=this.forecast[this.forecast.length-1][0]+1),this.forecast.push(this.predictDay(e))}this.today=this.forecast[0]}predictDay(e){let t,i;switch(this.calendarService.getSeasonForAbsoluteDay(e)){case SS.SPRING:t=am.randomBetween(10,25),i=am.randomElement([{item:im.SUN,chance:40},{item:im.CLOUDS,chance:25},{item:im.WIND,chance:14},{item:im.RAIN,chance:20},{item:im.STORM,chance:1}]);break;case SS.SUMMER:t=am.randomBetween(15,35),i=am.randomElement([{item:im.SUN,chance:50},{item:im.CLOUDS,chance:10},{item:im.WIND,chance:10},{item:im.RAIN,chance:20},{item:im.STORM,chance:10}]);break;case SS.AUTUMN:t=am.randomBetween(10,25),i=am.randomElement([{item:im.SUN,chance:20},{item:im.CLOUDS,chance:40},{item:im.WIND,chance:10},{item:im.RAIN,chance:25},{item:im.STORM,chance:5}]);break;case SS.WINTER:t=am.randomBetween(-20,5),i=am.randomElement([{item:im.SUN,chance:30},{item:im.CLOUDS,chance:20},{item:im.WIND,chance:15},{item:im.SNOW,chance:25},{item:im.STORM,chance:10}])}return[e,i,t]}getCurrentWeather(){return this.today[1]}getCurrentTemperature(){return this.optionsService.getOption(Xf.METRIC)?this.today[2]:1.8*this.today[2]+32}increaseForecastPeriod(e){this.forecastPeriod+=e}isWeather(...e){return e.includes(this.getCurrentWeather())}getForecast(){return this.forecast}getForecastPeriod(){return this.forecastPeriod}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(OS),gs(vS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function pN(e,t){if(1&e){const e=Go();xo(0,"button",5),Vo("click",function(){return Dt(e),Ko().progress10Days()}),sa(1,"Progress 10 days"),ko()}}function fN(e,t){1&e&&(xo(0,"span"),sa(1,"\xb0C"),ko())}function mN(e,t){1&e&&(xo(0,"span"),sa(1,"\xb0F"),ko())}function SN(e,t){1&e&&(xo(0,"span",11),sa(1,"today"),ko())}function EN(e,t){if(1&e&&(xo(0,"span",11),sa(1),ko()),2&e){const e=Ko().index;Jr(1),na("+",e,"")}}function vN(e,t){1&e&&(xo(0,"span"),sa(1,"\xb0C"),ko())}function RN(e,t){1&e&&(xo(0,"span"),sa(1,"\xb0F"),ko())}function ON(e,t){if(1&e&&(xo(0,"div",8),Po(1,SN,2,0,"span",9),Po(2,EN,2,1,"span",9),Fo(3,"app-icon",3),xo(4,"span",10),sa(5),Fc(6,"number"),Po(7,vN,2,0,"span",4),Po(8,RN,2,0,"span",4),ko(),ko()),2&e){const e=t.$implicit,i=t.index,s=Ko(2);Jr(1),Lo("ngIf",0===i),Jr(1),Lo("ngIf",0!==i),Jr(1),Lo("name",s.getWeatherName(e[1]))("path","weather"),Jr(2),ra(Hc(6,7,s.calculateTemp(e[2]),"0.0-1")),Jr(2),Lo("ngIf",s.metric),Jr(1),Lo("ngIf",!s.metric)}}function TN(e,t){if(1&e&&(xo(0,"div"),sa(1,"Weather forecast: "),xo(2,"div",6),Po(3,ON,9,10,"div",7),ko(),ko()),2&e){const e=Ko();Jr(3),Lo("ngForOf",e.getForecast())}}let IN=(()=>{class e{constructor(e,t,i){this.weatherService=e,this.calendarService=t,this.optionsService=i,this.metric=this.optionsService.getOption(Xf.METRIC),this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(()=>this.metric=this.optionsService.getOption(Xf.METRIC)))}ngOnInit(){}getTodayWeather(){return this.weatherService.getCurrentWeather()}getTodayTemperature(){return this.weatherService.getCurrentTemperature()}getWeatherName(e){return im[e].toLowerCase()}getForecast(){return this.weatherService.getForecast()}getForecastPeriod(){return this.weatherService.getForecastPeriod()}calculateTemp(e){return this.optionsService.getOption(Xf.METRIC)?e:1.8*e+32}isDev(){return!Am.production}progress10Days(){this.calendarService.progressDays(10)}}return e.\u0275fac=function(t){return new(t||e)(Mo(gN),Mo(OS),Mo(vS))},e.\u0275cmp=Ve({type:e,selectors:[["app-weather"]],decls:13,vars:11,consts:[["id","wrapper"],["id","title"],[3,"click",4,"ngIf"],[3,"name","path"],[4,"ngIf"],[3,"click"],["id","forecast"],["class","weather",4,"ngFor","ngForOf"],[1,"weather"],["class","day",4,"ngIf"],["id","temp"],[1,"day"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),xo(2,"span"),sa(3,"Weather"),ko(),ko(),Po(4,pN,2,0,"button",2),sa(5),Fo(6,"app-icon",3),Fo(7,"br"),sa(8),Fc(9,"number"),Po(10,fN,2,0,"span",4),Po(11,mN,2,0,"span",4),Po(12,TN,4,1,"div",4),ko()),2&e&&(Jr(4),Lo("ngIf",t.isDev()),Jr(1),na(" Weather: ",t.getWeatherName(t.getTodayWeather())," "),Jr(1),Lo("name",t.getWeatherName(t.getTodayWeather()))("path","weather"),Jr(2),na(" Temperature: ",Hc(9,8,t.getTodayTemperature(),"0.0-1"),""),Jr(2),Lo("ngIf",t.metric),Jr(1),Lo("ngIf",!t.metric),Jr(1),Lo("ngIf",t.getForecastPeriod()>1))},directives:[Gu,sI,Uu],pipes:[Zu],styles:["#wrapper[_ngcontent-%COMP%]{margin:.5%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#forecast[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;text-align:center;overflow-x:auto}.weather[_ngcontent-%COMP%]{display:flex;flex:0 0 40px;flex-direction:column;border-right:black solid 1px}.day[_ngcontent-%COMP%]{width:60px;border-bottom:black solid 1px}"]}),e})(),bN=(()=>{class e{constructor(e,t){this.gameService=e,this.router=t,this.lastRegion=Kf.VILLAGE}canActivate(e,t){switch(e.routeConfig.path){case"redirect":const e="/regions/"+Kf[this.lastRegion].toLowerCase();return this.router.navigate([e],{skipLocationChange:!1}),!1;case"crafting":return!!this.gameService.isEnabled(Mf.CRAFTING)||(this.goToError(),!1);case"market":return!!this.gameService.isEnabled(Mf.MARKET)||(this.goToError(),!1);case"research":return!!this.gameService.isEnabled(Mf.RESEARCH)||(this.goToError(),!1);case"army":return!!this.gameService.isEnabled(Mf.ARMY)||(this.goToError(),!1);case"religion":return!!this.gameService.isEnabled(Mf.RELIGION)||(this.goToError(),!1);case"weather":return!!this.gameService.isEnabled(Mf.WEATHER)||(this.goToError(),!1);case"world":return!!this.gameService.isEnabled(Mf.CARTOGRAPHY)||(this.goToError(),!1);case"navy":return!!this.gameService.isEnabled(Mf.NAVY)||(this.goToError(),!1);case"heritage":return!!this.gameService.isEnabled(Mf.HERITAGE)||(this.goToError(),!1);case"village":return this.lastRegion=Kf.VILLAGE,!0;case"forest":return this.lastRegion=Kf.FOREST,!0;case"mountains":return this.gameService.isEnabled(Mf.MOUNTAINS)?(this.lastRegion=Kf.MOUNTAINS,!0):(this.goToError(),!1);case"fort":return this.gameService.isEnabled(Mf.FORT)?(this.lastRegion=Kf.FORT,!0):(this.goToError(),!1);case"sea":return this.gameService.isEnabled(Mf.SEA)?(this.lastRegion=Kf.SEA,!0):(this.goToError(),!1);case"field":return this.gameService.isEnabled(Mf.FIELD)?(this.lastRegion=Kf.FIELD,!0):(this.goToError(),!1);case"plateau":return this.gameService.isEnabled(Mf.PLATEAU)?(this.lastRegion=Kf.PLATEAU,!0):(this.goToError(),!1);default:return!1}}goToError(){this.router.navigate(["/404"],{skipLocationChange:!0})}}return e.\u0275fac=function(t){return new(t||e)(gs(AS),gs(af))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),CN=(()=>{class e{constructor(e){this.router=e}ngOnInit(){}goToVillage(){this.router.navigate(["/village"])}}return e.\u0275fac=function(t){return new(t||e)(Mo(af))},e.\u0275cmp=Ve({type:e,selectors:[["app-not-found"]],decls:5,vars:0,consts:[["id","wrapper"],[3,"click"]],template:function(e,t){1&e&&(xo(0,"div",0),sa(1," Page not found "),Fo(2,"br"),xo(3,"button",1),Vo("click",function(){return t.goToVillage()}),sa(4,"Village"),ko(),ko())},styles:["#wrapper[_ngcontent-%COMP%]{margin:10px;font-size:4vw;text-align:center}button[_ngcontent-%COMP%]{font-size:1.5vw}"]}),e})();function yN(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),oa(" Usages: ",e.perk.usages,"/",e.perk.maxUsages," ")}}function AN(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na(" Usages: ",e.perk.usages,"/unlimited ")}}function NN(e,t){if(1&e){const e=Go();xo(0,"div",2),Vo("click",function(){return Dt(e),Ko().unlock()}),xo(1,"div",3),xo(2,"div",4),sa(3),ko(),ko(),xo(4,"span",5),Fo(5,"div",6),Fo(6,"br"),Fo(7,"hr"),sa(8),Fo(9,"br"),Po(10,yN,2,2,"div",7),Po(11,AN,2,1,"div",7),ko(),ko()}if(2&e){const e=Ko();Lo("elementId",e.id),Jr(3),na(" ",e.getPerkName()," "),Jr(1),$o("id",e.id),Jr(1),Lo("innerHTML",e.perk.description,Js),Jr(3),na(" Cost: ",e.perk.cost," RP "),Jr(2),Lo("ngIf",e.perk.maxUsages>0),Jr(1),Lo("ngIf",0===e.perk.maxUsages)}}function _N(e,t){1&e&&Fo(0,"app-icon",11),2&e&&Lo("name","tick")}function wN(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),oa(" Usages: ",e.perk.usages,"/",e.perk.maxUsages," ")}}function PN(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na(" Usages: ",e.perk.usages,"/unlimited ")}}function MN(e,t){if(1&e&&(xo(0,"div",8),xo(1,"div",9),xo(2,"div",4),Po(3,_N,1,1,"app-icon",10),sa(4),ko(),ko(),xo(5,"span",5),Fo(6,"div",6),Fo(7,"br"),Fo(8,"hr"),sa(9),Fo(10,"br"),Po(11,wN,2,2,"div",7),Po(12,PN,2,1,"div",7),ko(),ko()),2&e){const e=Ko();Lo("elementId",e.id),Jr(3),Lo("ngIf",e.perk.usages===e.perk.maxUsages&&e.perk.maxUsages>0),Jr(1),na("",e.getPerkName()," "),Jr(1),$o("id",e.id),Jr(1),Lo("innerHTML",e.perk.description,Js),Jr(3),na(" Cost: ",e.perk.cost," RP "),Jr(2),Lo("ngIf",e.perk.maxUsages>0),Jr(1),Lo("ngIf",0===e.perk.maxUsages)}}let LN=(()=>{class e{constructor(e){this.royalService=e,this.id=Math.random()}ngOnInit(){}getPerkName(){return Qf.preparePerkName(this.perk.perk)}unlock(){this.royalService.unlock(this.perk)}isAvailable(){return this.royalService.getRoyalPoints()>=this.perk.cost&&(0===this.perk.maxUsages||this.perk.usages<this.perk.maxUsages)}}return e.\u0275fac=function(t){return new(t||e)(Mo(_v))},e.\u0275cmp=Ve({type:e,selectors:[["app-royal-perk"]],inputs:{perk:"perk"},decls:2,vars:2,consts:[["id","wrapper","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapper","appTooltip","",1,"tooltip",3,"elementId","click"],["id","text"],[1,"icon"],[1,"perkTooltip",3,"id"],[3,"innerHTML"],[4,"ngIf"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"elementId"],["id","titleGrey"],[3,"name",4,"ngIf"],[3,"name"]],template:function(e,t){1&e&&(Po(0,NN,12,7,"div",0),Po(1,MN,13,8,"div",1)),2&e&&(Lo("ngIf",t.isAvailable()),Jr(1),Lo("ngIf",!t.isAvailable()))},directives:[Gu,rI,sI],styles:["#wrapper[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:black solid 1px;font-size:1.2em}#wrapperNotAvailable[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:#57575a solid 1px;cursor:auto;cursor:initial;font-size:1.2em}#text[_ngcontent-%COMP%]{display:inline-block}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#57575a}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}app-icon[_ngcontent-%COMP%]{margin-top:-15px;height:17px}.perkTooltip[_ngcontent-%COMP%]{min-width:400px}"]}),e})();function DN(e,t){1&e&&Fo(0,"app-royal-perk",8),2&e&&Lo("perk",t.$implicit)}function xN(e,t){1&e&&Fo(0,"app-royal-perk",8),2&e&&Lo("perk",t.$implicit)}function kN(e,t){1&e&&(xo(0,"span"),Fo(1,"app-icon",9),ko()),2&e&&(Jr(1),Lo("name","fish")("path","resources")("title","golden fish"))}function FN(e,t){1&e&&(xo(0,"span"),Fo(1,"app-icon",9),ko()),2&e&&(Jr(1),Lo("name","egg")("path","resources")("title","golden egg"))}function UN(e,t){1&e&&(xo(0,"span"),Fo(1,"app-icon",9),ko()),2&e&&(Jr(1),Lo("name","apple")("path","resources")("title","golden apple"))}function HN(e,t){1&e&&(xo(0,"span"),Fo(1,"app-icon",9),ko()),2&e&&(Jr(1),Lo("name","wool")("path","resources")("title","golden fleece"))}let GN=(()=>{class e{constructor(e,t){this.logService=e,this.royalService=t}ngOnInit(){}buyRoyalPoints(){this.royalService.buyRoyalPoints()}getRoyalPoints(){return this.royalService.getRoyalPoints()}getRoyalPerks(){return this.royalService.getRoyalPerks()}isGoldenFishCaught(){return this.royalService.isGoldenFishCaught()}isGoldenEggFound(){return this.royalService.isGoldenEggLaid()}isGoldenApplePicked(){return this.royalService.isGoldenApplePicked()}isGoldenFleeceFound(){return this.royalService.isGoldenFleeceFound()}getOneTimeUseRoyalPerks(){return this.royalService.getRoyalPerks().filter(e=>e.perk===xf.MOTIVATION_SPEECH||e.perk===xf.JESTER||e.perk===xf.CALL_TO_ARMS||e.perk===xf.ASTROLOGICAL_NOTE||e.perk===xf.ROYAL_FESTIVAL||e.perk===xf.ROYAL_RESERVE||e.perk===xf.ANCIENT_SEA_MAPS||e.perk===xf.HIRE_MERCENARIES||e.perk===xf.HIRE_PIRATES||e.perk===xf.ANCIENT_PROTECTION||e.perk===xf.ROYAL_TRADITIONS)}getPermanentUseRoyalPerks(){return this.royalService.getRoyalPerks().filter(e=>e.perk!==xf.MOTIVATION_SPEECH&&e.perk!==xf.JESTER&&e.perk!==xf.CALL_TO_ARMS&&e.perk!==xf.ASTROLOGICAL_NOTE&&e.perk!==xf.ROYAL_FESTIVAL&&e.perk!==xf.ROYAL_RESERVE&&e.perk!==xf.ANCIENT_SEA_MAPS&&e.perk!==xf.HIRE_MERCENARIES&&e.perk!==xf.HIRE_PIRATES&&e.perk!==xf.ANCIENT_PROTECTION&&e.perk!==xf.ROYAL_TRADITIONS)}}return e.\u0275fac=function(t){return new(t||e)(Mo(IS),Mo(_v))},e.\u0275cmp=Ve({type:e,selectors:[["app-royal"]],decls:30,vars:7,consts:[["id","wrapper"],["id","title"],[1,"bold"],[3,"click"],[1,"groupTitle"],[3,"perk",4,"ngFor","ngForOf"],["id","goldenItems"],[4,"ngIf"],[3,"perk"],[3,"name","path","title"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"span",1),sa(2,"Royal perks"),ko(),Fo(3,"br"),xo(4,"span"),sa(5,"You have "),xo(6,"span",2),sa(7),ko(),sa(8," royal points."),Fo(9,"br"),sa(10," You can use them to acquire special upgrades."),ko(),xo(11,"div"),xo(12,"button",3),Vo("click",function(){return t.buyRoyalPoints()}),sa(13,"Buy Royal points"),ko(),ko(),xo(14,"div"),xo(15,"div",4),sa(16,"One time use perks"),ko(),Po(17,DN,1,1,"app-royal-perk",5),ko(),Fo(18,"hr"),xo(19,"div"),xo(20,"div",4),sa(21,"Permanent perks"),ko(),Po(22,xN,1,1,"app-royal-perk",5),ko(),xo(23,"div",6),xo(24,"h4"),sa(25,"Golden items found:"),ko(),Po(26,kN,2,3,"span",7),Po(27,FN,2,3,"span",7),Po(28,UN,2,3,"span",7),Po(29,HN,2,3,"span",7),ko(),ko()),2&e&&(Jr(7),ra(t.getRoyalPoints()),Jr(10),Lo("ngForOf",t.getOneTimeUseRoyalPerks()),Jr(5),Lo("ngForOf",t.getPermanentUseRoyalPerks()),Jr(4),Lo("ngIf",t.isGoldenFishCaught()),Jr(1),Lo("ngIf",t.isGoldenEggFound()),Jr(1),Lo("ngIf",t.isGoldenApplePicked()),Jr(1),Lo("ngIf",t.isGoldenFleeceFound()))},directives:[Uu,Gu,LN,sI],styles:["#wrapper[_ngcontent-%COMP%]{margin:5px;display:flex;flex-direction:column}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.bold[_ngcontent-%COMP%]{font-weight:600}app-royal-perk[_ngcontent-%COMP%]{font-size:1em;display:inline-block;width:30%;margin:4px 8px;cursor:pointer}#goldenItems[_ngcontent-%COMP%]{margin-top:10px}.groupTitle[_ngcontent-%COMP%]{font-weight:bold;font-size:1.1em;text-align:center}"]}),e})();var BN=(()=>(function(e){e[e.NONE=0]="NONE",e[e.SELECTED=1]="SELECTED",e[e.UNTIL_X=2]="UNTIL_X",e[e.CONTINUOUS=3]="CONTINUOUS",e[e.UNTIL_PERCENT=4]="UNTIL_PERCENT"}(BN||(BN={})),BN))();class WN{constructor(e,t,i,s,r,n,o=!1){this.canceled=!1,this.id=e,this.title=t,this.resource=i,this.amount=s,this.cost=r,this.craftingDifficulty=n,this.available=o}getResource(){return this.resource}}let VN=(()=>{class e{constructor(e,t){this.servicesService=e,this.resourcesService=t,this.recipes=[],e.addService(Zf.RECIPE,this),this.initRecipes()}initRecipes(){this.recipes=[],Object.entries(uS.RECIPES).forEach(e=>{const t=new Map;e[1].COST.forEach(e=>t.set(e.resource,e.amount)),this.recipes.push(new WN(sm[e[0]],void 0!==e[1].NAME?e[1].NAME:Qf.prepareResourceName(e[1].RESOURCE),e[1].RESOURCE,e[1].AMOUNT?e[1].AMOUNT:1,t,e[1].CRAFTING,!1))}),this.recipes.find(e=>e.id===sm.PLANK).available=!0,this.recipes.find(e=>e.id===sm.CUT_STONE).available=!0,Am.production||Object.values(sm).filter(e=>!isNaN(e)).forEach(e=>this.enable(e))}getRecipes(){return this.recipes.filter(e=>e.available)}getCookingRecipes(){return this.recipes.filter(e=>e.available&&this.resourcesService.getResource(e.resource).getResourceTypes().includes(Gf.CONSUMABLE))}getRecipeById(e){return this.recipes.find(t=>t.id===e)}enable(e){const t=this.recipes.find(t=>t.id===e);this.resourcesService.makeVisible(t.getResource()),Array.from(t.cost.keys()).forEach(e=>this.resourcesService.makeVisible(e)),t.available=!0}disable(e){const t=this.recipes.find(t=>t.id===e);this.resourcesService.makeVisible(t.getResource()),t.available=!1}getName(){return"RecipeService"}load(e){this.initRecipes(),e.recipes.forEach(e=>{const t=this.recipes.find(t=>t.id===e);t&&(t.available=!0)})}save(){return{recipes:this.recipes.filter(e=>e.available).map(e=>e.id)}}reset(e,t){this.initRecipes()}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(Pv))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),zN=(()=>{class e{constructor(e,t,i,s){this.resourcesService=e,this.servicesService=t,this.recipeService=i,this.modalService=s,this.recipeUpdate=new b,this.craftingQueue=[],this.cookingQueue=[],this.id=1,this.craftingQueueSize=uS.START_CRAFTING_QUEUE_SIZE,this.cookingQueueSize=uS.START_COOKING_QUEUE_SIZE,this.craftingType=BN.SELECTED,this.cookingType=BN.SELECTED,t.addService(Zf.CRAFTING,this)}craft(e,t,i,s){this.craftingQueue.length>=this.craftingQueueSize?this.modalService.info("Crafting order queue is full"):e.shiftKey?this.craftingQueue.unshift({id:this.nextId(),recipe:t,amount:i,type:s}):this.craftingQueue.push({id:this.nextId(),recipe:t,amount:i,type:s})}cook(e,t,i,s){this.cookingQueue.length>=this.cookingQueueSize?this.modalService.info("Cooking order queue is full"):e.shiftKey?this.cookingQueue.unshift({id:this.nextId(),recipe:t,amount:i,type:s}):this.cookingQueue.push({id:this.nextId(),recipe:t,amount:i,type:s})}getCraftingQueue(){return this.craftingQueue}getCookingQueue(){return this.cookingQueue}getCraftingOrder(){const e=this.craftingQueue.find(e=>{if(e.type===BN.SELECTED&&e.amount>0&&this.resourcesService.hasResources(e.recipe.cost,"Crafting")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.WORKSHOP).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.amount+t<i.limit}if(e.type===BN.UNTIL_X&&this.resourcesService.hasResources(e.recipe.cost,"Crafting")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.WORKSHOP).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.limit<e.amount?i.amount+t<i.limit:i.amount+t<e.amount}if(e.type===BN.UNTIL_PERCENT&&this.resourcesService.hasResources(e.recipe.cost,"Crafting")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.WORKSHOP).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.limit<Math.ceil(e.amount/100*i.limit)?i.amount+t<i.limit:i.amount+t<Math.ceil(e.amount/100*i.limit)}if(e.type===BN.CONTINUOUS&&this.resourcesService.hasResources(e.recipe.cost,"Crafting")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.WORKSHOP).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.amount+t<i.limit}});return e?(this.resourcesService.decreaseResources(e.recipe.cost,"Crafting"),e.type===BN.SELECTED&&(e.amount-=1),this.craftingQueue=this.craftingQueue.filter(e=>e.type!==BN.SELECTED||e.amount>0),e.recipe):null}getCookingOrder(){const e=this.cookingQueue.find(e=>{if(e.type===BN.SELECTED&&e.amount>0&&this.resourcesService.hasResources(e.recipe.cost,"Kitchen")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.KITCHEN).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.amount+t<i.limit}if(e.type===BN.UNTIL_X&&this.resourcesService.hasResources(e.recipe.cost,"Kitchen")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.KITCHEN).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.limit<e.amount?i.amount+t<i.limit:i.amount+t<e.amount}if(e.type===BN.UNTIL_PERCENT&&this.resourcesService.hasResources(e.recipe.cost,"Kitchen")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.KITCHEN).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.limit<Math.ceil(e.amount/100*i.limit)?i.amount+t<i.limit:i.amount+t<Math.ceil(e.amount/100*i.limit)}if(e.type===BN.CONTINUOUS&&this.resourcesService.hasResources(e.recipe.cost,"Kitchen")){let t=0;this.servicesService.getVillageService().buildings.filter(e=>e.getBuildingType()===Lf.KITCHEN).forEach(i=>{i.getRecipe()&&i.getRecipe().id===e.recipe.id&&(t+=e.recipe.amount)});const i=this.resourcesService.getResource(e.recipe.resource);return i.amount+t<i.limit}});return e?(this.resourcesService.decreaseResources(e.recipe.cost,"Kitchen"),e.type===BN.SELECTED&&(e.amount-=1),this.cookingQueue=this.cookingQueue.filter(e=>e.type!==BN.SELECTED||e.amount>0),e.recipe):null}getName(){return"CraftingService"}load(e){this.craftingQueue=[],this.cookingQueue=[],Array.from(e.queue).forEach(e=>{this.craftingQueue.push({id:this.nextId(),recipe:this.recipeService.getRecipeById(e.recipeId),amount:e.amount,type:e.type})}),void 0!==e.cookingQueue&&Array.from(e.cookingQueue).forEach(e=>{this.cookingQueue.push({id:this.nextId(),recipe:this.recipeService.getRecipeById(e.recipeId),amount:e.amount,type:e.type})}),this.craftingQueueSize=e.queueSize,this.cookingQueueSize=void 0!==e.cookingQueueSize?e.cookingQueueSize:uS.START_COOKING_QUEUE_SIZE}save(){return{queue:this.craftingQueue.map(e=>({recipeId:e.recipe.id,amount:e.amount,type:e.type})),cookingQueue:this.cookingQueue.map(e=>({recipeId:e.recipe.id,amount:e.amount,type:e.type})),queueSize:this.craftingQueueSize,cookingQueueSize:this.cookingQueueSize}}reset(e,t){this.craftingQueue=[],this.cookingQueue=[],this.id=1,this.craftingQueueSize=uS.START_CRAFTING_QUEUE_SIZE,this.cookingQueueSize=uS.START_COOKING_QUEUE_SIZE}registerForUpdate(){return this.recipeUpdate.asObservable()}cancel(e,t=!1){let i=this.craftingQueue.find(t=>t.id===e);if(i)if(t)this.craftingQueue=this.craftingQueue.filter(t=>t.id!==e),this.recipeUpdate.next();else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel crafting "+Qf.prepareResourceName(i.recipe.resource)+"?");const t=this.modalService.registerForConfirmation().subscribe(i=>{i&&(this.craftingQueue=this.craftingQueue.filter(t=>t.id!==e),this.recipeUpdate.next()),t.unsubscribe()})}else if(i=this.cookingQueue.find(t=>t.id===e),i)if(t)this.cookingQueue=this.cookingQueue.filter(t=>t.id!==e),this.recipeUpdate.next();else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel cooking "+Qf.prepareResourceName(i.recipe.resource)+"?");const t=this.modalService.registerForConfirmation().subscribe(i=>{i&&(this.cookingQueue=this.cookingQueue.filter(t=>t.id!==e),this.recipeUpdate.next()),t.unsubscribe()})}}nextId(){const e=this.id;return this.id++,e}moveRecipeInCraftingQueue(e){BE(this.craftingQueue,e.previousIndex,e.currentIndex)}moveRecipeInCookingQueue(e){BE(this.cookingQueue,e.previousIndex,e.currentIndex)}getCraftingQueueMaxSize(){return this.craftingQueueSize}getCookingQueueMaxSize(){return this.cookingQueueSize}increaseCraftingQueueSize(e){this.craftingQueueSize+=e}decreaseCraftingQueueSize(e){this.craftingQueueSize-=e}increaseCookingQueueSize(e){this.cookingQueueSize+=e}decreaseCookingQueueSize(e){this.cookingQueueSize-=e}filterCraftingQueue(e){this.craftingQueue.forEach(t=>{e.includes(t.recipe.id)&&this.cancel(t.id,!0)})}setCraftingType(e){this.craftingType=e}setCookingType(e){this.cookingType=e}getCookingType(){return this.cookingType}getCraftingType(){return this.craftingType}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(Jf),gs(VN),gs(em))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function YN(e,t){1&e&&(xo(0,"a",3),sa(1,"Cooking"),ko())}let KN=(()=>{class e{constructor(e){this.gameService=e}ngOnInit(){}isCookingEnabled(){return this.gameService.isEnabled(Mf.KITCHEN)}}return e.\u0275fac=function(t){return new(t||e)(Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-crafting-top-menu"]],decls:4,vars:1,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","routerLink","/crafting/crafting","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/crafting/cooking","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/crafting/cooking","routerLinkActive","active",1,"entry"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"a",1),sa(2,"Crafting"),ko(),Po(3,YN,2,0,"a",2),ko()),2&e&&(Jr(3),Lo("ngIf",t.isCookingEnabled()))},directives:[lf,hf,Gu],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:row}.entry[_ngcontent-%COMP%]{flex:auto;display:flex;justify-content:center;flex-direction:column;height:100%;text-align:center;border-right:black solid 2px;border-bottom:black solid 1px;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry[_ngcontent-%COMP%]:last-of-type{border:none;border-bottom:black solid 1px}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour)}"]}),e})();function jN(e,t){if(1&e&&(xo(0,"div",12),sa(1),ko()),2&e){const e=Ko(2);Jr(1),ra(e.amount)}}function $N(e,t){if(1&e&&(xo(0,"div",12),sa(1),ko()),2&e){const e=Ko(2);Jr(1),oa("",e.getResourceAmount(),"/",e.amount,"")}}function QN(e,t){if(1&e&&(xo(0,"div",12),sa(1),ko()),2&e){const e=Ko(2);Jr(1),oa("",e.getResourceAmountPercentage(),"%/",e.amount,"%")}}function qN(e,t){1&e&&(xo(0,"div",12),sa(1,"\u221e"),ko())}function XN(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko(2);Jr(1),na(" (",e.getCurrentlyCrafted(),") ")}}function ZN(e,t){if(1&e&&(xo(0,"div",8),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na("Crafted: ",e.recipe.amount,"")}}function JN(e,t){if(1&e&&(Uo(0),xo(1,"div"),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function e_(e,t){if(1&e&&(Uo(0),xo(1,"div",15),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function t_(e,t){if(1&e&&(xo(0,"div",13),Po(1,JN,3,1,"ng-container",6),Po(2,e_,3,1,"ng-container",6),Fo(3,"app-icon",14),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("ngIf",i.checkResource(e)),Jr(1),Lo("ngIf",!i.checkResource(e)),Jr(1),Lo("name",i.getResourceName(e.key))("path","resources")}}function i_(e,t){if(1&e){const e=Go();xo(0,"div",3),Vo("click",function(){return Dt(e),Ko().cancel()}),xo(1,"div",4),Po(2,jN,2,1,"div",5),Po(3,$N,2,2,"div",5),Po(4,QN,2,2,"div",5),Po(5,qN,2,0,"div",5),sa(6),Fc(7,"titlecase"),Po(8,XN,2,1,"ng-container",6),ko(),xo(9,"span",7),sa(10),Fc(11,"titlecase"),Fo(12,"hr"),xo(13,"div",8),sa(14),ko(),Po(15,ZN,2,1,"div",9),xo(16,"div",10),sa(17,"Cost:"),ko(),Po(18,t_,4,4,"div",11),Fc(19,"keyvalue"),ko(),ko()}if(2&e){const e=Ko();Lo("elementId",e.id),Jr(2),Lo("ngIf",e.type===e.craftingTypes.SELECTED),Jr(1),Lo("ngIf",e.type===e.craftingTypes.UNTIL_X),Jr(1),Lo("ngIf",e.type===e.craftingTypes.UNTIL_PERCENT),Jr(1),Lo("ngIf",e.type===e.craftingTypes.CONTINUOUS),Jr(1),na(" ",Uc(7,12,e.recipe.title)," "),Jr(2),Lo("ngIf",e.isStarted()),Jr(1),$o("id",e.id),Jr(1),na(" ",Uc(11,14,e.getResourceName(e.recipe.resource))," "),Jr(4),na("Difficulty: ",e.recipe.craftingDifficulty,""),Jr(1),Lo("ngIf",e.recipe.amount>1),Jr(3),Lo("ngForOf",Uc(19,16,e.getCost()))}}function s_(e,t){if(1&e&&(xo(0,"div",12),sa(1),ko()),2&e){const e=Ko(2);Jr(1),ra(e.amount)}}function r_(e,t){if(1&e&&(xo(0,"div",12),sa(1),ko()),2&e){const e=Ko(2);Jr(1),oa("",e.getResourceAmount(),"/",e.amount,"")}}function n_(e,t){if(1&e&&(xo(0,"div",12),sa(1),ko()),2&e){const e=Ko(2);Jr(1),oa("",e.getResourceAmountPercentage(),"%/",e.amount,"%")}}function o_(e,t){1&e&&(xo(0,"div",12),sa(1,"\u221e"),ko())}function a_(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko(2);Jr(1),na(" (",e.getCurrentlyCrafted(),") ")}}function c_(e,t){if(1&e&&(xo(0,"div",8),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na("Crafted: ",e.recipe.amount,"")}}function l_(e,t){if(1&e&&(Uo(0),xo(1,"div"),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function u_(e,t){if(1&e&&(Uo(0),xo(1,"div",15),sa(2),ko(),Ho()),2&e){const e=Ko().$implicit;Jr(2),ra(e.value)}}function h_(e,t){if(1&e&&(xo(0,"div",13),Po(1,l_,3,1,"ng-container",6),Po(2,u_,3,1,"ng-container",6),Fo(3,"app-icon",14),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("ngIf",i.checkResource(e)),Jr(1),Lo("ngIf",!i.checkResource(e)),Jr(1),Lo("name",i.getResourceName(e.key))("path","resources")}}function d_(e,t){if(1&e){const e=Go();xo(0,"div",16),Vo("click",function(){return Dt(e),Ko().cancel()}),xo(1,"div",17),Po(2,s_,2,1,"div",5),Po(3,r_,2,2,"div",5),Po(4,n_,2,2,"div",5),Po(5,o_,2,0,"div",5),sa(6),Fc(7,"titlecase"),Po(8,a_,2,1,"ng-container",6),ko(),xo(9,"span",7),sa(10),Fc(11,"titlecase"),Fo(12,"hr"),xo(13,"div",8),sa(14),ko(),Po(15,c_,2,1,"div",9),xo(16,"div",10),sa(17,"Cost:"),ko(),Po(18,h_,4,4,"div",11),Fc(19,"keyvalue"),ko(),ko()}if(2&e){const e=Ko();Lo("elementId",e.id),Jr(2),Lo("ngIf",e.type===e.craftingTypes.SELECTED),Jr(1),Lo("ngIf",e.type===e.craftingTypes.UNTIL_X),Jr(1),Lo("ngIf",e.type===e.craftingTypes.UNTIL_PERCENT),Jr(1),Lo("ngIf",e.type===e.craftingTypes.CONTINUOUS),Jr(1),na(" ",Uc(7,12,e.recipe.title)," "),Jr(2),Lo("ngIf",e.isStarted()),Jr(1),$o("id",e.id),Jr(1),na(" ",Uc(11,14,e.getResourceName(e.recipe.resource))," "),Jr(4),na("Difficulty: ",e.recipe.craftingDifficulty,""),Jr(1),Lo("ngIf",e.recipe.amount>1),Jr(3),Lo("ngForOf",Uc(19,16,e.getCost()))}}let g_=(()=>{class e{constructor(e,t,i){this.craftingService=e,this.resourcesService=t,this.villageService=i,this.id=Math.random(),this.amount=1,this.type=BN.NONE,this.craftingTypes=BN}getResourceName(e){return Qf.prepareResourceName(e)}ngOnInit(){}cancel(){null!==this.id&&this.craftingService.cancel(this.id)}getCost(){return this.recipe.cost}isAvailable(){for(const[e,t]of Array.from(this.recipe.cost))if(0!==this.resourcesService.hasResource(e,t,"Crafting"))return!1;return!0}checkResource(e){return 0===this.resourcesService.hasResource(e.key,e.value,"Crafting")}getResourceAmount(){return this.resourcesService.getResource(this.recipe.resource).amount}getCurrentlyCrafted(){return this.villageService.getBuildings().filter(e=>e.getBuildingType()===Lf.WORKSHOP&&e.isWorking()).map(e=>e).filter(e=>e.getRecipe()&&e.getRecipe().id===this.recipe.id).length+this.villageService.getBuildings().filter(e=>e.getBuildingType()===Lf.KITCHEN&&e.isWorking()).map(e=>e).filter(e=>e.getRecipe()&&e.getRecipe().id===this.recipe.id).length}isStarted(){return this.id>=1&&this.getCurrentlyCrafted()>0}getResourceAmountPercentage(){const e=this.resourcesService.getResource(this.recipe.resource);return Math.floor(e.amount/e.limit*100)}}return e.\u0275fac=function(t){return new(t||e)(Mo(zN),Mo(Pv),Mo(wO))},e.\u0275cmp=Ve({type:e,selectors:[["app-recipe"]],inputs:{id:"id",recipe:"recipe",amount:"amount",type:"type"},decls:3,vars:2,consts:[["id","wrapper"],["id","available","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","notAvailable","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","available","appTooltip","",1,"tooltip",3,"elementId","click"],["id","text"],["class","type",4,"ngIf"],[4,"ngIf"],[3,"id"],[1,"craftingTitle"],["class","craftingTitle",4,"ngIf"],[1,"costTitle"],["class","icon",4,"ngFor","ngForOf"],[1,"type"],[1,"icon"],[3,"name","path"],[1,"missing"],["id","notAvailable","appTooltip","",1,"tooltip",3,"elementId","click"],["id","titleGrey"]],template:function(e,t){1&e&&(xo(0,"div",0),Po(1,i_,20,18,"div",1),Po(2,d_,20,18,"div",2),ko()),2&e&&(Jr(1),Lo("ngIf",t.isAvailable()),Jr(1),Lo("ngIf",!t.isAvailable()))},directives:[Gu,rI,Uu,sI],pipes:[Qu,qu],styles:["#wrapper[_ngcontent-%COMP%]{width:100%;display:inline-block}#available[_ngcontent-%COMP%]{position:relative;padding:3px;text-align:center;font-weight:100;font-size:1.1em;border:black solid 1px}#notAvailable[_ngcontent-%COMP%]{padding:3px;text-align:center;font-size:1.1em;border:#57575a solid 1px}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#57575a}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progressId[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}.costTitle[_ngcontent-%COMP%]{text-align:left}.missing[_ngcontent-%COMP%]{color:var(--negative-colour)}.tooltip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{min-width:200px}.craftingTitle[_ngcontent-%COMP%]{text-align:left}.type[_ngcontent-%COMP%]{display:inline-block}app-icon[_ngcontent-%COMP%]{flex:0 0 auto;margin-left:3px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e})();function p_(e,t){if(1&e&&(xo(0,"div",28),xo(1,"div",29),sa(2),ko(),ko()),2&e){const e=Ko().$implicit;Jr(2),ra(e)}}function f_(e,t){if(1&e&&(xo(0,"div",30),xo(1,"div",29),sa(2),ko(),ko()),2&e){const e=Ko().$implicit;Jr(2),ra(e)}}function m_(e,t){if(1&e){const e=Go();xo(0,"div",25),Vo("click",function(){const t=Dt(e).$implicit;return Ko().select(t)}),Po(1,p_,3,1,"div",26),Po(2,f_,3,1,"div",27),ko()}if(2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngIf",i.bookPage===e),Jr(1),Lo("ngIf",i.bookPage!==e)}}function S_(e,t){if(1&e){const e=Go();xo(0,"app-recipe",31),Vo("click",function(t){const i=Dt(e).$implicit;return Ko().craft(t,i)}),ko()}2&e&&Lo("recipe",t.$implicit)}function E_(e,t){if(1&e&&Fo(0,"app-recipe",32),2&e){const e=t.$implicit;Lo("recipe",e.recipe)("amount",e.amount)("type",e.type)("id",e.id)}}let v_=(()=>{class e{constructor(e,t,i,s,r){this.recipeService=e,this.resourcesService=t,this.craftingService=i,this.modalService=s,this.changeDetectorRef=r,this.craftingTypes=BN,this.filterText="",this.amount=1,this.craftingType=this.craftingTypes.SELECTED,this.bookPage=Gf[Gf.ALL]}ngOnInit(){this.craftingService.registerForUpdate().subscribe(()=>{this.changeDetectorRef.destroyed||this.changeDetectorRef.detectChanges()}),this.craftingType=this.craftingService.getCraftingType()}getRecipes(){return this.filterText&&this.filterText.length>0?this.recipeService.getRecipes().filter(e=>e.available&&(this.resourcesService.getResourceTypes(e.getResource()).includes(Gf[this.bookPage])&&e.title.toLowerCase().includes(this.filterText.toLowerCase())||this.resourcesService.getResourceTypes(e.getResource()).includes(Gf[this.bookPage])&&Qf.prepareResourceName(e.getResource()).toLowerCase().includes(this.filterText.toLowerCase()))):this.recipeService.getRecipes().filter(e=>e.available&&this.resourcesService.getResourceTypes(e.getResource()).includes(Gf[this.bookPage]))}getEntries(){const e=[];return e.push(Gf[Gf.ALL]),e.push(Gf[Gf.PROCESSED]),e.push(Gf[Gf.TOOLS]),e.push(Gf[Gf.FOOD]),e.push(Gf[Gf.OTHER]),e}select(e){this.bookPage=e}craft(e,t){this.validateAmountInput()&&this.craftingService.craft(e,t,this.amount,this.craftingType)}getQueue(){return this.craftingService.getCraftingQueue()}drop(e){this.craftingService.moveRecipeInCraftingQueue(e)}getQueueMaxSize(){return this.craftingService.getCraftingQueueMaxSize()}validateAmountInput(){return!(isNaN(this.amount)||Number(this.amount)<1)||(this.modalService.info("Invalid craft amount"),this.amount=1,!1)}updateCraftingType(){this.craftingService.setCraftingType(this.craftingType)}}return e.\u0275fac=function(t){return new(t||e)(Mo(VN),Mo(Pv),Mo(zN),Mo(em),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-crafting"]],decls:58,vars:18,consts:[["id","wrapper"],["id","title"],["id","boxes"],["id","recipes"],[1,"title"],[1,"icon"],["appTooltip","",1,"tooltip",3,"elementId"],[3,"name","title"],["id","help1"],["id","recipesBook"],["id","menu"],["class","entry",3,"click",4,"ngFor","ngForOf"],["id","book"],["id","side"],["id","filter"],["type","text",3,"ngModel","ngModelChange"],["id","amount"],["type","number","min","1",3,"ngModel","ngModelChange"],[1,"radios"],["type","radio","name","type",3,"ngModel","value","ngModelChange","change"],["id","bookRecipes"],[3,"recipe","click",4,"ngFor","ngForOf"],[1,"queue"],["id","queueRecipes","cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"recipe","amount","type","id",4,"ngFor","ngForOf"],[1,"entry",3,"click"],["class","activeEntry",4,"ngIf"],["class","inactiveEntry",4,"ngIf"],[1,"activeEntry"],[1,"entryText"],[1,"inactiveEntry"],[3,"recipe","click"],["cdkDrag","",3,"recipe","amount","type","id"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-crafting-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"span",4),xo(6,"span",5),sa(7,"Recipes "),xo(8,"div",6),Fo(9,"app-icon",7),xo(10,"span",8),sa(11," In this menu you can define orders for your workshops."),Fo(12,"br"),Fo(13,"br"),sa(14," Each workshop will try to take order from the orders lists starting from top."),Fo(15,"br"),Fo(16,"br"),sa(17," Only orders that meet requirements will be taken by workshops."),Fo(18,"br"),Fo(19,"br"),sa(20," You can add order to the top of the list by holding shift while clicking on a recipe. "),ko(),ko(),ko(),ko(),xo(21,"div",9),xo(22,"div",10),Po(23,m_,3,2,"div",11),ko(),xo(24,"div",12),xo(25,"div",13),xo(26,"div",14),sa(27," Filter:"),Fo(28,"br"),xo(29,"input",15),Vo("ngModelChange",function(e){return t.filterText=e}),ko(),ko(),xo(30,"div",16),sa(31," amount:"),Fo(32,"br"),xo(33,"input",17),Vo("ngModelChange",function(e){return t.amount=e}),ko(),ko(),xo(34,"div",18),xo(35,"label"),xo(36,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(37," selected amount "),ko(),Fo(38,"br"),xo(39,"label"),xo(40,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(41," until X available "),ko(),Fo(42,"br"),xo(43,"label"),xo(44,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(45," until % available "),ko(),ko(),xo(46,"div",18),xo(47,"label"),xo(48,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(49," continuous "),ko(),ko(),ko(),xo(50,"div",20),Po(51,S_,1,1,"app-recipe",21),ko(),ko(),ko(),ko(),xo(52,"div",22),xo(53,"span",4),sa(54,"Orders"),ko(),sa(55),xo(56,"div",23),Vo("cdkDropListDropped",function(e){return t.drop(e)}),Po(57,E_,1,4,"app-recipe",24),ko(),ko(),ko(),ko()),2&e&&(Jr(8),Lo("elementId","help1"),Jr(1),Lo("name","question")("title",""),Jr(14),Lo("ngForOf",t.getEntries()),Jr(6),Lo("ngModel",t.filterText),Jr(4),Lo("ngModel",t.amount),Jr(3),Lo("ngModel",t.craftingType)("value",t.craftingTypes.SELECTED),Jr(4),Lo("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_X),Jr(4),Lo("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_PERCENT),Jr(4),Lo("ngModel",t.craftingType)("value",t.craftingTypes.CONTINUOUS),Jr(3),Lo("ngForOf",t.getRecipes()),Jr(4),oa(" ",t.getQueue().length,"/",t.getQueueMaxSize()," "),Jr(2),Lo("ngForOf",t.getQueue()))},directives:[KN,rI,sI,Uu,KO,dT,MT,JT,DT,UT,sv,Gu,g_,cv],styles:["#wrapper[_ngcontent-%COMP%]{height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#boxes[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:95%;margin:.5%;text-align:center}#recipes[_ngcontent-%COMP%]{text-align:center;flex:0 0 74.3%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.queue[_ngcontent-%COMP%]{text-align:center;flex:0 0 25%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}#queueRecipes[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden}#queueRecipes[_ngcontent-%COMP%] > app-recipe[_ngcontent-%COMP%]{min-width:80%}.title[_ngcontent-%COMP%]{width:100.5%;font-weight:bolder;font-size:1.1em;display:inline-block;border-bottom:black solid 1px}#modes[_ngcontent-%COMP%]{margin-top:-1px;padding:0;margin-bottom:5px}#recipesBook[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}#menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-right:black solid 1px;flex:0 0 10%}.entry[_ngcontent-%COMP%]{display:flex;border-bottom:black solid 1px;flex:1 0 0;height:100%;width:100%;margin-right:-30px;font-size:.8em;font-weight:600;cursor:pointer}.entry[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.entryText[_ngcontent-%COMP%]{-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-ms-transform:rotate(-90deg);-o-transform:rotate(-90deg)}.inactiveEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center}.activeEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center;background-color:var(--active-colour)}#book[_ngcontent-%COMP%]{flex:0 0 90%;width:100%}#bookRecipes[_ngcontent-%COMP%]{overflow-y:auto;border-top:black solid 1px;height:84.5%}app-recipe[_ngcontent-%COMP%]{font-size:.8em;display:inline-block;width:20%;min-width:130px;margin:4px 6px;cursor:pointer}#side[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-size:.8em;margin:1%;vertical-align:bottom}#filter[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:1.05em;margin-left:0;padding:0;border:none;outline:0}#amount[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#amount[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:65%;font-size:1.15em;margin-left:0;padding:0;border:none;outline:0}.radios[_ngcontent-%COMP%]{text-align:left;font-size:.9em}#progressButton[_ngcontent-%COMP%]{font-size:.6em}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:85px;margin:auto}#help1[_ngcontent-%COMP%]{font-size:.7em;font-weight:normal;text-align:left}"]}),e})();function R_(e,t){1&e&&(xo(0,"a",6),sa(1,"Forest"),ko())}let O_=(()=>{class e{constructor(e){this.gameService=e}ngOnInit(){}isForestManagementEnabled(){return this.gameService.isEnabled(Mf.FORESTER)}}return e.\u0275fac=function(t){return new(t||e)(Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-management-top-menu"]],decls:10,vars:1,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","routerLink","/management/general","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management/happiness","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management/effects","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/management/forestM","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/management/summary","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management/forestM","routerLinkActive","active",1,"entry"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"a",1),sa(2,"General"),ko(),xo(3,"a",2),sa(4,"Happiness"),ko(),xo(5,"a",3),sa(6,"Effects"),ko(),Po(7,R_,2,0,"a",4),xo(8,"a",5),sa(9,"Summary"),ko(),ko()),2&e&&(Jr(7),Lo("ngIf",t.isForestManagementEnabled()))},directives:[lf,hf,Gu],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:row}.entry[_ngcontent-%COMP%]{flex:auto;display:flex;justify-content:center;flex-direction:column;height:100%;text-align:center;border-right:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry[_ngcontent-%COMP%]:last-of-type{border:none}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour)}"]}),e})();function T_(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span",4),sa(2),ko(),xo(3,"div",5),xo(4,"input",49),Vo("input",function(t){return Dt(e),Ko().changeTaxRate(t)}),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(2),na("tax/donation: ",10*e.getTaxRate(),"%"),Jr(2),Lo("value",e.getTaxRate())}}function I_(e,t){if(1&e){const e=Go();Uo(0),xo(1,"input",50),Vo("change",function(){return Dt(e),Ko().updateComplexWorkers()}),ko(),xo(2,"label",51),sa(3,"Enable automated work management for some buildings"),ko(),Ho()}if(2&e){const e=Ko();Jr(1),Lo("checked",e.getComplexWorkers())}}function b_(e,t){if(1&e){const e=Go();xo(0,"div",55),xo(1,"span",56),Fo(2,"app-icon",57),xo(3,"span",58),xo(4,"button",59),Vo("click",function(){const t=Dt(e).$implicit,i=Ko().index;return Ko().up(t,i)}),sa(5,"\u2191"),ko(),xo(6,"button",59),Vo("click",function(){const t=Dt(e).$implicit,i=Ko().index;return Ko().down(t,i)}),sa(7,"\u2193"),ko(),ko(),ko(),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Jr(2),Lo("name",i.getResourceName(e))("path","resources")}}function C_(e,t){if(1&e&&(xo(0,"div",52),xo(1,"span",53),sa(2),ko(),Po(3,b_,8,2,"div",54),ko()),2&e){const e=t.$implicit,i=t.index;Jr(2),ra(i+1),Jr(1),Lo("ngForOf",e)}}function y_(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"input",60),Vo("change",function(){return Dt(e),Ko().updateShowFaith()}),ko(),xo(2,"label",61),sa(3,"Show faith in the header"),ko(),Fo(4,"br"),ko()}if(2&e){const e=Ko();Jr(1),Lo("checked",e.getShowFaith())}}let A_=(()=>{class e{constructor(e,t,i){this.managementService=e,this.resourcesService=t,this.gameService=i}ngOnInit(){}getRations(){return this.managementService.getRations()}changeFoodValue(e){this.managementService.setRations(e.target.value)}changeClothesValue(e){this.managementService.setClothesRations(e.target.value)}changeAlcoholValue(e){this.managementService.setAlcoholRations(e.target.value)}getClothesRations(){return this.managementService.getClothesRations()}getAlcoholRations(){return this.managementService.getAlcoholRations()}updateFurClothes(){this.managementService.toggleFurClothes()}getFurClothes(){return this.managementService.getFurClothes()}updateFoodNutrition(){this.managementService.toggleFoodNutrition()}getFoodNutrition(){return this.managementService.getFoodNutrition()}updateComplexWorkers(){this.managementService.toggleComplexWorkers()}getComplexWorkers(){return this.managementService.getComplexWorkers()}isHREnabled(){return this.gameService.isEnabled(Mf.HUMAN_RESOURCES)}getSecondHeaderRow(){return this.managementService.getSecondHeaderRow()}updateSecondHeaderRow(){this.managementService.toggleSecondHeaderRow()}getShowFreeWorkers(){return this.managementService.getShowFreeWorkers()}updateShowFreeWorkers(){this.managementService.toggleShowFreeWorkers()}getShowPopulation(){return this.managementService.getShowPopulation()}updateShowPopulation(){this.managementService.toggleShowPopulation()}getFoodLines(){return this.managementService.getFoodPriority()}getResourceName(e){return Qf.prepareResourceName(e)}up(e,t){this.managementService.up(e,t)}down(e,t){this.managementService.down(e,t)}getShowResearchProgress(){return this.managementService.getShowResearchProgress()}updateShowResearchProgress(){this.managementService.toggleShowResearchProgress()}getShowFaith(){return this.managementService.getShowFaith()}updateShowFaith(){this.managementService.toggleShowFaith()}getShowHappiness(){return this.managementService.getShowHappiness()}updateShowHappiness(){this.managementService.toggleShowHappiness()}isFaithUnlocked(){return this.gameService.isEnabled(Mf.RELIGION)}getLogFiredWorkers(){return this.managementService.getLogFiredWorkers()}updateLogFiredWorkers(){this.managementService.toggleLogFiredWorkers()}getDefaultWorkshopResearch(){return this.managementService.getDefaultWorkshopResearch()}updateDefaultWorkshopResearch(){this.managementService.toggleDefaultWorkshopResearch()}getDefaultGathererFood(){return this.managementService.getDefaultGathererFood()}updateDefaultGathererFood(){this.managementService.toggleDefaultGathererFood()}getSwitchHunterFromTaming(){return this.managementService.getSwitchHunterFromTaming()}updateSwitchHunterFromTaming(){this.managementService.toggleSwitchHunterFromTaming()}getPlowInSummer(){return this.managementService.getPlowInSummer()}updatePlowInSummer(){this.managementService.togglePlowInSummer()}getLogAutoTrade(){return this.managementService.getLogAutoTrade()}updateLogAutoTrade(){this.managementService.toggleLogAutoTrade()}getShowRaw(){return this.managementService.getShowRaw()}updateShowRaw(){this.managementService.toggleShowRaw()}getShowProcessed(){return this.managementService.getShowProcessed()}updateShowProcessed(){this.managementService.toggleShowProcessed()}getShowFood(){return this.managementService.getShowFood()}updateShowFood(){this.managementService.toggleShowFood()}getShowTools(){return this.managementService.getShowTools()}updateShowTools(){this.managementService.toggleShowTools()}getLogSickness(){return this.managementService.getLogSickness()}updateLogSickness(){this.managementService.toggleLogSickness()}getLogMerchant(){return this.managementService.getLogMerchant()}updateLogMerchant(){this.managementService.toggleLogMerchant()}getTaxRate(){return this.managementService.getTaxRate()}changeTaxRate(e){this.managementService.setTaxRate(e.target.value)}isTaxUnlocked(){return this.gameService.isEnabled(Mf.TAX_COLLECTOR)}}return e.\u0275fac=function(t){return new(t||e)(Mo(PO),Mo(Pv),Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-management"]],decls:116,vars:29,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],[1,"label"],[1,"slidecontainer"],["type","range","min","1","max","4","value","2",1,"slider",3,"value","input"],["type","range","min","1","max","4","value","1",1,"slider",3,"value","input"],[4,"ngIf"],["id","furClothes","type","checkbox",3,"checked","change"],["for","furClothes"],["id","defaultWorkshopResearch","type","checkbox",3,"checked","change"],["for","defaultWorkshopResearch"],["id","defaultGathererFood","type","checkbox",3,"checked","change"],["for","defaultGathererFood"],["id","switchHunterFromTaming","type","checkbox",3,"checked","change"],["for","switchHunterFromTaming"],["id","plowInSummer","type","checkbox",3,"checked","change"],["for","plowInSummer"],["id","foodPriorityList"],["class","priorityLine icon",4,"ngFor","ngForOf"],["id","logMerchant","type","checkbox",3,"checked","change"],["for","logMerchant"],["id","logFiredWorkers","type","checkbox",3,"checked","change"],["for","logFiredWorkers"],["id","logAutoTrade","type","checkbox",3,"checked","change"],["for","logAutoTrade"],["id","logSickness","type","checkbox",3,"checked","change"],["for","logSickness"],["id","secondHeaderRow","type","checkbox",3,"checked","change"],["for","secondHeaderRow"],["id","foodNutrition","type","checkbox",3,"checked","change"],["for","foodNutrition"],["id","showRaw","type","checkbox",3,"checked","change"],["for","showRaw"],["id","showProcessed","type","checkbox",3,"checked","change"],["for","showProcessed"],["id","showFood","type","checkbox",3,"checked","change"],["for","showFood"],["id","showTools","type","checkbox",3,"checked","change"],["for","showTools"],["id","showPopulation","type","checkbox",3,"checked","change"],["for","showPopulation"],["id","showFreeWorkers","type","checkbox",3,"checked","change"],["for","showFreeWorkers"],["id","showHappiness","type","checkbox",3,"checked","change"],["for","showHappiness"],["id","showResearchProgress","type","checkbox",3,"checked","change"],["for","showResearchProgress"],["type","range","min","0","max","5","value","0",1,"slider",3,"value","input"],["id","workManagement","type","checkbox",3,"checked","change"],["for","workManagement"],[1,"priorityLine","icon"],["id","index"],["class","entry",4,"ngFor","ngForOf"],[1,"entry"],[1,"item"],[3,"name","path"],["id","arrows"],[1,"arrow",3,"click"],["id","showFaith","type","checkbox",3,"checked","change"],["for","showFaith"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-management-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"span"),sa(6,"General Management"),ko(),ko(),xo(7,"span"),sa(8,"Rations"),ko(),Fo(9,"br"),xo(10,"div"),xo(11,"span",4),sa(12),ko(),xo(13,"div",5),xo(14,"input",6),Vo("input",function(e){return t.changeFoodValue(e)}),ko(),ko(),ko(),xo(15,"div"),xo(16,"span",4),sa(17),ko(),xo(18,"div",5),xo(19,"input",6),Vo("input",function(e){return t.changeClothesValue(e)}),ko(),ko(),ko(),xo(20,"div"),xo(21,"span",4),sa(22),ko(),xo(23,"div",5),xo(24,"input",7),Vo("input",function(e){return t.changeAlcoholValue(e)}),ko(),ko(),ko(),Po(25,T_,5,2,"div",8),Fo(26,"br"),xo(27,"input",9),Vo("change",function(){return t.updateFurClothes()}),ko(),xo(28,"label",10),sa(29,"Allow fur when no clothes are available"),ko(),Fo(30,"br"),Po(31,I_,4,1,"ng-container",8),Fo(32,"br"),Uo(33),xo(34,"input",11),Vo("change",function(){return t.updateDefaultWorkshopResearch()}),ko(),xo(35,"label",12),sa(36,"Workshops start with research mode (on) or crafting (off)"),ko(),Ho(),Fo(37,"br"),Uo(38),xo(39,"input",13),Vo("change",function(){return t.updateDefaultGathererFood()}),ko(),xo(40,"label",14),sa(41,"Gatherers start with food mode (on) or resources (off)"),ko(),Ho(),Fo(42,"br"),Uo(43),xo(44,"input",15),Vo("change",function(){return t.updateSwitchHunterFromTaming()}),ko(),xo(45,"label",16),sa(46,"If enabled hunters won't stop taming animals even if pastures are full"),ko(),Ho(),Fo(47,"br"),Uo(48),xo(49,"input",17),Vo("change",function(){return t.updatePlowInSummer()}),ko(),xo(50,"label",18),sa(51,"Allow fields to be plowed in summer"),ko(),Ho(),xo(52,"h4"),sa(53,"food priority"),ko(),xo(54,"div",19),Po(55,C_,4,2,"div",20),ko(),xo(56,"h4"),sa(57,"Log management"),ko(),xo(58,"input",21),Vo("change",function(){return t.updateLogMerchant()}),ko(),xo(59,"label",22),sa(60,"Log message when a new merchant has arrived"),ko(),Fo(61,"br"),xo(62,"input",23),Vo("change",function(){return t.updateLogFiredWorkers()}),ko(),xo(63,"label",24),sa(64,"Log message when worker is removed from building"),ko(),Fo(65,"br"),xo(66,"input",25),Vo("change",function(){return t.updateLogAutoTrade()}),ko(),xo(67,"label",26),sa(68,"Log message when auto trade has been performed"),ko(),Fo(69,"br"),xo(70,"input",27),Vo("change",function(){return t.updateLogSickness()}),ko(),xo(71,"label",28),sa(72,"Log sickness related events"),ko(),Fo(73,"br"),xo(74,"h4"),sa(75,"Header management"),ko(),xo(76,"input",29),Vo("change",function(){return t.updateSecondHeaderRow()}),ko(),xo(77,"label",30),sa(78,"Display two rows in the header (resources will be displayed in second row)"),ko(),Fo(79,"br"),xo(80,"input",31),Vo("change",function(){return t.updateFoodNutrition()}),ko(),xo(81,"label",32),sa(82,"Show food nutrition in the header"),ko(),Fo(83,"br"),xo(84,"input",33),Vo("change",function(){return t.updateShowRaw()}),ko(),xo(85,"label",34),sa(86,"Show raw resources tooltip in the header"),ko(),Fo(87,"br"),xo(88,"input",35),Vo("change",function(){return t.updateShowProcessed()}),ko(),xo(89,"label",36),sa(90,"Show processed resources tooltip in the header"),ko(),Fo(91,"br"),xo(92,"input",37),Vo("change",function(){return t.updateShowFood()}),ko(),xo(93,"label",38),sa(94,"Show food resources tooltip in the header"),ko(),Fo(95,"br"),xo(96,"input",39),Vo("change",function(){return t.updateShowTools()}),ko(),xo(97,"label",40),sa(98,"Show tools resources tooltip in the header"),ko(),Fo(99,"br"),xo(100,"input",41),Vo("change",function(){return t.updateShowPopulation()}),ko(),xo(101,"label",42),sa(102,"Show population in the header"),ko(),Fo(103,"br"),xo(104,"input",43),Vo("change",function(){return t.updateShowFreeWorkers()}),ko(),xo(105,"label",44),sa(106,"Show free workers in the header"),ko(),Fo(107,"br"),xo(108,"input",45),Vo("change",function(){return t.updateShowHappiness()}),ko(),xo(109,"label",46),sa(110,"Show happiness in the header"),ko(),Fo(111,"br"),Po(112,y_,5,1,"div",8),xo(113,"input",47),Vo("change",function(){return t.updateShowResearchProgress()}),ko(),xo(114,"label",48),sa(115,"Show research progress in the header"),ko(),ko(),ko()),2&e&&(Jr(12),na("food: ",.5*t.getRations(),""),Jr(2),Lo("value",t.getRations()),Jr(3),na("clothes: ",t.getClothesRations(),""),Jr(2),Lo("value",t.getClothesRations()),Jr(3),na("alcohol: ",t.getAlcoholRations(),""),Jr(2),Lo("value",t.getAlcoholRations()),Jr(1),Lo("ngIf",t.isTaxUnlocked()),Jr(2),Lo("checked",t.getFurClothes()),Jr(4),Lo("ngIf",t.isHREnabled()),Jr(3),Lo("checked",t.getDefaultWorkshopResearch()),Jr(5),Lo("checked",t.getDefaultGathererFood()),Jr(5),Lo("checked",t.getSwitchHunterFromTaming()),Jr(5),Lo("checked",t.getPlowInSummer()),Jr(6),Lo("ngForOf",t.getFoodLines()),Jr(3),Lo("checked",t.getLogMerchant()),Jr(4),Lo("checked",t.getLogFiredWorkers()),Jr(4),Lo("checked",t.getLogAutoTrade()),Jr(4),Lo("checked",t.getLogSickness()),Jr(6),Lo("checked",t.getSecondHeaderRow()),Jr(4),Lo("checked",t.getFoodNutrition()),Jr(4),Lo("checked",t.getShowRaw()),Jr(4),Lo("checked",t.getShowProcessed()),Jr(4),Lo("checked",t.getShowFood()),Jr(4),Lo("checked",t.getShowTools()),Jr(4),Lo("checked",t.getShowPopulation()),Jr(4),Lo("checked",t.getShowFreeWorkers()),Jr(4),Lo("checked",t.getShowHappiness()),Jr(4),Lo("ngIf",t.isFaithUnlocked()),Jr(1),Lo("checked",t.getShowResearchProgress()))},directives:[O_,Gu,Uu,sI],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#content[_ngcontent-%COMP%]{margin:.5%;height:94%;overflow-y:auto}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.label[_ngcontent-%COMP%]{display:inline-block;width:160px}.slidecontainer[_ngcontent-%COMP%]{display:inline-block;width:150px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}app-icon[_ngcontent-%COMP%]{display:inline-block}#arrows[_ngcontent-%COMP%]{display:flex;flex-direction:column}.arrow[_ngcontent-%COMP%]{font-size:.7em;width:12px;display:inline-block}.priorityLine[_ngcontent-%COMP%]{height:34px}.entry[_ngcontent-%COMP%]{display:inline-block;margin:2px}.item[_ngcontent-%COMP%]{display:flex;flex-direction:row}#index[_ngcontent-%COMP%]{display:inline-block;width:10px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}"]}),e})(),N_=(()=>{class e extends dv{constructor(e,t,i,s,r,n){super(t,e,i,s,r,Kf.PLATEAU,Zf.PLATEAU),this.gameService=n}reset(e,t){e?super.reset(e,t):t?this.buildings=[]:(this.buildings=this.buildings.filter(e=>e.isFinished()),this.buildings.length>0&&this.gameService.enable(Mf.PLATEAU),this.getBuildings().forEach(e=>e.verifyWonderEffects()))}}return e.\u0275fac=function(t){return new(t||e)(gs(Pv),gs(_O),gs(Jf),gs(NS),gs(NO),gs(AS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function __(e,t){if(1&e){const e=Go();xo(0,"button",15),Vo("click",function(){return Dt(e),Ko().openBuildModal()}),sa(1,"Build"),ko()}}function w_(e,t){if(1&e){const e=Go();xo(0,"button",15),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Arrange"),ko()}}function P_(e,t){if(1&e){const e=Go();xo(0,"button",16),Vo("click",function(){return Dt(e),Ko().toggleArrangeMode()}),sa(1,"Stop"),ko()}}function M_(e,t){if(1&e&&(xo(0,"option",9),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("value",e),Jr(1),ra(i.getBuildingName(e))}}function L_(e,t){if(1&e&&(xo(0,"span",21),Fo(1,"app-building",22),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.plateauService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function D_(e,t){if(1&e&&(xo(0,"div",17),xo(1,"div",18),xo(2,"span"),sa(3,"Buildings"),ko(),ko(),xo(4,"div",19),Po(5,L_,2,6,"span",20),ko(),ko()),2&e){const e=Ko();Jr(5),Lo("ngForOf",e.getBuildings())}}const x_=function(e){return{activePage:e}};function k_(e,t){if(1&e){const e=Go();xo(0,"span",25),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).setPage(t)}),sa(1),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(2,x_,i.currentPage===e)),Jr(1),na("page ",e+1,"")}}function F_(e,t){if(1&e&&(xo(0,"span",21),Fo(1,"app-building",22),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),Lo("building",e)("parentRegion",i.plateauService)("combineMode",i.combineMode)("splitMode",i.splitMode)("demolishMode",i.demolishMode)("arrangeMode",i.arrangeMode)}}function U_(e,t){if(1&e&&(xo(0,"div",17),xo(1,"div",23),Po(2,k_,2,4,"span",24),ko(),xo(3,"div",19),Po(4,F_,2,6,"span",20),ko(),ko()),2&e){const e=Ko();Jr(2),Lo("ngForOf",e.getPagesNumber()),Jr(2),Lo("ngForOf",e.getPagedBuildings())}}let H_=(()=>{class e extends gv{constructor(e,t,i,s,r,n,o,a){super(e,t,i,n,s,o,a,Kf.PLATEAU),this.landService=t,this.techService=r,this.plateauService=n}areWonderBuildingsResearched(){return!Am.production||this.techService.isResearched(kf.WONDER_BUILDINGS)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(NS),Mo(AS),Mo(yS),Mo(Wb),Mo(N_),Mo(vS),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-field"]],features:[fo],decls:30,vars:19,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],["class","buildingsWrapper",4,"ngIf"],[3,"click"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),Po(5,__,2,0,"button",4),Po(6,w_,2,0,"button",4),Po(7,P_,2,0,"button",5),xo(8,"div",6),sa(9," Filter:"),Fo(10,"br"),xo(11,"div",7),xo(12,"select",8),Vo("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),xo(13,"option",9),sa(14),ko(),Po(15,M_,2,2,"option",10),ko(),xo(16,"select",8),Vo("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),xo(17,"option",9),sa(18,"All"),ko(),xo(19,"option",9),sa(20,"Working"),ko(),xo(21,"option",9),sa(22,"Idle"),ko(),ko(),ko(),ko(),ko(),xo(23,"div",11),Fo(24,"app-icon",12),sa(25),Fo(26,"app-icon",13),sa(27),ko(),Po(28,D_,6,1,"div",14),Po(29,U_,5,2,"div",14),ko(),ko()),2&e&&(Jr(5),Lo("ngIf",t.areWonderBuildingsResearched()),Jr(1),Lo("ngIf",!t.arrangeMode&&t.getBuildings().length>1),Jr(1),Lo("ngIf",t.arrangeMode),Jr(5),Lo("ngModel",t.filterBuilding),Jr(1),Lo("value",t.allBuildings),Jr(1),ra(t.getBuildingName(t.allBuildings)),Jr(1),Lo("ngForOf",t.getUniqueBuildingsFromCurrentView()),Jr(1),Lo("ngModel",t.filterWorking),Jr(1),Lo("value",t.buildingStates.ALL),Jr(2),Lo("value",t.buildingStates.WORKING),Jr(2),Lo("value",t.buildingStates.IDLE),Jr(3),Lo("name","hammer")("title","Workers")("margin","0 0 0 2px"),Jr(1),na(" ",t.getUnemployed()," \xa0\xa0\xa0 "),Jr(1),Lo("name","land"),Jr(1),na(" ",t.getFreeLand()," "),Jr(1),Lo("ngIf",!t.isPagedViewEnabled()),Jr(1),Lo("ngIf",t.isPagedViewEnabled()))},directives:[FO,Gu,VT,dT,MT,zT,$T,Uu,sI,lb,ku],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}","#allControl[_ngcontent-%COMP%]{margin-left:auto;width:108px;display:inline-block}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px}"]}),e})();function G_(e,t){if(1&e&&(xo(0,"span",17),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("+",e.effect,"% ")}}function B_(e,t){if(1&e&&(xo(0,"span",18),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.effect,"% ")}}function W_(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.duration," ")}}function V_(e,t){1&e&&(xo(0,"span"),sa(1,"permanent"),ko())}function z_(e,t){if(1&e&&(xo(0,"div",13),xo(1,"span"),sa(2),ko(),xo(3,"span"),sa(4),ko(),xo(5,"span"),sa(6),ko(),Po(7,G_,2,1,"span",14),Po(8,B_,2,1,"span",15),Po(9,W_,2,1,"span",16),Po(10,V_,2,0,"span",16),ko()),2&e){const e=t.$implicit,i=t.index,s=Ko();Jr(2),na("",i+1,"."),Jr(2),ra(e.name),Jr(2),ra(s.getBuildingName(e.building)),Jr(1),Lo("ngIf",e.effect>=0),Jr(1),Lo("ngIf",e.effect<0),Jr(1),Lo("ngIf",e.duration>0),Jr(1),Lo("ngIf",e.duration<0)}}function Y_(e,t){if(1&e&&(xo(0,"span",17),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("+",e.effect,"% ")}}function K_(e,t){if(1&e&&(xo(0,"span",18),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.effect,"% ")}}function j_(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.duration," ")}}function $_(e,t){1&e&&(xo(0,"span"),sa(1,"permanent"),ko())}function Q_(e,t){if(1&e&&(xo(0,"div",13),xo(1,"span"),sa(2),ko(),xo(3,"span"),sa(4),ko(),xo(5,"span"),sa(6),ko(),Po(7,Y_,2,1,"span",14),Po(8,K_,2,1,"span",15),Po(9,j_,2,1,"span",16),Po(10,$_,2,0,"span",16),ko()),2&e){const e=t.$implicit,i=t.index,s=Ko();Jr(2),na("",i+1,"."),Jr(2),ra(e.name),Jr(2),ra(s.getTroopName(e.troop)),Jr(1),Lo("ngIf",e.effect>=0),Jr(1),Lo("ngIf",e.effect<0),Jr(1),Lo("ngIf",e.duration>0),Jr(1),Lo("ngIf",e.duration<0)}}function q_(e,t){if(1&e&&(xo(0,"span",17),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("+",e.effect,"% ")}}function X_(e,t){if(1&e&&(xo(0,"span",18),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.effect,"% ")}}function Z_(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("",e.duration," ")}}function J_(e,t){1&e&&(xo(0,"span"),sa(1,"permanent"),ko())}function ew(e,t){if(1&e&&(xo(0,"div",19),xo(1,"span"),sa(2),ko(),xo(3,"span"),sa(4),ko(),Po(5,q_,2,1,"span",14),Po(6,X_,2,1,"span",15),Po(7,Z_,2,1,"span",16),Po(8,J_,2,0,"span",16),ko()),2&e){const e=t.$implicit,i=t.index;Jr(2),na("",i+1,"."),Jr(2),ra(e.name),Jr(1),Lo("ngIf",e.effect>=0),Jr(1),Lo("ngIf",e.effect<0),Jr(1),Lo("ngIf",e.duration>0),Jr(1),Lo("ngIf",e.duration<0)}}let tw=(()=>{class e{constructor(e){this.effectsService=e}ngOnInit(){}getBuildingsEffects(){return this.effectsService.getBuildingEffects().filter(e=>!e.isBuff()).sort((e,t)=>e.isPermanent()&&!t.isPermanent()?-1:e.isPermanent()&&t.isPermanent()?0:!e.isPermanent()&&t.isPermanent()?1:void 0)}getArmyEffects(){return this.effectsService.getArmyEffects()}getBuildingName(e){return Qf.prepareBuildingName(e)}getTroopName(e){return Qf.prepareTroopName(e)}getNatureEffects(){return this.effectsService.getNatureEffects()}}return e.\u0275fac=function(t){return new(t||e)(Mo(bS))},e.\u0275cmp=Ve({type:e,selectors:[["app-effects-management"]],decls:53,vars:3,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],["id","buildingEffects"],[1,"headers"],[1,"rows"],["class","row",4,"ngFor","ngForOf"],["id","armyEffects"],["id","natureEffects"],[1,"headers","natureHeaders"],[1,"natureRows"],["class","row natureRow",4,"ngFor","ngForOf"],[1,"row"],["class","positive",4,"ngIf"],["class","negative",4,"ngIf"],[4,"ngIf"],[1,"positive"],[1,"negative"],[1,"row","natureRow"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-management-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"span"),sa(6,"Effects Management"),ko(),ko(),xo(7,"span"),sa(8,"Buildings effects"),ko(),xo(9,"div",4),xo(10,"div",5),xo(11,"span"),sa(12,"#"),ko(),xo(13,"span"),sa(14,"name"),ko(),xo(15,"span"),sa(16,"building"),ko(),xo(17,"span"),sa(18,"effect"),ko(),xo(19,"span"),sa(20,"duration"),ko(),ko(),xo(21,"div",6),Po(22,z_,11,7,"div",7),ko(),ko(),xo(23,"span"),sa(24,"Army effects"),ko(),xo(25,"div",8),xo(26,"div",5),xo(27,"span"),sa(28,"#"),ko(),xo(29,"span"),sa(30,"name"),ko(),xo(31,"span"),sa(32,"troop"),ko(),xo(33,"span"),sa(34,"effect"),ko(),xo(35,"span"),sa(36,"duration"),ko(),ko(),xo(37,"div",6),Po(38,Q_,11,7,"div",7),ko(),ko(),xo(39,"span"),sa(40,"Nature effects"),ko(),xo(41,"div",9),xo(42,"div",10),xo(43,"span"),sa(44,"#"),ko(),xo(45,"span"),sa(46,"name"),ko(),xo(47,"span"),sa(48,"effect"),ko(),xo(49,"span"),sa(50,"duration"),ko(),ko(),xo(51,"div",11),Po(52,ew,9,6,"div",12),ko(),ko(),ko(),ko()),2&e&&(Jr(22),Lo("ngForOf",t.getBuildingsEffects()),Jr(16),Lo("ngForOf",t.getArmyEffects()),Jr(14),Lo("ngForOf",t.getNatureEffects()))},directives:[O_,Uu,Gu],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#content[_ngcontent-%COMP%]{margin:.5%;height:94%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#buildingEffects[_ngcontent-%COMP%]{height:40%;border:black solid 1px}#armyEffects[_ngcontent-%COMP%]{height:33%;border:black solid 1px}#natureEffects[_ngcontent-%COMP%]{height:15%;border:black solid 1px}.rows[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:90.5%;overflow-y:auto}.natureRows[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:79%;overflow-y:auto}.row[_ngcontent-%COMP%]{display:flex;border:black solid 1px;margin:3px}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{border-right:none}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 35%}.natureRow[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 50%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 30%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 13%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:auto;border-right:black solid 1px}.headers[_ngcontent-%COMP%]{margin:3px 3px 0;display:flex;width:98.3%;flex-direction:row;text-align:center;font-size:.9em}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border:black solid 1px;border-left:none}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{border-left:black solid 1px}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 35%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 30%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 13%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.natureHeaders[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 50%}.positive[_ngcontent-%COMP%]{color:var(--positive-colour)}.negative[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e})();function iw(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko();Jr(1),ra(e.getForestSize())}}function sw(e,t){if(1&e&&(xo(0,"span",16),sa(1),ko()),2&e){const e=Ko();Jr(1),ra(e.getForestSize())}}let rw=(()=>{class e{constructor(e){this.landService=e}ngOnInit(){}getForestSize(){return this.landService.getForest()}getLandSize(){return this.landService.getLand()}getForestOptions(){return this.landService.getForestOptions()}}return e.\u0275fac=function(t){return new(t||e)(Mo(NS))},e.\u0275cmp=Ve({type:e,selectors:[["app-forest-management"]],decls:33,vars:10,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],[1,"icon"],[3,"name"],[4,"ngIf"],["class","critical",4,"ngIf"],["id","forest","type","checkbox",3,"ngModel","ngModelChange"],["for","forest",1,"foresterLabel"],["id","forestSize","type","number","min","0",3,"ngModel","ngModelChange"],["id","land","type","checkbox",3,"ngModel","ngModelChange"],["for","land",1,"foresterLabel"],["id","landSize","type","number","min","0",3,"ngModel","ngModelChange"],["for","forestSize2"],["id","forestSize2","type","number","min","0",3,"ngModel","ngModelChange"],[1,"critical"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-management-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"span"),sa(6,"Forest Management"),ko(),ko(),xo(7,"div",4),Fo(8,"app-icon",5),Po(9,iw,2,1,"span",6),Po(10,sw,2,1,"span",7),sa(11," \xa0\xa0 "),Fo(12,"app-icon",5),sa(13),ko(),Fo(14,"br"),sa(15," Plant trees if:"),Fo(16,"br"),xo(17,"input",8),Vo("ngModelChange",function(e){return t.getForestOptions().forestSizeRuleEnabled=e}),ko(),xo(18,"label",9),sa(19,"forest smaller than"),ko(),xo(20,"input",10),Vo("ngModelChange",function(e){return t.getForestOptions().forestSizeRule=e}),ko(),Fo(21,"br"),xo(22,"input",11),Vo("ngModelChange",function(e){return t.getForestOptions().landSizeRuleEnabled=e}),ko(),xo(23,"label",12),sa(24,"free land bigger than"),ko(),xo(25,"input",13),Vo("ngModelChange",function(e){return t.getForestOptions().landSizeRule=e}),ko(),Fo(26,"br"),Fo(27,"br"),sa(28," Cut trees if:"),Fo(29,"br"),xo(30,"label",14),sa(31,"Forest bigger than "),ko(),xo(32,"input",15),Vo("ngModelChange",function(e){return t.getForestOptions().forestSizeReserved=e}),ko(),ko(),ko()),2&e&&(Jr(8),Lo("name","forest"),Jr(1),Lo("ngIf",t.getForestSize()>=400),Jr(1),Lo("ngIf",t.getForestSize()<400),Jr(2),Lo("name","land"),Jr(1),na(" ",t.getLandSize()," "),Jr(4),Lo("ngModel",t.getForestOptions().forestSizeRuleEnabled),Jr(3),Lo("ngModel",t.getForestOptions().forestSizeRule),Jr(2),Lo("ngModel",t.getForestOptions().landSizeRuleEnabled),Jr(3),Lo("ngModel",t.getForestOptions().landSizeRule),Jr(7),Lo("ngModel",t.getForestOptions().forestSizeReserved))},directives:[O_,sI,Gu,VO,dT,MT,JT,DT,KO],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#content[_ngcontent-%COMP%]{margin:.5%;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.foresterLabel[_ngcontent-%COMP%]{display:inline-block;width:200px}input[type=number][_ngcontent-%COMP%]{width:6ch}"]}),e})(),nw=(()=>{class e{constructor(e,t,i){this.servicesService=e,this.resourcesService=t,this.gameService=i,this.heritagePoints=0,this.spentHeritagePoints=0,this.xp=0,e.addService(Zf.HERITAGE,this)}getName(){return"HeritageService"}load(e){this.heritagePoints=void 0!==e.heritagePoints?e.heritagePoints:0,this.spentHeritagePoints=void 0!==e.spentHeritagePoints?e.spentHeritagePoints:0,this.xp=void 0!==e.xp?e.xp:0,this.heritagePoints>0&&this.gameService.enable(Mf.HERITAGE)}reset(e,t){e&&(this.heritagePoints=0,this.xp=0),this.heritagePoints>0&&this.gameService.enable(Mf.HERITAGE),this.spentHeritagePoints=0}save(){return{heritagePoints:this.heritagePoints,spentHeritagePoints:this.spentHeritagePoints,xp:this.xp}}increaseHeritagePoints(e){this.gameService.enable(Mf.HERITAGE),this.heritagePoints+=e}increaseXP(e){this.xp+=e}spendHeritagePoints(e){return e<=this.getAvailableHeritagePoints()&&(this.spentHeritagePoints+=e,!0)}hasHeritagePoints(e){return e<=this.heritagePoints-this.spentHeritagePoints}getHeritagePoints(){return this.heritagePoints}calculateHeritagePoints(e=!1){let t=this.resourcesService.getTotalPeople(),i=this.xp,s=20+2*this.heritagePoints,r=0;for(;t>=s;)r+=1,t-=s,s+=2;for(;t+i>=s;)r+=1,t-=s,t<0&&(i+=t),s+=2;return e&&(this.xp=i),t-=50,t<0&&(t=0),{hp:r,xp:t}}peopleToNextHeritagePoint(){let e=this.resourcesService.getTotalPeople()+this.xp,t=20+2*this.heritagePoints;for(;e>=t;)e-=t,t+=2;return t-e}getAvailableHeritagePoints(){return this.heritagePoints-this.spentHeritagePoints}getXP(){return this.xp}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(Pv),gs(AS))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ow(e,t){if(1&e){const e=Go();xo(0,"button",6),Vo("click",function(){return Dt(e),Ko().addHeritagePoints()}),sa(1,"add"),ko()}}function aw(e,t){if(1&e&&(xo(0,"span"),sa(1),Fo(2,"br"),ko()),2&e){const e=Ko();Jr(1),na("XP towards next heritage point: ",e.getXP(),"")}}const cw=function(e){return{selected:e}};let lw=(()=>{class e{constructor(e,t,i){this.heritageService=e,this.landService=t,this.modalService=i,this.multiplier=1,this.selectedMode=0}ngOnInit(){}getHeritagePoints(){return this.heritageService.getHeritagePoints()}getAvailableHeritagePoints(){return this.heritageService.getAvailableHeritagePoints()}buyLand(){this.heritageService.spendHeritagePoints(this.multiplier)?this.landService.increaseLand(10*this.multiplier,!0):this.modalService.info("No enough Heritage Points!")}buyForest(){this.heritageService.spendHeritagePoints(this.multiplier)?this.landService.increaseForest(10*this.multiplier,!1):this.modalService.info("No enough Heritage Points!")}buyMountains(){this.heritageService.spendHeritagePoints(this.multiplier)?this.landService.increaseMountains(5*this.multiplier):this.modalService.info("No enough Heritage Points!")}addHeritagePoints(){this.heritageService.increaseHeritagePoints(10)}isDev(){return!Am.production}getXP(){return this.heritageService.getXP()}getBuyButtonText(){return 0===this.selectedMode?"Buy "+10*this.multiplier+" land":1===this.selectedMode?"Buy "+10*this.multiplier+" forest":2===this.selectedMode?"Buy "+5*this.multiplier+" mountains":void 0}buy(){0===this.selectedMode?this.buyLand():1===this.selectedMode?this.buyForest():2===this.selectedMode&&this.buyMountains()}}return e.\u0275fac=function(t){return new(t||e)(Mo(nw),Mo(NS),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-heritage"]],decls:41,vars:22,consts:[["id","wrapper"],["id","title"],[3,"click",4,"ngIf"],[4,"ngIf"],["for","multiplier"],["id","multiplier","type","number","min","1",3,"max","ngModel","ngModelChange"],[3,"click"],["id","modes"],[1,"mode",3,"ngClass","click"],[1,"title"],["src","assets/land.svg"],[1,"effect"],["src","assets/forest.svg"],["src","assets/mountains.svg"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),xo(2,"span"),sa(3,"Heritage"),ko(),ko(),Fo(4,"br"),sa(5),Po(6,ow,2,0,"button",2),Fo(7,"br"),Po(8,aw,3,1,"span",3),Fo(9,"br"),sa(10," Heritage points can be used to buy more land or unlock research projects. "),Fo(11,"br"),Fo(12,"br"),xo(13,"label",4),sa(14,"Spend "),ko(),xo(15,"input",5),Vo("ngModelChange",function(e){return t.multiplier=e}),ko(),xo(16,"label",4),sa(17," Heritage Points to"),ko(),xo(18,"button",6),Vo("click",function(){return t.buy()}),sa(19),ko(),Fo(20,"br"),Fo(21,"br"),xo(22,"div",7),xo(23,"div",8),Vo("click",function(){return t.selectedMode=0}),xo(24,"span",9),sa(25,"Land"),ko(),Fo(26,"img",10),xo(27,"span",11),sa(28),ko(),ko(),xo(29,"div",8),Vo("click",function(){return t.selectedMode=1}),xo(30,"span",9),sa(31,"Forest"),ko(),Fo(32,"img",12),xo(33,"span",11),sa(34),ko(),ko(),xo(35,"div",8),Vo("click",function(){return t.selectedMode=2}),xo(36,"span",9),sa(37,"Mountains"),ko(),Fo(38,"img",13),xo(39,"span",11),sa(40),ko(),ko(),ko(),ko()),2&e&&(Jr(5),oa(" Heritage points: ",t.getAvailableHeritagePoints(),"/",t.getHeritagePoints()," "),Jr(1),Lo("ngIf",t.isDev()),Jr(2),Lo("ngIf",t.getXP()>0),Jr(7),$o("max",t.getAvailableHeritagePoints()),Lo("ngModel",t.multiplier),Jr(4),ra(t.getBuyButtonText()),Jr(4),Lo("ngClass",Mc(16,cw,0===t.selectedMode)),Jr(5),oa("",10*t.multiplier," land for ",t.multiplier," HP"),Jr(1),Lo("ngClass",Mc(18,cw,1===t.selectedMode)),Jr(5),oa("",10*t.multiplier," forest for ",t.multiplier," HP"),Jr(1),Lo("ngClass",Mc(20,cw,2===t.selectedMode)),Jr(5),oa("",5*t.multiplier," mountains for ",t.multiplier," HP"))},directives:[Gu,JT,XT,DT,KO,dT,MT,ku],styles:["#wrapper[_ngcontent-%COMP%]{margin:.5%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#multiplier[_ngcontent-%COMP%]{width:5ch}#modes[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.mode[_ngcontent-%COMP%]{display:flex;cursor:pointer;flex-direction:column;height:150px;width:200px;border:black solid 1px;align-items:center;margin-right:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.mode[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px}.mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:bold}.mode[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{margin-top:4px;font-size:.8em}.selected[_ngcontent-%COMP%]{border:black solid 3px}"]}),e})();var uw=(()=>(function(e){e[e.LAND=0]="LAND",e[e.SEA=1]="SEA"}(uw||(uw={})),uw))();class hw{constructor(e,t,i,s,r,n,o,a,c,l){this.speed=3,this.routePaths=[],this.servicesService=e,this.mission=i,this.settings=aS.getMission(i),this.missionTime=this.settings.TIME,this.description=this.settings.DESCRIPTION,this.icon=this.settings.ICON,this.id=t,this.targetIndex=s,this.route=r,this.progress=n,this.status=o,this.ownerCountry=a,this.army=c,this.data=l,e&&(this.armyService=e.getArmyService(),this.logService=e.getLogService(),this.worldService=e.getWorldService(),this.gameService=e.getGameService()),this.initRoutePaths(),"{mission}"===this.status?(this.origin=this.routePaths[this.routePaths.length-1].target,this.target=this.routePaths[this.routePaths.length-1].target):(this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target),this.speed=this.getMissionType()===uw.LAND?c.getArmySpeed():c.getNavy(!1).getArmySpeed()}getMissionName(){return Qf.prepareMissionName(this.mission)}getArmySpeed(){return this.getMissionType()===uw.LAND?this.army.getArmySpeed():this.army.getNavy(!1).getArmySpeed()}getTargetRegionId(){return this.route.path[this.targetIndex]}getCurrentRegionId(){return this.route.path[this.targetIndex-1]}getOrigin(){return this.origin}getTarget(){return this.target}getTravelSpeed(){return 60*this.speed/3/this.getDistance()}tick(){if("traveling"===this.status)this.progress<100?(this.progress+=this.getTravelSpeed(),this.progress>100&&(this.progress=100)):(this.evaluateRegion(),this.targetIndex===this.route.path.length-1?(this.origin=this.target,this.isInstant()?this.calculateMission()?(this.status="returning",this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target):this.status="finished":this.status="{mission}"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target),this.progress=0);else if("{mission}"===this.status)if(this.progress<100)this.progress+=1/this.missionTime;else{if(this.calculateMission()){this.status="returning",this.speed=this.army.getArmySpeed();const e=this.worldService.findPath(this.getTargetRegionId(),this.route.path[0],this.ownerCountry.id,!1);this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,e&&(e.path.length<this.route.path.length||!this.validateRoute())&&(this.route=e,this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}else this.worldService.clearMission(),this.status="finished";this.progress=0}else("returning"===this.status||"canceled"===this.status)&&(this.progress<100?(this.progress+=this.getTravelSpeed(),this.progress>100&&(this.progress=100)):(this.evaluateRegion(),this.targetIndex===this.route.path.length-1?(this.finish("canceled"===this.status),this.worldService.getSelectedMission()&&this.worldService.getSelectedMission().id===this.id&&this.worldService.clearMission(),this.status="finished"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,this.progress=0)))}getDisplayProgress(){return"{mission}"===this.status?this.progress:this.distanceSoFar()/this.totalDistance()}distanceSoFar(){let e=0;for(let t=0;t<this.targetIndex-1;t++)e+=100*this.calculatePointsDistance(this.routePaths[t].origin,this.routePaths[t].target);return e+=this.calculatePointsDistance(this.routePaths[this.targetIndex-1].origin,this.routePaths[this.targetIndex-1].target)*this.progress,e}totalDistance(){let e=0;for(let t=0;t<this.routePaths.length;t++)e+=this.calculatePointsDistance(this.routePaths[t].origin,this.routePaths[t].target);return e}getProgressPercentage(){return this.progress/100}isFinished(){return"finished"===this.status}getStatus(){return this.status.replace("{mission}",Qf.prepareMissionName(this.mission))}getDistance(){const e=this.calculatePointsDistance(this.origin,this.target);return this.worldService.getRegion(this.getCurrentRegionId()).roads?e*gS.ROADS_DISTANCE_MODIFIER:e}calculatePointsDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}canCancel(){return!1}}class dw{constructor(e,t,i,s,r,n,o){this.originRegion=e,this.originRegionColour=t,this.targetRegion=i,this.targetRegionColour=s,this.targetRegionCountry=r,this.targetSeaEvent=n,this.missionType=o}}var gw=(()=>(function(e){e[e.NONE=0]="NONE",e[e.PEACE=1]="PEACE",e[e.SAVE_WEALTH=2]="SAVE_WEALTH",e[e.ECONOMY_BUILD=3]="ECONOMY_BUILD",e[e.ECONOMY_COLONIZE=4]="ECONOMY_COLONIZE",e[e.DEFENSE_WALL=5]="DEFENSE_WALL",e[e.DEFENSE_ARCHER=6]="DEFENSE_ARCHER",e[e.DEFENSE_GATHER_FORCES=7]="DEFENSE_GATHER_FORCES",e[e.OFFENSE_MILITIA=8]="OFFENSE_MILITIA",e[e.OFFENSE_SPEARMAN=9]="OFFENSE_SPEARMAN",e[e.OFFENSE_SWORDSMAN=10]="OFFENSE_SWORDSMAN",e[e.OFFENSE_LIGHT_CAVALRY=11]="OFFENSE_LIGHT_CAVALRY",e[e.OFFENSE_GATHER_FORCES=12]="OFFENSE_GATHER_FORCES",e[e.OFFENSE_COLONIZE=13]="OFFENSE_COLONIZE",e[e.OFFENSE_PLUNDER=14]="OFFENSE_PLUNDER",e[e.OFFENSE_CONQUER=15]="OFFENSE_CONQUER",e[e.OFFENSE_RECLAIM_CAPITAL=16]="OFFENSE_RECLAIM_CAPITAL",e[e.DEFENSE_GUARD_TOWER=17]="DEFENSE_GUARD_TOWER"}(gw||(gw={})),gw))();class pw{constructor(e,t,i,s,r,n,o,a){this.data={},this.id=e,this.name=t,this.diplomacy=i,this.colour=s,this.focus=r,this.regions=n,this.data=o,this.capital=a}getDiplomacy(){return this.diplomacy<-25?"hostile":this.diplomacy>=-25&&this.diplomacy<25?"neutral":this.diplomacy>=25?"friendly":void 0}decreaseDiplomacy(e){this.diplomacy-=e,this.diplomacy<-100&&(this.diplomacy=-100)}increaseDiplomacy(e){this.diplomacy+=e,this.diplomacy>100&&(this.diplomacy=100)}}class fw{constructor(e,t,i,s,r,n,o,a,c,l,u,h,d,g,p,f,m,S=0){this.id=e,this.path=t,this.center=i,this.neighbours=s,this.land=r,this.forest=n,this.mountains=o,this.wealth=a,this.economy=c,this.defense=l,this.harbour=u,this.roads=h,this.watchtower=d,this.watched=g,this.target=p,this.spy=f,this.army=m,this.navy=new Cy([]),this.lastAttack=S}getSize(){return this.land+this.forest+this.mountains}}class mw{constructor(e,t){this.id=e,this.neighbours=t}}class Sw{constructor(e){this.distance=0,this.path=e}reversePath(){this.path=this.path.reverse()}calculatePathDistance(e){if(0!==this.distance)return this.distance;let t=0;for(let i=0;i<this.path.length-1;i++){const s=e.getRegion(this.path[i]),r=this.calculatePointsDistance(s.center,e.getRegion(this.path[i+1]).center);t+=s.roads?r*gS.ROADS_DISTANCE_MODIFIER:r}return this.distance=t,t}calculateSeaPathDistance(e){if(0!==this.distance)return this.distance;let t=0;for(let i=0;i<this.path.length-1;i++)t+=this.calculatePointsDistance(e.getSeaArea(this.path[i]).center,e.getSeaArea(this.path[i+1]).center);return this.distance=t,t}calculatePointsDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}}class Ew extends hw{constructor(e,t,i,s,r,n,o,a,c,l){super(e,t,i,s,r,n,o,a,c,l)}toJSON(){const e=[];return this.army.units.forEach(t=>e.push({troop:t.troop,size:t.size})),{type:this.mission,id:this.id,ownerCountryId:this.ownerCountry.id,army:e,route:this.route.path,progress:this.progress,targetIndex:this.targetIndex,status:this.status,data:this.data}}getDestinationTargetRegion(){return this.worldService.getRegion(this.route.path[this.route.path.length-1])}getMissionType(){return uw.LAND}getTravelSpeed(){let e=super.getTravelSpeed();return this.ownerCountry.id===zf.PLAYER&&this.gameService.isEnabled(Mf.LOGISTICS)&&(e*=1.1),e}evaluateRegion(){const e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(this.getTargetRegionId());if(!this.validateRoute()){const t=this.worldService.findPath(e.id,this.getDestinationTargetRegion().id,this.ownerCountry.id,!1);if(t&&t.path.length>1){const e=new Sw(this.route.path.splice(0,this.targetIndex));e.path=e.path.concat(t.path),this.route=e,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target}}if(e.id!==this.getDestinationTargetRegion().id&&this.ownerCountry.id!==t.id&&(this.ownerCountry.id===zf.PLAYER&&t.id!==zf.NEUTRAL||this.ownerCountry.id!==zf.PLAYER)&&e.army.hasAny()){const i=this.armyService.calculateAttack(this.army,e.army,e.defense,this.ownerCountry.id===zf.PLAYER,this.ownerCountry.id!==zf.PLAYER);i.attacker=this.ownerCountry.id,i.defender=t.id,(this.ownerCountry.id===zf.PLAYER||t.id===zf.PLAYER)&&(i.result?i.message=this.ownerCountry.id===zf.PLAYER?"We managed to pass through enemy region":"Enemy managed to pass through our region":(this.ownerCountry.id===zf.PLAYER?(i.message="We failed passing through enemy region",this.data&&(e.wealth+=this.data)):(i.message="We defeated enemy armies passing through our region",this.data&&this.armyService.loot(this.data)),this.worldService.getSelectedMission()&&this.worldService.getSelectedMission().id===this.id&&this.worldService.clearMission(),this.status="finished"),this.logService.fightReport(i))}}validateRoute(){for(let e=this.targetIndex;e<this.route.path.length-1;e++){const t=this.worldService.getCountryByRegionId(this.route.path[e]),i=this.worldService.getRegion(this.route.path[e]);if(t.id===zf.NEUTRAL&&i.army.hasAny())return!1;if(t.id===zf.NEUTRAL)return!0;if(t.id!==this.ownerCountry.id)return!1}return!0}initRoutePaths(){this.routePaths=[];for(let e=0;e<this.route.path.length-1;e++){const t=this.worldService.getRegion(this.route.path[e]),i=this.worldService.getRegion(this.route.path[e+1]);this.routePaths.push({origin:{x:t.center.x,y:t.center.y},target:{x:i.center.x,y:i.center.y}})}}cancel(){this.canCancel()&&"traveling"===this.status&&(this.progress=100-this.progress,this.status="returning",this.route.reversePath(),this.targetIndex=this.route.path.length-this.targetIndex,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}getIconPath(){return"assets/army/mission/"+this.icon+".svg"}getArmyEffectiveSpeed(){return this.ownerCountry.id===zf.PLAYER&&this.gameService.isEnabled(Mf.LOGISTICS)?1.1*this.army.getArmySpeed():this.army.getArmySpeed()}}class vw extends Ew{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.COLONIZE,o,r,n,a,i,s,c),e&&(this.landService=e.getLandService())}isInstant(){return!1}calculateMission(){const e=this.worldService.getRegion(this.getTargetRegionId());if(this.worldService.getCountryByRegionId(e.id).id!==zf.PLAYER){if(this.ownerCountry.id!==zf.PLAYER&&e.army.hasAny()&&e.army.getArmyPower(!1)<10)this.logService.success("Our troops lost against enemy colonists"),e.army=new Cy([]);else if(this.ownerCountry.id!==zf.PLAYER&&e.army.hasAny())return!1;am.chance(5*this.army.getUnit(Wf.COLONIST).size/100)?(this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.army=new Cy([]),this.ownerCountry.id===zf.PLAYER&&this.logService.success("We colonized new region!")):this.ownerCountry.id===zf.PLAYER&&this.logService.warning("Our colonists lost against the harsh conditions and died during attempt to colonize new region")}else this.ownerCountry.id===zf.PLAYER&&this.logService.warning("Our colonists died in a bandits ambush");return!1}finish(e){}}class Rw extends Ew{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.CONQUER,o,r,n,a,i,s,c),e&&(this.landService=e.getLandService())}isInstant(){return!1}calculateMission(){if(this.ownerCountry.id===zf.PLAYER){const e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){const i=this.armyService.calculateAttack(this.army,e.army,e.defense,!0,!1);return i.attacker=this.ownerCountry.id,i.defender=t.id,i.result?(i.message="Region conquered",this.servicesService.getHappinessService().addHappinessEffect(0,$f.SUCCESSFUL_CONQUER,2,90),this.logService.fightReport(i),this.armyService.loot(50*e.wealth+200*e.economy),t.diplomacy<25?t.decreaseDiplomacy(30):t.diplomacy=-50,t.capital===e.id&&(t.diplomacy=-100),this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new Cy([]),!1):(i.message="Our army has been defeated",this.logService.fightReport(i),t.diplomacy<25?t.decreaseDiplomacy(15):t.diplomacy=30,!1)}return!0}{const e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id===zf.PLAYER&&this.worldService.isProtected())return this.logService.log("We were protected from conquer"),!0;if(t.id!==this.ownerCountry.id){const i=this.armyService.calculateAttack(this.army,e.army,e.defense,!1,t.id===zf.PLAYER);return i.attacker=this.ownerCountry.id,i.defender=t.id,i.result?0!==e.id?(t.id===zf.PLAYER&&(this.reduceLand(e),i.message="Our region has been conquered by enemy!",this.servicesService.getHappinessService().addHappinessEffect(0,$f.RECENTLY_CONQUERED,-4,90),this.logService.fightReport(i)),this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new Cy([]),!1):(this.data=this.armyService.lootPlayer(50*this.army.getArmySize()),i.message="Our capital has been plundered!",this.servicesService.getHappinessService().addHappinessEffect(0,$f.RECENTLY_INVADED,-4,90),this.logService.fightReport(i),!0):(t.id===zf.PLAYER&&(i.message="We have defeated enemy conquer party!",this.logService.fightReport(i)),e.target=gw.DEFENSE_ARCHER,!1)}return!0}}finish(e){const t=this.getDestinationTargetRegion();t.army.addArmy(this.army),e||(t.wealth+=this.data)}reduceLand(e){let t=e.land+e.forest+e.mountains,i=0,s=0,r=0;if(this.landService.getLand()>=e.land?(t-=e.land,i+=e.land,this.landService.removeLand(e.land)):(t-=this.landService.getLand(),i+=this.landService.getLand(),this.landService.removeLand(this.landService.getLand())),this.landService.getForest()>=e.forest?(t-=e.forest,s+=e.forest,this.landService.removeForest(e.forest)):(t-=this.landService.getForest(),s+=this.landService.getForest(),this.landService.removeForest(this.landService.getForest())),this.landService.getMountains()>=e.mountains?(t-=e.mountains,r+=e.mountains,this.landService.removeMountains(e.mountains)):(t-=this.landService.getMountains(),r+=this.landService.getMountains(),this.landService.removeMountains(this.landService.getMountains())),t>0){if(this.landService.getForest()>0){if(this.landService.getForest()>t)return this.landService.removeForest(t),s+=t,void this.setLands(e,i,s,r);t-=this.landService.getForest(),s+=this.landService.getForest(),this.landService.removeForest(this.landService.getForest())}if(this.landService.getLand()>0){if(this.landService.getLand()>t)return this.landService.removeLand(t),i+=t,void this.setLands(e,i,s,r);t-=this.landService.getLand(),i+=this.landService.getLand(),this.landService.removeLand(this.landService.getLand())}if(this.landService.getMountains()>0){if(this.landService.getMountains()>t)return this.landService.removeMountains(t),r+=t,void this.setLands(e,i,s,r);t-=this.landService.getMountains(),r+=this.landService.getMountains(),this.landService.removeMountains(this.landService.getMountains())}}this.setLands(e,i,s,r)}setLands(e,t,i,s){e.land=t,e.forest=i,e.mountains=s}canCancel(){return!0}}class Ow extends Ew{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.PLUNDER,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){if(this.ownerCountry.id===zf.PLAYER){const e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){const i=this.armyService.calculateAttack(this.army,e.army,e.defense,!0,!1);return i.attacker=this.ownerCountry.id,i.defender=t.id,i.result?(t.decreaseDiplomacy(t.diplomacy<25?10:30),this.data=e.wealth,e.wealth=0,i.message="Region plundered",this.logService.fightReport(i),e.target=gw.DEFENSE_ARCHER,!0):(i.message="Our army has been defeated",this.logService.fightReport(i),t.decreaseDiplomacy(t.diplomacy<25?5:15),e.target=gw.DEFENSE_ARCHER,!1)}return!0}{const e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id===zf.PLAYER&&this.worldService.isProtected())return this.logService.log("We were protected from plunder"),!0;if(t.id!==this.ownerCountry.id){const i=this.armyService.calculateAttack(this.army,e.army,e.defense,!1,t.id===zf.PLAYER);return i.attacker=this.ownerCountry.id,i.defender=t.id,i.result?t.id===zf.PLAYER||t.id===zf.NEUTRAL?(this.data=this.armyService.lootPlayer(50*this.army.getArmySize()),i.message=t.id===zf.NEUTRAL?"Our troops stationed in neutral region have been defeated":"We have been plundered!",this.servicesService.getHappinessService().addHappinessEffect(0,$f.RECENTLY_INVADED,-2,60),this.logService.fightReport(i),!0):(this.data=e.wealth,this.data>Math.floor(this.army.getArmySize()/2)?(this.data=Math.floor(this.army.getArmySize()/2),e.wealth-=this.data):e.wealth=0,e.target=gw.DEFENSE_ARCHER,!0):(t.id===zf.PLAYER&&(i.message="We have defeated enemy plunder party!",this.logService.fightReport(i)),!1)}return!0}}finish(e){if(this.ownerCountry.id===zf.PLAYER)this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new Cy([]),e||this.armyService.loot(50*this.data);else{const e=this.getDestinationTargetRegion();this.worldService.getCountryByRegionId(e.id)!==this.ownerCountry?this.worldService.addMission(new Rw(this.servicesService,this.id,this.ownerCountry,this.army,this.route,0,this.targetIndex,"{mission}",this.data)):(e.army.addArmy(this.army),e.wealth+=this.data)}}canCancel(){return!0}}class Tw extends Ew{constructor(e,t,i,s,r,n=0,o=1,a="{mission}",c=null){super(e,t,Uf.BUILD,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){const e=this.getDestinationTargetRegion();if(null!==this.data)switch(this.data){case gm.DEFENSES:return e.defense+=1,!1;case gm.ROADS:return e.roads=!0,!1;case gm.WATCHTOWER:{e.watchtower=!0;const t=this.getDestinationTargetRegion();return this.worldService.getCountryByRegionId(t.id).id===zf.PLAYER&&t.neighbours.forEach(e=>{e>=0&&(this.worldService.getRegion(e).watched=!0)}),!1}case gm.GUARD_TOWER:return e.army.addTroop(Wf.GUARD_TOWER,1),!1;case gm.HARBOUR:return e.harbour=!0,!1}return!1}finish(e){}}class Iw{constructor(e,t,i,s,r){this.id=e,this.center=t,this.r=i,this.events=s,this.neighbours=r}}class bw{constructor(e,t,i,s,r,n,o){if(this.parentId=e,this.id=t,this.type=i,this.center=s,this.amount=r,this.time=n,this.data=o,i===jf.PIRATES||i===jf.PIRATES_BASE)if(null===o)for(this.data=new Cy([]);this.amount>=80;)this.amount>=aS.getTroop(Wf.GALLEON).PAY&&(this.amount-=aS.getTroop(Wf.GALLEON).PAY,this.data.addTroop(Wf.GALLEON,1),this.amount>=aS.getTroop(Wf.BRIGANTINE).PAY&&(this.amount-=aS.getTroop(Wf.BRIGANTINE).PAY,this.data.addTroop(Wf.BRIGANTINE,1))),this.amount>=aS.getTroop(Wf.BRIGANTINE).PAY&&(this.amount-=aS.getTroop(Wf.BRIGANTINE).PAY,this.data.addTroop(Wf.BRIGANTINE,1));else this.data=new Cy([]),o.units.forEach(e=>{e.troop&&this.data.addTroop(e.troop,e.size)});this.amount=r}toJSON(){return{parentId:this.parentId,id:this.id,type:this.type,center:this.center,amount:this.amount,time:this.time,data:this.data}}tick(e,t,i,s){if(this.type===jf.WHIRLPOOL&&(this.time-=1),this.type===jf.PIRATES_BASE&&(this.time-=1,this.time<=10)){let r=0;if(t.getSeaAreas().forEach(e=>{e.events.length>0&&e.events[0].type===jf.PIRATES&&(r+=1)}),this.time=am.randomBetween(gS.SEA_EVENTS.PIRATES_BASE.TIME_MIN+50*r,gS.SEA_EVENTS.PIRATES_BASE.TIME_MAX+50*r),r<2*gS.SEA_EVENTS.PIRATES.NUMBER_MAX){const r=t.getSeaAreas().filter(e=>-1!==e.id&&0===e.events.length&&e.r>0),n=r[am.randomBetween(0,r.length-1)];n.events.push(new bw(n.id,i.getNextId(),jf.PIRATES,t.getRandomPointInCircle(n.center,n.r),am.randomBetween(gS.SEA_EVENTS.PIRATES.POWER_MIN,gS.SEA_EVENTS.PIRATES.POWER_MAX),am.randomBetween(gS.SEA_EVENTS.PIRATES.TIME_MIN,gS.SEA_EVENTS.PIRATES.TIME_MAX),null)),e.getGameService().isEnabled(Mf.BOAT_BUILDER)&&s.warning("Pirates base sent a new pirates group")}}}}class Cw extends Ew{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.MOVE,o,r,n,a,i,s,c)}isInstant(){return!0}calculateMission(){const e=this.getDestinationTargetRegion(),t=this.worldService.getCountryByRegionId(e.id);return t.id!==zf.PLAYER&&t.id!==zf.NEUTRAL||(e.army.addArmy(this.army),this.army=new Cy([]),!1)}finish(e){this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new Cy([])}canCancel(){return!0}}class yw extends Ew{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.SPY,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){const e=this.getDestinationTargetRegion(),t=this.worldService.getCountryByRegionId(e.id);if(e&&this.army.getUnit(Wf.SPY)){if(t.id===zf.PLAYER)return!0;e.spy+=this.army.getUnit(Wf.SPY).size,this.army=new Cy([])}return!1}finish(e){this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new Cy([])}}class Aw extends hw{constructor(e,t,i,s,r,n,o,a,c,l){super(e,t,i,s,r,n,o,a,c,l)}toJSON(){const e=[];return this.army.units.forEach(t=>e.push({troop:t.troop,size:t.size})),{type:this.mission,id:this.id,ownerCountryId:this.ownerCountry.id,army:e,route:this.route.path,progress:this.progress,targetIndex:this.targetIndex,status:this.status,data:this.data}}initRoutePaths(){this.routePaths=[];const e=this.worldService.getSeaArea(this.route.path[0]),t=this.worldService.getSeaArea(this.route.path[1]);this.routePaths.push({origin:{x:e.center.x,y:e.center.y},target:{x:t.center.x,y:t.center.y}});for(let i=1;i<this.route.path.length-1;i++){const e=this.worldService.getSeaArea(this.route.path[i]),t=this.worldService.getSeaArea(this.route.path[i+1]);this.routePaths.push({origin:{x:e.center.x,y:e.center.y},target:{x:t.center.x,y:t.center.y}})}if(this.mission===Uf.FISHING||this.mission===Uf.HUNTING||this.mission===Uf.TREASURE||this.mission===Uf.CARTOGRAPHY||this.mission===Uf.SEA_BATTLE)if("traveling"===this.status)this.routePaths[this.routePaths.length-1].target=this.getDestinationTargetSeaEvent().center;else if("returning"===this.status){const e=this.worldService.getSeaArea(this.route.path[0]);this.routePaths[0].origin=e.events.length>0?e.events[0].center:e.center}}getTravelSpeed(){let e=super.getTravelSpeed();return this.ownerCountry.id===zf.PLAYER&&(this.gameService.isEnabled(Mf.LOGISTICS)&&(e*=1.1),this.servicesService.getService(Zf.SEA).getBuildings().find(e=>e.getBuildingType()===Lf.LIGHTHOUSE&&e.isWorking())&&(e*=1.1)),e}getDestinationTargetRegion(){return this.route.path[this.route.path.length-1]>=0?this.worldService.getRegion(this.route.path[this.route.path.length-1]):null}getDestinationTargetSeaEvent(){return this.worldService.getSeaArea(this.route.path[this.route.path.length-1]).events[0]}getMissionType(){return uw.SEA}tick(){let e=60*this.speed/3/this.getDistance();if(this.ownerCountry.id===zf.PLAYER&&this.gameService.isEnabled(Mf.LOGISTICS)&&(e*=1.1),"traveling"===this.status)if(this.progress<100)this.progress+=e,this.progress>100&&(this.progress=100);else{if(!this.evaluateRegion())return;this.targetIndex===this.route.path.length-1?(this.origin=this.target,this.isInstant()?this.calculateMission()?(this.status="returning",this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target):this.status="finished":this.status="{mission}"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target),this.progress=0}else if("{mission}"===this.status)if(this.progress<100)this.progress+=1/this.missionTime;else{if(this.calculateMission()){this.status="returning";const e=this.worldService.findSeaPath(this.getTargetRegionId(),this.route.path[0],!1);this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,e&&(e.path.length<this.route.path.length||!this.validateRoute())&&(this.route=e,this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}else this.worldService.clearMission(),this.status="finished";this.progress=0}else("returning"===this.status||"canceled"===this.status)&&(this.progress<100?(this.progress+=e,this.progress>100&&(this.progress=100)):(this.evaluateRegion(),this.targetIndex===this.route.path.length-1?(this.finish("canceled"===this.status),this.worldService.getSelectedMission()&&this.worldService.getSelectedMission().id===this.id&&this.worldService.clearMission(),this.status="finished"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,this.progress=0)))}cancel(){this.canCancel()&&"traveling"===this.status&&(this.progress=100-this.progress,this.status="returning",this.route.reversePath(),this.targetIndex=this.route.path.length-this.targetIndex,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}evaluateRegion(){const e=this.worldService.getSeaArea(this.getTargetRegionId());if(!this.validateRoute()){let t;if(t=this.getDestinationTargetSeaEvent()?this.worldService.findSeaPath(e.id,this.getDestinationTargetSeaEvent().parentId,!1):this.worldService.findSeaPath(e.id,this.getDestinationTargetRegion().id,!1),t&&t.path.length>1){const e=new Sw(this.route.path.splice(0,this.targetIndex));e.path=e.path.concat(t.path),this.route=e,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target}}if((this.getDestinationTargetSeaEvent()&&e.id!==this.getDestinationTargetSeaEvent().parentId||this.getDestinationTargetRegion()&&e.id!==this.getDestinationTargetRegion().id)&&e.events.length>0&&(e.events[0].type===jf.PIRATES||e.events[0].type===jf.PIRATES_BASE)&&(e.events[0].type===jf.PIRATES||e.events[0].type===jf.PIRATES_BASE)){const t=this.army.getNavy(!0),i=this.armyService.calculateAttack(t,e.events[0].data,e.events[0].type===jf.PIRATES?0:3,!0,!1);if(i.attacker=this.ownerCountry.id,i.defender=zf.PIRATES,i.result){i.message=e.events[0].type===jf.PIRATES?"Pirates defeated":"Pirates base destroyed",this.army.addArmy(t);const s=this.army.getLandUnits(!0);for(;s.getArmySize()>0&&this.getTroopsSize(s)>this.getNavyCapacity(t);)s.units[am.randomBetween(0,s.units.length-1)].size-=1,s.removeEmptyUnits();return this.army.addArmy(s),this.data=Math.min(10*this.army.getArmyCargo(),e.events[0].amount),e.events[0].amount-=this.data,e.events[0].amount>=50?e.events[0].type=jf.TREASURE:(e.events[0].amount=0,e.events[0].time=-1),this.logService.fightReport(i),!0}return i.message="Pirates won against our navy",this.status="finished",this.army.clearArmy(),this.logService.fightReport(i),!1}return!0}validateRoute(){if("traveling"===this.status&&this.isEventBasedMission()&&!this.getDestinationTargetSeaEvent())return this.cancel(),!1;for(let e=this.targetIndex;e<this.route.path.length-1;e++){const t=this.worldService.getSeaArea(this.route.path[e]);if(t.events.length>0&&(t.events[0].type===jf.PIRATES||t.events[0].type===jf.PIRATES_BASE))return!1}return!0}getIconPath(){return this.army.hasTroop(Wf.GALLEON)?"assets/sea/galleon.svg":this.army.hasTroop(Wf.BRIGANTINE)?"assets/sea/brigantine.svg":this.army.hasTroop(Wf.BOAT)?"assets/sea/boat.svg":void 0}getTroopsSize(e){let t=0;return e.units.forEach(e=>{e.troop!==Wf.ALL&&e.troop!==Wf.BOAT&&e.troop!==Wf.BRIGANTINE&&e.troop!==Wf.GALLEON&&e.size>0&&(t+=e.getTroopSize())}),t}getNavyCapacity(e){let t=0;return e.units.forEach(e=>{(e.troop===Wf.BOAT||e.troop===Wf.BRIGANTINE||e.troop===Wf.GALLEON)&&e.size>0&&(t+=e.getTroopCargo())}),t}canCancel(){return!0}getDistance(){return this.calculatePointsDistance(this.origin,this.target)}getArmyEffectiveSpeed(){return this.servicesService.getService(Zf.SEA).getBuildings().find(e=>e.getBuildingType()===Lf.LIGHTHOUSE&&e.isWorking())?1.1*this.army.getNavy(!1).getArmySpeed():this.army.getNavy(!1).getArmySpeed()}isEventBasedMission(){return!1}}class Nw extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.FISHING,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){if(!this.getDestinationTargetSeaEvent())return!0;const e=5*this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount);return this.getDestinationTargetSeaEvent().amount-=t,this.data=t,!0}finish(e){this.data&&this.data>0&&this.servicesService.getResourcesService().increaseResource(Df.FISH,this.data,"Fishing",!0),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([])}isEventBasedMission(){return!0}}class _w extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.HUNTING,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){if(!this.getDestinationTargetSeaEvent())return!0;const e=5*this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount),i=Math.ceil(.7*t),s=t-i;return this.getDestinationTargetSeaEvent().amount-=t,this.data={meat:i,fur:s},!0}finish(e){this.data&&this.data.meat>0&&(this.servicesService.getResourcesService().increaseResource(Df.MEAT,this.data.meat,"Sea hunting",!0),this.servicesService.getResourcesService().increaseResource(Df.FUR,this.data.fur,"Sea hunting",!0)),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([])}isEventBasedMission(){return!0}}class ww extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.TREASURE,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){if(!this.getDestinationTargetSeaEvent())return!0;const e=10*this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount);return this.getDestinationTargetSeaEvent().amount-=t,this.data=t,!0}finish(e){this.data&&this.data>0&&this.servicesService.getResourcesService().increaseResource(Df.COINS,this.data,"Treasure",!0),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([])}isEventBasedMission(){return!0}}class Pw extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.EXPEDITION,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){void 0!==this.data&&(am.chance(this.data/100)||this.logService.warning("Our expedition didn't find any new land, perhaps we need to go farther"));let e=0,t=0,i=0,s=0;return this.army.getLandUnits(!1).units.forEach(e=>{s+=e.getTroopStrength()*e.size,s+=e.getTroopDefense()*e.size}),am.chance(.5)?(e+=Math.ceil(.6*s),s-=e,t+=Math.ceil(.6*s),s-=t,i=s):am.chance(.7)?(t+=Math.ceil(.6*s),s-=t,e+=Math.ceil(.6*s),s-=e,i=s):(i+=Math.ceil(.6*s),s-=i,e+=Math.ceil(.6*s),s-=e,t=s),this.data={land:e,forest:t,mountains:i},!0}finish(e){const t=this.servicesService.getLandService();this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([]),this.data&&(this.data.land&&(t.increaseLand(this.data.land,!0),this.worldService.increaseDiscoveredLand(this.data.land)),this.data.forest&&(t.increaseForest(this.data.forest,!1),this.worldService.increaseDiscoveredForest(this.data.forest)),this.data.mountains&&(t.increaseMountains(this.data.mountains),this.worldService.increaseDiscoveredMountains(this.data.mountains)),this.logService.success("We found a new land:<br> Land:"+this.data.land+"<br> Forest:"+this.data.forest+"<br> Mountains:"+this.data.mountains+"<br>"))}}class Mw extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.CARTOGRAPHY,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){if(!this.getDestinationTargetSeaEvent())return!0;const e=this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount);return this.getDestinationTargetSeaEvent().amount-=t,this.data=t,!0}finish(e){this.data&&this.data>0&&this.servicesService.getNavyService().increaseCartographyData(this.data),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([])}isEventBasedMission(){return!0}}class Lw extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.SEA_BATTLE,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){if(!this.getDestinationTargetSeaEvent())return!0;const e=this.army.getNavy(!0),t=this.getDestinationTargetSeaEvent().type===jf.PIRATES?0:3,i=this.armyService.calculateAttack(e,this.getDestinationTargetSeaEvent().data,t,!0,!1);if(i.attacker=this.ownerCountry.id,i.defender=zf.PIRATES,i.result){this.getDestinationTargetSeaEvent().type===jf.PIRATES?(i.message="Pirates defeated",this.servicesService.getHappinessService().addHappinessEffect(0,$f.PIRATES_DEFEATED,1,180)):(i.message="Pirates base destroyed",this.servicesService.getHappinessService().addHappinessEffect(0,$f.PIRATES_DEFEATED,3,360)),this.army.addArmy(e);const t=this.army.getLandUnits(!0);for(;t.getArmySize()>0&&this.getTroopsSize(t)>this.getNavyCapacity(e);)t.units[am.randomBetween(0,t.units.length-1)].size-=1,t.removeEmptyUnits();return this.army.addArmy(t),this.data=Math.min(10*this.army.getArmyCargo(),this.getDestinationTargetSeaEvent().amount),this.getDestinationTargetSeaEvent().amount-=this.data,this.getDestinationTargetSeaEvent().amount>=50?this.getDestinationTargetSeaEvent().type=jf.TREASURE:(this.getDestinationTargetSeaEvent().amount=0,this.getDestinationTargetSeaEvent().time=-1),this.logService.fightReport(i),!0}return i.message="Pirates won against our navy",this.army.clearArmy(),this.status="finished",this.logService.fightReport(i),!1}finish(e){this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([])}getTroopsSize(e){let t=0;return e.units.forEach(e=>{e.troop!==Wf.ALL&&e.troop!==Wf.BOAT&&e.troop!==Wf.BRIGANTINE&&e.troop!==Wf.GALLEON&&e.size>0&&(t+=e.getTroopSize())}),t}getNavyCapacity(e){let t=0;return e.units.forEach(e=>{(e.troop===Wf.BOAT||e.troop===Wf.BRIGANTINE||e.troop===Wf.GALLEON)&&e.size>0&&(t+=e.getTroopCargo())}),t}isEventBasedMission(){return!0}}class Dw extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.SEA_CONQUER,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){const e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){const i=this.army.getLandUnits(!0),s=this.armyService.calculateAttack(i,e.army,e.defense,!0,!1);return s.attacker=this.ownerCountry.id,s.defender=t.id,s.result?(s.message="Region conquered",this.armyService.loot(50*e.wealth+200*e.economy),t.diplomacy<25?t.decreaseDiplomacy(30):t.diplomacy=-50,t.capital===e.id&&(t.diplomacy=-100),this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.getDestinationTargetRegion().army.addArmy(i),this.logService.fightReport(s),!0):(s.message="Our army has been defeated",t.diplomacy<25?t.decreaseDiplomacy(15):t.diplomacy=30,this.logService.fightReport(s),!0)}return!0}finish(e){return this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([]),!1}}class xw extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.SEA_PLUNDER,o,r,n,a,i,s,c)}isInstant(){return!1}calculateMission(){const e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){const i=this.army.getLandUnits(!0),s=this.armyService.calculateAttack(i,e.army,e.defense,!0,!1);return s.attacker=this.ownerCountry.id,s.defender=t.id,s.result?(t.decreaseDiplomacy(t.diplomacy<25?10:30),this.data=e.wealth,e.wealth=0,s.message="Region plundered",e.target=gw.DEFENSE_ARCHER,this.army.addArmy(i),this.logService.fightReport(s),!0):(s.message="Our army has been defeated",t.decreaseDiplomacy(t.diplomacy<25?5:15),e.target=gw.DEFENSE_ARCHER,this.logService.fightReport(s),!0)}}finish(e){return this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([]),!1}}class kw extends Aw{constructor(e,t,i,s,r,n=0,o=1,a="traveling",c=null){super(e,t,Uf.SEA_MOVE,o,r,n,a,i,s,c)}isInstant(){return!0}calculateMission(){const e=this.getDestinationTargetRegion(),t=this.worldService.getCountryByRegionId(e.id);return t.id!==zf.PLAYER&&t.id!==zf.NEUTRAL||(e.army.addArmy(this.army.getLandUnits(!0)),!e.harbour)||(e.navy.addArmy(this.army.getNavy(!0)),!1)}finish(e){return this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new Cy([]),!1}}let Fw=(()=>{class e{constructor(e){this.servicesService=e,e.addService(Zf.MISSION_FACTORY,this)}loadMission(e){const t=this.servicesService.getWorldService(),i=new Cy([]);if(e.army.forEach(e=>{i.addTroop(e.troop,e.size)}),e.type!==Uf.BUILD&&0===i.units.length)return null;const s=new Sw(e.route);switch(e.type){case Uf.COLONIZE:return new vw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.CONQUER:return new Rw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.MOVE:return new Cw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.PLUNDER:return new Ow(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.SPY:return new yw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.BUILD:return new Tw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.FISHING:return new Nw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.HUNTING:return new _w(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.TREASURE:return new ww(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.EXPEDITION:return new Pw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.CARTOGRAPHY:return new Mw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.SEA_BATTLE:return new Lw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.SEA_MOVE:return new kw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.SEA_PLUNDER:return new xw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data);case Uf.SEA_CONQUER:return new Dw(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,s,e.progress,e.targetIndex,e.status,e.data)}}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Uw=(()=>{class e{constructor(e,t,i,s,r,n,o,a,c,l,u,h){this.servicesService=e,this.idService=t,this.armyService=i,this.navyService=s,this.logService=r,this.calendarService=n,this.modalService=o,this.missionFactoryService=a,this.optionsService=c,this.soundService=l,this.landService=u,this.kongregateService=h,this.countries=[],this.regionsNeighbours=[],this.missions=[],this.regions=[],this.seaAreas=[],this.protection=0,this.defaultOrigin=0,this.discoveredLand=0,this.discoveredForest=0,this.discoveredMountains=0,this.x=150,this.y=-220,this.zoom=1.4,this.mapDisplayOption=0,this.showHarbours=!0,this.activeCountriesList=[],this.pathCacheSubject=new b,this.servicesService.addService(Zf.WORLD,this),this.init(),this.selectedCountry=this.countries[0],this.selectedRegion=this.selectedCountry.regions[0],this.calendarService.registerForDayChange().subscribe(()=>{this.countries.filter(e=>e.id!==zf.PLAYER&&e.id!==zf.NEUTRAL).forEach(e=>{e.regions.forEach(t=>{am.chance((t.economy+5)*this.AI_getDifficultyMultiplier()/100)&&(t.wealth+=1),this.AI_dailyRegionAction(e,t)})}),this.seaAreas.filter(e=>e.events.length>0).map(e=>e.events[0]).forEach(e=>e.tick(this.servicesService,this,this.idService,this.logService)),this.seaAreas.forEach(e=>{e.events.length>0&&(e.events[0].time<0||e.events[0].amount<=0)&&(e.events[0]===this.selectedSeaEvent&&(this.selectedSeaEvent=null),e.events.shift())}),this.spawnSeaEvents(),this.protection>0&&(this.protection-=1),this.protection<0&&(this.protection=0)})}init(e=!0){gS.REGIONS.forEach(e=>{const t=[];e.TROOPS.forEach(e=>t.push(new by(e.troop,e.size))),this.regions.push(new fw(e.ID,e.PATH,e.CENTER,e.NEIGHBOURS,e.LAND,e.FOREST,e.MOUNTAINS,e.WEALTH,0,0,e.HARBOUR,!1,!1,!1,null,0,new Cy(t)))}),this.regions[0].army=this.armyService.getArmy(),this.regions[0].navy=this.navyService.getNavy(),Object.values(gS.COUNTRIES).forEach(t=>{const i=[];t.REGIONS.forEach(s=>{const r=this.regions[s];t.CAPITAL===s&&(r.capital=t.COUNTRY),i.push(r),e&&t.COUNTRY!==zf.PLAYER&&t.COUNTRY!==zf.NEUTRAL&&this.regions[s].army.addTroop(Wf.ARCHER,Math.ceil(2*this.AI_getDifficultyMultiplier()))}),this.countries.push(new pw(t.COUNTRY,t.NAME,t.DIPLOMACY,t.COLOUR,t.FOCUS,i,{},t.CAPITAL))}),this.regionsNeighbours=[],Object.values(gS.REGIONS).forEach(e=>{this.regionsNeighbours.push(new mw(e.ID,e.NEIGHBOURS))}),this.calendarService.registerForYearChange().subscribe(e=>{this.countries.filter(e=>e.id!==zf.PLAYER&&e.id!==zf.NEUTRAL).forEach(e=>{e.regions.length>0&&am.chance(gS.KING_DEATH_CHANCE)&&(e.focus=am.randomElement([{item:Vf.OFFENSE,chance:25},{item:Vf.DEFENSE,chance:25},{item:Vf.PEACE,chance:25},{item:Vf.ECONOMY,chance:25}]),this.logService.warning(e.name+" king died. New king is known to focus on "+Qf.prepareFocusName(e.focus)))})}),this.initSeaAreas(),this.selectedRegion=this.regions[0],this.selectedCountry=this.getPlayerCountry(),this.initPlayerKingdomName()}initSeaAreas(){gS.SEA_AREAS.forEach(e=>{this.seaAreas.push(new Iw(e.ID,{x:e.CENTER.x,y:e.CENTER.y},e.R,[],e.NEIGHBOURS))});let e=this.seaAreas.filter(e=>-1!==e.id);Object.keys(jf).slice(Object.keys(jf).length/2).map(e=>jf[e]).forEach(t=>{const i=gS.getSeaEvent(t);for(let s=0;s<i.NUMBER_INIT;s++)if(e.length>0){const s=e.filter(e=>e.r>i.FOR_RADIUS),r=s[am.randomBetween(0,s.length-1)];0===r.events.length&&r.events.push(new bw(r.id,this.idService.getNextId(),t,this.getRandomPointInCircle(r.center,r.r),am.randomBetween(i.POWER_MIN,i.POWER_MAX),am.randomBetween(i.TIME_MIN,i.TIME_MAX),null)),e=e.filter(e=>0===e.events.length)}})}AI_dailyRegionAction(e,t){if(null===t.target?this.AI_chooseTarget(t,e):this.AI_executeTarget(t,e),t.spy>0&&am.chance(t.army.getArmySize()/2e4)){t.spy-=1;const i=new Vy;i.attacker=e.id,i.defender=zf.PLAYER,i.attackerArmy=Cy.clone(t.army),i.defenderArmy=new Cy([new by(Wf.SPY,1)]),i.skirmish.push(new zy(i.attackerArmy.getRandomUnit().troop,i.defenderArmy.getRandomUnit().troop,1,0,!0)),i.result=!0,i.armyAfterFight=i.attackerArmy,i.message="Our "+e.name+" spy has been discovered and killed!",this.logService.fightReport(i),e.decreaseDiplomacy(e.diplomacy<25?5:15)}}AI_chooseTarget(e,t){let i=10;t.regions.find(e=>e.id===t.capital)||(i=75);const s=[{item:Vf.OFFENSE,chance:i},{item:Vf.DEFENSE,chance:10},{item:Vf.PEACE,chance:10},{item:Vf.ECONOMY,chance:10}],r=s.find(e=>e.item===t.focus);r&&(r.chance=70);const n=am.randomElement(s);let o=gw.NONE;switch(n){case Vf.ECONOMY:const i=[];let s=70-8*e.economy;s<5&&(s=5),this.getNeutralRegionsNumber()>0&&i.push({item:gw.ECONOMY_COLONIZE,chance:10}),i.push({item:gw.ECONOMY_BUILD,chance:s}),o=am.randomElement(i);break;case Vf.DEFENSE:const r=[];e.army.getArmySize()<5*e.wealth&&r.push({item:gw.DEFENSE_ARCHER,chance:50});let n=30-4*e.defense;n<5&&(n=5),r.push({item:gw.DEFENSE_WALL,chance:n}),o=am.randomElement(r);break;case Vf.PEACE:e.target=gw.PEACE;break;case Vf.OFFENSE:const a=[{item:gw.OFFENSE_PLUNDER,chance:5},{item:gw.OFFENSE_CONQUER,chance:2}];if(e.army.getArmySize()<5*e.wealth&&a.push({item:gw.OFFENSE_SPEARMAN,chance:30},{item:gw.OFFENSE_SWORDSMAN,chance:25},{item:gw.OFFENSE_LIGHT_CAVALRY,chance:10}),this.getNeutralRegionsNumber()>0&&a.push({item:gw.OFFENSE_COLONIZE,chance:10}),!t.regions.find(e=>e.id===t.capital)&&e.army.getArmyPower(!0)>5){const i=this.findPath(e.id,t.capital,t.id,!0),s=this.missions.find(e=>e.ownerCountry===t&&e.getTargetRegionId()===t.capital);i&&!s&&a.push({item:gw.OFFENSE_RECLAIM_CAPITAL,chance:50})}o=am.randomElement(a)}e.target=o||gw.NONE}AI_executeTarget(e,t){switch(e.target){case gw.NONE:e.target=null;break;case gw.PEACE:am.chance(.1)&&(e.target=null);break;case gw.SAVE_WEALTH:e.wealth>=5*(e.economy+1)&&(e.target=null);break;case gw.ECONOMY_BUILD:e.wealth>=10*(e.economy+1)&&(e.wealth-=10*(e.economy+1),e.economy+=1,e.target=null);break;case gw.ECONOMY_COLONIZE:if(e.economy>=2){const i=this.findNeighbouringColonizableRegions(e,t);i.length?e.wealth>=40&&(this.missions.push(new vw(this.servicesService,this.idService.getNextId(),t,new Cy([new by(Wf.COLONIST,15)]),this.findPath(e.id,i[0],t.id))),e.wealth-=40,e.target=null):e.target=null}else e.target=null;break;case gw.DEFENSE_WALL:if(e.economy<=e.defense||e.defense>=7){e.target=null;break}e.wealth>=20*(e.defense+1)&&(e.wealth-=20*(e.defense+1),e.defense+=1,e.target=null);break;case gw.DEFENSE_ARCHER:this.AI_hireTroop(e,Wf.ARCHER);break;case gw.DEFENSE_GUARD_TOWER:e.target=null;break;case gw.OFFENSE_SPEARMAN:this.AI_hireTroop(e,Wf.SPEARMAN);break;case gw.OFFENSE_SWORDSMAN:this.AI_hireTroop(e,Wf.SWORDSMAN);break;case gw.OFFENSE_LIGHT_CAVALRY:this.AI_hireTroop(e,Wf.LIGHT_CAVALRY);break;case gw.OFFENSE_COLONIZE:if(e.army.getArmyPower(!0)>=20){const i=this.findNeighbouringColonizableRegions(e,t);i.length?e.wealth>=20&&(this.missions.push(new vw(this.servicesService,this.idService.getNextId(),t,new Cy([new by(Wf.COLONIST,15)]),this.findPath(e.id,i[0],t.id))),e.wealth-=20,e.target=null):e.target=null}else e.target=null;break;case gw.OFFENSE_PLUNDER:if(e.army.getArmyPower(!0)>20){const i=this.findNeighbouringAttackableRegions(e,t,!0);i.length>0?(this.missions.push(new Ow(this.servicesService,this.idService.getNextId(),t,this.AI_prepareArmy(e.army),this.findPath(e.id,i[0],t.id))),this.getRegion(i[0]).lastAttack=this.calendarService.getAbsoluteDay(),this.getCountryByRegionId(i[0]).id===zf.PLAYER&&(this.logService.warning("Incoming invasion!"),this.soundService.playBattle())):e.target=null}else e.target=null;break;case gw.OFFENSE_CONQUER:if(e.army.getArmyPower(!0)>20){const i=this.findNeighbouringAttackableRegions(e,t,!1).filter(e=>0!==e).filter(t=>this.getRegion(t).army.getArmyPower(!1)<1.5*e.army.getArmyPower(!0));i.length>0?(this.missions.push(new Rw(this.servicesService,this.idService.getNextId(),t,this.AI_prepareArmy(e.army),this.findPath(e.id,i[0],t.id))),this.getRegion(i[0]).lastAttack=this.calendarService.getAbsoluteDay(),this.getCountryByRegionId(i[0]).id===zf.PLAYER&&(this.logService.warning("Incoming invasion!"),this.soundService.playBattle())):e.target=null}else e.target=null;e.target=null;break;case gw.OFFENSE_RECLAIM_CAPITAL:if(t.regions.find(i=>i.id===t.capital&&e.army.getArmyPower(!0)>5))e.target=null;else{const i=this.findPath(e.id,t.capital,t.id,!1),s=this.missions.find(e=>e.ownerCountry===t&&e.getTargetRegionId()===t.capital);i&&!s?this.missions.push(new Rw(this.servicesService,this.idService.getNextId(),t,this.AI_prepareArmy(e.army),i)):e.target=null}e.target=null}}AI_hireTroop(e,t){const i=aS.getTroop(t).AI_COST;e.wealth>=i&&(e.wealth-=i,e.army.addTroop(t,1),e.target=null)}AI_getDifficultyMultiplier(){let e=1;switch(this.optionsService.getOption(Xf.AI_DIFFICULTY)){case dm.EASY:e=.5;break;case dm.MEDIUM:e=1;break;case dm.HARD:e=2}return e}getName(){return"WorldService"}load(e){e.regions||e.countries?(e.regions.forEach(e=>{const t=this.regions[e.id];t.wealth=e.wealth,t.economy=e.economy,t.defense=e.defense,t.defense=null!==e.defense&&e.defense,t.target=e.target,t.land=e.land,t.forest=e.forest,t.mountains=e.mountains,t.spy=e.spy,t.harbour=void 0!==e.harbour?e.harbour:void 0!==gS.REGIONS.find(e=>e.ID===t.id)&&gS.REGIONS.find(e=>e.ID===t.id).HARBOUR,t.roads=void 0!==e.roads&&e.roads,t.watchtower=void 0!==e.watchtower&&e.watchtower,t.watched=void 0!==e.watched&&e.watched,t.capital=e.capital,t.lastAttack=void 0!==e.lastAttack?e.lastAttack:0,t.army=new Cy([]),t.navy=new Cy([]),e.army.forEach(e=>{t.army.addTroop(e.troop,e.size)}),e.navy&&e.navy.forEach(e=>{t.navy.addTroop(e.troop,e.size)})}),this.seaAreas.forEach(e=>{e.events=[]}),void 0!==e.seaEvents&&e.seaEvents.forEach(e=>{const t=this.seaAreas.find(t=>t.id===e.parentId);t&&(t.events=[],t.events.push(new bw(t.id,e.id,e.type,e.center,e.amount,e.time,e.data)))}),this.selectedCountry=null===this.selectedCountry?null:this.getCountry(this.selectedCountry.id),e.countries.forEach(e=>{const t=this.getCountry(e.id);t.diplomacy=e.diplomacy,t.focus=e.country,t.capital=void 0!==e.capital?e.capital:gS.COUNTRIES.find(e=>e.COUNTRY===t.id).CAPITAL,t.regions=[],e.regions.forEach(e=>{t.regions.push(this.regions[e])}),t.data=e.data}),this.missions=[],e.missions.forEach(e=>{const t=this.missionFactoryService.loadMission(JSON.parse(e));null!==t&&this.missions.push(t)}),this.missions.forEach(e=>{e.army=new Cy(e.army.units.filter(e=>e.troop!==Wf.GUARD_TOWER))}),this.defaultOrigin=e.defaultOrigin,this.discoveredLand=void 0!==e.discoveredLand?e.discoveredLand:0,this.discoveredForest=void 0!==e.discoveredForest?e.discoveredForest:0,this.discoveredMountains=void 0!==e.discoveredMountains?e.discoveredMountains:0,this.getPlayerCountry().name=e.playerNationName,this.x=e.x,this.y=e.y,this.zoom=e.zoom,this.mapDisplayOption=void 0!==e.mapDisplayOption?e.mapDisplayOption:0,this.regions[0].army=this.armyService.getArmy(),this.regions[0].navy=this.navyService.getNavy(),this.protection=void 0!==e.protection?e.protection:0):this.reset(!1,!1)}reset(e,t){const i=this.getPlayerCountry().name,s=[],r=this.seaAreas;(e||t)&&(this.discoveredLand=0,this.discoveredForest=0,this.discoveredMountains=0),!e&&!t&&this.countries.forEach(e=>{s.push([e.id,e.regions.map(e=>e.id)])}),this.countries=[],this.regionsNeighbours=[],this.missions=[],this.regions=[],this.seaAreas=[],this.defaultOrigin=0,this.selectedRegion=null,this.selectedCountry=null,this.selectedMission=null,this.selectedSeaEvent=null,this.x=150,this.y=-220,this.zoom=1.4,this.mapDisplayOption=0,this.protection=0,this.init(!1),!e&&!t&&this.seaAreas.forEach(e=>{const t=r.find(t=>t.id===e.id);t&&(e.events=t.events)}),this.regions[0].army=this.armyService.getArmy(),this.regions[0].navy=this.navyService.getNavy(),e?this.initPlayerKingdomName():this.getPlayerCountry().name=i,this.countries.forEach(e=>{const t=s.find(t=>t[0]===e.id);t&&(e.regions=[],t[1].forEach(t=>{const i=this.getRegion(t);e.regions.push(i),e.id===zf.PLAYER&&0!==i.id&&(this.landService.increaseLand(i.land,!0),this.landService.increaseForest(i.forest,!1),this.landService.increaseMountains(i.mountains)),e.id!==zf.PLAYER&&e.id!==zf.NEUTRAL&&this.regions[t].army.addTroop(Wf.ARCHER,Math.ceil(2*this.AI_getDifficultyMultiplier()))}))})}save(){const e=[];this.countries.forEach(t=>{const i=[];t.regions.forEach(e=>{i.push(e.id)}),e.push({id:t.id,diplomacy:t.diplomacy,focus:t.focus,regions:i,data:t.data,capital:t.capital})});const t=[];this.regions.forEach(e=>{const i=[],s=[];0!==e.id&&e.army.units.forEach(e=>{i.push({troop:e.troop,size:e.size})}),0!==e.id&&e.navy.units.forEach(e=>{s.push({troop:e.troop,size:e.size})}),t.push({id:e.id,wealth:e.wealth,economy:e.economy,defense:e.defense,harbour:e.harbour,target:e.target,land:e.land,forest:e.forest,mountains:e.mountains,spy:e.spy,capital:e.capital,army:i,navy:s,roads:e.roads,watchtower:e.watchtower,watched:e.watched,lastAttack:e.lastAttack})});const i=[];this.missions.forEach(e=>{i.push(JSON.stringify(e))});const s=[];return this.seaAreas.forEach(e=>{e.events.length>0&&s.push(e.events[0])}),{countries:e,regions:t,seaEvents:s,missions:i,defaultOrigin:this.defaultOrigin,discoveredLand:this.discoveredLand,discoveredForest:this.discoveredForest,discoveredMountains:this.discoveredMountains,playerNationName:this.getPlayerCountry().name,protection:this.protection,x:this.x,y:this.y,zoom:this.zoom,mapDisplayOption:this.mapDisplayOption}}getCountries(){return this.countries}getMissions(){return this.missions}getPlayerLandMissions(){return this.missions.filter(e=>e.getMissionType()===uw.LAND&&e.ownerCountry.id===zf.PLAYER)}getPlayerSeaMissions(){return this.missions.filter(e=>e.getMissionType()===uw.SEA&&e.ownerCountry.id===zf.PLAYER)}setSelectedCountry(e){this.selectedCountry=e,this.selectedMission=null,this.selectedSeaEvent=null}getSelectedCountry(){return this.selectedCountry}setSelectedRegion(e){this.selectedRegion=e,this.selectedMission=null,this.selectedSeaEvent=null}getSelectedRegion(){return this.selectedRegion}setSelectedMission(e){this.selectedCountry=null,this.selectedRegion=null,this.selectedSeaEvent=null,this.selectedMission=e}getSelectedMission(){return this.selectedMission}registerForCacheInvalidation(){return this.pathCacheSubject.asObservable()}tick(e){this.missions.forEach(e=>{e.tick()}),this.missions=this.missions.filter(e=>!e.isFinished()),this.missions.includes(this.getSelectedMission())||(this.selectedMission=null)}getRegionNeighbours(e,t){const i=this.regionsNeighbours.find(t=>t.id===e),s=[];return i&&i.neighbours.forEach(t?e=>{s.push(e)}:t=>{e>=0&&t>=0&&s.push(t)}),s}findPath(e,t,i,s=!1){let r=!0;if(e===t)return new Sw([e]);let n=Number.MAX_SAFE_INTEGER;const o=new Array(this.regions.length).fill(Number.MAX_SAFE_INTEGER);let a=[],c=[];const l=[];for(a.push(new Sw([e]));a.length>0||c.length>0;){for(const e of a){const a=this.getCountryByRegionId(e.path[e.path.length-1]);if(i===zf.SPECIAL||a.id===i||a.id===zf.NEUTRAL||r){const i=this.getRegionNeighbours(e.path[e.path.length-1],!1).filter(t=>!e.path.includes(t));for(const r of i){const i=new Sw(e.path.slice().concat([r]));if(i.calculatePathDistance(this)<=o[r]&&(o[r]=i.calculatePathDistance(this),o[r]<=n))if(r===t){if(s)return i;o[r]<n&&(n=o[r]),l.push(i)}else c.push(i)}}}r=!1,a=c,c=[]}return 0===l.length?null:l.sort((e,t)=>e.distance-t.distance)[0]}addMission(e){this.missions.push(e)}getCountry(e){return this.countries.find(t=>t.id===e)}getCountryByRegionId(e){let t=null;return this.countries.forEach(i=>{i.regions.find(t=>t.id===e)&&(t=i)}),t}getRegion(e){return this.regions[e]}ownRegion(e,t){const i=this.getCountryByRegionId(e);if(i.id!==t.id){const s=i.regions.findIndex(t=>t.id===e);if(void 0!==s){const e=i.regions.splice(s,1)[0];t.regions.push(e),this.selectedRegion&&this.selectedRegion.id===e.id&&(this.selectedCountry=this.getCountryByRegionId(this.selectedRegion.id)),t.id===zf.PLAYER?(this.landService.increaseLand(e.land,!0),this.landService.increaseForest(e.forest,!1),this.landService.increaseMountains(e.mountains),e.spy=0):e.id===this.defaultOrigin&&(this.defaultOrigin=0),this.activeCountriesList=[],this.pathCacheSubject.next()}}this.regions.forEach(e=>{e.watched=!1}),this.regions.filter(e=>""!==e.path).forEach(e=>{this.getCountryByRegionId(e.id).id===zf.PLAYER&&e.watchtower&&e.neighbours.forEach(e=>{e>=0&&(this.getRegion(e).watched=!0)})})}findSeaPath(e,t,i=!1){let s=!0;if(e===t)return new Sw([e]);if(void 0===this.getSeaArea(e)||void 0===t)return null;let r=Number.MAX_SAFE_INTEGER;const n=[];this.seaAreas.forEach(e=>n.push({id:e.id,cost:Number.MAX_SAFE_INTEGER}));let o=[],a=[];const c=[];for(o.push(new Sw([e]));o.length>0||a.length>0;){for(const e of o){const s=this.getSeaArea(e.path[e.path.length-1]);if(0===s.events.length||s.events[0].type!==jf.PIRATES&&s.events[0].type!==jf.PIRATES_BASE&&s.events[0].type!==jf.WHIRLPOOL){const s=this.getSeaArea(e.path[e.path.length-1]).neighbours.filter(t=>!e.path.includes(t));for(const o of s){const s=new Sw(e.path.slice().concat([o]));if(s.calculateSeaPathDistance(this)<=n.find(e=>e.id===o).cost&&(n.find(e=>e.id===o).cost=s.calculateSeaPathDistance(this),n.find(e=>e.id===o).cost<=r))if(o===t){if(i)return s;n.find(e=>e.id===o).cost<r&&(r=n.find(e=>e.id===o).cost),c.push(s)}else a.push(s)}}}s=!1,o=a,a=[]}return 0===c.length?null:c.sort((e,t)=>e.distance-t.distance)[0]}clearMission(){this.selectedMission=null}canColonize(e){return!this.missions.find(t=>t.getMissionType()===uw.LAND&&t.getDestinationTargetRegion().id===e&&t.mission===Uf.COLONIZE)}getPlayerCountry(){return this.countries[0]}getDefaultOriginRegion(){return this.getRegion(this.getDefaultOrigin())}getDefaultOriginRegionCountry(){return this.getCountryByRegionId(this.getDefaultOrigin())}getDefaultOrigin(){return this.defaultOrigin}setDefaultOrigin(e){this.defaultOrigin=e}getStationedArmies(){const e=[];return this.countries[0].regions.filter(e=>0!==e.id&&e.army.getArmySize()>0).forEach(t=>e.push(t.army)),this.countries[1].regions.filter(e=>e.army.getArmySize()>0).forEach(t=>e.push(t.army)),e}getStationedNavy(){const e=[];return this.countries[0].regions.filter(e=>0!==e.id&&e.navy.getArmySize()>0).forEach(t=>e.push(t.navy)),this.countries[1].regions.filter(e=>e.navy.getArmySize()>0).forEach(t=>e.push(t.navy)),e}getDisplayX(){return this.x}getDisplayY(){return this.y}getDisplayZoom(){return this.zoom}setDisplayX(e){this.x=e}setDisplayY(e){this.y=e}setDisplayZoom(e){this.zoom=e}getCountriesList(){return 0===this.activeCountriesList.length&&(this.activeCountriesList.push(zf[zf.NONE]),this.countries.filter(e=>e.id!==zf.PLAYER&&e.id!==zf.NEUTRAL&&e.regions.length>0).forEach(e=>this.activeCountriesList.push(zf[e.id]))),this.activeCountriesList}getNeutralRegionsNumber(){return this.getCountry(zf.NEUTRAL).regions.length}buildRegionBuilding(e){this.missions.push(new Tw(this.servicesService,this.idService.getNextId(),this.getPlayerCountry(),new Cy([]),new Sw([this.getSelectedRegion().id,this.getSelectedRegion().id]),0,1,"{mission}",e))}changeName(){this.modalService.open(Pf.INPUT),this.modalService.setModalText("Specify your nation name"),this.modalService.setModalValue(this.getPlayerCountry().name);const e=this.modalService.registerForValueResponse().subscribe(t=>{e.unsubscribe(),null!==t&&(this.getPlayerCountry().name=t)})}findNeighbouringAttackableRegions(e,t,i){const s=[],r=[];return t.regions.forEach(n=>{n.neighbours.filter(e=>e>=0).forEach(n=>{const o=this.getCountryByRegionId(n);if(t.id!==o.id&&o.id!==zf.NEUTRAL){if((o.id===zf.PLAYER&&t.diplomacy<25||o.id!==zf.PLAYER)&&this.findPath(e.id,n,t.id,!0)){let e=30;o.id===zf.PLAYER&&(e=90/this.AI_getDifficultyMultiplier()),this.calendarService.getAbsoluteDay()-this.getRegion(n).lastAttack>=e&&(o.id===zf.PLAYER&&t.diplomacy<-25&&this.protection<=0?s.includes(n)||s.push(n):r.includes(n)||r.push(n))}}else if(i&&o.id===zf.NEUTRAL&&this.getRegion(n).army.hasAny()&&t.diplomacy<25&&this.findPath(e.id,n,t.id,!0)){const e=30;this.calendarService.getAbsoluteDay()-this.getRegion(n).lastAttack>=e&&(s.includes(n)||s.push(n))}})}),this.shuffleArray(s.length>0?s:r)}findNeighbouringColonizableRegions(e,t){const i=[];return t.regions.forEach(s=>{s.neighbours.filter(e=>e>=0).forEach(s=>{this.getCountryByRegionId(s).id===zf.NEUTRAL&&!this.getRegion(s).army.hasAny()&&this.canColonize(s)&&this.findPath(e.id,s,t.id,!0)&&(i.includes(s)||i.push(s))})}),this.shuffleArray(i)}shuffleArray(e){let t,i,s;for(s=e.length-1;s>0;s--)t=Math.floor(Math.random()*(s+1)),i=e[s],e[s]=e[t],e[t]=i;return e}getMapDisplayOption(){return this.mapDisplayOption}setMapDisplayOption(e){this.mapDisplayOption=e}DEV_calculateTotalLand(){let e=0,t=0,i=0;this.regions.forEach(s=>{8!==s.id&&9!==s.id&&10!==s.id&&11!==s.id&&12!==s.id&&(e+=s.land,t+=s.forest,i+=s.mountains)}),this.logService.success("Land report<br>Land: "+e+"<br>Forest: "+t+"<br>Mountains: "+i+"<br><br>Total: "+(e+t+i))}AI_prepareArmy(e){const t=new Cy([]);return e.units.forEach(i=>{i.troop!==Wf.MILITIA&&i.troop!==Wf.GUARD_TOWER&&(t.addTroop(i.troop,i.size),e.removeTroop(i.troop,i.size))}),e.removeEmptyUnits(),t}initPlayerKingdomName(){this.kongregateService.isAvailable()&&!this.kongregateService.isGuest()&&(this.getPlayerCountry().name=this.kongregateService.getUsername()+"'s nation")}setSelectedSeaEvent(e){this.selectedSeaEvent=e,this.selectedRegion=null,this.selectedCountry=null,this.selectedMission=null}getSelectedSeaEvent(){return this.selectedSeaEvent}getRandomPointInCircle(e,t){if(t<10)return e;{const i=(t-10)*Math.sqrt(Math.random()),s=Math.random()*Math.PI*2;return{x:i*Math.cos(s)+e.x,y:i*Math.sin(s)+e.y}}}getShowHarbours(){return this.showHarbours}setShowHarbours(e){this.showHarbours=e}calculatePointsDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}getSeaAreas(){return this.seaAreas}getSeaArea(e){return this.seaAreas.find(t=>t.id===e)}spawnSeaEvents(){const e=this.seaAreas.filter(e=>-1!==e.id);Object.keys(jf).slice(Object.keys(jf).length/2).map(e=>jf[e]).forEach(t=>{const i=gS.getSeaEvent(t);let s=0;this.getSeaAreas().forEach(e=>{e.events.length>0&&e.events[0].type===t&&(s+=1)});const r=e.filter(e=>e.r>i.FOR_RADIUS&&0===e.events.length);if(r.length>0){let e=!1;if((s<i.NUMBER_MIN||s<i.NUMBER_MAX&&am.chance(i.SPAWN_CHANCE-s*i.SPAWN_DECREASE))&&(e=!0),e){const e=r[am.randomBetween(0,r.length-1)];0===e.events.length&&e.events.push(new bw(e.id,this.idService.getNextId(),t,this.getRandomPointInCircle(e.center,e.r),am.randomBetween(i.POWER_MIN,i.POWER_MAX),am.randomBetween(i.TIME_MIN,i.TIME_MAX),null))}}})}ROYAL_spawnPositiveSeaEvents(){const e=this.seaAreas.filter(e=>-1!==e.id&&0===e.events.length),t=[];for(let i=0;i<4;i++)t.push(am.randomArrayElement([jf.TREASURE,jf.FISH,jf.SHARK,jf.CARTOGRAPHY]));t.forEach(t=>{const i=gS.getSeaEvent(t);let s=0;this.getSeaAreas().forEach(e=>{e.events.length>0&&e.events[0].type===t&&(s+=1)});const r=e.filter(e=>e.r>i.FOR_RADIUS&&0===e.events.length);if(r.length>0){const e=r[am.randomBetween(0,r.length-1)];0===e.events.length&&e.events.push(new bw(e.id,this.idService.getNextId(),t,this.getRandomPointInCircle(e.center,e.r),am.randomBetween(i.POWER_MIN,i.POWER_MAX),am.randomBetween(i.TIME_MIN,i.TIME_MAX),null)),this.logService.success("New sea event: "+Qf.prepareSeaEventName(t))}})}getDiscoveredLand(){return this.discoveredLand}increaseDiscoveredLand(e){this.discoveredLand+=e}getDiscoveredForest(){return this.discoveredForest}increaseDiscoveredForest(e){this.discoveredForest+=e}getDiscoveredMountains(){return this.discoveredMountains}increaseDiscoveredMountains(e){this.discoveredMountains+=e}getTotalDiscovered(){return this.discoveredLand+this.discoveredForest+this.discoveredMountains}setPlayerColour(e){this.getPlayerCountry().colour=e}isProtected(){return this.protection>0}addProtection(e){this.protection+=e}getProtection(){return this.protection}hasPiratesBase(){return this.getSeaAreas().find(e=>e.events.length>0&&e.events[0].type===jf.PIRATES_BASE)}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(NO),gs(Yy),gs(yy),gs(IS),gs(OS),gs(em),gs(Fw),gs(vS),gs(RS),gs(NS),gs(wv))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Hw=["svg"];function Gw(e,t){if(1&e){const e=Go();xo(0,"img",41),Vo("click",function(){return Dt(e),Ko(2).changeName()}),ko()}}function Bw(e,t){1&e&&Fo(0,"span")}function Ww(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),oa(" standing: ",e.getSelectedCountry().getDiplomacy()," (",e.getSelectedCountry().diplomacy,")\n")}}function Vw(e,t){if(1&e){const e=Go();xo(0,"span"),xo(1,"input",42),Vo("change",function(){Dt(e);const t=Ko(2);return t.setDefaultOrigin(t.getSelectedRegion().id)}),ko(),xo(2,"label",43),sa(3,"use as default origin"),ko(),ko()}if(2&e){const e=Ko(2);Jr(1),Lo("checked",e.getDefaultOrigin()===e.getSelectedRegion().id)}}function zw(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",39),Fo(2,"app-icon",44),sa(3),ko(),xo(4,"div",39),Fo(5,"app-icon",44),sa(6),ko(),xo(7,"div",39),Fo(8,"app-icon",44),sa(9),ko(),ko()),2&e){const e=Ko(2);Jr(2),Lo("name","wealth")("path","world"),Jr(1),na(" ",e.getSelectedRegion().wealth," "),Jr(2),Lo("name","economy")("path","world"),Jr(1),na(" ",e.getSelectedRegion().economy," "),Jr(2),Lo("name","defense")("path","world"),Jr(1),na(" ",e.getSelectedRegion().defense," ")}}function Yw(e,t){1&e&&(xo(0,"span"),sa(1,"yes"),ko())}function Kw(e,t){1&e&&(xo(0,"span"),sa(1,"no"),ko())}function jw(e,t){1&e&&(xo(0,"span"),sa(1,"yes"),ko())}function $w(e,t){1&e&&(xo(0,"span"),sa(1,"no"),ko())}function Qw(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",39),Fo(2,"app-icon",44),Po(3,Yw,2,0,"span",3),Po(4,Kw,2,0,"span",3),ko(),xo(5,"div",39),Fo(6,"app-icon",44),Po(7,jw,2,0,"span",3),Po(8,$w,2,0,"span",3),ko(),xo(9,"div",39),Fo(10,"app-icon",44),sa(11),ko(),ko()),2&e){const e=Ko(2);Jr(2),Lo("name","roads")("path","world"),Jr(1),Lo("ngIf",e.getSelectedRegion().roads),Jr(1),Lo("ngIf",!e.getSelectedRegion().roads),Jr(2),Lo("name","watchtower")("path","world"),Jr(1),Lo("ngIf",e.getSelectedRegion().watchtower),Jr(1),Lo("ngIf",!e.getSelectedRegion().watchtower),Jr(2),Lo("name","guard_tower")("path","world"),Jr(1),na(" ",e.getGuardTowersCount()," ")}}function qw(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",39),Fo(2,"app-icon",44),sa(3),ko(),ko()),2&e){const e=Ko(2);Jr(2),Lo("name","defense")("path","world"),Jr(1),na(" ",e.getSelectedRegion().defense," ")}}function Xw(e,t){1&e&&(xo(0,"span"),sa(1,"yes"),ko())}function Zw(e,t){1&e&&(xo(0,"span"),sa(1,"no"),ko())}function Jw(e,t){1&e&&(xo(0,"span"),sa(1,"yes"),ko())}function eP(e,t){1&e&&(xo(0,"span"),sa(1,"no"),ko())}function tP(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",39),Fo(2,"app-icon",44),Po(3,Xw,2,0,"span",3),Po(4,Zw,2,0,"span",3),ko(),xo(5,"div",39),Fo(6,"app-icon",44),Po(7,Jw,2,0,"span",3),Po(8,eP,2,0,"span",3),ko(),xo(9,"div",39),Fo(10,"app-icon",44),sa(11),ko(),ko()),2&e){const e=Ko(2);Jr(2),Lo("name","roads")("path","world"),Jr(1),Lo("ngIf",e.getSelectedRegion().roads),Jr(1),Lo("ngIf",!e.getSelectedRegion().roads),Jr(2),Lo("name","watchtower")("path","world"),Jr(1),Lo("ngIf",e.getSelectedRegion().watchtower),Jr(1),Lo("ngIf",!e.getSelectedRegion().watchtower),Jr(2),Lo("name","guard_tower")("path","world"),Jr(1),na(" ",e.getGuardTowersCount()," ")}}function iP(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",39),Fo(2,"app-icon",44),sa(3),ko(),ko()),2&e){const e=Ko(2);Jr(2),Lo("name","spy")("path","army/mission"),Jr(1),na(" ",e.getSelectedRegion().spy," ")}}function sP(e,t){1&e&&(xo(0,"div"),xo(1,"div",39),Fo(2,"app-icon",44),sa(3," ? "),ko(),xo(4,"div",39),Fo(5,"app-icon",44),sa(6," ? "),ko(),xo(7,"div",39),Fo(8,"app-icon",44),sa(9," ? "),ko(),ko()),2&e&&(Jr(2),Lo("name","wealth")("path","world"),Jr(3),Lo("name","economy")("path","world"),Jr(3),Lo("name","defense")("path","world"))}function rP(e,t){1&e&&(xo(0,"div"),xo(1,"div",39),Fo(2,"app-icon",44),sa(3," ? "),ko(),xo(4,"div",39),Fo(5,"app-icon",44),sa(6," ? "),ko(),xo(7,"div",39),Fo(8,"app-icon",44),sa(9," ? "),ko(),ko()),2&e&&(Jr(2),Lo("name","roads")("path","world"),Jr(3),Lo("name","watchtower")("path","world"),Jr(3),Lo("name","guard_tower")("path","world"))}function nP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),oa("",i.getTroopName(e.troop)," : ",e.size,"")}}function oP(e,t){if(1&e&&(xo(0,"div"),Po(1,nP,2,2,"div",32),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngForOf",e.getFirstFourUnits(e.getSelectedRegion().army.units))}}function aP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),oa("",i.getTroopName(e.troop)," : ",e.size,"")}}function cP(e,t){if(1&e&&(xo(0,"div"),Po(1,aP,2,2,"div",32),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngForOf",e.getSecondFourUnits(e.getSelectedRegion().army.units))}}function lP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),oa("",i.getTroopName(e.troop)," : ",e.size,"")}}function uP(e,t){if(1&e&&(xo(0,"div"),Po(1,lP,2,2,"div",32),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngForOf",e.getSelectedRegion().navy.units)}}function hP(e,t){1&e&&(xo(0,"div"),xo(1,"div"),sa(2," troops: ? "),ko(),ko())}function dP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).colonize()}),sa(1,"Colonize "),Fo(2,"img",48),ko()}}function gP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).move()}),sa(1,"Move army "),Fo(2,"img",49),ko()}}function pP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).seaMove()}),sa(1,"Sea move "),Fo(2,"img",50),ko()}}function fP(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",45),Po(2,dP,3,0,"button",46),Po(3,gP,3,0,"button",46),Po(4,pP,3,0,"button",46),ko(),ko()),2&e){const e=Ko(4);Jr(2),Lo("ngIf",e.canColonize()&&e.hasPath(0,e.getSelectedRegion().id)),Jr(1),Lo("ngIf",e.getSelectedRegion().army.hasAny()),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.getSelectedRegion().navy.hasAny()&&e.hasSeaPath(e.getDefaultOrigin(),e.getSelectedRegion().id))}}function mP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).plunder()}),sa(1," Plunder "),Fo(2,"img",51),ko()}}function SP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).conquer()}),sa(1," Conquer "),Fo(2,"img",52),ko()}}function EP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).spy()}),sa(1,"Spy "),Fo(2,"img",53),ko()}}function vP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).seaPlunder()}),sa(1,"Sea plunder "),Fo(2,"img",54),ko()}}function RP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(5).seaConquer()}),sa(1,"Sea conquer "),Fo(2,"img",55),ko()}}function OP(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",45),Po(2,mP,3,0,"button",46),Po(3,SP,3,0,"button",46),Po(4,EP,3,0,"button",46),Po(5,vP,3,0,"button",46),Po(6,RP,3,0,"button",46),ko(),ko()),2&e){const e=Ko(4);Jr(2),Lo("ngIf",e.hasPath(e.getDefaultOrigin(),e.getSelectedRegion().id)),Jr(1),Lo("ngIf",e.hasPath(e.getDefaultOrigin(),e.getSelectedRegion().id)),Jr(1),Lo("ngIf",0===e.getSelectedRegion().spy&&e.hasPath(e.getDefaultOrigin(),e.getSelectedRegion().id,e.countries.SPECIAL,!0)),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.hasSeaPath(0,e.getSelectedRegion().id)),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.hasSeaPath(0,e.getSelectedRegion().id))}}function TP(e,t){if(1&e&&(xo(0,"div"),Po(1,fP,5,3,"div",3),Po(2,OP,7,5,"div",3),ko()),2&e){const e=Ko(3);Jr(1),Lo("ngIf",e.getSelectedCountry().id===e.countries.NEUTRAL),Jr(1),Lo("ngIf",e.getSelectedCountry().id!==e.countries.NEUTRAL)}}function IP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(4).move()}),sa(1,"Move army "),Fo(2,"img",49),ko()}}function bP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(4).build()}),sa(1,"Build "),Fo(2,"img",56),ko()}}function CP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(4).seaMove()}),sa(1,"Sea move "),Fo(2,"img",50),ko()}}function yP(e,t){if(1&e){const e=Go();xo(0,"button",47),Vo("click",function(){return Dt(e),Ko(4).expedition()}),sa(1,"Send expedition"),Fo(2,"img",57),ko()}}function AP(e,t){if(1&e&&(xo(0,"div"),xo(1,"div",45),Po(2,IP,3,0,"button",46),Po(3,bP,3,0,"button",46),Po(4,CP,3,0,"button",46),Po(5,yP,3,0,"button",46),ko(),ko()),2&e){const e=Ko(3);Jr(2),Lo("ngIf",e.getSelectedRegion().army.hasAny()),Jr(1),Lo("ngIf",0!==e.getSelectedRegion().id),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.getSelectedRegion().navy.hasAny()&&e.hasSeaPath(e.getDefaultOrigin(),e.getSelectedRegion().id)),Jr(1),Lo("ngIf",0===e.getSelectedRegion().id&&e.hasMap())}}function NP(e,t){if(1&e&&(xo(0,"div"),Po(1,TP,3,2,"div",3),Po(2,AP,6,4,"div",3),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngIf",e.getSelectedCountry().id!==e.countries.PLAYER),Jr(1),Lo("ngIf",e.getSelectedCountry().id===e.countries.PLAYER)}}function _P(e,t){if(1&e&&(xo(0,"div"),sa(1," Kingdom: "),xo(2,"span",34),sa(3),ko(),Po(4,Gw,1,0,"img",35),Po(5,Bw,1,0,"span",3),Fo(6,"br"),Po(7,Ww,2,2,"span",3),Po(8,Vw,4,1,"span",3),Fo(9,"hr"),xo(10,"div",36),xo(11,"div",37),ai(),xo(12,"svg",38),Fo(13,"path"),ko(),ko(),wt.lFrame.currentNamespace=null,xo(14,"div"),xo(15,"div",39),Fo(16,"app-icon",40),sa(17),ko(),xo(18,"div",39),Fo(19,"app-icon",40),sa(20),ko(),xo(21,"div",39),Fo(22,"app-icon",40),sa(23),ko(),ko(),Po(24,zw,10,9,"div",3),Po(25,Qw,12,11,"div",3),Po(26,qw,4,3,"div",3),Po(27,tP,12,11,"div",3),Po(28,iP,4,3,"div",3),Po(29,sP,10,6,"div",3),Po(30,rP,10,6,"div",3),Po(31,oP,2,1,"div",3),Po(32,cP,2,1,"div",3),Po(33,uP,2,1,"div",3),Po(34,hP,3,0,"div",3),ko(),Po(35,NP,3,2,"div",3),ko()),2&e){const e=Ko();Jr(3),ra(e.getSelectedCountry().name),Jr(1),Lo("ngIf",e.getSelectedCountry().id===e.countries.PLAYER),Jr(1),Lo("ngIf",e.isDev()),Jr(2),Lo("ngIf",e.getSelectedCountry().id!==e.countries.PLAYER&&e.getSelectedCountry().id!==e.countries.NEUTRAL),Jr(1),Lo("ngIf",e.getSelectedCountry().id===e.countries.PLAYER||e.getSelectedCountry().id===e.countries.NEUTRAL),Jr(4),No("height","72px")("width","72px")("viewBox",e.prepareViewbox(e.getSelectedRegion().center)),Jr(1),No("fill",e.getSelectedCountry().colour)("d",e.getSelectedRegion().path)("stroke","black")("stroke-width","2"),Jr(3),Lo("name","land"),Jr(1),na(" ",e.getSelectedRegion().land,""),Jr(2),Lo("name","forest"),Jr(1),na(" ",e.getSelectedRegion().forest,""),Jr(2),Lo("name","mountains"),Jr(1),na(" ",e.getSelectedRegion().mountains,""),Jr(1),Lo("ngIf",e.getSelectedRegion().spy>0&&e.getSelectedCountry().id!==e.countries.PLAYER),Jr(1),Lo("ngIf",e.getSelectedRegion().spy>0&&e.getSelectedCountry().id!==e.countries.PLAYER),Jr(1),Lo("ngIf",e.getSelectedCountry().id===e.countries.PLAYER),Jr(1),Lo("ngIf",e.getSelectedCountry().id===e.countries.PLAYER),Jr(1),Lo("ngIf",e.getSelectedRegion().spy>0&&e.getSelectedCountry().id!==e.countries.PLAYER),Jr(1),Lo("ngIf",0===e.getSelectedRegion().spy&&e.getSelectedCountry().id!==e.countries.PLAYER&&e.getSelectedCountry().id!==e.countries.NEUTRAL),Jr(1),Lo("ngIf",0===e.getSelectedRegion().spy&&e.getSelectedCountry().id!==e.countries.PLAYER&&e.getSelectedCountry().id!==e.countries.NEUTRAL),Jr(1),Lo("ngIf",e.getSelectedRegion().spy>0||e.getSelectedRegion().watched||e.getSelectedCountry().id===e.countries.PLAYER||e.getSelectedCountry().id===e.countries.NEUTRAL),Jr(1),Lo("ngIf",e.getSelectedRegion().spy>0||e.getSelectedRegion().watched||e.getSelectedCountry().id===e.countries.PLAYER||e.getSelectedCountry().id===e.countries.NEUTRAL),Jr(1),Lo("ngIf",e.getSelectedRegion().spy>0||e.getSelectedRegion().watched||e.getSelectedCountry().id===e.countries.PLAYER||e.getSelectedCountry().id===e.countries.NEUTRAL),Jr(1),Lo("ngIf",0===e.getSelectedRegion().spy&&!e.getSelectedRegion().watched&&e.getSelectedCountry().id!==e.countries.PLAYER&&e.getSelectedCountry().id!==e.countries.NEUTRAL),Jr(1),Lo("ngIf",!e.selecting)}}function wP(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),na("(",e.roundEffectiveSpeed(),")")}}function PP(e,t){if(1&e&&(xo(0,"div"),Fo(1,"app-icon",44),sa(2),Po(3,wP,2,1,"span",3),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","speed")("path","army"),Jr(1),na(" ",e.getSelectedMission().getArmySpeed()," "),Jr(1),Lo("ngIf",e.getSelectedMission().getArmySpeed()!==e.getSelectedMission().getArmyEffectiveSpeed())}}function MP(e,t){if(1&e&&(xo(0,"div"),Fo(1,"app-icon",40),sa(2),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","cargo"),Jr(1),na(" ",e.getMissionCargo(),"")}}function LP(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"button",65),Vo("click",function(){return Dt(e),Ko(2).cancel()}),sa(2,"cancel mission"),ko(),ko()}}function DP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),oa("",i.getTroopName(e.troop),": ",e.size,"")}}function xP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),na("",e.getSelectedMission().data," fish")}}function kP(e,t){if(1&e&&(xo(0,"div"),xo(1,"div"),sa(2),ko(),xo(3,"div"),sa(4),ko(),ko()),2&e){const e=Ko(3);Jr(2),na("",e.getSelectedMission().data.meat," meat"),Jr(2),na("",e.getSelectedMission().data.fur," fur")}}function FP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),na("",e.getSelectedMission().data," coins")}}function UP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),na("",e.getSelectedMission().data," coins")}}function HP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),na("",e.getSelectedMission().data," cartography data ")}}function GP(e,t){if(1&e&&(xo(0,"div"),Po(1,xP,2,1,"div",3),Po(2,kP,5,2,"div",3),Po(3,FP,2,1,"div",3),Po(4,UP,2,1,"div",3),Po(5,HP,2,1,"div",3),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngIf",e.getSelectedMission().mission===e.missions.FISHING),Jr(1),Lo("ngIf",e.getSelectedMission().mission===e.missions.HUNTING),Jr(1),Lo("ngIf",e.getSelectedMission().mission===e.missions.TREASURE),Jr(1),Lo("ngIf",e.getSelectedMission().mission===e.missions.SEA_BATTLE),Jr(1),Lo("ngIf",e.getSelectedMission().mission===e.missions.CARTOGRAPHY)}}function BP(e,t){if(1&e&&(xo(0,"div",58),xo(1,"div",59),sa(2),ko(),xo(3,"div",60),xo(4,"div"),Fo(5,"img",61),ko(),xo(6,"div",62),xo(7,"div",63),sa(8),Fo(9,"app-progress-bar",64),ko(),Po(10,PP,4,4,"div",3),Po(11,MP,3,2,"div",3),Po(12,LP,3,0,"div",3),ko(),xo(13,"div"),Po(14,DP,2,2,"div",32),ko(),Po(15,GP,6,5,"div",3),ko(),ko()),2&e){const e=Ko();Jr(2),ra(e.getMissionName()),Jr(3),$o("src",e.getSelectedMission().getIconPath(),er),Jr(3),na(" ",e.getSelectedMission().getStatus(),": "),Jr(1),Lo("progress",e.getSelectedMission().getDisplayProgress()),Jr(1),Lo("ngIf",e.getSelectedMission().mission!==e.missions.BUILD),Jr(1),Lo("ngIf",e.getSelectedMission().getMissionType()===e.missionType.SEA),Jr(1),Lo("ngIf",e.canCancel()),Jr(2),Lo("ngForOf",e.getSelectedMission().army.units),Jr(1),Lo("ngIf",null!==e.getSelectedMission().data)}}function WP(e,t){if(1&e){const e=Go();xo(0,"button",65),Vo("click",function(){return Dt(e),Ko(2).fishing()}),sa(1,"Start fishing "),ko()}}function VP(e,t){if(1&e){const e=Go();xo(0,"button",65),Vo("click",function(){return Dt(e),Ko(2).hunting()}),sa(1,"Start hunting "),ko()}}function zP(e,t){if(1&e){const e=Go();xo(0,"button",65),Vo("click",function(){return Dt(e),Ko(2).treasure()}),sa(1,"Look for treasure "),ko()}}function YP(e,t){if(1&e){const e=Go();xo(0,"button",65),Vo("click",function(){return Dt(e),Ko(2).cartography()}),sa(1,"Gather cartography data "),ko()}}function KP(e,t){if(1&e){const e=Go();xo(0,"button",65),Vo("click",function(){return Dt(e),Ko(2).seaBattle()}),sa(1,"Attack pirates "),ko()}}function jP(e,t){if(1&e){const e=Go();xo(0,"button",65),Vo("click",function(){return Dt(e),Ko(2).seaBattle()}),sa(1,"Attack pirates base "),ko()}}function $P(e,t){if(1&e&&(xo(0,"div",73),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na(" size: ",e.getSelectedSeaEvent().amount," ")}}function QP(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),oa("",i.getTroopName(e.troop)," : ",e.size,"")}}function qP(e,t){if(1&e&&(xo(0,"div",74),Po(1,QP,2,2,"div",32),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngForOf",e.getSelectedSeaEvent().data.units)}}function XP(e,t){if(1&e&&(xo(0,"div",66),xo(1,"div",67),sa(2),ko(),xo(3,"div",68),xo(4,"div",69),xo(5,"div"),Fo(6,"img",61),ko(),Po(7,WP,2,0,"button",70),Po(8,VP,2,0,"button",70),Po(9,zP,2,0,"button",70),Po(10,YP,2,0,"button",70),Po(11,KP,2,0,"button",70),Po(12,jP,2,0,"button",70),ko(),Po(13,$P,2,1,"div",71),Po(14,qP,2,1,"div",72),ko(),ko()),2&e){const e=Ko();Jr(2),ra(e.getSeaEventName()),Jr(4),$o("src",e.getSeaEventIconPath(e.getSelectedSeaEvent().type),er),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.hasSeaPath(0,e.getSelectedSeaEvent().parentId)&&e.getSelectedSeaEvent().type===e.seaEvents.FISH),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.hasSeaPath(0,e.getSelectedSeaEvent().parentId)&&e.getSelectedSeaEvent().type===e.seaEvents.SHARK),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.hasSeaPath(0,e.getSelectedSeaEvent().parentId)&&e.getSelectedSeaEvent().type===e.seaEvents.TREASURE),Jr(1),Lo("ngIf",e.isSeaCartographyEnabled()&&e.hasSeaPath(0,e.getSelectedSeaEvent().parentId)&&e.getSelectedSeaEvent().type===e.seaEvents.CARTOGRAPHY),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.hasSeaPath(0,e.getSelectedSeaEvent().parentId)&&e.getSelectedSeaEvent().type===e.seaEvents.PIRATES),Jr(1),Lo("ngIf",e.isSeaEnabled()&&e.hasSeaPath(0,e.getSelectedSeaEvent().parentId)&&e.getSelectedSeaEvent().type===e.seaEvents.PIRATES_BASE),Jr(1),Lo("ngIf",e.getSelectedSeaEvent().type!==e.seaEvents.WHIRLPOOL),Jr(1),Lo("ngIf",e.getSelectedSeaEvent().data)}}function ZP(e,t){if(1&e){const e=Go();ai(),xo(0,"path",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko()}if(2&e){const e=Ko().$implicit;No("fill",Ko().$implicit.colour)("d",e.path)("stroke","black")("stroke-width","2")}}function JP(e,t){if(1&e){const e=Go();ai(),xo(0,"g",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),Fo(1,"path"),Fo(2,"path"),ko()}if(2&e){const e=Ko().$implicit,t=Ko().$implicit;Jr(1),No("fill",t.colour)("d",e.path)("stroke","black")("stroke-width","2"),Jr(1),No("fill","url(#diagonalHatch)")("d",e.path)}}function eM(e,t){if(1&e){const e=Go();ai(),xo(0,"g"),xo(1,"circle",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),xo(2,"image",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),No("r",12)("cx",e.center.x)("cy",e.center.y+1)("fill",t.worldService.getCountry(e.capital).colour),Jr(1),No("height",20)("width",20)("x",e.center.x-10)("y",e.center.y-10)("href","assets/world/capital.svg",null,"xlink")}}function tM(e,t){if(1&e){const e=Go();ai(),xo(0,"g"),xo(1,"circle",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),xo(2,"image",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko().$implicit;Jr(1),No("r",6)("cx",e.center.x)("cy",e.center.y)("fill",t.colour),Jr(1),No("height",10)("width",10)("x",e.center.x-5)("y",e.center.y-5)("href","assets/army/recruit.svg",null,"xlink")}}function iM(e,t){if(1&e){const e=Go();ai(),xo(0,"g"),xo(1,"circle",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),xo(2,"image",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko().$implicit;Jr(1),No("r",6)("cx",e.center.x)("cy",e.center.y)("fill",t.colour),Jr(1),No("height",10)("width",10)("x",e.center.x-5)("y",e.center.y-5)("href","assets/army/mission/spy.svg",null,"xlink")}}function sM(e,t){if(1&e){const e=Go();ai(),xo(0,"g"),xo(1,"circle",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),xo(2,"image",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko().$implicit;Jr(1),No("r",6)("cx",e.center.x)("cy",e.center.y)("fill",t.colour),Jr(1),No("height",10)("width",10)("x",e.center.x-5)("y",e.center.y-5)("href","assets/world/roads.svg",null,"xlink")}}function rM(e,t){if(1&e){const e=Go();ai(),xo(0,"g"),xo(1,"circle",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),xo(2,"image",65),Vo("click",function(t){Dt(e);const i=Ko().$implicit,s=Ko().$implicit;return Ko().select(t,s,i)}),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko().$implicit;Jr(1),No("r",6)("cx",e.center.x)("cy",e.center.y)("fill",t.colour),Jr(1),No("height",10)("width",10)("x",e.center.x-5)("y",e.center.y-5)("href","assets/world/watchtower.svg",null,"xlink")}}function nM(e,t){if(1&e&&(ai(),Fo(0,"image",78)),2&e){const e=Ko().$implicit,t=Ko(2);No("height",20)("width",20)("x",t.getHarbour(e.id).CENTER.x-10)("y",t.getHarbour(e.id).CENTER.y-10)("href","assets/sea/port.svg",null,"xlink")}}function oM(e,t){if(1&e&&(ai(),xo(0,"g",76),Po(1,ZP,1,4,"path",70),Po(2,JP,3,6,"g",70),Po(3,eM,3,9,"g",3),Po(4,tM,3,9,"g",3),Po(5,iM,3,9,"g",3),Po(6,sM,3,9,"g",3),Po(7,rM,3,9,"g",3),Po(8,nM,1,5,"image",77),ko()),2&e){const e=t.$implicit,i=Ko().$implicit,s=Ko();Jr(1),Lo("ngIf",!s.getSelectedRegion()||e.id!==s.getSelectedRegion().id),Jr(1),Lo("ngIf",s.getSelectedRegion()&&e.id===s.getSelectedRegion().id),Jr(1),Lo("ngIf",0===s.radio&&void 0!==e.capital),Jr(1),Lo("ngIf",1===s.radio&&e.army.hasAny()&&(i.id===s.countries.PLAYER||i.id===s.countries.NEUTRAL||e.spy>0)),Jr(1),Lo("ngIf",2===s.radio&&e.spy>0),Jr(1),Lo("ngIf",3===s.radio&&e.roads&&(i.id===s.countries.PLAYER||i.id===s.countries.NEUTRAL||e.spy>0)),Jr(1),Lo("ngIf",4===s.radio&&e.watchtower&&(i.id===s.countries.PLAYER||i.id===s.countries.NEUTRAL||e.spy>0)),Jr(1),Lo("ngIf",s.showHarbours&&e.harbour)}}function aM(e,t){if(1&e&&(ai(),xo(0,"g"),Po(1,oM,9,8,"g",75),ko()),2&e){const e=t.$implicit;Jr(1),Lo("ngForOf",e.regions)}}function cM(e,t){if(1&e){const e=Go();ai(),xo(0,"circle",65),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().selectArea(t.id)}),ko()}if(2&e){const e=Ko().$implicit;No("cx",e.center.x)("cy",e.center.y)("r",e.r)("fill","red")("opacity",.1)("stroke-width","1")}}function lM(e,t){if(1&e){const e=Go();ai(),xo(0,"g",80),Vo("click",function(){const t=Dt(e).$implicit;return Ko(2).selectSeaEvent(t)}),Fo(1,"image",78),ko()}if(2&e){const e=t.$implicit,i=Ko(2);Jr(1),No("height",20)("width",20)("x",e.center.x-10)("y",e.center.y-10)("href",i.getSeaEventIconPath(e.type),null,"xlink")}}function uM(e,t){if(1&e&&(ai(),xo(0,"g"),Po(1,cM,1,6,"circle",70),Po(2,lM,2,5,"g",79),ko()),2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngIf",e.events.length>0&&(e.events[0].type===i.seaEvents.PIRATES||e.events[0].type===i.seaEvents.PIRATES_BASE)),Jr(1),Lo("ngForOf",e.events)}}function hM(e,t){if(1&e&&(ai(),xo(0,"g"),Fo(1,"line"),ko()),2&e){const e=t.$implicit;Jr(1),No("x1",e.origin.x)("y1",e.origin.y)("x2",e.target.x)("y2",e.target.y)("stroke","black")("stroke-dasharray","5,5")("stroke-width","1")}}function dM(e,t){if(1&e&&(ai(),xo(0,"g"),Po(1,hM,2,7,"g",32),ko()),2&e){const e=Ko().$implicit;Jr(1),Lo("ngForOf",e.routePaths)}}function gM(e,t){if(1&e&&(ai(),xo(0,"g",81),Po(1,dM,2,1,"g",3),ko()),2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngIf",i.getSelectedMission()&&i.getSelectedMission()===e&&i.getSelectedMission().ownerCountry.id===i.countries.PLAYER)}}function pM(e,t){if(1&e){const e=Go();ai(),xo(0,"g",81),xo(1,"circle",65),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().selectMission(t)}),ko(),xo(2,"image",84),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().selectMission(t)}),ko(),ko()}if(2&e){const e=Ko().$implicit;Jr(1),No("r",8)("cx",e.getOrigin().x+(e.getTarget().x-e.getOrigin().x)*e.getProgressPercentage())("cy",e.getOrigin().y+(e.getTarget().y-e.getOrigin().y)*e.getProgressPercentage())("fill","lightgrey")("stroke","black")("stroke-width","1"),Jr(1),No("height",12)("width",12)("x",e.getOrigin().x+(e.getTarget().x-e.getOrigin().x)*e.getProgressPercentage()-6)("y",e.getOrigin().y+(e.getTarget().y-e.getOrigin().y)*e.getProgressPercentage()-6)("href",e.getIconPath(),null,"xlink")}}function fM(e,t){if(1&e&&(ai(),xo(0,"g",85),Fo(1,"circle"),Fo(2,"circle"),Fo(3,"image",78),ko()),2&e){const e=Ko().$implicit;Jr(1),No("r",8)("cx",e.getOrigin().x+(e.getTarget().x-e.getOrigin().x)*e.getProgressPercentage())("cy",e.getOrigin().y+(e.getTarget().y-e.getOrigin().y)*e.getProgressPercentage())("fill","white")("stroke","black")("stroke-width","1"),Jr(1),No("r",8)("cx",e.getOrigin().x+(e.getTarget().x-e.getOrigin().x)*e.getProgressPercentage())("cy",e.getOrigin().y+(e.getTarget().y-e.getOrigin().y)*e.getProgressPercentage())("fill",e.ownerCountry.colour)("fill-opacity",.8)("stroke","black")("stroke-width","1"),Jr(1),No("height",12)("width",12)("x",e.getOrigin().x+(e.getTarget().x-e.getOrigin().x)*e.getProgressPercentage()-6)("y",e.getOrigin().y+(e.getTarget().y-e.getOrigin().y)*e.getProgressPercentage()-6)("href",e.getIconPath(),null,"xlink")}}function mM(e,t){if(1&e&&(ai(),xo(0,"g"),Po(1,pM,3,11,"g",82),Po(2,fM,4,18,"g",83),ko()),2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngIf",e.ownerCountry.id===i.countries.PLAYER),Jr(1),Lo("ngIf",e.ownerCountry.id!==i.countries.PLAYER)}}const SM=function(e){return{selecting:e}};let EM=(()=>{class e{constructor(e,t,i,s,r){this.servicesService=e,this.worldService=t,this.gameService=i,this.resourcesService=s,this.modalService=r,this.selecting=!1,this.regionSelected=new Vc,this.dragX=-1,this.dragY=-1,this.clickX=-1,this.clickY=-1,this.moved=!1,this.selectedSeaRegion=null,this.radio=0,this.showHarbours=!0,this.pathCache=[],this.countries=zf,this.seaEvents=jf,this.missions=Uf,this.missionType=uw,this.troops=Wf,this.worldService.registerForCacheInvalidation().subscribe(e=>{this.pathCache=[]}),this.radio=this.worldService.getMapDisplayOption()}ngOnInit(){}getX(){return this.worldService.getDisplayX()}getY(){return this.worldService.getDisplayY()}getZoom(){return this.worldService.getDisplayZoom()}getCountries(){return this.worldService.getCountries()}getMissions(){return this.worldService.getMissions()}handleKeyDown(e){"ArrowDown"===e.key&&this.worldService.setDisplayY(this.worldService.getDisplayY()+5)}dragStart(e){this.moved=!1,this.dragX=e.x,this.dragY=e.y,this.clickX=e.x,this.clickY=e.y}mousemove(e){1===e.buttons&&this.dragX>=1&&this.dragY>=1&&(this.moved=!0,this.worldService.setDisplayX(this.worldService.getDisplayX()+e.x-this.dragX),this.worldService.setDisplayY(this.worldService.getDisplayY()+e.y-this.dragY),this.dragX=e.x,this.dragY=e.y)}dragEnd(e){this.moved&&this.dragX>=0&&this.dragY>=0&&(this.worldService.setDisplayX(this.worldService.getDisplayX()+e.x-this.dragX),this.worldService.setDisplayY(this.worldService.getDisplayY()+e.y-this.dragY)),this.dragX=-1,this.dragY=-1}onScroll(e){e.preventDefault(),(e.deltaY>0&&this.getZoom()<2.5||e.deltaY<0&&this.getZoom()>.7)&&this.worldService.setDisplayZoom(this.getZoom()+Math.sign(e.deltaY)/10),this.getZoom()<.7?this.worldService.setDisplayZoom(.7):this.getZoom()>2.5&&this.worldService.setDisplayZoom(2.5)}prepareViewbox(e){return e.x-65+" "+(e.y-65)+" 130 130"}resetView(){this.worldService.setDisplayZoom(1.4),this.worldService.setDisplayX(150),this.worldService.setDisplayY(-220)}select(e,t,i){Math.abs(e.x-this.clickX)<2&&Math.abs(e.y-this.clickY)<2&&(this.clickX=-1,this.clickY=-1,this.worldService.setSelectedRegion(i),this.worldService.setSelectedCountry(t))}moveUp(){this.worldService.setDisplayY(this.getY()-20)}moveDown(){this.worldService.setDisplayY(this.getY()+20)}moveRight(){this.worldService.setDisplayX(this.getX()+20)}moveLeft(){this.worldService.setDisplayX(this.getX()-20)}plunder(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Uf.PLUNDER))}conquer(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Uf.CONQUER))}colonize(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getRegion(0),this.worldService.getPlayerCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Uf.COLONIZE))}move(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,null,null,null,null,Uf.MOVE))}spy(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Uf.SPY))}seaMove(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,null,null,null,null,Uf.SEA_MOVE))}seaPlunder(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Uf.SEA_PLUNDER))}seaConquer(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Uf.SEA_CONQUER))}fishing(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Uf.FISHING))}hunting(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Uf.HUNTING))}treasure(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Uf.TREASURE))}cartography(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Uf.CARTOGRAPHY))}seaBattle(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Uf.SEA_BATTLE))}expedition(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,null,Uf.EXPEDITION))}isDev(){return!Am.production}getNeighbours(e){const t=[];return this.getCountries().forEach(i=>{i.regions.forEach(i=>{e.neighbours.includes(i.id)&&t.push(i)})}),t}selectMission(e){this.worldService.setSelectedMission(e)}findPath(e,t,i){const s=this.worldService.findPath(e,t,i,!0);return s?s.path.length-1:-1}hasPath(e,t,i=zf.PLAYER,s=!1){if(s)return this.findPath(e,t,i)>=0;{const s=this.pathCache.find(i=>i[0]===e&&i[1]===t);if(s)return s[2];const r=this.findPath(e,t,i)>=0;return this.pathCache.push([e,t,r]),r}}getSelectedRegion(){return this.worldService.getSelectedRegion()}getSelectedCountry(){return this.worldService.getSelectedCountry()}getSelectedMission(){return this.worldService.getSelectedMission()}getTroopName(e){return Qf.prepareTroopName(e)}getMissionName(){return Qf.prepareMissionName(this.getSelectedMission().mission)}canColonize(){return this.worldService.canColonize(this.getSelectedRegion().id)}zoomIn(){this.getZoom()>.7&&(this.worldService.setDisplayZoom(this.getZoom()-.1),this.getZoom()<.7&&this.worldService.setDisplayZoom(.7))}zoomOut(){this.getZoom()<2.5&&(this.worldService.setDisplayZoom(this.getZoom()+.1),this.getZoom()>2.5&&this.worldService.setDisplayZoom(2.5))}getDefaultOrigin(){return this.worldService.getDefaultOrigin()}setDefaultOrigin(e){this.worldService.setDefaultOrigin(e)}getTarget(e){return gw[e]}build(){this.worldService.getMissions().find(e=>e.mission===Uf.BUILD&&e.getDestinationTargetRegion().id===this.getSelectedRegion().id)?this.modalService.info("Building already in progress"):(this.modalService.open(Pf.WORLD_BUILD),this.modalService.setWorldRegion(this.getSelectedRegion()))}getFirstFourUnits(e){return e.length>4?e.filter(e=>e.troop===Wf.MILITIA||e.troop===Wf.ARCHER||e.troop===Wf.SPEARMAN||e.troop===Wf.SWORDSMAN).sort((e,t)=>e.troop-t.troop):e.filter(e=>e.troop!==Wf.GUARD_TOWER).sort((e,t)=>e.troop-t.troop)}getSecondFourUnits(e){if(e.length>4)return e.filter(e=>e.troop===Wf.LIGHT_CAVALRY||e.troop===Wf.HORSE_ARCHER).sort((e,t)=>e.troop-t.troop)}changeName(){this.worldService.changeName()}calculateTotalLand(){this.worldService.DEV_calculateTotalLand()}updateMapDisplayOption(){this.worldService.setMapDisplayOption(this.radio),this.worldService.setShowHarbours(this.showHarbours)}cancel(){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel this mission?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&this.getSelectedMission().cancel()})}canCancel(){const e=this.getSelectedMission();return e.canCancel()&&"traveling"===e.status}getSeaAreas(){return this.worldService.getSeaAreas()}getSeaArea(e){return this.worldService.getSeaAreas().find(t=>t.id===e)}selectArea(e){this.selectedSeaRegion=e}getSeaEventIconPath(e){let t;switch(e){case jf.FISH:t="fish";break;case jf.SHARK:t="shark";break;case jf.TREASURE:t="treasure";break;case jf.PIRATES:t="pirate_flag";break;case jf.PIRATES_BASE:t="pirates_base";break;case jf.WHIRLPOOL:t="whirlpool";break;case jf.CARTOGRAPHY:t="sextant"}return"assets/sea/"+t+".svg"}selectSeaEvent(e){this.worldService.setSelectedSeaEvent(e)}getSelectedSeaEvent(){return this.worldService.getSelectedSeaEvent()}getSeaEventName(){return Qf.prepareSeaEventName(this.getSelectedSeaEvent().type)}getShowHarbours(){return this.worldService.getShowHarbours()}getHarbour(e){return gS.SEA_AREAS.find(t=>t.ID===e)}hasSeaPath(e,t){return!!this.worldService.findSeaPath(e,t,!0)}DEV_changeToPirate(){this.getSelectedSeaEvent().type=jf.PIRATES,this.getSelectedSeaEvent().data=new Cy([new by(Wf.BOAT,1)])}hasMap(){return 0===this.resourcesService.hasResource(Df.MAP,1,"Expedition",!0)}isSeaEnabled(){return this.gameService.isEnabled(Mf.NAVY)}isSeaCartographyEnabled(){return this.gameService.isEnabled(Mf.CARTOGRAPHER)}getMissionCargo(){return this.getSelectedMission().army.getArmyCargo()}roundEffectiveSpeed(){return Qf.round(this.getSelectedMission().getArmyEffectiveSpeed(),2)}DEV_deleteSeaEvent(e){this.worldService.getSeaArea(e.parentId).events=[]}DEV_clearSeaEventData(){this.getSelectedSeaEvent().data=new Cy([])}getGuardTowersCount(){const e=this.getSelectedRegion().army.getUnit(Wf.GUARD_TOWER);return void 0===e?0:e.size}}return e.\u0275fac=function(t){return new(t||e)(Mo(Jf),Mo(Uw),Mo(AS),Mo(Pv),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-world"]],viewQuery:function(e,t){if(1&e&&il(Hw,5),2&e){let e;tl(e=rl())&&(t.svgRef=e.first)}},hostBindings:function(e,t){1&e&&Vo("keydown",function(e){return t.handleKeyDown(e)})("mousedown",function(e){return t.dragStart(e)})("mousemove",function(e){return t.mousemove(e)})("mouseup",function(e){return t.dragEnd(e)})("wheel",function(e){return t.onScroll(e)})},inputs:{selecting:"selecting"},outputs:{regionSelected:"regionSelected"},decls:49,vars:24,consts:[["id","wrapper"],["id","title"],["id","details",3,"ngClass"],[4,"ngIf"],["id","missionDetails",4,"ngIf"],["id","seaEventDetails",4,"ngIf"],["id","svg"],["svg",""],["id","target","src","assets/world/target.svg",3,"click"],["id","arrowUp","src","assets/world/arrow_up.svg",3,"click"],["id","arrowDown","src","assets/world/arrow_down.svg",3,"click"],["id","arrowRight","src","assets/world/arrow_right.svg",3,"click"],["id","arrowLeft","src","assets/world/arrow_left.svg",3,"click"],["id","plus","src","assets/world/plus.svg",3,"click"],["id","minus","src","assets/world/minus.svg",3,"click"],["id","options2"],["for","showRoads"],["id","showRoads","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showWatchtowers"],["id","showWatchtowers","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showHarbours"],["id","showHarbours","type","checkbox",3,"checked","ngModel","change","ngModelChange"],["id","options"],["for","showCapitals"],["id","showCapitals","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showArmies"],["id","showArmies","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showSpies"],["id","showSpies","type","radio",3,"value","ngModel","change","ngModelChange"],["xmlns","http://www.w3.org/2000/svg","id","mainMap"],["id","diagonalHatch","patternUnits","userSpaceOnUse","width","4","height","4"],["d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",2,"stroke","black","stroke-width","0.5"],[4,"ngFor","ngForOf"],["class","mission",4,"ngFor","ngForOf"],["id","kingdomName"],["id","changeName","src","assets/gear.svg",3,"click",4,"ngIf"],["id","regionDetails"],["id","svgBox"],["draggable","false","ondragstart","return false;",1,"regionSVG"],[1,"icon"],[3,"name"],["id","changeName","src","assets/gear.svg",3,"click"],["id","defaultOrigin","type","radio",3,"checked","change"],["for","defaultOrigin"],[3,"name","path"],[1,"buttons"],["class","icon",3,"click",4,"ngIf"],[1,"icon",3,"click"],["src","assets/army/mission/colonize.svg",1,"buttonIcon"],["src","assets/army/mission/move.svg",1,"buttonIcon"],["src","assets/army/mission/sea_move.svg",1,"buttonIcon"],["src","assets/army/mission/plunder.svg",1,"buttonIcon"],["src","assets/army/mission/conquer.svg",1,"buttonIcon"],["src","assets/army/mission/spy.svg",1,"buttonIcon"],["src","assets/army/mission/sea_plunder.svg",1,"buttonIcon"],["src","assets/army/mission/sea_conquer.svg",1,"buttonIcon"],["src","assets/army/mission/build.svg",1,"buttonIcon"],["src","assets/resources/map.svg",1,"buttonIcon"],["id","missionDetails"],["id","missionTitle"],["id","missionBody"],[3,"src"],["id","missionStats"],["id","missionStatus"],[3,"progress"],[3,"click"],["id","seaEventDetails"],["id","seaEventTitle"],["id","seaEventBody"],["id","seaEventLeft"],[3,"click",4,"ngIf"],["id","sizeDiv",4,"ngIf"],["id","seaEventRight",4,"ngIf"],["id","sizeDiv"],["id","seaEventRight"],["class","region",4,"ngFor","ngForOf"],[1,"region"],["draggable","false","ondragstart","return false;",4,"ngIf"],["draggable","false","ondragstart","return false;"],["class","seaEvent",3,"click",4,"ngFor","ngForOf"],[1,"seaEvent",3,"click"],[1,"mission"],["class","mission",4,"ngIf"],["class","computerMission",4,"ngIf"],["draggable","false","ondragstart","return false;",3,"click"],[1,"computerMission"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),sa(2,"World Map"),ko(),xo(3,"div",2),Po(4,_P,36,30,"div",3),Po(5,BP,16,9,"div",4),Po(6,XP,15,10,"div",5),ko(),xo(7,"div",6,7),xo(9,"img",8),Vo("click",function(){return t.resetView()}),ko(),xo(10,"img",9),Vo("click",function(){return t.moveDown()}),ko(),xo(11,"img",10),Vo("click",function(){return t.moveUp()}),ko(),xo(12,"img",11),Vo("click",function(){return t.moveLeft()}),ko(),xo(13,"img",12),Vo("click",function(){return t.moveRight()}),ko(),xo(14,"img",13),Vo("click",function(){return t.zoomIn()}),ko(),xo(15,"img",14),Vo("click",function(){return t.zoomOut()}),ko(),xo(16,"div",15),xo(17,"label",16),sa(18,"show roads"),ko(),xo(19,"input",17),Vo("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),ko(),Fo(20,"br"),xo(21,"label",18),sa(22,"show watchtowers"),ko(),xo(23,"input",19),Vo("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),ko(),Fo(24,"br"),xo(25,"label",20),sa(26,"show harbours"),ko(),xo(27,"input",21),Vo("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.showHarbours=e}),ko(),ko(),xo(28,"div",22),xo(29,"label",23),sa(30,"show capitals"),ko(),xo(31,"input",24),Vo("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),ko(),Fo(32,"br"),xo(33,"label",25),sa(34,"show armies"),ko(),xo(35,"input",26),Vo("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),ko(),Fo(36,"br"),xo(37,"label",27),sa(38,"show spies"),ko(),xo(39,"input",28),Vo("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),ko(),ko(),ai(),xo(40,"svg",29),xo(41,"defs"),xo(42,"pattern",30),Fo(43,"path",31),ko(),ko(),xo(44,"g"),Po(45,aM,2,1,"g",32),Po(46,uM,3,2,"g",32),Po(47,gM,2,1,"g",33),Po(48,mM,3,2,"g",32),ko(),ko(),ko(),ko()),2&e&&(Jr(3),Lo("ngClass",Mc(22,SM,t.selecting)),Jr(1),Lo("ngIf",t.getSelectedCountry()&&t.getSelectedRegion()),Jr(1),Lo("ngIf",t.getSelectedMission()),Jr(1),Lo("ngIf",t.getSelectedSeaEvent()),Jr(13),Lo("value",3)("ngModel",t.radio),Jr(4),Lo("value",4)("ngModel",t.radio),Jr(4),Lo("checked",t.getShowHarbours())("ngModel",t.showHarbours),Jr(4),Lo("value",0)("ngModel",t.radio),Jr(4),Lo("value",1)("ngModel",t.radio),Jr(4),Lo("value",2)("ngModel",t.radio),Jr(1),No("viewBox",-674*t.getZoom()/2+" "+-674*t.getZoom()/2+" "+674*t.getZoom()+" "+464*t.getZoom()),Jr(4),No("transform","translate("+t.getX()+" "+t.getY()+")"),Jr(1),Lo("ngForOf",t.getCountries()),Jr(1),Lo("ngForOf",t.getSeaAreas()),Jr(1),Lo("ngForOf",t.getMissions()),Jr(1),Lo("ngForOf",t.getMissions()))},directives:[ku,Gu,UT,KO,dT,MT,VO,Uu,sI,PI],styles:["#wrapper[_ngcontent-%COMP%]{width:100%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#details[_ngcontent-%COMP%]{margin:5px 5px 0;width:98%;height:152px;border:black solid 2px}#details.selecting[_ngcontent-%COMP%]{height:117px}#svg[_ngcontent-%COMP%]{position:relative;margin:5px;width:98%;height:70.5%;border:black solid 2px}#kingdomName[_ngcontent-%COMP%]{font-weight:bold}#mainMap[_ngcontent-%COMP%]{background-color:#86c5da}#target[_ngcontent-%COMP%]{position:absolute;width:30px;top:25px;right:30px;cursor:pointer}#arrowUp[_ngcontent-%COMP%]{position:absolute;width:30px;top:0;right:30px;cursor:pointer}#arrowDown[_ngcontent-%COMP%]{position:absolute;width:30px;top:50px;right:30px;cursor:pointer}#arrowRight[_ngcontent-%COMP%]{position:absolute;width:30px;top:25px;right:5px;cursor:pointer}#arrowLeft[_ngcontent-%COMP%]{position:absolute;width:30px;top:25px;right:55px;cursor:pointer}#plus[_ngcontent-%COMP%]{position:absolute;width:25px;top:80px;right:50px;cursor:pointer}#minus[_ngcontent-%COMP%]{position:absolute;width:25px;top:80px;right:15px;cursor:pointer}#options[_ngcontent-%COMP%]{position:absolute;top:5px;right:90px;cursor:pointer}#options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:100px;text-align:end;cursor:pointer}#options2[_ngcontent-%COMP%]{position:absolute;top:5px;right:220px;cursor:pointer}#options2[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:150px;text-align:end;cursor:pointer}.mission[_ngcontent-%COMP%]{cursor:pointer}svg[_ngcontent-%COMP%]{height:100%;width:100%}.region[_ngcontent-%COMP%]:hover{opacity:.7}#regionDetails[_ngcontent-%COMP%]{display:flex;flex-direction:row}#regionDetails[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-right:10px}#missionDetails[_ngcontent-%COMP%]{display:flex;flex-direction:column}#missionTitle[_ngcontent-%COMP%]{font-size:1.1em;font-weight:bolder;text-align:center;padding-bottom:5px}#missionBody[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-left:5px}app-progress-bar[_ngcontent-%COMP%]{margin-top:3px;margin-left:5px;display:inline-block;width:150px;height:15px;font-size:.7em}#missionStatus[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:2px}#missionStats[_ngcontent-%COMP%]{display:flex;flex-direction:column}#missionBody[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 auto}#missionBody[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px}#missionDetails[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-right:20px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}hr[_ngcontent-%COMP%]{display:block;height:1px;border:0;border-top:1px solid black;padding:0;margin:2px 0}button[_ngcontent-%COMP%]{margin:2px;padding:4px}.buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}.buttonIcon[_ngcontent-%COMP%]{height:20px}#changeName[_ngcontent-%COMP%]{margin-left:5px;height:14px;cursor:pointer}#svgBox[_ngcontent-%COMP%]{height:72px;width:72px}.seaEvent[_ngcontent-%COMP%]{cursor:pointer}#seaEventBody[_ngcontent-%COMP%]{display:flex;flex-direction:row}#seaEventTitle[_ngcontent-%COMP%]{margin-left:10px;font-weight:bolder}#sizeDiv[_ngcontent-%COMP%]{padding-right:15px}"]}),e})();function vM(e,t){if(1&e&&(xo(0,"div",28),xo(1,"div",29),sa(2),ko(),ko()),2&e){const e=Ko().$implicit;Jr(2),ra(e)}}function RM(e,t){if(1&e&&(xo(0,"div",30),xo(1,"div",29),sa(2),ko(),ko()),2&e){const e=Ko().$implicit;Jr(2),ra(e)}}function OM(e,t){if(1&e){const e=Go();xo(0,"div",25),Vo("click",function(){const t=Dt(e).$implicit;return Ko().select(t)}),Po(1,vM,3,1,"div",26),Po(2,RM,3,1,"div",27),ko()}if(2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngIf",i.bookPage===e),Jr(1),Lo("ngIf",i.bookPage!==e)}}function TM(e,t){if(1&e){const e=Go();xo(0,"app-recipe",31),Vo("click",function(t){const i=Dt(e).$implicit;return Ko().craft(t,i)}),ko()}2&e&&Lo("recipe",t.$implicit)}function IM(e,t){if(1&e&&Fo(0,"app-recipe",32),2&e){const e=t.$implicit;Lo("recipe",e.recipe)("amount",e.amount)("type",e.type)("id",e.id)}}let bM=(()=>{class e{constructor(e,t,i,s,r){this.recipeService=e,this.resourcesService=t,this.craftingService=i,this.modalService=s,this.changeDetectorRef=r,this.craftingTypes=BN,this.filterText="",this.amount=1,this.craftingType=this.craftingTypes.SELECTED,this.bookPage=Gf[Gf.ALL]}ngOnInit(){this.craftingService.registerForUpdate().subscribe(()=>{this.changeDetectorRef.destroyed||this.changeDetectorRef.detectChanges()}),this.craftingType=this.craftingService.getCookingType()}getRecipes(){return this.filterText&&this.filterText.length>0?this.recipeService.getCookingRecipes().filter(e=>e.available&&(this.resourcesService.getResourceTypes(e.getResource()).includes(Gf[this.bookPage])&&e.title.toLowerCase().includes(this.filterText.toLowerCase())||this.resourcesService.getResourceTypes(e.getResource()).includes(Gf[this.bookPage])&&Qf.prepareResourceName(e.getResource()).toLowerCase().includes(this.filterText.toLowerCase()))):this.recipeService.getCookingRecipes().filter(e=>e.available&&this.resourcesService.getResourceTypes(e.getResource()).includes(Gf[this.bookPage]))}getEntries(){const e=[];return e.push(Gf[Gf.FOOD]),e}select(e){this.bookPage=e}craft(e,t){this.validateAmountInput()&&this.craftingService.cook(e,t,this.amount,this.craftingType)}getQueue(){return this.craftingService.getCookingQueue()}drop(e){this.craftingService.moveRecipeInCookingQueue(e)}getQueueMaxSize(){return this.craftingService.getCookingQueueMaxSize()}validateAmountInput(){return!(isNaN(this.amount)||Number(this.amount)<1)||(this.modalService.info("Invalid cook amount"),this.amount=1,!1)}updateCraftingType(){this.craftingService.setCookingType(this.craftingType)}}return e.\u0275fac=function(t){return new(t||e)(Mo(VN),Mo(Pv),Mo(zN),Mo(em),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-cooking"]],decls:58,vars:18,consts:[["id","wrapper"],["id","title"],["id","boxes"],["id","recipes"],[1,"title"],[1,"icon"],["appTooltip","",1,"tooltip",3,"elementId"],[3,"name","title"],["id","help1"],["id","recipesBook"],["id","menu"],["class","entry",3,"click",4,"ngFor","ngForOf"],["id","book"],["id","side"],["id","filter"],["type","text",3,"ngModel","ngModelChange"],["id","amount"],["type","number","min","1",3,"ngModel","ngModelChange"],[1,"radios"],["type","radio","name","type",3,"ngModel","value","ngModelChange","change"],["id","bookRecipes"],[3,"recipe","click",4,"ngFor","ngForOf"],[1,"queue"],["id","queueRecipes","cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"recipe","amount","type","id",4,"ngFor","ngForOf"],[1,"entry",3,"click"],["class","activeEntry",4,"ngIf"],["class","inactiveEntry",4,"ngIf"],[1,"activeEntry"],[1,"entryText"],[1,"inactiveEntry"],[3,"recipe","click"],["cdkDrag","",3,"recipe","amount","type","id"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-crafting-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"span",4),xo(6,"span",5),sa(7,"Recipes "),xo(8,"div",6),Fo(9,"app-icon",7),xo(10,"span",8),sa(11," In this menu you can define orders for your kitchens."),Fo(12,"br"),Fo(13,"br"),sa(14," Each kitchen will try to take order from the orders lists starting from top."),Fo(15,"br"),Fo(16,"br"),sa(17," Only orders that meet requirements will be taken by kitchen."),Fo(18,"br"),Fo(19,"br"),sa(20," You can add order to the top of the list by holding shift while clicking on a recipe. "),ko(),ko(),ko(),ko(),xo(21,"div",9),xo(22,"div",10),Po(23,OM,3,2,"div",11),ko(),xo(24,"div",12),xo(25,"div",13),xo(26,"div",14),sa(27," Filter:"),Fo(28,"br"),xo(29,"input",15),Vo("ngModelChange",function(e){return t.filterText=e}),ko(),ko(),xo(30,"div",16),sa(31," amount:"),Fo(32,"br"),xo(33,"input",17),Vo("ngModelChange",function(e){return t.amount=e}),ko(),ko(),xo(34,"div",18),xo(35,"label"),xo(36,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(37," selected amount "),ko(),Fo(38,"br"),xo(39,"label"),xo(40,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(41," until X available "),ko(),Fo(42,"br"),xo(43,"label"),xo(44,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(45," until % available "),ko(),ko(),xo(46,"div",18),xo(47,"label"),xo(48,"input",19),Vo("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),ko(),sa(49," continuous "),ko(),ko(),ko(),xo(50,"div",20),Po(51,TM,1,1,"app-recipe",21),ko(),ko(),ko(),ko(),xo(52,"div",22),xo(53,"span",4),sa(54,"Orders"),ko(),sa(55),xo(56,"div",23),Vo("cdkDropListDropped",function(e){return t.drop(e)}),Po(57,IM,1,4,"app-recipe",24),ko(),ko(),ko(),ko()),2&e&&(Jr(8),Lo("elementId","help1"),Jr(1),Lo("name","question")("title",""),Jr(14),Lo("ngForOf",t.getEntries()),Jr(6),Lo("ngModel",t.filterText),Jr(4),Lo("ngModel",t.amount),Jr(3),Lo("ngModel",t.craftingType)("value",t.craftingTypes.SELECTED),Jr(4),Lo("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_X),Jr(4),Lo("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_PERCENT),Jr(4),Lo("ngModel",t.craftingType)("value",t.craftingTypes.CONTINUOUS),Jr(3),Lo("ngForOf",t.getRecipes()),Jr(4),oa(" ",t.getQueue().length,"/",t.getQueueMaxSize()," "),Jr(2),Lo("ngForOf",t.getQueue()))},directives:[KN,rI,sI,Uu,KO,dT,MT,JT,DT,UT,sv,Gu,g_,cv],styles:["#wrapper[_ngcontent-%COMP%]{height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#boxes[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:95%;margin:.5%;text-align:center}#recipes[_ngcontent-%COMP%]{text-align:center;flex:0 0 74.3%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.queue[_ngcontent-%COMP%]{text-align:center;flex:0 0 25%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}#queueRecipes[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden}.title[_ngcontent-%COMP%]{width:100.5%;font-weight:bolder;font-size:1.1em;display:inline-block;border-bottom:black solid 1px}#modes[_ngcontent-%COMP%]{margin-top:-1px;padding:0;margin-bottom:5px}#recipesBook[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}#menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-right:black solid 1px;flex:0 0 10%}.entry[_ngcontent-%COMP%]{display:flex;border-bottom:black solid 1px;flex:1 0 0;height:100%;width:100%;margin-right:-30px;font-size:.8em;font-weight:600;cursor:pointer}.entry[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.entryText[_ngcontent-%COMP%]{-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-ms-transform:rotate(-90deg);-o-transform:rotate(-90deg)}.inactiveEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center}.activeEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center;background-color:var(--active-colour)}#book[_ngcontent-%COMP%]{flex:0 0 90%;width:100%}#bookRecipes[_ngcontent-%COMP%]{overflow-y:auto;border-top:black solid 1px}app-recipe[_ngcontent-%COMP%]{font-size:.8em;display:inline-block;width:130px;margin:4px 6px;cursor:pointer}#side[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-size:.8em;margin:1%;vertical-align:bottom}#filter[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:1.05em;margin-left:0;padding:0;border:none;outline:0}#amount[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#amount[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:65%;font-size:1.15em;margin-left:0;padding:0;border:none;outline:0}.radios[_ngcontent-%COMP%]{text-align:left;font-size:.9em}#progressButton[_ngcontent-%COMP%]{font-size:.6em}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:85px;margin:auto}#help1[_ngcontent-%COMP%]{font-size:.7em;font-weight:normal;text-align:left}"]}),e})();function CM(e,t){if(1&e&&(xo(0,"option",16),sa(1),ko()),2&e){const e=t.$implicit,i=Ko();Lo("ngValue",e),Jr(1),na(" ",i.getRegionName(e)," ")}}function yM(e,t){if(1&e&&(xo(0,"div",17),xo(1,"span"),sa(2),ko(),xo(3,"span"),sa(4),ko(),xo(5,"span"),sa(6),ko(),xo(7,"span"),sa(8),ko(),xo(9,"span"),sa(10),ko(),xo(11,"span"),sa(12),ko(),ko()),2&e){const e=t.$implicit,i=t.index,s=Ko();Jr(2),na("",i+1,"."),Jr(2),ra(s.getBuildingName(e.building)),Jr(2),ra(e.count),Jr(2),ra(e.size),Jr(2),ra(e.working),Jr(2),ra(e.count-e.working)}}let AM=(()=>{class e{constructor(e,t){this.servicesService=e,this.gameService=t,this.region=Kf.VILLAGE,this.sorting=0}ngOnInit(){}getBuildings(e){const t=[];return this.servicesService.getServiceByRegion(e).getBuildings().forEach(e=>{const i=t.find(t=>t.building===e.getBuildingType());i?(i.count+=1,i.size+=e.getSize(),e.isWorking()&&(i.working+=1)):t.push({building:e.getBuildingType(),count:1,size:e.getSize(),working:e.isWorking()?1:0})}),t.sort(0===this.sorting?(e,t)=>e.building-t.building:1===this.sorting?(e,t)=>t.count-e.count:(e,t)=>e.count-t.count)}getBuildingName(e){return Qf.prepareBuildingName(e)}getRegions(){const e=[Kf.VILLAGE];return this.gameService.isEnabled(Mf.FORT)&&e.push(Kf.FORT),e.push(Kf.FOREST),this.gameService.isEnabled(Mf.FIELD)&&e.push(Kf.FIELD),this.gameService.isEnabled(Mf.MOUNTAINS)&&e.push(Kf.MOUNTAINS),this.gameService.isEnabled(Mf.PLATEAU)&&e.push(Kf.PLATEAU),this.gameService.isEnabled(Mf.SEA)&&e.push(Kf.SEA),e}getRegionName(e){return Qf.prepareRegionName(e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(Jf),Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-summary"]],decls:39,vars:9,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],["id","sortAlphabetically","type","radio","name","sorting",3,"ngModel","value","ngModelChange"],["for","sortAlphabetically"],["id","sortByBiggest","type","radio","name","sorting",3,"ngModel","value","ngModelChange"],["for","sortByBiggest"],["id","sortBySmallest","type","radio","name","sorting",3,"ngModel","value","ngModelChange"],["for","sortBySmallest"],[3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["id","buildingEffects"],[1,"headers"],[1,"rows"],["class","row",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"row"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-management-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"span"),sa(6,"Summary page"),ko(),ko(),xo(7,"input",4),Vo("ngModelChange",function(e){return t.sorting=e}),ko(),xo(8,"label",5),sa(9,"sort alphabetically"),ko(),Fo(10,"br"),xo(11,"input",6),Vo("ngModelChange",function(e){return t.sorting=e}),ko(),xo(12,"label",7),sa(13,"sort by most buildings"),ko(),Fo(14,"br"),xo(15,"input",8),Vo("ngModelChange",function(e){return t.sorting=e}),ko(),xo(16,"label",9),sa(17,"sort by least buildings"),ko(),Fo(18,"br"),xo(19,"h3"),xo(20,"select",10),Vo("ngModelChange",function(e){return t.region=e}),Po(21,CM,2,2,"option",11),ko(),sa(22," Buildings "),ko(),xo(23,"div",12),xo(24,"div",13),xo(25,"span"),sa(26,"#"),ko(),xo(27,"span"),sa(28,"building"),ko(),xo(29,"span"),sa(30,"count"),ko(),xo(31,"span"),sa(32,"total land"),ko(),xo(33,"span"),sa(34,"working"),ko(),xo(35,"span"),sa(36,"idle"),ko(),ko(),xo(37,"div",14),Po(38,yM,13,6,"div",15),ko(),ko(),ko(),ko()),2&e&&(Jr(7),Lo("ngModel",t.sorting)("value",0),Jr(4),Lo("ngModel",t.sorting)("value",1),Jr(4),Lo("ngModel",t.sorting)("value",2),Jr(5),Lo("ngModel",t.region),Jr(1),Lo("ngForOf",t.getRegions()),Jr(17),Lo("ngForOf",t.getBuildings(t.region)))},directives:[O_,UT,KO,dT,MT,VT,Uu,zT,$T],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#content[_ngcontent-%COMP%]{margin:.5%;height:94%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.headers[_ngcontent-%COMP%]{margin:3px 3px 0;display:flex;width:98.3%;flex-direction:row;text-align:center;font-size:.9em;font-weight:bold}.rows[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:90.5%;overflow-y:auto}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border:black solid 1px;border-left:none}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{border-left:black solid 1px}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 30%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 15%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 18%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(6){flex:0 0 15%}.row[_ngcontent-%COMP%]{display:flex;border:black solid 1px;margin:3px}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{border-right:none}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 30%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 18%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(6){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:auto;border-right:black solid 1px}"]}),e})();function NM(e,t){if(1&e&&(xo(0,"span"),Fo(1,"app-icon",3),sa(2),ko()),2&e){const e=Ko();Jr(1),Lo("name","sextant")("path","sea")("title","cartography data"),Jr(1),na(" ",e.getCartographyData()," \xa0\xa0\xa0 ")}}function _M(e,t){if(1&e){const e=Go();xo(0,"span",17),Vo("click",function(){return Dt(e),Ko().changeDismiss(!0)}),sa(1,"decommission"),ko()}}function wM(e,t){if(1&e){const e=Go();xo(0,"span",18),Vo("click",function(){return Dt(e),Ko().changeDismiss(!1)}),sa(1,"decommission"),ko()}}const PM=function(e){return{pointer:e}};function MM(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"div",19),xo(2,"img",20),Vo("click",function(){const t=Dt(e).$implicit;return Ko().tryToDismiss(t)}),ko(),sa(3),xo(4,"span",21),xo(5,"div",22),sa(6),ko(),Fo(7,"hr"),xo(8,"div",23),sa(9,"Stats:"),ko(),xo(10,"div",2),Fo(11,"app-icon",24),sa(12),ko(),xo(13,"div",2),Fo(14,"app-icon",24),sa(15),ko(),xo(16,"div",2),Fo(17,"app-icon",24),sa(18),ko(),xo(19,"div",2),Fo(20,"app-icon",16),sa(21),ko(),xo(22,"div",2),Fo(23,"app-icon",24),sa(24),ko(),ko(),ko(),ko()}if(2&e){const e=t.$implicit,i=Ko();Jr(2),$o("src",i.getShipIconPath(e),er),Lo("elementId","ship-"+e)("ngClass",Mc(21,PM,i.dismiss)),Jr(1),oa(" ",i.getAvailableShips(e)," /",i.getTotalShips(e)," "),Jr(1),Qo("id","ship-",e,""),Jr(2),ra(i.getShipName(e)),Jr(5),Lo("name","attack")("path","army"),Jr(1),na(": ",i.getShipStrength(e),""),Jr(2),Lo("name","defense")("path","army"),Jr(1),na(": ",i.getShipDefense(e),""),Jr(2),Lo("name","speed")("path","army"),Jr(1),na(": ",i.getShipSpeed(e),""),Jr(2),Lo("name","cargo"),Jr(1),na(": ",i.getShipCargo(e),""),Jr(2),Lo("name","coins")("path","resources"),Jr(1),na(": ",i.getShipPay(e),"")}}function LM(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),oa(" ",i.getTroopName(e.troop),": ",e.size," ")}}function DM(e,t){if(1&e){const e=Go();xo(0,"div",25),Vo("click",function(){const t=Dt(e).$implicit;return Ko().selectMission(t)}),sa(1),xo(2,"span",21),sa(3),Fo(4,"hr"),sa(5),Fc(6,"number"),Po(7,LM,2,2,"div",11),ko(),ko()}if(2&e){const e=t.$implicit;Lo("elementId","mission-"+e.id),Jr(1),na(" ",e.getMissionName()," "),Jr(1),Qo("id","mission-",e.id,""),Jr(1),na(" ",e.getMissionName()," "),Jr(2),oa(" ",e.getStatus()," : ",Hc(6,7,e.getDisplayProgress(),"0.0-0"),"% "),Jr(2),Lo("ngForOf",e.army.units)}}function xM(e,t){if(1&e){const e=Go();xo(0,"button",26),Vo("click",function(){return Dt(e),Ko().startExpedition()}),sa(1,"EXPEDITION"),ko()}}function kM(e,t){1&e&&(xo(0,"span",27),sa(1,"Discovered land:"),ko())}function FM(e,t){if(1&e){const e=Go();xo(0,"button",16),Vo("click",function(){return Dt(e),Ko().openFestivalModal()}),sa(1,"Organize festival"),ko()}}function UM(e,t){if(1&e&&(xo(0,"span",20),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("(",e.duration,")")}}function HM(e,t){if(1&e&&(xo(0,"div",17),sa(1),Po(2,UM,2,1,"span",18),xo(3,"span",19),sa(4),ko(),ko()),2&e){const e=t.$implicit,i=Ko();Jr(1),ra(i.getEffectName(e.effect)),Jr(1),Lo("ngIf",i.getShowDuration()&&e.duration>0),Jr(2),ra(e.value)}}function GM(e,t){if(1&e&&(xo(0,"span",20),sa(1),ko()),2&e){const e=Ko().$implicit;Jr(1),na("(",e.duration,")")}}function BM(e,t){if(1&e&&(xo(0,"div"),xo(1,"span",21),sa(2),ko(),Po(3,GM,2,1,"span",18),sa(4),ko()),2&e){const e=t.$implicit,i=Ko();Jr(2),ra(e.value),Jr(1),Lo("ngIf",i.getShowDuration()&&e.duration>0),Jr(1),na(" ",i.getEffectName(e.effect),"")}}const WM=function(e,t){return{negativeColor:e,positiveColor:t}},VM=[{path:"",redirectTo:"regions/redirect",pathMatch:"full"},{path:"404",component:CN,pathMatch:"full"},{path:"resources",component:Hb},{path:"crafting",children:[{path:"",redirectTo:"crafting",pathMatch:"full"},{path:"crafting",component:v_,canActivate:[bN]},{path:"cooking",component:bM}]},{path:"market",component:dN,canActivate:[bN]},{path:"research",component:SC,canActivate:[bN]},{path:"army",component:IA,canActivate:[bN]},{path:"religion",component:GA,canActivate:[bN]},{path:"weather",component:IN,canActivate:[bN]},{path:"world",component:EM,canActivate:[bN]},{path:"navy",component:(()=>{class e{constructor(e,t,i,s,r,n){this.navyService=e,this.worldService=t,this.armyService=i,this.modalService=s,this.gameService=r,this.router=n,this.troops=Wf,this.dismiss=!1}ngOnInit(){}getHarbourSpace(){return this.navyService.getHarbourSpace()}getMaxHarbourSpace(){return this.navyService.getMaxHarbourSpace()}getAvailableShips(e){return this.navyService.getAvailableShips(e)}getTotalShips(e){return this.navyService.getTotalShips(e)}getMissions(){return this.worldService.getPlayerSeaMissions()}selectMission(e){this.worldService.setSelectedMission(e),this.router.navigate(["/world"])}getTroopName(e){return Qf.prepareTroopName(e)}getCartographyData(){return this.navyService.getCartographyData()}getNavyPay(){return this.navyService.calculateNavyPay()}getPaydayCounter(){return this.navyService.getPaydayCounter()}startExpedition(){this.modalService.open(Pf.MISSION),this.modalService.setMissionData(new dw(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,null,Uf.EXPEDITION))}isCartographerResearched(){return this.gameService.isEnabled(Mf.CARTOGRAPHER)}getShipsTypes(){return[Wf.BOAT,Wf.BRIGANTINE,Wf.GALLEON]}getShipIconPath(e){return"assets/sea/"+Qf.prepareTroopName(e).toLowerCase()+".svg"}getShipName(e){return Qf.prepareTroopName(e)}getShipStrength(e){return aS.getTroop(e).STRENGTH}getShipDefense(e){return aS.getTroop(e).DEFENSE}getShipSpeed(e){return aS.getTroop(e).SPEED}getShipCargo(e){return aS.getTroop(e).CARGO}getShipPay(e){return aS.getTroop(e).PAY}changeDismiss(e){this.dismiss=e}tryToDismiss(e){this.dismiss&&this.navyService.dismiss(e,1)}}return e.\u0275fac=function(t){return new(t||e)(Mo(yy),Mo(Uw),Mo(Yy),Mo(em),Mo(AS),Mo(af))},e.\u0275cmp=Ve({type:e,selectors:[["app-navy"]],decls:36,vars:23,consts:[["id","wrapper"],["id","title"],[1,"icon"],[3,"name","path","title"],[4,"ngIf"],["id","categories"],[1,"category"],[1,"title"],["id","numbers"],["class","number",3,"click",4,"ngIf"],["class","number active",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["id","missionsScroll"],["class","mission tooltip","appTooltip","",3,"elementId","click",4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["class","title marginTop",4,"ngIf"],[3,"name"],[1,"number",3,"click"],[1,"number","active",3,"click"],[1,"icon","tooltip"],["appTooltip","",3,"src","elementId","ngClass","click"],[3,"id"],[1,"tooltipTitle"],[1,"statsTitle"],[3,"name","path"],["appTooltip","",1,"mission","tooltip",3,"elementId","click"],[3,"click"],[1,"title","marginTop"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),sa(2,"Navy"),ko(),xo(3,"div",2),Fo(4,"app-icon",3),sa(5),Po(6,NM,3,4,"span",4),Fo(7,"app-icon",3),sa(8),ko(),xo(9,"div",5),xo(10,"div",6),xo(11,"span",7),sa(12,"NAVY"),ko(),xo(13,"div",8),Po(14,_M,2,0,"span",9),Po(15,wM,2,0,"span",10),ko(),Po(16,MM,25,23,"div",11),ko(),xo(17,"div",6),xo(18,"span",7),sa(19,"MISSIONS IN PROGRESS"),ko(),xo(20,"div",12),Po(21,DM,8,10,"div",13),ko(),ko(),xo(22,"div",6),xo(23,"span",7),sa(24,"OTHER"),ko(),Po(25,xM,2,0,"button",14),Po(26,kM,2,0,"span",15),xo(27,"span",2),Fo(28,"app-icon",16),sa(29),ko(),xo(30,"span",2),Fo(31,"app-icon",16),sa(32),ko(),xo(33,"span",2),Fo(34,"app-icon",16),sa(35),ko(),ko(),ko(),ko()),2&e&&(Jr(4),Lo("name","port")("path","sea")("title","Ships space"),Jr(1),oa(" ",t.getHarbourSpace(),"/",t.getMaxHarbourSpace()," \xa0\xa0 "),Jr(1),Lo("ngIf",t.isCartographerResearched()),Jr(1),Lo("name","coins")("path","resources")("title","Navy upkeep (collected every 30 days)"),Jr(1),oa("\xa0",t.getNavyPay()," in ",t.getPaydayCounter()+1," days "),Jr(6),Lo("ngIf",!t.dismiss),Jr(1),Lo("ngIf",t.dismiss),Jr(1),Lo("ngForOf",t.getShipsTypes()),Jr(5),Lo("ngForOf",t.getMissions()),Jr(4),Lo("ngIf",t.isCartographerResearched()),Jr(1),Lo("ngIf",t.worldService.getTotalDiscovered()>0),Jr(2),Lo("name","land"),Jr(1),ra(t.worldService.getDiscoveredLand()),Jr(2),Lo("name","forest"),Jr(1),ra(t.worldService.getDiscoveredForest()),Jr(2),Lo("name","mountains"),Jr(1),ra(t.worldService.getDiscoveredMountains()))},directives:[sI,Gu,Uu,rI,ku],pipes:[Zu],styles:["#wrapper[_ngcontent-%COMP%]{margin:.7%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#categories[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:91.5%;text-align:center}.category[_ngcontent-%COMP%]{text-align:center;flex:0 0 33%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.title[_ngcontent-%COMP%]{padding:2px;width:100%;font-weight:bolder;font-size:.9em;margin-bottom:5px;display:block;border-bottom:black solid 1px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#missionsScroll[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;overflow-y:auto;align-items:center}.mission[_ngcontent-%COMP%]{padding:4px;border:black solid 1px;width:80%;cursor:pointer;margin:3px}.tooltipTitle[_ngcontent-%COMP%]{font-weight:bold;padding:0 20px}#numbers[_ngcontent-%COMP%]{margin-top:-6px;padding:0;margin-bottom:5px}.number[_ngcontent-%COMP%]{border:black solid 1px;padding:2px 4px;background-color:var(--passive-colour);font-size:.75em;cursor:pointer}.number[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}.active[_ngcontent-%COMP%]{background-color:var(--active-colour)}.pointer[_ngcontent-%COMP%]{cursor:pointer}.marginTop[_ngcontent-%COMP%]{margin-top:30px}"]}),e})(),canActivate:[bN]},{path:"heritage",component:lw,canActivate:[bN]},{path:"royal",component:GN},{path:"regions",children:[{path:"",redirectTo:"redirect",pathMatch:"full"},{path:"redirect",component:_b,canActivate:[bN]},{path:"village",component:_b,canActivate:[bN]},{path:"fort",component:iN,canActivate:[bN]},{path:"forest",component:kC,canActivate:[bN]},{path:"field",component:JC,canActivate:[bN]},{path:"mountains",component:Ty,canActivate:[bN]},{path:"plateau",component:H_,canActivate:[bN]},{path:"sea",component:Wy,canActivate:[bN]}]},{path:"management",children:[{path:"",redirectTo:"general",pathMatch:"full"},{path:"general",component:A_},{path:"happiness",component:(()=>{class e{constructor(e,t){this.happinessService=e,this.modalService=t}ngOnInit(){}getSum(){return this.happinessService.calculateDailyChange()}getPositiveEffects(){return this.happinessService.getHappinessEffects().filter(e=>e.value>=0)}getNegativeEffects(){return this.happinessService.getHappinessEffects().filter(e=>e.value<0)}getEffectName(e){return Qf.prepareHappinessEffectName(e)}getSumText(){return Qf.round(this.getSum(),2)}getHappinessBonus(){return this.happinessService.getHappinessEffect()}openFestivalModal(){this.modalService.open(Pf.FESTIVAL)}canStartFestival(){return void 0===this.happinessService.getHappinessEffectByEffect($f.FESTIVAL)}getShowDuration(){return this.happinessService.getShowDuration()}toggleShowDuration(){this.happinessService.toggleShowDuration()}}return e.\u0275fac=function(t){return new(t||e)(Mo(Av),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-happiness-management"]],decls:33,vars:14,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],[1,"center"],[3,"ngClass"],["id","showDuration","type","checkbox",3,"checked","change"],["for","showDuration"],["id","festival",3,"click",4,"ngIf"],[1,"headers"],[1,"center","subtitle"],["id","effects"],["id","positive"],["class","changeToRight",4,"ngFor","ngForOf"],["id","negative"],[4,"ngFor","ngForOf"],["id","festival",3,"click"],[1,"changeToRight"],["class","small",4,"ngIf"],[1,"positiveValue"],[1,"small"],[1,"negativeValue"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),Fo(2,"app-management-top-menu"),ko(),xo(3,"div",2),xo(4,"div",3),xo(5,"span"),sa(6,"Happiness"),ko(),ko(),xo(7,"div",4),Fo(8,"app-happiness"),Fo(9,"br"),sa(10," (bonus: "),xo(11,"span",5),sa(12),ko(),sa(13,") "),ko(),xo(14,"div",4),xo(15,"span",5),sa(16),ko(),sa(17," per day "),ko(),Fo(18,"br"),xo(19,"input",6),Vo("change",function(){return t.toggleShowDuration()}),ko(),xo(20,"label",7),sa(21,"show duration in days"),ko(),Po(22,FM,2,0,"button",8),xo(23,"div",9),xo(24,"span",10),sa(25,"Positive Effects"),ko(),xo(26,"span",10),sa(27,"Negative Effects"),ko(),ko(),xo(28,"div",11),xo(29,"div",12),Po(30,HM,5,3,"div",13),ko(),xo(31,"div",14),Po(32,BM,5,3,"div",15),ko(),ko(),ko(),ko()),2&e&&(Jr(11),Lo("ngClass",Lc(8,WM,t.getHappinessBonus()<0,t.getHappinessBonus()>0)),Jr(1),na("",t.getHappinessBonus()," %"),Jr(3),Lo("ngClass",Lc(11,WM,t.getSum()<0,t.getSum()>0)),Jr(1),na("",t.getSumText(),"%"),Jr(3),Lo("checked",t.getShowDuration()),Jr(3),Lo("ngIf",t.canStartFestival()),Jr(8),Lo("ngForOf",t.getPositiveEffects()),Jr(2),Lo("ngForOf",t.getNegativeEffects()))},directives:[O_,hI,ku,Gu,Uu],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#content[_ngcontent-%COMP%]{margin:.5%;height:90%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.5em;font-weight:800}.center[_ngcontent-%COMP%]{text-align:center}.headers[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;margin-bottom:10px}.headers[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 49%}#effects[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;height:78%}#positive[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-right:black solid 4px;font-size:1.5em;padding-right:10px;flex:0 0 49%;align-items:flex-start;height:100%;overflow:auto;direction:rtl}.changeToRight[_ngcontent-%COMP%]{direction:ltr}#negative[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:1.5em;padding-left:10px;flex:0 0 49%;overflow:auto}.positiveValue[_ngcontent-%COMP%]{display:inline-block;width:30px;text-align:center;color:var(--positive-colour)}.negativeValue[_ngcontent-%COMP%]{display:inline-block;width:30px;text-align:center;color:var(--negative-colour)}.positiveColor[_ngcontent-%COMP%]{color:var(--positive-colour)}.negativeColor[_ngcontent-%COMP%]{color:var(--negative-colour)}.subtitle[_ngcontent-%COMP%]{font-size:1.2em;font-weight:bolder}.small[_ngcontent-%COMP%]{font-size:.7em}#festival[_ngcontent-%COMP%]{float:right}"]}),e})()},{path:"effects",component:tw},{path:"forestM",component:rw},{path:"summary",component:AM}]},{path:"**",redirectTo:"regions/village",pathMatch:"full"}];let zM=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({imports:[[Tf.forRoot(VM,{relativeLinkResolution:"legacy"})],Tf]}),e})();const YM=["body"],KM=["*"];let jM=(()=>{class e{constructor(e,t,i){this.rd=e,this.el=t,this.modalService=i,this.param="",this.element=t.nativeElement}ngOnInit(){}ngAfterViewInit(){const e=this;!this.id||(document.body.appendChild(this.element),this.rd.listen(this.element,"click",t=>{const i=t.target;null===i.closest(".modal-body")&&"BUTTON"!==i.tagName&&"path"!==i.tagName&&"IMG"!==i.tagName&&"tutorial-modal"!==e.id&&(this.modalService.sendConfirmationResult(!1),this.modalService.sendCloseSignal(Pf.ALL),e.close())}),this.modalService.add(this))}ngOnDestroy(){this.modalService.remove(this.id),this.element.remove()}open(){this.element.style.display="block",document.body.classList.add("modal-open")}openTutorialWindow(e){const t=this.element.querySelector(".modal-body");t.style.position="absolute",t.style.margin="0",t.style.width=e.width,t.style.top=e.top,t.style.left=e.left,this.element.style.display="block",document.body.classList.add("modal-open")}close(){this.element.style.display="none",document.body.classList.remove("modal-open")}onKeydownHandler(e){"tutorial-modal"!==this.id&&(this.modalService.sendConfirmationResult(!1),this.modalService.sendCloseSignal(Pf.ALL),this.close())}}return e.\u0275fac=function(t){return new(t||e)(Mo(ka),Mo(La),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-modal"]],viewQuery:function(e,t){if(1&e&&il(YM,5),2&e){let e;tl(e=rl())&&(t.body=e)}},hostBindings:function(e,t){1&e&&Vo("keydown.escape",function(e){return t.onKeydownHandler(e)},!1,ur)},inputs:{id:"id"},ngContentSelectors:KM,decls:1,vars:0,template:function(e,t){1&e&&(function(e){const t=Mt()[16][6];if(!t.projection){const i=t.projection=es(e?e.length:1,null),s=i.slice();let r=t.child;for(;null!==r;){const t=e?jo(r,e):0;null!==t&&(s[t]?s[t].projectionNext=r:i[t]=r,s[t]=r),r=r.next}}}(),function(e,t=0,i){const s=Mt(),r=Lt(),n=un(r,20+e,16,null,i||null);null===n.projection&&(n.projection=t),Ht(),64!=(64&n.flags)&&function(e,t,i){Fr(t[11],0,t,i,br(e,i,t),_r(i.parent||t[6],i,t))}(r,s,n)}(0))},encapsulation:2}),e})();const $M=["filterInput"];function QM(e,t){if(1&e){const e=Go();xo(0,"span"),sa(1,"\xa0Number of buildings: "),xo(2,"input",8),Vo("keyup",function(){return Dt(e),Ko().verifyMultiplier()})("ngModelChange",function(t){return Dt(e),Ko().multiplier=t}),ko(),xo(3,"button",9),Vo("click",function(){return Dt(e),Ko().multiplier=1}),sa(4,"reset"),ko(),ko()}if(2&e){const e=Ko();Jr(2),Lo("ngModel",e.multiplier)}}function qM(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(1),ra(" (limit: "+t.getLimit(t.region,e.getBuildingType())+" building)")}}function XM(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(1),ra(" (limit: "+t.getLimit(t.region,e.getBuildingType())+" buildings)")}}function ZM(e,t){if(1&e&&(xo(0,"span",22),sa(1),Fo(2,"app-icon",23),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),na(" ",e.amount," "),Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources")}}function JM(e,t){if(1&e&&(xo(0,"span",22),sa(1),Fo(2,"app-icon",23),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),na(" ",e.amount," "),Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources")}}function eL(e,t){if(1&e&&(xo(0,"div",20),xo(1,"span"),xo(2,"span",16),sa(3,"production input:"),ko(),Fo(4,"br"),Po(5,ZM,3,3,"span",21),ko(),xo(6,"span"),xo(7,"span",16),sa(8,"production output:"),ko(),Fo(9,"br"),Po(10,JM,3,3,"span",21),ko(),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(5),Lo("ngForOf",t.getBuildingSettings(e.getBuildingType()).INPUT_RESOURCES),Jr(5),Lo("ngForOf",t.getBuildingSettings(e.getBuildingType()).OUTPUT_RESOURCES)}}function tL(e,t){if(1&e&&(xo(0,"span",22),Fo(1,"app-icon",23),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("name",i.getResourceName(e))("path","resources")}}function iL(e,t){if(1&e&&(xo(0,"div",20),xo(1,"span"),xo(2,"span",16),sa(3,"can produce:"),ko(),Fo(4,"br"),Po(5,tL,2,2,"span",21),ko(),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(5),Lo("ngForOf",t.getBuildingSettings(e.getBuildingType()).CAN_PRODUCE)}}const sL=function(e){return{notMet:e}};function rL(e,t){if(1&e&&(xo(0,"div"),xo(1,"span",22),xo(2,"span",24),sa(3),ko(),Fo(4,"app-icon",25),ko(),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(2),Lo("ngClass",Mc(3,sL,!t.hasLand(e.getSize()*t.getNumberToBuild(e)))),Jr(1),ra(e.getSize()*t.getNumberToBuild(e)),Jr(1),Lo("name","land")}}function nL(e,t){if(1&e&&(xo(0,"div"),xo(1,"span",22),xo(2,"span",24),sa(3),ko(),Fo(4,"app-icon",25),ko(),ko()),2&e){const e=Ko().$implicit,t=Ko();Jr(2),Lo("ngClass",Mc(3,sL,!t.hasMountains(e.getSize()*t.getNumberToBuild(e)))),Jr(1),ra(e.getSize()*t.getNumberToBuild(e)),Jr(1),Lo("name","mountains")}}function oL(e,t){if(1&e&&(xo(0,"span"),xo(1,"span",22),xo(2,"span",24),sa(3),ko(),Fo(4,"app-icon",23),ko(),ko()),2&e){const e=t.$implicit,i=Ko().$implicit,s=Ko();Jr(2),Lo("ngClass",Mc(4,sL,!s.hasResource(e,s.getNumberToBuild(i)))),Jr(1),ra(e.value*s.getNumberToBuild(i)),Jr(1),Lo("name",s.getResourceName(e.key))("path","resources")}}function aL(e,t){if(1&e){const e=Go();xo(0,"button",26),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().build(t)}),sa(1),ko()}if(2&e){const e=Ko().$implicit,t=Ko();Jr(1),na("Build ",t.getNumberToBuild(e),"")}}function cL(e,t){if(1&e){const e=Go();xo(0,"button",27),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().build(t)}),sa(1),ko()}if(2&e){const e=Ko().$implicit,t=Ko();Lo("disabled",0===t.getNumberToBuild(e)),Jr(1),na("Build ",t.getNumberToBuild(e),"")}}function lL(e,t){if(1&e&&(xo(0,"div",10),xo(1,"div",11),xo(2,"span",12),sa(3),Po(4,qM,2,1,"span",5),Po(5,XM,2,1,"span",5),ko(),xo(6,"div",13),Fo(7,"div",14),Po(8,eL,11,2,"div",15),Po(9,iL,6,1,"div",15),xo(10,"div",16),sa(11,"cost:"),ko(),Po(12,rL,5,5,"div",5),Po(13,nL,5,5,"div",5),Po(14,oL,5,6,"span",17),Fc(15,"keyvalue"),ko(),ko(),Po(16,aL,2,1,"button",18),Po(17,cL,2,2,"button",19),ko()),2&e){const e=t.$implicit,i=Ko();Jr(3),na("",e.getName()," "),Jr(1),Lo("ngIf",1===i.getLimit(i.region,e.getBuildingType())),Jr(1),Lo("ngIf",i.getLimit(i.region,e.getBuildingType())>1),Jr(2),Lo("innerHTML",e.getDescription(),Js),Jr(1),Lo("ngIf",i.hasInputOutputDescription(e.getBuildingType())),Jr(1),Lo("ngIf",i.hasCanProduceDescription(e.getBuildingType())),Jr(3),Lo("ngIf",!e.buildOnMountain()),Jr(1),Lo("ngIf",e.buildOnMountain()),Jr(1),Lo("ngForOf",Uc(15,11,i.getBuildingCostEntries(e))),Jr(2),Lo("ngIf",0!==i.getNumberToBuild(e)&&i.isCostMet(e)),Jr(1),Lo("ngIf",0===i.getNumberToBuild(e)||!i.isCostMet(e))}}let uL=(()=>{class e{constructor(e,t,i,s,r,n,o,a,c,l,u,h,d,g){this.buildingFactoryService=e,this.servicesService=t,this.modalService=i,this.logService=s,this.resourcesService=r,this.landService=n,this.villageService=o,this.fortService=a,this.fieldService=c,this.forestService=l,this.mountainsService=u,this.seaService=h,this.plateauService=d,this.gameService=g,this.filterText="",this.multiplier=1,this.buildings=new Map,this.regions=Kf,this.buildings.set(Kf.VILLAGE,[[new fv,[],0],[new mv,[Mf.HOUSE],0],[new jR,[Mf.LONGHOUSE],0],[new oO,[Mf.TUDOR_HOUSE],0],[new OO,[Mf.SETTLEMENT],0],[new oR,[Mf.BAKERY],0],[new fR,[Mf.TAILOR],0],[new jv,[],0],[new AO,[Mf.BUILDERS_GUILD],1],[new IO,[Mf.SCHOLARS_LAB],0],[new sO,[Mf.KITCHEN],0],[new KR,[Mf.SPECIALISED_PRODUCTION],0],[new $v,[],0],[new DR,[Mf.MARKETPLACE],0],[new CO,[Mf.TAX_COLLECTOR],1],[new RR,[Mf.TAVERN],1],[new Zv,[Mf.SHRINE],1],[new kR,[Mf.CHURCH],1]]),this.buildings.set(Kf.FOREST,[[new Lv,[],0],[new cO,[Mf.PRODUCTION_ZONES],0],[new Wv,[],0],[new eO,[Mf.PRODUCTION_ZONES],0],[new Xv,[Mf.HUNTER],0],[new dR,[Mf.TANNERY],0],[new xv,[Mf.FORESTER],0],[new Hv,[Mf.SAWMILL],0],[new QR,[Mf.PAPER_MILL],0]]),this.buildings.set(Kf.FORT,[[new lR,[Mf.BARRACKS],0],[new hR,[Mf.BARRACKS],0],[new $R,[Mf.BARRACKS],1],[new gR,[Mf.STOCKADE],1],[new SR,[Mf.WOODEN_TOWER],1],[new ER,[Mf.STONE_TOWER],1],[new zR,[Mf.STASH],3]]),this.buildings.set(Kf.FIELD,[[new eR,[Mf.FARM],0],[new nR,[Mf.WINDMILL],0],[new iR,[Mf.FARM],0],[new rR,[Mf.FARM],0],[new yR,[Mf.PASTURE],0],[new NR,[Mf.BUTCHER],0],[new pR,[Mf.COTTON_MILL],0],[new mR,[Mf.BREWERY],0],[new nO,[Mf.CLAY_PIT],0],[new vR,[Mf.WINERY],0],[new tO,[Mf.BARN],0]]),this.buildings.set(Kf.MOUNTAINS,[[new zv,[],0],[new OR,[Mf.GEOLOGIST],0],[new TR,[],0],[new bR,[Mf.PIT_MINE],0],[new xR,[Mf.SMITHY],1],[new _R,[Mf.MINT],0],[new XR,[Mf.DEEP_MINE],0]]),this.buildings.set(Kf.PLATEAU,[[new LR,[],1],[new FR,[],1],[new UR,[],1],[new HR,[],1],[new BR,[],1],[new WR,[],1],[new VR,[],1],[new GR,[],1]]),this.buildings.set(Kf.SEA,[[new cR,[Mf.FISHERS_HUT],0],[new hO,[Mf.BOAT_BUILDER],0],[new mO,[Mf.BOAT_BUILDER],0],[new dO,[Mf.HARBOUR],0],[new EO,[Mf.SHIPYARD],0],[new pO,[Mf.LIGHTHOUSE],1],[new RO,[Mf.CARTOGRAPHER],0]])}ngOnInit(){this.clearFilterObservable.subscribe(()=>{this.filterText="",this.multiplier=1}),this.openEvent.subscribe(()=>{this.filterInputRef.nativeElement.focus()})}build(e){const t=this.getNumberToBuild(e);if(e.buildOnMountain()){if(!this.landService.hasMountains(e.getSize()*t))return this.modalService.info("Not enough mountains to build "+t+" "+e.getName()+"!<br>"+e.getSize()*t+" mountains required but only "+this.landService.getMountains()+" available"),void this.modalService.close(Pf.BUILD)}else if(!this.landService.hasLand(e.getSize()*t))return this.modalService.info("Not enough empty land to build "+t+" "+e.getName()+"!<br>"+e.getSize()*t+" empty land required but only "+this.landService.getLand()+" available"),void this.modalService.close(Pf.BUILD);if(this.resourcesService.decreaseResources(e.getCost(),"Construction",!0,t)){e.buildOnMountain()?this.landService.decreaseMountains(e.getSize()*t):this.landService.decreaseLand(e.getSize()*t);for(let i=0;i<t;i++)switch(this.region){case Kf.VILLAGE:this.villageService.createConstruction(new hv(this.servicesService,this.servicesService.getIdService().getNextId(),Kf.VILLAGE,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Kf.FORT:this.fortService.createConstruction(new hv(this.servicesService,this.servicesService.getIdService().getNextId(),Kf.FORT,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Kf.FOREST:this.forestService.createConstruction(new hv(this.servicesService,this.servicesService.getIdService().getNextId(),Kf.FOREST,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Kf.FIELD:this.fieldService.createConstruction(new hv(this.servicesService,this.servicesService.getIdService().getNextId(),Kf.FIELD,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Kf.MOUNTAINS:this.mountainsService.createConstruction(new hv(this.servicesService,this.servicesService.getIdService().getNextId(),Kf.MOUNTAINS,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Kf.SEA:this.seaService.createConstruction(new hv(this.servicesService,this.servicesService.getIdService().getNextId(),Kf.SEA,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Kf.PLATEAU:this.plateauService.createConstruction(new hv(this.servicesService,this.servicesService.getIdService().getNextId(),Kf.PLATEAU,e.getBuildingType(),e.getComplexity(),e.getSize()).build())}this.modalService.close(Pf.BUILD)}else this.modalService.close(Pf.BUILD)}ngOnChanges(e){this.regionString=Kf[this.region]}checkBuilding(e,t){let i=!0;return e[1].forEach(e=>{this.gameService.isEnabled(e)||(i=!1)}),e[2]>0&&e[2]<=this.servicesService.getServiceByRegion(t).getBuildings().filter(t=>t.getBuildingType()===e[0].getBuildingType()||t.getBuildingType()===Lf.CONSTRUCTION&&t.getWorkingAt()===e[0].getBuildingType()).length&&(i=!1),i}hasResource(e,t=1){return 0===this.resourcesService.hasResource(e.key,e.value*t,"Construction",!0)}getResourceName(e){return Qf.prepareResourceName(e)}getBuildingCostEntries(e){return e.getCost()}getBuildingForRegion(e){if(this.buildings&&this.buildings.get(e)){let t=this.buildings.get(e).filter(t=>this.checkBuilding(t,e)).map(e=>e[0]);if(e===Kf.PLATEAU){if(this.gameService.getAbdicationLevel()<this.servicesService.getServiceByRegion(e).getBuildings().length)return[];this.gameService.getAbdicationLevel()<7&&(t=t.filter(e=>e.getBuildingType()!==Lf.ASCENSION_TEMPLE))}return null!==this.filterText&&this.filterText.length>0?t.filter(e=>e.getName().toLowerCase().includes(this.filterText.toLowerCase())):t}}isCostMet(e){let t=!0;const i=this.getNumberToBuild(e);return Array.from(e.getCost().entries()).forEach(e=>{0!==this.resourcesService.hasResource(e[0],e[1]*i,"Construction",!0)&&(t=!1)}),t&&(t=e.buildOnMountain()?this.hasMountains(e.getSize()*i):this.hasLand(e.getSize()*i)),t}hasLand(e){return this.landService.hasLand(e)}hasMountains(e){return this.landService.getMountains()>=e}getLimit(e,t){const i=this.buildings.get(e).find(e=>e[0].getBuildingType()===t);return i?i[2]:0}hasInputOutputDescription(e){return this.getBuildingSettings(e).INPUT_RESOURCES}getBuildingSettings(e){return nS.getBuilding(e)}hasCanProduceDescription(e){return this.getBuildingSettings(e).CAN_PRODUCE}getNumberToBuild(e){const t=this.buildings.get(this.region).find(t=>t[0].getBuildingType()===e.getBuildingType());if(0===t[2])return Math.trunc(this.multiplier);{const e=this.servicesService.getServiceByRegion(this.region).getBuildings().filter(e=>e.getBuildingType()===t[0].getBuildingType()||e.getBuildingType()===Lf.CONSTRUCTION&&e.getWorkingAt()===t[0].getBuildingType()).length;return t[2]-e<this.multiplier?t[2]-e:Math.trunc(this.multiplier)}}verifyMultiplier(){null!==this.multiplier&&(this.multiplier=Math.trunc(this.multiplier),0===this.multiplier&&(this.multiplier=1))}}return e.\u0275fac=function(t){return new(t||e)(Mo(_O),Mo(Jf),Mo(em),Mo(IS),Mo(Pv),Mo(NS),Mo(wO),Mo(Ky),Mo(FC),Mo(EC),Mo(ey),Mo(Iy),Mo(N_),Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-construction"]],viewQuery:function(e,t){if(1&e&&il($M,5),2&e){let e;tl(e=rl())&&(t.filterInputRef=e.first)}},inputs:{region:"region",clearFilterObservable:"clearFilterObservable",openEvent:"openEvent"},features:[ct],decls:11,vars:6,consts:[["id","wrapper"],["id","title"],["id","filters"],["type","text",3,"ngModel","ngModelChange"],["filterInput",""],[4,"ngIf"],["id","buildings"],["class","building",4,"ngFor","ngForOf"],["id","multiplierInput","type","number","min","1","step","1",3,"ngModel","keyup","ngModelChange"],["id","multiplierReset",3,"click"],[1,"building"],[1,"buildingSecondRow"],[1,"buildingTitle"],[1,"details"],["id","description",3,"innerHTML"],["class","productionDescription",4,"ngIf"],[1,"subTitle"],[4,"ngFor","ngForOf"],["class","buildButton",3,"click",4,"ngIf"],["class","buildButtonNotAvailable",3,"disabled","click",4,"ngIf"],[1,"productionDescription"],["class","icon",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","path"],[3,"ngClass"],[3,"name"],[1,"buildButton",3,"click"],[1,"buildButtonNotAvailable",3,"disabled","click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),sa(2),Fc(3,"titlecase"),ko(),xo(4,"span",2),sa(5,"Search: "),xo(6,"input",3,4),Vo("ngModelChange",function(e){return t.filterText=e}),ko(),Po(8,QM,5,1,"span",5),ko(),xo(9,"div",6),Po(10,lL,18,13,"div",7),ko(),ko()),2&e&&(Jr(2),na(" ",Uc(3,4,t.regionString)," buildings "),Jr(4),Lo("ngModel",t.filterText),Jr(2),Lo("ngIf",t.region!==t.regions.PLATEAU),Jr(2),Lo("ngForOf",t.getBuildingForRegion(t.region)))},directives:[KO,dT,MT,Gu,Uu,JT,DT,sI,ku],pipes:[Qu,qu],styles:[".notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.5em;margin-bottom:10px}#filters[_ngcontent-%COMP%]{display:inline-block;width:100%;margin-bottom:5px;border-bottom:black solid 2px}#filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block}#buildings[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;overflow-y:scroll;height:70vh}.building[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 1px;margin-bottom:10px}.buildingTitle[_ngcontent-%COMP%]{font-weight:600;background-color:var(--active-colour);border-bottom:black solid 1px}.buildingSecondRow[_ngcontent-%COMP%]{display:flex;width:100%;border-right:black solid 1px;flex-direction:column}.buildButton[_ngcontent-%COMP%]{width:30%}.buildButtonNotAvailable[_ngcontent-%COMP%]{width:30%;cursor:not-allowed}.details[_ngcontent-%COMP%]{width:100%;text-align:center}.resourceIcon[_ngcontent-%COMP%]{height:20px;width:20px;vertical-align:middle}#description[_ngcontent-%COMP%]{margin-bottom:10px}.icon[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;align-items:center;justify-content:center;margin-right:10px}.subTitle[_ngcontent-%COMP%]{font-size:1em;font-weight:bold}.productionDescription[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-bottom:5px}.productionDescription[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:5px}#actions[_ngcontent-%COMP%]{display:flex;flex-direction:column}#multiplierInput[_ngcontent-%COMP%]{width:5ch}#multiplierReset[_ngcontent-%COMP%]{padding:2px}"]}),e})();const hL=["body"];let dL=(()=>{class e{constructor(e){this.modalService=e,this.constructionOpenEventEmitter=new Vc,this.clearFilterSubject=new b,this.modalService.registerForRegion().subscribe(e=>{this.region=e,this.clearFilterSubject.next()}),this.modalService.registerForOnOpen().subscribe(e=>{e===Pf.BUILD&&(this.bodyRef.nativeElement.scrollTop=0,this.constructionOpenEventEmitter.next())})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-build-modal"]],viewQuery:function(e,t){if(1&e&&il(hL,5),2&e){let e;tl(e=rl())&&(t.bodyRef=e.first)}},decls:6,vars:3,consts:[["id","build-modal"],[1,"modal"],[1,"modal-body"],["body",""],[3,"openEvent","clearFilterObservable","region"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2,3),Fo(4,"app-construction",4),ko(),ko(),Fo(5,"div",5),ko()),2&e&&(Jr(4),Lo("openEvent",t.constructionOpenEventEmitter.asObservable())("clearFilterObservable",t.clearFilterSubject.asObservable())("region",t.region))},directives:[jM,uL],styles:[""]}),e})();class gL{constructor(e,t){this.message=e,this.fullError=t}}let pL=(()=>{class e{constructor(e,t,i,s,r,n,o){this.servicesService=e,this.calendarService=t,this.logService=i,this.idService=s,this.mountainService=r,this.resourcesService=n,this.villageService=o,this.gameService=null,this.gameService=e.getGameService(),t.registerForDayChange().subscribe(e=>{this.checkEvents()})}checkEvents(){Object.values(fS).forEach(e=>{let t=!0;if(e.PREREQUISITES.forEach(e=>{this.gameService.isEnabled(e)||(t=!1)}),t&&am.chance(e.CHANCE)){this.logService.customLog(e.LOG.MESSAGE,e.LOG.LOG_TYPE);const t=am.randomBetween(e.MIN_POWER,e.MAX_POWER);switch(e.EVENT){case um.METEORITE:{let e=am.randomElement([{item:Df.STONE,chance:35},{item:Df.COPPER_ORE,chance:30},{item:Df.TIN_ORE,chance:20},{item:Df.GOLD_ORE,chance:5},{item:Df.SILVER_ORE,chance:5},{item:Df.IRON_ORE,chance:5}]);null===e&&(e=Df.STONE),this.mountainService.buildings.push(new uO(this.servicesService,this.idService.getNextId(),t,e));break}case um.SMALL_REFUGEE:case um.MEDIUM_REFUGEE:this.addVillagers(t)}}})}addVillagers(e){this.servicesService.getVillageService().addVillagers(e)}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf),gs(OS),gs(IS),gs(NO),gs(ey),gs(Pv),gs(wO))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),fL=(()=>{class e{constructor(e,t,i,s,r,n,o,a,c,l,u,h,d,g,p,f,m,S,E,v,R){this.logService=e,this.villageService=t,this.fortService=i,this.fieldService=s,this.mountainsService=r,this.plateauService=n,this.seaService=o,this.forestService=a,this.calendarService=c,this.landService=l,this.techService=u,this.weatherService=h,this.resourcesService=d,this.gameService=g,this.effectsService=p,this.armyService=f,this.happinessService=m,this.worldService=S,this.servicesService=E,this.navyService=v,this.eventService=R,this.tickerState=0,this.lastTick=0,this.paused=!1,this.ticking=!1,this.resolution=750,E.addService(Zf.TICKER,this),this.tickSubject=new b,this.interval=setInterval(()=>this.tick(),this.resolution)}tick(){if(!this.ticking){this.ticking=!0;const t=Math.floor(Date.now()/this.resolution);if(this.tickerState>=0){this.lastTick=t;try{this.calendarService.tick(t),this.effectsService.tick(t),this.weatherService.tick(t),this.happinessService.tick(t),this.landService.tick(t),this.resourcesService.tick(t),this.gameService.tick(t),this.villageService.tick(t),this.fortService.tick(t),this.fieldService.tick(t),this.mountainsService.tick(t),this.plateauService.tick(t),this.seaService.tick(t),this.forestService.tick(t),this.armyService.tick(t),this.navyService.tick(t),this.worldService.tick(t)}catch(e){this.logService.warning("Game paused due to the internal error: "+e.name),this.logService.errorReport(new gL("Game paused due to the internal error: "+e.name,e.name+": "+e.message+"\n"+e.stack)),console.error(e),this.pause()}}this.ticking=!1}}stop(){return this.tickerState-=1,this.lastTick}start(){this.tickerState+=1,this.tickerState>0&&(this.tickerState=0)}forceStart(){this.tickerState=0}clearTicker(){clearInterval(this.interval)}initTicker(){this.interval=setInterval(()=>this.tick(),this.resolution)}pause(){this.stop(),this.paused=!0}resume(){this.forceStart(),this.paused=!1}isPaused(){return this.paused}}return e.\u0275fac=function(t){return new(t||e)(gs(IS),gs(wO),gs(Ky),gs(FC),gs(ey),gs(N_),gs(Iy),gs(EC),gs(OS),gs(NS),gs(Wb),gs(gN),gs(Pv),gs(AS),gs(bS),gs(Yy),gs(Av),gs(Uw),gs(Jf),gs(yy),gs(pL))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class mL{}class SL{}class EL{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(e=>{const t=e.indexOf(":");if(t>0){const i=e.slice(0,t),s=i.toLowerCase(),r=e.slice(t+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(r):this.headers.set(s,[r])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const s=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(s,i),this.maybeSetNormalizedName(t,s))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof EL?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new EL;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof EL?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const s=("a"===e.op?this.headers.get(t):void 0)||[];s.push(...i),this.headers.set(t,s);break;case"d":const r=e.value;if(r){let e=this.headers.get(t);if(!e)return;e=e.filter(e=>-1===r.indexOf(e)),0===e.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,e)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class vL{encodeKey(e){return RL(e)}encodeValue(e){return RL(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}function RL(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}function OL(e){return`${e}`}class TL{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new vL,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){const i=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(e=>{const s=e.indexOf("="),[r,n]=-1==s?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,s)),t.decodeValue(e.slice(s+1))],o=i.get(r)||[];o.push(n),i.set(r,o)}),i}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const s=e[i];Array.isArray(s)?s.forEach(e=>{t.push({param:i,value:e,op:"a"})}):t.push({param:i,value:s,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(e=>t+"="+this.encoder.encodeValue(e)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new TL({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(OL(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let t=this.map.get(e.param)||[];const i=t.indexOf(OL(e.value));-1!==i&&t.splice(i,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class IL{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function bL(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function CL(e){return"undefined"!=typeof Blob&&e instanceof Blob}function yL(e){return"undefined"!=typeof FormData&&e instanceof FormData}class AL{constructor(e,t,i,s){let r;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==i?i:null,r=s):r=i,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.context&&(this.context=r.context),r.params&&(this.params=r.params)),this.headers||(this.headers=new EL),this.context||(this.context=new IL),this.params){const e=this.params.toString();if(0===e.length)this.urlWithParams=t;else{const i=t.indexOf("?");this.urlWithParams=t+(-1===i?"?":i<t.length-1?"&":"")+e}}else this.params=new TL,this.urlWithParams=t}serializeBody(){return null===this.body?null:bL(this.body)||CL(this.body)||yL(this.body)||function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof TL?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||yL(this.body)?null:CL(this.body)?this.body.type||null:bL(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof TL?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,s=e.url||this.url,r=e.responseType||this.responseType,n=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const u=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((t,i)=>t.set(i,e.setHeaders[i]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((t,i)=>t.set(i,e.setParams[i]),l)),new AL(i,s,n,{params:l,headers:c,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var NL=(()=>((NL=NL||{})[NL.Sent=0]="Sent",NL[NL.UploadProgress=1]="UploadProgress",NL[NL.ResponseHeader=2]="ResponseHeader",NL[NL.DownloadProgress=3]="DownloadProgress",NL[NL.Response=4]="Response",NL[NL.User=5]="User",NL))();class _L{constructor(e,t=200,i="OK"){this.headers=e.headers||new EL,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class wL extends _L{constructor(e={}){super(e),this.type=NL.ResponseHeader}clone(e={}){return new wL({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class PL extends _L{constructor(e={}){super(e),this.type=NL.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new PL({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ML extends _L{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function LL(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let DL=(()=>{class e{constructor(e){this.handler=e}request(e,t,i={}){let s;if(e instanceof AL)s=e;else{let r,n;r=i.headers instanceof EL?i.headers:new EL(i.headers),i.params&&(n=i.params instanceof TL?i.params:new TL({fromObject:i.params})),s=new AL(e,t,void 0!==i.body?i.body:null,{headers:r,context:i.context,params:n,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const r=xh(s).pipe(hd(e=>this.handler.handle(e)));if(e instanceof AL||"events"===i.observe)return r;const n=r.pipe(nd(e=>e instanceof PL));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return n.pipe(A(e=>{if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return n.pipe(A(e=>{if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return n.pipe(A(e=>{if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return n.pipe(A(e=>e.body))}case"response":return n;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:(new TL).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,i={}){return this.request("PATCH",e,LL(i,t))}post(e,t,i={}){return this.request("POST",e,LL(i,t))}put(e,t,i={}){return this.request("PUT",e,LL(i,t))}}return e.\u0275fac=function(t){return new(t||e)(gs(mL))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class xL{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const kL=new ji("HTTP_INTERCEPTORS");let FL=(()=>{class e{intercept(e,t){return t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const UL=/^\)\]\}',?\n/;let HL=(()=>{class e{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new v(t=>{const i=this.xhrFactory.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((e,t)=>i.setRequestHeader(e,t.join(","))),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const t=e.detectContentTypeHeader();null!==t&&i.setRequestHeader("Content-Type",t)}if(e.responseType){const t=e.responseType.toLowerCase();i.responseType="json"!==t?t:"text"}const s=e.serializeBody();let r=null;const n=()=>{if(null!==r)return r;const t=1223===i.status?204:i.status,s=i.statusText||"OK",n=new EL(i.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(i)||e.url;return r=new wL({headers:n,status:t,statusText:s,url:o}),r},o=()=>{let{headers:s,status:r,statusText:o,url:a}=n(),c=null;204!==r&&(c=void 0===i.response?i.responseText:i.response),0===r&&(r=c?200:0);let l=r>=200&&r<300;if("json"===e.responseType&&"string"==typeof c){const e=c;c=c.replace(UL,"");try{c=""!==c?JSON.parse(c):null}catch(u){c=e,l&&(l=!1,c={error:u,text:c})}}l?(t.next(new PL({body:c,headers:s,status:r,statusText:o,url:a||void 0})),t.complete()):t.error(new ML({error:c,headers:s,status:r,statusText:o,url:a||void 0}))},a=e=>{const{url:s}=n(),r=new ML({error:e,status:i.status||0,statusText:i.statusText||"Unknown Error",url:s||void 0});t.error(r)};let c=!1;const l=s=>{c||(t.next(n()),c=!0);let r={type:NL.DownloadProgress,loaded:s.loaded};s.lengthComputable&&(r.total=s.total),"text"===e.responseType&&!!i.responseText&&(r.partialText=i.responseText),t.next(r)},u=e=>{let i={type:NL.UploadProgress,loaded:e.loaded};e.lengthComputable&&(i.total=e.total),t.next(i)};return i.addEventListener("load",o),i.addEventListener("error",a),i.addEventListener("timeout",a),i.addEventListener("abort",a),e.reportProgress&&(i.addEventListener("progress",l),null!==s&&i.upload&&i.upload.addEventListener("progress",u)),i.send(s),t.next({type:NL.Sent}),()=>{i.removeEventListener("error",a),i.removeEventListener("abort",a),i.removeEventListener("load",o),i.removeEventListener("timeout",a),e.reportProgress&&(i.removeEventListener("progress",l),null!==s&&i.upload&&i.upload.removeEventListener("progress",u)),i.readyState!==i.DONE&&i.abort()}})}}return e.\u0275fac=function(t){return new(t||e)(gs(rh))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const GL=new ji("XSRF_COOKIE_NAME"),BL=new ji("XSRF_HEADER_NAME");class WL{}let VL=(()=>{class e{constructor(e,t,i){this.doc=e,this.platform=t,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=xu(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return e.\u0275fac=function(t){return new(t||e)(gs(cu),gs(pl),gs(GL))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),zL=(()=>{class e{constructor(e,t){this.tokenService=e,this.headerName=t}intercept(e,t){const i=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||i.startsWith("http://")||i.startsWith("https://"))return t.handle(e);const s=this.tokenService.getToken();return null!==s&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,s)})),t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(gs(WL),gs(BL))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),YL=(()=>{class e{constructor(e,t){this.backend=e,this.injector=t,this.chain=null}handle(e){if(null===this.chain){const e=this.injector.get(kL,[]);this.chain=e.reduceRight((e,t)=>new xL(e,t),this.backend)}return this.chain.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(gs(SL),gs(go))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),KL=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:zL,useClass:FL}]}}static withOptions(t={}){return{ngModule:e,providers:[t.cookieName?{provide:GL,useValue:t.cookieName}:[],t.headerName?{provide:BL,useValue:t.headerName}:[]]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({providers:[zL,{provide:kL,useExisting:zL,multi:!0},{provide:WL,useClass:VL},{provide:GL,useValue:"XSRF-TOKEN"},{provide:BL,useValue:"X-XSRF-TOKEN"}]}),e})(),jL=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({providers:[DL,{provide:mL,useClass:YL},HL,{provide:SL,useExisting:HL}],imports:[[KL.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})();const $L=(()=>{function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e})();class QL{constructor(e,t,i,s){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=i,this.scheduler=s}call(e,t){return t.subscribe(new qL(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}class qL extends U{constructor(e,t,i,s,r){super(e),this.absoluteTimeout=t,this.waitFor=i,this.withObservable=s,this.scheduler=r,this.scheduleTimeout()}static dispatchTimeout(e){const{withObservable:t}=e;e._unsubscribeAndRecycle(),e.add(H(t,new F(e)))}scheduleTimeout(){const{action:e}=this;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(qL.dispatchTimeout,this.waitFor,this))}_next(e){this.absoluteTimeout||this.scheduleTimeout(),super._next(e)}_unsubscribe(){this.action=void 0,this.scheduler=null,this.withObservable=null}}function XL(e,t=qS){return function(e,t,i=qS){return s=>{let r=function(e){return e instanceof Date&&!isNaN(+e)}(e),n=r?+e-i.now():Math.abs(e);return s.lift(new QL(n,r,t,i))}}(e,nE(new $L),t)}let ZL=(()=>{class e{constructor(e,t,i){this.http=e,this.logService=t,this.modalService=i,this.serverUrl="https://villagerkings.com/api/"}cloudSave(e,t,i,s,r){const n={headers:(new EL).append("Content-Type","application/json").append("Access-Control-Allow-Origin","*")},o={};return o.userId=e,o.gameAuthToken=t,o.save=i,o.day=s,o.year=r,this.http.post(this.serverUrl+"save",o,n).pipe(XL(15e3),cd(e=>this.handleError(e)))}cloudLoad(e,t){const i={headers:(new EL).append("Content-Type","application/json").append("Access-Control-Allow-Origin","*"),observe:"response",responseType:"text"},s={};return s.userId=e,s.gameAuthToken=t,this.http.post(this.serverUrl+"load",s,i).pipe(XL(15e3),cd(e=>this.handleError(e)))}cloudCheck(e=!1,t,i){const s={headers:(new EL).append("Content-Type","application/json").append("Access-Control-Allow-Origin","*"),observe:"response"},r={};return r.userId=t,r.gameAuthToken=i,this.http.post(this.serverUrl+"hasSave",r,s).pipe(XL(5e3),cd(t=>this.handleError(t,!e)))}handleError(e,t=!0){return e instanceof ML?401===e.status?(t?this.modalService.info("Couldn't authorize server call via Kongregate API"):this.logService.warning("Couldn't authorize server call via Kongregate API"),Yh):(console.log("error",e),e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error(`Backend returned code ${e.status}`),t&&this.modalService.info("Something bad happened; please try again later."),nE("Something bad happened; please try again later.")):e instanceof $L?(t?this.modalService.info("Server request has timed out"):this.logService.warning("Server request has timed out"),Yh):void 0}}return e.\u0275fac=function(t){return new(t||e)(gs(DL),gs(IS),gs(em))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),JL=(()=>{class e{constructor(e,t,i,s,r,n,o,a,c,l,u,h,d,g,p,f,m,S,E,v,R,O,T,I,b,C,y,A,N,_,w,P,M,L,D){this.router=e,this.tickerService=t,this.gameService=i,this.modalService=s,this.optionsService=r,this.logService=n,this.villageService=o,this.forestService=a,this.resourcesService=c,this.landService=l,this.mountainsService=u,this.calendarService=h,this.royalService=d,this.techService=g,this.religionService=p,this.craftingService=f,this.recipeService=m,this.fieldService=S,this.plateauService=E,this.seaService=v,this.fortService=R,this.effectsService=O,this.armyService=T,this.happinessService=I,this.managementService=b,this.marketService=C,this.weatherService=y,this.idService=A,this.heritageService=N,this.tutorialService=_,this.worldService=w,this.kongregateService=P,this.serverService=M,this.navyService=L,this.saveName=Am.saveName,this.saveVersion=Am.saveVersion,D.addService(Zf.SERIALIZER,this),this.autoSaveStatus=this.optionsService.getOption(Xf.AUTO_SAVE_STATUS),this.autoSavePeriod=this.optionsService.getOption(Xf.AUTO_SAVE_PERIOD),this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(()=>this.changeOptions())),this.saveInterval=setInterval(()=>{this.initSave(),this.logService.autoSave()},this.autoSavePeriod)}changeOptions(){const e=this.optionsService.getOption(Xf.AUTO_SAVE_STATUS),t=this.optionsService.getOption(Xf.AUTO_SAVE_PERIOD);(this.autoSaveStatus!==e||this.autoSavePeriod!==t)&&(this.autoSaveStatus=e,this.autoSavePeriod=t,clearInterval(this.saveInterval),this.autoSaveStatus&&(this.saveInterval=setInterval(()=>{this.initSave(),this.logService.autoSave()},1e3*this.autoSavePeriod*60)))}initSave(){this.tickerService.stop(),localStorage.setItem(this.saveName,this.prepareBase64()),this.tickerService.start()}prepareBase64(){this.tickerService.stop();const e=btoa(JSON.stringify({saveVersion:this.saveVersion,heritage:this.heritageService.save(),id:this.idService,options:this.optionsService.save(),tutorial:this.tutorialService.save(),resources:this.resourcesService.save(),village:this.villageService.save(),fort:this.fortService.save(),forest:this.forestService.save(),field:this.fieldService.save(),mountains:this.mountainsService.save(),plateau:this.plateauService.save(),sea:this.seaService.save(),land:this.landService.save(),calendar:this.calendarService.save(),game:this.gameService.save(),royal:this.royalService.save(),tech:this.techService.save(),religion:this.religionService.save(),crafting:this.craftingService.save(),recipe:this.recipeService.save(),effects:this.effectsService.save(),army:this.armyService.save(),world:this.worldService.save(),happiness:this.happinessService.save(),management:this.managementService.save(),market:this.marketService.save(),navy:this.navyService.save(),weather:this.weatherService.save(),logs:this.logService.save()}));return this.tickerService.start(),e}initLoad(){if(this.tickerService.stop(),null===localStorage.getItem(this.saveName))return this.modalService.info("There is no any save file to load."),void this.tickerService.start();let e;try{e=JSON.parse(atob(localStorage.getItem(this.saveName)))}catch(t){return this.modalService.info("Save data is corrupted! Loading failed."),void this.tickerService.start()}this.loadSave(e),this.tickerService.start(),this.logService.log("loaded")}hasSave(){return null!=localStorage.getItem(this.saveName)}import(e){let t;this.tickerService.stop();try{t=JSON.parse(atob(e))}catch(i){return this.modalService.info("Import file is not valid or corrupted! Import failed."),void this.tickerService.start()}this.loadSave(t),localStorage.setItem(this.saveName,e),this.tickerService.start(),this.logService.log("save imported")}hardReset(){this.reset(!0),localStorage.removeItem(this.saveName)}ascensionReset(){this.reset(!1,!0)}reset(e,t=!1){this.tickerService.stop(),this.tickerService.clearTicker(),localStorage.removeItem(this.saveName),this.tutorialService.reset(e,t),this.calendarService.reset(e,t),this.gameService.reset(e,t),this.idService.reset(e,t),this.weatherService.reset(e,t),this.effectsService.reset(e,t),this.resourcesService.reset(e,t),this.landService.reset(e,t),this.navyService.reset(e,t),this.villageService.reset(e,t),this.fortService.reset(e,t),this.forestService.reset(e,t),this.fieldService.reset(e,t),this.mountainsService.reset(e,t),this.plateauService.reset(e,t),this.seaService.reset(e,t),this.optionsService.reset(e,t),this.techService.reset(e,t),this.religionService.reset(e,t),this.craftingService.reset(e,t),this.recipeService.reset(e,t),this.armyService.reset(e,t),this.worldService.reset(e,t),this.happinessService.reset(e,t),this.managementService.reset(e,t),this.marketService.reset(e,t),this.heritageService.reset(e,t),this.logService.reset(e,t),this.royalService.reset(e,t),this.initSave(),this.tickerService.initTicker(),this.tickerService.start(),this.router.navigate(["/village"])}loadSave(e){switch(e.saveVersion){case tm.DEV:case tm.V1_0_0:this.loadDevVersion(e);break;default:const t="Corrupted save file (unknown save version). Loading is not possible";return this.logService.log(t),void console.error(t)}}loadDevVersion(e){this.saveVersion=e.saveVersion,this.safeLoad(this.idService,e.id),this.safeLoad(this.optionsService,e.options),this.safeLoad(this.logService,e.logs),this.safeLoad(this.effectsService,e.effects),this.safeLoad(this.resourcesService,e.resources),this.safeLoad(this.villageService,e.village),this.safeLoad(this.fortService,e.fort),this.safeLoad(this.forestService,e.forest),this.safeLoad(this.fieldService,e.field),this.safeLoad(this.mountainsService,e.mountains),this.safeLoad(this.plateauService,e.plateau),this.safeLoad(this.seaService,e.sea),this.safeLoad(this.landService,e.land),this.safeLoad(this.calendarService,e.calendar),this.safeLoad(this.gameService,e.game),this.safeLoad(this.royalService,e.royal),this.safeLoad(this.recipeService,e.recipe),this.safeLoad(this.techService,e.tech),this.safeLoad(this.religionService,e.religion),this.safeLoad(this.craftingService,e.crafting),this.safeLoad(this.armyService,e.army),this.safeLoad(this.worldService,e.world),this.safeLoad(this.navyService,e.navy),this.safeLoad(this.happinessService,e.happiness),this.safeLoad(this.managementService,e.management),this.safeLoad(this.marketService,e.market),this.safeLoad(this.weatherService,e.weather),this.safeLoad(this.heritageService,e.heritage),this.safeLoad(this.tutorialService,e.tutorial)}safeLoad(e,t){try{e.load(void 0!==t?t:{})}catch(i){e!==this.royalService&&(this.logService.errorReport(new gL("Error ("+i.name+") while loading "+e.getName()+"! It will reset to default values",i.name+": "+i.message+"\n"+i.stack)),console.error(i),e.reset(!0,!0))}}abdicate(e,t){this.reset(!1,!1),this.tickerService.stop(),this.tickerService.clearTicker(),e&&(this.landService.reset(!1,!1),this.worldService.reset(!0,!1)),this.tickerService.initTicker(),this.tickerService.start()}getTimestamp(){return(new Date).getTime()}cloudSave(e,t,i){if(this.kongregateService.isGuest()&&!Wl())this.modalService.info("You must be logged into kongregate to use cloud save");else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to upload save to cloud? Current cloud save will be overridden");const s=this.modalService.registerForConfirmation().subscribe(r=>{if(s.unsubscribe(),r){i.timestamp=this.getTimestamp(),e.status=!0,this.tickerService.stop();const s=this.prepareBase64(),r=this.calendarService.getDay(),n=this.calendarService.getYear();this.tickerService.start(),Wl()?this.serverService.cloudSave(392444,"93ba2bd2f335d13f4c9a66447ae22d3db04670c596fd87b6e6424f870d9504b1",s,r,n).subscribe(e=>{this.logService.success("saved to cloud"),this.modalService.info("Saved to cloud!"),t.day=r,t.year=n}).add(()=>{e.status=!1}):this.serverService.cloudSave(this.kongregateService.getUserId(),this.kongregateService.getGameAuthToken(),s,r,n).subscribe(e=>{this.logService.success("saved to cloud"),this.modalService.info("Saved to cloud!"),t.day=r,t.year=n}).add(()=>{e.status=!1})}})}}cloudLoad(e,t){if(this.kongregateService.isGuest()&&!Wl())this.modalService.info("You must be logged into kongregate to use cloud save");else{this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to download cloud save? Current game progress will be overridden");const i=this.modalService.registerForConfirmation().subscribe(s=>{i.unsubscribe(),s&&(t.timestamp=this.getTimestamp(),e.status=!0,Wl()?this.serverService.cloudLoad(392444,"93ba2bd2f335d13f4c9a66447ae22d3db04670c596fd87b6e6424f870d9504b1").subscribe(e=>{204===e.status?this.modalService.info("There is no save file available on the server"):(this.import(e.body),this.modalService.info("Loaded save file from cloud"))}).add(()=>{e.status=!1}):this.serverService.cloudLoad(this.kongregateService.getUserId(),this.kongregateService.getGameAuthToken()).subscribe(e=>{204===e.status?this.modalService.info("There is no save file available on the server"):(this.import(e.body),this.modalService.info("Loaded save file from cloud"))}).add(()=>{e.status=!1}))})}}cloudCheck(e=!1,t,i,s){this.kongregateService.isGuest()&&!Wl()?e||this.modalService.info("You must be logged into kongregate to use cloud save"):(s.timestamp=this.getTimestamp(),t.status=!0,Wl()?this.serverService.cloudCheck(e,392444,"93ba2bd2f335d13f4c9a66447ae22d3db04670c596fd87b6e6424f870d9504b1").subscribe(e=>{204===e.status?i.day=-1:(i.day=e.body.day,i.year=e.body.year)},()=>{i.day=-1}).add(()=>{t.status=!1}):this.serverService.cloudCheck(e,this.kongregateService.getUserId(),this.kongregateService.getGameAuthToken()).subscribe(e=>{204===e.status?i.day=-1:(i.day=e.body.day,i.year=e.body.year)},()=>{i.day=-1}).add(()=>{t.status=!1}))}}return e.\u0275fac=function(t){return new(t||e)(gs(af),gs(fL),gs(AS),gs(em),gs(vS),gs(IS),gs(wO),gs(EC),gs(Pv),gs(NS),gs(ey),gs(OS),gs(_v),gs(Wb),gs(CA),gs(zN),gs(VN),gs(FC),gs(N_),gs(Iy),gs(Ky),gs(bS),gs(Yy),gs(Av),gs(PO),gs(rN),gs(gN),gs(NO),gs(nw),gs(yS),gs(Uw),gs(wv),gs(ZL),gs(yy),gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),eD=(()=>{class e{constructor(e,t,i,s,r){this.modalService=e,this.serializerService=t,this.heritageService=i,this.servicesService=s,this.gameService=r,this.resetWorld=!1,this.resetHeritage=!1,e.registerForOnOpen().subscribe(e=>{e===Pf.ABDICATION&&(this.resetWorld=!1,this.resetHeritage=!1)}),e.registerForCloseModal().subscribe(e=>{(e===Pf.ABDICATION||e===Pf.ALL)&&this.modalService.sendAbdicationResult(!1)})}ngOnInit(){}abdicate(){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to abdicate?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&(this.modalService.sendAbdicationResult(!0),this.servicesService.getService(Zf.PLATEAU).getBuildings().forEach(e=>{e.getBuildingType()!==Lf.CONSTRUCTION&&e.forceAbdicate()}),this.serializerService.abdicate(this.resetWorld,this.resetHeritage),this.modalService.close(Pf.ABDICATION))})}cancel(){this.modalService.sendAbdicationResult(!1),this.modalService.close(Pf.ABDICATION)}calculateHeritagePoints(){return this.heritageService.calculateHeritagePoints()}peopleToNextHeritagePoint(){return this.heritageService.peopleToNextHeritagePoint()}getStartYear(){return this.gameService.getGameStartedYear()}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(JL),Mo(nw),Mo(Jf),Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-abdication-modal"]],decls:38,vars:5,consts:[["id","abdication-modal"],[1,"modal"],[1,"modal-body"],["id","resetWorld","type","checkbox",3,"ngModel","ngModelChange"],["for","resetWorld"],["id","buttons"],["id","hardReset",3,"click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"h2"),sa(4,"Abdication"),ko(),xo(5,"div"),sa(6," Are you sure you want to soft reset your progress? "),Fo(7,"br"),sa(8," You will start from the beginning and all progress except for:"),Fo(9,"br"),xo(10,"ul"),xo(11,"li"),sa(12,"Royal Points"),ko(),xo(13,"li"),sa(14,"Heritage Points"),ko(),xo(15,"li"),sa(16,"Wonder buildings and their effects"),ko(),ko(),sa(17," will be deleted."),Fo(18,"br"),Fo(19,"br"),sa(20),Fo(21,"br"),sa(22),Fo(23,"br"),Fo(24,"br"),sa(25),Fo(26,"br"),Fo(27,"br"),xo(28,"input",3),Vo("ngModelChange",function(e){return t.resetWorld=e}),ko(),xo(29,"label",4),sa(30,"reset world map progress"),ko(),Fo(31,"br"),ko(),xo(32,"div",5),xo(33,"button",6),Vo("click",function(){return t.abdicate()}),sa(34,"ABDICATE"),ko(),xo(35,"button",7),Vo("click",function(){return t.cancel()}),sa(36,"CANCEL"),ko(),ko(),ko(),ko(),Fo(37,"div",8),ko()),2&e&&(Jr(20),oa(" You will be awarded ",t.calculateHeritagePoints().hp," Heritage Points and ",t.calculateHeritagePoints().xp," xp towards next point "),Jr(2),na(" (",t.peopleToNextHeritagePoint()," more people/xp needed for the next point)"),Jr(3),na(" You reign since the start of year ",t.getStartYear()," "),Jr(3),Lo("ngModel",t.resetWorld))},directives:[jM,VO,dT,MT],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%}button[_ngcontent-%COMP%]{border:black solid 1px;color:#000;padding:1% 2%;text-align:center;text-decoration:none;display:inline-block;font-size:1em;margin:.5%}"]}),e})();const tD=function(e){return{selected:e}},iD=function(e){return{disabled:e}};let sD=(()=>{class e{constructor(e){this.modalService=e,this.selectedMode=0}ngOnInit(){}ok(){this.modalService.close(Pf.ASCENSION)}canAscend(){return!0}ascend(){this.canAscend()&&this.modalService.close(Pf.ASCENSION)}onKeydownHandler(e){"none"!==document.getElementById("ascension-modal").style.display&&(e.preventDefault(),this.ok())}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-ascension-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:43,vars:12,consts:[["id","ascension-modal"],[1,"modal"],[1,"modal-body"],["id","modes"],[1,"mode",3,"ngClass","click"],[1,"title"],["src","assets/weather/snow.svg"],[1,"effect"],["src","assets/army/recruit.svg"],["src","assets/resources/food.svg"],["id","buttons"],[3,"ngClass"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"h2"),sa(4,"Ascension"),ko(),xo(5,"div"),sa(6," Are you sure you want to ascend into a new world? "),Fo(7,"br"),Fo(8,"br"),ko(),xo(9,"div"),sa(10," You will start from the beginning and all progress except for"),Fo(11,"br"),sa(12," royal points, heritage points and permanent royal upgrades will be deleted "),Fo(13,"br"),Fo(14,"br"),ko(),xo(15,"div"),sa(16,"What world do you choose:"),ko(),xo(17,"div",3),xo(18,"div",4),Vo("click",function(){return t.selectedMode=0}),xo(19,"span",5),sa(20,"Winter"),ko(),Fo(21,"img",6),xo(22,"span",7),sa(23,"cold severity +5%"),ko(),ko(),xo(24,"div",4),Vo("click",function(){return t.selectedMode=1}),xo(25,"span",5),sa(26,"War"),ko(),Fo(27,"img",8),xo(28,"span",7),sa(29,"enemy difficulty +5%"),ko(),ko(),xo(30,"div",4),Vo("click",function(){return t.selectedMode=2}),xo(31,"span",5),sa(32,"Hunger"),ko(),Fo(33,"img",9),xo(34,"span",7),sa(35,"food consumption +5%"),ko(),ko(),ko(),Fo(36,"br"),xo(37,"div",10),xo(38,"button",11),sa(39,"ASCEND"),ko(),xo(40,"button"),sa(41,"TURN BACK"),ko(),ko(),ko(),ko(),Fo(42,"div",12),ko()),2&e&&(Jr(18),Lo("ngClass",Mc(4,tD,0===t.selectedMode)),Jr(6),Lo("ngClass",Mc(6,tD,1===t.selectedMode)),Jr(6),Lo("ngClass",Mc(8,tD,2===t.selectedMode)),Jr(8),Lo("ngClass",Mc(10,iD,!t.canAscend())))},directives:[jM,ku],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:100px auto auto}.lineBreak[_ngcontent-%COMP%]{display:block}#modes[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:10px}.mode[_ngcontent-%COMP%]{display:flex;cursor:pointer;flex-direction:column;height:150px;width:200px;border:black solid 1px;align-items:center;margin-right:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.mode[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px}.mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:bold}.mode[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{font-size:.8em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;white-space:nowrap}.disabled[_ngcontent-%COMP%]{color:#5a5a5a}.selected[_ngcontent-%COMP%]{border:black solid 3px}"]}),e})();function rD(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na("army size bonus: ",e.fightReport.attackerArmySizeBonus,"")}}function nD(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),oa("",i.getTroopName(e.troop),": ",e.size,"")}}function oD(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na("army size bonus: ",e.fightReport.defenderArmySizeBonus,"")}}function aD(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),oa("",i.getTroopName(e.troop),": ",e.size,"")}}const cD=function(e,t){return{won:e,lost:t}};function lD(e,t){if(1&e&&(xo(0,"div",14),xo(1,"div"),sa(2),ko(),xo(3,"div",15),xo(4,"span",7),sa(5),xo(6,"span"),sa(7,"("),Fo(8,"img",16),sa(9),ko(),ko(),xo(10,"span"),sa(11,"vs"),ko(),xo(12,"span",7),sa(13),Fo(14,"img",17),sa(15),ko(),ko(),ko()),2&e){const e=t.$implicit,i=t.index,s=Ko(2);Jr(2),na("Skirmish ",i+1,""),Jr(2),Lo("ngClass",Lc(7,cD,e.result,!e.result)),Jr(1),na("",s.getTroopName(e.attackerTroop)," "),Jr(4),na("",s.round(e.attack),")"),Jr(3),Lo("ngClass",Lc(10,cD,!e.result,e.result)),Jr(1),na("",s.getTroopName(e.defenderTroop)," ("),Jr(2),na("",s.round(e.defense),")")}}function uD(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),ra(e.getAttackerName())}}function hD(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko(2);Jr(1),ra(e.getDefenderName())}}function dD(e,t){if(1&e&&(xo(0,"div"),sa(1),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(1),oa("",i.getTroopName(e.troop),": ",e.size,"")}}function gD(e,t){if(1&e){const e=Go();xo(0,"div",4),xo(1,"div",5),sa(2,"Fight Report"),ko(),xo(3,"div"),sa(4),ko(),xo(5,"div",6),xo(6,"div",7),sa(7,"ATTACKER"),Fo(8,"br"),sa(9),ko(),xo(10,"div",7),sa(11,"DEFENDER"),Fo(12,"br"),sa(13),ko(),ko(),xo(14,"div",8),xo(15,"div"),sa(16,"Armies"),ko(),xo(17,"div",6),xo(18,"div"),Po(19,rD,2,1,"div",9),Po(20,nD,2,2,"div",10),ko(),xo(21,"div"),xo(22,"div"),sa(23),ko(),Po(24,oD,2,1,"div",9),Po(25,aD,2,2,"div",10),ko(),ko(),Po(26,lD,16,13,"div",11),xo(27,"div"),sa(28,"Winner army ("),Po(29,uD,2,1,"span",9),Po(30,hD,2,1,"span",9),sa(31,") "),ko(),xo(32,"div",12),xo(33,"div"),Po(34,dD,2,2,"div",10),ko(),ko(),ko(),xo(35,"button",13),Vo("click",function(){return Dt(e),Ko().ok()}),sa(36,"close"),ko(),ko()}if(2&e){const e=Ko();Jr(4),ra(e.fightReport.message),Jr(2),Lo("ngClass",Lc(14,cD,e.fightReport.result,!e.fightReport.result)),Jr(3),na("",e.getAttackerName()," "),Jr(1),Lo("ngClass",Lc(17,cD,!e.fightReport.result,e.fightReport.result)),Jr(3),na("",e.getDefenderName()," "),Jr(6),Lo("ngIf",e.fightReport.attackerArmySizeBonus>0),Jr(1),Lo("ngForOf",e.fightReport.attackerArmy.units),Jr(3),na("defense: ",e.fightReport.defense,""),Jr(1),Lo("ngIf",e.fightReport.defenderArmySizeBonus>0),Jr(1),Lo("ngForOf",e.fightReport.defenderArmy.units),Jr(1),Lo("ngForOf",e.fightReport.skirmish),Jr(3),Lo("ngIf",e.fightReport.result),Jr(1),Lo("ngIf",!e.fightReport.result),Jr(4),Lo("ngForOf",e.fightReport.armyAfterFight.units)}}let pD=(()=>{class e{constructor(e,t){this.modalService=e,this.worldService=t,this.modalService.registerForFightReport().subscribe(e=>this.fightReport=e)}ngOnInit(){}ok(){this.fightReport=null,this.modalService.close(Pf.FIGHT_REPORT)}getAttackerName(){return this.fightReport.attacker===zf.PLAYER?this.worldService.getPlayerCountry().name:Qf.prepareCountryName(this.fightReport.attacker)}getDefenderName(){return this.fightReport.defender===zf.PLAYER?this.worldService.getPlayerCountry().name:Qf.prepareCountryName(this.fightReport.defender)}getTroopName(e){return Qf.prepareTroopName(e)}round(e){return Qf.round(e,1)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(Uw))},e.\u0275cmp=Ve({type:e,selectors:[["app-fight-report-modal"]],decls:4,vars:1,consts:[["id","fight-report-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],[1,"section"],[3,"ngClass"],["id","reportBody"],[4,"ngIf"],[4,"ngFor","ngForOf"],["id","skirmishes",4,"ngFor","ngForOf"],[1,"sectionEnd"],[3,"click"],["id","skirmishes"],[1,"sectionFull"],["src","assets/army/attack.svg",1,"attdefIcon"],["src","assets/army/defense.svg",1,"attdefIcon"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),Po(2,gD,37,20,"div",2),ko(),Fo(3,"div",3),ko()),2&e&&(Jr(2),Lo("ngIf",t.fightReport))},directives:[jM,Gu,ku,Uu],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;font-size:1.2em}#title[_ngcontent-%COMP%]{font-weight:bold}#reportBody[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;overflow-y:auto}.section[_ngcontent-%COMP%]{width:80%;display:flex;flex-direction:row;text-align:center;border-bottom:black solid 2px}.section[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 50%;align-items:center}#skirmishes[_ngcontent-%COMP%]{width:80%;text-align:center}.sectionFull[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;text-align:center;border-bottom:black solid 2px}.sectionEnd[_ngcontent-%COMP%]{width:80%;display:flex;flex-direction:row;text-align:center;border-bottom:black solid 2px}.sectionEnd[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 100%}.sectionFull[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){flex:0 0 45%;align-items:center}.sectionFull[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){flex:0 0 10%;align-items:center}.sectionFull[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(3){flex:0 0 45%;align-items:center}.section[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{border-right:black solid 2px}.section[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{padding-bottom:10px}.won[_ngcontent-%COMP%]{color:var(--positive-colour)}.lost[_ngcontent-%COMP%]{color:var(--negative-colour)}.attdefIcon[_ngcontent-%COMP%]{height:15px}"]}),e})();function fD(e,t){1&e&&(xo(0,"div"),sa(1,"copied..."),ko())}function mD(e,t){1&e&&(xo(0,"div"),Fo(1,"br"),ko())}let SD=(()=>{class e{constructor(e,t){this.serializerService=e,this.modalService=t,this.exportTextArea=null,this.showMessage=!1,this.modalService.registerForOnOpen().subscribe(e=>{e===Pf.EXPORT&&this.export()})}ngOnInit(){}export(){this.exportTextArea=this.serializerService.prepareBase64()}copy(){const e=this.exportTextArea,t=document.createElement("textarea");t.id="txt",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.opacity="0",t.value=e,document.body.appendChild(t),t.select();try{if(document.execCommand("copy"))return this.showMessage=!0,setTimeout(()=>this.showMessage=!1,1500),!0}catch(i){console.error(Tv.ERROR_1)}finally{document.body.removeChild(t)}return!1}}return e.\u0275fac=function(t){return new(t||e)(Mo(JL),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-export-modal"]],decls:15,vars:3,consts:[["id","export-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["readonly","","id","export-area","rows","20","placeholder","Your save will be generated here..."],["id","buttons"],["id","import-button",3,"click"],["id","copy-button",3,"click"],[4,"ngIf"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"span",3),sa(4,"Export save"),ko(),xo(5,"textarea",4),sa(6),ko(),xo(7,"div",5),xo(8,"button",6),Vo("click",function(){return t.export()}),sa(9,"Update"),ko(),xo(10,"button",7),Vo("click",function(){return t.copy()}),sa(11,"Copy to clipboard"),ko(),ko(),Po(12,fD,2,0,"div",8),Po(13,mD,2,0,"div",8),ko(),ko(),Fo(14,"div",9),ko()),2&e&&(Jr(6),ra(t.exportTextArea),Jr(6),Lo("ngIf",t.showMessage),Jr(1),Lo("ngIf",!t.showMessage))},directives:[jM,Gu],styles:["#export-area[_ngcontent-%COMP%]{width:95%;resize:none}.modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%}#title[_ngcontent-%COMP%]{font-weight:800;margin-bottom:10px}"]}),e})(),ED=(()=>{class e{constructor(e,t){this.serializerService=e,this.modalService=t}ngOnInit(){}import(){this.serializerService.import(this.importTextArea),this.importTextArea="",this.modalService.close(Pf.IMPORT)}}return e.\u0275fac=function(t){return new(t||e)(Mo(JL),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-import-modal"]],decls:9,vars:1,consts:[["id","import-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["id","import-area","rows","20","placeholder","Paste your save here...",3,"ngModel","ngModelChange"],["id","import-button",3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"span",3),sa(4,"Import save"),ko(),xo(5,"textarea",4),Vo("ngModelChange",function(e){return t.importTextArea=e}),ko(),xo(6,"button",5),Vo("click",function(){return t.import()}),sa(7,"Import"),ko(),ko(),ko(),Fo(8,"div",6),ko()),2&e&&(Jr(5),Lo("ngModel",t.importTextArea))},directives:[jM,KO,dT,MT],styles:["#import-area[_ngcontent-%COMP%]{width:95%;resize:none}.modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#title[_ngcontent-%COMP%]{font-weight:800;margin-bottom:10px}"]}),e})(),vD=(()=>{class e{constructor(e,t){this.modalService=e,this.serializerService=t}ngOnInit(){}hardReset(){this.serializerService.hardReset(),this.modalService.close(Pf.HARD_RESET)}cancel(){this.modalService.close(Pf.HARD_RESET)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(JL))},e.\u0275cmp=Ve({type:e,selectors:[["app-hard-reset-modal"]],decls:19,vars:0,consts:[["id","hard-reset-modal"],[1,"modal"],[1,"modal-body"],["id","buttons"],["id","hardReset",3,"click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"h2"),sa(4,"Hard Reset"),ko(),xo(5,"div"),sa(6," Are you sure you want to hard reset your progress? "),Fo(7,"br"),sa(8," This will remove ALL progress and saved game (except settings and tutorial state). "),Fo(9,"br"),sa(10," You will still be able to load game from exported save. "),Fo(11,"br"),sa(12," This should only be done if you have backup save or want to start from the beginning. "),ko(),xo(13,"div",3),xo(14,"button",4),Vo("click",function(){return t.hardReset()}),sa(15,"HARD RESET"),ko(),xo(16,"button",5),Vo("click",function(){return t.cancel()}),sa(17,"CANCEL"),ko(),ko(),ko(),ko(),Fo(18,"div",6),ko())},directives:[jM],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%}button[_ngcontent-%COMP%]{border:black solid 2px;color:#000;padding:1% 2%;text-align:center;text-decoration:none;display:inline-block;font-size:1em;margin:.5%}#hardReset[_ngcontent-%COMP%]{background-color:#5f0000;color:#fff}"]}),e})();function RD(e,t){1&e&&Fo(0,"div",28)}function OD(e,t){1&e&&(xo(0,"span"),sa(1,"No save file on the server"),ko())}function TD(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),oa("save for day: ",e.saveFileMetadata.day,", year: ",e.saveFileMetadata.year,"")}}function ID(e,t){1&e&&Fo(0,"img",29)}function bD(e,t){1&e&&Fo(0,"div",28)}function CD(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"div"),sa(2,"Cloud saving (saving no longer available due to low use, cloud load will be removed soon as well)"),ko(),xo(3,"button",6),Vo("click",function(){return Dt(e),Ko(2).cloudLoad()}),sa(4," Cloud load "),Po(5,RD,1,0,"div",25),ko(),xo(6,"div"),Po(7,OD,2,0,"span",5),Po(8,TD,2,2,"span",5),xo(9,"button",26),Vo("click",function(){return Dt(e),Ko(2).checkSave()}),Po(10,ID,1,0,"img",27),Po(11,bD,1,0,"div",25),ko(),Fo(12,"br"),ko(),ko()}if(2&e){const e=Ko(2);Jr(5),Lo("ngIf",e.loadingLoader.status),Jr(2),Lo("ngIf",e.saveFileMetadata.day<0),Jr(1),Lo("ngIf",e.saveFileMetadata.day>0),Jr(2),Lo("ngIf",!e.checkLoader.status),Jr(1),Lo("ngIf",e.checkLoader.status)}}function yD(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"h4"),sa(2,"Game options"),ko(),Po(3,CD,13,5,"div",5),xo(4,"div",8),xo(5,"h4"),sa(6,"Game options"),ko(),xo(7,"input",9),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().autoSaveStatus=t}),ko(),xo(8,"label",10),sa(9,"auto save on/off "),ko(),Fo(10,"br"),xo(11,"input",11),Vo("change",function(){return Dt(e),Ko().updateSaveOption()})("ngModelChange",function(t){return Dt(e),Ko().autoSavePeriod=t}),ko(),sa(12," minutes "),xo(13,"label",12),sa(14,"auto save period "),ko(),Fo(15,"br"),xo(16,"input",13),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().metricStatus=t}),ko(),xo(17,"label",14),sa(18,"use metric units"),ko(),Fo(19,"br"),xo(20,"input",15),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().saveLogs=t}),ko(),xo(21,"label",16),sa(22,"save logs (up to 100 entries)"),ko(),Fo(23,"br"),xo(24,"input",17),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().pauseOnInit=t}),ko(),xo(25,"label",18),sa(26,"pause the game on page refresh"),ko(),Fo(27,"br"),xo(28,"input",19),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().keepReservationSettingsOnReset=t}),ko(),xo(29,"label",20),sa(30,"Keep reservation settings active over resets and abdications"),ko(),Fo(31,"br"),xo(32,"input",21),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().keepManagementSettingsOnReset=t}),ko(),xo(33,"label",22),sa(34,"Keep management settings over resets and abdications"),ko(),Fo(35,"br"),xo(36,"input",23),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().keepAutoTradeOnReset=t}),ko(),xo(37,"label",24),sa(38,"Keep auto trade enabled after resets and abdications"),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(3),Lo("ngIf",e.isKongregate()),Jr(4),Lo("ngModel",e.autoSaveStatus),Jr(4),Lo("ngModel",e.autoSavePeriod),Jr(5),Lo("ngModel",e.metricStatus),Jr(4),Lo("ngModel",e.saveLogs),Jr(4),Lo("ngModel",e.pauseOnInit),Jr(4),Lo("ngModel",e.keepReservationSettingsOnReset),Jr(4),Lo("ngModel",e.keepManagementSettingsOnReset),Jr(4),Lo("ngModel",e.keepAutoTradeOnReset)}}function AD(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"h4"),sa(2,"Sound"),ko(),xo(3,"div",8),xo(4,"h5"),sa(5,"Master"),ko(),xo(6,"input",30),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().soundMaster=t}),ko(),xo(7,"label",31),sa(8,"master sound on/off"),ko(),Fo(9,"br"),xo(10,"label",32),sa(11),ko(),xo(12,"div",33),xo(13,"input",34),Vo("input",function(t){return Dt(e),Ko().changeSoundMasterVolume(t)}),ko(),ko(),xo(14,"h5"),sa(15,"Music"),ko(),xo(16,"input",35),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().soundMusic=t}),ko(),xo(17,"label",36),sa(18,"music on/off"),ko(),Fo(19,"br"),xo(20,"label",37),sa(21),ko(),xo(22,"div",33),xo(23,"input",38),Vo("input",function(t){return Dt(e),Ko().changeSoundMusicVolume(t)}),ko(),ko(),xo(24,"h5"),sa(25,"Effects"),ko(),xo(26,"input",39),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().soundEffects=t}),ko(),xo(27,"label",40),sa(28,"effects on/off"),ko(),Fo(29,"br"),xo(30,"label",41),sa(31),ko(),xo(32,"div",33),xo(33,"input",42),Vo("input",function(t){return Dt(e),Ko().changeSoundEffectsVolume(t)}),ko(),ko(),Fo(34,"br"),xo(35,"input",43),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().soundEffectMarket=t}),ko(),xo(36,"label",44),sa(37,"Play sound when merchant arrives"),ko(),Fo(38,"br"),xo(39,"input",45),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().soundEffectResearch=t}),ko(),xo(40,"label",46),sa(41,"Play sound when research is finished"),ko(),Fo(42,"br"),xo(43,"input",47),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().soundEffectInvasion=t}),ko(),xo(44,"label",48),sa(45,"Play sound when invasion is coming"),ko(),Fo(46,"br"),xo(47,"input",49),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().soundEffectSeason=t}),ko(),xo(48,"label",50),sa(49,"Play sound when season change"),ko(),Fo(50,"br"),ko(),ko()}if(2&e){const e=Ko();Jr(6),Lo("ngModel",e.soundMaster),Jr(5),na("master sound volume ",e.getSoundMasterVolume(),"% "),Jr(2),Lo("value",e.getSoundMasterVolume()),Jr(3),Lo("ngModel",e.soundMusic),Jr(5),na("music sound volume ",e.getSoundMusicVolume(),"% "),Jr(2),Lo("value",e.getSoundMusicVolume()),Jr(3),Lo("ngModel",e.soundEffects),Jr(5),na("effects sound volume ",e.getSoundEffectsVolume(),"% "),Jr(2),Lo("value",e.getSoundEffectsVolume()),Jr(2),Lo("ngModel",e.soundEffectMarket),Jr(4),Lo("ngModel",e.soundEffectResearch),Jr(4),Lo("ngModel",e.soundEffectInvasion),Jr(4),Lo("ngModel",e.soundEffectSeason)}}function ND(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"h4"),sa(2,"Game difficulty"),ko(),xo(3,"div",8),xo(4,"h5"),sa(5,"AI strength"),ko(),xo(6,"input",51),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().AIDifficulty=t}),ko(),xo(7,"label",52),sa(8,"Easy"),ko(),Fo(9,"br"),xo(10,"input",53),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().AIDifficulty=t}),ko(),xo(11,"label",54),sa(12,"Medium"),ko(),Fo(13,"br"),xo(14,"input",55),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().AIDifficulty=t}),ko(),xo(15,"label",56),sa(16,"Hard"),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(6),Lo("value",e.AIDiffs.EASY)("ngModel",e.AIDifficulty),Jr(4),Lo("value",e.AIDiffs.MEDIUM)("ngModel",e.AIDifficulty),Jr(4),Lo("value",e.AIDiffs.HARD)("ngModel",e.AIDifficulty)}}function _D(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"h4"),sa(2,"Performance options"),ko(),xo(3,"div",8),xo(4,"input",57),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().pagedView=t}),ko(),xo(5,"label",58),sa(6,"Display buildings in pages instead of all at once"),ko(),Fo(7,"br"),xo(8,"input",59),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().buildingsPerPage=t}),ko(),xo(9,"label",60),sa(10,"Number of buildings on one page"),ko(),Fo(11,"br"),xo(12,"input",61),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().visualProgressBars=t}),ko(),xo(13,"label",62),sa(14,"Display moving progress bars (on) or just text (off)"),ko(),Fo(15,"br"),xo(16,"input",63),Vo("change",function(){return Dt(e),Ko().updateOptions()})("ngModelChange",function(t){return Dt(e),Ko().autoTextFitting=t}),ko(),xo(17,"label",64),sa(18,"Buildings names and effect font size will be automatically recalculated on change"),ko(),Fo(19,"br"),ko(),ko()}if(2&e){const e=Ko();Jr(4),Lo("ngModel",e.pagedView),Jr(4),Lo("ngModel",e.buildingsPerPage),Jr(4),Lo("ngModel",e.visualProgressBars),Jr(4),Lo("ngModel",e.autoTextFitting)}}function wD(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"h4"),sa(2,"Display options"),ko(),xo(3,"div",8),xo(4,"input",65),Vo("change",function(){return Dt(e),Ko().setPositiveColour()})("ngModelChange",function(t){return Dt(e),Ko().positiveColour=t}),ko(),xo(5,"label",66),sa(6,"Font colour for positive effects"),ko(),xo(7,"button",6),Vo("click",function(){return Dt(e),Ko().resetPositiveColour()}),sa(8,"reset to default"),ko(),Fo(9,"br"),xo(10,"input",67),Vo("change",function(){return Dt(e),Ko().setNegativeColour()})("ngModelChange",function(t){return Dt(e),Ko().negativeColour=t}),ko(),xo(11,"label",68),sa(12,"Font colour for negative effects"),ko(),xo(13,"button",6),Vo("click",function(){return Dt(e),Ko().resetNegativeColour()}),sa(14,"reset to default"),ko(),Fo(15,"br"),xo(16,"input",69),Vo("change",function(){return Dt(e),Ko().setPlayerColour()})("ngModelChange",function(t){return Dt(e),Ko().playerColour=t}),ko(),xo(17,"label",70),sa(18,"World map player regions colour"),ko(),xo(19,"button",6),Vo("click",function(){return Dt(e),Ko().resetPlayerColour()}),sa(20,"reset to default"),ko(),Fo(21,"br"),ko(),ko()}if(2&e){const e=Ko();Jr(4),Lo("ngModel",e.positiveColour),Jr(6),Lo("ngModel",e.negativeColour),Jr(6),Lo("ngModel",e.playerColour)}}const PD=function(e){return{x:e}};let MD=(()=>{class e{constructor(e,t,i){this.optionsService=e,this.servicesService=t,this.modalService=i,this.selection=0,this.lastServerAction={timestamp:0},this.saveFileMetadata={day:-1,year:-1},this.savingLoader={status:!1},this.loadingLoader={status:!1},this.checkLoader={status:!1},this.positiveColour=this.optionsService.getOption(Xf.POSITIVE_COLOUR),this.negativeColour=this.optionsService.getOption(Xf.NEGATIVE_COLOUR),this.playerColour=this.optionsService.getOption(Xf.PLAYER_COLOUR),this.AIDiffs=dm,i.registerForOnOpen().subscribe(e=>{e===Pf.OPTIONS&&(this.checkSave(!0),this.lastServerAction.timestamp=0)})}ngOnInit(){this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(()=>this.initOptions())),this.initOptions()}initOptions(){this.autoSaveStatus=this.optionsService.getOption(Xf.AUTO_SAVE_STATUS),this.autoSavePeriod=this.optionsService.getOption(Xf.AUTO_SAVE_PERIOD),this.metricStatus=this.optionsService.getOption(Xf.METRIC),this.saveLogs=this.optionsService.getOption(Xf.SAVE_LOGS),this.pauseOnInit=this.optionsService.getOption(Xf.PAUSE_ON_INIT),this.keepReservationSettingsOnReset=this.optionsService.getOption(Xf.KEEP_RESERVATION_SETTINGS_ON_RESET),this.keepManagementSettingsOnReset=this.optionsService.getOption(Xf.KEEP_MANAGEMENT_SETTINGS_ON_RESET),this.keepAutoTradeOnReset=this.optionsService.getOption(Xf.KEEP_AUTO_TRADE_ON_RESET),this.soundMaster=this.optionsService.getOption(Xf.SOUND_MASTER),this.soundMasterVolume=this.optionsService.getOption(Xf.SOUND_MASTER_VOLUME),this.soundMusic=this.optionsService.getOption(Xf.SOUND_MUSIC),this.soundMusicVolume=this.optionsService.getOption(Xf.SOUND_MUSIC_VOLUME),this.soundEffects=this.optionsService.getOption(Xf.SOUND_EFFECTS),this.soundEffectsVolume=this.optionsService.getOption(Xf.SOUND_EFFECTS_VOLUME),this.soundEffectMarket=this.optionsService.getOption(Xf.SOUND_EFFECT_MARKET),this.soundEffectResearch=this.optionsService.getOption(Xf.SOUND_EFFECT_RESEARCH),this.soundEffectInvasion=this.optionsService.getOption(Xf.SOUND_EFFECT_INVASION),this.soundEffectSeason=this.optionsService.getOption(Xf.SOUND_EFFECT_SEASON),this.visualProgressBars=this.optionsService.getOption(Xf.VISUAL_PROGRESS_BARS),this.autoTextFitting=this.optionsService.getOption(Xf.AUTO_TEXT_FITTING),this.pagedView=this.optionsService.getOption(Xf.PAGED_VIEW),this.buildingsPerPage=this.optionsService.getOption(Xf.BUILDINGS_PER_PAGE),this.positiveColour=this.optionsService.getOption(Xf.POSITIVE_COLOUR),this.negativeColour=this.optionsService.getOption(Xf.NEGATIVE_COLOUR),this.playerColour=this.optionsService.getOption(Xf.PLAYER_COLOUR),this.AIDifficulty=this.optionsService.getOption(Xf.AI_DIFFICULTY)}close(){this.modalService.close(Pf.OPTIONS)}updateOptions(){this.optionsService.setOptions([{option:Xf.AUTO_SAVE_STATUS,value:this.autoSaveStatus},{option:Xf.AUTO_SAVE_PERIOD,value:this.autoSavePeriod},{option:Xf.METRIC,value:this.metricStatus},{option:Xf.SAVE_LOGS,value:this.saveLogs},{option:Xf.PAUSE_ON_INIT,value:this.pauseOnInit},{option:Xf.KEEP_RESERVATION_SETTINGS_ON_RESET,value:this.keepReservationSettingsOnReset},{option:Xf.KEEP_MANAGEMENT_SETTINGS_ON_RESET,value:this.keepManagementSettingsOnReset},{option:Xf.KEEP_AUTO_TRADE_ON_RESET,value:this.keepAutoTradeOnReset},{option:Xf.SOUND_MASTER,value:this.soundMaster},{option:Xf.SOUND_MASTER_VOLUME,value:this.soundMasterVolume},{option:Xf.SOUND_MUSIC,value:this.soundMusic},{option:Xf.SOUND_MUSIC_VOLUME,value:this.soundMusicVolume},{option:Xf.SOUND_EFFECTS,value:this.soundEffects},{option:Xf.SOUND_EFFECTS_VOLUME,value:this.soundEffectsVolume},{option:Xf.SOUND_EFFECT_MARKET,value:this.soundEffectMarket},{option:Xf.SOUND_EFFECT_RESEARCH,value:this.soundEffectResearch},{option:Xf.SOUND_EFFECT_INVASION,value:this.soundEffectInvasion},{option:Xf.SOUND_EFFECT_SEASON,value:this.soundEffectSeason},{option:Xf.VISUAL_PROGRESS_BARS,value:this.visualProgressBars},{option:Xf.AUTO_TEXT_FITTING,value:this.autoTextFitting},{option:Xf.PAGED_VIEW,value:this.pagedView},{option:Xf.BUILDINGS_PER_PAGE,value:this.buildingsPerPage},{option:Xf.POSITIVE_COLOUR,value:this.positiveColour},{option:Xf.NEGATIVE_COLOUR,value:this.negativeColour},{option:Xf.PLAYER_COLOUR,value:this.playerColour},{option:Xf.AI_DIFFICULTY,value:this.AIDifficulty}])}updateSaveOption(){this.autoSavePeriod=Number(this.autoSavePeriod),this.autoSavePeriod<1&&(this.autoSavePeriod=1),this.autoSavePeriod%1!=0&&(this.autoSavePeriod=Math.floor(this.autoSavePeriod)),this.autoSavePeriod>60&&(this.autoSavePeriod=60),this.updateOptions()}setPositiveColour(){this.optionsService.setPositiveColour(this.positiveColour)}setNegativeColour(){this.optionsService.setNegativeColour(this.negativeColour)}setPlayerColour(){this.optionsService.setPlayerColour(this.playerColour)}resetPositiveColour(){this.positiveColour=wm.POSITIVE_COLOUR,this.setPositiveColour()}resetNegativeColour(){this.negativeColour=wm.NEGATIVE_COLOUR,this.setNegativeColour()}resetPlayerColour(){this.playerColour=wm.PLAYER_COLOUR,this.setPlayerColour()}resetAll(){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to reset all settings (in all tabs) to default values?");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&this.optionsService.init()})}getTimestamp(){return(new Date).getTime()}cloudSave(){this.getTimestamp()-this.lastServerAction.timestamp>15e3?this.servicesService.getService(Zf.SERIALIZER).cloudSave(this.savingLoader,this.saveFileMetadata,this.lastServerAction):this.modalService.info("You must wait for "+(15-Math.ceil((this.getTimestamp()-this.lastServerAction.timestamp)/1e3))+"s before next cloud save")}cloudLoad(){this.getTimestamp()-this.lastServerAction.timestamp>15e3?this.servicesService.getService(Zf.SERIALIZER).cloudLoad(this.loadingLoader,this.lastServerAction):this.modalService.info("You must wait for "+(15-Math.ceil((this.getTimestamp()-this.lastServerAction.timestamp)/1e3))+"s before next cloud load")}checkSave(e=!1){e||this.getTimestamp()-this.lastServerAction.timestamp>5e3?this.servicesService.getService(Zf.SERIALIZER).cloudCheck(e,this.checkLoader,this.saveFileMetadata,this.lastServerAction):this.modalService.info("You must wait for "+(5-Math.ceil((this.getTimestamp()-this.lastServerAction.timestamp)/1e3))+"s before next save lookup")}getSoundMasterVolume(){return this.optionsService.getOption(Xf.SOUND_MASTER_VOLUME)}changeSoundMasterVolume(e){this.soundMasterVolume=e.target.value,this.updateOptions()}getSoundMusicVolume(){return this.optionsService.getOption(Xf.SOUND_MUSIC_VOLUME)}changeSoundMusicVolume(e){this.soundMusicVolume=e.target.value,this.updateOptions()}getSoundEffectsVolume(){return this.optionsService.getOption(Xf.SOUND_EFFECTS_VOLUME)}changeSoundEffectsVolume(e){this.soundEffectsVolume=e.target.value,this.updateOptions()}isKongregate(){return Am.target===ym.DEV||Am.target===ym.KONGREGATE}}return e.\u0275fac=function(t){return new(t||e)(Mo(vS),Mo(Jf),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-options-modal"]],decls:29,vars:20,consts:[["id","options-modal"],[1,"modal"],[1,"modal-body"],["id","sections"],[3,"ngClass","click"],[4,"ngIf"],[3,"click"],[1,"modal-background"],[1,"options"],["id","autoSaveStatus","type","checkbox",3,"ngModel","change","ngModelChange"],["for","autoSaveStatus"],["id","autoSavePeriod","type","number","min","1","max","60",3,"ngModel","change","ngModelChange"],["for","autoSavePeriod"],["id","metricStatus","type","checkbox",3,"ngModel","change","ngModelChange"],["for","metricStatus"],["id","saveLogsStatus","type","checkbox",3,"ngModel","change","ngModelChange"],["for","saveLogsStatus"],["id","pauseOnInit","type","checkbox",3,"ngModel","change","ngModelChange"],["for","pauseOnInit"],["id","keepReservationSettings","type","checkbox",3,"ngModel","change","ngModelChange"],["for","keepReservationSettings"],["id","keepManagementSettings","type","checkbox",3,"ngModel","change","ngModelChange"],["for","keepManagementSettings"],["id","keepAutoTradeOnReset","type","checkbox",3,"ngModel","change","ngModelChange"],["for","keepAutoTradeOnReset"],["class","loader",4,"ngIf"],["id","refresh",3,"click"],["id","refreshIMG","src","assets/refresh.svg",4,"ngIf"],[1,"loader"],["id","refreshIMG","src","assets/refresh.svg"],["id","soundMaster","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundMaster"],["for","soundMasterVolume",1,"soundVolumeLabel"],[1,"slidecontainer"],["id","soundMasterVolume","type","range","min","0","max","100","value","100",1,"slider",3,"value","input"],["id","soundMusic","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundMusic"],["for","soundMusicVolume",1,"soundVolumeLabel"],["id","soundMusicVolume","type","range","min","0","max","100","value","100",1,"slider",3,"value","input"],["id","soundEffects","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffects"],["for","soundEffectsVolume",1,"soundVolumeLabel"],["id","soundEffectsVolume","type","range","min","0","max","100","value","100",1,"slider",3,"value","input"],["id","soundEffectMarket","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectMarket"],["id","soundEffectResearch","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectResearch"],["id","soundEffectInvasion","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectInvasion"],["id","soundEffectSeason","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectSeason"],["id","AIeasy","type","radio",3,"value","ngModel","change","ngModelChange"],["for","AIeasy"],["id","AImedium","type","radio",3,"value","ngModel","change","ngModelChange"],["for","AImedium"],["id","AIhard","type","radio",3,"value","ngModel","change","ngModelChange"],["for","AIhard"],["id","pagedView","type","checkbox",3,"ngModel","change","ngModelChange"],["for","pagedView"],["id","buildingPerPage","type","number",3,"ngModel","change","ngModelChange"],["for","buildingPerPage"],["id","visualProgressBars","type","checkbox",3,"ngModel","change","ngModelChange"],["for","visualProgressBars"],["id","autoTextFitting","type","checkbox",3,"ngModel","change","ngModelChange"],["for","autoTextFitting"],["id","positiveColour","type","color",3,"ngModel","change","ngModelChange"],["for","positiveColour"],["id","negativeColour","type","color",3,"ngModel","change","ngModelChange"],["for","negativeColour"],["id","playerColour","type","color",3,"ngModel","change","ngModelChange"],["for","playerColour"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"div",3),xo(4,"div",4),Vo("click",function(){return t.selection=0}),sa(5,"General"),ko(),xo(6,"div",4),Vo("click",function(){return t.selection=1}),sa(7,"Sound"),ko(),xo(8,"div",4),Vo("click",function(){return t.selection=2}),sa(9,"Difficulty"),ko(),xo(10,"div",4),Vo("click",function(){return t.selection=3}),sa(11,"Performance"),ko(),xo(12,"div",4),Vo("click",function(){return t.selection=4}),sa(13,"Display"),ko(),ko(),Po(14,yD,39,9,"div",5),Po(15,AD,51,13,"div",5),Po(16,ND,17,6,"div",5),Po(17,_D,20,4,"div",5),Po(18,wD,22,3,"div",5),Fo(19,"br"),Fo(20,"br"),Fo(21,"br"),xo(22,"button",6),Vo("click",function(){return t.resetAll()}),sa(23,"RESET ALL SETTINGS"),ko(),Fo(24,"br"),Fo(25,"br"),xo(26,"button",6),Vo("click",function(){return t.close()}),sa(27,"Close"),ko(),ko(),ko(),Fo(28,"div",7),ko()),2&e&&(Jr(4),Lo("ngClass",Mc(10,PD,0===t.selection)),Jr(2),Lo("ngClass",Mc(12,PD,1===t.selection)),Jr(2),Lo("ngClass",Mc(14,PD,2===t.selection)),Jr(2),Lo("ngClass",Mc(16,PD,3===t.selection)),Jr(2),Lo("ngClass",Mc(18,PD,4===t.selection)),Jr(2),Lo("ngIf",0===t.selection),Jr(1),Lo("ngIf",1===t.selection),Jr(1),Lo("ngIf",2===t.selection),Jr(1),Lo("ngIf",3===t.selection),Jr(1),Lo("ngIf",4===t.selection))},directives:[jM,ku,Gu,VO,dT,MT,JT,XT,DT,KO,UT],styles:[".modal-body[_ngcontent-%COMP%]{text-align:center;font-size:1.2em}#title[_ngcontent-%COMP%]{text-align:center;font-weight:800;display:inline-block}.options[_ngcontent-%COMP%]{text-align:left}#autoSavePeriod[_ngcontent-%COMP%]{width:4ch;text-align:right}.slidecontainer[_ngcontent-%COMP%]{display:inline-block;width:150px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.soundVolumeLabel[_ngcontent-%COMP%]{display:inline-block;width:250px}#buildingPerPage[_ngcontent-%COMP%]{width:5ch}#sections[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;width:100%}#sections[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:10px;font-size:1.2em;background-color:var(--passive-colour);border:black solid 1px;cursor:pointer}#sections[_ngcontent-%COMP%] > div.x[_ngcontent-%COMP%]{background-color:var(--active-colour)}#refresh[_ngcontent-%COMP%]{padding:4px 4px 0;align-items:center}#refreshIMG[_ngcontent-%COMP%]{height:20px}"]}),e})();function LD(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span"),sa(2,"Choose how many Royal Points you would like to buy:"),ko(),Fo(3,"br"),xo(4,"div",6),xo(5,"button",7),Vo("click",function(){return Dt(e),Ko().buy("rp_pack10")}),sa(6,"10 "),Fo(7,"img",8),ko(),xo(8,"span"),sa(9," 10 Royal points"),ko(),ko(),xo(10,"div",6),xo(11,"button",7),Vo("click",function(){return Dt(e),Ko().buy("rp_pack20")}),sa(12,"20 "),Fo(13,"img",8),ko(),xo(14,"span"),sa(15," 20 Royal points"),ko(),ko(),xo(16,"div",6),xo(17,"button",7),Vo("click",function(){return Dt(e),Ko().buy("rp_pack55")}),sa(18,"50 "),Fo(19,"img",8),ko(),xo(20,"span"),sa(21," 55 Royal points"),ko(),ko(),xo(22,"div",6),xo(23,"button",7),Vo("click",function(){return Dt(e),Ko().buy("rp_pack125")}),sa(24,"100 "),Fo(25,"img",8),ko(),xo(26,"span"),sa(27," 125 Royal points"),ko(),ko(),ko()}}function DD(e,t){1&e&&(xo(0,"div"),xo(1,"span"),sa(2,"Buying Royal Points is currently possible only at Kongregate Villager Kings"),Fo(3,"br"),sa(4," You can still find Royal Points through playing the game or buying on Kongregate and moving your save file here. "),ko(),ko())}let xD=(()=>{class e{constructor(e,t,i){this.kongregateService=e,this.royalService=t,this.modalService=i}ngOnInit(){}ok(){this.modalService.close(Pf.ROYAL)}buy(e){Am.production?this.kongregateService.buyItem(e):(this.royalService.increaseRoyalPoints(Number(e.replace("rp_pack",""))),this.modalService.close(Pf.ROYAL))}isKongregate(){return Am.target===ym.DEV||Am.target===ym.KONGREGATE}}return e.\u0275fac=function(t){return new(t||e)(Mo(wv),Mo(_v),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-royal-modal"]],decls:8,vars:2,consts:[["id","royal-modal"],[1,"modal"],[1,"modal-body"],[4,"ngIf"],["id","close",3,"click"],[1,"modal-background"],[1,"entry"],[3,"click"],["src","assets/kred.png","alt","Kreds",1,"kred"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),Po(3,LD,28,0,"div",3),Po(4,DD,5,0,"div",3),xo(5,"button",4),Vo("click",function(){return t.ok()}),sa(6,"CLOSE"),ko(),ko(),ko(),Fo(7,"div",5),ko()),2&e&&(Jr(3),Lo("ngIf",t.isKongregate()),Jr(1),Lo("ngIf",!t.isKongregate()))},directives:[jM,Gu],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.kred[_ngcontent-%COMP%]{width:30px;height:30px;vertical-align:middle}.value[_ngcontent-%COMP%]{margin-top:5px}.entry[_ngcontent-%COMP%]{width:50%;text-align:center}#close[_ngcontent-%COMP%]{margin-top:15px}"]}),e})();function kD(e,t){if(1&e&&(xo(0,"div"),ai(),xo(1,"svg",21),Fo(2,"path"),ko(),ko()),2&e){const e=Ko(2);Jr(1),No("height","80px")("width","80px")("viewBox",e.prepareViewbox(e.missionData.originRegion.center)),Jr(1),No("fill",e.missionData.originRegionColour)("d",e.missionData.originRegion.path)("stroke","black")("stroke-width","2")}}function FD(e,t){1&e&&(xo(0,"div"),ai(),Fo(1,"svg",21),ko()),2&e&&(Jr(1),No("height","80px")("width","80px"))}function UD(e,t){if(1&e&&(xo(0,"div"),ai(),xo(1,"svg",21),Fo(2,"path"),ko(),ko()),2&e){const e=Ko(3);Jr(1),No("height","80px")("width","80px")("viewBox",e.prepareViewbox(e.missionData.targetRegion.center)),Jr(1),No("fill",e.missionData.targetRegionColour)("d",e.missionData.targetRegion.path)("stroke","black")("stroke-width","2")}}function HD(e,t){1&e&&(xo(0,"div"),ai(),Fo(1,"svg",21),ko()),2&e&&(Jr(1),No("height","80px")("width","80px"))}function GD(e,t){if(1&e){const e=Go();xo(0,"div",7),xo(1,"span",8),sa(2,"target"),ko(),Po(3,UD,3,7,"div",9),Po(4,HD,2,2,"div",9),xo(5,"button",10),Vo("click",function(){return Dt(e),Ko(2).changeTarget()}),sa(6,"change"),ko(),ko()}if(2&e){const e=Ko(2);Jr(3),Lo("ngIf",e.missionData.targetRegion),Jr(1),Lo("ngIf",!e.missionData.targetRegion)}}const BD=function(e){return{selectedMission:e}};function WD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.COLONIZE)}),Fo(1,"img",23),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.COLONIZE))}}function VD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.MOVE)}),Fo(1,"img",24),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.MOVE))}}function zD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.SPY)}),Fo(1,"img",25),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.SPY))}}function YD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.PLUNDER)}),Fo(1,"img",26),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.PLUNDER))}}function KD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.CONQUER)}),Fo(1,"img",27),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.CONQUER))}}function jD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.SEA_MOVE)}),Fo(1,"img",28),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.SEA_MOVE))}}function $D(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.SEA_PLUNDER)}),Fo(1,"img",29),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.SEA_PLUNDER))}}function QD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.SEA_CONQUER)}),Fo(1,"img",30),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.SEA_CONQUER))}}function qD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.FISHING)}),Fo(1,"img",31),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.FISHING))}}function XD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.HUNTING)}),Fo(1,"img",32),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.HUNTING))}}function ZD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.TREASURE)}),Fo(1,"img",33),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.TREASURE))}}function JD(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.CARTOGRAPHY)}),Fo(1,"img",34),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.CARTOGRAPHY))}}function ex(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.SEA_BATTLE)}),Fo(1,"img",35),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.SEA_BATTLE))}}function tx(e,t){if(1&e){const e=Go();xo(0,"div",22),Vo("click",function(){Dt(e);const t=Ko(2);return t.changeMission(t.missions.EXPEDITION)}),Fo(1,"img",36),ko()}if(2&e){const e=Ko(2);Lo("ngClass",Mc(1,BD,e.missionData.missionType===e.missions.EXPEDITION))}}function ix(e,t){if(1&e){const e=Go();xo(0,"span"),xo(1,"span",38),sa(2),ko(),xo(3,"input",39),Vo("ngModelChange",function(t){Dt(e);const i=Ko().$implicit;return Ko(3).troopsHolder[i]=t}),ko(),sa(4),Fo(5,"br"),xo(6,"div",40),sa(7," 0 "),xo(8,"input",41),Vo("ngModelChange",function(t){Dt(e);const i=Ko().$implicit;return Ko(3).troopsHolder[i]=t}),ko(),sa(9),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko(3);Jr(2),na("",t.getTroopName(e),":"),Jr(1),$o("max",t.getTroop(e).size),Lo("ngModel",t.troopsHolder[e]),Jr(1),na("/",t.getTroop(e).size," "),Jr(4),$o("max",t.getTroop(e).size),Lo("ngModel",t.troopsHolder[e]),Jr(1),na(" ",t.getTroop(e).size," ")}}function sx(e,t){if(1&e&&(xo(0,"div"),Po(1,ix,10,7,"span",9),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("ngIf",i.getTroop(e).size>0)}}function rx(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"div"),xo(2,"button",10),Vo("click",function(){return Dt(e),Ko(2).clearAll()}),sa(3,"clear all"),ko(),xo(4,"button",10),Vo("click",function(){return Dt(e),Ko(2).selectAll()}),sa(5,"select all"),ko(),ko(),Po(6,sx,2,1,"div",37),ko()}if(2&e){const e=Ko(2);Jr(6),Lo("ngForOf",e.getTroops(e.missionData.missionType))}}function nx(e,t){if(1&e){const e=Go();xo(0,"span"),xo(1,"span",38),sa(2),ko(),xo(3,"input",39),Vo("ngModelChange",function(t){Dt(e);const i=Ko().$implicit;return Ko(3).troopsHolder[i]=t}),ko(),sa(4),Fo(5,"br"),xo(6,"div",40),sa(7," 0 "),xo(8,"input",41),Vo("ngModelChange",function(t){Dt(e);const i=Ko().$implicit;return Ko(3).troopsHolder[i]=t}),ko(),sa(9),ko(),ko()}if(2&e){const e=Ko().$implicit,t=Ko(3);Jr(2),na("",t.getTroopName(e),":"),Jr(1),$o("max",t.getTroop(e).size),Lo("ngModel",t.troopsHolder[e]),Jr(1),na("/",t.getTroop(e).size," "),Jr(4),$o("max",t.getTroop(e).size),Lo("ngModel",t.troopsHolder[e]),Jr(1),na(" ",t.getTroop(e).size," ")}}function ox(e,t){if(1&e&&(xo(0,"div"),Po(1,nx,10,7,"span",9),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("ngIf",i.getTroop(e).size>0)}}function ax(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"div"),xo(2,"button",10),Vo("click",function(){return Dt(e),Ko(2).clearAll()}),sa(3,"clear all"),ko(),xo(4,"button",10),Vo("click",function(){return Dt(e),Ko(2).selectAll()}),sa(5,"select all"),ko(),ko(),Po(6,ox,2,1,"div",37),xo(7,"div"),xo(8,"label",42),sa(9,"distance: "),ko(),xo(10,"input",43),Vo("ngModelChange",function(t){return Dt(e),Ko(2).expeditionDistance=t}),ko(),ko(),ko()}if(2&e){const e=Ko(2);Jr(6),Lo("ngForOf",e.getTroops(e.missionData.missionType)),Jr(4),$o("min",e.discoveredLand+10),$o("max",e.calculateMaxDistance()),Lo("ngModel",e.expeditionDistance)}}function cx(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span",38),sa(2,"Colonist:"),ko(),xo(3,"input",39),Vo("ngModelChange",function(t){return Dt(e),Ko(2).colonistsHolder=t}),ko(),sa(4),Fo(5,"br"),xo(6,"div",40),sa(7," 0 "),xo(8,"input",41),Vo("ngModelChange",function(t){return Dt(e),Ko(2).colonistsHolder=t}),ko(),sa(9),ko(),ko()}if(2&e){const e=Ko(2);Jr(3),$o("max",e.getFreeWorkers()),Lo("ngModel",e.colonistsHolder),Jr(1),na("/",e.getFreeWorkers(),""),Jr(4),$o("max",e.getFreeWorkers()),Lo("ngModel",e.colonistsHolder),Jr(1),na(" ",e.getFreeWorkers()," ")}}function lx(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span",38),sa(2),ko(),xo(3,"input",39),Vo("ngModelChange",function(t){const i=Dt(e).$implicit;return Ko(3).troopsHolder[i]=t}),ko(),sa(4),Fo(5,"br"),xo(6,"div",40),sa(7," 0 "),xo(8,"input",41),Vo("ngModelChange",function(t){const i=Dt(e).$implicit;return Ko(3).troopsHolder[i]=t}),ko(),sa(9),ko(),ko()}if(2&e){const e=t.$implicit,i=Ko(3);Jr(2),na("",i.getTroopName(e),":"),Jr(1),$o("max",i.getTroop(e).size),Lo("ngModel",i.troopsHolder[e]),Jr(1),na("/",i.getTroop(e).size," "),Jr(4),$o("max",i.getTroop(e).size),Lo("ngModel",i.troopsHolder[e]),Jr(1),na(" ",i.getTroop(e).size," ")}}function ux(e,t){if(1&e&&(xo(0,"div"),Po(1,lx,10,7,"div",37),ko()),2&e){const e=Ko(2);Jr(1),Lo("ngForOf",e.getSpyUnits())}}function hx(e,t){if(1&e&&(xo(0,"div",44),xo(1,"span"),sa(2,"Stats"),ko(),xo(3,"div",45),Fo(4,"app-icon",46),sa(5),ko(),ko()),2&e){const e=Ko(2);Jr(4),Lo("name","colonize")("path","army/mission"),Jr(1),na(" ",5*e.colonistsHolder,"% success chance ")}}function dx(e,t){if(1&e&&(xo(0,"div",45),Fo(1,"app-icon",46),sa(2),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources"),Jr(1),na(" ",e.amount," ")}}const gx=function(e){return{notAvailable:e}};function px(e,t){if(1&e&&(xo(0,"div",45),Fo(1,"app-icon",46),xo(2,"span",50),sa(3),ko(),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources"),Jr(1),Lo("ngClass",Mc(4,gx,!i.hasResource(e.resource,e.amount*i.getUnitsNumber()))),Jr(1),na(" ",e.amount*i.getUnitsNumber()," ")}}function fx(e,t){if(1&e&&(xo(0,"div"),xo(1,"span"),sa(2,"Cost per person"),ko(),xo(3,"div",47),Po(4,dx,3,3,"div",48),Fo(5,"br"),ko(),xo(6,"span"),sa(7,"Total cost"),ko(),xo(8,"div",49),Po(9,px,4,6,"div",48),ko(),ko()),2&e){const e=Ko(2);Jr(4),Lo("ngForOf",e.getMissionCost(e.missionData.missionType)),Jr(5),Lo("ngForOf",e.getMissionCost(e.missionData.missionType))}}function mx(e,t){if(1&e&&(xo(0,"div",45),Fo(1,"app-icon",46),sa(2),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources"),Jr(1),na(" ",e.amount*i.expeditionDistance," ")}}function Sx(e,t){if(1&e&&(xo(0,"div",45),Fo(1,"app-icon",46),xo(2,"span",50),sa(3),ko(),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources"),Jr(1),Lo("ngClass",Mc(4,gx,!i.hasResource(e.resource,e.amount*i.getUnitsNumber()*i.expeditionDistance))),Jr(1),na(" ",e.amount*i.getUnitsNumber()*i.expeditionDistance," ")}}function Ex(e,t){if(1&e&&(xo(0,"div"),xo(1,"span"),sa(2,"Cost per person"),ko(),xo(3,"div",47),Po(4,mx,3,3,"div",48),Fo(5,"br"),ko(),xo(6,"span"),sa(7,"Total cost"),ko(),xo(8,"div",49),Po(9,Sx,4,6,"div",48),xo(10,"div",45),Fo(11,"app-icon",46),xo(12,"span",50),sa(13," 1 "),ko(),ko(),ko(),ko()),2&e){const e=Ko(2);Jr(4),Lo("ngForOf",e.getMissionCost(e.missionData.missionType)),Jr(5),Lo("ngForOf",e.getMissionCost(e.missionData.missionType)),Jr(2),Lo("name","map")("path","resources"),Jr(1),Lo("ngClass",Mc(5,gx,!e.hasResource(e.resources.MAP,1)))}}function vx(e,t){if(1&e&&(xo(0,"div",45),Fo(1,"app-icon",51),xo(2,"span",50),sa(3),ko(),ko()),2&e){const e=Ko(3);Jr(1),Lo("name","cargo"),Jr(1),Lo("ngClass",Mc(4,gx,e.getCargoUtilization()>e.getNavyCapacity())),Jr(1),oa("",e.getCargoUtilization()," /",e.getNavyCapacity(),"")}}function Rx(e,t){if(1&e&&(xo(0,"div",44),xo(1,"span"),sa(2,"Stats"),ko(),xo(3,"div",45),Fo(4,"app-icon",46),sa(5),ko(),xo(6,"div",45),Fo(7,"app-icon",51),sa(8),ko(),xo(9,"div",45),Fo(10,"app-icon",46),sa(11),ko(),xo(12,"div",45),Fo(13,"app-icon",46),sa(14),ko(),xo(15,"div",45),Fo(16,"app-icon",46),sa(17),ko(),Po(18,vx,4,6,"div",52),ko()),2&e){const e=Ko(2);Jr(4),Lo("name","map")("path","resources"),Jr(1),na(" ",e.calculateExpeditionChance(),"% success chance "),Jr(2),Lo("name","land"),Jr(1),na(" ~",e.calculateExpeditionLand()," estimated land "),Jr(2),Lo("name","attack")("path","army"),Jr(1),na(" ",e.getUnitsStrength()," "),Jr(2),Lo("name","defense")("path","army"),Jr(1),na(" ",e.getUnitsDefense()," "),Jr(2),Lo("name","speed")("path","army"),Jr(1),na(" ",e.getSeaUnitsSpeed()," "),Jr(1),Lo("ngIf",e.isSeaLandMission())}}function Ox(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),ra(e.getSeaUnitsSpeed())}}function Tx(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko(3);Jr(1),ra(e.getUnitsSpeed())}}function Ix(e,t){if(1&e&&(xo(0,"div",45),Fo(1,"app-icon",51),xo(2,"span",50),sa(3),ko(),ko()),2&e){const e=Ko(3);Jr(1),Lo("name","cargo"),Jr(1),Lo("ngClass",Mc(4,gx,e.getCargoUtilization()>e.getNavyCapacity())),Jr(1),oa("",e.getCargoUtilization()," /",e.getNavyCapacity(),"")}}function bx(e,t){if(1&e&&(xo(0,"div",44),xo(1,"span"),sa(2,"Stats"),ko(),xo(3,"div",45),Fo(4,"app-icon",46),sa(5),ko(),xo(6,"div",45),Fo(7,"app-icon",46),sa(8),ko(),xo(9,"div",45),Fo(10,"app-icon",46),Po(11,Ox,2,1,"span",9),Po(12,Tx,2,1,"span",9),ko(),Po(13,Ix,4,6,"div",52),ko()),2&e){const e=Ko(2);Jr(4),Lo("name","attack")("path","army"),Jr(1),na(" ",e.getUnitsStrength()," "),Jr(2),Lo("name","defense")("path","army"),Jr(1),na(" ",e.getUnitsDefense()," "),Jr(2),Lo("name","speed")("path","army"),Jr(1),Lo("ngIf",e.isSeaLandMission()),Jr(1),Lo("ngIf",!e.isSeaLandMission()),Jr(1),Lo("ngIf",e.isSeaLandMission())}}function Cx(e,t){if(1&e&&(xo(0,"div",53),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na(" ",e.cannotStartReason," ")}}const yx=function(e){return{inactive:e}};function Ax(e,t){if(1&e){const e=Go();xo(0,"div",4),xo(1,"div",5),sa(2,"New mission"),ko(),xo(3,"div",6),xo(4,"div",7),xo(5,"span",8),sa(6,"origin"),ko(),Po(7,kD,3,7,"div",9),Po(8,FD,2,2,"div",9),xo(9,"button",10),Vo("click",function(){return Dt(e),Ko().changeOrigin()}),sa(10,"change"),ko(),ko(),Po(11,GD,7,2,"div",11),ko(),xo(12,"div",12),Po(13,WD,2,3,"div",13),Po(14,VD,2,3,"div",13),Po(15,zD,2,3,"div",13),Po(16,YD,2,3,"div",13),Po(17,KD,2,3,"div",13),Po(18,jD,2,3,"div",13),Po(19,$D,2,3,"div",13),Po(20,QD,2,3,"div",13),Po(21,qD,2,3,"div",13),Po(22,XD,2,3,"div",13),Po(23,ZD,2,3,"div",13),Po(24,JD,2,3,"div",13),Po(25,ex,2,3,"div",13),Po(26,tx,2,3,"div",13),ko(),xo(27,"div",14),Po(28,rx,7,1,"div",9),Po(29,ax,11,4,"div",9),Po(30,cx,10,6,"div",9),Po(31,ux,2,1,"div",9),xo(32,"div",15),xo(33,"div",16),Po(34,hx,6,3,"div",17),Po(35,fx,10,2,"div",9),Po(36,Ex,14,7,"div",9),ko(),Po(37,Rx,19,15,"div",17),Po(38,bx,14,11,"div",17),ko(),ko(),Po(39,Cx,2,1,"div",18),xo(40,"div",19),xo(41,"button",20),Vo("click",function(){return Dt(e),Ko().start()}),sa(42),ko(),xo(43,"button",10),Vo("click",function(){return Dt(e),Ko().closeModal()}),sa(44,"Cancel"),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(7),Lo("ngIf",e.missionData.originRegion),Jr(1),Lo("ngIf",!e.missionData.originRegion),Jr(3),Lo("ngIf",!e.missionData.targetSeaEvent&&e.missionData.missionType!==e.missions.EXPEDITION),Jr(2),Lo("ngIf",e.isMissionAllowed(e.missions.COLONIZE)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.MOVE)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.SPY)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.PLUNDER)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.CONQUER)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.SEA_MOVE)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.SEA_PLUNDER)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.SEA_CONQUER)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.FISHING)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.HUNTING)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.TREASURE)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.CARTOGRAPHY)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.SEA_BATTLE)),Jr(1),Lo("ngIf",e.isMissionAllowed(e.missions.EXPEDITION)),Jr(2),Lo("ngIf",e.missionData.originRegion&&e.missionData.missionType!==e.missions.SPY&&e.missionData.missionType!==e.missions.COLONIZE&&e.missionData.missionType!==e.missions.EXPEDITION),Jr(1),Lo("ngIf",e.missionData.originRegion&&e.missionData.missionType===e.missions.EXPEDITION),Jr(1),Lo("ngIf",e.missionData.originRegion&&e.missionData.missionType===e.missions.COLONIZE),Jr(1),Lo("ngIf",e.missionData.originRegion&&e.missionData.missionType===e.missions.SPY),Jr(3),Lo("ngIf",e.missionData.missionType===e.missions.COLONIZE),Jr(1),Lo("ngIf",e.missionData.missionType!==e.missions.EXPEDITION),Jr(1),Lo("ngIf",e.missionData.missionType===e.missions.EXPEDITION),Jr(1),Lo("ngIf",e.missionData.missionType===e.missions.EXPEDITION),Jr(1),Lo("ngIf",e.missionData.missionType!==e.missions.COLONIZE&&e.missionData.missionType!==e.missions.EXPEDITION),Jr(1),Lo("ngIf",!e.canStart()),Jr(2),Lo("ngClass",Mc(29,yx,!e.canStart())),Jr(1),ra(e.getMissionName())}}let Nx=(()=>{class e{constructor(e,t,i,s,r){this.servicesService=e,this.modalService=t,this.idService=i,this.resourcesService=s,this.worldService=r,this.colonistsHolder=0,this.troopsHolder=new Array(Object.values(Wf).length).fill(0),this.expeditionDistance=1,this.discoveredLand=0,this.cannotStartReason="",this.missions=Uf,this.resources=Df,t.registerForMissionData().subscribe(e=>{this.missionData=e,this.troopsHolder=new Array(Object.values(Wf).length).fill(0),this.colonistsHolder=0,this.discoveredLand=this.worldService.getTotalDiscovered(),this.expeditionDistance=this.calculateMaxDistance(),this.cannotStartReason=""})}ngOnInit(){}closeModal(){this.modalService.close(Pf.MISSION),this.missionData=null}conquer(){const e=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,zf.PLAYER),t=new Cy([]);this.getTroops(Uf.CONQUER).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),this.missionData.originRegion.army.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new Rw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}colonize(){if(this.resourcesService.removeRecruit(this.colonistsHolder)){const e=this.worldService.findPath(0,this.missionData.targetRegion.id,zf.PLAYER);this.worldService.addMission(new vw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),new Cy([new by(Wf.COLONIST,this.colonistsHolder)]),e)),this.closeModal()}else this.modalService.info("Not enough villagers")}plunder(){const e=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,zf.PLAYER),t=new Cy([]);this.getTroops(Uf.PLUNDER).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),this.missionData.originRegion.army.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new Ow(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}move(){const e=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,zf.PLAYER),t=new Cy([]);this.getTroops(Uf.MOVE).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),this.missionData.originRegion.army.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new Cw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}spy(){const e=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,zf.SPECIAL);this.worldService.addMission(new yw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),new Cy([new by(Wf.SPY,this.troopsHolder[Wf.SPY])]),e)),this.missionData.originRegion.army.removeTroop(Wf.SPY,this.troopsHolder[Wf.SPY]),this.closeModal()}seaMove(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id),t=new Cy([]);this.getTroops(Uf.SEA_MOVE).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON?this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]):this.missionData.originRegion.army.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new kw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}seaPlunder(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id),t=new Cy([]);this.getTroops(Uf.SEA_PLUNDER).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON?this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]):this.missionData.originRegion.army.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new xw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}seaConquer(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id),t=new Cy([]);this.getTroops(Uf.SEA_CONQUER).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON?this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]):this.missionData.originRegion.army.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new Dw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}fishing(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),t=new Cy([]);this.getTroops(Uf.FISHING).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),(e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON)&&this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new Nw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}hunting(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),t=new Cy([]);this.getTroops(Uf.HUNTING).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),(e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON)&&this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new _w(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}treasure(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),t=new Cy([]);this.getTroops(Uf.TREASURE).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),(e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON)&&this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new ww(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}cartography(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),t=new Cy([]);this.getTroops(Uf.CARTOGRAPHY).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),(e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON)&&this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new Mw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}seaBattle(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),t=new Cy([]);this.getTroops(Uf.SEA_BATTLE).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),(e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON)&&this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]))}),this.worldService.addMission(new Lw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e)),this.closeModal()}expedition(){const e=this.worldService.findSeaPath(this.missionData.originRegion.id,-9999),t=new Cy([]);this.getTroops(Uf.EXPEDITION).forEach(e=>{this.troopsHolder[e]>0&&(t.addTroop(e,this.troopsHolder[e]),e===Wf.BOAT||e===Wf.BRIGANTINE||e===Wf.GALLEON?this.missionData.originRegion.navy.removeTroop(e,this.troopsHolder[e]):this.missionData.originRegion.army.removeTroop(e,this.troopsHolder[e]))});const i=new Pw(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),t,e);i.data=this.calculateExpeditionChance(),this.worldService.addMission(i),this.closeModal()}prepareViewbox(e){return e.x-65+" "+(e.y-65)+" 130 130"}isMissionAllowed(e){if(this.missionData.missionType===Uf.EXPEDITION&&e===Uf.EXPEDITION)return!0;if(this.missionData.targetRegionCountry)if(this.missionData.targetRegionCountry===zf.PLAYER){if(e===Uf.MOVE||e===Uf.SEA_MOVE&&this.isSeaAvailable())return!0}else if(this.missionData.targetRegionCountry===zf.NEUTRAL){if(e===Uf.MOVE||e===Uf.COLONIZE||e===Uf.SEA_MOVE&&this.isSeaAvailable())return!0}else{if(e===Uf.SPY)return!0;if((e===Uf.PLUNDER||e===Uf.CONQUER)&&this.hasPath())return!0;if((e===Uf.SEA_PLUNDER||e===Uf.SEA_CONQUER)&&this.hasSeaPath())return!0}else if(this.missionData.targetSeaEvent&&(this.missionData.targetSeaEvent.type===jf.FISH&&e===Uf.FISHING||this.missionData.targetSeaEvent.type===jf.SHARK&&e===Uf.HUNTING||this.missionData.targetSeaEvent.type===jf.TREASURE&&e===Uf.TREASURE||this.missionData.targetSeaEvent.type===jf.CARTOGRAPHY&&e===Uf.CARTOGRAPHY||this.missionData.targetSeaEvent.type===jf.PIRATES&&e===Uf.SEA_BATTLE||this.missionData.targetSeaEvent.type===jf.PIRATES_BASE&&e===Uf.SEA_BATTLE))return!0;return!1}hasPath(){return!!(this.missionData.originRegion&&this.missionData.targetRegion&&this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,zf.PLAYER,!0))}hasSeaPath(){return!!(this.missionData.originRegion&&this.missionData.targetRegion&&this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,!0))}changeMission(e){this.missionData.missionType=e,e===Uf.COLONIZE&&(this.missionData.originRegion=this.worldService.getRegion(0),this.missionData.originRegionColour=this.worldService.getPlayerCountry().colour)}start(){if(this.canStart()){switch(this.missionData.missionType===Uf.EXPEDITION?this.getMissionCost(this.missionData.missionType).forEach(e=>{this.resourcesService.decreaseResource(e.resource,e.amount*this.getUnitsNumber()*this.expeditionDistance,"Mission",!0)}):this.getMissionCost(this.missionData.missionType).forEach(e=>{this.resourcesService.decreaseResource(e.resource,e.amount*this.getUnitsNumber(),"Mission",!0)}),this.missionData.missionType===Uf.EXPEDITION&&this.resourcesService.decreaseResource(Df.MAP,1,"Mission",!0),this.missionData.missionType){case Uf.MOVE:this.move();break;case Uf.PLUNDER:this.plunder();break;case Uf.CONQUER:this.conquer();break;case Uf.COLONIZE:this.colonize();break;case Uf.SPY:this.spy();break;case Uf.SEA_MOVE:this.seaMove();break;case Uf.SEA_PLUNDER:this.seaPlunder();break;case Uf.SEA_CONQUER:this.seaConquer();break;case Uf.FISHING:this.fishing();break;case Uf.HUNTING:this.hunting();break;case Uf.TREASURE:this.treasure();break;case Uf.CARTOGRAPHY:this.cartography();break;case Uf.SEA_BATTLE:this.seaBattle();break;case Uf.EXPEDITION:this.expedition()}this.troopsHolder=new Array(Object.values(Wf).length).fill(0),this.colonistsHolder=0}}getTroopName(e){return Qf.prepareTroopName(e)}getTroops(e){return e===Uf.MOVE?[Wf.SPY,Wf.MILITIA,Wf.SPEARMAN,Wf.ARCHER,Wf.SWORDSMAN,Wf.LIGHT_CAVALRY,Wf.HORSE_ARCHER]:e===Uf.SEA_MOVE?[Wf.MILITIA,Wf.SPEARMAN,Wf.ARCHER,Wf.SWORDSMAN,Wf.LIGHT_CAVALRY,Wf.HORSE_ARCHER,Wf.BOAT,Wf.BRIGANTINE,Wf.GALLEON]:e===Uf.SEA_PLUNDER||e===Uf.SEA_CONQUER||e===Uf.EXPEDITION?[Wf.SPEARMAN,Wf.ARCHER,Wf.SWORDSMAN,Wf.LIGHT_CAVALRY,Wf.HORSE_ARCHER,Wf.BOAT,Wf.BRIGANTINE,Wf.GALLEON]:e===Uf.FISHING||e===Uf.HUNTING||e===Uf.TREASURE||e===Uf.CARTOGRAPHY||e===Uf.SEA_BATTLE?[Wf.BOAT,Wf.BRIGANTINE,Wf.GALLEON]:[Wf.SPEARMAN,Wf.ARCHER,Wf.SWORDSMAN,Wf.LIGHT_CAVALRY,Wf.HORSE_ARCHER]}getSpyUnits(){return[Wf.SPY]}getTroop(e){return e!==Wf.BOAT&&e!==Wf.BRIGANTINE&&e!==Wf.GALLEON?this.missionData.originRegion.army.units.find(t=>t.troop===e)||new by(e,0):this.missionData.originRegion.navy.units.find(t=>t.troop===e)||new by(e,0)}changeOrigin(){if(this.missionData.missionType!==Uf.COLONIZE){this.modalService.open(Pf.WORLD),this.modalService.setRegionSelection(!0);const e=this.modalService.registerForReturnRegion().subscribe(t=>{e.unsubscribe(),null!==t&&(this.missionData.originRegionColour=this.worldService.getCountryByRegionId(t.id).colour,this.missionData.originRegion=t,this.troopsHolder=new Array(Object.values(Wf).length).fill(0))})}else this.modalService.info("Cannot change origin region for colonization mission")}changeTarget(){this.modalService.open(Pf.WORLD),this.modalService.setRegionSelection(!1);const e=this.modalService.registerForReturnRegion().subscribe(t=>{if(e.unsubscribe(),null!==t){const e=this.worldService.getCountryByRegionId(t.id);this.missionData.targetRegionColour=e.colour,this.missionData.targetRegionCountry=e.id,this.missionData.targetRegion=t,e.id===zf.PLAYER||e.id===zf.NEUTRAL?this.isMissionAllowed(this.missionData.missionType)||(this.missionData.missionType=Uf.MOVE):this.isMissionAllowed(this.missionData.missionType)||(this.missionData.missionType=Uf.PLUNDER,this.troopsHolder[Wf.MILITIA]=0)}})}canStart(){let e=!1;if(this.missionData.originRegion&&this.missionData.targetRegion&&this.missionData.originRegion!==this.missionData.targetRegion?this.missionData.missionType===Uf.SPY&&this.troopsHolder[Wf.SPY]>0?e=!0:this.missionData.missionType===Uf.COLONIZE?e=this.colonistsHolder>0:this.anyTroops()&&(e=!0):this.missionData.originRegion&&this.missionData.targetSeaEvent?this.anyTroops()&&(e=!0):this.missionData.originRegion&&this.missionData.missionType===Uf.EXPEDITION&&this.anyTroops()&&(e=!0),this.missionData.missionType===Uf.FISHING||this.missionData.missionType===Uf.HUNTING||this.missionData.missionType===Uf.TREASURE||this.missionData.missionType===Uf.CARTOGRAPHY||this.missionData.missionType===Uf.SEA_BATTLE)this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId,!0)||(e=!1,this.cannotStartReason="no sea path available");else if(this.missionData.originRegion&&this.missionData.targetRegion&&this.missionData.originRegion!==this.missionData.targetRegion&&this.missionData.missionType===Uf.SEA_MOVE||this.missionData.missionType===Uf.SEA_PLUNDER||this.missionData.missionType===Uf.SEA_CONQUER||this.missionData.missionType===Uf.EXPEDITION)this.missionData.missionType===Uf.EXPEDITION?(this.worldService.findSeaPath(this.missionData.originRegion.id,-9999,!0)||(e=!1,this.cannotStartReason="no sea path available"),this.hasResource(Df.MAP,1)||(e=!1,this.cannotStartReason="missing map resource"),this.calculateExpeditionChance()<=0&&(e=!1,this.cannotStartReason="expedition chance too low"),this.calculateExpeditionLand()<=0&&(e=!1,this.cannotStartReason="estimated land from expedition too low")):this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,!0)||(e=!1,this.cannotStartReason="no sea path available"),e&&0===this.getNavyCapacity()&&(e=!1,this.cannotStartReason="not enough cargo capacity"),e&&this.getCargoUtilization()>this.getNavyCapacity()&&(e=!1,this.cannotStartReason="not enough cargo capacity");else if(e&&(this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,zf.PLAYER,!0)||(e=!1,this.cannotStartReason="no land path available")),e)for(let t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(void 0===this.missionData.originRegion.army.getUnit(t)||this.missionData.originRegion.army.getUnit(t).size<this.troopsHolder[t])&&(e=!1,this.cannotStartReason="not enough troops available");return e&&(this.missionData.missionType!==Uf.EXPEDITION?this.getMissionCost(this.missionData.missionType).forEach(t=>{this.hasResource(t.resource,t.amount*this.getUnitsNumber())||(e=!1,this.cannotStartReason="not enough resources")}):this.getMissionCost(this.missionData.missionType).forEach(t=>{this.hasResource(t.resource,t.amount*this.getUnitsNumber()*this.expeditionDistance)||(e=!1,this.cannotStartReason="not enough resources")})),e}anyTroops(){let e=!1;return this.troopsHolder.forEach(t=>{t>0&&(e=!0)}),e}getFreeWorkers(){return this.resourcesService.getPeople()<20?this.resourcesService.getPeople():20}getMissionCost(e){return aS.getMission(e).COST}getResourceName(e){return Qf.prepareResourceName(e)}getUnitsNumber(){let e=0;if(this.missionData.missionType===Uf.COLONIZE)e=this.colonistsHolder;else for(let t=0;t<this.troopsHolder.length-1;t++)t!==Wf.BOAT&&t!==Wf.BRIGANTINE&&t!==Wf.GALLEON&&(e+=this.troopsHolder[t]);return e}hasResource(e,t){return 0===this.resourcesService.hasResource(e,t,"Mission",!0)}getUnitsStrength(){let e=0;for(let t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(this.missionData.missionType===Uf.SEA_MOVE||this.missionData.missionType===Uf.SEA_PLUNDER||this.missionData.missionType===Uf.SEA_CONQUER?t!==Wf.BOAT&&t!==Wf.BRIGANTINE&&t!==Wf.GALLEON&&(e+=aS.getTroop(t).STRENGTH*this.troopsHolder[t]):e+=aS.getTroop(t).STRENGTH*this.troopsHolder[t]);return e}getUnitsDefense(){let e=0;for(let t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(this.missionData.missionType===Uf.SEA_MOVE||this.missionData.missionType===Uf.SEA_PLUNDER||this.missionData.missionType===Uf.SEA_CONQUER?t!==Wf.BOAT&&t!==Wf.BRIGANTINE&&t!==Wf.GALLEON&&(e+=aS.getTroop(t).DEFENSE*this.troopsHolder[t]):e+=aS.getTroop(t).DEFENSE*this.troopsHolder[t]);return e}getMissionName(){return void 0!==this.missionData.missionType?Qf.prepareMissionName(this.missionData.missionType):"no mission"}getUnitsSpeed(){let e=0;for(let t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(0===e&&(e=aS.getTroop(t).SPEED),aS.getTroop(t).SPEED<e&&(e=aS.getTroop(t).SPEED));return e}getSeaUnitsSpeed(){let e=0;for(let t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(t===Wf.BOAT||t===Wf.BRIGANTINE||t===Wf.GALLEON)&&(0===e&&(e=aS.getTroop(t).SPEED),aS.getTroop(t).SPEED<e&&(e=aS.getTroop(t).SPEED));return e}selectAll(){this.getTroops(this.missionData.missionType).forEach(e=>{this.troopsHolder[e]=this.getTroop(e).size})}clearAll(){for(let e=0;e<this.troopsHolder.length;e++)this.troopsHolder[e]=0}isSeaAvailable(){return this.missionData.originRegion.neighbours.includes(-1)&&this.missionData.targetRegion.neighbours.includes(-1)}isSeaLandMission(){return this.missionData.missionType===Uf.SEA_MOVE||this.missionData.missionType===Uf.SEA_PLUNDER||this.missionData.missionType===Uf.SEA_CONQUER||this.missionData.missionType===Uf.EXPEDITION}getCargoUtilization(){let e=0;for(let i=0;i<this.troopsHolder.length-1;i++)i!==Wf.ALL&&i!==Wf.BOAT&&i!==Wf.BRIGANTINE&&i!==Wf.GALLEON&&this.troopsHolder[i]>0&&(e+=this.troopsHolder[i]*aS.getTroop(i).SIZE);let t=0;return this.missionData.missionType===Uf.EXPEDITION&&this.getUnitsNumber()>0&&this.expeditionDistance>0&&(this.getMissionCost(this.missionData.missionType).forEach(e=>{t+=e.amount*this.getUnitsNumber()*this.expeditionDistance}),e+=Math.ceil(t/1e3)),e}getNavyCapacity(){let e=0;for(let t=0;t<this.troopsHolder.length-1;t++)(t===Wf.BOAT||t===Wf.BRIGANTINE||t===Wf.GALLEON)&&this.troopsHolder[t]>0&&(e+=this.troopsHolder[t]*aS.getTroop(t).CARGO);return e}calculateExpeditionChance(){return this.discoveredLand=this.worldService.getTotalDiscovered(),Math.max(this.expeditionDistance-this.discoveredLand,0)}calculateMaxDistance(){return this.discoveredLand=this.worldService.getTotalDiscovered(),this.discoveredLand+100}calculateExpeditionLand(){let e=0;for(let t=0;t<this.troopsHolder.length-1;t++)t!==Wf.ALL&&t!==Wf.BOAT&&t!==Wf.BRIGANTINE&&t!==Wf.GALLEON&&this.troopsHolder[t]>0&&(e+=this.troopsHolder[t]*(aS.getTroop(t).STRENGTH+aS.getTroop(t).DEFENSE));return e}}return e.\u0275fac=function(t){return new(t||e)(Mo(Jf),Mo(em),Mo(NO),Mo(Pv),Mo(Uw))},e.\u0275cmp=Ve({type:e,selectors:[["app-mission-modal"]],decls:4,vars:1,consts:[["id","mission-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],["id","regions"],[1,"region"],[1,"center"],[4,"ngIf"],[3,"click"],["class","region",4,"ngIf"],["id","missions"],["class","mission",3,"ngClass","click",4,"ngIf"],["id","secondHalf"],["id","bottomSection"],["id","costs"],["class","stats",4,"ngIf"],["class","rejectionReason",4,"ngIf"],["id","buttons"],["id","startButton",3,"ngClass","click"],[1,"regionSVG"],[1,"mission",3,"ngClass","click"],["src","assets/army/mission/colonize.svg"],["src","assets/army/mission/move.svg"],["src","assets/army/mission/spy.svg"],["src","assets/army/mission/plunder.svg"],["src","assets/army/mission/conquer.svg"],["src","assets/army/mission/sea_move.svg"],["src","assets/army/mission/sea_plunder.svg"],["src","assets/army/mission/sea_conquer.svg"],["src","assets/sea/fish.svg",1,"seaIcon"],["src","assets/sea/shark.svg",1,"seaIcon"],["src","assets/sea/treasure.svg",1,"seaIcon"],["src","assets/sea/sextant.svg",1,"seaIcon"],["src","assets/sea/pirate_flag.svg",1,"seaIcon"],["src","assets/resources/map.svg",1,"seaIcon"],[4,"ngFor","ngForOf"],[1,"troopLabel"],["type","number","min","0",1,"armyInput",3,"max","ngModel","ngModelChange"],[1,"slidecontainer"],["type","range","min","0",1,"slider",3,"max","ngModel","ngModelChange"],["for","distanceInput"],["id","distanceInput","type","number",3,"min","max","ngModel","ngModelChange"],[1,"stats"],[1,"icon"],[3,"name","path"],["id","costList"],["class","icon",4,"ngFor","ngForOf"],["id","totalCostList"],[3,"ngClass"],[3,"name"],["class","icon",4,"ngIf"],[1,"rejectionReason"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),Po(2,Ax,45,31,"div",2),ko(),Fo(3,"div",3),ko()),2&e&&(Jr(2),Lo("ngIf",t.missionData))},directives:[jM,Gu,ku,Uu,JT,XT,DT,KO,dT,MT,GT,sI],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#regions[_ngcontent-%COMP%]{display:flex;flex-direction:row}.region[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px}.regionSVG[_ngcontent-%COMP%]{border:black solid 1px}.center[_ngcontent-%COMP%]{text-align:center}#missions[_ngcontent-%COMP%]{display:flex;flex-direction:row}.mission[_ngcontent-%COMP%]{height:50px;width:50px;border:black solid 1px;padding:5px;margin:10px;opacity:.3;cursor:pointer}.selectedMission[_ngcontent-%COMP%]{opacity:1;cursor:auto;cursor:initial}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px}.slidecontainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:3px;width:300px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.armyInput[_ngcontent-%COMP%]{width:5ch}#distanceInput[_ngcontent-%COMP%]{width:8ch}.troopLabel[_ngcontent-%COMP%]{display:inline-block;width:150px}.inactive[_ngcontent-%COMP%]{color:#5f5f5f}.inactive[_ngcontent-%COMP%]:hover{cursor:auto;cursor:initial}.inactive[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}#secondHalf[_ngcontent-%COMP%]{font-size:.7em;padding-bottom:10px}#costs[_ngcontent-%COMP%]{text-align:center}#costList[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}#totalCostList[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-right:3px}.notAvailable[_ngcontent-%COMP%]{color:var(--negative-colour)}#bottomSection[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;margin-top:10px}#bottomSection[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:10px}.stats[_ngcontent-%COMP%]{text-align:center}#startButton[_ngcontent-%COMP%]{white-space:nowrap}.seaIcon[_ngcontent-%COMP%]{height:50px;width:50px}.rejectionReason[_ngcontent-%COMP%]{color:var(--negative-colour);font-size:.6em}"]}),e})();function _x(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span",5),sa(2,"Clothes"),ko(),xo(3,"input",15),Vo("input",function(){return Dt(e),Ko().calculateStats()})("ngModelChange",function(t){return Dt(e),Ko().clothes=t}),ko(),sa(4),ko()}if(2&e){const e=Ko();Jr(3),$o("max",e.getMaxClothes()),Lo("ngModel",e.clothes),Jr(1),na("/",e.getMaxClothes()," ")}}function wx(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span",5),sa(2,"Beer"),ko(),xo(3,"input",15),Vo("input",function(){return Dt(e),Ko().calculateStats()})("ngModelChange",function(t){return Dt(e),Ko().beer=t}),ko(),sa(4),ko()}if(2&e){const e=Ko();Jr(3),$o("max",e.getMaxBeer()),Lo("ngModel",e.beer),Jr(1),na("/",e.getMaxBeer()," ")}}function Px(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span",5),sa(2,"Wine"),ko(),xo(3,"input",15),Vo("input",function(){return Dt(e),Ko().calculateStats()})("ngModelChange",function(t){return Dt(e),Ko().wine=t}),ko(),sa(4),ko()}if(2&e){const e=Ko();Jr(3),$o("max",e.getMaxWine()),Lo("ngModel",e.wine),Jr(1),na("/",e.getMaxWine()," ")}}function Mx(e,t){if(1&e){const e=Go();xo(0,"div"),xo(1,"span",5),sa(2,"Jewelry"),ko(),xo(3,"input",15),Vo("input",function(){return Dt(e),Ko().calculateStats()})("ngModelChange",function(t){return Dt(e),Ko().jewelry=t}),ko(),sa(4),ko()}if(2&e){const e=Ko();Jr(3),$o("max",e.getMaxJewelry()),Lo("ngModel",e.jewelry),Jr(1),na("/",e.getMaxJewelry()," ")}}const Lx=function(e){return{notMet:e}};function Dx(e,t){if(1&e&&(xo(0,"span",16),Fo(1,"app-icon",17),sa(2," \xa0"),xo(3,"span",18),sa(4),ko(),ko()),2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources")("title",i.getResourceName(e.resource)),Jr(2),Lo("ngClass",Mc(5,Lx,!i.hasResource(e.resource,e.amount))),Jr(1),ra(e.amount)}}const xx=function(e){return{inactive:e}};let kx=(()=>{class e{constructor(e,t,i,s){this.modalService=e,this.happinessService=t,this.resourceService=i,this.gameService=s,this.food=1,this.clothes=0,this.beer=0,this.wine=0,this.jewelry=0,this.duration=1,this.happiness=5,e.registerForOnOpen().subscribe(e=>{e===Pf.FESTIVAL&&(this.food=Math.ceil(5*this.resourceService.getTotalPeople()/2),this.clothes=0,this.beer=0,this.wine=0,this.jewelry=0,this.happiness=1,this.duration=5)})}ngOnInit(){}onKeydownHandler(e){"none"!==document.getElementById("festival-modal").style.display&&(e.preventDefault(),this.modalService.close(Pf.FESTIVAL))}closeModal(){this.modalService.close(Pf.FESTIVAL)}startFestival(){this.canStart(!0)&&(this.getCost().forEach(e=>{this.resourceService.decreaseResource(e.resource,e.amount,"Festival",!0)}),this.happinessService.addHappinessEffect(0,$f.FESTIVAL,this.happiness,this.duration),this.modalService.close(Pf.FESTIVAL))}getDuration(){return this.duration}getPoints(){return Math.floor((2*this.food+500*this.clothes+125*this.wine+75*this.beer+300*this.jewelry*25)/this.resourceService.getTotalPeople())}getHappiness(){return this.happiness}getCost(){const e=[];return this.food>0&&e.push({resource:Df.FOOD,amount:this.food}),this.clothes>0&&e.push({resource:Df.CLOTHES,amount:this.clothes}),this.beer>0&&e.push({resource:Df.BEER,amount:this.beer}),this.wine>0&&e.push({resource:Df.WINE,amount:this.wine}),this.jewelry>0&&e.push({resource:Df.JEWELRY,amount:this.jewelry}),e}getMaxHappinessThreshold(){return this.gameService.isEnabled(Mf.JEWELRY)||this.resourceService.getResource(Df.JEWELRY).isVisible()?20:this.gameService.isEnabled(Mf.ALCOHOL)?15:this.gameService.isEnabled(Mf.TAILOR)?10:4}canStart(e=!1){if(this.calculateStats(),this.happiness<1)return e&&this.modalService.info("Happiness must be at least 1"),!1;if(this.duration<1)return e&&this.modalService.info("Duration must be at least 1"),!1;let t=!0;return this.getCost().forEach(e=>{t&&(t=0===this.resourceService.hasResource(e.resource,e.amount,"Festival",!0))}),!t&&e&&this.modalService.info("Not enough resources!"),t}getResourceName(e){return Qf.prepareResourceName(e)}getNutrition(){return this.resourceService.getFoodValue("Festival",!0)}getMaxClothes(){return this.resourceService.getResource(Df.CLOTHES).amount}getMaxWine(){return this.resourceService.getResource(Df.WINE).amount}getMaxBeer(){return this.resourceService.getResource(Df.BEER).amount}getMaxJewelry(){return this.resourceService.getResource(Df.JEWELRY).amount}isClothesEnabled(){return this.gameService.isEnabled(Mf.TAILOR)}isAlcoholEnabled(){return this.gameService.isEnabled(Mf.ALCOHOL)}isJewelryEnabled(){return this.gameService.isEnabled(Mf.JEWELRY)||this.resourceService.getResource(Df.JEWELRY).isVisible()}calculateStats(){this.duration=Math.floor(this.getPoints()/this.happiness)}hasResource(e,t){return 0===this.resourceService.hasResource(e,t,"Festival",!0)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(Av),Mo(Pv),Mo(AS))},e.\u0275cmp=Ve({type:e,selectors:[["app-festival-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:33,vars:14,consts:[["id","festival-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["id","text"],[1,"label"],["type","number","min","1",1,"input",3,"max","ngModel","input","ngModelChange"],[4,"ngIf"],["id","costList"],[1,"iconsLine"],["class","icon",4,"ngFor","ngForOf"],["id","buttons"],[3,"ngClass","click"],[3,"click"],[1,"modal-background"],["type","number","min","0",1,"input",3,"max","ngModel","input","ngModelChange"],[1,"icon"],[3,"name","path","title"],[3,"ngClass"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"div",3),sa(4,"Festival preparations"),ko(),xo(5,"span",4),sa(6,"\xa0"),ko(),Fo(7,"br"),xo(8,"div"),xo(9,"span",5),sa(10,"Food"),ko(),xo(11,"input",6),Vo("input",function(){return t.calculateStats()})("ngModelChange",function(e){return t.food=e}),ko(),sa(12),ko(),Po(13,_x,5,3,"div",7),Po(14,wx,5,3,"div",7),Po(15,Px,5,3,"div",7),Po(16,Mx,5,3,"div",7),Fo(17,"hr"),xo(18,"div",8),xo(19,"div",9),Po(20,Dx,5,7,"span",10),ko(),ko(),xo(21,"span"),sa(22),ko(),xo(23,"span"),sa(24),ko(),xo(25,"span"),sa(26),ko(),xo(27,"div",11),xo(28,"button",12),Vo("click",function(){return t.startFestival()}),sa(29,"Start festival"),ko(),xo(30,"button",13),Vo("click",function(){return t.closeModal()}),sa(31,"Cancel"),ko(),ko(),ko(),ko(),Fo(32,"div",14),ko()),2&e&&(Jr(11),$o("max",t.getNutrition()),Lo("ngModel",t.food),Jr(1),na("/",t.getNutrition()," "),Jr(1),Lo("ngIf",t.isClothesEnabled()),Jr(1),Lo("ngIf",t.isAlcoholEnabled()),Jr(1),Lo("ngIf",t.isAlcoholEnabled()),Jr(1),Lo("ngIf",t.isJewelryEnabled()),Jr(4),Lo("ngForOf",t.getCost()),Jr(2),na("Festival Points: ",t.getPoints(),""),Jr(2),na("Festival happiness: ",t.getHappiness(),""),Jr(2),na("Festival duration: ",t.getDuration()," days"),Jr(2),Lo("ngClass",Mc(12,xx,!t.canStart())))},directives:[jM,JT,XT,DT,KO,dT,MT,Gu,Uu,ku,sI],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:160px auto auto}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px;white-space:nowrap}.slidecontainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:3px;width:300px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.label[_ngcontent-%COMP%]{display:inline-block;width:150px}.input[_ngcontent-%COMP%]{width:10ch}.inactive[_ngcontent-%COMP%]{color:#5f5f5f}.iconsLine[_ngcontent-%COMP%]{display:flex;flex-direction:row}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-right:7px}hr[_ngcontent-%COMP%]{border-color:#000;width:50%}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e})();const Fx=["input"];function Ux(e,t){1&e&&(xo(0,"span"),sa(1,"buy"),ko())}function Hx(e,t){1&e&&(xo(0,"span"),sa(1,"sell"),ko())}function Gx(e,t){1&e&&(xo(0,"span"),sa(1,"BUY"),ko())}function Bx(e,t){1&e&&(xo(0,"span"),sa(1,"SELL"),ko())}function Wx(e,t){if(1&e){const e=Go();xo(0,"div",4),xo(1,"span",5),sa(2,"Market offer"),ko(),xo(3,"span",6),sa(4,"How many "),Fo(5,"app-icon",7),sa(6),Po(7,Ux,2,0,"span",8),Po(8,Hx,2,0,"span",8),sa(9,"?"),ko(),Fo(10,"br"),xo(11,"span",9),xo(12,"input",10,11),Vo("ngModelChange",function(t){return Dt(e),Ko().checkValue(t)})("ngModelChange",function(t){return Dt(e),Ko().value=t}),ko(),sa(14),Fo(15,"app-icon",7),sa(16),Fo(17,"app-icon",7),ko(),Fo(18,"br"),xo(19,"div",12),xo(20,"button",13),Vo("click",function(){return Dt(e),Ko().ok()}),Po(21,Gx,2,0,"span",8),Po(22,Bx,2,0,"span",8),ko(),xo(23,"button",13),Vo("click",function(){return Dt(e),Ko().cancel()}),sa(24,"CANCEL"),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(5),Lo("name",e.getResourceName(e.offer.resource))("path","resources"),Jr(1),oa("(",e.getResourceAmount(),"/",e.getResourceLimit(),") would you like to "),Jr(1),Lo("ngIf",e.offer.buy),Jr(1),Lo("ngIf",!e.offer.buy),Jr(4),Lo("ngModel",e.value),Jr(2),na("/",e.offer.amount," "),Jr(1),Lo("name",e.getResourceName(e.offer.resource))("path","resources"),Jr(1),na(" for ",e.calculatePrice()," "),Jr(1),Lo("name","coins")("path","resources"),Jr(4),Lo("ngIf",e.offer.buy),Jr(1),Lo("ngIf",!e.offer.buy)}}let Vx=(()=>{class e{constructor(e,t){this.modalService=e,this.resourcesService=t}ngOnInit(){this.modalService.registerForValue().subscribe(e=>{e&&void 0!==e.id&&(this.offer=e,this.value=this.offer.amount,this.inputRef&&(this.inputRef.nativeElement.style.width=this.value.toString().length+1+"ch"))})}ok(){this.checkValue(this.value),this.modalService.sendValueInput(Number(this.value)),this.modalService.close(Pf.MARKET),this.offer=null}cancel(){this.modalService.sendValueInput(null),this.offer=null,this.modalService.close(Pf.MARKET)}onKeydownHandler(e){"none"!==document.getElementById("market-modal").style.display&&(e.preventDefault(),this.ok())}getResourceName(e){return Df[e]}calculatePrice(){let e=this.value;return this.offer.amount<e&&(e=this.offer.amount),this.offer.buy?Math.ceil(e/this.offer.amount*this.offer.price):Math.floor(e/this.offer.amount*this.offer.price)}checkValue(e){if(e&&!isNaN(e)){if(this.offer.amount>=e)return!0;this.inputRef.nativeElement.value=this.offer.amount,this.value=this.offer.amount}return!1}getResourceAmount(){return this.resourcesService.getResource(this.offer.resource).amount}getResourceLimit(){return this.resourcesService.getResource(this.offer.resource).limit}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(Pv))},e.\u0275cmp=Ve({type:e,selectors:[["app-market-modal"]],viewQuery:function(e,t){if(1&e&&il(Fx,5),2&e){let e;tl(e=rl())&&(t.inputRef=e.first)}},hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:4,vars:1,consts:[["id","market-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],["id","text",1,"icon"],[3,"name","path"],[4,"ngIf"],[1,"icon"],["id","input",3,"ngModel","ngModelChange"],["input",""],["id","buttons"],[3,"click"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),Po(2,Wx,25,15,"div",2),ko(),Fo(3,"div",3),ko()),2&e&&(Jr(2),Lo("ngIf",t.offer))},directives:[jM,Gu,sI,KO,dT,MT],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:5px}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}#input[_ngcontent-%COMP%]{display:inline-block;width:3ch;font-size:1em}app-icon[_ngcontent-%COMP%]{display:inline-block;margin:0 3px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}"]}),e})();function zx(e,t){1&e&&(Uo(0),sa(1," working"),Ho())}function Yx(e,t){1&e&&(Uo(0),sa(1," not working"),Ho())}function Kx(e,t){if(1&e){const e=Go();Uo(0),xo(1,"button",23),Vo("click",function(){return Dt(e),Ko(2).stop()}),sa(2,"Hire worker"),ko(),Ho()}}function jx(e,t){if(1&e){const e=Go();Uo(0),xo(1,"button",23),Vo("click",function(){return Dt(e),Ko(2).stop()}),sa(2,"Fire worker"),ko(),Ho()}}function $x(e,t){if(1&e){const e=Go();xo(0,"div",24),sa(1),xo(2,"input",7),Vo("ngModelChange",function(t){return Dt(e),Ko(2).building.getWorkSettings().customRuleEnabled=t}),ko(),Fo(3,"br"),ko()}if(2&e){const e=Ko(2);Jr(1),na(" ",e.building.getWorkSettings().customRuleText," "),Jr(1),Lo("ngModel",e.building.getWorkSettings().customRuleEnabled)}}function Qx(e,t){if(1&e){const e=Go();xo(0,"div"),Fo(1,"app-icon",27),sa(2," > "),xo(3,"input",28),Vo("ngModelChange",function(t){return Dt(e).$implicit[1]=t}),ko(),sa(4),ko()}if(2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("name",i.getResourceName(e[0]))("path","resources"),Jr(2),Lo("ngModel",e[1]),Jr(1),oa(" ( ",i.getResource(e[0]).amount,"/",i.getResource(e[0]).limit," ) ")}}function qx(e,t){if(1&e&&(xo(0,"div",25),sa(1," Input resources: "),Po(2,Qx,5,5,"div",26),ko()),2&e){const e=Ko(2);Jr(2),Lo("ngForOf",e.building.getWorkSettings().inputSettings)}}function Xx(e,t){1&e&&(xo(0,"span"),sa(1,"\u221e"),ko())}function Zx(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko().$implicit,t=Ko(3);Jr(1),ra(t.getResource(e[0]).limit)}}function Jx(e,t){if(1&e){const e=Go();xo(0,"span"),xo(1,"input",28),Vo("ngModelChange",function(t){return Dt(e),Ko().$implicit[1]=t}),ko(),sa(2),ko()}if(2&e){const e=Ko().$implicit,t=Ko(3);Jr(1),Lo("ngModel",e[1]),Jr(1),na(" (",t.getResource(e[0]).amount,"")}}function ek(e,t){1&e&&(xo(0,"span"),sa(1,"\u221e"),ko())}function tk(e,t){if(1&e&&(xo(0,"span"),sa(1),ko()),2&e){const e=Ko().$implicit,t=Ko(3);Jr(1),ra(t.getResource(e[0]).limit)}}function ik(e,t){if(1&e){const e=Go();xo(0,"div"),Fo(1,"app-icon",27),sa(2," < "),Po(3,Xx,2,0,"span",6),Po(4,Zx,2,1,"span",6),Po(5,Jx,3,2,"span",6),sa(6," / "),Po(7,ek,2,0,"span",6),Po(8,tk,2,1,"span",6),sa(9,") "),xo(10,"input",30),Vo("ngModelChange",function(t){return Dt(e).$implicit[2]=t}),ko(),xo(11,"label",31),sa(12,"full"),ko(),ko()}if(2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("name",i.getResourceName(e[0]))("path","resources"),Jr(2),Lo("ngIf",e[2]&&i.isCoins(e[0])),Jr(1),Lo("ngIf",e[2]&&!i.isCoins(e[0])),Jr(1),Lo("ngIf",!e[2]),Jr(2),Lo("ngIf",i.isCoins(e[0])),Jr(1),Lo("ngIf",!i.isCoins(e[0])),Jr(2),Lo("ngModel",e[2])}}function sk(e,t){if(1&e&&(xo(0,"div",29),sa(1," Output resources: "),Po(2,ik,13,8,"div",26),ko()),2&e){const e=Ko(2);Jr(2),Lo("ngForOf",e.building.getWorkSettings().outputSettings)}}function rk(e,t){if(1&e){const e=Go();xo(0,"div",4),xo(1,"span",5),sa(2),ko(),Fo(3,"br"),Fo(4,"br"),sa(5," status: "),Po(6,zx,2,0,"ng-container",6),Po(7,Yx,2,0,"ng-container",6),Po(8,Kx,3,0,"ng-container",6),Po(9,jx,3,0,"ng-container",6),Fo(10,"br"),sa(11," work management on/off "),xo(12,"input",7),Vo("ngModelChange",function(t){return Dt(e),Ko().building.getWorkSettings().enabled=t}),ko(),Fo(13,"br"),Fo(14,"br"),xo(15,"div",8),xo(16,"div"),sa(17,"Seasonal rules"),ko(),xo(18,"span",9),xo(19,"label",10),sa(20,"Spring"),ko(),xo(21,"input",11),Vo("ngModelChange",function(t){return Dt(e),Ko().building.getWorkSettings().seasons[0]=t}),ko(),ko(),xo(22,"span",9),xo(23,"label",12),sa(24,"Summer"),ko(),xo(25,"input",13),Vo("ngModelChange",function(t){return Dt(e),Ko().building.getWorkSettings().seasons[1]=t}),ko(),ko(),xo(26,"span",9),xo(27,"label",14),sa(28,"Autumn"),ko(),xo(29,"input",15),Vo("ngModelChange",function(t){return Dt(e),Ko().building.getWorkSettings().seasons[2]=t}),ko(),ko(),xo(30,"span",9),xo(31,"label",16),sa(32,"Winter"),ko(),xo(33,"input",17),Vo("ngModelChange",function(t){return Dt(e),Ko().building.getWorkSettings().seasons[3]=t}),ko(),ko(),Fo(34,"br"),Fo(35,"br"),ko(),Po(36,$x,4,2,"div",18),xo(37,"div",19),Po(38,qx,3,1,"div",20),Fo(39,"br"),Po(40,sk,3,1,"div",21),ko(),Fo(41,"br"),Fo(42,"br"),xo(43,"div",22),xo(44,"button",23),Vo("click",function(){return Dt(e),Ko().applyToAll()}),sa(45,"Apply to all buildings of this type"),ko(),xo(46,"button",23),Vo("click",function(){return Dt(e),Ko().ok()}),sa(47,"Close"),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(2),na("",e.getBuildingName()," work management"),Jr(4),Lo("ngIf",e.building.isWorking()),Jr(1),Lo("ngIf",!e.building.isWorking()),Jr(1),Lo("ngIf",!e.building.getWorkSettings().enabled&&!e.building.isWorking()),Jr(1),Lo("ngIf",!e.building.getWorkSettings().enabled&&e.building.isWorking()),Jr(3),Lo("ngModel",e.building.getWorkSettings().enabled),Jr(9),Lo("ngModel",e.building.getWorkSettings().seasons[0]),Jr(4),Lo("ngModel",e.building.getWorkSettings().seasons[1]),Jr(4),Lo("ngModel",e.building.getWorkSettings().seasons[2]),Jr(4),Lo("ngModel",e.building.getWorkSettings().seasons[3]),Jr(3),Lo("ngIf",e.building.getWorkSettings().hasCustomRule),Jr(2),Lo("ngIf",e.building.getWorkSettings().inputSettings),Jr(2),Lo("ngIf",e.building.getWorkSettings().outputSettings)}}let nk=(()=>{class e{constructor(e,t,i){this.servicesService=e,this.modalService=t,this.resourcesService=i,this.modalService.registerForBuilding().subscribe(e=>{this.building=e,setTimeout(function(){const e=window.document.getElementsByClassName("textInput").item(0);e&&e.select()},10)})}ngOnInit(){}ok(){this.modalService.close(Pf.WORK_MANAGEMENT)}cancel(){this.modalService.close(Pf.WORK_MANAGEMENT)}stop(){this.building.isWorking()?this.building.stopProduction():this.building.startProduction()||this.modalService.info("Cannot unlock production of "+this.building.getName()+". Number of free workers: "+this.resourcesService.getPeople())}getBuildingName(){return Qf.prepareBuildingName(this.building.getBuildingType())}getResourceName(e){return Qf.prepareResourceName(e)}getResource(e){return this.resourcesService.getResource(e)}onKeydownHandler(){"none"!==document.getElementById("work-management-modal").style.display&&(event.preventDefault(),this.ok())}isCoins(e){return e===Df.COINS}applyToAll(){const e=nS.getBuildingRegion(this.building.getBuildingType());this.servicesService.getServiceByRegion(e).getBuildings().filter(e=>e.getBuildingType()===this.building.getBuildingType()).forEach(e=>e.setWorkSettings(kv.clone(this.building.getWorkSettings())))}}return e.\u0275fac=function(t){return new(t||e)(Mo(Jf),Mo(em),Mo(Pv))},e.\u0275cmp=Ve({type:e,selectors:[["app-work-management-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:4,vars:1,consts:[["id","work-management-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],[4,"ngIf"],["type","checkbox",3,"ngModel","ngModelChange"],["id","seasonalRules"],[1,"seasonalRule"],["for","spring"],["id","spring","type","checkbox",3,"ngModel","ngModelChange"],["for","summer"],["id","summer","type","checkbox",3,"ngModel","ngModelChange"],["for","autumn"],["id","autumn","type","checkbox",3,"ngModel","ngModelChange"],["for","winter"],["id","winter","type","checkbox",3,"ngModel","ngModelChange"],["id","customRule",4,"ngIf"],["id","rules"],["id","input",4,"ngIf"],["id","output",4,"ngIf"],["id","buttons"],[3,"click"],["id","customRule"],["id","input"],[4,"ngFor","ngForOf"],[3,"name","path"],[1,"textInput",3,"ngModel","ngModelChange"],["id","output"],["type","checkbox","id","full",3,"ngModel","ngModelChange"],["for","full"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),Po(2,rk,48,13,"div",2),ko(),Fo(3,"div",3),ko()),2&e&&(Jr(2),Lo("ngIf",t.building))},directives:[jM,Gu,VO,dT,MT,Uu,sI,KO],styles:[".modal-body[_ngcontent-%COMP%]{text-align:center;font-size:1.2em}input[_ngcontent-%COMP%]:not([type]), input[type=text][_ngcontent-%COMP%]{width:5ch}#rules[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#input[_ngcontent-%COMP%]{flex:0 0 50%;border-right:black solid 1px}#output[_ngcontent-%COMP%]{flex:0 0 50%}.seasonalRule[_ngcontent-%COMP%]{margin-right:10px}"]}),e})();function ok(e,t){if(1&e){const e=Go();xo(0,"button",9),Vo("click",function(){return Dt(e),Ko(2).ok()}),sa(1,"NEXT"),ko()}}function ak(e,t){if(1&e){const e=Go();xo(0,"button",9),Vo("click",function(){return Dt(e),Ko(2).finish()}),sa(1,"FINISH"),ko()}}function ck(e,t){if(1&e){const e=Go();xo(0,"button",9),Vo("click",function(){return Dt(e),Ko(2).skip()}),sa(1,"SKIP TUTORIAL"),ko()}}function lk(e,t){if(1&e&&(Uo(0),xo(1,"span",5),sa(2),ko(),Fo(3,"div",6),Fo(4,"span",7),Fo(5,"br"),Fo(6,"div",6),Po(7,ok,2,0,"button",8),Po(8,ak,2,0,"button",8),Po(9,ck,2,0,"button",8),Ho()),2&e){const e=Ko();Jr(2),na("Tutorial ",e.currentStep+"/"+e.tutorialStages.length,""),Jr(2),Lo("innerHTML",e.tutorialStages[e.currentStep-1].text,Js),Jr(3),Lo("ngIf",e.currentStep<e.tutorialStages.length),Jr(1),Lo("ngIf",e.currentStep===e.tutorialStages.length),Jr(1),Lo("ngIf",e.currentStep!==e.tutorialStages.length)}}let uk=(()=>{class e{constructor(e,t,i,s){this.modalService=e,this.tutorialService=t,this.tickerService=i,this.text="",this.tutorialStages=[],this.currentStep=1,this.modalService.registerForTutorial().subscribe(e=>{this.tutorialStages=e,this.currentStep=1,s.destroyed||s.detectChanges()})}ngOnInit(){}ngAfterViewInit(){this.tutorialService.enableTutorials()}ok(){this.currentStep+=1,this.modalService.openTutorialModal(this.tutorialStages[this.currentStep-1].position)}skip(){this.modalService.open(Pf.CONFIRM),this.modalService.setModalText("Are you sure you want to skip tutorial?<br>You can always start it again from the top right settings menu");const e=this.modalService.registerForConfirmation().subscribe(t=>{e.unsubscribe(),t&&(this.modalService.sendTutorialResponse(-1),this.tickerService.start(),this.modalService.close(Pf.TUTORIAL))})}finish(){this.modalService.sendTutorialResponse(1),this.tickerService.start(),this.modalService.close(Pf.TUTORIAL)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(yS),Mo(fL),Mo(nc))},e.\u0275cmp=Ve({type:e,selectors:[["app-tutorial-modal"]],decls:5,vars:1,consts:[["id","tutorial-modal"],[1,"modal"],[1,"modal-body"],[4,"ngIf"],[1,"modal-background"],["id","title"],[1,"space"],["id","text",3,"innerHTML"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),Po(3,lk,10,5,"ng-container",3),ko(),ko(),Fo(4,"div",4),ko()),2&e&&(Jr(3),Lo("ngIf",t.tutorialStages.length>0))},directives:[jM,Gu],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.space[_ngcontent-%COMP%]{height:20px}"]}),e})();const hk=["text"];let dk=(()=>{class e{constructor(e){this.modalService=e,this.messageNumber=CS.length,this.modalService.registerForCloseModal().subscribe(e=>this.messageNumber=CS.length),this.modalService.registerForOnOpen().subscribe(e=>{(e===Pf.CHANGELOG||e===Pf.ALL)&&(this.textRef.nativeElement.scrollTop=0)})}ngOnInit(){}ok(){this.modalService.close(Pf.CHANGELOG)}hasPrevious(){return this.messageNumber>1}previous(){this.messageNumber>1&&(this.messageNumber-=1)}hasNext(){return this.messageNumber<CS.length}next(){this.messageNumber<CS.length&&(this.messageNumber+=1)}onKeydownHandler(e){"none"!==document.getElementById("changelog-modal").style.display&&(e.preventDefault(),this.ok())}getChange(){return CS[this.messageNumber-1]}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-changelog-modal"]],viewQuery:function(e,t){if(1&e&&il(hk,5),2&e){let e;tl(e=rl())&&(t.textRef=e.first)}},hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:15,vars:4,consts:[["id","changelog-modal"],[1,"modal"],[1,"modal-body"],["id","header",3,"innerHTML"],["id","text",3,"innerHTML"],["text",""],["id","buttons"],[3,"disabled","click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),Fo(3,"span",3),Fo(4,"div",4,5),Fo(6,"br"),xo(7,"div",6),xo(8,"button",7),Vo("click",function(){return t.previous()}),sa(9,"PREVIOUS"),ko(),xo(10,"button",8),Vo("click",function(){return t.ok()}),sa(11,"CLOSE"),ko(),xo(12,"button",7),Vo("click",function(){return t.next()}),sa(13,"NEXT"),ko(),ko(),ko(),ko(),Fo(14,"div",9),ko()),2&e&&(Jr(3),Lo("innerHTML",t.getChange().VERSION,Js),Jr(1),Lo("innerHTML",t.getChange().MESSAGE,Js),Jr(4),Lo("disabled",!t.hasPrevious()),Jr(4),Lo("disabled",!t.hasNext()))},directives:[jM],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{width:50%;display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:0 0 33%}#header[_ngcontent-%COMP%]{font-size:1.5em;font-weight:bold;margin-bottom:10px}#text[_ngcontent-%COMP%]{font-size:1.2em;overflow-y:auto}#text[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0}button[disabled][_ngcontent-%COMP%]{color:#5a5a5a}button[disabled][_ngcontent-%COMP%]:active{background-color:var(--passive-colour);cursor:default}button[disabled][_ngcontent-%COMP%]:hover{cursor:default}"]}),e})();const gk=function(e){return{hidden:e}};function pk(e,t){if(1&e){const e=Go();xo(0,"div",32),xo(1,"label",33),sa(2),xo(3,"input",34),Vo("ngModelChange",function(t){return Dt(e).$implicit.enabled=t}),ko(),ko(),Fo(4,"br"),xo(5,"input",35),Vo("ngModelChange",function(t){return Dt(e).$implicit.reserved=t}),ko(),Fo(6,"br"),xo(7,"label",36),sa(8,"reserve %"),ko(),xo(9,"input",37),Vo("ngModelChange",function(t){return Dt(e).$implicit.reservedPercent=t}),ko(),ko()}if(2&e){const e=t.$implicit;Jr(1),$o("for",e.name),Jr(1),ra(e.name),Jr(1),$o("id",e.name),Lo("ngModel",e.enabled),Jr(2),Lo("ngClass",Mc(9,gk,!e.enabled))("ngModel",e.reserved),Jr(2),Lo("ngClass",Mc(11,gk,!e.enabled)),Jr(2),Lo("ngClass",Mc(13,gk,!e.enabled))("ngModel",e.reservedPercent)}}function fk(e,t){if(1&e){const e=Go();xo(0,"div",4),xo(1,"span",5),sa(2),ko(),Fo(3,"br"),Fo(4,"br"),xo(5,"span",6),xo(6,"label",7),sa(7,"reserved amount: "),ko(),Fo(8,"br"),xo(9,"input",8),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.reserve=t}),ko(),Fo(10,"br"),xo(11,"label",9),sa(12,"reserve %"),ko(),xo(13,"input",10),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.reservePercent=t}),ko(),ko(),Fo(14,"br"),Fo(15,"br"),xo(16,"span",11),sa(17,"Exceptions:"),Fo(18,"br"),sa(19," (will use it's own limit number if enabled)"),ko(),Fo(20,"br"),xo(21,"div",12),Po(22,pk,10,15,"div",13),ko(),xo(23,"div",11),sa(24,"Auto trade settings"),Fo(25,"br"),sa(26,"Auto trade will try to buy/sell until you have the specified amount of resource"),ko(),Fo(27,"br"),xo(28,"div"),xo(29,"label",14),sa(30,"Auto sell enabled"),ko(),xo(31,"input",15),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoSellEnabled=t}),ko(),Fo(32,"br"),xo(33,"span"),xo(34,"label",16),sa(35,"continuous sell limit"),ko(),xo(36,"input",17),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoSellAmount=t}),ko(),xo(37,"input",18),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoSellPercentage=t}),ko(),xo(38,"label",19),sa(39,"%"),ko(),ko(),Fo(40,"br"),xo(41,"label",20),sa(42,"Fixed one time sell amount"),ko(),xo(43,"input",21),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoSellOrder=t}),ko(),Fo(44,"br"),Fo(45,"br"),xo(46,"label",22),sa(47,"Auto buy enabled"),ko(),xo(48,"input",23),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoBuyEnabled=t}),ko(),Fo(49,"br"),xo(50,"span"),xo(51,"label",24),sa(52,"continuous buy limit"),ko(),xo(53,"input",25),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoBuyAmount=t}),ko(),xo(54,"input",26),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoBuyPercentage=t}),ko(),xo(55,"label",27),sa(56,"%"),ko(),ko(),Fo(57,"br"),xo(58,"label",28),sa(59,"Fixed one time buy amount"),ko(),xo(60,"input",29),Vo("ngModelChange",function(t){return Dt(e),Ko().resourceOptions.autoTrade.autoBuyOrder=t}),ko(),ko(),xo(61,"div",30),xo(62,"button",31),Vo("click",function(){return Dt(e),Ko().ok()}),sa(63,"SAVE"),ko(),xo(64,"button",31),Vo("click",function(){return Dt(e),Ko().cancel()}),sa(65,"CANCEL"),ko(),xo(66,"button",31),Vo("click",function(){return Dt(e),Ko().reset()}),sa(67,"RESET"),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(2),na("",e.getResourceName()," management"),Jr(7),Lo("ngModel",e.resourceOptions.reserve),Jr(4),Lo("ngModel",e.resourceOptions.reservePercent),Jr(9),Lo("ngForOf",e.resourceOptions.consumers),Jr(9),Lo("ngModel",e.resourceOptions.autoTrade.autoSellEnabled),Jr(5),Lo("ngModel",e.resourceOptions.autoTrade.autoSellAmount),Jr(1),Lo("ngModel",e.resourceOptions.autoTrade.autoSellPercentage),Jr(6),Lo("ngModel",e.resourceOptions.autoTrade.autoSellOrder),Jr(5),Lo("ngModel",e.resourceOptions.autoTrade.autoBuyEnabled),Jr(5),Lo("ngModel",e.resourceOptions.autoTrade.autoBuyAmount),Jr(1),Lo("ngModel",e.resourceOptions.autoTrade.autoBuyPercentage),Jr(6),Lo("ngModel",e.resourceOptions.autoTrade.autoBuyOrder)}}let mk=(()=>{class e{constructor(e){this.modalService=e,this.modalService.registerForResourceOptions().subscribe(e=>{this.resourceOptions=vv.clone(e),setTimeout(function(){window.document.getElementById("reserved").select()},10)}),this.modalService.registerForCloseModal().subscribe(e=>{(e===Pf.RESOURCE_MANAGEMENT||e===Pf.ALL)&&this.modalService.sendResourceOptionsResponse(null)})}ngOnInit(){}ok(){this.modalService.sendResourceOptionsResponse(this.resourceOptions),this.modalService.close(Pf.RESOURCE_MANAGEMENT)}cancel(){this.modalService.sendResourceOptionsResponse(null),this.modalService.close(Pf.RESOURCE_MANAGEMENT)}onKeydownHandler(e){"none"!==document.getElementById("resource-management-modal").style.display&&(e.preventDefault(),this.ok())}getResourceName(){return Qf.prepareResourceName(this.resourceOptions.resource)}reset(){this.resourceOptions=new vv(this.resourceOptions.resource)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-resource-management-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:4,vars:1,consts:[["id","resource-management-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],[1,"entry"],["for","reserved"],["type","number","min","0","id","reserved",3,"ngModel","ngModelChange"],["for","mainPercent"],["id","mainPercent","type","checkbox",3,"ngModel","ngModelChange"],[1,"subTitle"],["id","exceptions"],["class","exceptionEntry",4,"ngFor","ngForOf"],["for","autoSellEnabled",1,"tradeLabel"],["type","checkbox","id","autoSellEnabled",3,"ngModel","ngModelChange"],["for","autoSellAmount",1,"tradeLabel"],["type","number","min","0","id","autoSellAmount",3,"ngModel","ngModelChange"],["id","autoSellPercentage","type","checkbox",3,"ngModel","ngModelChange"],["for","autoSellPercentage"],["for","autoSellOrder",1,"tradeLabel"],["type","number","min","0","id","autoSellOrder",3,"ngModel","ngModelChange"],["for","autoBuyEnabled",1,"tradeLabel"],["type","checkbox","id","autoBuyEnabled",3,"ngModel","ngModelChange"],["for","autoBuyAmount",1,"tradeLabel"],["type","number","min","0","id","autoBuyAmount",3,"ngModel","ngModelChange"],["id","autoBuyPercentage","type","checkbox",3,"ngModel","ngModelChange"],["for","autoBuyPercentage"],["for","autoBuyOrder",1,"tradeLabel"],["type","number","min","0","id","autoBuyOrder",3,"ngModel","ngModelChange"],["id","buttons"],[3,"click"],[1,"exceptionEntry"],[3,"for"],["type","checkbox",3,"id","ngModel","ngModelChange"],["type","number","min","0",3,"ngClass","ngModel","ngModelChange"],["for","percent",3,"ngClass"],["id","percent","type","checkbox",3,"ngClass","ngModel","ngModelChange"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),Po(2,fk,68,12,"div",2),ko(),Fo(3,"div",3),ko()),2&e&&(Jr(2),Lo("ngIf",t.resourceOptions))},directives:[jM,Gu,JT,DT,KO,dT,MT,VO,Uu,ku],styles:[".modal-body[_ngcontent-%COMP%]{padding:40px;display:flex;flex-direction:column;align-items:center;justify-content:center}#title[_ngcontent-%COMP%]{font-size:1.3em;font-weight:bold;margin-bottom:20px}input[type=number][_ngcontent-%COMP%]{width:6ch}#exceptions[_ngcontent-%COMP%]{width:100%;text-align:center}.subTitle[_ngcontent-%COMP%]{padding-top:10px;text-align:center}.entry[_ngcontent-%COMP%]{text-align:center}.exceptionEntry[_ngcontent-%COMP%]{display:inline-block;text-align:center;border:black solid 1px;min-width:100px;min-height:50px;padding:4px 4px 0;margin:5px}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}.hidden[_ngcontent-%COMP%]{visibility:hidden}.tradeLabel[_ngcontent-%COMP%]{display:inline-block;width:200px}"]}),e})();const Sk=function(e){return{selected:e}};function Ek(e,t){if(1&e){const e=Go();xo(0,"div",8),xo(1,"app-recipe",9),Vo("click",function(){const t=Dt(e).$implicit;return Ko().choose(t)}),ko(),ko()}if(2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngClass",Mc(2,Sk,e.id===i.selectedRecipeId))("recipe",e)}}let vk=(()=>{class e{constructor(e,t){this.modalService=e,this.recipeService=t,this.selectedRecipeId=-1,this.modalService.registerForCloseModal().subscribe(e=>{(e===Pf.RECIPE||e===Pf.ALL)&&(this.selectedRecipeId=-1,this.modalService.sendValueInput(null))}),this.modalService.registerForValue().subscribe(e=>{this.selectedRecipeId=e})}ngOnInit(){}ok(){this.modalService.sendValueInput(this.selectedRecipeId),this.modalService.close(Pf.RECIPE)}cancel(){this.modalService.sendValueInput(null),this.modalService.close(Pf.RECIPE)}onKeydownHandler(e){"none"!==document.getElementById("recipe-modal").style.display&&(e.preventDefault(),this.ok())}getRecipes(){return this.recipeService.getRecipes()}choose(e){this.selectedRecipeId=e.id}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(VN))},e.\u0275cmp=Ve({type:e,selectors:[["app-recipe-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:14,vars:1,consts:[["id","recipe-modal"],[1,"modal"],[1,"modal-body"],["id","recipes"],["class","recipe",4,"ngFor","ngForOf"],["id","buttons"],[3,"click"],[1,"modal-background"],[1,"recipe"],[3,"ngClass","recipe","click"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"span"),sa(4,"Choose recipe"),ko(),Fo(5,"br"),xo(6,"div",3),Po(7,Ek,2,4,"div",4),ko(),xo(8,"div",5),xo(9,"button",6),Vo("click",function(){return t.ok()}),sa(10,"CONFIRM"),ko(),xo(11,"button",6),Vo("click",function(){return t.cancel()}),sa(12,"CANCEL"),ko(),ko(),ko(),ko(),Fo(13,"div",7),ko()),2&e&&(Jr(7),Lo("ngForOf",t.getRecipes()))},directives:[jM,Uu,g_,ku],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}app-recipe[_ngcontent-%COMP%]{font-size:.8em;display:inline-block;width:110px;margin:4px 8px;cursor:pointer}.recipe[_ngcontent-%COMP%]{display:inline-block}.selected[_ngcontent-%COMP%]{border:black solid 2px}"]}),e})();const Rk=function(e){return{inactive:e}};let Ok=(()=>{class e{constructor(e,t){this.modalService=e,this.worldService=t,this.on=!1,this.selectOrigin=!0,this.modalService.registerForRegionSelectionOrder().subscribe(e=>{this.selectOrigin=e,this.on=!0})}ngOnInit(){}select(){if(this.canSelect()){const e=this.worldService.getSelectedRegion();this.modalService.setReturnRegion(e),this.modalService.close(Pf.WORLD),this.on=!1}else this.modalService.info("Only your and neutral regions can be selected as origin")}cancel(){this.modalService.setReturnRegion(null),this.modalService.close(Pf.WORLD),this.on=!1}canSelect(){if(!this.on)return!1;{const e=this.worldService.getSelectedCountry();if(e)return!(this.selectOrigin&&e.id!==zf.PLAYER&&e.id!==zf.NEUTRAL)}}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(Uw))},e.\u0275cmp=Ve({type:e,selectors:[["app-world-modal"]],decls:10,vars:4,consts:[["id","world-modal"],[1,"modal"],[1,"modal-body"],[3,"selecting"],["id","buttons"],[3,"ngClass","click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),Fo(3,"app-world",3),xo(4,"div",4),xo(5,"button",5),Vo("click",function(){return t.select()}),sa(6,"Select"),ko(),xo(7,"button",6),Vo("click",function(){return t.cancel()}),sa(8,"Cancel"),ko(),ko(),ko(),ko(),Fo(9,"div",7),ko()),2&e&&(Jr(3),Lo("selecting",!0),Jr(2),Lo("ngClass",Mc(2,Rk,!t.canSelect())))},directives:[jM,EM,ku],styles:[".modal-body[_ngcontent-%COMP%]{height:660px;max-height:660px;margin:20px;display:flex;flex-direction:column;align-items:center;justify-content:center}app-world[_ngcontent-%COMP%]{display:inline-block;height:90%;width:90%}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;margin-right:4px}.inactive[_ngcontent-%COMP%]{color:#5f5f5f}.inactive[_ngcontent-%COMP%]:hover{cursor:auto;cursor:initial}"]}),e})();const Tk=function(e){return{notMet:e}};function Ik(e,t){if(1&e&&(xo(0,"span"),xo(1,"span",17),xo(2,"span",18),sa(3),ko(),Fo(4,"app-icon",19),ko(),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(2),Lo("ngClass",Mc(4,Tk,!i.hasResource(e))),Jr(1),ra(e.amount),Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources")}}function bk(e,t){if(1&e){const e=Go();xo(0,"button",20),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko(2).buildBuilding(t)}),sa(1,"Build "),ko()}}function Ck(e,t){if(1&e){const e=Go();xo(0,"button",21),Vo("click",function(){return Dt(e),Ko(3).buildWallNotAvailable()}),sa(1,"Build "),ko()}}function yk(e,t){if(1&e&&(xo(0,"div",8),xo(1,"div",9),xo(2,"span",10),sa(3),ko(),xo(4,"div",11),Fo(5,"div",12),xo(6,"div",13),sa(7,"cost:"),ko(),Po(8,Ik,5,6,"span",14),ko(),ko(),Po(9,bk,2,0,"button",15),Po(10,Ck,2,0,"button",16),ko()),2&e){const e=t.$implicit,i=Ko(2);Jr(3),na("",e.NAME," "),Jr(2),Lo("innerHTML",e.DESCRIPTION,Js),Jr(3),Lo("ngForOf",i.getBuildingCost(e)),Jr(1),Lo("ngIf",i.isCostMet(e)),Jr(1),Lo("ngIf",!i.isCostMet(e))}}function Ak(e,t){if(1&e&&(xo(0,"div",4),xo(1,"div",5),sa(2,"Region construction"),ko(),xo(3,"div",6),Po(4,yk,11,5,"div",7),ko(),ko()),2&e){const e=Ko();Jr(4),Lo("ngForOf",e.getBuildings())}}let Nk=(()=>{class e{constructor(e,t,i,s){this.modalService=e,this.resourcesService=t,this.gameService=i,this.worldService=s,this.defensesCost=[[{resource:Df.LOG,amount:50}],[{resource:Df.LOG,amount:50},{resource:Df.PLANK,amount:30}],[{resource:Df.LOG,amount:50},{resource:Df.CUT_STONE,amount:30}],[{resource:Df.LOG,amount:80},{resource:Df.CUT_STONE,amount:50}],[{resource:Df.LOG,amount:80},{resource:Df.PLANK,amount:40},{resource:Df.CUT_STONE,amount:40}],[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:60},{resource:Df.CUT_STONE,amount:60}],[{resource:Df.LOG,amount:100},{resource:Df.PLANK,amount:80},{resource:Df.CUT_STONE,amount:80}]],this.modalService.registerForWorldRegion().subscribe(e=>{this.region=e})}ngOnInit(){}isCostMet(e){let t=!0;return this.getBuildingCost(e).forEach(e=>{0!==this.resourcesService.hasResource(e.resource,e.amount,"Region construction",!0)&&(t=!1)}),t}buildBuilding(e){this.getBuildingCost(e).forEach(e=>{this.resourcesService.decreaseResource(e.resource,e.amount,"Region construction",!0)}),this.worldService.buildRegionBuilding(e.REGION_BUILDING),this.region=null,this.modalService.close(Pf.WORLD_BUILD)}hasResource(e){return 0===this.resourcesService.hasResource(e.resource,e.amount,"Region construction",!0)}getResourceName(e){return Qf.prepareResourceName(e)}buildWallNotAvailable(){this.modalService.info("Not enough resources")}getBuildings(){const e=[];return this.region.defense<7&&e.push(gS.REGION_BUILDINGS.DEFENSES),!this.region.roads&&this.gameService.isEnabled(Mf.LOGISTICS)&&e.push(gS.REGION_BUILDINGS.ROADS),!this.region.watchtower&&this.gameService.isEnabled(Mf.WOODEN_TOWER)&&e.push(gS.REGION_BUILDINGS.WATCHTOWER),this.gameService.isEnabled(Mf.WOODEN_TOWER)&&(void 0===this.region.army.getUnit(Wf.GUARD_TOWER)||this.region.army.getUnit(Wf.GUARD_TOWER).size<5)&&e.push(gS.REGION_BUILDINGS.GUARD_TOWER),this.gameService.isEnabled(Mf.HARBOUR)&&!this.region.harbour&&this.region.neighbours.includes(-1)&&e.push(gS.REGION_BUILDINGS.HARBOUR),e}getBuildingCost(e){return e.REGION_BUILDING===gm.DEFENSES?this.defensesCost[this.region.defense]:e.COST}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(Pv),Mo(AS),Mo(Uw))},e.\u0275cmp=Ve({type:e,selectors:[["app-world-build-modal"]],decls:4,vars:1,consts:[["id","world-build-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],["id","buildings"],["class","building",4,"ngFor","ngForOf"],[1,"building"],[1,"buildingSecondRow"],[1,"buildingTitle"],[1,"details"],["id","description",3,"innerHTML"],[1,"subTitle"],[4,"ngFor","ngForOf"],["class","buildButton",3,"click",4,"ngIf"],["class","buildButtonNotAvailable",3,"click",4,"ngIf"],[1,"icon"],[3,"ngClass"],[3,"name","path"],[1,"buildButton",3,"click"],[1,"buildButtonNotAvailable",3,"click"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),Po(2,Ak,5,1,"div",2),ko(),Fo(3,"div",3),ko()),2&e&&(Jr(2),Lo("ngIf",t.region))},directives:[jM,Gu,Uu,ku,sI],styles:["#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em}.building[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 1px;margin-bottom:10px}.buildingTitle[_ngcontent-%COMP%]{font-weight:600;background-color:var(--active-colour);border-bottom:black solid 1px}.buildingSecondRow[_ngcontent-%COMP%]{display:flex;width:100%;border-right:black solid 1px;flex-direction:column}.details[_ngcontent-%COMP%]{width:100%;text-align:center}.resourceIcon[_ngcontent-%COMP%]{height:20px;width:20px;vertical-align:middle}.description[_ngcontent-%COMP%]{margin-bottom:10px}.icon[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;align-items:center;justify-content:center;margin-right:10px}.buildButton[_ngcontent-%COMP%]{width:30%}.buildButtonNotAvailable[_ngcontent-%COMP%]{width:30%;cursor:not-allowed}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e})();const _k=["input"];let wk=(()=>{class e{constructor(e){this.modalService=e,this.text="",this.value=""}ngOnInit(){this.modalService.registerForText().subscribe(e=>{this.text=e,this.inputRef.nativeElement.select()}),this.modalService.registerForValue().subscribe(e=>this.value=e)}ok(){this.modalService.sendValueInput(this.value),this.modalService.close(Pf.INPUT)}cancel(){this.modalService.sendValueInput(null),this.modalService.close(Pf.INPUT)}onKeydownHandler(e){"none"!==document.getElementById("input-modal").style.display&&(e.preventDefault(),this.ok())}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-input-modal"]],viewQuery:function(e,t){if(1&e&&il(_k,7),2&e){let e;tl(e=rl())&&(t.inputRef=e.first)}},hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:14,vars:2,consts:[["id","input-modal"],[1,"modal"],[1,"modal-body"],["id","text",3,"innerHTML"],["id","input",3,"ngModel","ngModelChange"],["input",""],["id","buttons"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),Fo(3,"span",3),Fo(4,"br"),xo(5,"input",4,5),Vo("ngModelChange",function(e){return t.value=e}),ko(),Fo(7,"br"),xo(8,"div",6),xo(9,"button",7),Vo("click",function(){return t.ok()}),sa(10,"CONFIRM"),ko(),xo(11,"button",7),Vo("click",function(){return t.cancel()}),sa(12,"CANCEL"),ko(),ko(),ko(),ko(),Fo(13,"div",8),ko()),2&e&&(Jr(3),Lo("innerHTML",t.text,Js),Jr(2),Lo("ngModel",t.value))},directives:[jM,KO,dT,MT],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}"]}),e})();function Pk(e,t){if(1&e){const e=Go();xo(0,"div",6),Fo(1,"span",7),Fo(2,"br"),xo(3,"div",8),xo(4,"button",9),Vo("click",function(){return Dt(e),Ko(2).ok()}),sa(5,"YES"),ko(),xo(6,"button",9),Vo("click",function(){return Dt(e),Ko(2).cancel()}),sa(7,"NO"),ko(),ko(),ko()}if(2&e){const e=Ko(2);Jr(1),Lo("innerHTML","Are you sure you want to start researching "+e.tech.getTechName()+"?",Js)}}function Mk(e,t){1&e&&(xo(0,"div",6),sa(1," Research queue is full "),Fo(2,"br"),ko())}const Lk=function(e){return{disabled:e}};function Dk(e,t){if(1&e){const e=Go();xo(0,"div",6),Fo(1,"hr"),sa(2),xo(3,"div",8),xo(4,"button",10),Vo("click",function(){return Dt(e),Ko(2).unlockWithHeritage()}),sa(5),ko(),ko(),ko()}if(2&e){const e=Ko(2);Jr(2),oa(" Unlock with Heritage Points (",e.getHeritagePoints(),"/",e.getHeritageCap(),") "),Jr(2),Lo("ngClass",Mc(4,Lk,!e.hasHeritagePoints()||!e.meetsPrerequisites())),Jr(1),na("unlock for ",e.requiredHeritagePoints()," HP")}}function xk(e,t){if(1&e&&(xo(0,"div",4),Po(1,Pk,8,1,"div",5),Po(2,Mk,3,0,"div",5),Po(3,Dk,6,6,"div",5),ko()),2&e){const e=Ko();Jr(1),Lo("ngIf",e.hasQueueSpace()),Jr(1),Lo("ngIf",!e.hasQueueSpace()),Jr(1),Lo("ngIf",e.isHeritageUnlocked())}}let kk=(()=>{class e{constructor(e,t,i,s){this.modalService=e,this.heritageService=t,this.gameService=i,this.techService=s,this.modalService.registerForTech().subscribe(e=>{this.tech=e})}ngOnInit(){}ok(){this.hasQueueSpace()?this.modalService.sendConfirmationResult(!0):this.modalService.sendConfirmationResult(!1),this.tech=null,this.modalService.close(Pf.RESEARCH_UNLOCK)}cancel(){this.modalService.sendConfirmationResult(!1),this.tech=null,this.modalService.close(Pf.RESEARCH_UNLOCK)}onKeydownHandler(e){"none"!==document.getElementById("research-unlock-modal").style.display&&(e.preventDefault(),this.ok())}hasQueueSpace(){return this.techService.hasQueueSpace()}requiredHeritagePoints(){let e=0,t=10*this.tech.getRequiredResearchPoints();return Array.from(this.tech.getCost()).forEach(e=>{t+=e[0]===Df.FOOD?Math.ceil(e[1]/50):oS.getResource(e[0]).TRADE_VALUE*e[1]}),t>0&&(e+=Math.ceil(t/100)),e}hasHeritagePoints(){return this.heritageService.hasHeritagePoints(this.requiredHeritagePoints())}unlockWithHeritage(){this.meetsPrerequisites()?this.heritageService.spendHeritagePoints(this.requiredHeritagePoints())?this.techService.finishTech(this.tech.getTech()):this.modalService.info("Not enough Heritage Points"):this.modalService.info("Prerequisites not met"),this.modalService.sendConfirmationResult(!1),this.tech=null,this.modalService.close(Pf.RESEARCH_UNLOCK)}isHeritageUnlocked(){return this.gameService.isEnabled(Mf.HERITAGE)}getHeritagePoints(){return this.heritageService.getAvailableHeritagePoints()}getHeritageCap(){return this.heritageService.getHeritagePoints()}meetsPrerequisites(){let e=!0;const t=this.techService.getTechDone();return this.tech.getPrerequisites().forEach(i=>{e&&(t.includes(i)||(e=!1))}),this.tech.getFlagPrerequisites().forEach(t=>{this.gameService.isEnabled(t)||e&&(e=!1)}),e}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(nw),Mo(AS),Mo(Wb))},e.\u0275cmp=Ve({type:e,selectors:[["app-research-unlock-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:4,vars:1,consts:[["id","research-unlock-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["class","center",4,"ngIf"],[1,"center"],["id","text",3,"innerHTML"],[1,"buttons"],[3,"click"],[3,"ngClass","click"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),Po(2,xk,4,3,"div",2),ko(),Fo(3,"div",3),ko()),2&e&&(Jr(2),Lo("ngIf",t.tech))},directives:[jM,Gu,ku],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:750px;margin:200px auto auto}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}.center[_ngcontent-%COMP%]{text-align:center}.disabled[_ngcontent-%COMP%]{color:#5a5a5a}"]}),e})();const Fk=function(e){return{selected:e}};function Uk(e,t){if(1&e){const e=Go();xo(0,"div",4),Vo("click",function(){Dt(e);const t=Ko();return t.selectedShip=t.troops.BRIGANTINE}),xo(1,"span",5),sa(2,"Brigantine"),ko(),Fo(3,"img",13),ko()}if(2&e){const e=Ko();Lo("ngClass",Mc(1,Fk,e.selectedShip===e.troops.BRIGANTINE))}}function Hk(e,t){if(1&e){const e=Go();xo(0,"div",4),Vo("click",function(){Dt(e);const t=Ko();return t.selectedShip=t.troops.GALLEON}),xo(1,"span",5),sa(2,"Galleon"),ko(),Fo(3,"img",14),ko()}if(2&e){const e=Ko();Lo("ngClass",Mc(1,Fk,e.selectedShip===e.troops.GALLEON))}}const Gk=function(e){return{notMet:e}};function Bk(e,t){if(1&e&&(xo(0,"div",25),xo(1,"span",22),sa(2),Fo(3,"app-icon",24),ko(),ko()),2&e){const e=t.$implicit,i=Ko(2);Lo("ngClass",Mc(4,Gk,!i.hasResource(e.resource,e.amount))),Jr(2),na("",e.amount," "),Jr(1),Lo("name",i.getResourceName(e.resource))("path","resources")}}function Wk(e,t){if(1&e&&(xo(0,"div"),xo(1,"h5",15),sa(2,"Cost"),ko(),xo(3,"div",16),xo(4,"span",17),sa(5),Fo(6,"app-icon",18),ko(),xo(7,"span",17),sa(8),Fo(9,"app-icon",19),ko(),Po(10,Bk,4,6,"div",20),ko(),xo(11,"h5",15),sa(12,"Stats"),ko(),xo(13,"div",21),xo(14,"span",22),sa(15),Fo(16,"app-icon",23),ko(),xo(17,"span",22),sa(18),Fo(19,"app-icon",23),ko(),xo(20,"span",22),sa(21),Fo(22,"app-icon",24),ko(),xo(23,"span",22),sa(24),Fo(25,"app-icon",24),ko(),xo(26,"span",22),sa(27),Fo(28,"app-icon",24),ko(),xo(29,"span",22),sa(30),Fo(31,"app-icon",24),ko(),xo(32,"span",22),sa(33),Fo(34,"app-icon",24),ko(),ko(),ko()),2&e){const e=Ko();Jr(4),Lo("ngClass",Mc(29,Gk,!e.hasPort())),Jr(1),na("",e.getShipStats().SIZE," "),Jr(1),Lo("name","port")("path","sea")("title","port space"),Jr(1),Lo("ngClass",Mc(31,Gk,!e.hasPeople())),Jr(1),na("",e.getShipStats().CREW," "),Jr(1),Lo("name","hammer")("title","sailors"),Jr(1),Lo("ngForOf",e.getCost()),Jr(5),na("",e.getShipStats().SIZE," "),Jr(1),Lo("name","size"),Jr(2),na("",e.getShipStats().CARGO," "),Jr(1),Lo("name","cargo"),Jr(2),na("",e.getShipStats().SPEED," "),Jr(1),Lo("name","speed")("path","army"),Jr(2),na("",e.getShipStats().SPEED," "),Jr(1),Lo("name","speed")("path","army"),Jr(2),na("",e.getShipStats().PAY," "),Jr(1),Lo("name","coins")("path","resources"),Jr(2),na("",e.getShipStats().STRENGTH," "),Jr(1),Lo("name","attack")("path","army"),Jr(2),na("",e.getShipStats().DEFENSE," "),Jr(1),Lo("name","defense")("path","army")}}const Vk=function(e){return{disabled:e}};let zk=(()=>{class e{constructor(e,t,i,s){this.modalService=e,this.resourcesService=t,this.gameService=i,this.navyService=s,this.selectedShip=Wf.BOAT,this.troops=Wf,this.limitToBoat=!1,e.registerForShipyardLimitBoat().subscribe(e=>{this.limitToBoat=e,this.selectedShip=Wf.BOAT})}ngOnInit(){}onKeydownHandler(e){"none"!==document.getElementById("shipyard-modal").style.display&&(e.preventDefault(),this.cancel())}build(){if(this.hasPort())if(this.hasResources()){if(!(this.resourcesService.getPeople()>=this.getShipStats().CREW))return void this.modalService.info("Not enough sailors!");this.resourcesService.removeRecruit(this.getShipStats().CREW),this.getCost().forEach(e=>{this.resourcesService.decreaseResource(e.resource,e.amount,"ship construction",!0)}),this.modalService.sendValueInput(this.selectedShip),this.modalService.close(Pf.SHIPYARD)}else this.modalService.info("Not enough resources!");else this.modalService.info("Not enough port space!")}cancel(){this.modalService.close(Pf.SHIPYARD)}hasResources(){let e=!0;return this.getCost().forEach(t=>{e&&(e=this.hasResource(t.resource,t.amount))}),e}hasResource(e,t){return 0===this.resourcesService.hasResource(e,t,"ship construction",!0)}getCost(){return aS.getTroop(this.selectedShip).COST}getResourceName(e){return Qf.prepareResourceName(e)}getShipStats(){return aS.getTroop(this.selectedShip)}hasPort(){return this.navyService.getFreeHarbourSpace()>=this.getShipStats().SIZE}hasPeople(){return this.resourcesService.getPeople()>=this.getShipStats().CREW}isBrigantineUnlocked(){return this.gameService.isEnabled(Mf.BRIGANTINE)}isGalleonUnlocked(){return this.gameService.isEnabled(Mf.GALLEON)}}return e.\u0275fac=function(t){return new(t||e)(Mo(em),Mo(Pv),Mo(AS),Mo(yy))},e.\u0275cmp=Ve({type:e,selectors:[["app-shipyard-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:20,vars:9,consts:[["id","shipyard-modal"],[1,"modal"],[1,"modal-body"],["id","modes"],[1,"mode",3,"ngClass","click"],[1,"title"],["src","assets/sea/boat.svg"],["class","mode",3,"ngClass","click",4,"ngIf"],[4,"ngIf"],["id","buttons"],[3,"ngClass","click"],[3,"click"],[1,"modal-background"],["src","assets/sea/brigantine.svg"],["src","assets/sea/galleon.svg"],[1,"center"],["id","costList"],[1,"icon",3,"ngClass"],[3,"name","path","title"],[3,"name","title"],[3,"ngClass",4,"ngFor","ngForOf"],["id","stats"],[1,"icon"],[3,"name"],[3,"name","path"],[3,"ngClass"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"h2"),sa(4,"Select ship to build"),ko(),xo(5,"div",3),xo(6,"div",4),Vo("click",function(){return t.selectedShip=t.troops.BOAT}),xo(7,"span",5),sa(8,"Boat"),ko(),Fo(9,"img",6),ko(),Po(10,Uk,4,3,"div",7),Po(11,Hk,4,3,"div",7),ko(),Fo(12,"br"),Po(13,Wk,35,33,"div",8),xo(14,"div",9),xo(15,"button",10),Vo("click",function(){return t.build()}),sa(16,"BUILD"),ko(),xo(17,"button",11),Vo("click",function(){return t.cancel()}),sa(18,"CANCEL"),ko(),ko(),ko(),ko(),Fo(19,"div",12),ko()),2&e&&(Jr(6),Lo("ngClass",Mc(5,Fk,t.selectedShip===t.troops.BOAT)),Jr(4),Lo("ngIf",!t.limitToBoat&&t.isBrigantineUnlocked()),Jr(1),Lo("ngIf",!t.limitToBoat&&t.isGalleonUnlocked()),Jr(2),Lo("ngIf",t.selectedShip),Jr(2),Lo("ngClass",Mc(7,Vk,!t.hasPort()||!t.hasPeople()||!t.hasResources())))},directives:[jM,ku,Gu,sI,Uu],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:100px auto auto}.lineBreak[_ngcontent-%COMP%]{display:block}#modes[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:10px}.mode[_ngcontent-%COMP%]{display:flex;cursor:pointer;flex-direction:column;height:150px;width:200px;border:black solid 1px;align-items:center;margin-right:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.mode[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px}.mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:bold}.mode[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{font-size:.8em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:10px}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;white-space:nowrap}.disabled[_ngcontent-%COMP%]{color:#5a5a5a}.selected[_ngcontent-%COMP%]{border:black solid 3px}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}#costList[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}#stats[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.center[_ngcontent-%COMP%]{text-align:center}h5[_ngcontent-%COMP%]{margin-bottom:5px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-right:10px}"]}),e})();function Yk(e,t){if(1&e&&(xo(0,"div",7),Fo(1,"br"),xo(2,"span"),sa(3),ko(),Fo(4,"br"),Fo(5,"br"),xo(6,"label",8),sa(7,"Full error:"),ko(),Fo(8,"br"),xo(9,"textarea",9),sa(10),ko(),ko()),2&e){const e=Ko();Jr(3),ra(e.errorReport.message),Jr(7),ra(e.errorReport.fullError)}}let Kk=(()=>{class e{constructor(e){this.modalService=e,this.errorReport=null,this.modalService.registerForErrorReport().subscribe(e=>this.errorReport=e),this.modalService.registerForCloseModal().subscribe(e=>{e===Pf.ERROR&&(this.errorReport=null)})}ngOnInit(){}ok(){this.modalService.close(Pf.ERROR)}onKeydownHandler(e){"none"!==document.getElementById("error-modal").style.display&&(e.preventDefault(),this.ok())}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-error-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:10,vars:1,consts:[["id","error-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["id","wrapper",4,"ngIf"],[3,"click"],[1,"modal-background"],["id","wrapper"],["for","errorBox"],["readonly","","rows","20","id","errorBox"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),xo(3,"span",3),sa(4,"Error report"),ko(),Po(5,Yk,11,2,"div",4),Fo(6,"br"),xo(7,"button",5),Vo("click",function(){return t.ok()}),sa(8,"OK"),ko(),ko(),ko(),Fo(9,"div",6),ko()),2&e&&(Jr(5),Lo("ngIf",t.errorReport))},directives:[jM,Gu],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#title[_ngcontent-%COMP%]{font-weight:bold}#wrapper[_ngcontent-%COMP%]{width:100%;text-align:center}#errorBox[_ngcontent-%COMP%]{width:100%;resize:none}"]}),e})(),jk=(()=>{class e{constructor(e){this.modalService=e,this.modalService.registerForText().subscribe(e=>this.text=e)}ngOnInit(){}ok(){this.modalService.sendConfirmationResult(!0),this.modalService.close(Pf.CONFIRM)}cancel(){this.modalService.sendConfirmationResult(!1),this.modalService.close(Pf.CONFIRM)}onKeydownHandler(e){"none"!==document.getElementById("confirm-modal").style.display&&(e.preventDefault(),this.ok())}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-confirm-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:11,vars:1,consts:[["id","confirm-modal"],[1,"modal"],[1,"modal-body"],["id","text",3,"innerHTML"],["id","buttons"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),Fo(3,"span",3),Fo(4,"br"),xo(5,"div",4),xo(6,"button",5),Vo("click",function(){return t.ok()}),sa(7,"YES"),ko(),xo(8,"button",5),Vo("click",function(){return t.cancel()}),sa(9,"NO"),ko(),ko(),ko(),ko(),Fo(10,"div",6),ko()),2&e&&(Jr(3),Lo("innerHTML",t.text,Js))},directives:[jM],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:750px;margin:200px auto auto}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}"]}),e})(),$k=(()=>{class e{constructor(e){this.modalService=e,this.text="",this.modalService.registerForText().subscribe(e=>this.text=e)}ngOnInit(){}ok(){this.modalService.close(Pf.INFO)}onKeydownHandler(e){"none"!==document.getElementById("info-modal").style.display&&(e.preventDefault(),this.ok())}}return e.\u0275fac=function(t){return new(t||e)(Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-info-modal"]],hostBindings:function(e,t){1&e&&Vo("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,ur)},decls:8,vars:1,consts:[["id","info-modal"],[1,"modal"],[1,"modal-body"],["id","text",3,"innerHTML"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(xo(0,"app-modal",0),xo(1,"div",1),xo(2,"div",2),Fo(3,"span",3),Fo(4,"br"),xo(5,"button",4),Vo("click",function(){return t.ok()}),sa(6,"OK"),ko(),ko(),ko(),Fo(7,"div",5),ko()),2&e&&(Jr(3),Lo("innerHTML",t.text,Js))},directives:[jM],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:200px auto auto}"]}),e})(),Qk=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ve({type:e,selectors:[["app-modals"]],decls:25,vars:0,template:function(e,t){1&e&&(Fo(0,"app-build-modal"),Fo(1,"app-abdication-modal"),Fo(2,"app-ascension-modal"),Fo(3,"app-fight-report-modal"),Fo(4,"app-export-modal"),Fo(5,"app-import-modal"),Fo(6,"app-hard-reset-modal"),Fo(7,"app-options-modal"),Fo(8,"app-royal-modal"),Fo(9,"app-mission-modal"),Fo(10,"app-festival-modal"),Fo(11,"app-market-modal"),Fo(12,"app-work-management-modal"),Fo(13,"app-tutorial-modal"),Fo(14,"app-changelog-modal"),Fo(15,"app-resource-management-modal"),Fo(16,"app-recipe-modal"),Fo(17,"app-world-modal"),Fo(18,"app-world-build-modal"),Fo(19,"app-input-modal"),Fo(20,"app-research-unlock-modal"),Fo(21,"app-shipyard-modal"),Fo(22,"app-error-modal"),Fo(23,"app-confirm-modal"),Fo(24,"app-info-modal"))},directives:[dL,eD,sD,pD,SD,ED,vD,MD,xD,Nx,kx,Vx,nk,uk,dk,mk,vk,Ok,Nk,wk,kk,zk,Kk,jk,$k],styles:[""]}),e})(),qk=(()=>{class e{constructor(e){this.servicesService=e,e.addService(Zf.REGIONS,this),this.init()}init(){this.villageService=this.servicesService.getVillageService(),this.fortService=this.servicesService.getFortService(),this.forestService=this.servicesService.getForestService(),this.fieldService=this.servicesService.getFieldService(),this.mountainsService=this.servicesService.getMountainsService(),this.seaService=this.servicesService.getSeaService(),this.regionsServices=[this.villageService,this.fortService,this.forestService,this.fieldService,this.mountainsService,this.seaService]}getAllBuildingSites(){let e=[];return this.regionsServices.forEach(t=>{e=e.concat(t.getBuildings().filter(e=>e.getBuildingType()===Lf.CONSTRUCTION||e.getBuildingType()===Lf.DECONSTRUCTION))}),e}}return e.\u0275fac=function(t){return new(t||e)(gs(Jf))},e.\u0275prov=de({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Xk=(()=>{class e{constructor(e){this.calendarService=e}ngOnInit(){}getDay(){return this.calendarService.getDay()}getYear(){return this.calendarService.getYear()}getSeason(){return SS[this.calendarService.getSeason()].toLowerCase()}polarToCartesian(e,t,i,s){const r=(s-90)*Math.PI/180;return{x:e+i*Math.cos(r),y:t+i*Math.sin(r)}}describeArc(e,t,i,s,r){360===r&&(r=359.9);const n=this.polarToCartesian(e,t,i,r),o=this.polarToCartesian(e,t,i,s);return["M",n.x,n.y,"A",i,i,0,r-s<=180?"0":"1",0,o.x,o.y,"L",e,t,"L",n.x,n.y].join(" ")}getTickNumber(){return this.calendarService.getTickInDay()-1}}return e.\u0275fac=function(t){return new(t||e)(Mo(OS))},e.\u0275cmp=Ve({type:e,selectors:[["app-calendar"]],decls:6,vars:4,consts:[["id","wrapper"],["height","22px","width","23px",1,"progress-circle"],["cx","11","cy","11","r","10","stroke","black","stroke-width","1.5","fill","transparent"]],template:function(e,t){1&e&&(xo(0,"div",0),sa(1),ai(),xo(2,"svg",1),Fo(3,"circle",2),Fo(4,"path"),ko(),sa(5),ko()),2&e&&(Jr(1),na(" day: ",t.getDay()," "),Jr(3),No("d",t.describeArc(11,11,8,0,36*t.getTickNumber())),Jr(1),oa(" year: ",t.getYear()," ",t.getSeason(),"\n"))},styles:[".progress-circle[_ngcontent-%COMP%]{margin-bottom:-2px}"]}),e})();const Zk=["line1"],Jk=["line22"];function eF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function tF(e,t){if(1&e&&(xo(0,"div",17),Fo(1,"app-icon",18),sa(2),xo(3,"span",19),sa(4," Total food nutrition"),Fo(5,"br"),Fo(6,"hr"),sa(7),Fo(8,"br"),sa(9),Fo(10,"br"),sa(11),Fc(12,"number"),Fo(13,"br"),Fo(14,"hr"),Po(15,eF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","nutTolltip"),Jr(1),Lo("name","food")("path","resources")("title",""),Jr(1),na("\xa0",e.getFoodValue()," "),Jr(5),na(" Rations: ",e.getRations(),""),Jr(2),na(" Daily consumption: ",e.getDailyNutritionUsage(),""),Jr(2),na(" Average daily production: ",Hc(12,9,e.getAverageDailyNutritionProduction(),"0.0-0"),""),Jr(4),Lo("ngForOf",e.getConsumableResources())}}function iF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function sF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0RAW "),xo(2,"span",22),Po(3,iF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","rawTolltip"),Jr(3),Lo("ngForOf",e.geRawResources())}}function rF(e,t){if(1&e&&(xo(0,"div"),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=Ko().$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function nF(e,t){if(1&e&&(xo(0,"div"),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=Ko().$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),na("",e.amount," ")}}function oF(e,t){if(1&e&&(xo(0,"div",21),Po(1,rF,3,4,"div",7),Po(2,nF,3,3,"div",7),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("ngIf",i.isNotCoins(e)),Jr(1),Lo("ngIf",!i.isNotCoins(e))}}function aF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0PROCESSED "),xo(2,"span",23),Po(3,oF,3,2,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","processedTolltip"),Jr(3),Lo("ngForOf",e.geProcessedResources())}}function cF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function lF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0FOOD "),xo(2,"span",24),Po(3,cF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","foodTolltip"),Jr(3),Lo("ngForOf",e.geFoodResources())}}function uF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function hF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0TOOLS "),xo(2,"span",25),Po(3,uF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","toolsTolltip"),Jr(3),Lo("ngForOf",e.geToolsResources())}}function dF(e,t){if(1&e&&(xo(0,"div",17),Fo(1,"app-icon",18),sa(2),xo(3,"span",19),sa(4," Total food nutrition "),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","nutTolltip"),Jr(1),Lo("name","food")("path","resources")("title",""),Jr(1),na("\xa0",e.getFoodValue()," ")}}function gF(e,t){if(1&e&&(xo(0,"div",26),Fo(1,"app-icon",27),sa(2),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","population"),Jr(1),na(" ",e.getPopulation()," ")}}function pF(e,t){if(1&e&&(xo(0,"div",26),Fo(1,"app-icon",28),sa(2),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","hammer")("title","Workers"),Jr(1),na(" ",e.getFreeWorkers()," ")}}function fF(e,t){if(1&e){const e=Go();xo(0,"div",26),xo(1,"app-happiness",15),Vo("click",function(){return Dt(e),Ko(2).openHappiness()}),ko(),sa(2," \xa0 "),ko()}}function mF(e,t){if(1&e&&(xo(0,"div",26),Fo(1,"app-icon",18),sa(2),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","faith")("path","religion")("title","Faith"),Jr(1),na(" ",e.getFaith()," \xa0 ")}}function SF(e,t){if(1&e&&(xo(0,"div",26),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na(" ",e.getResearchProgress()," ")}}function EF(e,t){if(1&e&&(Uo(0,35),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),oa("",e.getAmount(),"/",e.getLimit(),"")}}function vF(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),oa("",e.getAmount(),"/",e.getLimit(),"")}}function RF(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),ra(e.getAmount())}}function OF(e,t){if(1&e&&(xo(0,"span"),xo(1,"span",30),xo(2,"span",31),xo(3,"div",32),sa(4),ko(),Fo(5,"div",33),Fo(6,"div",33),ko(),Fo(7,"app-icon",18),Po(8,EF,2,2,"ng-container",34),Po(9,vF,2,2,"ng-container",7),Po(10,RF,2,1,"ng-container",7),sa(11," \xa0"),ko(),ko()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),Lo("elementId",1e5*e.resource),Jr(1),$o("id",1e5*e.resource),Jr(2),ra(e.name),Jr(1),Lo("innerHTML",t.getResourceDescription(e),Js),Jr(1),Lo("innerHTML",t.getResourceConsumers(e),Js),Jr(1),Lo("name",e.getName())("path","resources")("title",""),Jr(1),Lo("ngIf",e.getAmount()===e.getLimit()),Jr(1),Lo("ngIf",t.isNotCoins(e)&&e.getAmount()!==e.getLimit()),Jr(1),Lo("ngIf",!t.isNotCoins(e))}}function TF(e,t){if(1&e&&(xo(0,"div",29),Po(1,OF,12,11,"span",7),ko()),2&e){const e=t.$implicit;Jr(1),Lo("ngIf",e.visible&&e.highlighted)}}function IF(e,t){1&e&&Fo(0,"app-calendar")}function bF(e,t){1&e&&(Uo(0),sa(1,"\xb0C"),Ho())}function CF(e,t){1&e&&(Uo(0),sa(1,"\xb0F"),Ho())}function yF(e,t){1&e&&Fo(0,"img",36)}function AF(e,t){1&e&&Fo(0,"img",37)}function NF(e,t){if(1&e){const e=Go();xo(0,"li",15),Vo("click",function(){return Dt(e),Ko(2).pause()}),sa(1,"pause game"),ko()}}function _F(e,t){if(1&e){const e=Go();xo(0,"li",15),Vo("click",function(){return Dt(e),Ko(2).resume()}),sa(1,"resume game"),ko()}}function wF(e,t){if(1&e){const e=Go();xo(0,"div",2),Po(1,tF,16,12,"div",3),Po(2,sF,4,2,"div",3),Po(3,aF,4,2,"div",3),Po(4,lF,4,2,"div",3),Po(5,hF,4,2,"div",3),Po(6,dF,5,5,"div",3),Po(7,gF,3,2,"div",4),sa(8," \xa0 "),Po(9,pF,3,3,"div",4),sa(10," \xa0 "),Po(11,fF,3,0,"div",4),Po(12,mF,3,4,"div",4),Po(13,SF,2,1,"div",4),sa(14," \xa0 "),Po(15,TF,2,1,"div",5),sa(16," \xa0 "),xo(17,"div",6),Po(18,IF,1,0,"app-calendar",7),xo(19,"span",8),sa(20," \xa0 "),Fo(21,"app-icon",9),Uo(22,10),sa(23),Fc(24,"number"),Po(25,bF,2,0,"ng-container",7),Po(26,CF,2,0,"ng-container",7),Ho(),ko(),ko(),xo(27,"div",11),Po(28,yF,1,0,"img",12),Po(29,AF,1,0,"img",13),xo(30,"ul",14),xo(31,"li",15),Vo("click",function(){return Dt(e),Ko().options()}),sa(32,"options"),ko(),xo(33,"li",15),Vo("click",function(){return Dt(e),Ko().save()}),sa(34,"save"),ko(),xo(35,"li",15),Vo("click",function(){return Dt(e),Ko().load()}),sa(36,"load"),ko(),xo(37,"li",15),Vo("click",function(){return Dt(e),Ko().import()}),sa(38,"import"),ko(),xo(39,"li",15),Vo("click",function(){return Dt(e),Ko().export()}),sa(40,"export"),ko(),Po(41,NF,2,0,"li",16),Po(42,_F,2,0,"li",16),xo(43,"li",15),Vo("click",function(){return Dt(e),Ko().showCurrentTutorial()}),sa(44,"show current tab tutorial"),ko(),xo(45,"li",15),Vo("click",function(){return Dt(e),Ko().resetTutorials()}),sa(46,"reset tutorials"),ko(),xo(47,"li",15),Vo("click",function(){return Dt(e),Ko().softReset()}),sa(48,"abdicate"),ko(),xo(49,"li",15),Vo("click",function(){return Dt(e),Ko().hardReset()}),sa(50,"hard reset"),ko(),ko(),ko(),ko()}if(2&e){const e=Ko();Jr(1),Lo("ngIf",e.isFoodNutritionEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isRawEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isProcessedEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isFoodEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isToolsEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isFoodNutritionEnabled()&&!e.isManagementResearched()),Jr(1),Lo("ngIf",e.showPopulation()),Jr(2),Lo("ngIf",e.showFreeWorkers()),Jr(2),Lo("ngIf",e.showHappiness()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.showFaith()&&e.isFaithUnlocked()),Jr(1),Lo("ngIf",e.showResearchProgress()),Jr(2),Lo("ngForOf",e.getResourcesValues()),Jr(3),Lo("ngIf",e.calendarEnabled()),Jr(3),Lo("name",e.getWeatherName())("path","weather"),Jr(2),na("",Hc(24,22,e.getTemperature(),"0.0-1")," "),Jr(2),Lo("ngIf",e.metric),Jr(1),Lo("ngIf",!e.metric),Jr(2),Lo("ngIf",!e.isPaused()),Jr(1),Lo("ngIf",e.isPaused()),Jr(12),Lo("ngIf",!e.isPaused()),Jr(1),Lo("ngIf",e.isPaused())}}function PF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function MF(e,t){if(1&e&&(xo(0,"div",17),Fo(1,"app-icon",18),sa(2),xo(3,"span",19),sa(4," Nutrition"),Fo(5,"br"),Fo(6,"hr"),sa(7),Fo(8,"br"),sa(9),Fo(10,"br"),sa(11),Fc(12,"number"),Fo(13,"br"),Fo(14,"hr"),Po(15,PF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","nutTolltip"),Jr(1),Lo("name","food")("path","resources")("title",""),Jr(1),na("\xa0",e.getFoodValue()," "),Jr(5),na(" Rations: ",e.getRations(),""),Jr(2),na(" Daily consumption: ",e.getDailyNutritionUsage(),""),Jr(2),na(" Average daily production: ",Hc(12,9,e.getAverageDailyNutritionProduction(),"0.0-0"),""),Jr(4),Lo("ngForOf",e.getConsumableResources())}}function LF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function DF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0RAW "),xo(2,"span",22),Po(3,LF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","rawTolltip"),Jr(3),Lo("ngForOf",e.geRawResources())}}function xF(e,t){if(1&e&&(xo(0,"div"),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=Ko().$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function kF(e,t){if(1&e&&(xo(0,"div"),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=Ko().$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),na("",e.amount," ")}}function FF(e,t){if(1&e&&(xo(0,"div",21),Po(1,xF,3,4,"div",7),Po(2,kF,3,3,"div",7),ko()),2&e){const e=t.$implicit,i=Ko(3);Jr(1),Lo("ngIf",i.isNotCoins(e)),Jr(1),Lo("ngIf",!i.isNotCoins(e))}}function UF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0PROCESSED "),xo(2,"span",23),Po(3,FF,3,2,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","processedTolltip"),Jr(3),Lo("ngForOf",e.geProcessedResources())}}function HF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function GF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0FOOD "),xo(2,"span",24),Po(3,HF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","foodTolltip"),Jr(3),Lo("ngForOf",e.geFoodResources())}}function BF(e,t){if(1&e&&(xo(0,"div",21),Fo(1,"app-icon",9),sa(2),ko()),2&e){const e=t.$implicit;Jr(1),Lo("name",e.getName())("path","resources"),Jr(1),oa("",e.amount,"/",e.limit," ")}}function WF(e,t){if(1&e&&(xo(0,"div",17),sa(1," \xa0TOOLS "),xo(2,"span",25),Po(3,BF,3,4,"div",20),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","toolsTolltip"),Jr(3),Lo("ngForOf",e.geToolsResources())}}function VF(e,t){if(1&e&&(xo(0,"div",17),Fo(1,"app-icon",18),sa(2),xo(3,"span",19),sa(4," Total food nutrition "),ko(),ko()),2&e){const e=Ko(2);Lo("elementId","nutTolltip"),Jr(1),Lo("name","food")("path","resources")("title",""),Jr(1),na("\xa0",e.getFoodValue()," ")}}function zF(e,t){if(1&e&&(xo(0,"div",26),Fo(1,"app-icon",27),sa(2),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","population"),Jr(1),na(" ",e.getPopulation()," ")}}function YF(e,t){if(1&e&&(xo(0,"div",26),Fo(1,"app-icon",28),sa(2),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","hammer")("title","Workers"),Jr(1),na(" ",e.getFreeWorkers()," ")}}function KF(e,t){if(1&e){const e=Go();xo(0,"div",26),xo(1,"app-happiness",15),Vo("click",function(){return Dt(e),Ko(2).openHappiness()}),ko(),sa(2," \xa0 "),ko()}}function jF(e,t){if(1&e&&(xo(0,"div",26),Fo(1,"app-icon",18),sa(2),ko()),2&e){const e=Ko(2);Jr(1),Lo("name","faith")("path","religion")("title","Faith"),Jr(1),na(" ",e.getFaith()," \xa0 ")}}function $F(e,t){if(1&e&&(xo(0,"div",26),sa(1),ko()),2&e){const e=Ko(2);Jr(1),na(" ",e.getResearchProgress()," ")}}function QF(e,t){1&e&&Fo(0,"app-calendar")}function qF(e,t){1&e&&(Uo(0),sa(1,"\xb0C"),Ho())}function XF(e,t){1&e&&(Uo(0),sa(1,"\xb0F"),Ho())}function ZF(e,t){1&e&&Fo(0,"img",42)}function JF(e,t){1&e&&Fo(0,"img",43)}function eU(e,t){if(1&e){const e=Go();xo(0,"li",15),Vo("click",function(){return Dt(e),Ko(2).pause()}),sa(1,"pause game"),ko()}}function tU(e,t){if(1&e){const e=Go();xo(0,"li",15),Vo("click",function(){return Dt(e),Ko(2).resume()}),sa(1,"resume game"),ko()}}function iU(e,t){if(1&e&&(Uo(0,35),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),oa("",e.getAmount(),"/",e.getLimit(),"")}}function sU(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),oa("",e.getAmount(),"/",e.getLimit(),"")}}function rU(e,t){if(1&e&&(Uo(0),sa(1),Ho()),2&e){const e=Ko(2).$implicit;Jr(1),ra(e.getAmount())}}function nU(e,t){if(1&e&&(xo(0,"span"),xo(1,"span",30),xo(2,"span",31),xo(3,"div",32),sa(4),ko(),Fo(5,"div",33),Fo(6,"div",33),ko(),Fo(7,"app-icon",18),Po(8,iU,2,2,"ng-container",34),Po(9,sU,2,2,"ng-container",7),Po(10,rU,2,1,"ng-container",7),sa(11," \xa0"),ko(),ko()),2&e){const e=Ko().$implicit,t=Ko(2);Jr(1),Lo("elementId",1e5*e.resource),Jr(1),$o("id",1e5*e.resource),Jr(2),ra(e.name),Jr(1),Lo("innerHTML",t.getResourceDescription(e),Js),Jr(1),Lo("innerHTML",t.getResourceConsumers(e),Js),Jr(1),Lo("name",e.getName())("path","resources")("title",""),Jr(1),Lo("ngIf",e.getAmount()===e.getLimit()),Jr(1),Lo("ngIf",t.isNotCoins(e)&&e.getAmount()!==e.getLimit()),Jr(1),Lo("ngIf",!t.isNotCoins(e))}}function oU(e,t){if(1&e&&(xo(0,"div",29),Po(1,nU,12,11,"span",7),ko()),2&e){const e=t.$implicit;Jr(1),Lo("ngIf",e.visible&&e.highlighted)}}function aU(e,t){if(1&e){const e=Go();xo(0,"div",38),xo(1,"div",39),Po(2,MF,16,12,"div",3),Po(3,DF,4,2,"div",3),Po(4,UF,4,2,"div",3),Po(5,GF,4,2,"div",3),Po(6,WF,4,2,"div",3),Po(7,VF,5,5,"div",3),Po(8,zF,3,2,"div",4),sa(9," \xa0 "),Po(10,YF,3,3,"div",4),sa(11," \xa0 "),Po(12,KF,3,0,"div",4),Po(13,jF,3,4,"div",4),Po(14,$F,2,1,"div",4),sa(15," \xa0 "),xo(16,"div",6),Po(17,QF,1,0,"app-calendar",7),xo(18,"span",8),sa(19," \xa0 "),Fo(20,"app-icon",9),Uo(21,10),sa(22),Fc(23,"number"),Po(24,qF,2,0,"ng-container",7),Po(25,XF,2,0,"ng-container",7),Ho(),ko(),ko(),xo(26,"div",11),Po(27,ZF,1,0,"img",40),Po(28,JF,1,0,"img",41),xo(29,"ul",14),xo(30,"li",15),Vo("click",function(){return Dt(e),Ko().options()}),sa(31,"options"),ko(),xo(32,"li",15),Vo("click",function(){return Dt(e),Ko().save()}),sa(33,"save"),ko(),xo(34,"li",15),Vo("click",function(){return Dt(e),Ko().load()}),sa(35,"load"),ko(),xo(36,"li",15),Vo("click",function(){return Dt(e),Ko().import()}),sa(37,"import"),ko(),xo(38,"li",15),Vo("click",function(){return Dt(e),Ko().export()}),sa(39,"export"),ko(),Po(40,eU,2,0,"li",16),Po(41,tU,2,0,"li",16),xo(42,"li",15),Vo("click",function(){return Dt(e),Ko().showCurrentTutorial()}),sa(43,"show current tab tutorial"),ko(),xo(44,"li",15),Vo("click",function(){return Dt(e),Ko().resetTutorials()}),sa(45,"reset tutorials"),ko(),xo(46,"li",15),Vo("click",function(){return Dt(e),Ko().softReset()}),sa(47,"abdicate"),ko(),xo(48,"li",15),Vo("click",function(){return Dt(e),Ko().hardReset()}),sa(49,"hard reset"),ko(),ko(),ko(),ko(),xo(50,"div",39),Po(51,oU,2,1,"div",5),ko(),ko()}if(2&e){const e=Ko();Jr(2),Lo("ngIf",e.isFoodNutritionEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isRawEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isProcessedEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isFoodEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isToolsEnabled()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.isFoodNutritionEnabled()&&!e.isManagementResearched()),Jr(1),Lo("ngIf",e.showPopulation()),Jr(2),Lo("ngIf",e.showFreeWorkers()),Jr(2),Lo("ngIf",e.showHappiness()&&e.isManagementResearched()),Jr(1),Lo("ngIf",e.showFaith()&&e.isFaithUnlocked()),Jr(1),Lo("ngIf",e.showResearchProgress()),Jr(3),Lo("ngIf",e.calendarEnabled()),Jr(3),Lo("name",e.getWeatherName())("path","weather"),Jr(2),na("",Hc(23,22,e.getTemperature(),"0.0-1")," "),Jr(2),Lo("ngIf",e.metric),Jr(1),Lo("ngIf",!e.metric),Jr(2),Lo("ngIf",!e.isPaused()),Jr(1),Lo("ngIf",e.isPaused()),Jr(12),Lo("ngIf",!e.isPaused()),Jr(1),Lo("ngIf",e.isPaused()),Jr(10),Lo("ngForOf",e.getResourcesValues())}}let cU=(()=>{class e{constructor(e,t,i,s,r,n,o,a,c,l,u,h,d,g){this.serializerService=e,this.servicesService=t,this.logService=i,this.modalService=s,this.resourcesService=r,this.weatherService=n,this.optionsService=o,this.gameService=a,this.tickerService=c,this.tutorialService=l,this.techService=u,this.religionService=h,this.router=d,this.managementService=g,this.metric=this.optionsService.getOption(Xf.METRIC),this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(()=>this.metric=this.optionsService.getOption(Xf.METRIC)))}ngOnInit(){this.resources=this.resourcesService.getResources(),this.resourcesService.registerForResourcesChange().subscribe(e=>{this.resources=e})}getResourcesValues(){return Array.from(this.resources.values())}save(){this.serializerService.initSave(),this.logService.log("saved")}load(){this.serializerService.initLoad()}import(){this.modalService.open(Pf.IMPORT)}export(){this.modalService.open(Pf.EXPORT)}hardReset(){this.modalService.open(Pf.HARD_RESET)}options(){this.modalService.open(Pf.OPTIONS)}getTemperature(){return this.weatherService.getCurrentTemperature()}getWeather(){return this.weatherService.getCurrentWeather()}getWeatherName(){return im[this.getWeather()].toLowerCase()}calendarEnabled(){return this.gameService.isEnabled(Mf.CALENDAR)}softReset(){this.modalService.open(Pf.ABDICATION)}isNotCoins(e){return e.resource!==Df.COINS}resetTutorials(){this.tutorialService.resetTutorials()}pause(){this.tickerService.pause()}resume(){this.tickerService.resume()}isPaused(){return this.tickerService.isPaused()}getResourceDescription(e){let t="";return e.hasResourceType(Gf.CONSUMABLE)&&(t+="nutrition: "+oS.getResource(e.resource).POWER),e.hasResourceType(Gf.FUEL)&&(t+="heating energy: "+oS.getResource(e.resource).POWER),""!==t?"<hr>"+t:t}getResourceConsumers(e){let t="",i="<b>used by:</b><br>";const s=this.resourcesService.getResourceUses(e.resource),r=[];s&&(s.slice().forEach(e=>{const t=r.find(t=>t[0]===e.userName);t?t[1]+=e.value:r.push([e.userName,e.value])}),r.sort((e,t)=>e[0].localeCompare(t[0])).forEach(e=>{i+=e[0]+": "+e[1]+"<br>"})),"<b>used by:</b><br>"!==i&&(t+="<hr>"+i),i="<b>produced by:</b><br>";const n=this.resourcesService.getResourceProductions(e.resource),o=[];return n&&(n.slice().forEach(e=>{const t=o.find(t=>t[0]===e.producerName);t?t[1]+=e.value:o.push([e.producerName,e.value])}),o.sort((e,t)=>e[0].localeCompare(t[0])).forEach(e=>{i+=e[0]+": "+e[1]+"<br>"})),"<b>produced by:</b><br>"!==i&&(t+="<hr>"+i),t}showCurrentTutorial(){this.tutorialService.showCurrentViewTutorial()}getFoodValue(){return this.resourcesService.getFoodValue("Village")}isFoodNutritionEnabled(){return this.managementService.getFoodNutrition()}getConsumableResources(){return this.resourcesService.getResourcesByType(Gf.CONSUMABLE).filter(e=>e.isVisible())}getDailyNutritionUsage(){return 5*(this.resourcesService.getTotalPeople()-1)*this.managementService.getRations()}getAverageDailyNutritionProduction(){return this.resourcesService.getAverageNutritionProduction()}getRations(){return.5*this.managementService.getRations()}isHeaderTwoLines(){return this.managementService.getSecondHeaderRow()}showFreeWorkers(){return this.managementService.getShowFreeWorkers()}getFreeWorkers(){return this.resourcesService.getPeople()}showPopulation(){return this.managementService.getShowPopulation()}getPopulation(){return this.resourcesService.getTotalPeople()+"/"+this.resourcesService.getPopulationCap()}isManagementResearched(){return this.gameService.isEnabled(Mf.MANAGEMENT)}showResearchProgress(){return this.managementService.getShowResearchProgress()}getResearchProgress(){const e=this.techService.getCurrentResearch();return e?Qf.prepareTechName(e.getTech())+": "+e.getResearchPoints()+"/"+e.getRequiredResearchPoints():"no research"}showFaith(){return this.managementService.getShowFaith()}showHappiness(){return this.managementService.getShowHappiness()}getFaith(){return this.religionService.getFaith()+"/"+this.religionService.getFaithCap()}isFaithUnlocked(){return this.gameService.isEnabled(Mf.RELIGION)}isRawEnabled(){return this.managementService.getShowRaw()}geRawResources(){return this.resourcesService.getResourcesByType(Gf.RAW).filter(e=>e.isVisible())}isProcessedEnabled(){return this.managementService.getShowProcessed()}geProcessedResources(){return this.resourcesService.getResourcesByType(Gf.PROCESSED).filter(e=>e.isVisible())}isFoodEnabled(){return this.managementService.getShowFood()}geFoodResources(){return this.resourcesService.getResourcesByType(Gf.FOOD).filter(e=>e.isVisible())}isToolsEnabled(){return this.managementService.getShowTools()}geToolsResources(){return this.resourcesService.getResourcesByType(Gf.TOOLS).filter(e=>e.isVisible())}openHappiness(){this.router.navigate(["/management/happiness"])}}return e.\u0275fac=function(t){return new(t||e)(Mo(JL),Mo(Jf),Mo(IS),Mo(em),Mo(Pv),Mo(gN),Mo(vS),Mo(AS),Mo(fL),Mo(yS),Mo(Wb),Mo(CA),Mo(af),Mo(PO))},e.\u0275cmp=Ve({type:e,selectors:[["app-header"]],viewQuery:function(e,t){if(1&e&&(il(Zk,5),il(Jk,5)),2&e){let e;tl(e=rl())&&(t.line1Ref=e.first),tl(e=rl())&&(t.line22Ref=e.first)}},decls:2,vars:2,consts:[["id","wrapperOneLine",4,"ngIf"],["id","wrapperTwoLines",4,"ngIf"],["id","wrapperOneLine"],["class","highlighted icon tooltip","appTooltip","",3,"elementId",4,"ngIf"],["class","highlighted icon",4,"ngIf"],["class","highlighted",4,"ngFor","ngForOf"],["id","right"],[4,"ngIf"],["id","weather",1,"icon"],[3,"name","path"],["id","temp"],[1,"dropdown"],["draggable","false","id","cog","src","assets/settings.svg","alt","settings",4,"ngIf"],["draggable","false","id","cog","src","assets/pause.svg","alt","settings",4,"ngIf"],[1,"dropdown-content"],[3,"click"],[3,"click",4,"ngIf"],["appTooltip","",1,"highlighted","icon","tooltip",3,"elementId"],[3,"name","path","title"],["id","nutTolltip"],["class","icon",4,"ngFor","ngForOf"],[1,"icon"],["id","rawTolltip"],["id","processedTolltip"],["id","foodTolltip"],["id","toolsTolltip"],[1,"highlighted","icon"],[3,"name"],[3,"name","title"],[1,"highlighted"],["appTooltip","",1,"icon","tooltip",3,"elementId"],[3,"id"],[1,"center"],[1,"center",3,"innerHTML"],["class","full",4,"ngIf"],[1,"full"],["draggable","false","id","cog","src","assets/settings.svg","alt","settings"],["draggable","false","id","cog","src","assets/pause.svg","alt","settings"],["id","wrapperTwoLines"],[1,"line"],["draggable","false","ondragstart","return false;","id","cog","src","assets/settings.svg","alt","settings",4,"ngIf"],["draggable","false","ondragstart","return false;","id","cog","src","assets/pause.svg","alt","settings",4,"ngIf"],["draggable","false","ondragstart","return false;","id","cog","src","assets/settings.svg","alt","settings"],["draggable","false","ondragstart","return false;","id","cog","src","assets/pause.svg","alt","settings"]],template:function(e,t){1&e&&(Po(0,wF,51,25,"div",0),Po(1,aU,52,25,"div",1)),2&e&&(Lo("ngIf",!t.isHeaderTwoLines()),Jr(1),Lo("ngIf",t.isHeaderTwoLines()))},directives:[Gu,Uu,sI,rI,hI,Xk],pipes:[Zu],styles:["#wrapperTwoLines[_ngcontent-%COMP%]{font-size:1em;display:flex;flex-direction:column;height:100%;align-items:center}#wrapperOneLine[_ngcontent-%COMP%]{font-size:1em;display:flex;height:100%;align-items:center}.line[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:50%;width:100%}button[_ngcontent-%COMP%]{width:100%;margin:0;padding:0}app-calendar[_ngcontent-%COMP%]{display:inline-block}.highlighted[_ngcontent-%COMP%]{display:inline-block}#cog[_ngcontent-%COMP%]{float:right;margin-top:-2px;height:30px;width:30px}#cog[_ngcontent-%COMP%]:hover{cursor:pointer}.dropdown[_ngcontent-%COMP%]{position:absolute;right:4px;display:inline-block}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;white-space:nowrap;text-align:center;right:0;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}#cog[_ngcontent-%COMP%]{width:30px}#temp[_ngcontent-%COMP%]{padding-top:2px;padding-left:5px}.full[_ngcontent-%COMP%]{font-weight:600}app-calendar[_ngcontent-%COMP%]{display:inline-block;font-size:1.1em}#right[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:row;font-size:1.1em;margin-top:2px;right:40px}app-icon[_ngcontent-%COMP%]{flex:0 0 auto;margin-right:3px}#weather[_ngcontent-%COMP%]{flex:0 0 auto}.icon[_ngcontent-%COMP%]{font-size:1.1em;display:flex;flex-direction:row;align-items:center}hr[_ngcontent-%COMP%]{border-color:#000}.center[_ngcontent-%COMP%]{text-align:center}app-happiness[_ngcontent-%COMP%]{cursor:pointer}"]}),e})();function lU(e,t){if(1&e&&(xo(0,"a",18),sa(1),ko()),2&e){const e=Ko();Jr(1),ra(e.getVillageStageName())}}function uU(e,t){if(1&e&&(xo(0,"a",19),sa(1),ko()),2&e){const e=Ko();Zo("active",!0),Jr(1),ra(e.getVillageStageName())}}function hU(e,t){1&e&&(xo(0,"a",20),sa(1,"Management"),ko())}function dU(e,t){1&e&&(xo(0,"a",21),sa(1,"Crafting"),ko())}function gU(e,t){1&e&&(xo(0,"a",22),sa(1,"Research"),ko())}function pU(e,t){1&e&&(xo(0,"a",23),sa(1,"Market"),ko())}function fU(e,t){1&e&&(xo(0,"a",24),sa(1,"Army"),ko())}function mU(e,t){1&e&&(xo(0,"a",25),sa(1,"Religion"),ko())}function SU(e,t){1&e&&(xo(0,"a",26),sa(1,"Weather"),ko())}function EU(e,t){1&e&&(xo(0,"a",27),sa(1,"World Map"),ko())}function vU(e,t){1&e&&(xo(0,"a",28),sa(1,"Navy"),ko())}function RU(e,t){1&e&&(xo(0,"a",29),sa(1,"Heritage"),ko())}function OU(e,t){1&e&&Fo(0,"a",30)}let TU=(()=>{class e{constructor(e,t,i){this.gameService=e,this.resourcesService=t,this.router=i}ngOnInit(){}isWeatherEnabled(){return this.gameService.isEnabled(Mf.WEATHER)}isMarketEnabled(){return this.gameService.isEnabled(Mf.MARKET)}isManagementEnabled(){return this.gameService.isEnabled(Mf.MANAGEMENT)}isResearchEnabled(){return this.gameService.isEnabled(Mf.RESEARCH)}isArmyEnabled(){return this.gameService.isEnabled(Mf.ARMY)}isReligionEnabled(){return this.gameService.isEnabled(Mf.RELIGION)}isCraftingEnabled(){return this.gameService.isEnabled(Mf.CRAFTING)}isHeritageUnlocked(){return this.gameService.isEnabled(Mf.HERITAGE)}isCartographyEnabled(){return this.gameService.isEnabled(Mf.CARTOGRAPHY)}isDev(){return!Am.production}isInRegions(){return this.router.url.includes("/regions/")}isNavyEnabled(){return this.gameService.isEnabled(Mf.NAVY)}getVillageStageName(){let e="Village";return rS.forEach(t=>{this.resourcesService.getPopulationCap()>=t.population&&(e=t.name)}),e}}return e.\u0275fac=function(t){return new(t||e)(Mo(AS),Mo(Pv),Mo(af))},e.\u0275cmp=Ve({type:e,selectors:[["app-left-menu"]],decls:20,vars:13,consts:[["id","wrapper"],[1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/village",3,"active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/resources","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/management","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/crafting","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/research","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/market","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/army","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/religion","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/weather","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/world","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/navy","routerLinkActive","active",4,"ngIf"],[1,"entry2","end"],["draggable","false","ondragstart","return false;","class","entry3","routerLink","/heritage","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","empty",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/royal","routerLinkActive","active",1,"entry3"],["draggable","false","ondragstart","return false;","routerLink","/regions","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/village",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/crafting","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/research","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/market","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/army","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/religion","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/weather","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/world","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/navy","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/heritage","routerLinkActive","active",1,"entry3"],["draggable","false","ondragstart","return false;",1,"empty"]],template:function(e,t){1&e&&(xo(0,"div",0),Fo(1,"a",1),Po(2,lU,2,1,"a",2),Po(3,uU,2,3,"a",3),xo(4,"a",4),sa(5,"Resources"),ko(),Po(6,hU,2,0,"a",5),Po(7,dU,2,0,"a",6),Po(8,gU,2,0,"a",7),Po(9,pU,2,0,"a",8),Po(10,fU,2,0,"a",9),Po(11,mU,2,0,"a",10),Po(12,SU,2,0,"a",11),Po(13,EU,2,0,"a",12),Po(14,vU,2,0,"a",13),xo(15,"div",14),Po(16,RU,2,0,"a",15),Po(17,OU,1,0,"a",16),xo(18,"a",17),sa(19,"Royal perks"),ko(),ko(),ko()),2&e&&(Jr(2),Lo("ngIf",!t.isInRegions()),Jr(1),Lo("ngIf",t.isInRegions()),Jr(3),Lo("ngIf",t.isManagementEnabled()),Jr(1),Lo("ngIf",t.isCraftingEnabled()),Jr(1),Lo("ngIf",t.isResearchEnabled()),Jr(1),Lo("ngIf",t.isMarketEnabled()),Jr(1),Lo("ngIf",t.isArmyEnabled()),Jr(1),Lo("ngIf",t.isReligionEnabled()),Jr(1),Lo("ngIf",t.isWeatherEnabled()),Jr(1),Lo("ngIf",t.isCartographyEnabled()),Jr(1),Lo("ngIf",t.isNavyEnabled()),Jr(2),Lo("ngIf",t.isHeritageUnlocked()),Jr(1),Lo("ngIf",!t.isHeritageUnlocked()))},directives:[Gu,lf,hf],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column}.entry[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:5%;text-align:center;border-bottom:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1.1em}.entry2[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:10%;text-align:center;border:none;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry3[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:50%;text-align:center;border-top:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry3[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.entry[_ngcontent-%COMP%]:first-of-type{cursor:default}.empty[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:50%;text-align:center;text-decoration:none;color:#000;font-size:1em;cursor:default}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour);text-decoration:none}.entry3.active[_ngcontent-%COMP%]{background:var(--active-colour);text-decoration:none}.end[_ngcontent-%COMP%]{margin-top:auto;border:none}"]}),e})();const IU=["scroll"];function bU(e,t){if(1&e&&(xo(0,"span"),xo(1,"span",12),sa(2),ko(),Fo(3,"span",13),ko()),2&e){const e=Ko().$implicit;Jr(2),na("day ",e.day,":"),Jr(1),Lo("innerHTML"," "+e.message,Js)}}function CU(e,t){if(1&e&&(xo(0,"span",14),xo(1,"span",12),sa(2),ko(),Fo(3,"span",13),ko()),2&e){const e=Ko().$implicit;Jr(2),na("day ",e.day,":"),Jr(1),Lo("innerHTML"," "+e.message,Js)}}function yU(e,t){if(1&e&&(xo(0,"span",15),xo(1,"span",12),sa(2),ko(),Fo(3,"span",13),ko()),2&e){const e=Ko().$implicit;Jr(2),na("day ",e.day,":"),Jr(1),Lo("innerHTML"," "+e.message,Js)}}function AU(e,t){if(1&e&&(xo(0,"span",16),xo(1,"span",12),sa(2),ko(),Fo(3,"span",13),ko()),2&e){const e=Ko().$implicit;Jr(2),na("day ",e.day,":"),Jr(1),Lo("innerHTML"," "+e.message,Js)}}function NU(e,t){if(1&e){const e=Go();xo(0,"span"),xo(1,"span",12),sa(2),ko(),Fo(3,"span",13),xo(4,"button",17),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().showFightReport(t.data)}),sa(5,"report"),ko(),ko()}if(2&e){const e=Ko().$implicit;Jr(2),na("day ",e.day,":"),Jr(1),Lo("innerHTML"," "+e.message,Js)}}function _U(e,t){if(1&e){const e=Go();xo(0,"span",15),xo(1,"span",12),sa(2),ko(),Fo(3,"span",13),xo(4,"button",17),Vo("click",function(){Dt(e);const t=Ko().$implicit;return Ko().showErrorReport(t.data)}),sa(5,"report"),ko(),ko()}if(2&e){const e=Ko().$implicit;Jr(2),na("day ",e.day,":"),Jr(1),Lo("innerHTML"," "+e.message,Js)}}function wU(e,t){if(1&e&&(xo(0,"li"),xo(1,"div",7),Po(2,bU,4,2,"span",8),Po(3,CU,4,2,"span",9),Po(4,yU,4,2,"span",10),Po(5,AU,4,2,"span",11),Po(6,NU,6,2,"span",8),Po(7,_U,6,2,"span",10),ko(),ko()),2&e){const e=t.$implicit,i=Ko();Jr(1),Lo("ngSwitch",e.type),Jr(1),Lo("ngSwitchCase",i.logEntryTypes.LOG),Jr(1),Lo("ngSwitchCase",i.logEntryTypes.SUCCESS),Jr(1),Lo("ngSwitchCase",i.logEntryTypes.WARNING),Jr(1),Lo("ngSwitchCase",i.logEntryTypes.MYSTICAL),Jr(1),Lo("ngSwitchCase",i.logEntryTypes.FIGHT_REPORT),Jr(1),Lo("ngSwitchCase",i.logEntryTypes.ERROR)}}let PU=(()=>{class e{constructor(e,t,i){this.logService=e,this.changeDetectorRef=t,this.modalService=i,this.entries=[],this.logEntryTypes=hm}ngOnInit(){this.logService.registerForLogs().subscribe(()=>{this.entries=this.logService.getEntries(),this.scrollToBottom()}),this.entries=this.logService.getEntries(),this.scrollToBottom()}clearLogs(){this.logService.clearEntries()}scrollToBottom(){const e=this.scrollRef.nativeElement,t=e.scrollHeight-e.clientHeight<=e.scrollTop+25;this.changeDetectorRef.destroyed||this.changeDetectorRef.detectChanges(),t&&(e.scrollTop=e.scrollHeight)}showFightReport(e){this.modalService.open(Pf.FIGHT_REPORT),this.modalService.setFightReport(e)}showErrorReport(e){this.modalService.open(Pf.ERROR),this.modalService.setModalErrorReport(e)}}return e.\u0275fac=function(t){return new(t||e)(Mo(IS),Mo(nc),Mo(em))},e.\u0275cmp=Ve({type:e,selectors:[["app-log"]],viewQuery:function(e,t){if(1&e&&il(IU,7),2&e){let e;tl(e=rl())&&(t.scrollRef=e.first)}},decls:10,vars:1,consts:[["id","wrapper"],[1,"title"],["id","title-text"],["id","clear-button",3,"click"],["id","log"],["scroll",""],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","success",4,"ngSwitchCase"],["class","warning",4,"ngSwitchCase"],["class","mystical",4,"ngSwitchCase"],[1,"date"],[3,"innerHTML"],[1,"success"],[1,"warning"],[1,"mystical"],[3,"click"]],template:function(e,t){1&e&&(xo(0,"div",0),xo(1,"div",1),xo(2,"span",2),sa(3,"Log"),ko(),xo(4,"button",3),Vo("click",function(){return t.clearLogs()}),sa(5,"clear"),ko(),ko(),xo(6,"div",4,5),xo(8,"ul"),Po(9,wU,8,7,"li",6),ko(),ko(),ko()),2&e&&(Jr(9),Lo("ngForOf",t.entries))},directives:[Uu,zu,Yu],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:100%}#clear-button[_ngcontent-%COMP%]{float:right}#log[_ngcontent-%COMP%]{height:100%;overflow-y:scroll;font-size:.8em}.title[_ngcontent-%COMP%]{border-bottom:black solid 1px;text-align:center;font-weight:bold;font-size:1.1em}#title-text[_ngcontent-%COMP%]{display:inline-block;margin-left:20px;margin-top:3px}ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}li[_ngcontent-%COMP%]{padding-left:.5%;padding-bottom:.4%}.date[_ngcontent-%COMP%]{font-weight:bolder}.warning[_ngcontent-%COMP%]{color:var(--negative-colour)}.success[_ngcontent-%COMP%]{color:var(--positive-colour)}.mystical[_ngcontent-%COMP%]{color:#00008b}#log[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:1px;margin-left:2px}"]}),e})();function MU(e,t){if(1&e){const e=Go();xo(0,"span",8),xo(1,"img",9),Vo("click",function(){return Dt(e),Ko().toggleSound()}),ko(),ko()}}function LU(e,t){if(1&e){const e=Go();xo(0,"span",8),xo(1,"img",10),Vo("click",function(){return Dt(e),Ko().toggleSound()}),ko(),ko()}}function DU(e,t){if(1&e){const e=Go();xo(0,"span",11),xo(1,"img",12),Vo("click",function(){return Dt(e),Ko().pause()}),ko(),ko()}}function xU(e,t){if(1&e){const e=Go();xo(0,"span",11),xo(1,"img",13),Vo("click",function(){return Dt(e),Ko().resume()}),ko(),ko()}}let kU=(()=>{class e{constructor(e,t,i){this.gameService=e,this.tickerService=t,this.optionsService=i,this.gameName=Am.gameName,this.version=Am.versionString}ngOnInit(){}showDevNotes(){this.gameService.showDevNotes()}getSound(){return this.optionsService.getOption(Xf.SOUND_MASTER)}toggleSound(){this.optionsService.setOption(Xf.SOUND_MASTER,!this.optionsService.getOption(Xf.SOUND_MASTER))}isPaused(){return this.tickerService.isPaused()}pause(){this.tickerService.pause()}resume(){this.tickerService.resume()}}return e.\u0275fac=function(t){return new(t||e)(Mo(AS),Mo(fL),Mo(vS))},e.\u0275cmp=Ve({type:e,selectors:[["app-footer"]],decls:13,vars:6,consts:[["id","wrapper"],["class","first",4,"ngIf"],["class","second",4,"ngIf"],["id","center"],["id","wiki"],["target","_blank","rel","noopener noreferrer","href","http://wiki.villagerkings.com"],["id","dev"],["draggable","false","ondragstart","return false;","src","assets/dev.svg","title","dev notes",3,"click"],[1,"first"],["draggable","false","ondragstart","return false;","src","assets/sound_on.svg","title","turn master sounds off",3,"click"],["draggable","false","ondragstart","return false;","src","assets/sound_off.svg","title","turn master sound on",3,"click"],[1,"second"],["draggable","false","ondragstart","return false;","src","assets/pause2.svg","title","pause",3,"click"],["draggable","false","ondragstart","return false;","src","assets/play.svg","title","play",3,"click"]],template:function(e,t){1&e&&(xo(0,"div",0),Po(1,MU,2,0,"span",1),Po(2,LU,2,0,"span",1),Po(3,DU,2,0,"span",2),Po(4,xU,2,0,"span",2),xo(5,"div",3),xo(6,"span"),sa(7),ko(),ko(),xo(8,"span",4),xo(9,"a",5),sa(10,"wiki"),ko(),ko(),xo(11,"span",6),xo(12,"img",7),Vo("click",function(){return t.showDevNotes()}),ko(),ko(),ko()),2&e&&(Jr(1),Lo("ngIf",t.getSound()),Jr(1),Lo("ngIf",!t.getSound()),Jr(1),Lo("ngIf",!t.isPaused()),Jr(1),Lo("ngIf",t.isPaused()),Jr(3),oa("",t.gameName," v",t.version,""))},directives:[Gu],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:row;font-size:1.2em}.first[_ngcontent-%COMP%]{flex:0 0 35px;height:30px}.second[_ngcontent-%COMP%]{display:flex;flex:0 0 35px;height:30px;align-items:center;vertical-align:center}.second[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:24px}#center[_ngcontent-%COMP%]{flex:0 0 calc(100% - 150px);display:flex;justify-content:center;align-items:center}#wiki[_ngcontent-%COMP%]{display:flex;flex:0 0 35px;justify-content:flex-end;margin-top:5px}a[_ngcontent-%COMP%]{text-decoration:none;color:#000}#dev[_ngcontent-%COMP%]{display:flex;flex:0 0 35px;height:30px;justify-content:flex-end}img[_ngcontent-%COMP%]{width:30px;cursor:pointer}"]}),e})();const FU=["wrap"];let UU=(()=>{class e{constructor(e,t,i,s,r,n,o,a,c,l,u,h,d,g,p,f,m,S){this.gameService=e,this.randomService=t,this.optionsService=i,this.tickerService=s,this.serializerService=r,this.resourceService=n,this.techService=o,this.logService=a,this.seaService=c,this.mountainsService=l,this.fortService=u,this.forestService=h,this.fieldService=d,this.managementService=g,this.villageService=p,this.regionsService=f,this.soundService=m,this.router=S,e.registerForHeaderRowsChange().subscribe(e=>{e&&this.wrapperRef?this.wrapperRef.nativeElement.style.gridTemplateRows="70px auto 35px":!e&&this.wrapperRef&&(this.wrapperRef.nativeElement.style.gridTemplateRows="35px auto 35px")})}ngOnInit(){this.serializerService.hasSave()?this.serializerService.initLoad():this.initGame(),this.managementService.getSecondHeaderRow()&&this.wrapperRef&&(this.wrapperRef.nativeElement.style.gridTemplateRows="70px auto 35px"),this.tickerService.start(),this.optionsService.getOption(Xf.PAUSE_ON_INIT)&&(this.logService.warning("Game paused on start (settings option)"),this.tickerService.pause()),this.soundService.playMusic()}initGame(){this.gameService.init(),this.optionsService.init(),this.resourceService.init(),this.villageService.init(),this.fortService.init(),this.forestService.init(),this.fieldService.init(),this.mountainsService.init(),this.seaService.init()}exitSave(e){this.serializerService.initSave()}pause(e){if("VillagerKings"===e.target.id)switch(e.key){case"p":"VillagerKings"===e.target.id&&(this.tickerService.isPaused()?this.tickerService.resume():this.tickerService.pause());break;case"m":this.gameService.isEnabled(Mf.CARTOGRAPHY)&&this.router.navigate(["/world"])}}}return e.\u0275fac=function(t){return new(t||e)(Mo(AS),Mo(am),Mo(vS),Mo(fL),Mo(JL),Mo(Pv),Mo(Wb),Mo(IS),Mo(Iy),Mo(ey),Mo(Ky),Mo(EC),Mo(FC),Mo(PO),Mo(wO),Mo(qk),Mo(RS),Mo(af))},e.\u0275cmp=Ve({type:e,selectors:[["app-game"]],viewQuery:function(e,t){if(1&e&&il(FU,7),2&e){let e;tl(e=rl())&&(t.wrapperRef=e.first)}},hostBindings:function(e,t){1&e&&Vo("beforeunload",function(e){return t.exitSave(e)},!1,lr)("keydown",function(e){return t.pause(e)},!1,ur)},decls:132,vars:0,consts:[["id","wrapper"],["wrap",""],["src","assets/buff.svg","alt","",1,"asset"],["src","assets/complex_management_off_off.svg","alt","",1,"asset"],["src","assets/complex_management_off_on.svg","alt","",1,"asset"],["src","assets/complex_management_on_off.svg","alt","",1,"asset"],["src","assets/complex_management_on_on.svg","alt","",1,"asset"],["src","assets/details.svg","alt","",1,"asset"],["src","assets/dev.svg","alt","",1,"asset"],["src","assets/eye.svg","alt","",1,"asset"],["src","assets/foresight.svg","alt","",1,"asset"],["src","assets/forest.svg","alt","",1,"asset"],["src","assets/gear.svg","alt","",1,"asset"],["src","assets/gear_off.svg","alt","",1,"asset"],["src","assets/hammer.svg","alt","",1,"asset"],["src","assets/kred.png","alt","",1,"asset"],["src","assets/land.svg","alt","",1,"asset"],["src","assets/manage.svg","alt","",1,"asset"],["src","assets/mountains.svg","alt","",1,"asset"],["src","assets/pause.svg","alt","",1,"asset"],["src","assets/pause2.svg","alt","",1,"asset"],["src","assets/play.svg","alt","",1,"asset"],["src","assets/population.svg","alt","",1,"asset"],["src","assets/question_mark.svg","alt","",1,"asset"],["src","assets/settings.svg","alt","",1,"asset"],["src","assets/sound_off.svg","alt","",1,"asset"],["src","assets/sound_on.svg","alt","",1,"asset"],["src","assets/stop.svg","alt","",1,"asset"],["src","assets/tick.svg","alt","",1,"asset"],["src","assets/time.svg","alt","",1,"asset"],["src","assets/trade.svg","alt","",1,"asset"],["src","assets/upgrade.svg","alt","",1,"asset"],["src","assets/village.svg","alt","",1,"asset"],["src","assets/religion/faith.svg","alt","",1,"asset"],["src","assets/religion/faith_shield.svg","alt","",1,"asset"],["src","assets/weather/clouds.svg","alt","",1,"asset"],["src","assets/weather/rain.svg","alt","",1,"asset"],["src","assets/weather/snow.svg","alt","",1,"asset"],["src","assets/weather/storm.svg","alt","",1,"asset"],["src","assets/weather/sun.svg","alt","",1,"asset"],["src","assets/weather/wind.svg","alt","",1,"asset"],["src","assets/army/attack.svg","alt","",1,"asset"],["src","assets/army/barracks.svg","alt","",1,"asset"],["src","assets/army/defense.svg","alt","",1,"asset"],["src","assets/army/invasion.svg","alt","",1,"asset"],["src","assets/army/recruit.svg","alt","",1,"asset"],["src","assets/happiness/angry.svg","alt","",1,"asset"],["src","assets/happiness/happy.svg","alt","",1,"asset"],["src","assets/happiness/neutral.svg","alt","",1,"asset"],["src","assets/happiness/overjoyed.svg","alt","",1,"asset"],["src","assets/happiness/sad.svg","alt","",1,"asset"],["src","assets/resources/apple.svg","alt","",1,"asset"],["src","assets/resources/barley.svg","alt","",1,"asset"],["src","assets/resources/beer.svg","alt","",1,"asset"],["src","assets/resources/berry.svg","alt","",1,"asset"],["src","assets/resources/bow.svg","alt","",1,"asset"],["src","assets/resources/bread.svg","alt","",1,"asset"],["src","assets/resources/bricks.svg","alt","",1,"asset"],["src","assets/resources/bronze.svg","alt","",1,"asset"],["src","assets/resources/brushwood.svg","alt","",1,"asset"],["src","assets/resources/cheese.svg","alt","",1,"asset"],["src","assets/resources/chicken.svg","alt","",1,"asset"],["src","assets/resources/clay.svg","alt","",1,"asset"],["src","assets/resources/clothes.svg","alt","",1,"asset"],["src","assets/resources/coal.svg","alt","",1,"asset"],["src","assets/resources/coins.svg","alt","",1,"asset"],["src","assets/resources/cooked_fish.svg","alt","",1,"asset"],["src","assets/resources/cooked_meat.svg","alt","",1,"asset"],["src","assets/resources/copper.svg","alt","",1,"asset"],["src","assets/resources/copper_ore.svg","alt","",1,"asset"],["src","assets/resources/cotton.svg","alt","",1,"asset"],["src","assets/resources/cow.svg","alt","",1,"asset"],["src","assets/resources/cut_stone.svg","alt","",1,"asset"],["src","assets/resources/egg.svg","alt","",1,"asset"],["src","assets/resources/fabric.svg","alt","",1,"asset"],["src","assets/resources/fish.svg","alt","",1,"asset"],["src","assets/resources/flour.svg","alt","",1,"asset"],["src","assets/resources/food.svg","alt","",1,"asset"],["src","assets/resources/fuel.svg","alt","",1,"asset"],["src","assets/resources/fur.svg","alt","",1,"asset"],["src","assets/resources/gold.svg","alt","",1,"asset"],["src","assets/resources/gold_ore.svg","alt","",1,"asset"],["src","assets/resources/grape.svg","alt","",1,"asset"],["src","assets/resources/hay.svg","alt","",1,"asset"],["src","assets/resources/hop.svg","alt","",1,"asset"],["src","assets/resources/horse.svg","alt","",1,"asset"],["src","assets/resources/iron.svg","alt","",1,"asset"],["src","assets/resources/iron_ore.svg","alt","",1,"asset"],["src","assets/resources/leather.svg","alt","",1,"asset"],["src","assets/resources/leather_armor.svg","alt","",1,"asset"],["src","assets/resources/light_armor.svg","alt","",1,"asset"],["src","assets/resources/heavy_armor.svg","alt","",1,"asset"],["src","assets/resources/log.svg","alt","",1,"asset"],["src","assets/resources/meat.svg","alt","",1,"asset"],["src","assets/resources/meat_soup.svg","alt","",1,"asset"],["src","assets/resources/milk.svg","alt","",1,"asset"],["src","assets/resources/mushroom.svg","alt","",1,"asset"],["src","assets/resources/nails.svg","alt","",1,"asset"],["src","assets/resources/omelette.svg","alt","",1,"asset"],["src","assets/resources/pig.svg","alt","",1,"asset"],["src","assets/resources/plank.svg","alt","",1,"asset"],["src","assets/resources/pottery.svg","alt","",1,"asset"],["src","assets/resources/sheep.svg","alt","",1,"asset"],["src","assets/resources/silver.svg","alt","",1,"asset"],["src","assets/resources/silver_ore.svg","alt","",1,"asset"],["src","assets/resources/steel.svg","alt","",1,"asset"],["src","assets/resources/stone.svg","alt","",1,"asset"],["src","assets/resources/axe.svg","alt","",1,"asset"],["src","assets/resources/hammer.svg","alt","",1,"asset"],["src","assets/resources/pickaxe.svg","alt","",1,"asset"],["src","assets/resources/pie.svg","alt","",1,"asset"],["src","assets/resources/shovel.svg","alt","",1,"asset"],["src","assets/resources/spear.svg","alt","",1,"asset"],["src","assets/resources/sword.svg","alt","",1,"asset"],["src","assets/resources/tin.svg","alt","",1,"asset"],["src","assets/resources/tin_ore.svg","alt","",1,"asset"],["src","assets/resources/vegetable_soup.svg","alt","",1,"asset"],["src","assets/resources/wheat.svg","alt","",1,"asset"],["src","assets/resources/wine.svg","alt","",1,"asset"],["src","assets/resources/shield.svg","alt","",1,"asset"],["src","assets/resources/wool.svg","alt","",1,"asset"],["id","header"],["id","left-menu"],["id","center"],["id","screen"],["id","right-menu"],["id","footer"]],template:function(e,t){1&e&&(xo(0,"div",0,1),Fo(2,"img",2),Fo(3,"img",3),Fo(4,"img",4),Fo(5,"img",5),Fo(6,"img",6),Fo(7,"img",7),Fo(8,"img",8),Fo(9,"img",9),Fo(10,"img",10),Fo(11,"img",11),Fo(12,"img",12),Fo(13,"img",13),Fo(14,"img",14),Fo(15,"img",15),Fo(16,"img",16),Fo(17,"img",17),Fo(18,"img",18),Fo(19,"img",19),Fo(20,"img",20),Fo(21,"img",21),Fo(22,"img",22),Fo(23,"img",23),Fo(24,"img",24),Fo(25,"img",25),Fo(26,"img",26),Fo(27,"img",27),Fo(28,"img",28),Fo(29,"img",29),Fo(30,"img",30),Fo(31,"img",31),Fo(32,"img",32),Fo(33,"img",33),Fo(34,"img",34),Fo(35,"img",35),Fo(36,"img",36),Fo(37,"img",37),Fo(38,"img",38),Fo(39,"img",39),Fo(40,"img",40),Fo(41,"img",41),Fo(42,"img",42),Fo(43,"img",43),Fo(44,"img",44),Fo(45,"img",45),Fo(46,"img",46),Fo(47,"img",47),Fo(48,"img",48),Fo(49,"img",49),Fo(50,"img",50),Fo(51,"img",51),Fo(52,"img",52),Fo(53,"img",53),Fo(54,"img",54),Fo(55,"img",55),Fo(56,"img",56),Fo(57,"img",57),Fo(58,"img",58),Fo(59,"img",59),Fo(60,"img",60),Fo(61,"img",61),Fo(62,"img",62),Fo(63,"img",63),Fo(64,"img",64),Fo(65,"img",65),Fo(66,"img",66),Fo(67,"img",67),Fo(68,"img",68),Fo(69,"img",69),Fo(70,"img",70),Fo(71,"img",71),Fo(72,"img",72),Fo(73,"img",73),Fo(74,"img",74),Fo(75,"img",75),Fo(76,"img",76),Fo(77,"img",77),Fo(78,"img",78),Fo(79,"img",79),Fo(80,"img",80),Fo(81,"img",81),Fo(82,"img",82),Fo(83,"img",83),Fo(84,"img",84),Fo(85,"img",85),Fo(86,"img",86),Fo(87,"img",87),Fo(88,"img",88),Fo(89,"img",89),Fo(90,"img",90),Fo(91,"img",91),Fo(92,"img",92),Fo(93,"img",93),Fo(94,"img",94),Fo(95,"img",95),Fo(96,"img",96),Fo(97,"img",97),Fo(98,"img",98),Fo(99,"img",99),Fo(100,"img",100),Fo(101,"img",101),Fo(102,"img",102),Fo(103,"img",103),Fo(104,"img",104),Fo(105,"img",105),Fo(106,"img",106),Fo(107,"img",107),Fo(108,"img",108),Fo(109,"img",109),Fo(110,"img",110),Fo(111,"img",111),Fo(112,"img",112),Fo(113,"img",113),Fo(114,"img",114),Fo(115,"img",115),Fo(116,"img",116),Fo(117,"img",117),Fo(118,"img",118),Fo(119,"img",119),Fo(120,"img",120),xo(121,"div",121),Fo(122,"app-header"),ko(),xo(123,"div",122),Fo(124,"app-left-menu"),ko(),xo(125,"div",123),xo(126,"div",124),Fo(127,"router-outlet"),ko(),ko(),xo(128,"div",125),Fo(129,"app-log"),ko(),xo(130,"div",126),Fo(131,"app-footer"),ko(),ko())},directives:[cU,TU,df,PU,kU],styles:["#wrapper[_ngcontent-%COMP%]{position:relative;display:grid;height:calc(100% - 2px);width:calc(100% - 2px);max-height:100%;grid-template-columns:11% auto 20%;grid-template-rows:35px auto 35px;border:black solid 1px;background:var(--background-clour);background-image:url(old_parchment.5ec6f5823080b4e43708.jpg);background-size:100% 100%}#header[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:4;border:black solid 1px;overflow:hidden}#left-menu[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:2;border:black solid 1px;overflow:hidden}#center[_ngcontent-%COMP%]{grid-column-start:2;grid-column-end:3;border:black solid 1px;overflow:hidden}#screen[_ngcontent-%COMP%]{height:100%}#right-menu[_ngcontent-%COMP%]{grid-column-start:3;grid-column-end:4;border:black solid 1px;overflow:hidden}#footer[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:4;border:black solid 1px;overflow:hidden}.asset[_ngcontent-%COMP%]{display:none}"]}),e})();function HU(e,t){1&e&&(Uo(0),Fo(1,"app-modals"),Fo(2,"app-game"),Ho())}function GU(e,t){1&e&&(Uo(0),xo(1,"div",1),xo(2,"span"),sa(3,"Internet Explorer is not supported."),Fo(4,"br"),sa(5,"Please use Firefox, Chrome, Safari"),Fo(6,"br"),sa(7,"or Edge."),ko(),ko(),Ho())}let BU=(()=>{class e{constructor(){this.title="app"}isIE(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode}catchContextMenu(e){return!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ve({type:e,selectors:[["app-root"]],hostBindings:function(e,t){1&e&&Vo("contextmenu",function(e){return t.catchContextMenu(e)},!1,ur)},decls:2,vars:2,consts:[[4,"ngIf"],["id","IEwrapper"]],template:function(e,t){1&e&&(Po(0,HU,3,0,"ng-container",0),Po(1,GU,8,0,"ng-container",0)),2&e&&(Lo("ngIf",!t.isIE()),Jr(1),Lo("ngIf",t.isIE()))},directives:[Gu,Qk,UU],styles:["#IEwrapper[_ngcontent-%COMP%]{border:black solid 1px;background:#919191;font-size:3em;height:100%;max-height:100%;display:flex;justify-content:center;align-items:center}#IEwrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}"]}),e})();class WU{}const VU="*";function zU(e,t=null){return{type:2,steps:e,options:t}}function YU(e){return{type:6,styles:e,offset:null}}function KU(e){Promise.resolve(null).then(e)}class jU{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){KU(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class $U{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,s=0;const r=this.players.length;0==r?KU(()=>this._onFinish()):this.players.forEach(e=>{e.onDone(()=>{++t==r&&this._onFinish()}),e.onDestroy(()=>{++i==r&&this._onDestroy()}),e.onStart(()=>{++s==r&&this._onStart()})}),this.totalTime=this.players.reduce((e,t)=>Math.max(e,t.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(e=>{const i=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(i)})}getPosition(){const e=this.players.reduce((e,t)=>null===e||t.totalTime>e.totalTime?t:e,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}function QU(){return"undefined"!=typeof window&&void 0!==window.document}function qU(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function XU(e){switch(e.length){case 0:return new jU;case 1:return e[0];default:return new $U(e)}}function ZU(e,t,i,s,r={},n={}){const o=[],a=[];let c=-1,l=null;if(s.forEach(e=>{const i=e.offset,s=i==c,u=s&&l||{};Object.keys(e).forEach(i=>{let s=i,a=e[i];if("offset"!==i)switch(s=t.normalizePropertyName(s,o),a){case"!":a=r[i];break;case VU:a=n[i];break;default:a=t.normalizeStyleValue(i,s,a,o)}u[s]=a}),s||a.push(u),l=u,c=i}),o.length){const e="\n - ";throw new Error(`Unable to animate due to the following errors:${e}${o.join(e)}`)}return a}function JU(e,t,i,s){switch(t){case"start":e.onStart(()=>s(i&&eH(i,"start",e)));break;case"done":e.onDone(()=>s(i&&eH(i,"done",e)));break;case"destroy":e.onDestroy(()=>s(i&&eH(i,"destroy",e)))}}function eH(e,t,i){const s=i.totalTime,r=tH(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==s?e.totalTime:s,!!i.disabled),n=e._data;return null!=n&&(r._data=n),r}function tH(e,t,i,s,r="",n=0,o){return{element:e,triggerName:t,fromState:i,toState:s,phaseName:r,totalTime:n,disabled:!!o}}function iH(e,t,i){let s;return e instanceof Map?(s=e.get(t),s||e.set(t,s=i)):(s=e[t],s||(s=e[t]=i)),s}function sH(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let rH=(e,t)=>!1,nH=(e,t)=>!1,oH=(e,t,i)=>[];const aH=qU();(aH||"undefined"!=typeof Element)&&(rH=QU()?(e,t)=>{for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:(e,t)=>e.contains(t),nH=(()=>{if(aH||Element.prototype.matches)return(e,t)=>e.matches(t);{const e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?(e,i)=>t.apply(e,[i]):nH}})(),oH=(e,t,i)=>{let s=[];if(i){const i=e.querySelectorAll(t);for(let e=0;e<i.length;e++)s.push(i[e])}else{const i=e.querySelector(t);i&&s.push(i)}return s});let cH=null,lH=!1;function uH(e){cH||(cH=("undefined"!=typeof document?document.body:null)||{},lH=!!cH.style&&"WebkitAppearance"in cH.style);let t=!0;return cH.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in cH.style,!t&&lH&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in cH.style)),t}const hH=nH,dH=rH,gH=oH;let pH=(()=>{class e{validateStyleProperty(e){return uH(e)}matchesElement(e,t){return hH(e,t)}containsElement(e,t){return dH(e,t)}query(e,t,i){return gH(e,t,i)}computeStyle(e,t,i){return i||""}animate(e,t,i,s,r,n=[],o){return new jU(i,s)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class fH{}fH.NOOP=new pH;const mH="ng-enter",SH="ng-leave",EH="ng-trigger",vH=".ng-trigger",RH="ng-animating",OH=".ng-animating";function TH(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:IH(parseFloat(t[1]),t[2])}function IH(e,t){switch(t){case"s":return 1e3*e;default:return e}}function bH(e,t,i){return e.hasOwnProperty("duration")?e:function(e,t,i){let s,r=0,n="";if("string"==typeof e){const i=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===i)return t.push(`The provided timing value "${e}" is invalid.`),{duration:0,delay:0,easing:""};s=IH(parseFloat(i[1]),i[2]);const o=i[3];null!=o&&(r=IH(parseFloat(o),i[4]));const a=i[5];a&&(n=a)}else s=e;if(!i){let i=!1,n=t.length;s<0&&(t.push("Duration values below 0 are not allowed for this animation step."),i=!0),r<0&&(t.push("Delay values below 0 are not allowed for this animation step."),i=!0),i&&t.splice(n,0,`The provided timing value "${e}" is invalid.`)}return{duration:s,delay:r,easing:n}}(e,t,i)}function CH(e,t={}){return Object.keys(e).forEach(i=>{t[i]=e[i]}),t}function yH(e,t,i={}){if(t)for(let s in e)i[s]=e[s];else CH(e,i);return i}function AH(e,t,i){return i?t+":"+i+";":""}function NH(e){let t="";for(let i=0;i<e.style.length;i++){const s=e.style.item(i);t+=AH(0,s,e.style.getPropertyValue(s))}for(const i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=AH(0,UH(i),e.style[i]));e.setAttribute("style",t)}function _H(e,t,i){e.style&&(Object.keys(t).forEach(s=>{const r=FH(s);i&&!i.hasOwnProperty(s)&&(i[s]=e.style[r]),e.style[r]=t[s]}),qU()&&NH(e))}function wH(e,t){e.style&&(Object.keys(t).forEach(t=>{const i=FH(t);e.style[i]=""}),qU()&&NH(e))}function PH(e){return Array.isArray(e)?1==e.length?e[0]:zU(e):e}const MH=new RegExp("{{\\s*(.+?)\\s*}}","g");function LH(e){let t=[];if("string"==typeof e){let i;for(;i=MH.exec(e);)t.push(i[1]);MH.lastIndex=0}return t}function DH(e,t,i){const s=e.toString(),r=s.replace(MH,(e,s)=>{let r=t[s];return t.hasOwnProperty(s)||(i.push(`Please provide a value for the animation param ${s}`),r=""),r.toString()});return r==s?e:r}function xH(e){const t=[];let i=e.next();for(;!i.done;)t.push(i.value),i=e.next();return t}const kH=/-+([a-z0-9])/g;function FH(e){return e.replace(kH,(...e)=>e[1].toUpperCase())}function UH(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function HH(e,t,i){switch(t.type){case 7:return e.visitTrigger(t,i);case 0:return e.visitState(t,i);case 1:return e.visitTransition(t,i);case 2:return e.visitSequence(t,i);case 3:return e.visitGroup(t,i);case 4:return e.visitAnimate(t,i);case 5:return e.visitKeyframes(t,i);case 6:return e.visitStyle(t,i);case 8:return e.visitReference(t,i);case 9:return e.visitAnimateChild(t,i);case 10:return e.visitAnimateRef(t,i);case 11:return e.visitQuery(t,i);case 12:return e.visitStagger(t,i);default:throw new Error(`Unable to resolve animation metadata node #${t.type}`)}}function GH(e,t){const i=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(e=>function(e,t,i){if(":"==e[0]){const s=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,t)=>parseFloat(t)>parseFloat(e);case":decrement":return(e,t)=>parseFloat(t)<parseFloat(e);default:return t.push(`The transition alias value "${e}" is not supported`),"* => *"}}(e,i);if("function"==typeof s)return void t.push(s);e=s}const s=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==s||s.length<4)return i.push(`The provided transition expression "${e}" is not supported`),t;const r=s[1],n=s[2],o=s[3];t.push(VH(r,o));"<"==n[0]&&!("*"==r&&"*"==o)&&t.push(VH(o,r))}(e,i,t)):i.push(e),i}const BH=new Set(["true","1"]),WH=new Set(["false","0"]);function VH(e,t){const i=BH.has(e)||WH.has(e),s=BH.has(t)||WH.has(t);return(r,n)=>{let o="*"==e||e==r,a="*"==t||t==n;return!o&&i&&"boolean"==typeof r&&(o=r?BH.has(e):WH.has(e)),!a&&s&&"boolean"==typeof n&&(a=n?BH.has(t):WH.has(t)),o&&a}}const zH=new RegExp("s*:selfs*,?","g");function YH(e,t,i){return new KH(e).build(t,i)}class KH{constructor(e){this._driver=e}build(e,t){const i=new jH(t);return this._resetContextStyleTimingState(i),HH(this,PH(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,s=t.depCount=0;const r=[],n=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(e=>{if(this._resetContextStyleTimingState(t),0==e.type){const i=e,s=i.name;s.toString().split(/\s*,\s*/).forEach(e=>{i.name=e,r.push(this.visitState(i,t))}),i.name=s}else if(1==e.type){const r=this.visitTransition(e,t);i+=r.queryCount,s+=r.depCount,n.push(r)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:r,transitions:n,queryCount:i,depCount:s,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),s=e.options&&e.options.params||null;if(i.containsDynamicStyles){const r=new Set,n=s||{};if(i.styles.forEach(e=>{if($H(e)){const t=e;Object.keys(t).forEach(e=>{LH(t[e]).forEach(e=>{n.hasOwnProperty(e)||r.add(e)})})}}),r.size){const i=xH(r.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${i.join(", ")}`)}}return{type:0,name:e.name,style:i,options:s?{params:s}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=HH(this,PH(e.animation),t);return{type:1,matchers:GH(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:QH(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(e=>HH(this,e,t)),options:QH(e.options)}}visitGroup(e,t){const i=t.currentTime;let s=0;const r=e.steps.map(e=>{t.currentTime=i;const r=HH(this,e,t);return s=Math.max(s,t.currentTime),r});return t.currentTime=s,{type:3,steps:r,options:QH(e.options)}}visitAnimate(e,t){const i=function(e,t){let i=null;if(e.hasOwnProperty("duration"))i=e;else if("number"==typeof e)return qH(bH(e,t).duration,0,"");const s=e;if(s.split(/\s+/).some(e=>"{"==e.charAt(0)&&"{"==e.charAt(1))){const e=qH(0,0,"");return e.dynamic=!0,e.strValue=s,e}return i=i||bH(s,t),qH(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let s,r=e.styles?e.styles:YU({});if(5==r.type)s=this.visitKeyframes(r,t);else{let r=e.styles,n=!1;if(!r){n=!0;const e={};i.easing&&(e.easing=i.easing),r=YU(e)}t.currentTime+=i.duration+i.delay;const o=this.visitStyle(r,t);o.isEmptyStep=n,s=o}return t.currentAnimateTimings=null,{type:4,timings:i,style:s,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[];Array.isArray(e.styles)?e.styles.forEach(e=>{"string"==typeof e?e==VU?i.push(e):t.errors.push(`The provided style string value ${e} is not allowed.`):i.push(e)}):i.push(e.styles);let s=!1,r=null;return i.forEach(e=>{if($H(e)){const t=e,i=t.easing;if(i&&(r=i,delete t.easing),!s)for(let e in t)if(t[e].toString().indexOf("{{")>=0){s=!0;break}}}),{type:6,styles:i,easing:r,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let s=t.currentTime,r=t.currentTime;i&&r>0&&(r-=i.duration+i.delay),e.styles.forEach(e=>{"string"!=typeof e&&Object.keys(e).forEach(i=>{if(!this._driver.validateStyleProperty(i))return void t.errors.push(`The provided animation property "${i}" is not a supported CSS property for animations`);const n=t.collectedStyles[t.currentQuerySelector],o=n[i];let a=!0;o&&(r!=s&&r>=o.startTime&&s<=o.endTime&&(t.errors.push(`The CSS property "${i}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${r}ms" and "${s}ms"`),a=!1),r=o.startTime),a&&(n[i]={startTime:r,endTime:s}),t.options&&function(e,t,i){const s=t.params||{},r=LH(e);r.length&&r.forEach(e=>{s.hasOwnProperty(e)||i.push(`Unable to resolve the local animation param ${e} in the given list of values`)})}(e[i],t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),i;let s=0;const r=[];let n=!1,o=!1,a=0;const c=e.steps.map(e=>{const i=this._makeStyleAst(e,t);let c=null!=i.offset?i.offset:function(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(e=>{if($H(e)&&e.hasOwnProperty("offset")){const i=e;t=parseFloat(i.offset),delete i.offset}});else if($H(e)&&e.hasOwnProperty("offset")){const i=e;t=parseFloat(i.offset),delete i.offset}return t}(i.styles),l=0;return null!=c&&(s++,l=i.offset=c),o=o||l<0||l>1,n=n||l<a,a=l,r.push(l),i});o&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),n&&t.errors.push("Please ensure that all keyframe offsets are in order");const l=e.steps.length;let u=0;s>0&&s<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==s&&(u=1/(l-1));const h=l-1,d=t.currentTime,g=t.currentAnimateTimings,p=g.duration;return c.forEach((e,s)=>{const n=u>0?s==h?1:u*s:r[s],o=n*p;t.currentTime=d+g.delay+o,g.duration=o,this._validateStyleAst(e,t),e.offset=n,i.styles.push(e)}),i}visitReference(e,t){return{type:8,animation:HH(this,PH(e.animation),t),options:QH(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:QH(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:QH(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,s=e.options||{};t.queryCount++,t.currentQuery=e;const[r,n]=function(e){const t=!!e.split(/\s*,\s*/).find(e=>":self"==e);return t&&(e=e.replace(zH,"")),[e=e.replace(/@\*/g,vH).replace(/@\w+/g,e=>vH+"-"+e.substr(1)).replace(/:animating/g,OH),t]}(e.selector);t.currentQuerySelector=i.length?i+" "+r:r,iH(t.collectedStyles,t.currentQuerySelector,{});const o=HH(this,PH(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:r,limit:s.limit||0,optional:!!s.optional,includeSelf:n,animation:o,originalSelector:e.selector,options:QH(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:bH(e.timings,t.errors,!0);return{type:12,animation:HH(this,PH(e.animation),t),timings:i,options:null}}}class jH{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function $H(e){return!Array.isArray(e)&&"object"==typeof e}function QH(e){return e?(e=CH(e)).params&&(e.params=function(e){return e?CH(e):null}(e.params)):e={},e}function qH(e,t,i){return{duration:e,delay:t,easing:i}}function XH(e,t,i,s,r,n,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:i,postStyleProps:s,duration:r,delay:n,totalTime:r+n,easing:o,subTimeline:a}}class ZH{constructor(){this._map=new Map}consume(e){let t=this._map.get(e);return t?this._map.delete(e):t=[],t}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const JH=new RegExp(":enter","g"),eG=new RegExp(":leave","g");function tG(e,t,i,s,r,n={},o={},a,c,l=[]){return(new iG).buildKeyframes(e,t,i,s,r,n,o,a,c,l)}class iG{buildKeyframes(e,t,i,s,r,n,o,a,c,l=[]){c=c||new ZH;const u=new rG(e,t,c,s,r,l,[]);u.options=a,u.currentTimeline.setStyles([n],null,u.errors,a),HH(this,i,u);const h=u.timelines.filter(e=>e.containsAnimation());if(h.length&&Object.keys(o).length){const e=h[h.length-1];e.allowOnlyTimelineStyles()||e.setStyles([o],null,u.errors,a)}return h.length?h.map(e=>e.buildKeyframes()):[XH(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.consume(t.element);if(i){const s=t.createSubContext(e.options),r=t.currentTimeline.currentTime,n=this._visitSubInstructions(i,s,s.options);r!=n&&t.transformIntoNewTimeline(n)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const r=null!=i.duration?TH(i.duration):null,n=null!=i.delay?TH(i.delay):null;return 0!==r&&e.forEach(e=>{const i=t.appendInstructionToTimeline(e,r,n);s=Math.max(s,i.duration+i.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),HH(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let s=t;const r=e.options;if(r&&(r.params||r.delay)&&(s=t.createSubContext(r),s.transformIntoNewTimeline(),null!=r.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=sG);const e=TH(r.delay);s.delayNextStep(e)}e.steps.length&&(e.steps.forEach(e=>HH(this,e,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>i&&s.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let s=t.currentTimeline.currentTime;const r=e.options&&e.options.delay?TH(e.options.delay):0;e.steps.forEach(n=>{const o=t.createSubContext(e.options);r&&o.delayNextStep(r),HH(this,n,o),s=Math.max(s,o.currentTimeline.currentTime),i.push(o.currentTimeline)}),i.forEach(e=>t.currentTimeline.mergeTimelineCollectedStyles(e)),t.transformIntoNewTimeline(s),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return bH(t.params?DH(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),s=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),s.snapshotCurrentStyles());const r=e.style;5==r.type?this.visitKeyframes(r,t):(t.incrementTime(i.duration),this.visitStyle(r,t),s.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,s=t.currentAnimateTimings;!s&&i.getCurrentStyleProperties().length&&i.forwardFrame();const r=s&&s.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(r):i.setStyles(e.styles,r,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,s=t.currentTimeline.duration,r=i.duration,n=t.createSubContext().currentTimeline;n.easing=i.easing,e.styles.forEach(e=>{n.forwardTime((e.offset||0)*r),n.setStyles(e.styles,e.easing,t.errors,t.options),n.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(n),t.transformIntoNewTimeline(s+r),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,s=e.options||{},r=s.delay?TH(s.delay):0;r&&(6===t.previousNode.type||0==i&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=sG);let n=i;const o=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!s.optional,t.errors);t.currentQueryTotal=o.length;let a=null;o.forEach((i,s)=>{t.currentQueryIndex=s;const o=t.createSubContext(e.options,i);r&&o.delayNextStep(r),i===t.element&&(a=o.currentTimeline),HH(this,e.animation,o),o.currentTimeline.applyStylesToKeyframe(),n=Math.max(n,o.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(n),a&&(t.currentTimeline.mergeTimelineCollectedStyles(a),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,s=t.currentTimeline,r=e.timings,n=Math.abs(r.duration),o=n*(t.currentQueryTotal-1);let a=n*t.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":a=o-a;break;case"full":a=i.currentStaggerTime}const c=t.currentTimeline;a&&c.delayNextStep(a);const l=c.currentTime;HH(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=s.currentTime-l+(s.startTime-i.currentTimeline.startTime)}}const sG={};class rG{constructor(e,t,i,s,r,n,o,a){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=s,this._leaveClassName=r,this.errors=n,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=sG,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new nG(this._driver,t,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let s=this.options;null!=i.duration&&(s.duration=TH(i.duration)),null!=i.delay&&(s.delay=TH(i.delay));const r=i.params;if(r){let e=s.params;e||(e=this.options.params={}),Object.keys(r).forEach(i=>{(!t||!e.hasOwnProperty(i))&&(e[i]=DH(r[i],e,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(e=>{i[e]=t[e]})}}return e}createSubContext(e=null,t,i){const s=t||this.element,r=new rG(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,i||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(e),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(e){return this.previousNode=sG,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const s={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+e.delay,easing:""},r=new oG(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,s,e.stretchStartingKeyframe);return this.timelines.push(r),s}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,s,r,n){let o=[];if(s&&o.push(this.element),e.length>0){e=(e=e.replace(JH,"."+this._enterClassName)).replace(eG,"."+this._leaveClassName);let t=this._driver.query(this.element,e,1!=i);0!==i&&(t=i<0?t.slice(t.length+i,t.length):t.slice(0,i)),o.push(...t)}return!r&&0==o.length&&n.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),o}}class nG{constructor(e,t,i,s){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new nG(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||VU,this._currentKeyframe[e]=VU}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,s){t&&(this._previousKeyframe.easing=t);const r=s&&s.params||{},n=function(e,t){const i={};let s;return e.forEach(e=>{"*"===e?(s=s||Object.keys(t),s.forEach(e=>{i[e]=VU})):yH(e,!1,i)}),i}(e,this._globalTimelineStyles);Object.keys(n).forEach(e=>{const t=DH(n[e],r,i);this._pendingStyles[e]=t,this._localTimelineStyles.hasOwnProperty(e)||(this._backFill[e]=this._globalTimelineStyles.hasOwnProperty(e)?this._globalTimelineStyles[e]:VU),this._updateStyle(e,t)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(t=>{this._currentKeyframe[t]=e[t]}),Object.keys(this._localTimelineStyles).forEach(e=>{this._currentKeyframe.hasOwnProperty(e)||(this._currentKeyframe[e]=this._localTimelineStyles[e])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const i=this._styleSummary[t],s=e._styleSummary[t];(!i||s.time>i.time)&&this._updateStyle(t,s.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((r,n)=>{const o=yH(r,!0);Object.keys(o).forEach(i=>{const s=o[i];"!"==s?e.add(i):s==VU&&t.add(i)}),i||(o.offset=n/this.duration),s.push(o)});const r=e.size?xH(e.values()):[],n=t.size?xH(t.values()):[];if(i){const e=s[0],t=CH(e);e.offset=0,t.offset=1,s=[e,t]}return XH(this.element,s,r,n,this.duration,this.startTime,this.easing,!1)}}class oG extends nG{constructor(e,t,i,s,r,n,o=!1){super(e,t,n.delay),this.keyframes=i,this.preStyleProps=s,this.postStyleProps=r,this._stretchStartingKeyframe=o,this.timings={duration:n.duration,delay:n.delay,easing:n.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:s}=this.timings;if(this._stretchStartingKeyframe&&t){const r=[],n=i+t,o=t/n,a=yH(e[0],!1);a.offset=0,r.push(a);const c=yH(e[0],!1);c.offset=aG(o),r.push(c);const l=e.length-1;for(let s=1;s<=l;s++){let o=yH(e[s],!1);o.offset=aG((t+o.offset*i)/n),r.push(o)}i=n,t=0,s="",e=r}return XH(this.element,e,this.preStyleProps,this.postStyleProps,i,t,s,!0)}}function aG(e,t=3){const i=Math.pow(10,t-1);return Math.round(e*i)/i}class cG{}class lG extends cG{normalizePropertyName(e,t){return FH(e)}normalizeStyleValue(e,t,i,s){let r="";const n=i.toString().trim();if(uG[t]&&0!==i&&"0"!==i)if("number"==typeof i)r="px";else{const t=i.match(/^[+-]?[\d\.]+([a-z]*)$/);t&&0==t[1].length&&s.push(`Please provide a CSS unit value for ${e}:${i}`)}return n+r}}const uG=(()=>function(e){const t={};return e.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function hG(e,t,i,s,r,n,o,a,c,l,u,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:i,fromStyles:n,toState:s,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:h,errors:d}}const dG={};class gG{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,s){return function(e,t,i,s,r){return e.some(e=>e(t,i,s,r))}(this.ast.matchers,e,t,i,s)}buildStyles(e,t,i){const s=this._stateStyles["*"],r=this._stateStyles[e],n=s?s.buildStyles(t,i):{};return r?r.buildStyles(t,i):n}build(e,t,i,s,r,n,o,a,c,l){const u=[],h=this.ast.options&&this.ast.options.params||dG,d=this.buildStyles(i,o&&o.params||dG,u),g=a&&a.params||dG,p=this.buildStyles(s,g,u),f=new Set,m=new Map,S=new Map,E="void"===s,v={params:Object.assign(Object.assign({},h),g)},R=l?[]:tG(e,t,this.ast.animation,r,n,d,p,v,c,u);let O=0;if(R.forEach(e=>{O=Math.max(e.duration+e.delay,O)}),u.length)return hG(t,this._triggerName,i,s,E,d,p,[],[],m,S,O,u);R.forEach(e=>{const i=e.element,s=iH(m,i,{});e.preStyleProps.forEach(e=>s[e]=!0);const r=iH(S,i,{});e.postStyleProps.forEach(e=>r[e]=!0),i!==t&&f.add(i)});const T=xH(f.values());return hG(t,this._triggerName,i,s,E,d,p,R,T,m,S,O)}}class pG{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i={},s=CH(this.defaultParams);return Object.keys(e).forEach(t=>{const i=e[t];null!=i&&(s[t]=i)}),this.styles.styles.forEach(e=>{if("string"!=typeof e){const r=e;Object.keys(r).forEach(e=>{let n=r[e];n.length>1&&(n=DH(n,s,t));const o=this.normalizer.normalizePropertyName(e,t);n=this.normalizer.normalizeStyleValue(e,o,n,t),i[o]=n})}}),i}}class fG{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states={},t.states.forEach(e=>{this.states[e.name]=new pG(e.style,e.options&&e.options.params||{},i)}),mG(this.states,"true","1"),mG(this.states,"false","0"),t.transitions.forEach(t=>{this.transitionFactories.push(new gG(e,t,this.states))}),this.fallbackTransition=function(e,t,i){return new gG(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(e,t)=>!0],options:null,queryCount:0,depCount:0},t)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,s){return this.transitionFactories.find(r=>r.match(e,t,i,s))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function mG(e,t,i){e.hasOwnProperty(t)?e.hasOwnProperty(i)||(e[i]=e[t]):e.hasOwnProperty(i)&&(e[t]=e[i])}const SG=new ZH;class EG{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(e,t){const i=[],s=YH(this._driver,t,i);if(i.length)throw new Error(`Unable to build the animation due to the following errors: ${i.join("\n")}`);this._animations[e]=s}_buildPlayer(e,t,i){const s=e.element,r=ZU(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(s,r,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const s=[],r=this._animations[e];let n;const o=new Map;if(r?(n=tG(this._driver,t,r,mH,SH,{},{},i,SG,s),n.forEach(e=>{const t=iH(o,e.element,{});e.postStyleProps.forEach(e=>t[e]=null)})):(s.push("The requested animation doesn't exist or has already been destroyed"),n=[]),s.length)throw new Error(`Unable to create the animation due to the following errors: ${s.join("\n")}`);o.forEach((e,t)=>{Object.keys(e).forEach(i=>{e[i]=this._driver.computeStyle(t,i,VU)})});const a=XU(n.map(e=>{const t=o.get(e.element);return this._buildPlayer(e,{},t)}));return this._playersById[e]=a,a.onDestroy(()=>this.destroy(e)),this.players.push(a),a}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,i,s){const r=tH(t,"","","");return JU(this._getPlayer(e),i,r,s),()=>{}}command(e,t,i,s){if("register"==i)return void this.register(e,s[0]);if("create"==i)return void this.create(e,t,s[0]||{});const r=this._getPlayer(e);switch(i){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(e)}}}const vG="ng-animate-queued",RG="ng-animate-disabled",OG=".ng-animate-disabled",TG=[],IG={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},bG={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},CG="__ng_removed";class yG{constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function(e){return null!=e?e:null}(i?e.value:e),i){const t=CH(e);delete t.value,this.options=t}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const e=this.options.params;Object.keys(t).forEach(i=>{null==e[i]&&(e[i]=t[i])})}}}const AG="void",NG=new yG(AG);class _G{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,FG(t,this._hostClassName)}listen(e,t,i,s){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${i}" because the animation trigger "${t}" doesn't exist!`);if(null==i||0==i.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if(!function(e){return"start"==e||"done"==e}(i))throw new Error(`The provided animation trigger event "${i}" for the animation trigger "${t}" is not supported!`);const r=iH(this._elementListeners,e,[]),n={name:t,phase:i,callback:s};r.push(n);const o=iH(this._engine.statesByElement,e,{});return o.hasOwnProperty(t)||(FG(e,EH),FG(e,EH+"-"+t),o[t]=NG),()=>{this._engine.afterFlush(()=>{const e=r.indexOf(n);e>=0&&r.splice(e,1),this._triggers[t]||delete o[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,i,s=!0){const r=this._getTrigger(t),n=new PG(this.id,t,e);let o=this._engine.statesByElement.get(e);o||(FG(e,EH),FG(e,EH+"-"+t),this._engine.statesByElement.set(e,o={}));let a=o[t];const c=new yG(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&a&&c.absorbOptions(a.options),o[t]=c,a||(a=NG),c.value!==AG&&a.value===c.value){if(!function(e,t){const i=Object.keys(e),s=Object.keys(t);if(i.length!=s.length)return!1;for(let r=0;r<i.length;r++){const s=i[r];if(!t.hasOwnProperty(s)||e[s]!==t[s])return!1}return!0}(a.params,c.params)){const t=[],i=r.matchStyles(a.value,a.params,t),s=r.matchStyles(c.value,c.params,t);t.length?this._engine.reportError(t):this._engine.afterFlush(()=>{wH(e,i),_H(e,s)})}return}const l=iH(this._engine.playersByElement,e,[]);l.forEach(e=>{e.namespaceId==this.id&&e.triggerName==t&&e.queued&&e.destroy()});let u=r.matchTransition(a.value,c.value,e,c.params),h=!1;if(!u){if(!s)return;u=r.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:u,fromState:a,toState:c,player:n,isFallbackTransition:h}),h||(FG(e,vG),n.onStart(()=>{UG(e,vG)})),n.onDone(()=>{let t=this.players.indexOf(n);t>=0&&this.players.splice(t,1);const i=this._engine.playersByElement.get(e);if(i){let e=i.indexOf(n);e>=0&&i.splice(e,1)}}),this.players.push(n),l.push(n),n}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,i)=>{delete t[e]}),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(t=>t.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(e=>e.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,vH,!0);i.forEach(e=>{if(e[CG])return;const i=this._engine.fetchNamespacesByElement(e);i.size?i.forEach(i=>i.triggerLeaveAnimation(e,t,!1,!0)):this.clearElementCache(e)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(e=>this.clearElementCache(e)))}triggerLeaveAnimation(e,t,i,s){const r=this._engine.statesByElement.get(e);if(r){const n=[];if(Object.keys(r).forEach(t=>{if(this._triggers[t]){const i=this.trigger(e,t,AG,s);i&&n.push(i)}}),n.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),i&&XU(n).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const s=new Set;t.forEach(t=>{const r=t.name;if(s.has(r))return;s.add(r);const n=this._triggers[r].fallbackTransition,o=i[r]||NG,a=new yG(AG),c=new PG(this.id,r,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:r,transition:n,fromState:o,toState:a,player:c,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let s=!1;if(i.totalAnimations){const t=i.players.length?i.playersByQueriedElement.get(e):[];if(t&&t.length)s=!0;else{let t=e;for(;t=t.parentNode;)if(i.statesByElement.get(t)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(e),s)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[CG];(!s||s===IG)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){FG(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const s=i.player;if(s.destroyed)return;const r=i.element,n=this._elementListeners.get(r);n&&n.forEach(t=>{if(t.name==i.triggerName){const s=tH(r,i.triggerName,i.fromState.value,i.toState.value);s._data=e,JU(i.player,t.phase,s,t.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):t.push(i)}),this._queue=[],t.sort((e,t)=>{const i=e.transition.ast.depCount,s=t.transition.ast.depCount;return 0==i||0==s?i-s:this._engine.driver.containsElement(e.element,t.element)?1:-1})}destroy(e){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(t=>t.element===e)||t,t}}class wG{constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(e,t)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(t=>{t.queued&&e.push(t)})}),e}createNamespace(e,t){const i=new _G(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList.length-1;if(i>=0){let s=!1;for(let r=i;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,t)){this._namespaceList.splice(r+1,0,e),s=!0;break}s||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let s=this._namespaceLookup[e];s&&s.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const t=this._namespaceList.indexOf(i);t>=0&&this._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i){const e=Object.keys(i);for(let s=0;s<e.length;s++){const r=i[e[s]].namespaceId;if(r){const e=this._fetchNamespace(r);e&&t.add(e)}}}return t}trigger(e,t,i,s){if(MG(t)){const r=this._fetchNamespace(e);if(r)return r.trigger(t,i,s),!0}return!1}insertNode(e,t,i,s){if(!MG(t))return;const r=t[CG];if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;const e=this.collectedLeaveElements.indexOf(t);e>=0&&this.collectedLeaveElements.splice(e,1)}if(e){const s=this._fetchNamespace(e);s&&s.insertNode(t,i)}s&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),FG(e,RG)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),UG(e,RG))}removeNode(e,t,i,s){if(MG(t)){const r=e?this._fetchNamespace(e):null;if(r?r.removeNode(t,s):this.markElementAsRemoved(e,t,!1,s),i){const i=this.namespacesByHostElement.get(t);i&&i.id!==e&&i.removeNode(t,s)}}else this._onRemovalComplete(t,s)}markElementAsRemoved(e,t,i,s){this.collectedLeaveElements.push(t),t[CG]={namespaceId:e,setForRemoval:s,hasAnimation:i,removedBeforeQueried:!1}}listen(e,t,i,s,r){return MG(t)?this._fetchNamespace(e).listen(t,i,s,r):()=>{}}_buildInstruction(e,t,i,s,r){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,s,e.fromState.options,e.toState.options,t,r)}destroyInnerAnimations(e){let t=this.driver.query(e,vH,!0);t.forEach(e=>this.destroyActiveAnimationsForElement(e)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,OH,!0),t.forEach(e=>this.finishActiveQueriedAnimationOnElement(e)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(e=>{e.queued?e.markedForDestroy=!0:e.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(e=>e.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return XU(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[CG];if(t&&t.setForRemoval){if(e[CG]=IG,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}this.driver.matchesElement(e,OG)&&this.markElementAsDisabled(e,!1),this.driver.query(e,OG,!0).forEach(e=>{this.markElementAsDisabled(e,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((e,t)=>this._balanceNamespaceList(e,t)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)FG(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let e=0;e<i.length;e++)i[e]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(e=>e()),this._flushFns=[],this._whenQuietFns.length){const e=this._whenQuietFns;this._whenQuietFns=[],t.length?XU(t).onDone(()=>{e.forEach(e=>e())}):e.forEach(e=>e())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const i=new ZH,s=[],r=new Map,n=[],o=new Map,a=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(e=>{l.add(e);const t=this.driver.query(e,".ng-animate-queued",!0);for(let i=0;i<t.length;i++)l.add(t[i])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=xG(h,this.collectedEnterElements),g=new Map;let p=0;d.forEach((e,t)=>{const i=mH+p++;g.set(t,i),e.forEach(e=>FG(e,i))});const f=[],m=new Set,S=new Set;for(let w=0;w<this.collectedLeaveElements.length;w++){const e=this.collectedLeaveElements[w],t=e[CG];t&&t.setForRemoval&&(f.push(e),m.add(e),t.hasAnimation?this.driver.query(e,".ng-star-inserted",!0).forEach(e=>m.add(e)):S.add(e))}const E=new Map,v=xG(h,Array.from(m));v.forEach((e,t)=>{const i=SH+p++;E.set(t,i),e.forEach(e=>FG(e,i))}),e.push(()=>{d.forEach((e,t)=>{const i=g.get(t);e.forEach(e=>UG(e,i))}),v.forEach((e,t)=>{const i=E.get(t);e.forEach(e=>UG(e,i))}),f.forEach(e=>{this.processLeaveNode(e)})});const R=[],O=[];for(let w=this._namespaceList.length-1;w>=0;w--)this._namespaceList[w].drainQueuedTransitions(t).forEach(e=>{const t=e.player,r=e.element;if(R.push(t),this.collectedEnterElements.length){const e=r[CG];if(e&&e.setForMove)return void t.destroy()}const l=!u||!this.driver.containsElement(u,r),h=E.get(r),d=g.get(r),p=this._buildInstruction(e,i,d,h,l);if(p.errors&&p.errors.length)O.push(p);else{if(l)return t.onStart(()=>wH(r,p.fromStyles)),t.onDestroy(()=>_H(r,p.toStyles)),void s.push(t);if(e.isFallbackTransition)return t.onStart(()=>wH(r,p.fromStyles)),t.onDestroy(()=>_H(r,p.toStyles)),void s.push(t);p.timelines.forEach(e=>e.stretchStartingKeyframe=!0),i.append(r,p.timelines),n.push({instruction:p,player:t,element:r}),p.queriedElements.forEach(e=>iH(o,e,[]).push(t)),p.preStyleProps.forEach((e,t)=>{const i=Object.keys(e);if(i.length){let e=a.get(t);e||a.set(t,e=new Set),i.forEach(t=>e.add(t))}}),p.postStyleProps.forEach((e,t)=>{const i=Object.keys(e);let s=c.get(t);s||c.set(t,s=new Set),i.forEach(e=>s.add(e))})}});if(O.length){const e=[];O.forEach(t=>{e.push(`@${t.triggerName} has failed due to:\n`),t.errors.forEach(t=>e.push(`- ${t}\n`))}),R.forEach(e=>e.destroy()),this.reportError(e)}const T=new Map,I=new Map;n.forEach(e=>{const t=e.element;i.has(t)&&(I.set(t,t),this._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),s.forEach(e=>{const t=e.element;this._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(e=>{iH(T,t,[]).push(e),e.destroy()})});const b=f.filter(e=>BG(e,a,c)),C=new Map;DG(C,this.driver,S,c,VU).forEach(e=>{BG(e,a,c)&&b.push(e)});const y=new Map;d.forEach((e,t)=>{DG(y,this.driver,new Set(e),a,"!")}),b.forEach(e=>{const t=C.get(e),i=y.get(e);C.set(e,Object.assign(Object.assign({},t),i))});const A=[],N=[],_={};n.forEach(e=>{const{element:t,player:n,instruction:o}=e;if(i.has(t)){if(l.has(t))return n.onDestroy(()=>_H(t,o.toStyles)),n.disabled=!0,n.overrideTotalTime(o.totalTime),void s.push(n);let e=_;if(I.size>1){let i=t;const s=[];for(;i=i.parentNode;){const t=I.get(i);if(t){e=t;break}s.push(i)}s.forEach(t=>I.set(t,e))}const i=this._buildAnimation(n.namespaceId,o,T,r,y,C);if(n.setRealPlayer(i),e===_)A.push(n);else{const t=this.playersByElement.get(e);t&&t.length&&(n.parentPlayer=XU(t)),s.push(n)}}else wH(t,o.fromStyles),n.onDestroy(()=>_H(t,o.toStyles)),N.push(n),l.has(t)&&s.push(n)}),N.forEach(e=>{const t=r.get(e.element);if(t&&t.length){const i=XU(t);e.setRealPlayer(i)}}),s.forEach(e=>{e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(let w=0;w<f.length;w++){const e=f[w],t=e[CG];if(UG(e,SH),t&&t.hasAnimation)continue;let i=[];if(o.size){let t=o.get(e);t&&t.length&&i.push(...t);let s=this.driver.query(e,OH,!0);for(let e=0;e<s.length;e++){let t=o.get(s[e]);t&&t.length&&i.push(...t)}}const s=i.filter(e=>!e.destroyed);s.length?HG(this,e,s):this.processLeaveNode(e)}return f.length=0,A.forEach(e=>{this.players.push(e),e.onDone(()=>{e.destroy();const t=this.players.indexOf(e);this.players.splice(t,1)}),e.play()}),A}elementContainsData(e,t){let i=!1;const s=t[CG];return s&&s.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,s,r){let n=[];if(t){const t=this.playersByQueriedElement.get(e);t&&(n=t)}else{const t=this.playersByElement.get(e);if(t){const e=!r||r==AG;t.forEach(t=>{t.queued||!e&&t.triggerName!=s||n.push(t)})}}return(i||s)&&(n=n.filter(e=>!(i&&i!=e.namespaceId||s&&s!=e.triggerName))),n}_beforeAnimationBuild(e,t,i){const s=t.element,r=t.isRemovalTransition?void 0:e,n=t.isRemovalTransition?void 0:t.triggerName;for(const o of t.timelines){const e=o.element,a=e!==s,c=iH(i,e,[]);this._getPreviousPlayers(e,a,r,n,t.toState).forEach(e=>{const t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})}wH(s,t.fromStyles)}_buildAnimation(e,t,i,s,r,n){const o=t.triggerName,a=t.element,c=[],l=new Set,u=new Set,h=t.timelines.map(t=>{const h=t.element;l.add(h);const d=h[CG];if(d&&d.removedBeforeQueried)return new jU(t.duration,t.delay);const g=h!==a,p=function(e){const t=[];return GG(e,t),t}((i.get(h)||TG).map(e=>e.getRealPlayer())).filter(e=>!!e.element&&e.element===h),f=r.get(h),m=n.get(h),S=ZU(0,this._normalizer,0,t.keyframes,f,m),E=this._buildPlayer(t,S,p);if(t.subTimeline&&s&&u.add(h),g){const t=new PG(e,o,h);t.setRealPlayer(E),c.push(t)}return E});c.forEach(e=>{iH(this.playersByQueriedElement,e.element,[]).push(e),e.onDone(()=>function(e,t,i){let s;if(e instanceof Map){if(s=e.get(t),s){if(s.length){const e=s.indexOf(i);s.splice(e,1)}0==s.length&&e.delete(t)}}else if(s=e[t],s){if(s.length){const e=s.indexOf(i);s.splice(e,1)}0==s.length&&delete e[t]}return s}(this.playersByQueriedElement,e.element,e))}),l.forEach(e=>FG(e,RH));const d=XU(h);return d.onDestroy(()=>{l.forEach(e=>UG(e,RH)),_H(a,t.toStyles)}),u.forEach(e=>{iH(s,e,[]).push(d)}),d}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new jU(e.duration,e.delay)}}class PG{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new jU,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(i=>JU(e,t,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){iH(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function MG(e){return e&&1===e.nodeType}function LG(e,t){const i=e.style.display;return e.style.display=null!=t?t:"none",i}function DG(e,t,i,s,r){const n=[];i.forEach(e=>n.push(LG(e)));const o=[];s.forEach((i,s)=>{const n={};i.forEach(e=>{const i=n[e]=t.computeStyle(s,e,r);(!i||0==i.length)&&(s[CG]=bG,o.push(s))}),e.set(s,n)});let a=0;return i.forEach(e=>LG(e,n[a++])),o}function xG(e,t){const i=new Map;if(e.forEach(e=>i.set(e,[])),0==t.length)return i;const s=new Set(t),r=new Map;function n(e){if(!e)return 1;let t=r.get(e);if(t)return t;const o=e.parentNode;return t=i.has(o)?o:s.has(o)?1:n(o),r.set(e,t),t}return t.forEach(e=>{const t=n(e);1!==t&&i.get(t).push(e)}),i}const kG="$$classes";function FG(e,t){if(e.classList)e.classList.add(t);else{let i=e[kG];i||(i=e[kG]={}),i[t]=!0}}function UG(e,t){if(e.classList)e.classList.remove(t);else{let i=e[kG];i&&delete i[t]}}function HG(e,t,i){XU(i).onDone(()=>e.processLeaveNode(t))}function GG(e,t){for(let i=0;i<e.length;i++){const s=e[i];s instanceof $U?GG(s.players,t):t.push(s)}}function BG(e,t,i){const s=i.get(e);if(!s)return!1;let r=t.get(e);return r?s.forEach(e=>r.add(e)):t.set(e,s),i.delete(e),!0}class WG{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(e,t)=>{},this._transitionEngine=new wG(e,t,i),this._timelineEngine=new EG(e,t,i),this._transitionEngine.onRemovalComplete=(e,t)=>this.onRemovalComplete(e,t)}registerTrigger(e,t,i,s,r){const n=e+"-"+s;let o=this._triggerCache[n];if(!o){const e=[],t=YH(this._driver,r,e);if(e.length)throw new Error(`The animation trigger "${s}" has failed to build due to the following errors:\n - ${e.join("\n - ")}`);o=function(e,t,i){return new fG(e,t,i)}(s,t,this._normalizer),this._triggerCache[n]=o}this._transitionEngine.registerTrigger(t,s,o)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,s){this._transitionEngine.insertNode(e,t,i,s)}onRemove(e,t,i,s){this._transitionEngine.removeNode(e,t,s||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,s){if("@"==i.charAt(0)){const[e,r]=sH(i);this._timelineEngine.command(e,t,r,s)}else this._transitionEngine.trigger(e,t,i,s)}listen(e,t,i,s,r){if("@"==i.charAt(0)){const[e,s]=sH(i);return this._timelineEngine.listen(e,t,s,r)}return this._transitionEngine.listen(e,t,i,s,r)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}class VG{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let s=VG.initialStylesByElement.get(e);s||VG.initialStylesByElement.set(e,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&_H(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(_H(this._element,this._initialStyles),this._endStyles&&(_H(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(VG.initialStylesByElement.delete(this._element),this._startStyles&&(wH(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(wH(this._element,this._endStyles),this._endStyles=null),_H(this._element,this._initialStyles),this._state=3)}}VG.initialStylesByElement=new WeakMap;let zG=(()=>{class e extends WU{constructor(e,t){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(t.body,{id:"0",encapsulation:Ae.None,styles:[],data:{animation:[]}})}build(e){const t=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(e)?zU(e):e;return jG(this._renderer,null,t,"register",[i]),new YG(t,this._renderer)}}return e.\u0275fac=function(t){return new(t||e)(gs(xa),gs(cu))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class YG extends class{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new KG(this._id,e,t||{},this._renderer)}}class KG{constructor(e,t,i,s){this.id=e,this.element=t,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return jG(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function jG(e,t,i,s,r){return e.setProperty(t,`@@${i}:${s}`,r)}const $G="@.disabled";let QG=(()=>{class e{constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),t.onRemovalComplete=(e,t)=>{t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}createRenderer(e,t){const i=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){let e=this._rendererCache.get(i);return e||(e=new qG("",i,this.engine),this._rendererCache.set(i,e)),e}const s=t.id,r=t.id+"-"+this._currentId;this._currentId++,this.engine.register(r,e);const n=t=>{Array.isArray(t)?t.forEach(n):this.engine.registerTrigger(s,r,e,t.name,t)};return t.data.animation.forEach(n),new XG(this,r,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){e>=0&&e<this._microtaskId?this._zone.run(()=>t(i)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(e=>{const[t,i]=e;t(i)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(t){return new(t||e)(gs(xa),gs(WG),gs(_l))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();class qG{constructor(e,t,i){this.namespaceId=e,this.delegate=t,this.engine=i,this.destroyNode=this.delegate.destroyNode?e=>t.destroyNode(e):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,s=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,s)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,s){this.delegate.setAttribute(e,t,i,s)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,s){this.delegate.setStyle(e,t,i,s)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==$G?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class XG extends qG{constructor(e,t,i,s){super(t,i,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==$G?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.substr(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const s=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e);let r=t.substr(1),n="";return"@"!=r.charAt(0)&&([r,n]=function(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(r)),this.engine.listen(this.namespaceId,s,r,n,e=>{this.factory.scheduleListenerCallback(e._data||-1,i,e)})}return this.delegate.listen(e,t,i)}}let ZG=(()=>{class e extends WG{constructor(e,t,i){super(e.body,t,i)}ngOnDestroy(){this.flush()}}return e.\u0275fac=function(t){return new(t||e)(gs(cu),gs(fH),gs(cG))},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})();const JG=[{provide:fH,useClass:pH},{provide:new ji("AnimationModuleType"),useValue:"NoopAnimations"},...[{provide:WU,useClass:zG},{provide:cG,useFactory:function(){return new lG}},{provide:WG,useClass:ZG},{provide:xa,useFactory:function(e,t,i){return new QG(e,t,i)},deps:[Th,WG,_l]}]];let eB=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e}),e.\u0275inj=ge({providers:JG,imports:[Dh]}),e})(),tB=(()=>{class e{constructor(){this.handlers={}}shouldDetach(e){return e.routeConfig&&("village"===e.routeConfig.path||"fort"===e.routeConfig.path||"forest"===e.routeConfig.path||"field"===e.routeConfig.path||"mountains"===e.routeConfig.path||"plateau"===e.routeConfig.path||"sea"===e.routeConfig.path)}store(e,t){this.handlers[e.routeConfig.path]=t}shouldAttach(e){return!!e.routeConfig&&!!this.handlers[e.routeConfig.path]}retrieve(e){return e.routeConfig?this.handlers[e.routeConfig.path]:null}shouldReuseRoute(e,t){return!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=de({token:e,factory:e.\u0275fac}),e})(),iB=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=je({type:e,bootstrap:[BU]}),e.\u0275inj=ge({providers:[Pv,{provide:$p,useClass:tB}],imports:[[tI,Dh,zM,eB,uv,jL]]}),e})();Am.production&&function(){if(Bl)throw new Error("Cannot enable prod mode after platform setup.");Gl=!1}(),Mh().bootstrapModule(iB).catch(e=>console.log(e))}},function(e){e(e.s=48475)}]);