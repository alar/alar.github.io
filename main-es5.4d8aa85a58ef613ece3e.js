!function(){function e(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var n,r,o=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(n=i.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(u){a=!0,r=u}finally{try{s||null==i.return||i.return()}finally{if(a)throw r}}return o}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=r(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==i.return||i.return()}finally{if(u)throw s}}}}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return a(e,arguments,v(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)})(e)}function a(e,t,i){return(a=f()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&l(r,i.prototype),r}).apply(null,arguments)}function u(e,t,i){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=f();return function(){var i,n=v(e);if(t){var r=v(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return d(this,i)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t,i){return t&&m(e.prototype,t),i&&m(e,i),e}(self.webpackChunkVillagerKings=self.webpackChunkVillagerKings||[]).push([[179],{98255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=98255,e.exports=t},48475:function(r,o,l){"use strict";function f(e){return"function"==typeof e}var m=!1,E={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else m&&console.log("RxJS: Back to a better error behavior. Thank you. <3");m=e},get useDeprecatedSynchronousErrorHandling(){return m}};function y(e){setTimeout(function(){throw e},0)}var R={closed:!0,next:function(e){},error:function(e){if(E.useDeprecatedSynchronousErrorHandling)throw e;y(e)},complete:function(){}},O=Array.isArray||function(e){return e&&"number"==typeof e.length};function T(e){return null!==e&&"object"==typeof e}var I,b=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),C=function(){function e(t){p(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return S(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var i=this._parentOrParents,n=this._ctorUnsubscribe,r=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(var s=0;s<i.length;++s)i[s].remove(this);if(f(r)){n&&(this._unsubscribe=void 0);try{r.call(this)}catch(s){t=s instanceof b?A(s.errors):[s]}}if(O(o))for(var a=-1,u=o.length;++a<u;){var c=o[a];if(T(c))try{c.unsubscribe()}catch(l){t=t||[],l instanceof b?t=t.concat(A(l.errors)):t.push(l)}}if(t)throw new b(t)}}},{key:"add",value:function(t){var i=t;if(!t)return e.EMPTY;switch(typeof t){case"function":i=new e(t);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){var n=i;(i=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var r=i._parentOrParents;if(null===r)i._parentOrParents=this;else if(r instanceof e){if(r===this)return i;i._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return i;r.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[i]:o.push(i),i}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}]),e}();function A(e){return e.reduce(function(e,t){return e.concat(t instanceof b?t.errors:t)},[])}C.EMPTY=((I=new C).closed=!0,I);var k="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),N=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;switch(p(this,i),(o=t.call(this)).syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=R;break;case 1:if(!e){o.destination=R;break}if("object"==typeof e){e instanceof i?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(g(o))):(o.syncErrorThrowable=!0,o.destination=new _(g(o),e));break}default:o.syncErrorThrowable=!0,o.destination=new _(g(o),e,n,r)}return o}return S(i,[{key:k,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,u(v(i.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,t,n){var r=new i(e,t,n);return r.syncErrorThrowable=!1,r}}]),i}(C),_=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;p(this,i),(s=t.call(this))._parentSubscriber=e;var a,u=g(s);return f(n)?a=n:n&&(a=n.next,r=n.error,o=n.complete,n!==R&&(f((u=Object.create(n)).unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(g(s)))),s._context=u,s._next=a,s._error=r,s._complete=o,s}return S(i,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;E.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,i=E.useDeprecatedSynchronousErrorHandling;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):y(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;y(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var i=function(){return e._complete.call(e._context)};E.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,i),this.unsubscribe()):(this.__tryOrUnsub(i),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),E.useDeprecatedSynchronousErrorHandling)throw i;y(i)}}},{key:"__tryOrSetError",value:function(e,t,i){if(!E.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(n){return E.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(y(n),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),i}(N),w="function"==typeof Symbol&&Symbol.observable||"@@observable";function P(e){return e}var M=function(){var e=function(){function e(t){p(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return S(e,[{key:"lift",value:function(t){var i=new e;return i.source=this,i.operator=t,i}},{key:"subscribe",value:function(e,t,i){var n=this.operator,r=function(e,t,i){if(e){if(e instanceof N)return e;if(e[k])return e[k]()}return e||t||i?new N(e,t,i):new N(R)}(e,t,i);if(r.add(n?n.call(r,this.source):this.source||E.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),E.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){E.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,i=t.closed,n=t.destination,r=t.isStopped;if(i||r)return!1;e=n&&n instanceof N?n:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var i=this;return new(t=D(t))(function(t,n){var r;r=i.subscribe(function(t){try{e(t)}catch(i){n(i),r&&r.unsubscribe()}},n,t)})}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:w,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?this:function(e){return 0===e.length?P:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=D(e))(function(e,i){var n;t.subscribe(function(e){return n=e},function(e){return i(e)},function(){return e(n)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function D(e){if(e||(e=E.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var L=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),x=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this)).subject=e,r.subscriber=n,r.closed=!1,r}return S(i,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}}}]),i}(C),F=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this,e)).destination=e,n}return i}(N),U=function(){var e=function(e){c(i,e);var t=h(i);function i(){var e;return p(this,i),(e=t.call(this)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return S(i,[{key:k,value:function(){return new F(this)}},{key:"lift",value:function(e){var t=new H(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new L;if(!this.isStopped)for(var t=this.observers,i=t.length,n=t.slice(),r=0;r<i;r++)n[r].next(e)}},{key:"error",value:function(e){if(this.closed)throw new L;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,i=t.length,n=t.slice(),r=0;r<i;r++)n[r].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new L;this.isStopped=!0;for(var e=this.observers,t=e.length,i=e.slice(),n=0;n<t;n++)i[n].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new L;return u(v(i.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new L;return this.hasError?(e.error(this.thrownError),C.EMPTY):this.isStopped?(e.complete(),C.EMPTY):(this.observers.push(e),new x(this,e))}},{key:"asObservable",value:function(){var e=new M;return e.source=this,e}}]),i}(M);return e.create=function(e,t){return new H(e,t)},e}(),H=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this)).destination=e,r.source=n,r}return S(i,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):C.EMPTY}}]),i}(U);function G(e){return e&&"function"==typeof e.schedule}function B(e,t){return function(i){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new W(e,t))}}var W=function(){function e(t,i){p(this,e),this.project=t,this.thisArg=i}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new V(e,this.project,this.thisArg))}}]),e}(),V=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,e)).project=n,o.count=0,o.thisArg=r||g(o),o}return S(i,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}]),i}(N),z=function(e){return function(t){for(var i=0,n=e.length;i<n&&!t.closed;i++)t.next(e[i]);t.complete()}},Y="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",j=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function K(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var Q=function(e){if(e&&"function"==typeof e[w])return function(e){return function(t){var i=e[w]();if("function"!=typeof i.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return i.subscribe(t)}}(e);if(j(e))return z(e);if(K(e))return function(e){return function(t){return e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,y),t}}(e);if(e&&"function"==typeof e[Y])return function(e){return function(t){for(var i=e[Y]();;){var n=void 0;try{n=i.next()}catch(r){return t.error(r),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof i.return&&t.add(function(){i.return&&i.return()}),t}}(e);var t="You provided ".concat(T(e)?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.");throw new TypeError(t)};function q(e,t){return new M(function(i){var n=new C,r=0;return n.add(t.schedule(function(){r!==e.length?(i.next(e[r++]),i.closed||n.add(this.schedule())):i.complete()})),n})}function X(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[w]}(e))return function(e,t){return new M(function(i){var n=new C;return n.add(t.schedule(function(){var r=e[w]();n.add(r.subscribe({next:function(e){n.add(t.schedule(function(){return i.next(e)}))},error:function(e){n.add(t.schedule(function(){return i.error(e)}))},complete:function(){n.add(t.schedule(function(){return i.complete()}))}}))})),n})}(e,t);if(K(e))return function(e,t){return new M(function(i){var n=new C;return n.add(t.schedule(function(){return e.then(function(e){n.add(t.schedule(function(){i.next(e),n.add(t.schedule(function(){return i.complete()}))}))},function(e){n.add(t.schedule(function(){return i.error(e)}))})})),n})}(e,t);if(j(e))return q(e,t);if(function(e){return e&&"function"==typeof e[Y]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new M(function(i){var n,r=new C;return r.add(function(){n&&"function"==typeof n.return&&n.return()}),r.add(t.schedule(function(){n=e[Y](),r.add(t.schedule(function(){if(!i.closed){var e,t;try{var r=n.next();e=r.value,t=r.done}catch(r){return void i.error(r)}t?i.complete():(i.next(e),this.schedule())}}))})),r})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof M?e:new M(Q(e))}var Z=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this)).parent=e,n}return S(i,[{key:"_next",value:function(e){this.parent.notifyNext(e)}},{key:"_error",value:function(e){this.parent.notifyError(e),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(),this.unsubscribe()}}]),i}(N),$=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"notifyNext",value:function(e){this.destination.next(e)}},{key:"notifyError",value:function(e){this.destination.error(e)}},{key:"notifyComplete",value:function(){this.destination.complete()}}]),i}(N);function J(e,t){if(!t.closed)return e instanceof M?e.subscribe(t):Q(e)(t)}function ee(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(n){return n.pipe(ee(function(i,n){return X(e(i,n)).pipe(B(function(e,r){return t(i,e,n,r)}))},i))}:("number"==typeof t&&(i=t),function(t){return t.lift(new te(e,i))})}var te=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;p(this,e),this.project=t,this.concurrent=i}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new ie(e,this.project,this.concurrent))}}]),e}(),ie=function(e){c(i,e);var t=h(i);function i(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return p(this,i),(r=t.call(this,e)).project=n,r.concurrent=o,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return S(i,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(t)}},{key:"_innerSub",value:function(e){var t=new Z(this),i=this.destination;i.add(t);var n=J(e,t);n!==t&&i.add(n)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e){this.destination.next(e)}},{key:"notifyComplete",value:function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),i}($);function ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return ee(P,e)}function re(e,t){return t?q(e,t):new M(z(e))}function oe(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Number.POSITIVE_INFINITY,r=null,o=t[t.length-1];return G(o)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof o&&(n=t.pop()),null===r&&1===t.length&&t[0]instanceof M?t[0]:ne(n)(re(t,r))}function se(){return function(e){return e.lift(new ae(e))}}var ae=function(){function e(t){p(this,e),this.connectable=t}return S(e,[{key:"call",value:function(e,t){var i=this.connectable;i._refCount++;var n=new ue(e,i),r=t.subscribe(n);return n.closed||(n.connection=i.connect()),r}}]),e}(),ue=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).connectable=n,r}return S(i,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var i=this.connection,n=e._connection;this.connection=null,n&&(!i||n===i)&&n.unsubscribe()}}else this.connection=null}}]),i}(N),ce=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this)).source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return S(i,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new C).add(this.source.subscribe(new he(this.getSubject(),this))),e.closed&&(this._connection=null,e=C.EMPTY)),e}},{key:"refCount",value:function(){return se()(this)}}]),i}(M),le=function(){var e=ce.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),he=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).connectable=n,r}return S(i,[{key:"_error",value:function(e){this._unsubscribe(),u(v(i.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),u(v(i.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),i}(F);function de(){return new U}function ge(e){for(var t in e)if(e[t]===ge)return t;throw Error("Could not find renamed property on target object.")}function fe(e,t){for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}function ve(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(ve).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var i=t.indexOf("\n");return-1===i?t:t.substring(0,i)}function pe(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var me=ge({__forward_ref__:ge});function Se(e){return e.__forward_ref__=Se,e.toString=function(){return ve(this())},e}function Ee(e){return ye(e)?e():e}function ye(e){return"function"==typeof e&&e.hasOwnProperty(me)&&e.__forward_ref__===Se}var Re=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,n))).code=e,r}return i}(s(Error));function Oe(e){return"string"==typeof e?e:null==e?"":String(e)}function Te(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Oe(e)}function Ie(e,t){var i=t?" in ".concat(t):"";throw new Re("201","No provider for ".concat(Te(e)," found").concat(i))}function be(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Ce(e){return{providers:e.providers||[],imports:e.imports||[]}}function Ae(e){return ke(e,we)||ke(e,Me)}function ke(e,t){return e.hasOwnProperty(t)?e[t]:null}function Ne(e){return e&&(e.hasOwnProperty(Pe)||e.hasOwnProperty(De))?e[Pe]:null}var _e,we=ge({"\u0275prov":ge}),Pe=ge({"\u0275inj":ge}),Me=ge({ngInjectableDef:ge}),De=ge({ngInjectorDef:ge}),Le=((Le=Le||{})[Le.Default=0]="Default",Le[Le.Host=1]="Host",Le[Le.Self=2]="Self",Le[Le.SkipSelf=4]="SkipSelf",Le[Le.Optional=8]="Optional",Le);function xe(e){var t=_e;return _e=e,t}function Fe(e,t,i){var n=Ae(e);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:i&Le.Optional?null:void 0!==t?t:void Ie(ve(e),"Injector")}function Ue(e){return{toString:e}.toString()}var He=((He=He||{})[He.OnPush=0]="OnPush",He[He.Default=1]="Default",He),Ge=((Ge=Ge||{})[Ge.Emulated=0]="Emulated",Ge[Ge.None=2]="None",Ge[Ge.ShadowDom=3]="ShadowDom",Ge),Be="undefined"!=typeof globalThis&&globalThis,We="undefined"!=typeof window&&window,Ve="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ze="undefined"!=typeof global&&global,Ye=Be||ze||We||Ve,je={},Ke=[],Qe=ge({"\u0275cmp":ge}),qe=ge({"\u0275dir":ge}),Xe=ge({"\u0275pipe":ge}),Ze=ge({"\u0275mod":ge}),$e=ge({"\u0275loc":ge}),Je=ge({"\u0275fac":ge}),et=ge({__NG_ELEMENT_ID__:ge}),tt=0;function it(e){return Ue(function(){var t={},i={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===He.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Ke,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ge.Emulated,id:"c",styles:e.styles||Ke,_:null,setInput:null,schemas:e.schemas||null,tView:null},n=e.directives,r=e.features,o=e.pipes;return i.id+=tt++,i.inputs=at(e.inputs,t),i.outputs=at(e.outputs),r&&r.forEach(function(e){return e(i)}),i.directiveDefs=n?function(){return("function"==typeof n?n():n).map(nt)}:null,i.pipeDefs=o?function(){return("function"==typeof o?o():o).map(rt)}:null,i})}function nt(e){return lt(e)||function(e){return e[qe]||null}(e)}function rt(e){return function(e){return e[Xe]||null}(e)}var ot={};function st(e){return Ue(function(){var t={type:e.type,bootstrap:e.bootstrap||Ke,declarations:e.declarations||Ke,imports:e.imports||Ke,exports:e.exports||Ke,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(ot[e.id]=e.type),t})}function at(e,t){if(null==e)return je;var i={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),i[r]=n,t&&(t[r]=o)}return i}var ut=it;function ct(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function lt(e){return e[Qe]||null}function ht(e,t){var i=e[Ze]||null;if(!i&&!0===t)throw new Error("Type ".concat(ve(e)," does not have '\u0275mod' property."));return i}function dt(e){return Array.isArray(e)&&"object"==typeof e[1]}function gt(e){return Array.isArray(e)&&!0===e[1]}function ft(e){return 0!=(8&e.flags)}function vt(e){return 2==(2&e.flags)}function pt(e){return 1==(1&e.flags)}function mt(e){return null!==e.template}function St(e){return 0!=(512&e[2])}function Et(e,t){return e.hasOwnProperty(Je)?e[Je]:null}var yt=function(){function e(t,i,n){p(this,e),this.previousValue=t,this.currentValue=i,this.firstChange=n}return S(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Rt(){return Ot}function Ot(e){return e.type.prototype.ngOnChanges&&(e.setInput=It),Tt}function Tt(){var e=Ct(this),t=null==e?void 0:e.current;if(t){var i=e.previous;if(i===je)e.previous=t;else for(var n in t)i[n]=t[n];e.current=null,this.ngOnChanges(t)}}function It(e,t,i,n){var r=Ct(e)||function(e,t){return e[bt]=t}(e,{previous:je,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[i],u=s[a];o[a]=new yt(u&&u.currentValue,t,s===je),e[n]=t}Rt.ngInherit=!0;var bt="__ngSimpleChanges__";function Ct(e){return e[bt]||null}var At,kt="http://www.w3.org/2000/svg";function Nt(){return void 0!==At?At:"undefined"!=typeof document?document:void 0}function _t(e){return!!e.listen}var wt={createRenderer:function(e,t){return Nt()}};function Pt(e){for(;Array.isArray(e);)e=e[0];return e}function Mt(e,t){return Pt(t[e])}function Dt(e,t){return Pt(t[e.index])}function Lt(e,t){return e.data[t]}function xt(e,t){return e[t]}function Ft(e,t){var i=t[e];return dt(i)?i:i[0]}function Ut(e){return 4==(4&e[2])}function Ht(e){return 128==(128&e[2])}function Gt(e,t){return null==t?null:e[t]}function Bt(e){e[18]=0}function Wt(e,t){e[5]+=t;for(var i=e,n=e[3];null!==n&&(1===t&&1===i[5]||-1===t&&0===i[5]);)n[5]+=t,i=n,n=n[3]}var Vt={lFrame:gi(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function zt(){return Vt.bindingsEnabled}function Yt(){return Vt.lFrame.lView}function jt(){return Vt.lFrame.tView}function Kt(e){return Vt.lFrame.contextLView=e,e[8]}function Qt(){for(var e=qt();null!==e&&64===e.type;)e=e.parent;return e}function qt(){return Vt.lFrame.currentTNode}function Xt(e,t){var i=Vt.lFrame;i.currentTNode=e,i.isParent=t}function Zt(){return Vt.lFrame.isParent}function $t(){Vt.lFrame.isParent=!1}function Jt(){return Vt.isInCheckNoChangesMode}function ei(e){Vt.isInCheckNoChangesMode=e}function ti(){var e=Vt.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function ii(){return Vt.lFrame.bindingIndex}function ni(){return Vt.lFrame.bindingIndex++}function ri(e){var t=Vt.lFrame,i=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,i}function oi(e,t){var i=Vt.lFrame;i.bindingIndex=i.bindingRootIndex=e,si(t)}function si(e){Vt.lFrame.currentDirectiveIndex=e}function ai(){return Vt.lFrame.currentQueryIndex}function ui(e){Vt.lFrame.currentQueryIndex=e}function ci(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function li(e,t,i){if(i&Le.SkipSelf){for(var n=t,r=e;!(null!==(n=n.parent)||i&Le.Host||(n=ci(r),null===n||(r=r[15],10&n.type))););if(null===n)return!1;t=n,e=r}var o=Vt.lFrame=di();return o.currentTNode=t,o.lView=e,!0}function hi(e){var t=di(),i=e[1];Vt.lFrame=t,t.currentTNode=i.firstChild,t.lView=e,t.tView=i,t.contextLView=e,t.bindingIndex=i.bindingStartIndex,t.inI18n=!1}function di(){var e=Vt.lFrame,t=null===e?null:e.child;return null===t?gi(e):t}function gi(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function fi(){var e=Vt.lFrame;return Vt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var vi=fi;function pi(){var e=fi();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function mi(){return Vt.lFrame.selectedIndex}function Si(e){Vt.lFrame.selectedIndex=e}function Ei(){var e=Vt.lFrame;return Lt(e.tView,e.selectedIndex)}function yi(){Vt.lFrame.currentNamespace=kt}function Ri(e,t){for(var i=t.directiveStart,n=t.directiveEnd;i<n;i++){var r=e.data[i].type.prototype,o=r.ngAfterContentInit,s=r.ngAfterContentChecked,a=r.ngAfterViewInit,u=r.ngAfterViewChecked,c=r.ngOnDestroy;o&&(e.contentHooks||(e.contentHooks=[])).push(-i,o),s&&((e.contentHooks||(e.contentHooks=[])).push(i,s),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(i,s)),a&&(e.viewHooks||(e.viewHooks=[])).push(-i,a),u&&((e.viewHooks||(e.viewHooks=[])).push(i,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(i,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(i,c)}}function Oi(e,t,i){bi(e,t,3,i)}function Ti(e,t,i,n){(3&e[2])===i&&bi(e,t,i,n)}function Ii(e,t){var i=e[2];(3&i)===t&&(i&=2047,i+=1,e[2]=i)}function bi(e,t,i,n){for(var r=null!=n?n:-1,o=t.length-1,s=0,a=void 0!==n?65535&e[18]:0;a<o;a++)if("number"==typeof t[a+1]){if(s=t[a],null!=n&&s>=n)break}else t[a]<0&&(e[18]+=65536),(s<r||-1==r)&&(Ci(e,i,t,a),e[18]=(4294901760&e[18])+a+2),a++}function Ci(e,t,i,n){var r=i[n]<0,o=i[n+1],s=e[r?-i[n]:i[n]];if(r){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{o.call(s)}finally{}}}else try{o.call(s)}finally{}}var Ai=function e(t,i,n){p(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=i,this.injectImpl=n};function ki(e,t,i){for(var n=_t(e),r=0;r<i.length;){var o=i[r];if("number"==typeof o){if(0!==o)break;r++;var s=i[r++],a=i[r++],u=i[r++];n?e.setAttribute(t,a,u,s):t.setAttributeNS(s,a,u)}else{var c=o,l=i[++r];_i(c)?n&&e.setProperty(t,c,l):n?e.setAttribute(t,c,l):t.setAttribute(c,l),r++}}return r}function Ni(e){return 3===e||4===e||6===e}function _i(e){return 64===e.charCodeAt(0)}function wi(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var i=-1,n=0;n<t.length;n++){var r=t[n];"number"==typeof r?i=r:0===i||Pi(e,i,r,null,-1===i||2===i?t[++n]:null)}return e}function Pi(e,t,i,n,r){var o=0,s=e.length;if(-1===t)s=-1;else for(;o<e.length;){var a=e[o++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=o-1;break}}}for(;o<e.length;){var u=e[o];if("number"==typeof u)break;if(u===i){if(null===n)return void(null!==r&&(e[o+1]=r));if(n===e[o+1])return void(e[o+2]=r)}o++,null!==n&&o++,null!==r&&o++}-1!==s&&(e.splice(s,0,t),o=s+1),e.splice(o++,0,i),null!==n&&e.splice(o++,0,n),null!==r&&e.splice(o++,0,r)}function Mi(e){return-1!==e}function Di(e){return 32767&e}function Li(e,t){for(var i=function(e){return e>>16}(e),n=t;i>0;)n=n[15],i--;return n}var xi=!0;function Fi(e){var t=xi;return xi=e,t}var Ui=0;function Hi(e,t){var i=Bi(e,t);if(-1!==i)return i;var n=t[1];n.firstCreatePass&&(e.injectorIndex=t.length,Gi(n.data,e),Gi(t,null),Gi(n.blueprint,null));var r=Wi(e,t),o=e.injectorIndex;if(Mi(r))for(var s=Di(r),a=Li(r,t),u=a[1].data,c=0;c<8;c++)t[o+c]=a[s+c]|u[s+c];return t[o+8]=r,o}function Gi(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Bi(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Wi(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var i=0,n=null,r=t;null!==r;){var o=r[1],s=o.type;if(null===(n=2===s?o.declTNode:1===s?r[6]:null))return-1;if(i++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|i<<16}return-1}function Vi(e,t,i){!function(e,t,i){var n;"string"==typeof i?n=i.charCodeAt(0)||0:i.hasOwnProperty(et)&&(n=i[et]),null==n&&(n=i[et]=Ui++);var r=255&n;t.data[e+(r>>5)]|=1<<r}(e,t,i)}function zi(e,t,i){if(i&Le.Optional)return e;Ie(t,"NodeInjector")}function Yi(e,t,i,n){if(i&Le.Optional&&void 0===n&&(n=null),0==(i&(Le.Self|Le.Host))){var r=e[9],o=xe(void 0);try{return r?r.get(t,n,i&Le.Optional):Fe(t,n,i&Le.Optional)}finally{xe(o)}}return zi(n,t,i)}function ji(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Le.Default,r=arguments.length>4?arguments[4]:void 0;if(null!==e){var o=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(et)?e[et]:void 0;return"number"==typeof t?t>=0?255&t:Qi:t}(i);if("function"==typeof o){if(!li(t,e,n))return n&Le.Host?zi(r,i,n):Yi(t,i,n,r);try{var s=o(n);if(null!=s||n&Le.Optional)return s;Ie(i)}finally{vi()}}else if("number"==typeof o){var a=null,u=Bi(e,t),c=-1,l=n&Le.Host?t[16][6]:null;for((-1===u||n&Le.SkipSelf)&&(-1!==(c=-1===u?Wi(e,t):t[u+8])&&Ji(n,!1)?(a=t[1],u=Di(c),t=Li(c,t)):u=-1);-1!==u;){var h=t[1];if($i(o,u,h.data)){var d=qi(u,t,i,a,n,l);if(d!==Ki)return d}-1!==(c=t[u+8])&&Ji(n,t[1].data[u+8]===l)&&$i(o,u,t)?(a=h,u=Di(c),t=Li(c,t)):u=-1}}}return Yi(t,i,n,r)}var Ki={};function Qi(){return new en(Qt(),Yt())}function qi(e,t,i,n,r,o){var s=t[1],a=s.data[e+8],u=Xi(a,s,i,null==n?vt(a)&&xi:n!=s&&0!=(3&a.type),r&Le.Host&&o===a);return null!==u?Zi(t,s,u,a):Ki}function Xi(e,t,i,n,r){for(var o=e.providerIndexes,s=t.data,a=1048575&o,u=e.directiveStart,c=o>>20,l=r?a+c:e.directiveEnd,h=n?a:a+c;h<l;h++){var d=s[h];if(h<u&&i===d||h>=u&&d.type===i)return h}if(r){var g=s[u];if(g&&mt(g)&&g.type===i)return u}return null}function Zi(e,t,i,n){var r=e[i],o=t.data;if(function(e){return e instanceof Ai}(r)){var s=r;s.resolving&&function(e,t){throw new Re("200","Circular dependency in DI detected for ".concat(e))}(Te(o[i]));var a=Fi(s.canSeeViewProviders);s.resolving=!0;var u=s.injectImpl?xe(s.injectImpl):null;li(e,n,Le.Default);try{r=e[i]=s.factory(void 0,o,e,n),t.firstCreatePass&&i>=n.directiveStart&&function(e,t,i){var n=t.type.prototype,r=n.ngOnChanges,o=n.ngOnInit,s=n.ngDoCheck;if(r){var a=Ot(t);(i.preOrderHooks||(i.preOrderHooks=[])).push(e,a),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,a)}o&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-e,o),s&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e,s),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,s))}(i,o[i],t)}finally{null!==u&&xe(u),Fi(a),s.resolving=!1,vi()}}return r}function $i(e,t,i){return!!(i[t+(e>>5)]&1<<e)}function Ji(e,t){return!(e&Le.Self||e&Le.Host&&t)}var en=function(){function e(t,i){p(this,e),this._tNode=t,this._lView=i}return S(e,[{key:"get",value:function(e,t){return ji(this._tNode,this._lView,e,void 0,t)}}]),e}();function tn(e){return Ue(function(){for(var t=e.prototype.constructor,i=t[Je]||nn(t),n=Object.prototype,r=Object.getPrototypeOf(e.prototype).constructor;r&&r!==n;){var o=r[Je]||nn(r);if(o&&o!==i)return o;r=Object.getPrototypeOf(r)}return function(e){return new e}})}function nn(e){return ye(e)?function(){var t=nn(Ee(e));return t&&t()}:Et(e)}function rn(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var i=e.attrs;if(i)for(var n=i.length,r=0;r<n;){var o=i[r];if(Ni(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<n&&"string"==typeof i[r];)r++;else{if(o===t)return i[r+1];r+=2}}return null}(Qt(),e)}var on="__parameters__";function sn(e,t,i){return Ue(function(){var n=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var i in t)this[i]=t[i]}}}(t);function r(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(this instanceof r)return n.apply(this,t),this;var o=a(r,t);return s.annotation=o,s;function s(e,t,i){for(var n=e.hasOwnProperty(on)?e[on]:Object.defineProperty(e,on,{value:[]})[on];n.length<=i;)n.push(null);return(n[i]=n[i]||[]).push(o),e}}return i&&(r.prototype=Object.create(i.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}var an=function(){function e(t,i){p(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof i?this.__NG_ELEMENT_ID__=i:void 0!==i&&(this.\u0275prov=be({token:this,providedIn:i.providedIn||"root",factory:i.factory}))}return S(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),un=new an("AnalyzeForEntryComponents"),cn=Function;function ln(e,t){void 0===t&&(t=e);for(var i=0;i<e.length;i++){var n=e[i];Array.isArray(n)?(t===e&&(t=e.slice(0,i)),ln(n,t)):t!==e&&t.push(n)}return t}function hn(e,t){e.forEach(function(e){return Array.isArray(e)?hn(e,t):t(e)})}function dn(e,t,i){t>=e.length?e.push(i):e.splice(t,0,i)}function gn(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function fn(e,t){for(var i=[],n=0;n<e;n++)i.push(t);return i}function vn(e,t,i){var n=mn(e,t);return n>=0?e[1|n]=i:function(e,t,i,n){var r=e.length;if(r==t)e.push(i,n);else if(1===r)e.push(n,e[0]),e[0]=i;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=i,e[t+1]=n}}(e,n=~n,t,i),n}function pn(e,t){var i=mn(e,t);if(i>=0)return e[1|i]}function mn(e,t){return function(e,t,i){for(var n=0,r=e.length>>1;r!==n;){var o=n+(r-n>>1),s=e[o<<1];if(t===s)return o<<1;s>t?r=o:n=o+1}return~(r<<1)}(e,t)}var Sn,En={},yn="__NG_DI_FLAG__",Rn="ngTempTokenPath",On=/\n/gm,Tn="__source",In=ge({provide:String,useValue:ge});function bn(e){var t=Sn;return Sn=e,t}function Cn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Le.Default;if(void 0===Sn)throw new Error("inject() must be called from an injection context");return null===Sn?Fe(e,void 0,t):Sn.get(e,t&Le.Optional?null:void 0,t)}function An(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Le.Default;return(_e||Cn)(Ee(e),t)}var kn=An;function Nn(e){for(var t=[],i=0;i<e.length;i++){var n=Ee(e[i]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");for(var r=void 0,o=Le.Default,s=0;s<n.length;s++){var a=n[s],u=wn(a);"number"==typeof u?-1===u?r=a.token:o|=u:r=a}t.push(An(r,o))}else t.push(An(n))}return t}function _n(e,t){return e[yn]=t,e.prototype[yn]=t,e}function wn(e){return e[yn]}function Pn(e,t,i,n){var r=e[Rn];throw t[Tn]&&r.unshift(t[Tn]),e.message=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var r=ve(t);if(Array.isArray(t))r=t.map(ve).join(" -> ");else if("object"==typeof t){var o=[];for(var s in t)if(t.hasOwnProperty(s)){var a=t[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):ve(a)))}r="{".concat(o.join(", "),"}")}return"".concat(i).concat(n?"("+n+")":"","[").concat(r,"]: ").concat(e.replace(On,"\n  "))}("\n"+e.message,r,i,n),e.ngTokenPath=r,e[Rn]=null,e}var Mn,Dn,Ln=_n(sn("Inject",function(e){return{token:e}}),-1),xn=_n(sn("Optional"),8),Fn=_n(sn("SkipSelf"),4);function Un(e){var t;return(null===(t=function(){if(void 0===Mn&&(Mn=null,Ye.trustedTypes))try{Mn=Ye.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Mn}())||void 0===t?void 0:t.createHTML(e))||e}function Hn(e){var t;return(null===(t=function(){if(void 0===Dn&&(Dn=null,Ye.trustedTypes))try{Dn=Ye.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Dn}())||void 0===t?void 0:t.createHTML(e))||e}var Gn=function(){function e(t){p(this,e),this.changingThisBreaksApplicationSecurity=t}return S(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}();function Bn(e){return e instanceof Gn?e.changingThisBreaksApplicationSecurity:e}function Wn(e,t){var i=function(e){return e instanceof Gn&&e.getTypeName()||null}(e);if(null!=i&&i!==t){if("ResourceURL"===i&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(i," (see https://g.co/ng/security#xss)"))}return i===t}var Vn=function(){function e(t){p(this,e),this.inertDocumentHelper=t}return S(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Un(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}]),e}(),zn=function(){function e(t){if(p(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var i=this.inertDocument.createElement("html");this.inertDocument.appendChild(i);var n=this.inertDocument.createElement("body");i.appendChild(n)}}return S(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Un(e),t;var i=this.inertDocument.createElement("body");return i.innerHTML=Un(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,i=t.length-1;0<i;i--){var n=t.item(i).name;("xmlns:ns1"===n||0===n.indexOf("ns1:"))&&e.removeAttribute(n)}for(var r=e.firstChild;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}]),e}(),Yn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,jn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Kn(e){return(e=String(e)).match(Yn)||e.match(jn)?e:"unsafe:"+e}function Qn(e){return(e=String(e)).split(",").map(function(e){return Kn(e.trim())}).join(", ")}function qn(e){var t,i={},r=n(e.split(","));try{for(r.s();!(t=r.n()).done;){i[t.value]=!0}}catch(o){r.e(o)}finally{r.f()}return i}function Xn(){for(var e={},t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];for(var r=0,o=i;r<o.length;r++){var s=o[r];for(var a in s)s.hasOwnProperty(a)&&(e[a]=!0)}return e}var Zn,$n=qn("area,br,col,hr,img,wbr"),Jn=qn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),er=qn("rp,rt"),tr=Xn($n,Xn(Jn,qn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Xn(er,qn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Xn(er,Jn)),ir=qn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),nr=qn("srcset"),rr=Xn(ir,nr,qn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),qn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),or=qn("script,style,template"),sr=function(){function e(){p(this,e),this.sanitizedSomething=!1,this.buf=[]}return S(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,i=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var n=this.checkClobberedElement(t,t.nextSibling);if(n){t=n;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!tr.hasOwnProperty(t))return this.sanitizedSomething=!0,!or.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var i=e.attributes,n=0;n<i.length;n++){var r=i.item(n),o=r.name,s=o.toLowerCase();if(rr.hasOwnProperty(s)){var a=r.value;ir[s]&&(a=Kn(a)),nr[s]&&(a=Qn(a)),this.buf.push(" ",o,'="',cr(a),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();tr.hasOwnProperty(t)&&!$n.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(cr(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),ar=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ur=/([^\#-~ |!])/g;function cr(e){return e.replace(/&/g,"&amp;").replace(ar,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(ur,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function lr(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var hr=((hr=hr||{})[hr.NONE=0]="NONE",hr[hr.HTML=1]="HTML",hr[hr.STYLE=2]="STYLE",hr[hr.SCRIPT=3]="SCRIPT",hr[hr.URL=4]="URL",hr[hr.RESOURCE_URL=5]="RESOURCE_URL",hr);function dr(e){var t=fr();return t?Hn(t.sanitize(hr.HTML,e)||""):Wn(e,"HTML")?Hn(Bn(e)):function(e,t){var i=null;try{Zn=Zn||function(e){var t=new zn(e);return function(){try{return!!(new window.DOMParser).parseFromString(Un(""),"text/html")}catch(e){return!1}}()?new Vn(t):t}(e);var n=t?String(t):"";i=Zn.getInertBodyElement(n);var r=5,o=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=o,o=i.innerHTML,i=Zn.getInertBodyElement(n)}while(n!==o);return Un((new sr).sanitizeChildren(lr(i)||i))}finally{if(i)for(var s=lr(i)||i;s.firstChild;)s.removeChild(s.firstChild)}}(Nt(),Oe(e))}function gr(e){var t=fr();return t?t.sanitize(hr.URL,e)||"":Wn(e,"URL")?Bn(e):Kn(Oe(e))}function fr(){var e=Yt();return e&&e[12]}var vr="__ngContext__";function pr(e,t){e[vr]=t}function mr(e){var t=function(e){return e[vr]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Sr(e){return e.ngOriginalError}function Er(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];e.error.apply(e,i)}var yr=function(){function e(){p(this,e),this._console=console}return S(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),i=this._findContext(e),n=function(e){return e&&e.ngErrorLogger||Er}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t),i&&n(this._console,"ERROR CONTEXT",i)}},{key:"_findContext",value:function(e){return e?function(e){return e.ngDebugContext}(e)||this._findContext(Sr(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&Sr(e);t&&Sr(t);)t=Sr(t);return t||null}}]),e}(),Rr=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ye);function Or(e){return e.ownerDocument.defaultView}function Tr(e){return e.ownerDocument}function Ir(e){return e instanceof Function?e():e}var br=((br=br||{})[br.Important=1]="Important",br[br.DashCase=2]="DashCase",br);function Cr(e,t){return(void 0)(e,t)}function Ar(e){var t=e[3];return gt(t)?t[3]:t}function kr(e){return _r(e[13])}function Nr(e){return _r(e[4])}function _r(e){for(;null!==e&&!gt(e);)e=e[4];return e}function wr(e,t,i,n,r){if(null!=n){var o,s=!1;gt(n)?o=n:dt(n)&&(s=!0,n=n[0]);var a=Pt(n);0===e&&null!==i?null==r?Hr(t,i,a):Ur(t,i,a,r||null,!0):1===e&&null!==i?Ur(t,i,a,r||null,!0):2===e?function(e,t,i){var n=Br(e,t);n&&function(e,t,i,n){_t(e)?e.removeChild(t,i,n):t.removeChild(i)}(e,n,t,i)}(t,a,s):3===e&&t.destroyNode(a),null!=o&&function(e,t,i,n,r){var o=i[7];o!==Pt(i)&&wr(t,e,n,o,r);for(var s=10;s<i.length;s++){var a=i[s];qr(a[1],a,e,t,n,o)}}(t,e,o,i,r)}}function Pr(e,t,i){return _t(e)?e.createElement(t,i):null===i?e.createElement(t):e.createElementNS(i,t)}function Mr(e,t){var i=e[9],n=i.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,Wt(r,-1)),i.splice(n,1)}function Dr(e,t){if(!(e.length<=10)){var i=10+t,n=e[i];if(n){var r=n[17];null!==r&&r!==e&&Mr(r,n),t>0&&(e[i-1][4]=n[4]);var o=gn(e,10+t);!function(e,t){qr(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(n[1],n);var s=o[19];null!==s&&s.detachView(o[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}}function Lr(e,t){if(!(256&t[2])){var i=t[11];_t(i)&&i.destroyNode&&qr(e,t,i,3,null,null),function(e){var t=e[13];if(!t)return xr(e[1],e);for(;t;){var i=null;if(dt(t))i=t[13];else{var n=t[10];n&&(i=n)}if(!i){for(;t&&!t[4]&&t!==e;)dt(t)&&xr(t[1],t),t=t[3];null===t&&(t=e),dt(t)&&xr(t[1],t),i=t&&t[4]}t=i}}(t)}}function xr(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var i;if(null!=e&&null!=(i=e.destroyHooks))for(var n=0;n<i.length;n+=2){var r=t[i[n]];if(!(r instanceof Ai)){var o=i[n+1];if(Array.isArray(o))for(var s=0;s<o.length;s+=2){var a=r[o[s]],u=o[s+1];try{u.call(a)}finally{}}else try{o.call(r)}finally{}}}}(e,t),function(e,t){var i=e.cleanup,n=t[7],r=-1;if(null!==i)for(var o=0;o<i.length-1;o+=2)if("string"==typeof i[o]){var s=i[o+1],a="function"==typeof s?s(t):Pt(t[s]),u=n[r=i[o+2]],c=i[o+3];"boolean"==typeof c?a.removeEventListener(i[o],u,c):c>=0?n[r=c]():n[r=-c].unsubscribe(),o+=2}else{var l=n[r=i[o+1]];i[o].call(l)}if(null!==n){for(var h=r+1;h<n.length;h++)n[h]();t[7]=null}}(e,t),1===t[1].type&&_t(t[11])&&t[11].destroy();var i=t[17];if(null!==i&&gt(t[3])){i!==t[3]&&Mr(i,t);var n=t[19];null!==n&&n.detachView(e)}}}function Fr(e,t,i){return function(e,t,i){for(var n=t;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return i[0];if(2&n.flags){var r=e.data[n.directiveStart].encapsulation;if(r===Ge.None||r===Ge.Emulated)return null}return Dt(n,i)}(e,t.parent,i)}function Ur(e,t,i,n,r){_t(e)?e.insertBefore(t,i,n,r):t.insertBefore(i,n,r)}function Hr(e,t,i){_t(e)?e.appendChild(t,i):t.appendChild(i)}function Gr(e,t,i,n,r){null!==n?Ur(e,t,i,n,r):Hr(e,t,i)}function Br(e,t){return _t(e)?e.parentNode(t):t.parentNode}function Wr(e,t,i){return Vr(e,t,i)}var Vr=function(e,t,i){return 40&e.type?Dt(e,i):null};function zr(e,t,i,n){var r=Fr(e,n,t),o=t[11],s=Wr(n.parent||t[6],n,t);if(null!=r)if(Array.isArray(i))for(var a=0;a<i.length;a++)Gr(o,r,i[a],s,!1);else Gr(o,r,i,s,!1)}function Yr(e,t){if(null!==t){var i=t.type;if(3&i)return Dt(t,e);if(4&i)return Kr(-1,e[t.index]);if(8&i){var n=t.child;if(null!==n)return Yr(e,n);var r=e[t.index];return gt(r)?Kr(-1,r):Pt(r)}if(32&i)return Cr(t,e)()||Pt(e[t.index]);var o=jr(e,t);return null!==o?Array.isArray(o)?o[0]:Yr(Ar(e[16]),o):Yr(e,t.next)}return null}function jr(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Kr(e,t){var i=10+e+1;if(i<t.length){var n=t[i],r=n[1].firstChild;if(null!==r)return Yr(n,r)}return t[7]}function Qr(e,t,i,n,r,o,s){for(;null!=i;){var a=n[i.index],u=i.type;if(s&&0===t&&(a&&pr(Pt(a),n),i.flags|=4),64!=(64&i.flags))if(8&u)Qr(e,t,i.child,n,r,o,!1),wr(t,e,r,a,o);else if(32&u){for(var c=Cr(i,n),l=void 0;l=c();)wr(t,e,r,l,o);wr(t,e,r,a,o)}else 16&u?Xr(e,t,n,i,r,o):wr(t,e,r,a,o);i=s?i.projectionNext:i.next}}function qr(e,t,i,n,r,o){Qr(i,n,e.firstChild,t,r,o,!1)}function Xr(e,t,i,n,r,o){var s=i[16],a=s[6].projection[n.projection];if(Array.isArray(a))for(var u=0;u<a.length;u++)wr(t,e,r,a[u],o);else Qr(e,t,a,s[3],r,o,!0)}function Zr(e,t,i){_t(e)?e.setAttribute(t,"style",i):t.style.cssText=i}function $r(e,t,i){_t(e)?""===i?e.removeAttribute(t,"class"):e.setAttribute(t,"class",i):t.className=i}function Jr(e,t,i){for(var n=e.length;;){var r=e.indexOf(t,i);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){var o=t.length;if(r+o===n||e.charCodeAt(r+o)<=32)return r}i=r+1}}var eo="ng-template";function to(e,t,i){for(var n=0;n<e.length;){var r=e[n++];if(i&&"class"===r){if(-1!==Jr((r=e[n]).toLowerCase(),t,0))return!0}else if(1===r){for(;n<e.length&&"string"==typeof(r=e[n++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function io(e){return 4===e.type&&e.value!==eo}function no(e,t,i){return t===(4!==e.type||i?e.value:eo)}function ro(e,t,i){for(var n=4,r=e.attrs||[],o=function(e){for(var t=0;t<e.length;t++)if(Ni(e[t]))return t;return e.length}(r),s=!1,a=0;a<t.length;a++){var u=t[a];if("number"!=typeof u){if(!s)if(4&n){if(n=2|1&n,""!==u&&!no(e,u,i)||""===u&&1===t.length){if(oo(n))return!1;s=!0}}else{var c=8&n?u:t[++a];if(8&n&&null!==e.attrs){if(!to(e.attrs,c,i)){if(oo(n))return!1;s=!0}continue}var l=so(8&n?"class":u,r,io(e),i);if(-1===l){if(oo(n))return!1;s=!0;continue}if(""!==c){var h;h=l>o?"":r[l+1].toLowerCase();var d=8&n?h:null;if(d&&-1!==Jr(d,c,0)||2&n&&c!==h){if(oo(n))return!1;s=!0}}}}else{if(!s&&!oo(n)&&!oo(u))return!1;if(s&&oo(u))continue;s=!1,n=u|1&n}}return oo(n)||s}function oo(e){return 0==(1&e)}function so(e,t,i,n){if(null===t)return-1;var r=0;if(n||!i){for(var o=!1;r<t.length;){var s=t[r];if(s===e)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){for(var a=t[++r];"string"==typeof a;)a=t[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function(e,t){var i=e.indexOf(4);if(i>-1)for(i++;i<e.length;){var n=e[i];if("number"==typeof n)return-1;if(n===t)return i;i++}return-1}(t,e)}function ao(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=0;n<t.length;n++)if(ro(e,t[n],i))return!0;return!1}function uo(e,t){return e?":not("+t.trim()+")":t}function co(e){for(var t=e[0],i=1,n=2,r="",o=!1;i<e.length;){var s=e[i];if("string"==typeof s)if(2&n){var a=e[++i];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+s:4&n&&(r+=" "+s);else""!==r&&!oo(s)&&(t+=uo(o,r),r=""),n=s,o=o||!oo(n);i++}return""!==r&&(t+=uo(o,r)),t}var lo={};function ho(e){go(jt(),Yt(),mi()+e,Jt())}function go(e,t,i,n){if(!n)if(3==(3&t[2])){var r=e.preOrderCheckHooks;null!==r&&Oi(t,r,i)}else{var o=e.preOrderHooks;null!==o&&Ti(t,o,0,i)}Si(i)}function fo(e,t){return e<<17|t<<2}function vo(e){return e>>17&32767}function po(e){return 2|e}function mo(e){return(131068&e)>>2}function So(e,t){return-131069&e|t<<2}function Eo(e){return 1|e}function yo(e,t){var i=e.contentQueries;if(null!==i)for(var n=0;n<i.length;n+=2){var r=i[n],o=i[n+1];if(-1!==o){var s=e.data[o];ui(r),s.contentQueries(2,t[o],o)}}}function Ro(e,t,i,n,r,o,s,a,u,c){var l=t.blueprint.slice();return l[0]=r,l[2]=140|n,Bt(l),l[3]=l[15]=e,l[8]=i,l[10]=s||e&&e[10],l[11]=a||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=o,l[16]=2==t.type?e[16]:l,l}function Oo(e,t,i,n,r){var o=e.data[t];if(null===o)o=function(e,t,i,n,r){var o=qt(),s=Zt(),a=e.data[t]=function(e,t,i,n,r,o){return{type:i,index:n,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,i,t,n,r);return null===e.firstChild&&(e.firstChild=a),null!==o&&(s?null==o.child&&null!==a.parent&&(o.child=a):null===o.next&&(o.next=a)),a}(e,t,i,n,r),Vt.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=i,o.value=n,o.attrs=r;var s=function(){var e=Vt.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return Xt(o,!0),o}function To(e,t,i,n){if(0===i)return-1;for(var r=t.length,o=0;o<i;o++)t.push(n),e.blueprint.push(n),e.data.push(null);return r}function Io(e,t,i){hi(t);try{var n=e.viewQuery;null!==n&&es(1,n,i);var r=e.template;null!==r&&Ao(e,t,r,1,i),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&yo(e,t),e.staticViewQueries&&es(2,e.viewQuery,i);var o=e.components;null!==o&&function(e,t){for(var i=0;i<t.length;i++)qo(e,t[i])}(t,o)}catch(n){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),n}finally{t[2]&=-5,pi()}}function bo(e,t,i,n){var r=t[2];if(256!=(256&r)){hi(t);var o=Jt();try{Bt(t),function(e){Vt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==i&&Ao(e,t,i,2,n);var s=3==(3&r);if(!o)if(s){var a=e.preOrderCheckHooks;null!==a&&Oi(t,a,null)}else{var u=e.preOrderHooks;null!==u&&Ti(t,u,0,null),Ii(t,0)}if(function(e){for(var t=kr(e);null!==t;t=Nr(t))if(t[2])for(var i=t[9],n=0;n<i.length;n++){var r=i[n],o=r[3];0==(1024&r[2])&&Wt(o,1),r[2]|=1024}}(t),function(e){for(var t=kr(e);null!==t;t=Nr(t))for(var i=10;i<t.length;i++){var n=t[i],r=n[1];Ht(n)&&bo(r,n,r.template,n[8])}}(t),null!==e.contentQueries&&yo(e,t),!o)if(s){var c=e.contentCheckHooks;null!==c&&Oi(t,c)}else{var l=e.contentHooks;null!==l&&Ti(t,l,1),Ii(t,1)}!function(e,t){var i=e.hostBindingOpCodes;if(null!==i)try{for(var n=0;n<i.length;n++){var r=i[n];if(r<0)Si(~r);else{var o=r,s=i[++n],a=i[++n];oi(s,o),a(2,t[o])}}}finally{Si(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var i=0;i<t.length;i++)Ko(e,t[i])}(t,h);var d=e.viewQuery;if(null!==d&&es(2,d,n),!o)if(s){var g=e.viewCheckHooks;null!==g&&Oi(t,g)}else{var f=e.viewHooks;null!==f&&Ti(t,f,2),Ii(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Wt(t[3],-1))}finally{pi()}}}function Co(e,t,i,n){var r=t[10],o=!Jt(),s=Ut(t);try{o&&!s&&r.begin&&r.begin(),s&&Io(e,t,n),bo(e,t,i,n)}finally{o&&!s&&r.end&&r.end()}}function Ao(e,t,i,n,r){var o=mi(),s=2&n;try{Si(-1),s&&t.length>20&&go(e,t,20,Jt()),i(n,r)}finally{Si(o)}}function ko(e,t,i){if(ft(t))for(var n=t.directiveEnd,r=t.directiveStart;r<n;r++){var o=e.data[r];o.contentQueries&&o.contentQueries(1,i[r],r)}}function No(e,t,i){!zt()||(function(e,t,i,n){var r=i.directiveStart,o=i.directiveEnd;e.firstCreatePass||Hi(i,t),pr(n,t);for(var s=i.initialInputs,a=r;a<o;a++){var u=e.data[a],c=mt(u);c&&Vo(t,i,u);var l=Zi(t,e,a,i);pr(l,t),null!==s&&zo(0,a-r,l,u,0,s),c&&(Ft(i.index,t)[8]=l)}}(e,t,i,Dt(i,t)),128==(128&i.flags)&&function(e,t,i){var n=i.directiveStart,r=i.directiveEnd,o=i.index,s=Vt.lFrame.currentDirectiveIndex;try{Si(o);for(var a=n;a<r;a++){var u=e.data[a],c=t[a];si(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&Uo(u,c)}}finally{Si(-1),si(s)}}(e,t,i))}function _o(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dt,n=t.localNames;if(null!==n)for(var r=t.index+1,o=0;o<n.length;o+=2){var s=n[o+1],a=-1===s?i(t,e):e[s];e[r++]=a}}function wo(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Po(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Po(e,t,i,n,r,o,s,a,u,c){var l=20+n,h=l+r,d=function(e,t){for(var i=[],n=0;n<t;n++)i.push(n<e?null:lo);return i}(l,h),g="function"==typeof c?c():c;return d[1]={type:e,blueprint:d,template:i,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:u,consts:g,incompleteFirstPass:!1}}function Mo(e,t,i,n){var r=is(t);null===i?r.push(n):(r.push(i),e.firstCreatePass&&ns(e).push(n,r.length-1))}function Do(e,t,i){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];(i=null===i?{}:i).hasOwnProperty(n)?i[n].push(t,r):i[n]=[t,r]}return i}function Lo(e,t,i,n,r,o,s,a){var u,c=Dt(t,i),l=t.inputs;!a&&null!=l&&(u=l[n])?(os(e,i,u,n,r),vt(t)&&function(e,t){var i=Ft(t,e);16&i[2]||(i[2]|=64)}(i,t.index)):3&t.type&&(n=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(n),r=null!=s?s(r,t.value||"",n):r,_t(o)?o.setProperty(c,n,r):_i(n)||(c.setProperty?c.setProperty(n,r):c[n]=r))}function xo(e,t,i,n){var r=!1;if(zt()){var o=function(e,t,i){var n=e.directiveRegistry,r=null;if(n)for(var o=0;o<n.length;o++){var s=n[o];ao(i,s.selectors,!1)&&(r||(r=[]),Vi(Hi(i,t),e,s.type),mt(s)?(Ho(e,i),r.unshift(s)):r.push(s))}return r}(e,t,i),s=null===n?null:{"":-1};if(null!==o){r=!0,Bo(i,e.data.length,o.length);for(var a=0;a<o.length;a++){var u=o[a];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,h=To(e,t,o.length,null),d=0;d<o.length;d++){var g=o[d];i.mergedAttrs=wi(i.mergedAttrs,g.hostAttrs),Wo(e,i,t,h,g),Go(h,g,s),null!==g.contentQueries&&(i.flags|=8),(null!==g.hostBindings||null!==g.hostAttrs||0!==g.hostVars)&&(i.flags|=128);var f=g.type.prototype;!c&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(i.index),c=!0),!l&&(f.ngOnChanges||f.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i.index),l=!0),h++}!function(e,t){for(var i=t.directiveEnd,n=e.data,r=t.attrs,o=[],s=null,a=null,u=t.directiveStart;u<i;u++){var c=n[u],l=c.inputs,h=null===r||io(t)?null:Yo(l,r);o.push(h),s=Do(l,u,s),a=Do(c.outputs,u,a)}null!==s&&(s.hasOwnProperty("class")&&(t.flags|=16),s.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=s,t.outputs=a}(e,i)}s&&function(e,t,i){if(t)for(var n=e.localNames=[],r=0;r<t.length;r+=2){var o=i[t[r+1]];if(null==o)throw new Re("301","Export of name '".concat(t[r+1],"' not found!"));n.push(t[r],o)}}(i,n,s)}return i.mergedAttrs=wi(i.mergedAttrs,i.attrs),r}function Fo(e,t,i,n,r,o){var s=o.hostBindings;if(s){var a=e.hostBindingOpCodes;null===a&&(a=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var i=e[--t];if("number"==typeof i&&i<0)return i}return 0})(a)!=u&&a.push(u),a.push(n,r,s)}}function Uo(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Ho(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Go(e,t,i){if(i){if(t.exportAs)for(var n=0;n<t.exportAs.length;n++)i[t.exportAs[n]]=e;mt(t)&&(i[""]=e)}}function Bo(e,t,i){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+i,e.providerIndexes=t}function Wo(e,t,i,n,r){e.data[n]=r;var o=r.factory||(r.factory=Et(r.type)),s=new Ai(o,mt(r),null);e.blueprint[n]=s,i[n]=s,Fo(e,t,0,n,To(e,i,r.hostVars,lo),r)}function Vo(e,t,i){var n=Dt(t,e),r=wo(i),o=e[10],s=Xo(e,Ro(e,r,null,i.onPush?64:16,n,t,o,o.createRenderer(n,i),null,null));e[t.index]=s}function zo(e,t,i,n,r,o){var s=o[t];if(null!==s)for(var a=n.setInput,u=0;u<s.length;){var c=s[u++],l=s[u++],h=s[u++];null!==a?n.setInput(i,h,c,l):i[l]=h}}function Yo(e,t){for(var i=null,n=0;n<t.length;){var r=t[n];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===i&&(i=[]),i.push(r,e[r],t[n+1])),n+=2}else n+=2;else n+=4}return i}function jo(e,t,i,n){return new Array(e,!0,!1,t,null,0,n,i,null,null)}function Ko(e,t){var i=Ft(t,e);if(Ht(i)){var n=i[1];80&i[2]?bo(n,i,n.template,i[8]):i[5]>0&&Qo(i)}}function Qo(e){for(var t=kr(e);null!==t;t=Nr(t))for(var i=10;i<t.length;i++){var n=t[i];if(1024&n[2]){var r=n[1];bo(r,n,r.template,n[8])}else n[5]>0&&Qo(n)}var o=e[1].components;if(null!==o)for(var s=0;s<o.length;s++){var a=Ft(o[s],e);Ht(a)&&a[5]>0&&Qo(a)}}function qo(e,t){var i=Ft(t,e),n=i[1];(function(e,t){for(var i=t.length;i<e.blueprint.length;i++)t.push(e.blueprint[i])})(n,i),Io(n,i,i[8])}function Xo(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Zo(e){for(;e;){e[2]|=64;var t=Ar(e);if(St(e)&&!t)return e;e=t}return null}function $o(e,t,i){var n=t[10];n.begin&&n.begin();try{bo(e,t,e.template,i)}catch(r){throw rs(t,r),r}finally{n.end&&n.end()}}function Jo(e){!function(e){for(var t=0;t<e.components.length;t++){var i=e.components[t],n=mr(i),r=n[1];Co(r,n,r.template,i)}}(e[8])}function es(e,t,i){ui(0),t(e,i)}var ts=Promise.resolve(null);function is(e){return e[7]||(e[7]=[])}function ns(e){return e.cleanup||(e.cleanup=[])}function rs(e,t){var i=e[9],n=i?i.get(yr,null):null;n&&n.handleError(t)}function os(e,t,i,n,r){for(var o=0;o<i.length;){var s=i[o++],a=i[o++],u=t[s],c=e.data[s];null!==c.setInput?c.setInput(u,r,n,a):u[a]=r}}function ss(e,t,i){var n=Mt(t,e);!function(e,t,i){_t(e)?e.setValue(t,i):t.textContent=i}(e[11],n,i)}function as(e,t,i){var n=i?e.styles:null,r=i?e.classes:null,o=0;if(null!==t)for(var s=0;s<t.length;s++){var a=t[s];"number"==typeof a?o=a:1==o?r=pe(r,a):2==o&&(n=pe(n,a+": "+t[++s]+";"))}i?e.styles=n:e.stylesWithoutHost=n,i?e.classes=r:e.classesWithoutHost=r}var us,cs=new an("INJECTOR",-1),ls=function(){function e(){p(this,e)}return S(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:En;if(t===En){var i=new Error("NullInjectorError: No provider for ".concat(ve(e),"!"));throw i.name="NullInjectorError",i}return t}}]),e}(),hs=new an("Set Injector scope."),ds={},gs={};function fs(){return void 0===us&&(us=new ls),us}function vs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return new ps(e,i,t||fs(),n)}var ps=function(){function e(t,i,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;p(this,e),this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var s=[];i&&hn(i,function(e){return r.processProvider(e,t,i)}),hn([t],function(e){return r.processInjectorType(e,[],s)}),this.records.set(cs,Es(void 0,this));var a=this.records.get(hs);this.scope=null!=a?a.value:null,this.source=o||("object"==typeof t?null:ve(t))}return S(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:En,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le.Default;this.assertNotDestroyed();var n=bn(this),r=xe(void 0);try{if(!(i&Le.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=function(e){return"function"==typeof e||"object"==typeof e&&e instanceof an}(e)&&Ae(e);o=s&&this.injectableDefInScope(s)?Es(ms(e),ds):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(i&Le.Self?fs():this.parent).get(e,t=i&Le.Optional&&t===En?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Rn]=a[Rn]||[]).unshift(ve(e)),n)throw a;return Pn(a,e,"R3InjectorError",this.source)}throw a}finally{xe(r),bn(n)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,i){return e.push(ve(i))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,i){var n=this;if(!(e=Ee(e)))return!1;var r=Ne(e),o=null==r&&e.ngModule||void 0,s=void 0===o?e:o,a=-1!==i.indexOf(s);if(void 0!==o&&(r=Ne(o)),null==r)return!1;if(null!=r.imports&&!a){var u;i.push(s);try{hn(r.imports,function(e){n.processInjectorType(e,t,i)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],i=t.ngModule,r=t.providers;hn(r,function(e){return n.processProvider(e,i,r||Ke)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(s);var h=Et(s)||function(){return new s};this.records.set(s,Es(h,ds));var d=r.providers;if(null!=d&&!a){var g=e;hn(d,function(e){return n.processProvider(e,g,d)})}return void 0!==o&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,i){var n=Rs(e=Ee(e))?e:Ee(e&&e.provide),r=function(e,t,i){return ys(e)?Es(void 0,e.useValue):Es(Ss(e),ds)}(e);if(Rs(e)||!0!==e.multi)this.records.get(n);else{var o=this.records.get(n);o||((o=Es(void 0,ds,!0)).factory=function(){return Nn(o.multi)},this.records.set(n,o)),n=e,o.multi.push(e)}this.records.set(n,r)}},{key:"hydrate",value:function(e,t){return t.value===ds&&(t.value=gs,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=Ee(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function ms(e){var t=Ae(e),i=null!==t?t.factory:Et(e);if(null!==i)return i;if(e instanceof an)throw new Error("Token ".concat(ve(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var i=fn(t,"?");throw new Error("Can't resolve all parameters for ".concat(ve(e),": (").concat(i.join(", "),")."))}var n=function(e){var t=e&&(e[we]||e[Me]);if(t){var i=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(i,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(i,'" class.')),t}return null}(e);return null!==n?function(){return n.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function Ss(e,t,n){var r;if(Rs(e)){var o=Ee(e);return Et(o)||ms(o)}if(ys(e))r=function(){return Ee(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,i(Nn(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return An(Ee(e.useExisting))};else{var s=Ee(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return Et(s)||ms(s);r=function(){return a(s,i(Nn(e.deps)))}}return r}function Es(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:i?[]:void 0}}function ys(e){return null!==e&&"object"==typeof e&&In in e}function Rs(e){return"function"==typeof e}var Os=function(e,t,i){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0,r=vs(e,t,i,n);return r._resolveInjectorDefTypes(),r}({name:i},t,e,i)},Ts=function(){function e(){p(this,e)}return S(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Os(e,t,""):Os(e.providers,e.parent,e.name||"")}}]),e}();function Is(e,t){Ri(mr(e)[1],Qt())}function bs(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),i=!0,n=[e];t;){var r=void 0;if(mt(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");r=t.\u0275dir}if(r){if(i){n.push(r);var o=e;o.inputs=Cs(e.inputs),o.declaredInputs=Cs(e.declaredInputs),o.outputs=Cs(e.outputs);var s=r.hostBindings;s&&Ns(e,s);var a=r.viewQuery,u=r.contentQueries;if(a&&As(e,a),u&&ks(e,u),fe(e.inputs,r.inputs),fe(e.declaredInputs,r.declaredInputs),fe(e.outputs,r.outputs),mt(r)&&r.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(r.data.animation)}}var l=r.features;if(l)for(var h=0;h<l.length;h++){var d=l[h];d&&d.ngInherit&&d(e),d===bs&&(i=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,i=null,n=e.length-1;n>=0;n--){var r=e[n];r.hostVars=t+=r.hostVars,r.hostAttrs=wi(r.hostAttrs,i=wi(i,r.hostAttrs))}}(n)}function Cs(e){return e===je?{}:e===Ke?[]:e}function As(e,t){var i=e.viewQuery;e.viewQuery=i?function(e,n){t(e,n),i(e,n)}:t}function ks(e,t){var i=e.contentQueries;e.contentQueries=i?function(e,n,r){t(e,n,r),i(e,n,r)}:t}function Ns(e,t){var i=e.hostBindings;e.hostBindings=i?function(e,n){t(e,n),i(e,n)}:t}Ts.THROW_IF_NOT_FOUND=En,Ts.NULL=new ls,Ts.\u0275prov=be({token:Ts,providedIn:"any",factory:function(){return An(cs)}}),Ts.__NG_ELEMENT_ID__=-1;var _s=null;function ws(){if(!_s){var e=Ye.Symbol;if(e&&e.iterator)_s=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),i=0;i<t.length;++i){var n=t[i];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(_s=n)}}return _s}var Ps=function(){function e(t){p(this,e),this.wrapped=t}return S(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function Ms(e){return!!Ds(e)&&(Array.isArray(e)||!(e instanceof Map)&&ws()in e)}function Ds(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Ls(e,t,i){return e[t]=i}function xs(e,t,i){return!Object.is(e[t],i)&&(e[t]=i,!0)}function Fs(e,t,i,n){var r=xs(e,t,i);return xs(e,t+1,n)||r}function Us(e,t,i,n){var r=Yt();return xs(r,ni(),t)&&(jt(),function(e,t,i,n,r,o){var s=Dt(e,t);!function(e,t,i,n,r,o,s){if(null==o)_t(e)?e.removeAttribute(t,r,i):t.removeAttribute(r);else{var a=null==s?Oe(o):s(o,n||"",r);_t(e)?e.setAttribute(t,r,a,i):i?t.setAttributeNS(i,r,a):t.setAttribute(r,a)}}(t[11],s,o,e.value,i,n,r)}(Ei(),r,e,t,i,n)),Us}function Hs(e,t,i,n){return xs(e,ni(),i)?t+Oe(i)+n:lo}function Gs(e,t,i,n,r,o,s,a){var u=Yt(),c=jt(),l=e+20,h=c.firstCreatePass?function(e,t,i,n,r,o,s,a,u){var c=t.consts,l=Oo(t,e,4,s||null,Gt(c,a));xo(t,i,l,Gt(c,u)),Ri(t,l);var h=l.tViews=Po(2,l,n,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,i,n,r,o,s):c.data[l];Xt(h,!1);var d=u[11].createComment("");zr(c,u,d,h),pr(d,u),Xo(u,u[l]=jo(d,u,d,h)),pt(h)&&No(c,u,h),null!=s&&_o(u,h,a)}function Bs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Le.Default,i=Yt();return null===i?An(e,t):ji(Qt(),i,Ee(e),t)}function Ws(e,t,i){var n=Yt();return xs(n,ni(),t)&&Lo(jt(),Ei(),n,e,t,n[11],i,!1),Ws}function Vs(e,t,i,n,r){var o=r?"class":"style";os(e,i,t.inputs[o],o,n)}function zs(e,t,i,n){var r=Yt(),o=jt(),s=20+e,a=r[11],u=r[s]=Pr(a,t,Vt.lFrame.currentNamespace),c=o.firstCreatePass?function(e,t,i,n,r,o,s){var a=t.consts,u=Oo(t,e,2,r,Gt(a,o));return xo(t,i,u,Gt(a,s)),null!==u.attrs&&as(u,u.attrs,!1),null!==u.mergedAttrs&&as(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(s,o,r,0,t,i,n):o.data[s];Xt(c,!0);var l=c.mergedAttrs;null!==l&&ki(a,u,l);var h=c.classes;null!==h&&$r(a,u,h);var d=c.styles;null!==d&&Zr(a,u,d),64!=(64&c.flags)&&zr(o,r,u,c),0===Vt.lFrame.elementDepthCount&&pr(u,r),Vt.lFrame.elementDepthCount++,pt(c)&&(No(o,r,c),ko(o,c,r)),null!==n&&_o(r,c)}function Ys(){var e=Qt();Zt()?$t():Xt(e=e.parent,!1);var t=e;Vt.lFrame.elementDepthCount--;var i=jt();i.firstCreatePass&&(Ri(i,e),ft(e)&&i.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Vs(i,t,Yt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Vs(i,t,Yt(),t.stylesWithoutHost,!1)}function js(e,t,i,n){zs(e,t,i,n),Ys()}function Ks(e,t,i){var n=Yt(),r=jt(),o=e+20,s=r.firstCreatePass?function(e,t,i,n,r){var o=t.consts,s=Gt(o,n),a=Oo(t,e,8,"ng-container",s);return null!==s&&as(a,s,!0),xo(t,i,a,Gt(o,r)),null!==t.queries&&t.queries.elementStart(t,a),a}(o,r,n,t,i):r.data[o];Xt(s,!0);var a=n[o]=n[11].createComment("");zr(r,n,a,s),pr(a,n),pt(s)&&(No(r,n,s),ko(r,s,n)),null!=i&&_o(n,s)}function Qs(){var e=Qt(),t=jt();Zt()?$t():Xt(e=e.parent,!1),t.firstCreatePass&&(Ri(t,e),ft(e)&&t.queries.elementEnd(e))}function qs(){return Yt()}function Xs(e){return!!e&&"function"==typeof e.then}var Zs=function(e){return!!e&&"function"==typeof e.subscribe};function $s(e,t,i,n){var r=Yt(),o=jt(),s=Qt();return function(e,t,i,n,r,o,s,a){var u=pt(n),c=e.firstCreatePass&&ns(e),l=t[8],h=is(t),d=!0;if(3&n.type||a){var g=Dt(n,t),f=a?a(g):g,v=h.length,p=a?function(e){return a(Pt(e[n.index]))}:n.index;if(_t(i)){var m=null;if(!a&&u&&(m=function(e,t,i,n){var r=e.cleanup;if(null!=r)for(var o=0;o<r.length-1;o+=2){var s=r[o];if(s===i&&r[o+1]===n){var a=t[7],u=r[o+2];return a.length>u?a[u]:null}"string"==typeof s&&(o+=2)}return null}(e,t,r,n.index)),null!==m)(m.__ngLastListenerFn__||m).__ngNextListenerFn__=o,m.__ngLastListenerFn__=o,d=!1;else{o=ea(n,t,l,o,!1);var S=i.listen(f,r,o);h.push(o,S),c&&c.push(r,p,v,v+1)}}else o=ea(n,t,l,o,!0),f.addEventListener(r,o,s),h.push(o),c&&c.push(r,p,v,s)}else o=ea(n,t,l,o,!1);var E,y=n.outputs;if(d&&null!==y&&(E=y[r])){var R=E.length;if(R)for(var O=0;O<R;O+=2){var T=t[E[O]][E[O+1]].subscribe(o),I=h.length;h.push(o,T),c&&c.push(r,n.index,I,-(I+1))}}}(o,r,r[11],s,e,t,!!i,n),$s}function Js(e,t,i,n){try{return!1!==i(n)}catch(r){return rs(e,r),!1}}function ea(e,t,i,n,r){return function i(o){if(o===Function)return n;var s=2&e.flags?Ft(e.index,t):t;0==(32&t[2])&&Zo(s);for(var a=Js(t,0,n,o),u=i.__ngNextListenerFn__;u;)a=Js(t,0,u,o)&&a,u=u.__ngNextListenerFn__;return r&&!1===a&&(o.preventDefault(),o.returnValue=!1),a}}function ta(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Vt.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Vt.lFrame.contextLView))[8]}(e)}function ia(e,t,i){return na(e,"",t,"",i),ia}function na(e,t,i,n,r){var o=Yt(),s=Hs(o,t,i,n);return s!==lo&&Lo(jt(),Ei(),o,e,s,o[11],r,!1),na}function ra(e,t,i,n,r){for(var o=e[i+1],s=null===t,a=n?vo(o):mo(o),u=!1;0!==a&&(!1===u||s);){var c=e[a+1];oa(e[a],t)&&(u=!0,e[a+1]=n?Eo(c):po(c)),a=n?vo(c):mo(c)}u&&(e[i+1]=n?po(o):Eo(o))}function oa(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&mn(e,t)>=0}function sa(e,t){return function(e,t,i,n){var r=Yt(),o=jt(),s=ri(2);o.firstUpdatePass&&function(e,t,i,n){var r=e.data;if(null===r[i+1]){var o=r[mi()],s=function(e,t){return t>=e.expandoStartIndex}(e,i);(function(e,t){return 0!=(16&e.flags)})(o)&&null===t&&!s&&(t=!1),function(e,t,i,n,r,o){var s=t.classBindings,a=vo(s),u=mo(s);e[n]=i;var c,l=!1;if(Array.isArray(i)){var h=i;(null===(c=h[1])||mn(h,c)>0)&&(l=!0)}else c=i;if(r)if(0!==u){var d=vo(e[a+1]);e[n+1]=fo(d,a),0!==d&&(e[d+1]=So(e[d+1],n)),e[a+1]=function(e,t){return 131071&e|t<<17}(e[a+1],n)}else e[n+1]=fo(a,0),0!==a&&(e[a+1]=So(e[a+1],n)),a=n;else e[n+1]=fo(u,0),0===a?a=n:e[u+1]=So(e[u+1],n),u=n;l&&(e[n+1]=po(e[n+1])),ra(e,c,n,!0),ra(e,c,n,!1),function(e,t,i,n,r){var o=e.residualClasses;null!=o&&"string"==typeof t&&mn(o,t)>=0&&(i[n+1]=Eo(i[n+1]))}(t,c,e,n),s=fo(a,u),t.classBindings=s}(r,o,t=function(e,t,i,n){var r=function(e){var t=Vt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),o=t.residualClasses;if(null===r)0===t.classBindings&&(i=ua(i=aa(null,e,t,i,n),t.attrs,n),o=null);else{var s=t.directiveStylingLast;if(-1===s||e[s]!==r)if(i=aa(r,e,t,i,n),null===o){var a=function(e,t,i){var n=t.classBindings;if(0!==mo(n))return e[vo(n)]}(e,t);void 0!==a&&Array.isArray(a)&&function(e,t,i,n){e[vo(t.classBindings)]=n}(e,t,0,a=ua(a=aa(null,e,t,a[1],n),t.attrs,n))}else o=function(e,t,i){for(var n,r=t.directiveEnd,o=1+t.directiveStylingLast;o<r;o++)n=ua(n,e[o].hostAttrs,true);return ua(n,t.attrs,true)}(e,t)}return void 0!==o&&(t.residualClasses=o),i}(r,o,t,n),i,s)}}(o,e,s,true),t!==lo&&xs(r,s,t)&&function(e,t,i,n,r,o,s,a){if(3&t.type){var u=e.data,c=u[a+1];la(function(e){return 1==(1&e)}(c)?ca(u,t,i,r,mo(c),s):void 0)||(la(o)||function(e){return 2==(2&e)}(c)&&(o=ca(u,null,i,r,a,s)),function(e,t,i,n,r){var o=_t(e);r?o?e.addClass(i,n):i.classList.add(n):o?e.removeClass(i,n):i.classList.remove(n)}(n,0,Mt(mi(),i),r,o))}}(o,o.data[mi()],r,r[11],e,r[s+1]=function(e,t){return null==e||"object"==typeof e&&(e=ve(Bn(e))),e}(t),true,s)}(e,t),sa}function aa(e,t,i,n,r){var o=null,s=i.directiveEnd,a=i.directiveStylingLast;for(-1===a?a=i.directiveStart:a++;a<s&&(n=ua(n,(o=t[a]).hostAttrs,r),o!==e);)a++;return null!==e&&(i.directiveStylingLast=a),n}function ua(e,t,i){var n=i?1:2,r=-1;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?r=s:r===n&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),vn(e,s,!!i||t[++o]))}return void 0===e?null:e}function ca(e,t,i,n,r,o){for(var s,a=null===t;r>0;){var u=e[r],c=Array.isArray(u),l=c?u[1]:u,h=null===l,d=i[r+1];d===lo&&(d=h?Ke:void 0);var g=h?pn(d,n):l===n?d:void 0;if(c&&!la(g)&&(g=pn(u,n)),la(g)&&(s=g,a))return s;var f=e[r+1];r=a?vo(f):mo(f)}if(null!==t){var v=o?t.residualClasses:t.residualStyles;null!=v&&(s=pn(v,n))}return s}function la(e){return void 0!==e}function ha(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=Yt(),n=jt(),r=e+20,o=n.firstCreatePass?Oo(n,r,1,t,null):n.data[r],s=i[r]=function(e,t){return _t(e)?e.createText(t):e.createTextNode(t)}(i[11],t);zr(n,i,s,o),Xt(o,!1)}function da(e){return ga("",e,""),da}function ga(e,t,i){var n=Yt(),r=Hs(n,e,t,i);return r!==lo&&ss(n,mi(),r),ga}function fa(e,t,i,n,r){var o=Yt(),s=function(e,t,i,n,r,o){var s=Fs(e,ii(),i,r);return ri(2),s?t+Oe(i)+n+Oe(r)+o:lo}(o,e,t,i,n,r);return s!==lo&&ss(o,mi(),s),fa}function va(e,t,i,n,r,o,s){var a=Yt(),u=function(e,t,i,n,r,o,s,a){var u=function(e,t,i,n,r){var o=Fs(e,t,i,n);return xs(e,t+2,r)||o}(e,ii(),i,r,s);return ri(3),u?t+Oe(i)+n+Oe(r)+o+Oe(s)+a:lo}(a,e,t,i,n,r,o,s);return u!==lo&&ss(a,mi(),u),va}function pa(e,t,i){var n=Yt();return xs(n,ni(),t)&&Lo(jt(),Ei(),n,e,t,n[11],i,!0),pa}var ma=void 0,Sa=["en",[["a","p"],["AM","PM"],ma],[["AM","PM"],ma,ma],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ma,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ma,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ma,"{1} 'at' {0}",ma],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),i=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}],Ea={};function ya(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),i=Ra(t);if(i)return i;var n=t.split("-")[0];if(i=Ra(n))return i;if("en"===n)return Sa;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function Ra(e){return e in Ea||(Ea[e]=Ye.ng&&Ye.ng.common&&Ye.ng.common.locales&&Ye.ng.common.locales[e]),Ea[e]}var Oa=((Oa=Oa||{})[Oa.LocaleId=0]="LocaleId",Oa[Oa.DayPeriodsFormat=1]="DayPeriodsFormat",Oa[Oa.DayPeriodsStandalone=2]="DayPeriodsStandalone",Oa[Oa.DaysFormat=3]="DaysFormat",Oa[Oa.DaysStandalone=4]="DaysStandalone",Oa[Oa.MonthsFormat=5]="MonthsFormat",Oa[Oa.MonthsStandalone=6]="MonthsStandalone",Oa[Oa.Eras=7]="Eras",Oa[Oa.FirstDayOfWeek=8]="FirstDayOfWeek",Oa[Oa.WeekendRange=9]="WeekendRange",Oa[Oa.DateFormat=10]="DateFormat",Oa[Oa.TimeFormat=11]="TimeFormat",Oa[Oa.DateTimeFormat=12]="DateTimeFormat",Oa[Oa.NumberSymbols=13]="NumberSymbols",Oa[Oa.NumberFormats=14]="NumberFormats",Oa[Oa.CurrencyCode=15]="CurrencyCode",Oa[Oa.CurrencySymbol=16]="CurrencySymbol",Oa[Oa.CurrencyName=17]="CurrencyName",Oa[Oa.Currencies=18]="Currencies",Oa[Oa.Directionality=19]="Directionality",Oa[Oa.PluralCase=20]="PluralCase",Oa[Oa.ExtraData=21]="ExtraData",Oa),Ta="en-US";function Ia(e){(function(e,t){null==e&&function(e,t,i,n){throw new Error("ASSERTION ERROR: ".concat(e)+" [Expected=> ".concat(null," ").concat("!="," ").concat(t," <=Actual]"))}(t,e)})(e,"Expected localeId to be defined"),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}function ba(e,t,i,n,r){if(e=Ee(e),Array.isArray(e))for(var o=0;o<e.length;o++)ba(e[o],t,i,n,r);else{var s=jt(),a=Yt(),u=Rs(e)?e:Ee(e.provide),c=Ss(e),l=Qt(),h=1048575&l.providerIndexes,d=l.directiveStart,g=l.providerIndexes>>20;if(Rs(e)||!e.multi){var f=new Ai(c,r,Bs),v=ka(u,t,r?h:h+g,d);-1===v?(Vi(Hi(l,a),s,u),Ca(s,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),i.push(f),a.push(f)):(i[v]=f,a[v]=f)}else{var p=ka(u,t,h+g,d),m=ka(u,t,h,h+g),S=p>=0&&i[p],E=m>=0&&i[m];if(r&&!E||!r&&!S){Vi(Hi(l,a),s,u);var y=function(e,t,i,n,r){var o=new Ai(e,i,Bs);return o.multi=[],o.index=t,o.componentProviders=0,Aa(o,r,n&&!i),o}(r?_a:Na,i.length,r,n,c);!r&&E&&(i[m].providerFactory=y),Ca(s,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),i.push(y),a.push(y)}else Ca(s,e,p>-1?p:m,Aa(i[r?m:p],c,!r&&n));!r&&n&&E&&i[m].componentProviders++}}}function Ca(e,t,i,n){var r=Rs(t);if(r||function(e){return!!e.useClass}(t)){var o=(t.useClass||t).prototype.ngOnDestroy;if(o){var s=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){var a=s.indexOf(i);-1===a?s.push(i,[n,o]):s[a+1].push(n,o)}else s.push(i,o)}}}function Aa(e,t,i){return i&&e.componentProviders++,e.multi.push(t)-1}function ka(e,t,i,n){for(var r=i;r<n;r++)if(t[r]===e)return r;return-1}function Na(e,t,i,n){return wa(this.multi,[])}function _a(e,t,i,n){var r,o=this.multi;if(this.providerFactory){var s=this.providerFactory.componentProviders,a=Zi(i,i[1],this.providerFactory.index,n);wa(o,r=a.slice(0,s));for(var u=s;u<a.length;u++)r.push(a[u])}else wa(o,r=[]);return r}function wa(e,t){for(var i=0;i<e.length;i++)t.push((0,e[i])());return t}function Pa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(i){i.providersResolver=function(i,n){return function(e,t,i){var n=jt();if(n.firstCreatePass){var r=mt(e);ba(i,n.data,n.blueprint,r,!0),ba(t,n.data,n.blueprint,r,!1)}}(i,n?n(e):e,t)}}}var Ma=function e(){p(this,e)},Da=function e(){p(this,e)};function La(){}function xa(e,t){return new Ua(Dt(e,t))}Da.NULL=new(function(){function e(){p(this,e)}return S(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(ve(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}());var Fa=function(){return xa(Qt(),Yt())},Ua=function(){var e=function e(t){p(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=Fa,e}();function Ha(e){return e instanceof Ua?e.nativeElement:e}var Ga=function e(){p(this,e)},Ba=function(){var e=function e(){p(this,e)};return e.__NG_ELEMENT_ID__=function(){return Wa()},e}(),Wa=function(){var e=Yt(),t=Ft(Qt().index,e);return function(e){return e[11]}(dt(t)?t:e)},Va=function(){var e=function e(){p(this,e)};return e.\u0275prov=be({token:e,providedIn:"root",factory:function(){return null}}),e}(),za=new function e(t){p(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("12.2.1"),Ya=function(){function e(){p(this,e)}return S(e,[{key:"supports",value:function(e){return Ms(e)}},{key:"create",value:function(e){return new Ka(e)}}]),e}(),ja=function(e,t){return t},Ka=function(){function e(t){p(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||ja}return S(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,i=this._removalsHead,n=0,r=null;t||i;){var o=!i||t&&t.currentIndex<Za(i,n,r)?t:i,s=Za(o,n,r),a=o.currentIndex;if(o===i)n--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)n++;else{r||(r=[]);var u=s-n,c=a-n;if(u!=c){for(var l=0;l<u;l++){var h=l<r.length?r[l]:r[l]=0,d=h+l;c<=d&&d<u&&(r[l]=h+1)}r[o.previousIndex]=c-u}}s!==a&&e(o,s,a)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Ms(e))throw new Error("Error trying to diff '".concat(ve(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var i,n,r,o=this._itHead,s=!1;if(Array.isArray(e)){this.length=e.length;for(var a=0;a<this.length;a++)n=e[a],r=this._trackByFn(a,n),null!==o&&Object.is(o.trackById,r)?(s&&(o=this._verifyReinsertion(o,n,r,a)),Object.is(o.item,n)||this._addIdentityChange(o,n)):(o=this._mismatch(o,n,r,a),s=!0),o=o._next}else i=0,function(e,t){if(Array.isArray(e))for(var i=0;i<e.length;i++)t(e[i]);else for(var n,r=e[ws()]();!(n=r.next()).done;)t(n.value)}(e,function(e){r=t._trackByFn(i,e),null!==o&&Object.is(o.trackById,r)?(s&&(o=t._verifyReinsertion(o,e,r,i)),Object.is(o.item,e)||t._addIdentityChange(o,e)):(o=t._mismatch(o,e,r,i),s=!0),o=o._next,i++}),this.length=i;return this._truncate(o),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,i,n){var r;return null===e?r=this._itTail:(r=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,r,n)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,n))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,r,n)):e=this._addAfter(new Qa(t,i),r,n),e}},{key:"_verifyReinsertion",value:function(e,t,i,n){var r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==r?e=this._reinsertAfter(r,e._prev,n):e.currentIndex!=n&&(e.currentIndex=n,this._addToMoves(e,n)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var n=e._prevRemoved,r=e._nextRemoved;return null===n?this._removalsHead=r:n._nextRemoved=r,null===r?this._removalsTail=n:r._prevRemoved=n,this._insertAfter(e,t,i),this._addToMoves(e,i),e}},{key:"_moveAfter",value:function(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}},{key:"_addAfter",value:function(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,i){var n=null===t?this._itHead:t._next;return e._next=n,e._prev=t,null===n?this._itTail=e:n._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Xa),this._linkedRecords.put(e),e.currentIndex=i,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Xa),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),Qa=function e(t,i){p(this,e),this.item=t,this.trackById=i,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},qa=function(){function e(){p(this,e),this._head=null,this._tail=null}return S(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}},{key:"remove",value:function(e){var t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}]),e}(),Xa=function(){function e(){p(this,e),this.map=new Map}return S(e,[{key:"put",value:function(e){var t=e.trackById,i=this.map.get(t);i||(i=new qa,this.map.set(t,i)),i.add(e)}},{key:"get",value:function(e,t){var i=this.map.get(e);return i?i.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function Za(e,t,i){var n=e.previousIndex;if(null===n)return n;var r=0;return i&&n<i.length&&(r=i[n]),n+t+r}var $a=function(){function e(){p(this,e)}return S(e,[{key:"supports",value:function(e){return e instanceof Map||Ds(e)}},{key:"create",value:function(){return new Ja}}]),e}(),Ja=function(){function e(){p(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return S(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Ds(e)))throw new Error("Error trying to diff '".concat(ve(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var i=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,n){if(i&&i.key===n)t._maybeAddToChanges(i,e),t._appendAfter=i,i=i._next;else{var r=t._getOrCreateRecordForKey(n,e);i=t._insertBeforeOrAppend(i,r)}}),i){i._prev&&(i._prev._next=null),this._removalsHead=i;for(var n=i;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var i=this._records.get(e);this._maybeAddToChanges(i,t);var n=i._prev,r=i._next;return n&&(n._next=r),r&&(r._prev=n),i._next=null,i._prev=null,i}var o=new eu(e);return this._records.set(e,o),o.currentValue=t,this._addToAdditions(o),o}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(i){return t(e[i],i)})}}]),e}(),eu=function e(t){p(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null};function tu(){return new iu([new Ya])}var iu=function(){var e=function(){function e(t){p(this,e),this.factories=t}return S(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,i){if(null!=i){var n=i.factories.slice();t=t.concat(n)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(i){return e.create(t,i||tu())},deps:[[e,new Fn,new xn]]}}}]),e}();return e.\u0275prov=be({token:e,providedIn:"root",factory:tu}),e}();function nu(){return new ru([new $a])}var ru=function(){var e=function(){function e(t){p(this,e),this.factories=t}return S(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,i){if(i){var n=i.factories.slice();t=t.concat(n)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(i){return e.create(t,i||nu())},deps:[[e,new Fn,new xn]]}}}]),e}();return e.\u0275prov=be({token:e,providedIn:"root",factory:nu}),e}();function ou(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var s=t[n.index];if(null!==s&&r.push(Pt(s)),gt(s))for(var a=10;a<s.length;a++){var u=s[a],c=u[1].firstChild;null!==c&&ou(u[1],u,c,r)}var l=n.type;if(8&l)ou(e,t,n.child,r);else if(32&l)for(var h=Cr(n,t),d=void 0;d=h();)r.push(d);else if(16&l){var g=jr(t,n);if(Array.isArray(g))r.push.apply(r,i(g));else{var f=Ar(t[16]);ou(f[1],f,g,r,!0)}}n=o?n.projectionNext:n.next}return r}var su=function(){function e(t,i){p(this,e),this._lView=t,this._cdRefInjectingView=i,this._appRef=null,this._attachedToViewContainer=!1}return S(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return ou(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(gt(e)){var t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Dr(e,i),gn(t,i))}this._attachedToViewContainer=!1}Lr(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){Mo(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){Zo(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){$o(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,i){ei(!0);try{$o(e,t,i)}finally{ei(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){this._appRef=null,function(e,t){qr(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),au=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this,e))._view=e,n}return S(i,[{key:"detectChanges",value:function(){Jo(this._view)}},{key:"checkNoChanges",value:function(){!function(e){ei(!0);try{Jo(e)}finally{ei(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),i}(su),uu=function(e){return function(e,t,i){if(vt(e)&&!i){var n=Ft(e.index,t);return new su(n,n)}return 47&e.type?new su(t[16],t):null}(Qt(),Yt(),16==(16&e))},cu=function(){var e=function e(){p(this,e)};return e.__NG_ELEMENT_ID__=uu,e}(),lu=[new $a],hu=new iu([new Ya]),du=new ru(lu),gu=function(){return pu(Qt(),Yt())},fu=function(){var e=function e(){p(this,e)};return e.__NG_ELEMENT_ID__=gu,e}(),vu=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this))._declarationLView=e,o._declarationTContainer=n,o.elementRef=r,o}return S(i,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,i=Ro(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];var n=this._declarationLView[19];return null!==n&&(i[19]=n.createEmbeddedView(t)),Io(t,i,e),new su(i)}}]),i}(fu);function pu(e,t){return 4&e.type?new vu(t,e,xa(e,t)):null}var mu=function e(){p(this,e)},Su=function e(){p(this,e)},Eu=function(){return Iu(Qt(),Yt())},yu=function(){var e=function e(){p(this,e)};return e.__NG_ELEMENT_ID__=Eu,e}(),Ru=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this))._lContainer=e,o._hostTNode=n,o._hostLView=r,o}return S(i,[{key:"element",get:function(){return xa(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new en(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=Wi(this._hostTNode,this._hostLView);if(Mi(e)){var t=Li(e,this._hostLView),i=Di(e);return new en(t[1].data[i+8],t)}return new en(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=Ou(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,i){var n=e.createEmbeddedView(t||{});return this.insert(n,i),n}},{key:"createComponent",value:function(e,t,i,n,r){var o=i||this.parentInjector;if(!r&&null==e.ngModule&&o){var s=o.get(mu,null);s&&(r=s)}var a=e.create(o,n,void 0,r);return this.insert(a.hostView,t),a}},{key:"insert",value:function(e,t){var n=e._lView,r=n[1];if(function(e){return gt(e[3])}(n)){var o=this.indexOf(e);if(-1!==o)this.detach(o);else{var s=n[3],a=new i(s,s[6],s[3]);a.detach(a.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,i,n){var r=10+n,o=i.length;n>0&&(i[r-1][4]=t),n<o-10?(t[4]=i[r],dn(i,10+n,t)):(i.push(t),t[4]=null),t[3]=i;var s=t[17];null!==s&&i!==s&&function(e,t){var i=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===i?e[9]=[t]:i.push(t)}(s,t);var a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,n,c,u);var l=Kr(u,c),h=n[11],d=Br(h,c[7]);return null!==d&&function(e,t,i,n,r,o){n[0]=r,n[6]=t,qr(e,n,i,1,r,o)}(r,c[6],h,n,d,l),e.attachToViewContainerRef(),dn(Tu(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=Ou(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),i=Dr(this._lContainer,t);i&&(gn(Tu(this._lContainer),t),Lr(i[1],i))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),i=Dr(this._lContainer,t);return i&&null!=gn(Tu(this._lContainer),t)?new su(i):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?this.length+t:e}}]),i}(yu);function Ou(e){return e[8]}function Tu(e){return e[8]||(e[8]=[])}function Iu(e,t){var i,n=t[e.index];if(gt(n))i=n;else{var r;if(8&e.type)r=Pt(n);else{var o=t[11];r=o.createComment("");var s=Dt(e,t);Ur(o,Br(o,s),r,function(e,t){return _t(e)?e.nextSibling(t):t.nextSibling}(o,s),!1)}t[e.index]=i=jo(n,t,r,e),Xo(t,i)}return new Ru(i,e,t)}var bu={},Cu=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this)).ngModule=e,n}return S(i,[{key:"resolveComponentFactory",value:function(e){var t=lt(e);return new Nu(t,this.ngModule)}}]),i}(Da);function Au(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push({propName:e[i],templateName:i});return t}var ku=new an("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Rr}}),Nu=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this)).componentDef=e,r.ngModule=n,r.componentType=e.type,r.selector=function(e){return e.map(co).join(",")}(e.selectors),r.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],r.isBoundToModule=!!n,r}return S(i,[{key:"inputs",get:function(){return Au(this.componentDef.inputs)}},{key:"outputs",get:function(){return Au(this.componentDef.outputs)}},{key:"create",value:function(e,t,i,n){var r,o,s=(n=n||this.ngModule)?function(e,t){return{get:function(i,n,r){var o=e.get(i,bu,r);return o!==bu||n===bu?o:t.get(i,n,r)}}}(e,n.injector):e,a=s.get(Ga,wt),u=s.get(Va,null),c=a.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=i?function(e,t,i){if(_t(e))return e.selectRootElement(t,i===Ge.ShadowDom);var n="string"==typeof t?e.querySelector(t):t;return n.textContent="",n}(c,i,this.componentDef.encapsulation):Pr(a.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?kt:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),d=this.componentDef.onPush?576:528,g={components:[],scheduler:Rr,clean:ts,playerHandler:null,flags:0},f=Po(0,null,null,1,0,null,null,null,null,null),v=Ro(null,f,g,d,null,null,a,c,u,s);hi(v);try{var p=function(e,t,i,n,r,o){var s=i[1];i[20]=e;var a=Oo(s,20,2,"#host",null),u=a.mergedAttrs=t.hostAttrs;null!==u&&(as(a,u,!0),null!==e&&(ki(r,e,u),null!==a.classes&&$r(r,e,a.classes),null!==a.styles&&Zr(r,e,a.styles)));var c=n.createRenderer(e,t),l=Ro(i,wo(t),null,t.onPush?64:16,i[20],a,n,c,null,null);return s.firstCreatePass&&(Vi(Hi(a,i),s,t.type),Ho(s,a),Bo(a,i.length,1)),Xo(i,l),i[20]=l}(h,this.componentDef,v,a,c);if(h)if(i)ki(c,h,["ng-version",za.full]);else{var m=function(e){for(var t=[],i=[],n=1,r=2;n<e.length;){var o=e[n];if("string"==typeof o)2===r?""!==o&&t.push(o,e[++n]):8===r&&i.push(o);else{if(!oo(r))break;r=o}n++}return{attrs:t,classes:i}}(this.componentDef.selectors[0]),S=m.attrs,E=m.classes;S&&ki(c,h,S),E&&E.length>0&&$r(c,h,E.join(" "))}if(o=Lt(f,20),void 0!==t)for(var y=o.projection=[],R=0;R<this.ngContentSelectors.length;R++){var O=t[R];y.push(null!=O?Array.from(O):null)}r=function(e,t,i,n,r){var o=i[1],s=function(e,t,i){var n=Qt();e.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),Wo(e,n,t,To(e,t,1,null),i));var r=Zi(t,e,n.directiveStart,n);pr(r,t);var o=Dt(n,t);return o&&pr(o,t),r}(o,i,t);if(n.components.push(s),e[8]=s,r&&r.forEach(function(e){return e(s,t)}),t.contentQueries){var a=Qt();t.contentQueries(1,s,a.directiveStart)}var u=Qt();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Si(u.index),Fo(i[1],u,0,u.directiveStart,u.directiveEnd,t),Uo(t,s)),s}(p,this.componentDef,v,g,[Is]),Io(f,v,null)}finally{pi()}return new _u(this.componentType,r,xa(o,v),v,o)}}]),i}(Ma),_u=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a;return p(this,i),(a=t.call(this)).location=r,a._rootLView=o,a._tNode=s,a.instance=n,a.hostView=a.changeDetectorRef=new au(o),a.componentType=e,a}return S(i,[{key:"injector",get:function(){return new en(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),i}(function(){return function e(){p(this,e)}}()),wu=new Map,Pu=function(e){c(i,e);var t=h(i);function i(e,n){var r;p(this,i),(r=t.call(this))._parent=n,r._bootstrapComponents=[],r.injector=g(r),r.destroyCbs=[],r.componentFactoryResolver=new Cu(g(r));var o=ht(e),s=function(e){return e[$e]||null}(e);return s&&Ia(s),r._bootstrapComponents=Ir(o.bootstrap),r._r3Injector=vs(e,n,[{provide:mu,useValue:g(r)},{provide:Da,useValue:r.componentFactoryResolver}],ve(e)),r._r3Injector._resolveInjectorDefTypes(),r.instance=r.get(e),r}return S(i,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ts.THROW_IF_NOT_FOUND,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le.Default;return e===Ts||e===mu||e===cs?this:this._r3Injector.get(e,t,i)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),i}(mu),Mu=function(e){c(i,e);var t=h(i);function i(e){var r;return p(this,i),(r=t.call(this)).moduleType=e,null!==ht(e)&&function(e){var t=new Set;!function e(i){var r=ht(i,!0),o=r.id;null!==o&&(function(e,t,i){if(t&&t!==i)throw new Error("Duplicate module registered for ".concat(e," - ").concat(ve(t)," vs ").concat(ve(t.name)))}(o,wu.get(o),i),wu.set(o,i));var s,a=n(Ir(r.imports));try{for(a.s();!(s=a.n()).done;){var u=s.value;t.has(u)||(t.add(u),e(u))}}catch(c){a.e(c)}finally{a.f()}}(e)}(e),r}return S(i,[{key:"create",value:function(e){return new Pu(this.moduleType,e)}}]),i}(Su);function Du(e,t,i,n){return Fu(Yt(),ti(),e,t,i,n)}function Lu(e,t,i,n,r){return Uu(Yt(),ti(),e,t,i,n,r)}function xu(e,t){var i=e[t];return i===lo?void 0:i}function Fu(e,t,i,n,r,o){var s=t+i;return xs(e,s,r)?Ls(e,s+1,o?n.call(o,r):n(r)):xu(e,s+1)}function Uu(e,t,i,n,r,o,s){var a=t+i;return Fs(e,a,r,o)?Ls(e,a+2,s?n.call(s,r,o):n(r,o)):xu(e,a+2)}function Hu(e,t){var i,n=jt(),r=e+20;n.firstCreatePass?(i=function(e,t){if(t)for(var i=t.length-1;i>=0;i--){var n=t[i];if(e===n.name)return n}throw new Re("302","The pipe '".concat(e,"' could not be found!"))}(t,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];var o=i.factory||(i.factory=Et(i.type)),s=xe(Bs);try{var a=Fi(!1),u=o();return Fi(a),function(e,t,i,n){i>=e.data.length&&(e.data[i]=null,e.blueprint[i]=null),t[i]=n}(n,Yt(),r,u),u}finally{xe(s)}}function Gu(e,t,i){var n=e+20,r=Yt(),o=xt(r,n);return Vu(r,Wu(r,n)?Fu(r,ti(),t,o.transform,i,o):o.transform(i))}function Bu(e,t,i,n){var r=e+20,o=Yt(),s=xt(o,r);return Vu(o,Wu(o,r)?Uu(o,ti(),t,s.transform,i,n,s):s.transform(i,n))}function Wu(e,t){return e[1].data[t].pure}function Vu(e,t){return Ps.isWrapped(t)&&(t=Ps.unwrap(t),e[ii()]=lo),t}function zu(e){return function(t){setTimeout(e,void 0,t)}}var Yu=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return p(this,i),(e=t.call(this)).__isAsync=n,e}return S(i,[{key:"emit",value:function(e){u(v(i.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,n){var r,o,s,a=e,c=t||function(){return null},l=n;if(e&&"object"==typeof e){var h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),c=null===(o=h.error)||void 0===o?void 0:o.bind(h),l=null===(s=h.complete)||void 0===s?void 0:s.bind(h)}this.__isAsync&&(c=zu(c),a&&(a=zu(a)),l&&(l=zu(l)));var d=u(v(i.prototype),"subscribe",this).call(this,{next:a,error:c,complete:l});return e instanceof C&&e.add(d),d}}]),i}(U);function ju(){return this._results[ws()]()}var Ku=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];p(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var i=ws(),n=e.prototype;n[i]||(n[i]=ju)}return S(e,[{key:"changes",get:function(){return this._changes||(this._changes=new Yu)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var i=this;i.dirty=!1;var n=ln(e);(this._changesDetected=!function(e,t,i){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var r=e[n],o=t[n];if(i&&(r=i(r),o=i(o)),o!==r)return!1}return!0}(i._results,n,t))&&(i._results=n,i.length=n.length,i.last=n[this.length-1],i.first=n[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var Qu=function(){function e(t){p(this,e),this.queryList=t,this.matches=null}return S(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),qu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];p(this,e),this.queries=t}return S(e,[{key:"createEmbeddedView",value:function(t){var i=t.queries;if(null!==i){for(var n=null!==t.contentQueries?t.contentQueries[0]:i.length,r=[],o=0;o<n;o++){var s=i.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new e(r)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==cc(e,t).matches&&this.queries[t].setDirty()}}]),e}(),Xu=function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;p(this,e),this.predicate=t,this.flags=i,this.read=n},Zu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];p(this,e),this.queries=t}return S(e,[{key:"elementStart",value:function(e,t){for(var i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var i=null,n=0;n<this.length;n++){var r=null!==i?i.length:0,o=this.getByIndex(n).embeddedTView(t,r);o&&(o.indexInDeclarationView=n,null!==i?i.push(o):i=[o])}return null!==i?new e(i):null}},{key:"template",value:function(e,t){for(var i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),$u=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;p(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=i}return S(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,i){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,i),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,i=e.parent;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var i=this.metadata.predicate;if(Array.isArray(i))for(var n=0;n<i.length;n++){var r=i[n];this.matchTNodeWithReadOption(e,t,Ju(t,r)),this.matchTNodeWithReadOption(e,t,Xi(t,e,r,!1,!1))}else i===fu?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Xi(t,e,i,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,i){if(null!==i){var n=this.metadata.read;if(null!==n)if(n===Ua||n===yu||n===fu&&4&t.type)this.addMatch(t.index,-2);else{var r=Xi(t,e,n,!1,!1);null!==r&&this.addMatch(t.index,r)}else this.addMatch(t.index,i)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function Ju(e,t){var i=e.localNames;if(null!==i)for(var n=0;n<i.length;n+=2)if(i[n]===t)return i[n+1];return null}function ec(e,t,i,n){return-1===i?function(e,t){return 11&e.type?xa(e,t):4&e.type?pu(e,t):null}(t,e):-2===i?function(e,t,i){return i===Ua?xa(t,e):i===fu?pu(t,e):i===yu?Iu(t,e):void 0}(e,t,n):Zi(e,e[1],i,t)}function tc(e,t,i,n){var r=t[19].queries[n];if(null===r.matches){for(var o=e.data,s=i.matches,a=[],u=0;u<s.length;u+=2){var c=s[u];a.push(c<0?null:ec(t,o[c],s[u+1],i.metadata.read))}r.matches=a}return r.matches}function ic(e,t,i,n){var r=e.queries.getByIndex(i),o=r.matches;if(null!==o)for(var s=tc(e,t,r,i),a=0;a<o.length;a+=2){var u=o[a];if(u>0)n.push(s[a/2]);else{for(var c=o[a+1],l=t[-u],h=10;h<l.length;h++){var d=l[h];d[17]===d[3]&&ic(d[1],d,c,n)}if(null!==l[9])for(var g=l[9],f=0;f<g.length;f++){var v=g[f];ic(v[1],v,c,n)}}}return n}function nc(e){var t=Yt(),i=jt(),n=ai();ui(n+1);var r=cc(i,n);if(e.dirty&&Ut(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{var o=r.crossesNgTemplate?ic(i,t,n,[]):tc(i,t,r,n);e.reset(o,Ha),e.notifyOnChanges()}return!0}return!1}function rc(e,t,i){var n=jt();n.firstCreatePass&&(uc(n,new Xu(e,t,i),-1),2==(2&t)&&(n.staticViewQueries=!0)),ac(n,Yt(),t)}function oc(e,t,i,n){var r=jt();if(r.firstCreatePass){var o=Qt();uc(r,new Xu(t,i,n),o.index),function(e,t){var i=e.contentQueries||(e.contentQueries=[]);t!==(i.length?i[i.length-1]:-1)&&i.push(e.queries.length-1,t)}(r,e),2==(2&i)&&(r.staticContentQueries=!0)}ac(r,Yt(),i)}function sc(){return function(e,t){return e[19].queries[t].queryList}(Yt(),ai())}function ac(e,t,i){var n=new Ku(4==(4&i));Mo(e,t,n,n.destroy),null===t[19]&&(t[19]=new qu),t[19].queries.push(new Qu(n))}function uc(e,t,i){null===e.queries&&(e.queries=new Zu),e.queries.track(new $u(t,i))}function cc(e,t){return e.queries.getByIndex(t)}var lc=new an("Application Initializer"),hc=function(){var e=function(){function e(t){var i=this;p(this,e),this.appInits=t,this.resolve=La,this.reject=La,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){i.resolve=e,i.reject=t})}return S(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],i=function(){e.done=!0,e.resolve()};if(this.appInits)for(var n=function(i){var n=e.appInits[i]();if(Xs(n))t.push(n);else if(Zs(n)){var r=new Promise(function(e,t){n.subscribe({complete:e,error:t})});t.push(r)}},r=0;r<this.appInits.length;r++)n(r);Promise.all(t).then(function(){i()}).catch(function(t){e.reject(t)}),0===t.length&&i(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(lc,8))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),dc=new an("AppId"),gc={provide:dc,useFactory:function(){return"".concat(fc()).concat(fc()).concat(fc())},deps:[]};function fc(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var vc=new an("Platform Initializer"),pc=new an("Platform ID"),mc=new an("appBootstrapListener"),Sc=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Ec=new an("LocaleId"),yc=new an("DefaultCurrencyCode"),Rc=function e(t,i){p(this,e),this.ngModuleFactory=t,this.componentFactories=i},Oc=function(e){return new Mu(e)},Tc=Oc,Ic=function(e){return Promise.resolve(Oc(e))},bc=function(e){var t=Oc(e),i=Ir(ht(e).declarations).reduce(function(e,t){var i=lt(t);return i&&e.push(new Nu(i)),e},[]);return new Rc(t,i)},Cc=bc,Ac=function(e){return Promise.resolve(bc(e))},kc=function(){var e=function(){function e(){p(this,e),this.compileModuleSync=Tc,this.compileModuleAsync=Ic,this.compileModuleAndAllComponentsSync=Cc,this.compileModuleAndAllComponentsAsync=Ac}return S(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Nc=Promise.resolve(0);function _c(e){"undefined"==typeof Zone?Nc.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var wc=function(){function e(t){var i=t.enableLongStackTrace,n=void 0!==i&&i,r=t.shouldCoalesceEventChangeDetection,o=void 0!==r&&r,s=t.shouldCoalesceRunChangeDetection,a=void 0!==s&&s;if(p(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yu(!1),this.onMicrotaskEmpty=new Yu(!1),this.onStable=new Yu(!1),this.onError=new Yu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!a&&o,u.shouldCoalesceRunChangeDetection=a,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=Ye.requestAnimationFrame,t=Ye.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);var n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Ye,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,Dc(e),e.isCheckStableRunning=!0,Mc(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),Dc(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(i,n,r,o,s,a){try{return Lc(e),i.invokeTask(r,o,s,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||e.shouldCoalesceRunChangeDetection)&&t(),xc(e)}},onInvoke:function(i,n,r,o,s,a,u){try{return Lc(e),i.invoke(r,o,s,a,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),xc(e)}},onHasTask:function(t,i,n,r){t.hasTask(n,r),i===n&&("microTask"==r.change?(e._hasPendingMicrotasks=r.microTask,Dc(e),Mc(e)):"macroTask"==r.change&&(e.hasPendingMacrotasks=r.macroTask))},onHandleError:function(t,i,n,r){return t.handleError(n,r),e.runOutsideAngular(function(){return e.onError.emit(r)}),!1}})}(u)}return S(e,[{key:"run",value:function(e,t,i){return this._inner.run(e,t,i)}},{key:"runTask",value:function(e,t,i,n){var r=this._inner,o=r.scheduleEventTask("NgZoneEvent: "+n,e,Pc,La,La);try{return r.runTask(o,t,i)}finally{r.cancelTask(o)}}},{key:"runGuarded",value:function(e,t,i){return this._inner.runGuarded(e,t,i)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),Pc={};function Mc(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function Dc(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Lc(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function xc(e){e._nesting--,Mc(e)}var Fc,Uc=function(){function e(){p(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Yu,this.onMicrotaskEmpty=new Yu,this.onStable=new Yu,this.onError=new Yu}return S(e,[{key:"run",value:function(e,t,i){return e.apply(t,i)}},{key:"runGuarded",value:function(e,t,i){return e.apply(t,i)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,i,n){return e.apply(t,i)}}]),e}(),Hc=function(){var e=function(){function e(t){var i=this;p(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){i.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return S(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){wc.assertNotInAngularZone(),_c(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())_c(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,i){var n=this,r=-1;t&&t>0&&(r=setTimeout(function(){n._callbacks=n._callbacks.filter(function(e){return e.timeoutId!==r}),e(n._didWork,n.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:i})}},{key:"whenStable",value:function(e,t,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,i),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,i){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(wc))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Gc=function(){var e=function(){function e(){p(this,e),this._applications=new Map,Bc.addToWindow(this)}return S(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Bc.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Bc=new(function(){function e(){p(this,e)}return S(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,i){return null}}]),e}()),Wc=!0,Vc=!1;function zc(){return Vc=!0,Wc}var Yc=new an("AllowMultipleToken"),jc=function e(t,i){p(this,e),this.name=t,this.token=i};function Kc(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n="Platform: ".concat(t),r=new an(n);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=Qc();if(!o||o.injector.get(Yc,!1))if(e)e(i.concat(t).concat({provide:r,useValue:!0}));else{var s=i.concat(t).concat({provide:r,useValue:!0},{provide:hs,useValue:"platform"});!function(e){if(Fc&&!Fc.destroyed&&!Fc.injector.get(Yc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Fc=e.get(qc);var t=e.get(vc,null);t&&t.forEach(function(e){return e()})}(Ts.create({providers:s,name:n}))}return function(e){var t=Qc();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function Qc(){return Fc&&!Fc.destroyed?Fc:null}var qc=function(){var e=function(){function e(t){p(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return S(e,[{key:"bootstrapModuleFactory",value:function(e,t){var i=this,n=function(e,t){return"noop"===e?new Uc:("zone.js"===e?void 0:e)||new wc({enableLongStackTrace:zc(),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),r=[{provide:wc,useValue:n}];return n.run(function(){var o=Ts.create({providers:r,parent:i.injector,name:e.moduleType.name}),s=e.create(o),a=s.injector.get(yr,null);if(!a)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(function(){var e=n.onError.subscribe({next:function(e){a.handleError(e)}});s.onDestroy(function(){$c(i._modules,s),e.unsubscribe()})}),function(e,n,r){try{var o=((a=s.injector.get(hc)).runInitializers(),a.donePromise.then(function(){return Ia(s.injector.get(Ec,Ta)||Ta),i._moduleDoBootstrap(s),s}));return Xs(o)?o.catch(function(t){throw n.runOutsideAngular(function(){return e.handleError(t)}),t}):o}catch(t){throw n.runOutsideAngular(function(){return e.handleError(t)}),t}var a}(a,n)})}},{key:"bootstrapModule",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Xc({},i);return function(e,t,i){var n=new Mu(i);return Promise.resolve(n)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,n)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(Zc);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(ve(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Ts))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}();function Xc(e,t){return Array.isArray(t)?t.reduce(Xc,e):Object.assign(Object.assign({},e),t)}var Zc=function(){var e=function(){function e(t,i,n,r,o){var s=this;p(this,e),this._zone=t,this._injector=i,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run(function(){s.tick()})}});var a=new M(function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular(function(){e.next(s._stable),e.complete()})}),u=new M(function(e){var t;s._zone.runOutsideAngular(function(){t=s._zone.onStable.subscribe(function(){wc.assertNotInAngularZone(),_c(function(){!s._stable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks&&(s._stable=!0,e.next(!0))})})});var i=s._zone.onUnstable.subscribe(function(){wc.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),i.unsubscribe()}});this.isStable=oe(a,u.pipe(function(e){return se()(function(e,t){return function(t){var i;i="function"==typeof e?e:function(){return e};var n=Object.create(t,le);return n.source=t,n.subjectFactory=i,n}}(de)(e))}))}return S(e,[{key:"bootstrap",value:function(e,t){var i,n=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");i=e instanceof Ma?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(i.componentType);var r=function(e){return e.isBoundToModule}(i)?void 0:this._injector.get(mu),o=i.create(Ts.NULL,[],t||i.selector,r),s=o.location.nativeElement,a=o.injector.get(Hc,null),u=a&&o.injector.get(Gc);return a&&u&&u.registerApplication(s,a),o.onDestroy(function(){n.detachView(o.hostView),$c(n.components,o),u&&u.unregisterApplication(s)}),this._loadComponent(o),o}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,i=n(this._views);try{for(i.s();!(t=i.n()).done;){var r;t.value.detectChanges()}}catch(o){i.e(o)}finally{i.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;$c(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(mc,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(wc),An(Ts),An(yr),An(Da),An(hc))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}();function $c(e,t){var i=e.indexOf(t);i>-1&&e.splice(i,1)}var Jc=function e(){p(this,e)},el=function e(){p(this,e)},tl={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},il=function(){var e=function(){function e(t,i){p(this,e),this._compiler=t,this._config=i||tl}return S(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var i=this,n=t(e.split("#"),2),r=n[0],o=n[1];return void 0===o&&(o="default"),l(98255)(r).then(function(e){return e[o]}).then(function(e){return nl(e,r,o)}).then(function(e){return i._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var i=t(e.split("#"),2),n=i[0],r=i[1],o="NgFactory";return void 0===r&&(r="default",o=""),l(98255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+o]}).then(function(e){return nl(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(kc),An(el,8))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}();function nl(e,t,i){if(!e)throw new Error("Cannot find '".concat(i,"' in '").concat(t,"'"));return e}var rl=Kc(null,"core",[{provide:pc,useValue:"unknown"},{provide:qc,deps:[Ts]},{provide:Gc,deps:[]},{provide:Sc,deps:[]}]),ol=[{provide:Zc,useClass:Zc,deps:[wc,Ts,yr,Da,hc]},{provide:ku,deps:[wc],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:hc,useClass:hc,deps:[[new xn,lc]]},{provide:kc,useClass:kc,deps:[]},gc,{provide:iu,useFactory:function(){return hu},deps:[]},{provide:ru,useFactory:function(){return du},deps:[]},{provide:Ec,useFactory:function(e){return Ia(e=e||"undefined"!=typeof $localize&&$localize.locale||Ta),e},deps:[[new Ln(Ec),new xn,new Fn]]},{provide:yc,useValue:"USD"}],sl=function(){var e=function e(t){p(this,e)};return e.\u0275fac=function(t){return new(t||e)(An(Zc))},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({providers:ol}),e}(),al=null;function ul(){return al}var cl=new an("DocumentToken"),ll=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({factory:hl,token:e,providedIn:"platform"}),e}();function hl(){return An(gl)}var dl=new an("Location Initialized"),gl=function(){var e=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this))._doc=e,n._init(),n}return S(i,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return ul().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=ul().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=ul().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,i){fl()?this._history.pushState(e,t,i):this.location.hash=i}},{key:"replaceState",value:function(e,t,i){fl()?this._history.replaceState(e,t,i):this.location.hash=i}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),i}(ll);return e.\u0275fac=function(t){return new(t||e)(An(cl))},e.\u0275prov=be({factory:vl,token:e,providedIn:"platform"}),e}();function fl(){return!!window.history.pushState}function vl(){return new gl(An(cl))}function pl(e,t){if(0==e.length)return t;if(0==t.length)return e;var i=0;return e.endsWith("/")&&i++,t.startsWith("/")&&i++,2==i?e+t.substring(1):1==i?e+t:e+"/"+t}function ml(e){var t=e.match(/#|\?|$/),i=t&&t.index||e.length;return e.slice(0,i-("/"===e[i-1]?1:0))+e.slice(i)}function Sl(e){return e&&"?"!==e[0]?"?"+e:e}var El=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({factory:yl,token:e,providedIn:"root"}),e}();function yl(e){var t=An(cl).location;return new Ol(An(ll),t&&t.origin||"")}var Rl=new an("appBaseHref"),Ol=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n){var r;if(p(this,i),(r=t.call(this))._platformLocation=e,r._removeListenerFns=[],null==n&&(n=r._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return r._baseHref=n,d(r)}return S(i,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return pl(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+Sl(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?"".concat(t).concat(i):t}},{key:"pushState",value:function(e,t,i,n){var r=this.prepareExternalUrl(i+Sl(n));this._platformLocation.pushState(e,t,r)}},{key:"replaceState",value:function(e,t,i,n){var r=this.prepareExternalUrl(i+Sl(n));this._platformLocation.replaceState(e,t,r)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,i)}}]),i}(El);return e.\u0275fac=function(t){return new(t||e)(An(ll),An(Rl,8))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Tl=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this))._platformLocation=e,r._baseHref="",r._removeListenerFns=[],null!=n&&(r._baseHref=n),r}return S(i,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=pl(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,i,n){var r=this.prepareExternalUrl(i+Sl(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(e,t,r)}},{key:"replaceState",value:function(e,t,i,n){var r=this.prepareExternalUrl(i+Sl(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,r)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,i)}}]),i}(El);return e.\u0275fac=function(t){return new(t||e)(An(ll),An(Rl,8))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Il=function(){var e=function(){function e(t,i){var n=this;p(this,e),this._subject=new Yu,this._urlChangeListeners=[],this._platformStrategy=t;var r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=ml(Cl(r)),this._platformStrategy.onPopState(function(e){n._subject.emit({url:n.path(!0),pop:!0,state:e.state,type:e.type})})}return S(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+Sl(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,Cl(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Sl(t)),i)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Sl(t)),i)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,i)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(i){return i(e,t)})}},{key:"subscribe",value:function(e,t,i){return this._subject.subscribe({next:e,error:t,complete:i})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(El),An(ll))},e.normalizeQueryParams=Sl,e.joinWithSlash=pl,e.stripTrailingSlash=ml,e.\u0275prov=be({factory:bl,token:e,providedIn:"root"}),e}();function bl(){return new Il(An(El),An(ll))}function Cl(e){return e.replace(/\/index.html$/,"")}var Al=((Al=Al||{})[Al.Decimal=0]="Decimal",Al[Al.Percent=1]="Percent",Al[Al.Currency=2]="Currency",Al[Al.Scientific=3]="Scientific",Al),kl=((kl=kl||{})[kl.Zero=0]="Zero",kl[kl.One=1]="One",kl[kl.Two=2]="Two",kl[kl.Few=3]="Few",kl[kl.Many=4]="Many",kl[kl.Other=5]="Other",kl),Nl=((Nl=Nl||{})[Nl.Decimal=0]="Decimal",Nl[Nl.Group=1]="Group",Nl[Nl.List=2]="List",Nl[Nl.PercentSign=3]="PercentSign",Nl[Nl.PlusSign=4]="PlusSign",Nl[Nl.MinusSign=5]="MinusSign",Nl[Nl.Exponential=6]="Exponential",Nl[Nl.SuperscriptingExponent=7]="SuperscriptingExponent",Nl[Nl.PerMille=8]="PerMille",Nl[Nl.Infinity=9]="Infinity",Nl[Nl.NaN=10]="NaN",Nl[Nl.TimeSeparator=11]="TimeSeparator",Nl[Nl.CurrencyDecimal=12]="CurrencyDecimal",Nl[Nl.CurrencyGroup=13]="CurrencyGroup",Nl);function _l(e,t){var i=ya(e),n=i[Oa.NumberSymbols][t];if(void 0===n){if(t===Nl.CurrencyDecimal)return i[Oa.NumberSymbols][Nl.Decimal];if(t===Nl.CurrencyGroup)return i[Oa.NumberSymbols][Nl.Group]}return n}var wl=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Pl(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var Ml=function e(){p(this,e)},Dl=function(){var e=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this)).locale=e,n}return S(i,[{key:"getPluralCategory",value:function(e,t){switch(function(e){return ya(e)[Oa.PluralCase]}(t||this.locale)(e)){case kl.Zero:return"zero";case kl.One:return"one";case kl.Two:return"two";case kl.Few:return"few";case kl.Many:return"many";default:return"other"}}}]),i}(Ml);return e.\u0275fac=function(t){return new(t||e)(An(Ec))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}();function Ll(e,i){i=encodeURIComponent(i);var r,o=n(e.split(";"));try{for(o.s();!(r=o.n()).done;){var s=r.value,a=s.indexOf("="),u=t(-1==a?[s,""]:[s.slice(0,a),s.slice(a+1)],2),c=u[0],l=u[1];if(c.trim()===i)return decodeURIComponent(l)}}catch(h){o.e(h)}finally{o.f()}return null}var xl=function(){var e=function(){function e(t,i,n,r){p(this,e),this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return S(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Ms(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(ve(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(i){return t._toggleClass(i,!!e[i])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var i=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?i._renderer.addClass(i._ngEl.nativeElement,e):i._renderer.removeClass(i._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(iu),Bs(ru),Bs(Ua),Bs(Ba))},e.\u0275dir=ut({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),Fl=function(){function e(t,i,n,r){p(this,e),this.$implicit=t,this.ngForOf=i,this.index=n,this.count=r}return S(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),Ul=function(){var e=function(){function e(t,i,n){p(this,e),this._viewContainer=t,this._template=i,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return S(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(i){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,i=[];e.forEachOperation(function(e,n,r){if(null==e.previousIndex){var o=t._viewContainer.createEmbeddedView(t._template,new Fl(null,t._ngForOf,-1,-1),null===r?void 0:r),s=new Hl(e,o);i.push(s)}else if(null==r)t._viewContainer.remove(null===n?void 0:n);else if(null!==n){var a=t._viewContainer.get(n);t._viewContainer.move(a,r);var u=new Hl(e,a);i.push(u)}});for(var n=0;n<i.length;n++)this._perViewChange(i[n].view,i[n].record);for(var r=0,o=this._viewContainer.length;r<o;r++){var s=this._viewContainer.get(r);s.context.index=r,s.context.count=o,s.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(yu),Bs(fu),Bs(iu))},e.\u0275dir=ut({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),Hl=function e(t,i){p(this,e),this.record=t,this.view=i},Gl=function(){var e=function(){function e(t,i){p(this,e),this._viewContainer=t,this._context=new Bl,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}return S(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){Wl("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){Wl("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(yu),Bs(fu))},e.\u0275dir=ut({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),Bl=function e(){p(this,e),this.$implicit=null,this.ngIf=null};function Wl(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(ve(t),"'."))}var Vl=function(){function e(t,i){p(this,e),this._viewContainerRef=t,this._templateRef=i,this._created=!1}return S(e,[{key:"create",value:function(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}},{key:"destroy",value:function(){this._created=!1,this._viewContainerRef.clear()}},{key:"enforceState",value:function(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}]),e}(),zl=function(){var e=function(){function e(){p(this,e),this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}return S(e,[{key:"ngSwitch",set:function(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}},{key:"_addCase",value:function(){return this._caseCount++}},{key:"_addDefault",value:function(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}},{key:"_matchCase",value:function(e){var t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}},{key:"_updateDefaultCases",value:function(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(var t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=ut({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),e}(),Yl=function(){var e=function(){function e(t,i,n){p(this,e),this.ngSwitch=n,n._addCase(),this._view=new Vl(t,i)}return S(e,[{key:"ngDoCheck",value:function(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(yu),Bs(fu),Bs(zl,9))},e.\u0275dir=ut({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),e}(),jl=function(){var e=function(){function e(t,i,n){p(this,e),this._ngEl=t,this._differs=i,this._renderer=n,this._ngStyle=null,this._differ=null}return S(e,[{key:"ngStyle",set:function(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}},{key:"ngDoCheck",value:function(){if(this._differ){var e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}},{key:"_setStyle",value:function(e,i){var n=t(e.split("."),2),r=n[0],o=n[1];null!=(i=null!=i&&o?"".concat(i).concat(o):i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}},{key:"_applyChanges",value:function(e){var t=this;e.forEachRemovedItem(function(e){return t._setStyle(e.key,null)}),e.forEachAddedItem(function(e){return t._setStyle(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._setStyle(e.key,e.currentValue)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ua),Bs(ru),Bs(Ba))},e.\u0275dir=ut({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),e}();function Kl(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(ve(e),"'"))}var Ql=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])\S*/g,ql=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"transform",value:function(t){if(null==t)return null;if("string"!=typeof t)throw Kl(e,t);return t.replace(Ql,function(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=ct({name:"titlecase",type:e,pure:!0}),e}(),Xl=function(){var e=function(){function e(t){p(this,e),this.differs=t,this.keyValues=[],this.compareFn=Zl}return S(e,[{key:"transform",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zl;if(!e||!(e instanceof Map)&&"object"!=typeof e)return null;this.differ||(this.differ=this.differs.find(e).create());var n=this.differ.diff(e),r=i!==this.compareFn;return n&&(this.keyValues=[],n.forEachItem(function(e){t.keyValues.push(function(e,t){return{key:e,value:t}}(e.key,e.currentValue))})),(n||r)&&(this.keyValues.sort(i),this.compareFn=i),this.keyValues}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(ru,16))},e.\u0275pipe=ct({name:"keyvalue",type:e,pure:!1}),e}();function Zl(e,t){var i=e.key,n=t.key;if(i===n)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(null===i)return 1;if(null===n)return-1;if("string"==typeof i&&"string"==typeof n)return i<n?-1:1;if("number"==typeof i&&"number"==typeof n)return i-n;if("boolean"==typeof i&&"boolean"==typeof n)return i<n?-1:1;var r=String(i),o=String(n);return r==o?0:r<o?-1:1}var $l=function(){var e=function(){function e(t){p(this,e),this._locale=t}return S(e,[{key:"transform",value:function(t,i,n){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;n=n||this._locale;try{return function(e,t,i){return function(e,t,i,n,r,o){var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a="",u=!1;if(isFinite(e)){var c=function(e){var t,i,n,r,o,s=Math.abs(e)+"",a=0;for((i=s.indexOf("."))>-1&&(s=s.replace(".","")),(n=s.search(/e/i))>0?(i<0&&(i=n),i+=+s.slice(n+1),s=s.substring(0,n)):i<0&&(i=s.length),n=0;"0"===s.charAt(n);n++);if(n===(o=s.length))t=[0],i=1;else{for(o--;"0"===s.charAt(o);)o--;for(i-=n,t=[],r=0;n<=o;n++,r++)t[r]=Number(s.charAt(n))}return i>22&&(t=t.splice(0,21),a=i-1,i=1),{digits:t,exponent:a,integerLen:i}}(e);s&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,h=t.minFrac,d=t.maxFrac;if(o){var g=o.match(wl);if(null===g)throw new Error("".concat(o," is not a valid digit info"));var f=g[1],v=g[3],p=g[5];null!=f&&(l=Pl(f)),null!=v&&(h=Pl(v)),null!=p?d=Pl(p):null!=v&&h>d&&(d=h)}!function(e,t,i){if(t>i)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(i,")."));var n=e.digits,r=n.length-e.integerLen,o=Math.min(Math.max(t,r),i),s=o+e.integerLen,a=n[s];if(s>0){n.splice(Math.max(e.integerLen,s));for(var u=s;u<n.length;u++)n[u]=0}else{r=Math.max(0,r),e.integerLen=1,n.length=Math.max(1,s=o+1),n[0]=0;for(var c=1;c<s;c++)n[c]=0}if(a>=5)if(s-1<0){for(var l=0;l>s;l--)n.unshift(0),e.integerLen++;n.unshift(1),e.integerLen++}else n[s-1]++;for(;r<Math.max(0,o);r++)n.push(0);var h=0!==o,d=t+e.integerLen,g=n.reduceRight(function(e,t,i,n){return n[i]=(t+=e)<10?t:t-10,h&&(0===n[i]&&i>=d?n.pop():h=!1),t>=10?1:0},0);g&&(n.unshift(g),e.integerLen++)}(c,h,d);var m=c.digits,S=c.integerLen,E=c.exponent,y=[];for(u=m.every(function(e){return!e});S<l;S++)m.unshift(0);for(;S<0;S++)m.unshift(0);S>0?y=m.splice(S,m.length):(y=m,m=[0]);var R=[];for(m.length>=t.lgSize&&R.unshift(m.splice(-t.lgSize,m.length).join(""));m.length>t.gSize;)R.unshift(m.splice(-t.gSize,m.length).join(""));m.length&&R.unshift(m.join("")),a=R.join(_l(i,n)),y.length&&(a+=_l(i,r)+y.join("")),E&&(a+=_l(i,Nl.Exponential)+"+"+E)}else a=_l(i,Nl.Infinity);return a=e<0&&!u?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",i={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=e.split(";"),r=n[0],o=n[1],s=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],a=s[0],u=s[1]||"";i.posPre=a.substr(0,a.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?i.minFrac=i.maxFrac=c+1:"#"===l?i.maxFrac=c+1:i.posSuf+=l}var h=a.split(",");if(i.gSize=h[1]?h[1].length:0,i.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,o){var d=r.length-i.posPre.length-i.posSuf.length,g=o.indexOf("#");i.negPre=o.substr(0,g).replace(/'/g,""),i.negSuf=o.substr(g+d).replace(/'/g,"")}else i.negPre=t+i.posPre,i.negSuf=i.posSuf;return i}(function(e,t){return ya(e)[Oa.NumberFormats][t]}(t,Al.Decimal),_l(t,Nl.MinusSign)),t,Nl.Group,Nl.Decimal,i)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),n,i)}catch(r){throw Kl(e,r.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ec,16))},e.\u0275pipe=ct({name:"number",type:e,pure:!0}),e}(),Jl=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({providers:[{provide:Ml,useClass:Dl}]}),e}(),eh="browser",th=function(){var e=function e(){p(this,e)};return e.\u0275prov=be({token:e,providedIn:"root",factory:function(){return new ih(An(cl),window)}}),e}(),ih=function(){function e(t,i){p(this,e),this.document=t,this.window=i,this.offset=function(){return[0,0]}}return S(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var i=e.getElementById(t)||e.getElementsByName(t)[0];if(i)return i;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var n=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),r=n.currentNode;r;){var o=r.shadowRoot;if(o){var s=o.getElementById(t)||o.querySelector('[name="'.concat(t,'"]'));if(s)return s}r=n.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,n=t.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(i-r[0],n-r[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=nh(this.window.history)||nh(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function nh(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var rh,oh=function e(){p(this,e)},sh=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"onAndCancel",value:function(e,t,i){return e.addEventListener(t,i,!1),function(){e.removeEventListener(t,i,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(ah=ah||document.querySelector("base"))?ah.getAttribute("href"):null;return null==t?null:function(e){(rh=rh||document.createElement("a")).setAttribute("href",e);var t=rh.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){ah=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return Ll(document.cookie,e)}}],[{key:"makeCurrent",value:function(){!function(e){al||(al=e)}(new i)}}]),i}(function(e){c(i,e);var t=h(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return i}(function(){return function e(){p(this,e)}}())),ah=null,uh=new an("TRANSITION_ID"),ch=[{provide:lc,useFactory:function(e,t,i){return function(){i.get(hc).donePromise.then(function(){var i=ul();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(function(t){return t.getAttribute("ng-transition")===e}).forEach(function(e){return i.remove(e)})})}},deps:[uh,cl,Ts],multi:!0}],lh=function(){function e(){p(this,e)}return S(e,[{key:"addToWindow",value:function(e){Ye.getAngularTestability=function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.findTestabilityInTree(t,i);if(null==n)throw new Error("Could not find testability for element.");return n},Ye.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Ye.getAllAngularRootElements=function(){return e.getAllRootElements()},Ye.frameworkStabilizers||(Ye.frameworkStabilizers=[]),Ye.frameworkStabilizers.push(function(e){var t=Ye.getAllAngularTestabilities(),i=t.length,n=!1,r=function(t){n=n||t,0==--i&&e(n)};t.forEach(function(e){e.whenStable(r)})})}},{key:"findTestabilityInTree",value:function(e,t,i){if(null==t)return null;var n=e.getTestability(t);return null!=n?n:i?ul().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){!function(e){Bc=e}(new e)}}]),e}(),hh=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),dh=new an("EventManagerPlugins"),gh=function(){var e=function(){function e(t,i){var n=this;p(this,e),this._zone=i,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=n}),this._plugins=t.slice().reverse()}return S(e,[{key:"addEventListener",value:function(e,t,i){return this._findPluginFor(t).addEventListener(e,t,i)}},{key:"addGlobalEventListener",value:function(e,t,i){return this._findPluginFor(t).addGlobalEventListener(e,t,i)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var i=this._plugins,n=0;n<i.length;n++){var r=i[n];if(r.supports(e))return this._eventNameToPlugin.set(e,r),r}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(dh),An(wc))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),fh=function(){function e(t){p(this,e),this._doc=t}return S(e,[{key:"addGlobalEventListener",value:function(e,t,i){var n=ul().getGlobalEventTarget(this._doc,e);if(!n)throw new Error("Unsupported event target ".concat(n," for event ").concat(t));return this.addEventListener(n,t,i)}}]),e}(),vh=function(){var e=function(){function e(){p(this,e),this._stylesSet=new Set}return S(e,[{key:"addStyles",value:function(e){var t=this,i=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),i.add(e))}),this.onStylesAdded(i)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),ph=function(){var e=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this))._doc=e,n._hostNodes=new Map,n._hostNodes.set(e.head,[]),n}return S(i,[{key:"_addStylesToHost",value:function(e,t,i){var n=this;e.forEach(function(e){var r=n._doc.createElement("style");r.textContent=e,i.push(t.appendChild(r))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(mh),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(i,n){t._addStylesToHost(e,n,i)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(mh)})}}]),i}(vh);return e.\u0275fac=function(t){return new(t||e)(An(cl))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}();function mh(e){ul().remove(e)}var Sh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Eh=/%COMP%/g;function yh(e,t,i){for(var n=0;n<t.length;n++){var r=t[n];Array.isArray(r)?yh(e,r,i):(r=r.replace(Eh,e),i.push(r))}return i}function Rh(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var Oh=function(){var e=function(){function e(t,i,n){p(this,e),this.eventManager=t,this.sharedStylesHost=i,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Th(t)}return S(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ge.Emulated:var i=this.rendererByCompId.get(t.id);return i||(i=new Ih(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,i)),i.applyToHost(e),i;case 1:case Ge.ShadowDom:return new bh(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var n=yh(t.id,t.styles,[]);this.sharedStylesHost.addStyles(n),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(gh),An(ph),An(dc))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Th=function(){function e(t){p(this,e),this.eventManager=t,this.data=Object.create(null)}return S(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(Sh[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,i){e&&e.insertBefore(t,i)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(i.textContent=""),i}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,i,n){if(n){t=n+":"+t;var r=Sh[n];r?e.setAttributeNS(r,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}},{key:"removeAttribute",value:function(e,t,i){if(i){var n=Sh[i];n?e.removeAttributeNS(n,t):e.removeAttribute("".concat(i,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,i,n){n&(br.DashCase|br.Important)?e.style.setProperty(t,i,n&br.Important?"important":""):e.style[t]=i}},{key:"removeStyle",value:function(e,t,i){i&br.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,i){e[t]=i}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Rh(i)):this.eventManager.addEventListener(e,t,Rh(i))}}]),e}(),Ih=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;p(this,i),(s=t.call(this,e)).component=r;var a=yh(o+"-"+r.id,r.styles,[]);return n.addStyles(a),s.contentAttr=function(e){return"_ngcontent-%COMP%".replace(Eh,e)}(o+"-"+r.id),s.hostAttr=function(e){return"_nghost-%COMP%".replace(Eh,e)}(o+"-"+r.id),s}return S(i,[{key:"applyToHost",value:function(e){u(v(i.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var n=u(v(i.prototype),"createElement",this).call(this,e,t);return u(v(i.prototype),"setAttribute",this).call(this,n,this.contentAttr,""),n}}]),i}(Th),bh=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;p(this,i),(s=t.call(this,e)).sharedStylesHost=n,s.hostEl=r,s.shadowRoot=r.attachShadow({mode:"open"}),s.sharedStylesHost.addHost(s.shadowRoot);for(var a=yh(o.id,o.styles,[]),u=0;u<a.length;u++){var c=document.createElement("style");c.textContent=a[u],s.shadowRoot.appendChild(c)}return s}return S(i,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return u(v(i.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,n){return u(v(i.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,n)}},{key:"removeChild",value:function(e,t){return u(v(i.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(u(v(i.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),i}(Th),Ch=function(){var e=function(e){c(i,e);var t=h(i);function i(e){return p(this,i),t.call(this,e)}return S(i,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,i){var n=this;return e.addEventListener(t,i,!1),function(){return n.removeEventListener(e,t,i)}}},{key:"removeEventListener",value:function(e,t,i){return e.removeEventListener(t,i)}}]),i}(fh);return e.\u0275fac=function(t){return new(t||e)(An(cl))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Ah=["alt","control","meta","shift"],kh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Nh={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},_h={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},wh=function(){var e=function(e){c(i,e);var t=h(i);function i(e){return p(this,i),t.call(this,e)}return S(i,[{key:"supports",value:function(e){return null!=i.parseEventName(e)}},{key:"addEventListener",value:function(e,t,n){var r=i.parseEventName(t),o=i.eventCallback(r.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return ul().onAndCancel(e,r.domEventName,o)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),n=t.shift();if(0===t.length||"keydown"!==n&&"keyup"!==n)return null;var r=i._normalizeKey(t.pop()),o="";if(Ah.forEach(function(e){var i=t.indexOf(e);i>-1&&(t.splice(i,1),o+=e+".")}),o+=r,0!=t.length||0===r.length)return null;var s={};return s.domEventName=n,s.fullKey=o,s}},{key:"getEventFullKey",value:function(e){var t="",i=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Nh.hasOwnProperty(t)&&(t=Nh[t]))}return kh[t]||t}(e);return" "===(i=i.toLowerCase())?i="space":"."===i&&(i="dot"),Ah.forEach(function(n){n!=i&&_h[n](e)&&(t+=n+".")}),t+=i}},{key:"eventCallback",value:function(e,t,n){return function(r){i.getEventFullKey(r)===e&&n.runGuarded(function(){return t(r)})}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),i}(fh);return e.\u0275fac=function(t){return new(t||e)(An(cl))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),Ph=Kc(rl,"browser",[{provide:pc,useValue:eh},{provide:vc,useValue:function(){sh.makeCurrent(),lh.init()},multi:!0},{provide:cl,useFactory:function(){return function(e){At=e}(document),document},deps:[]}]),Mh=[[],{provide:hs,useValue:"root"},{provide:yr,useFactory:function(){return new yr},deps:[]},{provide:dh,useClass:Ch,multi:!0,deps:[cl,wc,pc]},{provide:dh,useClass:wh,multi:!0,deps:[cl]},[],{provide:Oh,useClass:Oh,deps:[gh,ph,dc]},{provide:Ga,useExisting:Oh},{provide:vh,useExisting:ph},{provide:ph,useClass:ph,deps:[cl]},{provide:Hc,useClass:Hc,deps:[wc]},{provide:gh,useClass:gh,deps:[dh,wc]},{provide:oh,useClass:hh,deps:[]},[]],Dh=function(){var e=function(){function e(t){if(p(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return S(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:dc,useValue:t.appId},{provide:uh,useExisting:dc},ch]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(e,12))},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({providers:Mh,imports:[Jl,sl]}),e}();function Lh(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t[t.length-1];return G(n)?(t.pop(),q(t,n)):re(t)}"undefined"!=typeof window&&window;var xh=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this))._value=e,n}return S(i,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=u(v(i.prototype),"_subscribe",this).call(this,e);return t&&!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new L;return this._value}},{key:"next",value:function(e){u(v(i.prototype),"next",this).call(this,this._value=e)}}]),i}(U),Fh=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"notifyNext",value:function(e,t,i,n,r){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),i}(N),Uh=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this)).parent=e,o.outerValue=n,o.outerIndex=r,o.index=0,o}return S(i,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),i}(N);function Hh(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Uh(e,i,n);if(!r.closed)return t instanceof M?t.subscribe(r):Q(t)(r)}var Gh={},Bh=function(){function e(t){p(this,e),this.resultSelector=t}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new Wh(e,this.resultSelector))}}]),e}(),Wh=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return S(i,[{key:"_next",value:function(e){this.values.push(Gh),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var i=0;i<t;i++)this.add(Hh(this,e[i],void 0,i))}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,i){var n=this.values,r=this.toRespond?n[i]===Gh?--this.toRespond:this.toRespond:0;n[i]=t,0===r&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}]),i}(Fh),Vh=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}();function zh(){return ne(1)(Lh.apply(void 0,arguments))}var Yh=new M(function(e){return e.complete()});function jh(e){return e?function(e){return new M(function(t){return e.schedule(function(){return t.complete()})})}(e):Yh}function Kh(e){return new M(function(t){var i;try{i=e()}catch(n){return void t.error(n)}return(i?X(i):jh()).subscribe(t)})}function Qh(e,t){return"function"==typeof t?function(i){return i.pipe(Qh(function(i,n){return X(e(i,n)).pipe(B(function(e,r){return t(i,e,n,r)}))}))}:function(t){return t.lift(new qh(e))}}var qh=function(){function e(t){p(this,e),this.project=t}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new Xh(e,this.project))}}]),e}(),Xh=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).project=n,r.index=0,r}return S(i,[{key:"_next",value:function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this._innerSub(t)}},{key:"_innerSub",value:function(e){var t=this.innerSubscription;t&&t.unsubscribe();var i=new Z(this),n=this.destination;n.add(i),this.innerSubscription=J(e,i),this.innerSubscription!==i&&n.add(this.innerSubscription)}},{key:"_complete",value:function(){var e=this.innerSubscription;(!e||e.closed)&&u(v(i.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=void 0}},{key:"notifyComplete",value:function(){this.innerSubscription=void 0,this.isStopped&&u(v(i.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e){this.destination.next(e)}}]),i}($),Zh=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}();function $h(e){return function(t){return 0===e?jh():t.lift(new Jh(e))}}var Jh=function(){function e(t){if(p(this,e),this.total=t,this.total<0)throw new Zh}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new ed(e,this.total))}}]),e}(),ed=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).total=n,r.count=0,r}return S(i,[{key:"_next",value:function(e){var t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}]),i}(N);function td(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t[t.length-1];return G(n)?(t.pop(),function(e){return zh(t,e,n)}):function(e){return zh(t,e)}}function id(e,t){var i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new nd(e,t,i))}}var nd=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];p(this,e),this.accumulator=t,this.seed=i,this.hasSeed=n}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new rd(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),rd=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;return p(this,i),(s=t.call(this,e)).accumulator=n,s._seed=r,s.hasSeed=o,s.index=0,s}return S(i,[{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}},{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,i=this.index++;try{t=this.accumulator(this.seed,e,i)}catch(n){this.destination.error(n)}this.seed=t,this.destination.next(t)}}]),i}(N);function od(e,t){return function(i){return i.lift(new sd(e,t))}}var sd=function(){function e(t,i){p(this,e),this.predicate=t,this.thisArg=i}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new ad(e,this.predicate,this.thisArg))}}]),e}(),ad=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,e)).predicate=n,o.thisArg=r,o.count=0,o}return S(i,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}]),i}(N);function ud(e){return function(t){var i=new cd(e),n=t.lift(i);return i.caught=n}}var cd=function(){function e(t){p(this,e),this.selector=t}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new ld(e,this.selector,this.caught))}}]),e}(),ld=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,e)).selector=n,o.caught=r,o}return S(i,[{key:"error",value:function(e){if(!this.isStopped){var t;try{t=this.selector(e,this.caught)}catch(o){return void u(v(i.prototype),"error",this).call(this,o)}this._unsubscribeAndRecycle();var n=new Z(this);this.add(n);var r=J(t,n);r!==n&&this.add(r)}}}]),i}($);function hd(e,t){return ee(e,t,1)}function dd(e){return function(t){return 0===e?jh():t.lift(new gd(e))}}var gd=function(){function e(t){if(p(this,e),this.total=t,this.total<0)throw new Zh}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new fd(e,this.total))}}]),e}(),fd=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).total=n,r.ring=new Array,r.count=0,r}return S(i,[{key:"_next",value:function(e){var t=this.ring,i=this.total,n=this.count++;t.length<i?t.push(e):t[n%i]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var i=this.count>=this.total?this.total:this.count,n=this.ring,r=0;r<i;r++){var o=t++%i;e.next(n[o])}e.complete()}}]),i}(N);function vd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sd;return function(t){return t.lift(new pd(e))}}var pd=function(){function e(t){p(this,e),this.errorFactory=t}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new md(e,this.errorFactory))}}]),e}(),md=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).errorFactory=n,r.hasValue=!1,r}return S(i,[{key:"_next",value:function(e){this.hasValue=!0,this.destination.next(e)}},{key:"_complete",value:function(){if(this.hasValue)return this.destination.complete();var e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}]),i}(N);function Sd(){return new Vh}function Ed(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new yd(e))}}var yd=function(){function e(t){p(this,e),this.defaultValue=t}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new Rd(e,this.defaultValue))}}]),e}(),Rd=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).defaultValue=n,r.isEmpty=!0,r}return S(i,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),i}(N);function Od(e,t){var i=arguments.length>=2;return function(n){return n.pipe(e?od(function(t,i){return e(t,i,n)}):P,$h(1),i?Ed(t):vd(function(){return new Vh}))}}function Td(){}function Id(e,t,i){return function(n){return n.lift(new bd(e,t,i))}}var bd=function(){function e(t,i,n){p(this,e),this.nextOrObserver=t,this.error=i,this.complete=n}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new Cd(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),Cd=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;return p(this,i),(s=t.call(this,e))._tapNext=Td,s._tapError=Td,s._tapComplete=Td,s._tapError=r||Td,s._tapComplete=o||Td,f(n)?(s._context=g(s),s._tapNext=n):n&&(s._context=n,s._tapNext=n.next||Td,s._tapError=n.error||Td,s._tapComplete=n.complete||Td),s}return S(i,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),i}(N),Ad=function(){function e(t){p(this,e),this.callback=t}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new kd(e,this.callback))}}]),e}(),kd=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).add(new C(n)),r}return i}(N),Nd=function e(t,i){p(this,e),this.id=t,this.url=i},_d=function(e){c(i,e);var t=h(i);function i(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return p(this,i),(r=t.call(this,e,n)).navigationTrigger=o,r.restoredState=s,r}return S(i,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),i}(Nd),wd=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,e,n)).urlAfterRedirects=r,o}return S(i,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),i}(Nd),Pd=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,e,n)).reason=r,o}return S(i,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),i}(Nd),Md=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,e,n)).error=r,o}return S(i,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),i}(Nd),Dd=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;return p(this,i),(s=t.call(this,e,n)).urlAfterRedirects=r,s.state=o,s}return S(i,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),i}(Nd),Ld=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;return p(this,i),(s=t.call(this,e,n)).urlAfterRedirects=r,s.state=o,s}return S(i,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),i}(Nd),xd=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a;return p(this,i),(a=t.call(this,e,n)).urlAfterRedirects=r,a.state=o,a.shouldActivate=s,a}return S(i,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),i}(Nd),Fd=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;return p(this,i),(s=t.call(this,e,n)).urlAfterRedirects=r,s.state=o,s}return S(i,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),i}(Nd),Ud=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;return p(this,i),(s=t.call(this,e,n)).urlAfterRedirects=r,s.state=o,s}return S(i,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),i}(Nd),Hd=function(){function e(t){p(this,e),this.route=t}return S(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),Gd=function(){function e(t){p(this,e),this.route=t}return S(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),Bd=function(){function e(t){p(this,e),this.snapshot=t}return S(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Wd=function(){function e(t){p(this,e),this.snapshot=t}return S(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Vd=function(){function e(t){p(this,e),this.snapshot=t}return S(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),zd=function(){function e(t){p(this,e),this.snapshot=t}return S(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Yd=function(){function e(t,i,n){p(this,e),this.routerEvent=t,this.position=i,this.anchor=n}return S(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),jd="primary",Kd=function(){function e(t){p(this,e),this.params=t||{}}return S(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function Qd(e){return new Kd(e)}var qd="ngNavigationCancelingError";function Xd(e){var t=Error("NavigationCancelingError: "+e);return t[qd]=!0,t}function Zd(e,t,i){var n=i.path.split("/");if(n.length>e.length||"full"===i.pathMatch&&(t.hasChildren()||n.length<e.length))return null;for(var r={},o=0;o<n.length;o++){var s=n[o],a=e[o];if(s.startsWith(":"))r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:e.slice(0,n.length),posParams:r}}function $d(e,t){var i,n=e?Object.keys(e):void 0,r=t?Object.keys(t):void 0;if(!n||!r||n.length!=r.length)return!1;for(var o=0;o<n.length;o++)if(!Jd(e[i=n[o]],t[i]))return!1;return!0}function Jd(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=i(e).sort(),r=i(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function eg(e){return Array.prototype.concat.apply([],e)}function tg(e){return e.length>0?e[e.length-1]:null}function ig(e,t){for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)}function ng(e){return Zs(e)?e:Xs(e)?X(Promise.resolve(e)):Lh(e)}var rg={exact:function e(t,i,n){if(!gg(t.segments,i.segments)||!cg(t.segments,i.segments,n)||t.numberOfChildren!==i.numberOfChildren)return!1;for(var r in i.children)if(!t.children[r]||!e(t.children[r],i.children[r],n))return!1;return!0},subset:ag},og={exact:function(e,t){return $d(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(i){return Jd(e[i],t[i])})},ignored:function(){return!0}};function sg(e,t,i){return rg[i.paths](e.root,t.root,i.matrixParams)&&og[i.queryParams](e.queryParams,t.queryParams)&&!("exact"===i.fragment&&e.fragment!==t.fragment)}function ag(e,t,i){return ug(e,t,t.segments,i)}function ug(e,t,i,n){if(e.segments.length>i.length){var r=e.segments.slice(0,i.length);return!(!gg(r,i)||t.hasChildren()||!cg(r,i,n))}if(e.segments.length===i.length){if(!gg(e.segments,i)||!cg(e.segments,i,n))return!1;for(var o in t.children)if(!e.children[o]||!ag(e.children[o],t.children[o],n))return!1;return!0}var s=i.slice(0,e.segments.length),a=i.slice(e.segments.length);return!!(gg(e.segments,s)&&cg(e.segments,s,n)&&e.children[jd])&&ug(e.children[jd],t,a,n)}function cg(e,t,i){return t.every(function(t,n){return og[i](e[n].parameters,t.parameters)})}var lg=function(){function e(t,i,n){p(this,e),this.root=t,this.queryParams=i,this.fragment=n}return S(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Qd(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return pg.serialize(this)}}]),e}(),hg=function(){function e(t,i){var n=this;p(this,e),this.segments=t,this.children=i,this.parent=null,ig(i,function(e,t){return e.parent=n})}return S(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return mg(this)}}]),e}(),dg=function(){function e(t,i){p(this,e),this.path=t,this.parameters=i}return S(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=Qd(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return Ig(this)}}]),e}();function gg(e,t){return e.length===t.length&&e.every(function(e,i){return e.path===t[i].path})}var fg=function e(){p(this,e)},vg=function(){function e(){p(this,e)}return S(e,[{key:"parse",value:function(e){var t=new Ng(e);return new lg(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){return"".concat("/".concat(Sg(e.root,!0)),function(e){var t=Object.keys(e).map(function(t){var i=e[t];return Array.isArray(i)?i.map(function(e){return"".concat(yg(t),"=").concat(yg(e))}).join("&"):"".concat(yg(t),"=").concat(yg(i))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams)).concat("string"==typeof e.fragment?"#".concat(function(e){return encodeURI(e)}(e.fragment)):"")}}]),e}(),pg=new vg;function mg(e){return e.segments.map(function(e){return Ig(e)}).join("/")}function Sg(e,t){if(!e.hasChildren())return mg(e);if(t){var i=e.children[jd]?Sg(e.children[jd],!1):"",n=[];return ig(e.children,function(e,t){t!==jd&&n.push("".concat(t,":").concat(Sg(e,!1)))}),n.length>0?"".concat(i,"(").concat(n.join("//"),")"):i}var r=function(e,t){var i=[];return ig(e.children,function(e,n){n===jd&&(i=i.concat(t(e,n)))}),ig(e.children,function(e,n){n!==jd&&(i=i.concat(t(e,n)))}),i}(e,function(t,i){return i===jd?[Sg(e.children[jd],!1)]:["".concat(i,":").concat(Sg(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[jd]?"".concat(mg(e),"/").concat(r[0]):"".concat(mg(e),"/(").concat(r.join("//"),")")}function Eg(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yg(e){return Eg(e).replace(/%3B/gi,";")}function Rg(e){return Eg(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Og(e){return decodeURIComponent(e)}function Tg(e){return Og(e.replace(/\+/g,"%20"))}function Ig(e){return"".concat(Rg(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(Rg(t),"=").concat(Rg(e[t]))}).join("")}(e.parameters))}var bg=/^[^\/()?;=#]+/;function Cg(e){var t=e.match(bg);return t?t[0]:""}var Ag=/^[^=?&#]+/,kg=/^[^?&#]+/,Ng=function(){function e(t){p(this,e),this.url=t,this.remaining=t}return S(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new hg([],{}):new hg([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[jd]=new hg(e,t)),i}},{key:"parseSegment",value:function(){var e=Cg(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new dg(Og(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=Cg(this.remaining);if(t){this.capture(t);var i="";if(this.consumeOptional("=")){var n=Cg(this.remaining);n&&(i=n,this.capture(i))}e[Og(t)]=Og(i)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(Ag);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var i="";if(this.consumeOptional("=")){var n=function(e){var t=e.match(kg);return t?t[0]:""}(this.remaining);n&&(i=n,this.capture(i))}var r=Tg(t),o=Tg(i);if(e.hasOwnProperty(r)){var s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var i=Cg(this.remaining),n=this.remaining[i.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error("Cannot parse url '".concat(this.url,"'"));var r=void 0;i.indexOf(":")>-1?(r=i.substr(0,i.indexOf(":")),this.capture(r),this.capture(":")):e&&(r=jd);var o=this.parseChildren();t[r]=1===Object.keys(o).length?o[jd]:new hg([],o),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),_g=function(){function e(t){p(this,e),this._root=t}return S(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=wg(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=wg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=Pg(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return Pg(e,this._root).map(function(e){return e.value})}}]),e}();function wg(e,t){if(e===t.value)return t;var i,r=n(t.children);try{for(r.s();!(i=r.n()).done;){var o=wg(e,i.value);if(o)return o}}catch(s){r.e(s)}finally{r.f()}return null}function Pg(e,t){if(e===t.value)return[t];var i,r=n(t.children);try{for(r.s();!(i=r.n()).done;){var o=Pg(e,i.value);if(o.length)return o.unshift(t),o}}catch(s){r.e(s)}finally{r.f()}return[]}var Mg=function(){function e(t,i){p(this,e),this.value=t,this.children=i}return S(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function Dg(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var Lg=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).snapshot=n,Bg(g(r),e),r}return S(i,[{key:"toString",value:function(){return this.snapshot.toString()}}]),i}(_g);function xg(e,t){var i=function(e,t){var i=new Hg([],{},{},"",{},jd,t,null,e.root,-1,{});return new Gg("",new Mg(i,[]))}(e,t),n=new xh([new dg("",{})]),r=new xh({}),o=new xh({}),s=new xh({}),a=new xh(""),u=new Fg(n,r,s,a,o,jd,t,i.root);return u.snapshot=i.root,new Lg(new Mg(u,[]),i)}var Fg=function(){function e(t,i,n,r,o,s,a,u){p(this,e),this.url=t,this.params=i,this.queryParams=n,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this._futureSnapshot=u}return S(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(B(function(e){return Qd(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(B(function(e){return Qd(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function Ug(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",i=e.pathFromRoot,n=0;if("always"!==t)for(n=i.length-1;n>=1;){var r=i[n],o=i[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(o.component)break;n--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(i.slice(n))}var Hg=function(){function e(t,i,n,r,o,s,a,u,c,l,h){p(this,e),this.url=t,this.params=i,this.queryParams=n,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return S(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=Qd(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Qd(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),Gg=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,n)).url=e,Bg(g(r),n),r}return S(i,[{key:"toString",value:function(){return Wg(this._root)}}]),i}(_g);function Bg(e,t){t.value._routerState=e,t.children.forEach(function(t){return Bg(e,t)})}function Wg(e){var t=e.children.length>0?" { ".concat(e.children.map(Wg).join(", ")," } "):"";return"".concat(e.value).concat(t)}function Vg(e){if(e.snapshot){var t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,$d(t.queryParams,i.queryParams)||e.queryParams.next(i.queryParams),t.fragment!==i.fragment&&e.fragment.next(i.fragment),$d(t.params,i.params)||e.params.next(i.params),function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!$d(e[i],t[i]))return!1;return!0}(t.url,i.url)||e.url.next(i.url),$d(t.data,i.data)||e.data.next(i.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function zg(e,t){return $d(e.params,t.params)&&function(e,t){return gg(e,t)&&e.every(function(e,i){return $d(e.parameters,t[i].parameters)})}(e.url,t.url)&&!(!e.parent!=!t.parent)&&(!e.parent||zg(e.parent,t.parent))}function Yg(e,t,i){if(i&&e.shouldReuseRoute(t.value,i.value.snapshot)){var r=i.value;r._futureSnapshot=t.value;var o=function(e,t,i){return t.children.map(function(t){var r,o=n(i.children);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(e.shouldReuseRoute(t.value,s.value.snapshot))return Yg(e,t,s)}}catch(a){o.e(a)}finally{o.f()}return Yg(e,t)})}(e,t,i);return new Mg(r,o)}if(e.shouldAttach(t.value)){var s=e.retrieve(t.value);if(null!==s){var a=s.route;return jg(t,a),a}}var u=function(e){return new Fg(new xh(e.url),new xh(e.params),new xh(e.queryParams),new xh(e.fragment),new xh(e.data),e.outlet,e.component,e)}(t.value),c=t.children.map(function(t){return Yg(e,t)});return new Mg(u,c)}function jg(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var i=0;i<e.children.length;++i)jg(e.children[i],t.children[i])}function Kg(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Qg(e){return"object"==typeof e&&null!=e&&e.outlets}function qg(e,t,i,n,r){var o={};return n&&ig(n,function(e,t){o[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new lg(i.root===e?t:Xg(i.root,e,t),o,r)}function Xg(e,t,i){var n={};return ig(e.children,function(e,r){n[r]=e===t?i:Xg(e,t,i)}),new hg(e.segments,n)}var Zg=function(){function e(t,i,n){if(p(this,e),this.isAbsolute=t,this.numberOfDoubleDots=i,this.commands=n,t&&n.length>0&&Kg(n[0]))throw new Error("Root segment cannot have matrix parameters");var r=n.find(Qg);if(r&&r!==tg(n))throw new Error("{outlets:{}} has to be the last command")}return S(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),$g=function e(t,i,n){p(this,e),this.segmentGroup=t,this.processChildren=i,this.index=n};function Jg(e,t,i){if(e||(e=new hg([],{})),0===e.segments.length&&e.hasChildren())return ef(e,t,i);var n=function(e,t,i){for(var n=0,r=t,o={match:!1,pathIndex:0,commandIndex:0};r<e.segments.length;){if(n>=i.length)return o;var s=e.segments[r],a=i[n];if(Qg(a))break;var u="".concat(a),c=n<i.length-1?i[n+1]:null;if(r>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!of(u,c,s))return o;n+=2}else{if(!of(u,{},s))return o;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(e,t,i),r=i.slice(n.commandIndex);if(n.match&&n.pathIndex<e.segments.length){var o=new hg(e.segments.slice(0,n.pathIndex),{});return o.children[jd]=new hg(e.segments.slice(n.pathIndex),e.children),ef(o,0,r)}return n.match&&0===r.length?new hg(e.segments,{}):n.match&&!e.hasChildren()?tf(e,t,i):n.match?ef(e,0,r):tf(e,t,i)}function ef(t,i,n){if(0===n.length)return new hg(t.segments,{});var r=function(t){return Qg(t[0])?t[0].outlets:e({},jd,t)}(n),o={};return ig(r,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(o[n]=Jg(t.children[n],i,e))}),ig(t.children,function(e,t){void 0===r[t]&&(o[t]=e)}),new hg(t.segments,o)}function tf(e,t,i){for(var n=e.segments.slice(0,t),r=0;r<i.length;){var o=i[r];if(Qg(o)){var s=nf(o.outlets);return new hg(n,s)}if(0===r&&Kg(i[0]))n.push(new dg(e.segments[t].path,rf(i[0]))),r++;else{var a=Qg(o)?o.outlets[jd]:"".concat(o),u=r<i.length-1?i[r+1]:null;a&&u&&Kg(u)?(n.push(new dg(a,rf(u))),r+=2):(n.push(new dg(a,{})),r++)}}return new hg(n,{})}function nf(e){var t={};return ig(e,function(e,i){"string"==typeof e&&(e=[e]),null!==e&&(t[i]=tf(new hg([],{}),0,e))}),t}function rf(e){var t={};return ig(e,function(e,i){return t[i]="".concat(e)}),t}function of(e,t,i){return e==i.path&&$d(t,i.parameters)}var sf=function(){function e(t,i,n,r){p(this,e),this.routeReuseStrategy=t,this.futureState=i,this.currState=n,this.forwardEvent=r}return S(e,[{key:"activate",value:function(e){var t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Vg(this.futureState.root),this.activateChildRoutes(t,i,e)}},{key:"deactivateChildRoutes",value:function(e,t,i){var n=this,r=Dg(t);e.children.forEach(function(e){var t=e.value.outlet;n.deactivateRoutes(e,r[t],i),delete r[t]}),ig(r,function(e,t){n.deactivateRouteAndItsChildren(e,i)})}},{key:"deactivateRoutes",value:function(e,t,i){var n=e.value,r=t?t.value:null;if(n===r)if(n.component){var o=i.getContext(n.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else r&&this.deactivateRouteAndItsChildren(t,i)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var i=t.getContext(e.value.outlet);if(i&&i.outlet){var n=i.outlet.detach(),r=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:n,route:e,contexts:r})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var i=t.getContext(e.value.outlet),n=i&&e.value.component?i.children:t,r=Dg(e),o=0,s=Object.keys(r);o<s.length;o++){var a=s[o];this.deactivateRouteAndItsChildren(r[a],n)}i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}},{key:"activateChildRoutes",value:function(e,t,i){var n=this,r=Dg(t);e.children.forEach(function(e){n.activateRoutes(e,r[e.value.outlet],i),n.forwardEvent(new zd(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Wd(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,i){var n=e.value,r=t?t.value:null;if(Vg(n),n===r)if(n.component){var o=i.getOrCreateContext(n.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(n.component){var s=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){var a=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),af(a.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var i=t.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig;if(i&&i.component)return null}return null}(n.snapshot),c=u?u.module.componentFactoryResolver:null;s.attachRef=null,s.route=n,s.resolver=c,s.outlet&&s.outlet.activateWith(n,c),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,i)}}]),e}();function af(e){Vg(e.value),e.children.forEach(af)}var uf=function e(t,i){p(this,e),this.routes=t,this.module=i};function cf(e){return"function"==typeof e}function lf(e){return e instanceof lg}var hf=Symbol("INITIAL_VALUE");function df(){return Qh(function(e){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n,r;return G(t[t.length-1])&&(r=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&O(t[0])&&(t=t[0]),re(t,r).lift(new Bh(n))}(e.map(function(e){return e.pipe($h(1),td(hf))})).pipe(id(function(e,t){var i=!1;return t.reduce(function(e,n,r){return e!==hf?e:(n===hf&&(i=!0),i||!1!==n&&r!==t.length-1&&!lf(n)?e:n)},e)},hf),od(function(e){return e!==hf}),B(function(e){return lf(e)?e:!0===e}),$h(1))})}var gf=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=it({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&js(0,"router-outlet")},directives:function(){return[hv]},encapsulation:2}),e}();function ff(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=0;i<e.length;i++){var n=e[i];vf(n,pf(t,n))}}function vf(e,t){e.children&&ff(e.children,t)}function pf(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function mf(e){var t=e.children&&e.children.map(mf),i=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!i.component&&(t||i.loadChildren)&&i.outlet&&i.outlet!==jd&&(i.component=gf),i}function Sf(e){return e.outlet||jd}function Ef(e,t){var n=e.filter(function(e){return Sf(e)===t});return n.push.apply(n,i(e.filter(function(e){return Sf(e)!==t}))),n}var yf={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Rf(e,t,i){var n;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||i.length>0)?Object.assign({},yf):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var r=(t.matcher||Zd)(i,e,t);if(!r)return Object.assign({},yf);var o={};ig(r.posParams,function(e,t){o[t]=e.path});var s=r.consumed.length>0?Object.assign(Object.assign({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:s,positionalParamSegments:null!==(n=r.posParams)&&void 0!==n?n:{}}}function Of(e,t,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(i.length>0&&function(e,t,i){return i.some(function(i){return Tf(e,t,i)&&Sf(i)!==jd})}(e,i,r)){var s=new hg(t,function(e,t,i,r){var o={};o[jd]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var s,a=n(i);try{for(a.s();!(s=a.n()).done;){var u=s.value;if(""===u.path&&Sf(u)!==jd){var c=new hg([],{});c._sourceSegment=e,c._segmentIndexShift=t.length,o[Sf(u)]=c}}}catch(l){a.e(l)}finally{a.f()}return o}(e,t,r,new hg(i,e.children)));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:[]}}if(0===i.length&&function(e,t,i){return i.some(function(i){return Tf(e,t,i)})}(e,i,r)){var a=new hg(e.segments,function(e,t,i,r,o,s){var a,u={},c=n(r);try{for(c.s();!(a=c.n()).done;){var l=a.value;if(Tf(e,i,l)&&!o[Sf(l)]){var h=new hg([],{});h._sourceSegment=e,h._segmentIndexShift="legacy"===s?e.segments.length:t.length,u[Sf(l)]=h}}}catch(d){c.e(d)}finally{c.f()}return Object.assign(Object.assign({},o),u)}(e,t,i,r,e.children,o));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:i}}var u=new hg(e.segments,e.children);return u._sourceSegment=e,u._segmentIndexShift=t.length,{segmentGroup:u,slicedSegments:i}}function Tf(e,t,i){return(!(e.hasChildren()||t.length>0)||"full"!==i.pathMatch)&&""===i.path}function If(e,t,i,n){return!!(Sf(e)===n||n!==jd&&Tf(t,i,e))&&("**"===e.path||Rf(t,e,i).matched)}function bf(e,t,i){return 0===t.length&&!e.children[i]}var Cf=function e(t){p(this,e),this.segmentGroup=t||null},Af=function e(t){p(this,e),this.urlTree=t};function kf(e){return new M(function(t){return t.error(new Cf(e))})}function Nf(e){return new M(function(t){return t.error(new Af(e))})}function _f(e){return new M(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var wf=function(){function t(e,i,n,r,o){p(this,t),this.configLoader=i,this.urlSerializer=n,this.urlTree=r,this.config=o,this.allowRedirects=!0,this.ngModule=e.get(mu)}return S(t,[{key:"apply",value:function(){var e=this,t=Of(this.urlTree.root,[],[],this.config).segmentGroup,i=new hg(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,i,jd).pipe(B(function(t){return e.createUrlTree(Pf(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(ud(function(t){if(t instanceof Af)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof Cf?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,jd).pipe(B(function(i){return t.createUrlTree(Pf(i),e.queryParams,e.fragment)})).pipe(ud(function(e){throw e instanceof Cf?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(t,i,n){var r=t.segments.length>0?new hg([],e({},jd,t)):t;return new lg(r,i,n)}},{key:"expandSegmentGroup",value:function(e,t,i,n){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(B(function(e){return new hg([],e)})):this.expandSegment(e,i,t,i.segments,n,!0)}},{key:"expandChildren",value:function(e,t,i){for(var n=this,r=[],o=0,s=Object.keys(i.children);o<s.length;o++){var a=s[o];"primary"===a?r.unshift(a):r.push(a)}return X(r).pipe(hd(function(r){var o=i.children[r],s=Ef(t,r);return n.expandSegmentGroup(e,s,o,r).pipe(B(function(e){return{segment:e,outlet:r}}))}),id(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var i=arguments.length>=2;return function(n){return n.pipe(e?od(function(t,i){return e(t,i,n)}):P,dd(1),i?Ed(t):vd(function(){return new Vh}))}}())}},{key:"expandSegment",value:function(e,t,i,n,r,o){var s=this;return X(i).pipe(hd(function(a){return s.expandSegmentAgainstRoute(e,t,i,a,n,r,o).pipe(ud(function(e){if(e instanceof Cf)return Lh(null);throw e}))}),Od(function(e){return!!e}),ud(function(e,i){if(e instanceof Vh||"EmptyError"===e.name){if(bf(t,n,r))return Lh(new hg([],{}));throw new Cf(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,i,n,r,o,s){return If(n,t,r,o)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,t,n,r,o):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,n,r,o):kf(t):kf(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,i,n,r,o){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,n,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,n,r,o)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,i,n){var r=this,o=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?Nf(o):this.lineralizeSegments(i,o).pipe(ee(function(i){var o=new hg(i,{});return r.expandSegment(e,o,t,i,n,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,i,n,r,o){var s=this,a=Rf(t,n,r),u=a.matched,c=a.consumedSegments,l=a.lastChild,h=a.positionalParamSegments;if(!u)return kf(t);var d=this.applyRedirectCommands(c,n.redirectTo,h);return n.redirectTo.startsWith("/")?Nf(d):this.lineralizeSegments(n,d).pipe(ee(function(n){return s.expandSegment(e,t,i,n.concat(r.slice(l)),o,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,i,n,r){var o=this;if("**"===i.path)return i.loadChildren?(i._loadedConfig?Lh(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(B(function(e){return i._loadedConfig=e,new hg(n,{})})):Lh(new hg(n,{}));var s=Rf(t,i,n),a=s.matched,u=s.consumedSegments,c=s.lastChild;if(!a)return kf(t);var l=n.slice(c);return this.getChildConfig(e,i,n).pipe(ee(function(e){var n=e.module,s=e.routes,a=Of(t,u,l,s),c=a.segmentGroup,h=a.slicedSegments,d=new hg(c.segments,c.children);if(0===h.length&&d.hasChildren())return o.expandChildren(n,s,d).pipe(B(function(e){return new hg(u,e)}));if(0===s.length&&0===h.length)return Lh(new hg(u,{}));var g=Sf(i)===r;return o.expandSegment(n,d,s,h,g?jd:r,!0).pipe(B(function(e){return new hg(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,i){var n=this;return t.children?Lh(new uf(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Lh(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(ee(function(i){return i?n.configLoader.load(e.injector,t).pipe(B(function(e){return t._loadedConfig=e,e})):function(e){return new M(function(t){return t.error(Xd("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))})}(t)})):Lh(new uf([],e))}},{key:"runCanLoadGuards",value:function(e,t,i){var n=this,r=t.canLoad;return r&&0!==r.length?Lh(r.map(function(n){var r,o=e.get(n);if(function(e){return e&&cf(e.canLoad)}(o))r=o.canLoad(t,i);else{if(!cf(o))throw new Error("Invalid CanLoad guard");r=o(t,i)}return ng(r)})).pipe(df(),Id(function(e){if(lf(e)){var t=Xd('Redirecting to "'.concat(n.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),B(function(e){return!0===e})):Lh(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var i=[],n=t.root;;){if(i=i.concat(n.segments),0===n.numberOfChildren)return Lh(i);if(n.numberOfChildren>1||!n.children[jd])return _f(e.redirectTo);n=n.children[jd]}}},{key:"applyRedirectCommands",value:function(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,i,n){var r=this.createSegmentGroup(e,t.root,i,n);return new lg(r,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var i={};return ig(e,function(e,n){if("string"==typeof e&&e.startsWith(":")){var r=e.substring(1);i[n]=t[r]}else i[n]=e}),i}},{key:"createSegmentGroup",value:function(e,t,i,n){var r=this,o=this.createSegments(e,t.segments,i,n),s={};return ig(t.children,function(t,o){s[o]=r.createSegmentGroup(e,t,i,n)}),new hg(o,s)}},{key:"createSegments",value:function(e,t,i,n){var r=this;return t.map(function(t){return t.path.startsWith(":")?r.findPosParam(e,t,n):r.findOrReturn(t,i)})}},{key:"findPosParam",value:function(e,t,i){var n=i[t.path.substring(1)];if(!n)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return n}},{key:"findOrReturn",value:function(e,t){var i,r=0,o=n(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s.path===e.path)return t.splice(r),s;r++}}catch(a){o.e(a)}finally{o.f()}return e}}]),t}();function Pf(e){for(var t={},i=0,n=Object.keys(e.children);i<n.length;i++){var r=n[i],o=Pf(e.children[r]);(o.segments.length>0||o.hasChildren())&&(t[r]=o)}return function(e){if(1===e.numberOfChildren&&e.children[jd]){var t=e.children[jd];return new hg(e.segments.concat(t.segments),t.children)}return e}(new hg(e.segments,t))}var Mf=function e(t){p(this,e),this.path=t,this.route=this.path[this.path.length-1]},Df=function e(t,i){p(this,e),this.component=t,this.route=i};function Lf(e,t,i){var n=e._root;return Ff(n,t?t._root:null,i,[n.value])}function xf(e,t,i){var n=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var i=t.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig}return null}(t);return(n?n.module.injector:i).get(e)}function Ff(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=Dg(t);return e.children.forEach(function(e){(function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=e.value,s=t?t.value:null,a=i?i.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){var u=function(e,t,i){if("function"==typeof i)return i(e,t);switch(i){case"pathParamsChange":return!gg(e.url,t.url);case"pathParamsOrQueryParamsChange":return!gg(e.url,t.url)||!$d(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!zg(e,t)||!$d(e.queryParams,t.queryParams);case"paramsChange":default:return!zg(e,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);u?r.canActivateChecks.push(new Mf(n)):(o.data=s.data,o._resolvedData=s._resolvedData),Ff(e,t,o.component?a?a.children:null:i,n,r),u&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Df(a.outlet.component,s))}else s&&Uf(t,a,r),r.canActivateChecks.push(new Mf(n)),Ff(e,null,o.component?a?a.children:null:i,n,r)})(e,o[e.value.outlet],i,n.concat([e.value]),r),delete o[e.value.outlet]}),ig(o,function(e,t){return Uf(e,i.getContext(t),r)}),r}function Uf(e,t,i){var n=Dg(e),r=e.value;ig(n,function(e,n){Uf(e,r.component?t?t.children.getContext(n):null:t,i)}),i.canDeactivateChecks.push(new Df(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}var Hf=function e(){p(this,e)};function Gf(e){return new M(function(t){return t.error(e)})}var Bf=function(){function e(t,i,n,r,o,s){p(this,e),this.rootComponentType=t,this.config=i,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=s}return S(e,[{key:"recognize",value:function(){var e=Of(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,jd);if(null===t)return null;var i=new Hg([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},jd,this.rootComponentType,null,this.urlTree.root,-1,{}),n=new Mg(i,t),r=new Gg(this.url,n);return this.inheritParamsAndData(r._root),r}},{key:"inheritParamsAndData",value:function(e){var t=this,i=e.value,n=Ug(i,this.paramsInheritanceStrategy);i.params=Object.freeze(n.params),i.data=Object.freeze(n.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,o=Object.keys(t.children);r<o.length;r++){var s=o[r],a=t.children[s],u=Ef(e,s),c=this.processSegmentGroup(u,a,s);if(null===c)return null;n.push.apply(n,i(c))}var l=Wf(n);return function(e){e.sort(function(e,t){return e.value.outlet===jd?-1:t.value.outlet===jd?1:e.value.outlet.localeCompare(t.value.outlet)})}(l),l}},{key:"processSegment",value:function(e,t,i,r){var o,s=n(e);try{for(s.s();!(o=s.n()).done;){var a=o.value,u=this.processSegmentAgainstRoute(a,t,i,r);if(null!==u)return u}}catch(c){s.e(c)}finally{s.f()}return bf(t,i,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,i,n){if(e.redirectTo||!If(e,t,i,n))return null;var r,o=[],s=[];if("**"===e.path){var a=i.length>0?tg(i).parameters:{};r=new Hg(i,a,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Yf(e),Sf(e),e.component,e,Vf(t),zf(t)+i.length,jf(e))}else{var u=Rf(t,e,i);if(!u.matched)return null;o=u.consumedSegments,s=i.slice(u.lastChild),r=new Hg(o,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Yf(e),Sf(e),e.component,e,Vf(t),zf(t)+o.length,jf(e))}var c=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),l=Of(t,o,s,c.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=l.segmentGroup,d=l.slicedSegments;if(0===d.length&&h.hasChildren()){var g=this.processChildren(c,h);return null===g?null:[new Mg(r,g)]}if(0===c.length&&0===d.length)return[new Mg(r,[])];var f=Sf(e)===n,v=this.processSegment(c,h,d,f?jd:n);return null===v?null:[new Mg(r,v)]}}]),e}();function Wf(e){var t,r=[],o=new Set,s=n(e);try{var a=function(){var e,n=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(n))return r.push(n),"continue";var s=r.find(function(e){return n.value.routeConfig===e.value.routeConfig});void 0!==s?((e=s.children).push.apply(e,i(n.children)),o.add(s)):r.push(n)};for(s.s();!(t=s.n()).done;)a()}catch(d){s.e(d)}finally{s.f()}var u,c=n(o);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=Wf(l.children);r.push(new Mg(l.value,h))}}catch(d){c.e(d)}finally{c.f()}return r.filter(function(e){return!o.has(e)})}function Vf(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function zf(e){for(var t=e,i=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)i+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return i-1}function Yf(e){return e.data||{}}function jf(e){return e.resolve||{}}function Kf(e){return Qh(function(t){var i=e(t);return i?X(i).pipe(B(function(){return t})):Lh(t)})}var Qf=function e(){p(this,e)},qf=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(function(){function e(){p(this,e)}return S(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),Xf=new an("ROUTES"),Zf=function(){function e(t,i,n,r){p(this,e),this.loader=t,this.compiler=i,this.onLoadStartListener=n,this.onLoadEndListener=r}return S(e,[{key:"load",value:function(e,t){var i=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var n=this.loadModuleFactory(t.loadChildren).pipe(B(function(n){i.onLoadEndListener&&i.onLoadEndListener(t);var r=n.create(e);return new uf(eg(r.injector.get(Xf,void 0,Le.Self|Le.Optional)).map(mf),r)}),ud(function(e){throw t._loader$=void 0,e}));return t._loader$=new ce(n,function(){return new U}).pipe(se()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?X(this.loader.load(e)):ng(e()).pipe(ee(function(e){return e instanceof Su?Lh(e):X(t.compiler.compileModuleAsync(e))}))}}]),e}(),$f=function e(){p(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new Jf,this.attachRef=null},Jf=function(){function e(){p(this,e),this.contexts=new Map}return S(e,[{key:"onChildOutletCreated",value:function(e,t){var i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new $f,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),ev=function(){function e(){p(this,e)}return S(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function tv(e){throw e}function iv(e,t,i){return t.parse("/")}function nv(e,t){return Lh(null)}var rv={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ov={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},sv=function(){var e=function(){function e(t,i,n,r,o,s,a,u){var c=this;p(this,e),this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=n,this.location=r,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new U,this.errorHandler=tv,this.malformedUriErrorHandler=iv,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:nv,afterPreactivation:nv},this.urlHandlingStrategy=new ev,this.routeReuseStrategy=new qf,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(mu),this.console=o.get(Sc);var l=o.get(wc);this.isNgZoneEnabled=l instanceof wc&&wc.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new lg(new hg([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Zf(s,a,function(e){return c.triggerEvent(new Hd(e))},function(e){return c.triggerEvent(new Gd(e))}),this.routerState=xg(this.currentUrlTree,this.rootComponentType),this.transitions=new xh({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return S(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,i=this.events;return e.pipe(od(function(e){return 0!==e.id}),B(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),Qh(function(e){var n=!1,r=!1;return Lh(e).pipe(Id(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Qh(function(e){var n=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||n)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Lh(e).pipe(Qh(function(e){var n=t.transitions.getValue();return i.next(new _d(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),n!==t.transitions.getValue()?Yh:Promise.resolve(e)}),function(e,t,i,n){return Qh(function(r){return function(e,t,i,n,r){return new wf(e,t,i,n,r).apply()}(e,t,i,r.extractedUrl,n).pipe(B(function(e){return Object.assign(Object.assign({},r),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),Id(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,i,n,o,s){return ee(function(n){return function(e,t,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var a=new Bf(e,t,i,n,o,s).recognize();return null===a?Gf(new Hf):Lh(a)}catch(r){return Gf(r)}}(e,i,n.urlAfterRedirects,(a=n.urlAfterRedirects,t.serializeUrl(a)),o,s).pipe(B(function(e){return Object.assign(Object.assign({},n),{targetSnapshot:e})}));var a})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),Id(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var n=new Dd(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);i.next(n)}));if(n&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,a=e.source,u=e.restoredState,c=e.extras,l=new _d(o,t.serializeUrl(s),a,u);i.next(l);var h=xg(s,t.rootComponentType).snapshot;return Lh(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:s,extras:Object.assign(Object.assign({},c),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Yh}),Kf(function(e){var i=e.targetSnapshot,n=e.id,r=e.extractedUrl,o=e.rawUrl,s=e.extras,a=s.skipLocationChange,u=s.replaceUrl;return t.hooks.beforePreactivation(i,{navigationId:n,appliedUrlTree:r,rawUrlTree:o,skipLocationChange:!!a,replaceUrl:!!u})}),Id(function(e){var i=new Ld(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(i)}),B(function(e){return Object.assign(Object.assign({},e),{guards:Lf(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return ee(function(i){var n=i.targetSnapshot,r=i.currentSnapshot,o=i.guards,s=o.canActivateChecks,a=o.canDeactivateChecks;return 0===a.length&&0===s.length?Lh(Object.assign(Object.assign({},i),{guardsResult:!0})):function(e,t,i,n){return X(e).pipe(ee(function(e){return function(e,t,i,n,r){var o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?Lh(o.map(function(o){var s,a=xf(o,t,r);if(function(e){return e&&cf(e.canDeactivate)}(a))s=ng(a.canDeactivate(e,t,i,n));else{if(!cf(a))throw new Error("Invalid CanDeactivate guard");s=ng(a(e,t,i,n))}return s.pipe(Od())})).pipe(df()):Lh(!0)}(e.component,e.route,i,t,n)}),Od(function(e){return!0!==e},!0))}(a,n,r,e).pipe(ee(function(i){return i&&function(e){return"boolean"==typeof e}(i)?function(e,t,i,n){return X(t).pipe(hd(function(t){return zh(function(e,t){return null!==e&&t&&t(new Bd(e)),Lh(!0)}(t.route.parent,n),function(e,t){return null!==e&&t&&t(new Vd(e)),Lh(!0)}(t.route,n),function(e,t,i){var n=t[t.length-1],r=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return Kh(function(){return Lh(t.guards.map(function(r){var o,s=xf(r,t.node,i);if(function(e){return e&&cf(e.canActivateChild)}(s))o=ng(s.canActivateChild(n,e));else{if(!cf(s))throw new Error("Invalid CanActivateChild guard");o=ng(s(n,e))}return o.pipe(Od())})).pipe(df())})});return Lh(r).pipe(df())}(e,t.path,i),function(e,t,i){var n=t.routeConfig?t.routeConfig.canActivate:null;return n&&0!==n.length?Lh(n.map(function(n){return Kh(function(){var r,o=xf(n,t,i);if(function(e){return e&&cf(e.canActivate)}(o))r=ng(o.canActivate(t,e));else{if(!cf(o))throw new Error("Invalid CanActivate guard");r=ng(o(t,e))}return r.pipe(Od())})})).pipe(df()):Lh(!0)}(e,t.route,i))}),Od(function(e){return!0!==e},!0))}(n,s,e,t):Lh(i)}),B(function(e){return Object.assign(Object.assign({},i),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),Id(function(e){if(lf(e.guardsResult)){var i=Xd('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw i.url=e.guardsResult,i}var n=new xd(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(n)}),od(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),Kf(function(e){if(e.guards.canActivateChecks.length)return Lh(e).pipe(Id(function(e){var i=new Fd(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(i)}),Qh(function(e){var i=!1;return Lh(e).pipe(function(e,t){return ee(function(i){var n=i.targetSnapshot,r=i.guards.canActivateChecks;if(!r.length)return Lh(i);var o=0;return X(r).pipe(hd(function(i){return function(e,t,i,n){return function(e,t,i,n){var r=Object.keys(e);if(0===r.length)return Lh({});var o={};return X(r).pipe(ee(function(r){return function(e,t,i,n){var r=xf(e,t,n);return ng(r.resolve?r.resolve(t,i):r(t,i))}(e[r],t,i,n).pipe(Id(function(e){o[r]=e}))}),dd(1),ee(function(){return Object.keys(o).length===r.length?Lh(o):Yh}))}(e._resolve,e,t,n).pipe(B(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),Ug(e,i).resolve),null}))}(i.route,n,e,t)}),Id(function(){return o++}),dd(1),ee(function(e){return o===r.length?Lh(i):Yh}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),Id({next:function(){return i=!0},complete:function(){i||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),Id(function(e){var i=new Ud(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(i)}))}),Kf(function(e){var i=e.targetSnapshot,n=e.id,r=e.extractedUrl,o=e.rawUrl,s=e.extras,a=s.skipLocationChange,u=s.replaceUrl;return t.hooks.afterPreactivation(i,{navigationId:n,appliedUrlTree:r,rawUrlTree:o,skipLocationChange:!!a,replaceUrl:!!u})}),B(function(e){var i=function(e,t,i){var n=Yg(e,t._root,i?i._root:void 0);return new Lg(n,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:i})}),Id(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,i){return B(function(n){return new sf(t,n.targetRouterState,n.currentRouterState,i).activate(e),n})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),Id({next:function(){n=!0},complete:function(){n=!0}}),function(e){return function(t){return t.lift(new Ad(e))}}(function(){if(!n&&!r){var i="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,i)):t.cancelNavigationTransition(e,i)}t.currentNavigation=null}),ud(function(n){if(r=!0,function(e){return e&&e[qd]}(n)){var o=lf(n.url);o||(t.navigated=!0,t.restoreHistory(e,!0));var s=new Pd(e.id,t.serializeUrl(e.extractedUrl),n.message);i.next(s),o?setTimeout(function(){var i=t.urlHandlingStrategy.merge(n.url,t.rawUrlTree);t.scheduleNavigation(i,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var a=new Md(e.id,t.serializeUrl(e.extractedUrl),n);i.next(a);try{e.resolve(t.errorHandler(n))}catch(s){e.reject(s)}}return Yh}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var i=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,i)&&setTimeout(function(){var t=i.source,n=i.state,r=i.urlTree,o={replaceUrl:!0};if(n){var s=Object.assign({},n);delete s.navigationId,delete s.\u0275routerPageId,0!==Object.keys(s).length&&(o.state=s)}e.scheduleNavigation(r,t,n,o)},0),e.lastLocationChangeInfo=i}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var i=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!i||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){ff(e),this.config=e.map(mf),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,o=t.fragment,s=t.queryParamsHandling,a=t.preserveFragment,u=n||this.routerState.root,c=a?this.currentUrlTree.fragment:o,l=null;switch(s){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}return null!==l&&(l=this.removeEmptyProps(l)),function(e,t,n,r,o){if(0===n.length)return qg(t.root,t.root,t,r,o);var s=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Zg(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,o){if("object"==typeof r&&null!=r){if(r.outlets){var s={};return ig(r.outlets,function(e,t){s[t]="string"==typeof e?e.split("/"):e}),[].concat(i(e),[{outlets:s}])}if(r.segmentPath)return[].concat(i(e),[r.segmentPath])}return"string"!=typeof r?[].concat(i(e),[r]):0===o?(r.split("/").forEach(function(i,r){0==r&&"."===i||(0==r&&""===i?n=!0:".."===i?t++:""!=i&&e.push(i))}),e):[].concat(i(e),[r])},[]);return new Zg(n,t,r)}(n);if(s.toRoot())return qg(t.root,new hg([],{}),t,r,o);var a=function(e,t,i){if(e.isAbsolute)return new $g(t.root,!0,0);if(-1===i.snapshot._lastPathIndex){var n=i.snapshot._urlSegment;return new $g(n,n===t.root,0)}var r=Kg(e.commands[0])?0:1;return function(e,t,i){for(var n=e,r=t,o=i;o>r;){if(o-=r,!(n=n.parent))throw new Error("Invalid number of '../'");r=n.segments.length}return new $g(n,!1,r-o)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(s,t,e),u=a.processChildren?ef(a.segmentGroup,a.index,s.commands):Jg(a.segmentGroup,a.index,s.commands);return qg(a.segmentGroup,u,t,r,o)}(u,this.currentUrlTree,e,l,null!=c?c:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},i=lf(e)?e:this.parseUrl(e),n=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(n,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var i=e[t];if(null==i)throw new Error("The requested path contains ".concat(i," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(i){t=this.malformedUriErrorHandler(i,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var i;if(i=!0===t?Object.assign({},rv):!1===t?Object.assign({},ov):t,lf(e))return sg(this.currentUrlTree,e,i);var n=this.parseUrl(e);return sg(this.currentUrlTree,n,i)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,i){var n=e[i];return null!=n&&(t[i]=n),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new wd(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ")})}},{key:"scheduleNavigation",value:function(e,t,i,n,r){var o,s;if(this.disposed)return Promise.resolve(!1);var a,u,c,l=this.getTransition(),h="imperative"!==t&&"imperative"===(null==l?void 0:l.source),d=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(h&&d)return Promise.resolve(!0);r?(a=r.resolve,u=r.reject,c=r.promise):c=new Promise(function(e,t){a=e,u=t});var g,f=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),g=i&&i.\u0275routerPageId?i.\u0275routerPageId:n.replaceUrl||n.skipLocationChange?null!==(o=this.browserPageId)&&void 0!==o?o:0:(null!==(s=this.browserPageId)&&void 0!==s?s:0)+1):g=0,this.setTransition({id:f,targetPageId:g,source:t,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:n,resolve:a,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var i=this.urlSerializer.serialize(e),n=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(i)||t.extras.replaceUrl?this.location.replaceState(i,"",n):this.location.go(i,"",n)}},{key:"restoreHistory",value:function(e){var t,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var r=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===r?this.currentUrlTree===(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)&&0===r&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var i=new Pd(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(i),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(cn),An(fg),An(Jf),An(Il),An(Ts),An(Jc),An(kc),An(void 0))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),av=function(){var e=function(){function e(t,i,n,r,o){p(this,e),this.router=t,this.route=i,this.commands=[],this.onChanges=new U,null==n&&r.setAttribute(o.nativeElement,"tabindex","0")}return S(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:cv(this.skipLocationChange),replaceUrl:cv(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:cv(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(sv),Bs(Fg),rn("tabindex"),Bs(Ba),Bs(Ua))},e.\u0275dir=ut({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&$s("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Rt]}),e}(),uv=function(){var e=function(){function e(t,i,n){var r=this;p(this,e),this.router=t,this.route=i,this.locationStrategy=n,this.commands=[],this.onChanges=new U,this.subscription=t.events.subscribe(function(e){e instanceof wd&&r.updateTargetUrlAndHref()})}return S(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,i,n,r){if(0!==e||t||i||n||r||"string"==typeof this.target&&"_self"!=this.target)return!0;var o={skipLocationChange:cv(this.skipLocationChange),replaceUrl:cv(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,o),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:cv(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(sv),Bs(Fg),Bs(El))},e.\u0275dir=ut({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&$s("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(pa("href",t.href,gr),Us("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Rt]}),e}();function cv(e){return""===e||!!e}var lv=function(){var e=function(){function e(t,i,n,r,o,s){var a=this;p(this,e),this.router=t,this.element=i,this.renderer=n,this.cdr=r,this.link=o,this.linkWithHref=s,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.routerEventsSubscription=t.events.subscribe(function(e){e instanceof wd&&a.update()})}return S(e,[{key:"ngAfterContentInit",value:function(){var e=this;Lh(this.links.changes,this.linksWithHrefs.changes,Lh(null)).pipe(ne()).subscribe(function(t){e.update(),e.subscribeToEachLinkOnChanges()})}},{key:"subscribeToEachLinkOnChanges",value:function(){var e,t=this;null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe();var n=[].concat(i(this.links.toArray()),i(this.linksWithHrefs.toArray()),[this.link,this.linkWithHref]).filter(function(e){return!!e}).map(function(e){return e.onChanges});this.linkInputChangesSubscription=X(n).pipe(ne()).subscribe(function(e){t.isActive!==t.isLinkActive(t.router)(e)&&t.update()})}},{key:"routerLinkActive",set:function(e){var t=Array.isArray(e)?e:e.split(" ");this.classes=t.filter(function(e){return!!e})}},{key:"ngOnChanges",value:function(e){this.update()}},{key:"ngOnDestroy",value:function(){var e;this.routerEventsSubscription.unsubscribe(),null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe()}},{key:"update",value:function(){var e=this;!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(function(){var t=e.hasActiveLinks();e.isActive!==t&&(e.isActive=t,e.cdr.markForCheck(),e.classes.forEach(function(i){t?e.renderer.addClass(e.element.nativeElement,i):e.renderer.removeClass(e.element.nativeElement,i)}))})}},{key:"isLinkActive",value:function(e){var t=function(e){return!!e.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return function(i){return e.isActive(i.urlTree,t)}}},{key:"hasActiveLinks",value:function(){var e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.linkWithHref&&e(this.linkWithHref)||this.links.some(e)||this.linksWithHrefs.some(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(sv),Bs(Ua),Bs(Ba),Bs(cu),Bs(av,8),Bs(uv,8))},e.\u0275dir=ut({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(e,t,i){var n;(1&e&&(oc(i,av,5),oc(i,uv,5)),2&e)&&(nc(n=sc())&&(t.links=n),nc(n=sc())&&(t.linksWithHrefs=n))},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[Rt]}),e}(),hv=function(){var e=function(){function e(t,i,n,r,o){p(this,e),this.parentContexts=t,this.location=i,this.resolver=n,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Yu,this.deactivateEvents=new Yu,this.name=r||jd,t.onChildOutletCreated(this.name,this)}return S(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var i=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,r=new dv(e,n,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jf),Bs(yu),Bs(Da),rn("name"),Bs(cu))},e.\u0275dir=ut({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),dv=function(){function e(t,i,n){p(this,e),this.route=t,this.childContexts=i,this.parent=n}return S(e,[{key:"get",value:function(e,t){return e===Fg?this.route:e===Jf?this.childContexts:this.parent.get(e,t)}}]),e}(),gv=function e(){p(this,e)},fv=function(){function e(){p(this,e)}return S(e,[{key:"preload",value:function(e,t){return Lh(null)}}]),e}(),vv=function(){var e=function(){function e(t,i,n,r,o){p(this,e),this.router=t,this.injector=r,this.preloadingStrategy=o,this.loader=new Zf(i,n,function(e){return t.triggerEvent(new Hd(e))},function(e){return t.triggerEvent(new Gd(e))})}return S(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(od(function(e){return e instanceof wd}),hd(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(mu);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var i,r=[],o=n(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s.loadChildren&&!s.canLoad&&s._loadedConfig){var a=s._loadedConfig;r.push(this.processRoutes(a.module,a.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(e,s)):s.children&&r.push(this.processRoutes(e,s.children))}}catch(u){o.e(u)}finally{o.f()}return X(r).pipe(ne(),B(function(e){}))}},{key:"preloadConfig",value:function(e,t){var i=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?Lh(t._loadedConfig):i.loader.load(e.injector,t)).pipe(ee(function(e){return t._loadedConfig=e,i.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(sv),An(Jc),An(kc),An(Ts),An(gv))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),pv=function(){var e=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p(this,e),this.router=t,this.viewportScroller=i,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}return S(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof _d?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof wd&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof Yd&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new Yd(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(sv),An(th),An(void 0))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),mv=new an("ROUTER_CONFIGURATION"),Sv=new an("ROUTER_FORROOT_GUARD"),Ev=[Il,{provide:fg,useClass:vg},{provide:sv,useFactory:function(e,t,i,n,r,o,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new sv(null,e,t,i,n,r,o,eg(s));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(a,l),a.enableTracing&&l.events.subscribe(function(e){var t,i;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(i=console.groupEnd)||void 0===i||i.call(console)}),l},deps:[fg,Jf,Il,Ts,Jc,kc,Xf,mv,[function(){return function e(){p(this,e)}}(),new xn],[Qf,new xn]]},Jf,{provide:Fg,useFactory:function(e){return e.routerState.root},deps:[sv]},{provide:Jc,useClass:il},vv,fv,function(){function e(){p(this,e)}return S(e,[{key:"preload",value:function(e,t){return t().pipe(ud(function(){return Lh(null)}))}}]),e}(),{provide:mv,useValue:{enableTracing:!1}}];function yv(){return new jc("Router",sv)}var Rv=function(){var e=function(){function e(t,i){p(this,e)}return S(e,null,[{key:"forRoot",value:function(t,i){return{ngModule:e,providers:[Ev,bv(t),{provide:Sv,useFactory:Iv,deps:[[sv,new xn,new Fn]]},{provide:mv,useValue:i||{}},{provide:El,useFactory:Tv,deps:[ll,[new Ln(Rl),new xn],mv]},{provide:pv,useFactory:Ov,deps:[sv,th,mv]},{provide:gv,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:fv},{provide:jc,multi:!0,useFactory:yv},[Cv,{provide:lc,multi:!0,useFactory:Av,deps:[Cv]},{provide:Nv,useFactory:kv,deps:[Cv]},{provide:mc,multi:!0,useExisting:Nv}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[bv(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Sv,8),An(sv,8))},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({}),e}();function Ov(e,t,i){return i.scrollOffset&&t.setOffset(i.scrollOffset),new pv(e,t,i)}function Tv(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i.useHash?new Tl(e,t):new Ol(e,t)}function Iv(e){return"guarded"}function bv(e){return[{provide:un,multi:!0,useValue:e},{provide:Xf,multi:!0,useValue:e}]}var Cv=function(){var e=function(){function e(t){p(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new U}return S(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(dl,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,i=new Promise(function(e){return t=e}),n=e.injector.get(sv),r=e.injector.get(mv);return"disabled"===r.initialNavigation?(n.setUpLocationChangeListener(),t(!0)):"enabled"===r.initialNavigation||"enabledBlocking"===r.initialNavigation?(n.hooks.afterPreactivation=function(){return e.initNavigation?Lh(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},n.initialNavigation()):t(!0),i})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(mv),i=this.injector.get(vv),n=this.injector.get(pv),r=this.injector.get(sv),o=this.injector.get(Zc);e===o.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&r.initialNavigation(),i.setUpPreloading(),n.init(),r.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Ts))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}();function Av(e){return e.appInitializer.bind(e)}function kv(e){return e.bootstrapListener.bind(e)}var Nv=new an("Router Initializer"),_v=(function(e){e.ALL="all",e.BUILD="build-modal",e.IMPORT="import-modal",e.EXPORT="export-modal",e.HARD_RESET="hard-reset-modal",e.INFO="info-modal",e.OPTIONS="options-modal",e.CONFIRM="confirm-modal",e.INPUT="input-modal",e.ROYAL="royal-modal",e.MISSION="mission-modal",e.MARKET="market-modal",e.WORK_MANAGEMENT="work-management-modal",e.TUTORIAL="tutorial-modal",e.CHANGELOG="changelog-modal",e.RESOURCE_MANAGEMENT="resource-management-modal",e.RECIPE="recipe-modal",e.WORLD="world-modal",e.WORLD_BUILD="world-build-modal",e.FIGHT_REPORT="fight-report-modal",e.ABDICATION="abdication-modal",e.ASCENSION="ascension-modal",e.RESEARCH_UNLOCK="research-unlock-modal",e.SHIPYARD="shipyard-modal",e.FESTIVAL="festival-modal",e.ERROR="error-modal"}(_v||(_v={})),_v),wv=(function(e){e[e.WEATHER=0]="WEATHER",e[e.MARKET=1]="MARKET",e[e.MANAGEMENT=2]="MANAGEMENT",e[e.CRAFTING=3]="CRAFTING",e[e.RESEARCH=4]="RESEARCH",e[e.ARMY=5]="ARMY",e[e.RELIGION=6]="RELIGION",e[e.FORT=7]="FORT",e[e.SEA=8]="SEA",e[e.FIELD=9]="FIELD",e[e.MOUNTAINS=10]="MOUNTAINS",e[e.PLATEAU=11]="PLATEAU",e[e.HOUSE=12]="HOUSE",e[e.SHRINE=13]="SHRINE",e[e.CHURCH=14]="CHURCH",e[e.TAILOR=15]="TAILOR",e[e.TAVERN=16]="TAVERN",e[e.BAKERY=17]="BAKERY",e[e.MARKETPLACE=18]="MARKETPLACE",e[e.BARRACKS=19]="BARRACKS",e[e.STOCKADE=20]="STOCKADE",e[e.WOODEN_TOWER=21]="WOODEN_TOWER",e[e.STONE_TOWER=22]="STONE_TOWER",e[e.STASH=23]="STASH",e[e.FORESTER=24]="FORESTER",e[e.SAWMILL=25]="SAWMILL",e[e.HUNTER=26]="HUNTER",e[e.TANNERY=27]="TANNERY",e[e.WINDMILL=28]="WINDMILL",e[e.FARM=29]="FARM",e[e.PASTURE=30]="PASTURE",e[e.BUTCHER=31]="BUTCHER",e[e.BREWERY=32]="BREWERY",e[e.WINERY=33]="WINERY",e[e.COTTON_MILL=34]="COTTON_MILL",e[e.PIT_MINE=35]="PIT_MINE",e[e.GEOLOGIST=36]="GEOLOGIST",e[e.SMITHY=37]="SMITHY",e[e.MINT=38]="MINT",e[e.FISHERS_HUT=39]="FISHERS_HUT",e[e.CALENDAR=40]="CALENDAR",e[e.FIRE=41]="FIRE",e[e.URBAN_PLANNING=42]="URBAN_PLANNING",e[e.ALCOHOL=43]="ALCOHOL",e[e.GOLD=44]="GOLD",e[e.SILVER=45]="SILVER",e[e.BRONZE=46]="BRONZE",e[e.IRON=47]="IRON",e[e.STEEL=48]="STEEL",e[e.ADVANCED_ORE_PROCESSING=49]="ADVANCED_ORE_PROCESSING",e[e.BUFFS=50]="BUFFS",e[e.COTTON=51]="COTTON",e[e.BARLEY=52]="BARLEY",e[e.HOPS=53]="HOPS",e[e.BUILT_QUARRY=54]="BUILT_QUARRY",e[e.BUILT_SMITHY=55]="BUILT_SMITHY",e[e.HUMAN_RESOURCES=56]="HUMAN_RESOURCES",e[e.FISH_FOOD=57]="FISH_FOOD",e[e.SPECIALISED_PRODUCTION=58]="SPECIALISED_PRODUCTION",e[e.MANUFACTURE=59]="MANUFACTURE",e[e.STONEMASON=60]="STONEMASON",e[e.LONGHOUSE=61]="LONGHOUSE",e[e.HERITAGE=62]="HERITAGE",e[e.HERBALISM=63]="HERBALISM",e[e.EMBASSY=64]="EMBASSY",e[e.CARTOGRAPHY=65]="CARTOGRAPHY",e[e.PAPER_MILL=66]="PAPER_MILL",e[e.DEEP_MINE=67]="DEEP_MINE",e[e.LOGISTICS=68]="LOGISTICS",e[e.PRODUCTION_ZONES=69]="PRODUCTION_ZONES",e[e.BARN=70]="BARN",e[e.KITCHEN=71]="KITCHEN",e[e.CLAY_PIT=72]="CLAY_PIT",e[e.TUDOR_HOUSE=73]="TUDOR_HOUSE",e[e.NAVY=74]="NAVY",e[e.PIER=75]="PIER",e[e.BOAT_BUILDER=76]="BOAT_BUILDER",e[e.HARBOUR=77]="HARBOUR",e[e.SHIPYARD=78]="SHIPYARD",e[e.BRIGANTINE=79]="BRIGANTINE",e[e.GALLEON=80]="GALLEON",e[e.LIGHTHOUSE=81]="LIGHTHOUSE",e[e.CARTOGRAPHER=82]="CARTOGRAPHER",e[e.SETTLEMENT=83]="SETTLEMENT",e[e.SCHOLARS_LAB=84]="SCHOLARS_LAB",e[e.TAX_COLLECTOR=85]="TAX_COLLECTOR",e[e.JEWELRY=86]="JEWELRY",e[e.BUILDERS_GUILD=87]="BUILDERS_GUILD"}(wv||(wv={})),wv),Pv=(function(e){e[e.ALL=0]="ALL",e[e.CONSTRUCTION=1]="CONSTRUCTION",e[e.DECONSTRUCTION=2]="DECONSTRUCTION",e[e.HUT=3]="HUT",e[e.HOUSE=4]="HOUSE",e[e.MARKETPLACE=5]="MARKETPLACE",e[e.WAREHOUSE=6]="WAREHOUSE",e[e.SMITHY=7]="SMITHY",e[e.BAKERY=8]="BAKERY",e[e.WORKSHOP=9]="WORKSHOP",e[e.SHRINE=10]="SHRINE",e[e.TAILOR=11]="TAILOR",e[e.BREWERY=12]="BREWERY",e[e.TAVERN=13]="TAVERN",e[e.CHURCH=14]="CHURCH",e[e.STOCKADE=15]="STOCKADE",e[e.BARRACKS=16]="BARRACKS",e[e.TRAINING_SQUARE=17]="TRAINING_SQUARE",e[e.WOODEN_TOWER=18]="WOODEN_TOWER",e[e.STONE_TOWER=19]="STONE_TOWER",e[e.STASH=20]="STASH",e[e.LOGGERS_HUT=21]="LOGGERS_HUT",e[e.SAWMILL=22]="SAWMILL",e[e.FORESTER=23]="FORESTER",e[e.HUNTER_LODGE=24]="HUNTER_LODGE",e[e.GATHERER=25]="GATHERER",e[e.TANNERY=26]="TANNERY",e[e.FARM=27]="FARM",e[e.FIELD=28]="FIELD",e[e.ORCHARD=29]="ORCHARD",e[e.PASTURE=30]="PASTURE",e[e.WINDMILL=31]="WINDMILL",e[e.BUTCHER=32]="BUTCHER",e[e.COTTON_MILL=33]="COTTON_MILL",e[e.WINERY=34]="WINERY",e[e.PIT_MINE=35]="PIT_MINE",e[e.QUARRY=36]="QUARRY",e[e.GEOLOGIST=37]="GEOLOGIST",e[e.STONEMASON=38]="STONEMASON",e[e.MINT=39]="MINT",e[e.FISHERS_HUT=40]="FISHERS_HUT",e[e.SCHOOL_OF_FISH=41]="SCHOOL_OF_FISH",e[e.SHARKS=42]="SHARKS",e[e.STONEHENGE=43]="STONEHENGE",e[e.PYRAMID=44]="PYRAMID",e[e.HANGING_GARDEN=45]="HANGING_GARDEN",e[e.COLOSSUS=46]="COLOSSUS",e[e.UNDERGROUND_CITY=47]="UNDERGROUND_CITY",e[e.GREAT_LIGHTHOUSE=48]="GREAT_LIGHTHOUSE",e[e.SACRED_GROVE=49]="SACRED_GROVE",e[e.ASCENSION_TEMPLE=50]="ASCENSION_TEMPLE",e[e.MANUFACTURE=51]="MANUFACTURE",e[e.LONGHOUSE=52]="LONGHOUSE",e[e.EMBASSY=53]="EMBASSY",e[e.PAPER_MILL=54]="PAPER_MILL",e[e.DEEP_MINE=55]="DEEP_MINE",e[e.GATHERERS_CAMP=56]="GATHERERS_CAMP",e[e.BARN=57]="BARN",e[e.KITCHEN=58]="KITCHEN",e[e.CLAY_PIT=59]="CLAY_PIT",e[e.TUDOR_HOUSE=60]="TUDOR_HOUSE",e[e.LOGGERS_CAMP=61]="LOGGERS_CAMP",e[e.METEORITE=62]="METEORITE",e[e.BOAT_BUILDER=63]="BOAT_BUILDER",e[e.SHIPYARD=64]="SHIPYARD",e[e.PIER=65]="PIER",e[e.HARBOUR=66]="HARBOUR",e[e.LIGHTHOUSE=67]="LIGHTHOUSE",e[e.CARTOGRAPHER=68]="CARTOGRAPHER",e[e.SETTLEMENT=69]="SETTLEMENT",e[e.SCHOLARS_LAB=70]="SCHOLARS_LAB",e[e.TAX_COLLECTOR=71]="TAX_COLLECTOR",e[e.BUILDERS_GUILD=72]="BUILDERS_GUILD"}(Pv||(Pv={})),Pv),Mv=(function(e){e[e.NOTHING=0]="NOTHING",e[e.FOOD=1]="FOOD",e[e.LOG=2]="LOG",e[e.BRUSHWOOD=3]="BRUSHWOOD",e[e.STONE=4]="STONE",e[e.FUR=5]="FUR",e[e.WHEAT=6]="WHEAT",e[e.BARLEY=7]="BARLEY",e[e.HOP=8]="HOP",e[e.COTTON=9]="COTTON",e[e.HAY=10]="HAY",e[e.CHICKEN=11]="CHICKEN",e[e.COW=12]="COW",e[e.PIG=13]="PIG",e[e.HORSE=14]="HORSE",e[e.COAL=15]="COAL",e[e.GOLD_ORE=16]="GOLD_ORE",e[e.SILVER_ORE=17]="SILVER_ORE",e[e.COPPER_ORE=18]="COPPER_ORE",e[e.TIN_ORE=19]="TIN_ORE",e[e.IRON_ORE=20]="IRON_ORE",e[e.PLANK=21]="PLANK",e[e.CUT_STONE=22]="CUT_STONE",e[e.FUEL=23]="FUEL",e[e.FLOUR=24]="FLOUR",e[e.FABRIC=25]="FABRIC",e[e.LEATHER=26]="LEATHER",e[e.COINS=27]="COINS",e[e.COPPER=28]="COPPER",e[e.GOLD=29]="GOLD",e[e.SILVER=30]="SILVER",e[e.TIN=31]="TIN",e[e.BRONZE=32]="BRONZE",e[e.IRON=33]="IRON",e[e.STEEL=34]="STEEL",e[e.BERRY=35]="BERRY",e[e.MUSHROOM=36]="MUSHROOM",e[e.FISH=37]="FISH",e[e.APPLE=38]="APPLE",e[e.GRAPE=39]="GRAPE",e[e.BREAD=40]="BREAD",e[e.MEAT=41]="MEAT",e[e.EGG=42]="EGG",e[e.MILK=43]="MILK",e[e.COOKED_MEAT=44]="COOKED_MEAT",e[e.VEGETABLE_SOUP=45]="VEGETABLE_SOUP",e[e.MEAT_SOUP=46]="MEAT_SOUP",e[e.BEER=47]="BEER",e[e.WINE=48]="WINE",e[e.CLOTHES=49]="CLOTHES",e[e.BOW=50]="BOW",e[e.PICKAXE=51]="PICKAXE",e[e.SHOVEL=52]="SHOVEL",e[e.AXE=53]="AXE",e[e.SPEAR=54]="SPEAR",e[e.HAMMER=55]="HAMMER",e[e.SWORD=56]="SWORD",e[e.SHIELD=57]="SHIELD",e[e.LEATHER_ARMOR=58]="LEATHER_ARMOR",e[e.LIGHT_ARMOR=59]="LIGHT_ARMOR",e[e.HEAVY_ARMOR=60]="HEAVY_ARMOR",e[e.FISH_FOOD=61]="FISH_FOOD",e[e.CHEESE=62]="CHEESE",e[e.HERBS=63]="HERBS",e[e.HERBAL_MEDICINE=64]="HERBAL_MEDICINE",e[e.COOKED_FISH=65]="COOKED_FISH",e[e.SHEEP=66]="SHEEP",e[e.WOOL=67]="WOOL",e[e.PAPER=68]="PAPER",e[e.GLASS=69]="GLASS",e[e.CLAY=70]="CLAY",e[e.POTTERY=71]="POTTERY",e[e.BRICKS=72]="BRICKS",e[e.OMELETTE=73]="OMELETTE",e[e.PIE=74]="PIE",e[e.NAILS=75]="NAILS",e[e.MAP=76]="MAP",e[e.CANNON=77]="CANNON",e[e.BOUILLABAISSE=78]="BOUILLABAISSE",e[e.GEMS=79]="GEMS",e[e.JEWELRY=80]="JEWELRY"}(Mv||(Mv={})),Mv);!function(e){e.values=function(){return Object.keys(e).filter(function(e){return isNaN(e)&&"values"!==e})}}(Mv||(Mv={}));var Dv=(function(e){e[e.MOTIVATION_SPEECH=0]="MOTIVATION_SPEECH",e[e.ROYAL_PROPHECY=1]="ROYAL_PROPHECY",e[e.HERITAGE=2]="HERITAGE",e[e.FAMILY_JEWELS=3]="FAMILY_JEWELS",e[e.KING_OF_THE_FOREST=4]="KING_OF_THE_FOREST",e[e.KING_OF_THE_SEAS=5]="KING_OF_THE_SEAS",e[e.KING_OF_THE_PEOPLE=6]="KING_OF_THE_PEOPLE",e[e.KING_OF_THE_WAR=7]="KING_OF_THE_WAR",e[e.CALL_TO_ARMS=8]="CALL_TO_ARMS",e[e.UNITE_WITH_THE_PEOPLE=9]="UNITE_WITH_THE_PEOPLE",e[e.JESTER=10]="JESTER",e[e.ROYAL_ORDERS=11]="ROYAL_ORDERS",e[e.ROYAL_ARCHIVES=12]="ROYAL_ARCHIVES",e[e.ASTROLOGICAL_NOTE=13]="ASTROLOGICAL_NOTE",e[e.ROYAL_FESTIVAL=14]="ROYAL_FESTIVAL",e[e.ROYAL_RESERVE=15]="ROYAL_RESERVE",e[e.ANCIENT_SEA_MAPS=16]="ANCIENT_SEA_MAPS",e[e.ROYAL_GARDENS=17]="ROYAL_GARDENS",e[e.HIRE_MERCENARIES=18]="HIRE_MERCENARIES",e[e.HIRE_PIRATES=19]="HIRE_PIRATES",e[e.ANCIENT_PROTECTION=20]="ANCIENT_PROTECTION",e[e.ROYAL_TRADITIONS=21]="ROYAL_TRADITIONS"}(Dv||(Dv={})),Dv),Lv=(function(e){e[e.MANAGEMENT=0]="MANAGEMENT",e[e.STONE_AXE=1]="STONE_AXE",e[e.STONE_PICKAXE=2]="STONE_PICKAXE",e[e.STONE_SHOVEL=3]="STONE_SHOVEL",e[e.STONE_HAMMER=4]="STONE_HAMMER",e[e.HUNTING=5]="HUNTING",e[e.FIRE=6]="FIRE",e[e.BIGGER_FIRE=7]="BIGGER_FIRE",e[e.COOKING=8]="COOKING",e[e.TRADE=9]="TRADE",e[e.ALCOHOL=10]="ALCOHOL",e[e.WONDER_BUILDINGS=11]="WONDER_BUILDINGS",e[e.TRADE_ROUTES=12]="TRADE_ROUTES",e[e.BUFF_PRODUCTION=13]="BUFF_PRODUCTION",e[e.STONE_SPEAR=14]="STONE_SPEAR",e[e.BOW=15]="BOW",e[e.BARRACKS=16]="BARRACKS",e[e.WOODEN_DEFENCES=17]="WOODEN_DEFENCES",e[e.STONE_DEFENCES=18]="STONE_DEFENCES",e[e.STASH=19]="STASH",e[e.SCIENTIFIC_METHOD=20]="SCIENTIFIC_METHOD",e[e.FORESIGHT=21]="FORESIGHT",e[e.CALENDAR=22]="CALENDAR",e[e.WEATHER=23]="WEATHER",e[e.HISTORY=24]="HISTORY",e[e.URBAN_PLANNING=25]="URBAN_PLANNING",e[e.MATHEMATICS=26]="MATHEMATICS",e[e.PROSPECTING_FOR_ORE=27]="PROSPECTING_FOR_ORE",e[e.ADVANCED_PROSPECTING=28]="ADVANCED_PROSPECTING",e[e.MASTER_PROSPECTING=29]="MASTER_PROSPECTING",e[e.SAWMILL=30]="SAWMILL",e[e.MINING=31]="MINING",e[e.PIT_MINE=32]="PIT_MINE",e[e.UNDERGROUND_MINE=33]="UNDERGROUND_MINE",e[e.WINDMILL=34]="WINDMILL",e[e.MORTAR=35]="MORTAR",e[e.HOUSE=36]="HOUSE",e[e.TANNERY=37]="TANNERY",e[e.FABRIC=38]="FABRIC",e[e.TAILORING=39]="TAILORING",e[e.ORE_PROCESSING=40]="ORE_PROCESSING",e[e.ADVANCED_ORE_PROCESSING=41]="ADVANCED_ORE_PROCESSING",e[e.MASTER_ORE_PROCESSING=42]="MASTER_ORE_PROCESSING",e[e.COINS_MINTING=43]="COINS_MINTING",e[e.METALLURGY=44]="METALLURGY",e[e.ADVANCED_METALLURGY=45]="ADVANCED_METALLURGY",e[e.PICKAXE_DESIGN=46]="PICKAXE_DESIGN",e[e.AGRICULTURE=47]="AGRICULTURE",e[e.FORESTRY=48]="FORESTRY",e[e.FISHING=49]="FISHING",e[e.ANIMALS=50]="ANIMALS",e[e.COTTON=51]="COTTON",e[e.FERTILIZER=52]="FERTILIZER",e[e.HUMAN_RESOURCES=53]="HUMAN_RESOURCES",e[e.FISH_FOOD=54]="FISH_FOOD",e[e.SPECIALISED_PRODUCTION=55]="SPECIALISED_PRODUCTION",e[e.LONGHOUSE=56]="LONGHOUSE",e[e.HERBAL_MEDICINE=57]="HERBAL_MEDICINE",e[e.HERBALISM=58]="HERBALISM",e[e.CARTOGRAPHY=59]="CARTOGRAPHY",e[e.PARCHMENT=60]="PARCHMENT",e[e.PAPER_MILL=61]="PAPER_MILL",e[e.DEEP_MINE=62]="DEEP_MINE",e[e.ADVANCED_MATHEMATICS=63]="ADVANCED_MATHEMATICS",e[e.IMPROVED_FORESIGHT=64]="IMPROVED_FORESIGHT",e[e.LOGISTICS=65]="LOGISTICS",e[e.PRODUCTION_ZONES=66]="PRODUCTION_ZONES",e[e.CROPS_STORAGE=67]="CROPS_STORAGE",e[e.COPPER_TOOLS=68]="COPPER_TOOLS",e[e.BRONZE_TOOLS=69]="BRONZE_TOOLS",e[e.IRON_TOOLS=70]="IRON_TOOLS",e[e.BAKERY=71]="BAKERY",e[e.KITCHEN=72]="KITCHEN",e[e.DIGGING=73]="DIGGING",e[e.POTTERY=74]="POTTERY",e[e.BRICKS=75]="BRICKS",e[e.TUDOR_HOUSE=76]="TUDOR_HOUSE",e[e.IMPROVED_COOKING=77]="IMPROVED_COOKING",e[e.BOAT_BUILDING=78]="BOAT_BUILDING",e[e.CANNON=79]="CANNON",e[e.GALLEON=80]="GALLEON",e[e.BIGGER_SHIPS=81]="BIGGER_SHIPS",e[e.SEA_NAVIGATION=82]="SEA_NAVIGATION",e[e.SEA_CARTOGRAPHY=83]="SEA_CARTOGRAPHY",e[e.SEA_CUISINE=84]="SEA_CUISINE",e[e.SETTLEMENT=85]="SETTLEMENT",e[e.SCHOLAR=86]="SCHOLAR",e[e.TAX=87]="TAX",e[e.JEWELRY=88]="JEWELRY",e[e.BUILDERS_GUILD=89]="BUILDERS_GUILD"}(Lv||(Lv={})),Lv),xv=(function(e){e[e.BLESSING=0]="BLESSING",e[e.PREACH=1]="PREACH",e[e.FAITH_SHIELD=2]="FAITH_SHIELD",e[e.SOLDIER_PRAYER=3]="SOLDIER_PRAYER",e[e.FAITHFUL_RESEARCH=4]="FAITHFUL_RESEARCH",e[e.BABY_BOOM=5]="BABY_BOOM",e[e.LIFE_CYCLE=6]="LIFE_CYCLE",e[e.HOLY_WAR=7]="HOLY_WAR",e[e.PRAY=8]="PRAY"}(xv||(xv={})),xv),Fv=(function(e){e[e.SPY=0]="SPY",e[e.DIVERSION=1]="DIVERSION",e[e.PLUNDER=2]="PLUNDER",e[e.EXPEDITION=3]="EXPEDITION",e[e.CONQUER=4]="CONQUER",e[e.COLONIZE=5]="COLONIZE",e[e.MOVE=6]="MOVE",e[e.BUILD=7]="BUILD",e[e.FISHING=8]="FISHING",e[e.HUNTING=9]="HUNTING",e[e.TREASURE=10]="TREASURE",e[e.CARTOGRAPHY=11]="CARTOGRAPHY",e[e.SEA_BATTLE=12]="SEA_BATTLE",e[e.SEA_PLUNDER=13]="SEA_PLUNDER",e[e.SEA_CONQUER=14]="SEA_CONQUER",e[e.SEA_MOVE=15]="SEA_MOVE"}(Fv||(Fv={})),Fv),Uv=(function(e){e[e.NONE=0]="NONE",e[e.WHEAT=1]="WHEAT",e[e.BARLEY=2]="BARLEY",e[e.HAY=3]="HAY",e[e.HOP=4]="HOP",e[e.COTTON=5]="COTTON",e[e.BERRY=6]="BERRY",e[e.GRAPE=7]="GRAPE",e[e.APPLE=8]="APPLE",e[e.HERBS=9]="HERBS",e[e.MUSHROOM=10]="MUSHROOM"}(Uv||(Uv={})),Uv),Hv=(function(e){e[e.ALL=0]="ALL",e[e.NONE=1]="NONE",e[e.RAW=2]="RAW",e[e.PROCESSED=3]="PROCESSED",e[e.FOOD=4]="FOOD",e[e.TOOLS=5]="TOOLS",e[e.OTHER=6]="OTHER",e[e.WOODEN=7]="WOODEN",e[e.METAL=8]="METAL",e[e.STONE=9]="STONE",e[e.ANIMAL=10]="ANIMAL",e[e.FUEL=11]="FUEL",e[e.CONSUMABLE=12]="CONSUMABLE"}(Hv||(Hv={})),Hv),Gv=(function(e){e[e.NONE=0]="NONE",e[e.FERTILITY=1]="FERTILITY",e[e.NATURE=2]="NATURE",e[e.TECHNOLOGY=3]="TECHNOLOGY",e[e.WAR=4]="WAR"}(Gv||(Gv={})),Gv),Bv=(function(e){e[e.ALL=0]="ALL",e[e.MILITIA=1]="MILITIA",e[e.SPEARMAN=2]="SPEARMAN",e[e.ARCHER=3]="ARCHER",e[e.SWORDSMAN=4]="SWORDSMAN",e[e.LIGHT_CAVALRY=5]="LIGHT_CAVALRY",e[e.SPY=6]="SPY",e[e.COLONIST=7]="COLONIST",e[e.HORSE_ARCHER=8]="HORSE_ARCHER",e[e.BOAT=9]="BOAT",e[e.BRIGANTINE=10]="BRIGANTINE",e[e.GALLEON=11]="GALLEON",e[e.GUARD_TOWER=12]="GUARD_TOWER"}(Bv||(Bv={})),Bv),Wv=(function(e){e[e.NONE=0]="NONE",e[e.OFFENSE=1]="OFFENSE",e[e.DEFENSE=2]="DEFENSE",e[e.ECONOMY=3]="ECONOMY",e[e.PEACE=4]="PEACE"}(Wv||(Wv={})),Wv),Vv=(function(e){e[e.SPECIAL=0]="SPECIAL",e[e.PLAYER=1]="PLAYER",e[e.NEUTRAL=2]="NEUTRAL",e[e.EXPEDITION=3]="EXPEDITION",e[e.CLEADAL=4]="CLEADAL",e[e.GRIERIA=5]="GRIERIA",e[e.BOTHIL=6]="BOTHIL",e[e.DOSHOR=7]="DOSHOR",e[e.CREURUS=8]="CREURUS",e[e.ESTRAILA=9]="ESTRAILA",e[e.NONE=10]="NONE",e[e.PIRATES=11]="PIRATES"}(Vv||(Vv={})),Vv),zv=(function(e){e[e.FLU=0]="FLU",e[e.COLD=1]="COLD",e[e.PNEUMONIA=2]="PNEUMONIA"}(zv||(zv={})),zv),Yv=(function(e){e[e.VILLAGE=0]="VILLAGE",e[e.FORT=1]="FORT",e[e.FOREST=2]="FOREST",e[e.FIELD=3]="FIELD",e[e.MOUNTAINS=4]="MOUNTAINS",e[e.SEA=5]="SEA",e[e.PLATEAU=6]="PLATEAU"}(Yv||(Yv={})),Yv),jv=(function(e){e[e.FISH=0]="FISH",e[e.SHARK=1]="SHARK",e[e.TREASURE=2]="TREASURE",e[e.PIRATES=3]="PIRATES",e[e.PIRATES_BASE=4]="PIRATES_BASE",e[e.WHIRLPOOL=5]="WHIRLPOOL",e[e.CARTOGRAPHY=6]="CARTOGRAPHY"}(jv||(jv={})),jv),Kv=(function(e){e[e.FOOD=0]="FOOD",e[e.VARIOUS_FOOD=1]="VARIOUS_FOOD",e[e.MONOTONOUS_FOOD=2]="MONOTONOUS_FOOD",e[e.RAW_FOOD=3]="RAW_FOOD",e[e.CLOTHES=4]="CLOTHES",e[e.FUR_CLOTHES=5]="FUR_CLOTHES",e[e.ALCOHOL=6]="ALCOHOL",e[e.TAX=7]="TAX",e[e.DONATION=8]="DONATION",e[e.FREEZING=9]="FREEZING",e[e.SICKNESS_DEATH=10]="SICKNESS_DEATH",e[e.FESTIVAL=11]="FESTIVAL",e[e.ROYAL_FESTIVAL=12]="ROYAL_FESTIVAL",e[e.RELIGION=13]="RELIGION",e[e.PRAYER=14]="PRAYER",e[e.POPULATION_SIZE=15]="POPULATION_SIZE",e[e.LOW_QUALITY_HOUSING=16]="LOW_QUALITY_HOUSING",e[e.SUCCESSFUL_CONQUER=17]="SUCCESSFUL_CONQUER",e[e.RECENTLY_INVADED=18]="RECENTLY_INVADED",e[e.RECENTLY_CONQUERED=19]="RECENTLY_CONQUERED",e[e.PIRATES_DEFEATED=20]="PIRATES_DEFEATED",e[e.PIRATES_BASE_PRESENT=21]="PIRATES_BASE_PRESENT",e[e.ROYAL_GARDENS=22]="ROYAL_GARDENS"}(Kv||(Kv={})),Kv),Qv=function(){function e(){p(this,e)}return S(e,null,[{key:"round",value:function(e,t){return e.toFixed(t)}},{key:"titleCase",value:function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}},{key:"prepareResourceName",value:function(e){var t=Mv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: r"+e+")"}},{key:"prepareRegionName",value:function(e){var t=Yv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: reg"+e+")"}},{key:"prepareResourceTypeName",value:function(e){var t=Hv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: rt"+e+")"}},{key:"preparePerkName",value:function(e){var t=Dv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: rp"+e+")"}},{key:"prepareTechName",value:function(e){var t=Lv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: r"+e+")"}},{key:"prepareFlagName",value:function(e){var t=wv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: f"+e+")"}},{key:"prepareBuildingName",value:function(e){var t=Pv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: b"+e+")"}},{key:"prepareSeaEventName",value:function(e){var t=jv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: se"+e+")"}},{key:"preparePrayerName",value:function(e){var t=xv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: p"+e+")"}},{key:"prepareReligionName",value:function(e){var t=Gv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: rel"+e+")"}},{key:"prepareTroopName",value:function(e){var t=Bv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: t"+e+")"}},{key:"prepareMissionName",value:function(e){var t=Fv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: m"+e+")"}},{key:"prepareCropName",value:function(e){var t=Uv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: c"+e+")"}},{key:"prepareFocusName",value:function(e){var t=Wv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: foc"+e+")"}},{key:"prepareCountryName",value:function(e){var t=Vv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: co"+e+")"}},{key:"prepareSicknessName",value:function(e){var t=zv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: si"+e+")"}},{key:"prepareHappinessEffectName",value:function(e){var t=Kv[e];return t?this.titleCase(t.replace(/_/g," ")):"(error: he"+e+")"}},{key:"resourcesArraysDiff",value:function(e,t){return e.filter(function(e){return t.findIndex(function(t){return t.resource===e.resource})<0})}},{key:"prepareResourcesNamesList",value:function(t){var i="";return t.forEach(function(t){return i+=e.prepareResourceName(t.resource)+", "}),(i=i.substr(0,i.length-2)).toLowerCase()}},{key:"copyResourceArray",value:function(e){var t=[];return e.forEach(function(e){return t.push({resource:e.resource,amount:e.amount})}),t}}]),e}(),qv=(function(e){e[e.ALL=0]="ALL",e[e.WORKING=1]="WORKING",e[e.IDLE=2]="IDLE",e[e.PASSIVE=3]="PASSIVE"}(qv||(qv={})),qv),Xv=(function(e){e[e.AUTO_SAVE_STATUS=0]="AUTO_SAVE_STATUS",e[e.AUTO_SAVE_PERIOD=1]="AUTO_SAVE_PERIOD",e[e.METRIC=2]="METRIC",e[e.SAVE_LOGS=3]="SAVE_LOGS",e[e.SOUND_MASTER=4]="SOUND_MASTER",e[e.SOUND_MASTER_VOLUME=5]="SOUND_MASTER_VOLUME",e[e.VISUAL_PROGRESS_BARS=6]="VISUAL_PROGRESS_BARS",e[e.AUTO_TEXT_FITTING=7]="AUTO_TEXT_FITTING",e[e.POSITIVE_COLOUR=8]="POSITIVE_COLOUR",e[e.NEGATIVE_COLOUR=9]="NEGATIVE_COLOUR",e[e.PAGED_VIEW=10]="PAGED_VIEW",e[e.BUILDINGS_PER_PAGE=11]="BUILDINGS_PER_PAGE",e[e.KEEP_RESERVATION_SETTINGS_ON_RESET=12]="KEEP_RESERVATION_SETTINGS_ON_RESET",e[e.KEEP_MANAGEMENT_SETTINGS_ON_RESET=13]="KEEP_MANAGEMENT_SETTINGS_ON_RESET",e[e.PAUSE_ON_INIT=14]="PAUSE_ON_INIT",e[e.KEEP_AUTO_TRADE_ON_RESET=15]="KEEP_AUTO_TRADE_ON_RESET",e[e.AI_DIFFICULTY=16]="AI_DIFFICULTY",e[e.SOUND_MUSIC=17]="SOUND_MUSIC",e[e.SOUND_MUSIC_VOLUME=18]="SOUND_MUSIC_VOLUME",e[e.SOUND_EFFECTS=19]="SOUND_EFFECTS",e[e.SOUND_EFFECTS_VOLUME=20]="SOUND_EFFECTS_VOLUME",e[e.SOUND_EFFECT_MARKET=21]="SOUND_EFFECT_MARKET",e[e.SOUND_EFFECT_RESEARCH=22]="SOUND_EFFECT_RESEARCH",e[e.SOUND_EFFECT_INVASION=23]="SOUND_EFFECT_INVASION",e[e.SOUND_EFFECT_SEASON=24]="SOUND_EFFECT_SEASON",e[e.PLAYER_COLOUR=25]="PLAYER_COLOUR"}(Xv||(Xv={})),Xv),Zv=(function(e){e[e.GAME=0]="GAME",e[e.LOG=1]="LOG",e[e.MODAL=2]="MODAL",e[e.RESOURCES=3]="RESOURCES",e[e.LAND=4]="LAND",e[e.RESEARCH=5]="RESEARCH",e[e.CRAFTING=6]="CRAFTING",e[e.RECIPE=7]="RECIPE",e[e.RELIGION=8]="RELIGION",e[e.WEATHER=9]="WEATHER",e[e.CALENDAR=10]="CALENDAR",e[e.EFFECTS=11]="EFFECTS",e[e.ARMY=12]="ARMY",e[e.HAPPINESS=13]="HAPPINESS",e[e.MANAGEMENT=14]="MANAGEMENT",e[e.ROYAL=15]="ROYAL",e[e.MARKET=16]="MARKET",e[e.VILLAGE=17]="VILLAGE",e[e.FORT=18]="FORT",e[e.FOREST=19]="FOREST",e[e.FIELD=20]="FIELD",e[e.MOUNTAINS=21]="MOUNTAINS",e[e.SEA=22]="SEA",e[e.PLATEAU=23]="PLATEAU",e[e.BUILDING_FACTORY=24]="BUILDING_FACTORY",e[e.SERIALIZER=25]="SERIALIZER",e[e.KONGREGATE=26]="KONGREGATE",e[e.ID=27]="ID",e[e.TICKER=28]="TICKER",e[e.HERITAGE=29]="HERITAGE",e[e.WORLD=30]="WORLD",e[e.MISSION_FACTORY=31]="MISSION_FACTORY",e[e.SOUND=32]="SOUND",e[e.TUTORIAL=33]="TUTORIAL",e[e.NAVY=34]="NAVY",e[e.REGIONS=35]="REGIONS"}(Zv||(Zv={})),Zv),$v=function(){var e=function(){function e(){p(this,e),this.services=new Map}return S(e,[{key:"addService",value:function(e,t){this.services.set(e,t)}},{key:"getService",value:function(e){return this.services.get(e)}},{key:"getIdService",value:function(){return this.services.get(Zv.ID)}},{key:"getKongregateService",value:function(){return this.services.get(Zv.KONGREGATE)}},{key:"getWeatherService",value:function(){return this.services.get(Zv.WEATHER)}},{key:"getManagementService",value:function(){return this.services.get(Zv.MANAGEMENT)}},{key:"getTechService",value:function(){return this.services.get(Zv.RESEARCH)}},{key:"getHappinessService",value:function(){return this.services.get(Zv.HAPPINESS)}},{key:"getEffectsService",value:function(){return this.services.get(Zv.EFFECTS)}},{key:"getRecipeService",value:function(){return this.services.get(Zv.RECIPE)}},{key:"getLandService",value:function(){return this.services.get(Zv.LAND)}},{key:"getResourcesService",value:function(){return this.services.get(Zv.RESOURCES)}},{key:"getRegionsService",value:function(){return this.services.get(Zv.REGIONS)}},{key:"getVillageService",value:function(){return this.services.get(Zv.VILLAGE)}},{key:"getFortService",value:function(){return this.services.get(Zv.FORT)}},{key:"getForestService",value:function(){return this.services.get(Zv.FOREST)}},{key:"getFieldService",value:function(){return this.services.get(Zv.FIELD)}},{key:"getMountainsService",value:function(){return this.services.get(Zv.MOUNTAINS)}},{key:"getSeaService",value:function(){return this.services.get(Zv.SEA)}},{key:"getCalendarService",value:function(){return this.services.get(Zv.CALENDAR)}},{key:"getRoyalService",value:function(){return this.services.get(Zv.ROYAL)}},{key:"getWorldService",value:function(){return this.services.get(Zv.WORLD)}},{key:"getModalService",value:function(){return this.services.get(Zv.MODAL)}},{key:"getArmyService",value:function(){return this.services.get(Zv.ARMY)}},{key:"getNavyService",value:function(){return this.services.get(Zv.NAVY)}},{key:"getLogService",value:function(){return this.services.get(Zv.LOG)}},{key:"getGameService",value:function(){return this.services.get(Zv.GAME)}},{key:"getServiceByRegion",value:function(e){switch(e){case Yv.VILLAGE:return this.services.get(Zv.VILLAGE);case Yv.FORT:return this.services.get(Zv.FORT);case Yv.FIELD:return this.services.get(Zv.FIELD);case Yv.FOREST:return this.services.get(Zv.FOREST);case Yv.MOUNTAINS:return this.services.get(Zv.MOUNTAINS);case Yv.SEA:return this.services.get(Zv.SEA);case Yv.PLATEAU:return this.services.get(Zv.PLATEAU);default:console.error("Region service not found for ["+Yv[e]+"]")}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Jv=function(){var e=function(){function e(t){p(this,e),this.servicesService=t,this.textSubject=new U,this.errorSubject=new U,this.missionDataSubject=new U,this.returnRegionSubject=new U,this.regionSelectionSubject=new U,this.shipyardLimitBoat=new U,this.buildingSubject=new U,this.tutorialSubject=new U,this.tutorialResponseSubject=new U,this.valueSubject=new U,this.onOpenSubject=new U,this.confirmationSubject=new U,this.abdicationSubject=new U,this.closeSubject=new U,this.valueResponseSubject=new U,this.regionSubject=new U,this.worldRegionSubject=new U,this.fightReportSubject=new U,this.techSubject=new U,this.resourceOptionsSubject=new U,this.resourceOptionsResponseSubject=new U,this.modals=[],this.servicesService.addService(Zv.MODAL,this)}return S(e,[{key:"add",value:function(e){this.modals.push(e)}},{key:"remove",value:function(e){this.modals=this.modals.filter(function(t){return t.id!==e})}},{key:"open",value:function(e){this.modals.find(function(t){return t.id===e}).open(),this.onOpenSubject.next(e)}},{key:"close",value:function(e){this.modals.find(function(t){return t.id===e}).close(),this.closeSubject.next(e)}},{key:"registerForText",value:function(){return this.textSubject.asObservable()}},{key:"registerForErrorReport",value:function(){return this.errorSubject.asObservable()}},{key:"registerForOnOpen",value:function(){return this.onOpenSubject.asObservable()}},{key:"registerForConfirmation",value:function(){return this.confirmationSubject.asObservable()}},{key:"sendConfirmationResult",value:function(e){this.confirmationSubject.next(e)}},{key:"registerForAbdication",value:function(){return this.abdicationSubject.asObservable()}},{key:"sendAbdicationResult",value:function(e){this.abdicationSubject.next(e)}},{key:"setModalText",value:function(e){this.textSubject.next(e)}},{key:"setModalErrorReport",value:function(e){this.errorSubject.next(e)}},{key:"registerForRegion",value:function(){return this.regionSubject.asObservable()}},{key:"setRegion",value:function(e){this.regionSubject.next(e)}},{key:"registerForCloseModal",value:function(){return this.closeSubject.asObservable()}},{key:"sendCloseSignal",value:function(e){this.closeSubject.next(e)}},{key:"registerForValue",value:function(){return this.valueSubject.asObservable()}},{key:"setModalValue",value:function(e){this.valueSubject.next(e)}},{key:"sendValueInput",value:function(e){this.valueResponseSubject.next(e)}},{key:"registerForValueResponse",value:function(){return this.valueResponseSubject.asObservable()}},{key:"registerForMissionData",value:function(){return this.missionDataSubject.asObservable()}},{key:"registerForBuilding",value:function(){return this.buildingSubject.asObservable()}},{key:"setMissionData",value:function(e){this.missionDataSubject.next(e)}},{key:"setBuilding",value:function(e){this.buildingSubject.next(e)}},{key:"info",value:function(e){this.open(_v.INFO),this.setModalText(e)}},{key:"openTutorialModal",value:function(e){var t=this.modals.find(function(e){return e.id===_v.TUTORIAL});t.close(),t.openTutorialWindow(e)}},{key:"registerForTutorial",value:function(){return this.tutorialSubject.asObservable()}},{key:"setTutorial",value:function(e){this.tutorialSubject.next(e)}},{key:"registerForTutorialResponse",value:function(){return this.tutorialResponseSubject.asObservable()}},{key:"sendTutorialResponse",value:function(e){this.tutorialResponseSubject.next(e)}},{key:"registerForResourceOptions",value:function(){return this.resourceOptionsSubject.asObservable()}},{key:"setResourceOptions",value:function(e){this.resourceOptionsSubject.next(e)}},{key:"registerForResourceOptionsResponse",value:function(){return this.resourceOptionsResponseSubject.asObservable()}},{key:"sendResourceOptionsResponse",value:function(e){return this.resourceOptionsResponseSubject.next(e)}},{key:"registerForReturnRegion",value:function(){return this.returnRegionSubject.asObservable()}},{key:"setReturnRegion",value:function(e){this.returnRegionSubject.next(e)}},{key:"registerForRegionSelectionOrder",value:function(){return this.regionSelectionSubject.asObservable()}},{key:"setRegionSelection",value:function(e){this.regionSelectionSubject.next(e)}},{key:"registerForShipyardLimitBoat",value:function(){return this.shipyardLimitBoat.asObservable()}},{key:"setShipyardLimitBoat",value:function(e){this.shipyardLimitBoat.next(e)}},{key:"registerForWorldRegion",value:function(){return this.worldRegionSubject.asObservable()}},{key:"setWorldRegion",value:function(e){this.worldRegionSubject.next(e)}},{key:"registerForFightReport",value:function(){return this.fightReportSubject.asObservable()}},{key:"setFightReport",value:function(e){this.fightReportSubject.next(e)}},{key:"registerForTech",value:function(){return this.techSubject.asObservable()}},{key:"setTech",value:function(e){this.techSubject.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ep=(function(e){e[e.DEV=0]="DEV",e[e.V1_0_0=1]="V1_0_0"}(ep||(ep={})),ep),tp=(function(e){e[e.SUN=0]="SUN",e[e.CLOUDS=1]="CLOUDS",e[e.RAIN=2]="RAIN",e[e.WIND=3]="WIND",e[e.STORM=4]="STORM",e[e.SNOW=5]="SNOW"}(tp||(tp={})),tp),ip=(function(e){e[e.PLANK=0]="PLANK",e[e.CUT_STONE=1]="CUT_STONE",e[e.FABRIC=2]="FABRIC",e[e.LEATHER=3]="LEATHER",e[e.GOLD=4]="GOLD",e[e.SILVER=5]="SILVER",e[e.COPPER=6]="COPPER",e[e.TIN=7]="TIN",e[e.BRONZE=8]="BRONZE",e[e.IRON=9]="IRON",e[e.STEEL=10]="STEEL",e[e.FUEL_BRUSHWOOD=11]="FUEL_BRUSHWOOD",e[e.FUEL_LOG=12]="FUEL_LOG",e[e.FUEL_COAL=13]="FUEL_COAL",e[e.STONE_AXE=14]="STONE_AXE",e[e.STONE_PICKAXE=15]="STONE_PICKAXE",e[e.STONE_SHOVEL=16]="STONE_SHOVEL",e[e.STONE_SPEAR=17]="STONE_SPEAR",e[e.STONE_HAMMER=18]="STONE_HAMMER",e[e.BOW=19]="BOW",e[e.CLOTHES_FUR=20]="CLOTHES_FUR",e[e.CLOTHES_FABRIC=21]="CLOTHES_FABRIC",e[e.SWORD=22]="SWORD",e[e.WOODEN_SHIELD=23]="WOODEN_SHIELD",e[e.LEATHER_ARMOR=24]="LEATHER_ARMOR",e[e.LIGHT_ARMOR=25]="LIGHT_ARMOR",e[e.HEAVY_ARMOR=26]="HEAVY_ARMOR",e[e.COOKED_MEAT=27]="COOKED_MEAT",e[e.FLOUR=28]="FLOUR",e[e.BREAD=29]="BREAD",e[e.VEGETABLE_SOUP_BERRY=30]="VEGETABLE_SOUP_BERRY",e[e.VEGETABLE_SOUP_MUSHROOM=31]="VEGETABLE_SOUP_MUSHROOM",e[e.MEAT_SOUP=32]="MEAT_SOUP",e[e.CHEESE=33]="CHEESE",e[e.HERBAL_MEDICINE=34]="HERBAL_MEDICINE",e[e.COOKED_FISH=35]="COOKED_FISH",e[e.FABRIC_WOOL=36]="FABRIC_WOOL",e[e.PARCHMENT=37]="PARCHMENT",e[e.VEGETABLE_SOUP_BERRY_MUSHROOM=38]="VEGETABLE_SOUP_BERRY_MUSHROOM",e[e.COPPER_AXE=39]="COPPER_AXE",e[e.COPPER_PICKAXE=40]="COPPER_PICKAXE",e[e.COPPER_SHOVEL=41]="COPPER_SHOVEL",e[e.COPPER_SPEAR=42]="COPPER_SPEAR",e[e.COPPER_HAMMER=43]="COPPER_HAMMER",e[e.BRONZE_AXE=44]="BRONZE_AXE",e[e.BRONZE_PICKAXE=45]="BRONZE_PICKAXE",e[e.BRONZE_SHOVEL=46]="BRONZE_SHOVEL",e[e.BRONZE_SPEAR=47]="BRONZE_SPEAR",e[e.BRONZE_HAMMER=48]="BRONZE_HAMMER",e[e.IRON_AXE=49]="IRON_AXE",e[e.IRON_PICKAXE=50]="IRON_PICKAXE",e[e.IRON_SHOVEL=51]="IRON_SHOVEL",e[e.IRON_SPEAR=52]="IRON_SPEAR",e[e.IRON_HAMMER=53]="IRON_HAMMER",e[e.POTTERY=54]="POTTERY",e[e.BRICKS=55]="BRICKS",e[e.OMELETTE=56]="OMELETTE",e[e.PIE=57]="PIE",e[e.COPPER_NAILS=58]="COPPER_NAILS",e[e.BRONZE_NAILS=59]="BRONZE_NAILS",e[e.IRON_NAILS=60]="IRON_NAILS",e[e.CANNON=61]="CANNON",e[e.BOUILLABAISSE=62]="BOUILLABAISSE",e[e.JEWELRY=63]="JEWELRY",e[e.BRONZE_SWORD=64]="BRONZE_SWORD",e[e.IRON_SWORD=65]="IRON_SWORD",e[e.BRONZE_SHIELD=66]="BRONZE_SHIELD",e[e.IRON_SHIELD=67]="IRON_SHIELD"}(ip||(ip={})),ip),np=(function(e){e[e.GENERAL=0]="GENERAL",e[e.MILITARY=1]="MILITARY",e[e.SCIENCE=2]="SCIENCE",e[e.TECHNOLOGY=3]="TECHNOLOGY",e[e.AGRICULTURE=4]="AGRICULTURE"}(np||(np={})),np),rp=function(){function e(t,i,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;p(this,e),this.name=t,this.building=i,this.effect=n,this.duration=r,this.buff=o}return S(e,[{key:"isPermanent",value:function(){return this.duration<0}},{key:"isRoyal",value:function(){return-10===this.duration}},{key:"isWonder",value:function(){return-9===this.duration}},{key:"isBuff",value:function(){return this.buff>0}}]),e}(),op=function(){var e=function e(){p(this,e)};return e.PERMANENT=-1,e.WONDER=-9,e.ROYAL=-10,e}(),sp=function(){var e=function(){function e(){p(this,e)}return S(e,null,[{key:"randomElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=0;if(e.forEach(function(e){return r+=e.chance}),r>100||r<100&&t){var o=100/r;e.forEach(function(e){return e.chance=Math.floor(e.chance*o)})}var s,a=this.randomBetween(1,100*i),u=0,c=n(e);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(u+1<=a&&u+l.chance*i>=a)return l.item;u+=l.chance*i}}catch(f){c.e(f)}finally{c.f()}for(;r>100;){var h,d=n(e);try{for(d.s();!(h=d.n()).done;){var g=h.value;if(u+1<=a&&u+g.chance*i>=a)return g.item;u+=g.chance*i}}catch(f){d.e(f)}finally{d.f()}}return null}},{key:"chance",value:function(e){return Math.random()<e}},{key:"randomExcept",value:function(e,t){var i=e.filter(function(e){return t.indexOf(e)<0});return i[this.randomBetween(0,i.length-1)]}},{key:"randomArrayElement",value:function(e){return e[this.randomBetween(0,e.length-1)]}},{key:"randomBetween",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"randomBetweenFloat",value:function(e,t){return Math.random()*(t-e+1)+e}},{key:"randomWeightedExcept",value:function(e,t){var i=e.filter(function(e){return t.indexOf(e.item)<0}),n=0;i.forEach(function(e){return n+=e.chance});for(var r=this.randomBetween(1,n),o=0,s=0;s<i.length;s++){if(o<r&&r<=o+i[s].chance)return i[s].item;o+=i[s].chance}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ap=function(){function e(t,i,n,r){p(this,e),this.name=t,this.troop=i,this.effect=n,this.duration=r}return S(e,[{key:"isPermanent",value:function(){return this.duration<0}},{key:"isRoyal",value:function(){return-10===this.duration}},{key:"isWonder",value:function(){return-9===this.duration}}]),e}(),up=function(){function e(t,i,n){p(this,e),this.name=t,this.effect=i,this.duration=n}return S(e,[{key:"isPermanent",value:function(){return this.duration<0}},{key:"isRoyal",value:function(){return-10===this.duration}},{key:"isWonder",value:function(){return-9===this.duration}}]),e}(),cp=(function(e){e[e.METEORITE=0]="METEORITE",e[e.SMALL_REFUGEE=1]="SMALL_REFUGEE",e[e.MEDIUM_REFUGEE=2]="MEDIUM_REFUGEE"}(cp||(cp={})),cp),lp=(function(e){e[e.LOG=0]="LOG",e[e.WARNING=1]="WARNING",e[e.SUCCESS=2]="SUCCESS",e[e.MYSTICAL=3]="MYSTICAL",e[e.FIGHT_REPORT=4]="FIGHT_REPORT",e[e.ERROR=5]="ERROR"}(lp||(lp={})),lp),hp=(function(e){e[e.DISABLED=0]="DISABLED",e[e.EASY=1]="EASY",e[e.MEDIUM=2]="MEDIUM",e[e.HARD=3]="HARD"}(hp||(hp={})),hp),dp=(function(e){e[e.DEFENSES=0]="DEFENSES",e[e.ROADS=1]="ROADS",e[e.WATCHTOWER=2]="WATCHTOWER",e[e.GUARD_TOWER=3]="GUARD_TOWER",e[e.HARBOUR=4]="HARBOUR"}(dp||(dp={})),dp),gp={AUTO_SAVE_STATUS:!0,AUTO_SAVE_PERIOD:5,METRIC:!0,SAVE_LOGS:!1,PAUSE_ON_INIT:!1,KEEP_RESERVATION_SETTINGS_ON_RESET:!1,KEEP_MANAGEMENT_SETTINGS_ON_RESET:!1,KEEP_AUTO_TRADE_ON_RESET:!1,SOUND_MASTER:!0,SOUND_MASTER_VOLUME:50,SOUND_MUSIC:!0,SOUND_MUSIC_VOLUME:50,SOUND_EFFECTS:!0,SOUND_EFFECTS_VOLUME:50,SOUND_EFFECT_MARKET:!0,SOUND_EFFECT_RESEARCH:!0,SOUND_EFFECT_INVASION:!0,SOUND_EFFECT_SEASON:!0,VISUAL_PROGRESS_BARS:!0,AUTO_TEXT_FITTING:!0,PAGED_VIEW:!1,BUILDINGS_PER_PAGE:12,POSITIVE_COLOUR:"#006400",NEGATIVE_COLOUR:"#8B0000",PLAYER_COLOUR:"#006400",AI_DIFFICULTY:hp.MEDIUM},fp={getBuilding:function(e){var t=this.getBuildings().find(function(t){return t[0]===Pv[e]});if(t)return t[1];console.warn("Invalid building: "+Qv.prepareBuildingName(e))},getBuildings:function(){return Object.entries(this.VILLAGE).concat(Object.entries(this.FORT)).concat(Object.entries(this.FOREST)).concat(Object.entries(this.FIELD)).concat(Object.entries(this.MOUNTAINS)).concat(Object.entries(this.PLATEAU)).concat(Object.entries(this.SEA))},getBuildingRegion:function(e){return Object.keys(this.FOREST).includes(Pv[e])?Yv.FOREST:Object.keys(this.VILLAGE).includes(Pv[e])?Yv.VILLAGE:Object.keys(this.MOUNTAINS).includes(Pv[e])?Yv.MOUNTAINS:Object.keys(this.FIELD).includes(Pv[e])?Yv.FIELD:Object.keys(this.FORT).includes(Pv[e])?Yv.FORT:Object.keys(this.SEA).includes(Pv[e])?Yv.SEA:Object.keys(this.PLATEAU).includes(Pv[e])?Yv.PLATEAU:void 0},DEMOLITION_RETURN:.3,FOREST:{LOGGERS_HUT:{BASE_POWER:5,SIZE:5,COMPLEXITY:5,DESCRIPTION:"Loggers cut trees in the forest",COST:[{resource:Mv.LOG,amount:10}],WEATHER:[{weather:tp.RAIN,effect:-50},{weather:tp.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.AXE,amount:5}]},UPGRADES:[{BASE_POWER:7.5,COMPLEXITY:10,PREREQUISITES:[wv.URBAN_PLANNING],COST:[{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.HAMMER,amount:5},{resource:Mv.AXE,amount:5}]},{BASE_POWER:10,COMPLEXITY:20,PREREQUISITES:[],COST:[{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.COPPER,amount:10},{resource:Mv.AXE,amount:10}]}]},LOGGERS_CAMP:{BASE_POWER:5,SIZE:20,COMPLEXITY:5,DESCRIPTION:"Loggers cut trees in the forest",COST:[{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:10}],WEATHER:[{weather:tp.RAIN,effect:-50},{weather:tp.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.AXE,amount:20}]},UPGRADES:[{BASE_POWER:7.5,COMPLEXITY:10,PREREQUISITES:[wv.URBAN_PLANNING],COST:[{resource:Mv.PLANK,amount:40},{resource:Mv.CUT_STONE,amount:40},{resource:Mv.HAMMER,amount:20},{resource:Mv.AXE,amount:20}]},{BASE_POWER:10,COMPLEXITY:20,PREREQUISITES:[],COST:[{resource:Mv.PLANK,amount:80},{resource:Mv.BRICKS,amount:40},{resource:Mv.BRONZE,amount:20},{resource:Mv.AXE,amount:40}]}]},FORESTER:{BASE_POWER:10,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Forester can plant new trees and control natural growth of the forest",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.SHOVEL,amount:2}],WEATHER:[{weather:tp.RAIN,effect:-100},{weather:tp.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.SHOVEL,amount:5}]}},SAWMILL:{BASE_POWER:3,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Sawmill cut logs into planks",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.CUT_STONE,amount:10}],TEXT:"cutting",INPUT_RESOURCES:[{resource:Mv.LOG,amount:3}],OUTPUT_RESOURCES:[{resource:Mv.PLANK,amount:1}]},GATHERER:{BASE_POWER:10,SIZE:5,COMPLEXITY:3,DESCRIPTION:"Gatherer can find all kinds of useful things in the forest.<br>They can look for either food or resources",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.STONE,amount:5}],WEATHER:[{weather:tp.RAIN,effect:-75},{weather:tp.STORM,effect:-100}],CAN_PRODUCE:[Mv.BERRY,Mv.MUSHROOM,Mv.WHEAT,Mv.HERBS,Mv.BRUSHWOOD,Mv.STONE,Mv.LOG,Mv.COPPER],BERRY_CHANCE:30,MUSHROOM_CHANCE:30,WHEAT_CHANCE:3,BRUSHWOOD_CHANCE:35,STONE_CHANCE:15,LOG_CHANCE:5,COPPER_CHANCE:.5,HERBS_CHANCE:2},GATHERERS_CAMP:{BASE_POWER:10,SIZE:20,COMPLEXITY:15,DESCRIPTION:"It is more efficient to group gatherers together in one place",COST:[{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:10}],WEATHER:[{weather:tp.RAIN,effect:-75},{weather:tp.STORM,effect:-100}],CAN_PRODUCE:[Mv.BERRY,Mv.MUSHROOM,Mv.WHEAT,Mv.HERBS,Mv.BRUSHWOOD,Mv.STONE,Mv.LOG,Mv.COPPER],BERRY_CHANCE:30,MUSHROOM_CHANCE:30,WHEAT_CHANCE:3,BRUSHWOOD_CHANCE:35,STONE_CHANCE:15,LOG_CHANCE:5,COPPER_CHANCE:.5,HERBS_CHANCE:2},HUNTER_LODGE:{BASE_POWER:2,SIZE:5,COMPLEXITY:8,DESCRIPTION:"Hunts animals for meat and fur",COST:[{resource:Mv.LOG,amount:15},{resource:Mv.PLANK,amount:5},{resource:Mv.BOW,amount:1}],WEATHER:[{weather:tp.RAIN,effect:-100},{weather:tp.STORM,effect:-100}],CAN_PRODUCE:[Mv.MEAT,Mv.FUR],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.BOW,amount:5}]}},TANNERY:{BASE_POWER:5,SIZE:5,COMPLEXITY:5,DESCRIPTION:"Turns furs into leather",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10}],TEXT:"tanning",INPUT_RESOURCES:[{resource:Mv.FUR,amount:1}],OUTPUT_RESOURCES:[{resource:Mv.LEATHER,amount:1}]},PAPER_MILL:{BASE_POWER:2,SIZE:20,COMPLEXITY:20,DESCRIPTION:"Produces paper from logs",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.PLANK,amount:10}],TEXT:"producing",INPUT_RESOURCES:[{resource:Mv.LOG,amount:3}],OUTPUT_RESOURCES:[{resource:Mv.PAPER,amount:1}]}},MOUNTAINS:{QUARRY:{BASE_POWER:5,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Cuts stone out of mountains",COST:[{resource:Mv.LOG,amount:40},{resource:Mv.PLANK,amount:20}],WEATHER:[{weather:tp.RAIN,effect:-100},{weather:tp.STORM,effect:-100}],CAN_PRODUCE:[Mv.STONE],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.PICKAXE,amount:5}]}},GEOLOGIST:{BASE_POWER:1,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Looks for useful rocks",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.STONE,amount:5}],WEATHER:[{weather:tp.RAIN,effect:-100},{weather:tp.STORM,effect:-100}],COAL_CHANCE:20,GOLD_CHANCE:4,SILVER_CHANCE:8,COPPER_CHANCE:10,TIN_CHANCE:6,IRON_CHANCE:4},PIT_MINE:{BASE_POWER:2,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Allows workers to mine ores",COST:[{resource:Mv.LOG,amount:60},{resource:Mv.PICKAXE,amount:5}],WEATHER:[{weather:tp.RAIN,effect:-100},{weather:tp.STORM,effect:-100}],GEM_CHANCE:.001,BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.PICKAXE,amount:5},{resource:Mv.SHOVEL,amount:5}]}},METEORITE:{BASE_POWER:3,SIZE:0,COMPLEXITY:0,DESCRIPTION:"Pieces of metal that fell from the sky",COST:[],WEATHER:[{weather:tp.RAIN,effect:-100},{weather:tp.STORM,effect:-100}]},DEEP_MINE:{BASE_POWER:1,SIZE:20,COMPLEXITY:30,DESCRIPTION:"Allows workers to mine ores from under the ground",COST:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50},{resource:Mv.CUT_STONE,amount:50},{resource:Mv.PICKAXE,amount:20},{resource:Mv.SHOVEL,amount:20},{resource:Mv.HAMMER,amount:10}],WEATHER:[],GEM_CHANCE:.002,BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.PICKAXE,amount:10},{resource:Mv.SHOVEL,amount:10}]},UPGRADES:[{BASE_POWER:1,COMPLEXITY:40,PREREQUISITES:[],COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.PICKAXE,amount:5},{resource:Mv.HAMMER,amount:5},{resource:Mv.SHOVEL,amount:5}]},{BASE_POWER:1,COMPLEXITY:50,PREREQUISITES:[],COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.PICKAXE,amount:5},{resource:Mv.HAMMER,amount:5},{resource:Mv.SHOVEL,amount:5}]},{BASE_POWER:1,COMPLEXITY:60,PREREQUISITES:[],COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.PICKAXE,amount:5},{resource:Mv.HAMMER,amount:5},{resource:Mv.SHOVEL,amount:5}]},{BASE_POWER:1,COMPLEXITY:70,PREREQUISITES:[],COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.PICKAXE,amount:5},{resource:Mv.HAMMER,amount:5},{resource:Mv.SHOVEL,amount:5}]}]},STONEMASON:{BASE_POWER:3,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Shapes stones for building",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.STONE,amount:10}],TEXT:"cutting",INPUT_RESOURCES:[{resource:Mv.STONE,amount:3}],OUTPUT_RESOURCES:[{resource:Mv.CUT_STONE,amount:1}]},SMITHY:{BASE_POWER:5,SIZE:10,COMPLEXITY:20,DESCRIPTION:"Provides furnace for smelting ore and metal items",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.COPPER,amount:5}],RECIPES:[{recipe:ip.COPPER,prerequisite:wv.SMITHY},{recipe:ip.TIN,prerequisite:wv.SMITHY},{recipe:ip.BRONZE,prerequisite:wv.BRONZE},{recipe:ip.GOLD,prerequisite:wv.ADVANCED_ORE_PROCESSING},{recipe:ip.SILVER,prerequisite:wv.ADVANCED_ORE_PROCESSING},{recipe:ip.IRON,prerequisite:wv.IRON},{recipe:ip.STEEL,prerequisite:wv.STEEL},{recipe:ip.SWORD,prerequisite:wv.SMITHY},{recipe:ip.BRONZE_SWORD,prerequisite:wv.BRONZE},{recipe:ip.IRON_SWORD,prerequisite:wv.IRON},{recipe:ip.BRONZE_SHIELD,prerequisite:wv.BRONZE},{recipe:ip.IRON_SHIELD,prerequisite:wv.IRON},{recipe:ip.LIGHT_ARMOR,prerequisite:wv.SMITHY},{recipe:ip.HEAVY_ARMOR,prerequisite:wv.BRONZE}]},MINT:{BASE_POWER:3,SIZE:40,COMPLEXITY:20,DESCRIPTION:"Produces coins from gold",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.BRONZE,amount:10}],TEXT:"minting",INPUT_RESOURCES:[{resource:Mv.GOLD,amount:1},{resource:Mv.SILVER,amount:1}],OUTPUT_RESOURCES:[{resource:Mv.COINS,amount:150}]}},VILLAGE:{HUT:{BASE_POWER:.5,FUEL_EFFICIENCY:0,SIZE:10,COMPLEXITY:5,STORAGE:100,TAX:1,DESCRIPTION:"Very primitive shelter but keeps rain and cold away. Houses 2 villagers",COST:[{resource:Mv.FOOD,amount:100},{resource:Mv.LOG,amount:10},{resource:Mv.BRUSHWOOD,amount:10}],MAX_OCCUPANTS:2,UPGRADES:[{BASE_POWER:0,SIZE:15,COMPLEXITY:15,NEW_BUILDING:Pv.HOUSE,PREREQUISITES:[wv.HOUSE],COST:[{resource:Mv.FOOD,amount:100},{resource:Mv.LOG,amount:15},{resource:Mv.BRUSHWOOD,amount:5},{resource:Mv.PLANK,amount:20}]}]},HOUSE:{BASE_POWER:.7,FUEL_EFFICIENCY:.2,SIZE:25,COMPLEXITY:15,STORAGE:200,TAX:1,DESCRIPTION:"Bigger and more durable shelter. Houses 6 villagers.<br>It's more efficient to heat than multiple huts",COST:[{resource:Mv.FOOD,amount:200},{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.BRUSHWOOD,amount:10}],MAX_OCCUPANTS:6,UPGRADES:[{BASE_POWER:0,SIZE:20,COMPLEXITY:20,NEW_BUILDING:Pv.LONGHOUSE,PREREQUISITES:[wv.LONGHOUSE],COST:[{resource:Mv.FOOD,amount:100},{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:30},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.HAY,amount:10}]}]},LONGHOUSE:{BASE_POWER:.9,FUEL_EFFICIENCY:.3,SIZE:45,COMPLEXITY:20,STORAGE:300,TAX:2,DESCRIPTION:"Long building for multiple families. Houses 15 villagers",COST:[{resource:Mv.FOOD,amount:300},{resource:Mv.LOG,amount:40},{resource:Mv.PLANK,amount:40},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.HAY,amount:10}],MAX_OCCUPANTS:15,UPGRADES:[{BASE_POWER:0,SIZE:55,COMPLEXITY:30,NEW_BUILDING:Pv.TUDOR_HOUSE,PREREQUISITES:[wv.TUDOR_HOUSE],COST:[{resource:Mv.FOOD,amount:500},{resource:Mv.LOG,amount:80},{resource:Mv.PLANK,amount:60},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.BRICKS,amount:50}]}]},TUDOR_HOUSE:{BASE_POWER:1.1,FUEL_EFFICIENCY:.35,SIZE:100,COMPLEXITY:30,STORAGE:800,TAX:2,DESCRIPTION:"Very big and durable house. Houses 40 villagers",COST:[{resource:Mv.FOOD,amount:800},{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:80},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.BRICKS,amount:50}],MAX_OCCUPANTS:40,UPGRADES:[{BASE_POWER:0,SIZE:100,COMPLEXITY:60,NEW_BUILDING:Pv.SETTLEMENT,PREREQUISITES:[wv.SETTLEMENT],COST:[{resource:Mv.FOOD,amount:800},{resource:Mv.LOG,amount:150},{resource:Mv.PLANK,amount:110},{resource:Mv.CUT_STONE,amount:40},{resource:Mv.BRICKS,amount:25},{resource:Mv.NAILS,amount:100},{resource:Mv.HAMMER,amount:20},{resource:Mv.SHOVEL,amount:20}]}]},SETTLEMENT:{BASE_POWER:1.3,FUEL_EFFICIENCY:.38,SIZE:200,COMPLEXITY:60,STORAGE:1600,TAX:3,DESCRIPTION:"A group of small buildings that can house up to 90 villagers",COST:[{resource:Mv.FOOD,amount:1600},{resource:Mv.LOG,amount:200},{resource:Mv.PLANK,amount:150},{resource:Mv.CUT_STONE,amount:50},{resource:Mv.BRICKS,amount:50},{resource:Mv.NAILS,amount:100},{resource:Mv.HAMMER,amount:20},{resource:Mv.SHOVEL,amount:20}],MAX_OCCUPANTS:90},WAREHOUSE:{BASE_POWER:0,SIZE:50,COMPLEXITY:10,DESCRIPTION:"Stores selected type of resources",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:5}]},WORKSHOP:{BASE_POWER:5,RESEARCH_POWER:1,CRAFTING_POWER:1.5,SIZE:15,COMPLEXITY:15,DESCRIPTION:"At the workshop workers can do research projects or build complex things",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.BRUSHWOOD,amount:10}]},TAX_COLLECTOR:{BASE_POWER:0,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Tax collector gathers taxes from villagers or give donations",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:20},{resource:Mv.BRICKS,amount:20},{resource:Mv.PAPER,amount:30}]},BUILDERS_GUILD:{BASE_POWER:.5,SIZE:20,COMPLEXITY:10,DESCRIPTION:"Builders guild allow unemployed villagers to automatically work at construction sites. They are not as proficient at this as regular builders and cannot work at wonder buildings construction sites",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:40},{resource:Mv.HAMMER,amount:5},{resource:Mv.SHOVEL,amount:5},{resource:Mv.AXE,amount:5},{resource:Mv.PICKAXE,amount:5}],WEATHER:[{weather:tp.RAIN,effect:-75},{weather:tp.STORM,effect:-100}]},SCHOLARS_LAB:{BASE_POWER:2.5,RESEARCH_POWER:4,SIZE:15,COMPLEXITY:25,DESCRIPTION:"Scholars cannot craft items but they are more efficient at research (each cycle generates 4 research points)",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:20},{resource:Mv.HAY,amount:20},{resource:Mv.PAPER,amount:20}]},KITCHEN:{BASE_POWER:12.5,CRAFTING_POWER:1.5,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Kitchen focuses on processing raw food",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:5},{resource:Mv.CUT_STONE,amount:5},{resource:Mv.POTTERY,amount:5}]},MANUFACTURE:{BASE_POWER:7,CRAFTING_POWER:1.5,SIZE:5,COMPLEXITY:20,DESCRIPTION:"Manufacture specialises in crafting one recipe and it takes time to change production but it produces slightly faster than workshop",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.HAMMER,amount:5}]},MARKETPLACE:{BASE_POWER:1,SIZE:20,COMPLEXITY:5,DESCRIPTION:"Place for trading with other villages",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:10},{resource:Mv.STONE,amount:20}]},TAVERN:{BASE_POWER:1,SIZE:10,COMPLEXITY:20,DESCRIPTION:"Meeting place where villagers can relax and cheer up<br>Consume wine and beer but increase happiness",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.BRUSHWOOD,amount:20}],WEATHER:[{weather:tp.RAIN,effect:25},{weather:tp.STORM,effect:25}]},BAKERY:{BASE_POWER:10,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Bakes bread from flour",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:10},{resource:Mv.STONE,amount:10},{resource:Mv.CUT_STONE,amount:10}],TEXT:"baking",INPUT_RESOURCES:[{resource:Mv.FLOUR,amount:2},{resource:Mv.FUEL,amount:1}],OUTPUT_RESOURCES:[{resource:Mv.BREAD,amount:1}],BUFF:{name:"Bread oven",effect:10,duration:360,cost:[{resource:Mv.CUT_STONE,amount:20}]}},TAILOR:{BASE_POWER:5,SIZE:5,COMPLEXITY:10,DESCRIPTION:"Produces clothes from fabric",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:10}],TEXT:"sewing",INPUT_RESOURCES:[{resource:Mv.FABRIC,amount:3}],OUTPUT_RESOURCES:[{resource:Mv.CLOTHES,amount:1}]},SHRINE:{BASE_POWER:2,POPULATION:8,SIZE:2,COMPLEXITY:8,DESCRIPTION:"Place for prayer and offerings",COST:[{resource:Mv.LOG,amount:5},{resource:Mv.CUT_STONE,amount:5},{resource:Mv.BERRY,amount:10},{resource:Mv.MUSHROOM,amount:10},{resource:Mv.MEAT,amount:10}]},CHURCH:{BASE_POWER:1,POPULATION:20,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Place of prayer and contemplation",COST:[{resource:Mv.LOG,amount:40},{resource:Mv.CUT_STONE,amount:30}],BUFF:{name:"Offering",effect:10,duration:360,cost:[{resource:Mv.COINS,amount:200}]}}},FORT:{BARRACKS:{BASE_POWER:0,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Housing for troops",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.CUT_STONE,amount:10}]},TRAINING_SQUARE:{BASE_POWER:10,SIZE:10,COMPLEXITY:3,DESCRIPTION:"Place for training recruits",COST:[{resource:Mv.STONE,amount:40}],WEATHER:[{weather:tp.RAIN,effect:-50},{weather:tp.STORM,effect:-100}]},EMBASSY:{BASE_POWER:1,SIZE:20,COMPLEXITY:10,DESCRIPTION:"Ambassadors work here to improve relations with other kingdoms",COST:[{resource:Mv.PLANK,amount:30},{resource:Mv.CUT_STONE,amount:30}]},STOCKADE:{BASE_POWER:10,SIZE:50,COMPLEXITY:100,DESCRIPTION:"Protective wall around the village to protect against attackers",COST:[{resource:Mv.LOG,amount:100},{resource:Mv.STONE,amount:10}],DEFENSE:2,DURABILITY:50},WOODEN_TOWER:{BASE_POWER:10,SIZE:10,COMPLEXITY:30,DESCRIPTION:" Provide passive defense power",COST:[{resource:Mv.LOG,amount:40},{resource:Mv.PLANK,amount:20}],DEFENSE:3,DURABILITY:50},STONE_TOWER:{BASE_POWER:10,SIZE:10,COMPLEXITY:30,DESCRIPTION:"Provide passive defense power, more durable than wooden tower",COST:[{resource:Mv.CUT_STONE,amount:40},{resource:Mv.PLANK,amount:20}],DEFENSE:3,DURABILITY:100},STASH:{BASE_POWER:1,SIZE:10,COMPLEXITY:30,DESCRIPTION:"Complex hidden tunnels allow us to hide some resources in case of invasion",COST:[{resource:Mv.LOG,amount:30},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.PLANK,amount:10},{resource:Mv.PICKAXE,amount:5}]}},FIELD:{FARM:{BASE_POWER:20,SIZE:15,COMPLEXITY:10,DESCRIPTION:"Farm allows workers to work on fields, orchard and pastures",COST:[{resource:Mv.LOG,amount:40},{resource:Mv.PLANK,amount:20},{resource:Mv.STONE,amount:10}],WEATHER:[{weather:tp.RAIN,effect:-50},{weather:tp.STORM,effect:-100}],BUFF:{name:"New tools",effect:10,duration:360,cost:[{resource:Mv.SHOVEL,amount:5}]},UPGRADES:[{BASE_POWER:22,COMPLEXITY:10,PREREQUISITES:[wv.URBAN_PLANNING],COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.HAMMER,amount:5},{resource:Mv.SHOVEL,amount:5}]}]},BARN:{BASE_POWER:0,SIZE:50,COMPLEXITY:10,DESCRIPTION:"Stores selected type of crops",COST:[{resource:Mv.LOG,amount:40},{resource:Mv.PLANK,amount:20},{resource:Mv.HAY,amount:20},{resource:Mv.CUT_STONE,amount:10}]},WINDMILL:{BASE_POWER:10,SIZE:20,COMPLEXITY:15,DESCRIPTION:"Windmill turns wheat into flour",COST:[{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:10},{resource:Mv.FABRIC,amount:20}],TEXT:"milling",INPUT_RESOURCES:[{resource:Mv.WHEAT,amount:1}],OUTPUT_RESOURCES:[{resource:Mv.FLOUR,amount:2}],WEATHER:[{weather:tp.WIND,effect:50},{weather:tp.STORM,effect:-100}]},COTTON_MILL:{BASE_POWER:5,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Spins cotton into fabric",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:10}],TEXT:"spinning",INPUT_RESOURCES:[{resource:Mv.COTTON,amount:2}],OUTPUT_RESOURCES:[{resource:Mv.FABRIC,amount:1}]},BREWERY:{BASE_POWER:1,SIZE:25,COMPLEXITY:20,DESCRIPTION:"Brews delicious beer",COST:[{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:30},{resource:Mv.COPPER,amount:5},{resource:Mv.POTTERY,amount:10}],TEXT:"brewing",INPUT_RESOURCES:[{resource:Mv.BARLEY,amount:10},{resource:Mv.HOP,amount:5},{resource:Mv.FUEL,amount:3}],OUTPUT_RESOURCES:[{resource:Mv.BEER,amount:20}]},FIELD:{BASE_POWER:1,SIZE:50,COMPLEXITY:1,DESCRIPTION:"Various crops can be grown here (Farm required to work on fields)",COST:[{resource:Mv.STONE,amount:4}],WEATHER:[{weather:tp.RAIN,effect:50},{weather:tp.SUN,effect:50},{weather:tp.CLOUDS,effect:-25}]},BUTCHER:{BASE_POWER:5,SIZE:15,COMPLEXITY:10,DESCRIPTION:"Turns animals from pastures into meat",COST:[{resource:Mv.LOG,amount:15},{resource:Mv.PLANK,amount:10},{resource:Mv.CUT_STONE,amount:5}]},ORCHARD:{BASE_POWER:1,SIZE:50,COMPLEXITY:1,DESCRIPTION:"Various fruit trees and bushes can be grown here (Farm required to work on orchards)",COST:[{resource:Mv.LOG,amount:5}],WEATHER:[{weather:tp.RAIN,effect:50},{weather:tp.SUN,effect:50},{weather:tp.CLOUDS,effect:-25}]},PASTURE:{BASE_POWER:1,SIZE:50,COMPLEXITY:3,DESCRIPTION:"Many animals can be grown here (Farm required to work on pastures). <br>After building pasture and selecting animal type it is possible to use hunter lodges to tame animals or buy them from market.<br>Animals start to breed if there are at least two of them in a pasture.",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:20}]},CLAY_PIT:{BASE_POWER:5,SIZE:15,COMPLEXITY:15,DESCRIPTION:"We can extract clay here",COST:[{resource:Mv.LOG,amount:15},{resource:Mv.PLANK,amount:5}],WEATHER:[{weather:tp.RAIN,effect:-100},{weather:tp.STORM,effect:-100}],CAN_PRODUCE:[Mv.CLAY]},WINERY:{BASE_POWER:1,SIZE:25,COMPLEXITY:10,DESCRIPTION:"Extracts and ferments grape juices",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.COPPER,amount:5},{resource:Mv.POTTERY,amount:10}],TEXT:"fermenting",INPUT_RESOURCES:[{resource:Mv.GRAPE,amount:35}],OUTPUT_RESOURCES:[{resource:Mv.WINE,amount:16}]}},SEA:{FISHERS_HUT:{BASE_POWER:5,SIZE:5,COMPLEXITY:5,DESCRIPTION:"Fishers catch fish in the sea",COST:[{resource:Mv.LOG,amount:10},{resource:Mv.PLANK,amount:5},{resource:Mv.COPPER,amount:1}],WEATHER:[{weather:tp.RAIN,effect:25},{weather:tp.STORM,effect:-100},{weather:tp.WIND,effect:25}]},PIER:{BASE_POWER:0,SIZE:25,HARBOUR_SIZE:80,COMPLEXITY:40,DESCRIPTION:"Pier is where your boats can dock",COST:[{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:20},{resource:Mv.COPPER,amount:10}]},HARBOUR:{BASE_POWER:0,SIZE:200,HARBOUR_SIZE:800,COMPLEXITY:60,DESCRIPTION:"Harbour can dock many more boats and ships than pier",COST:[{resource:Mv.CUT_STONE,amount:50},{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:20},{resource:Mv.BRONZE,amount:20},{resource:Mv.IRON,amount:20}]},LIGHTHOUSE:{BASE_POWER:0,SIZE:20,COMPLEXITY:20,DESCRIPTION:"Sailors can better navigate at sea when lighthouse light guide them",COST:[{resource:Mv.CUT_STONE,amount:20},{resource:Mv.LOG,amount:10},{resource:Mv.BRONZE,amount:5},{resource:Mv.FUEL,amount:5}]},BOAT_BUILDER:{BASE_POWER:1,SIZE:20,COMPLEXITY:30,DESCRIPTION:"Boat builder can craft small boats",COST:[{resource:Mv.LOG,amount:30},{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.HAMMER,amount:10}]},SHIPYARD:{BASE_POWER:2,SIZE:50,COMPLEXITY:50,DESCRIPTION:"Shipyards excel in building even the biggest ships",COST:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50},{resource:Mv.BRICKS,amount:50},{resource:Mv.HAMMER,amount:20}]},CARTOGRAPHER:{BASE_POWER:2,SIZE:10,COMPLEXITY:10,DESCRIPTION:"Gathers information produced by sea missions and by creating star maps to help navigating to distant lands",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10},{resource:Mv.PAPER,amount:50}]}},PLATEAU:{STONEHENGE:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"Huge rocks mark place for old rituals and scientific experiments",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.PICKAXE,amount:10},{resource:Mv.HAMMER,amount:10}],progress:10},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.STONE,amount:100}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.STONE,amount:100}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.STONE,amount:100}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10}],BUILDING_EFFECTS:[{building:Pv.WORKSHOP,value:20},{building:Pv.KITCHEN,value:10},{building:Pv.MANUFACTURE,value:10}],RP:20},PYRAMID:{BASE_POWER:3,SIZE:100,COMPLEXITY:0,DESCRIPTION:"Although it's just \"putting one rock on the other\", our construction worker's skill will be put to the test with this huge project",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.PICKAXE,amount:10},{resource:Mv.HAMMER,amount:10}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:50}],progress:10},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:5},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:5},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:5},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:5}],BUILDING_EFFECTS:[{building:Pv.CONSTRUCTION,value:10},{building:Pv.DECONSTRUCTION,value:10},{building:Pv.BUILDERS_GUILD,value:10}],RP:20},HANGING_GARDEN:{BASE_POWER:3,SIZE:30,COMPLEXITY:0,DESCRIPTION:"With all those plants that cover entire buildings we truly became masters of flora",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.HAMMER,amount:10},{resource:Mv.AXE,amount:10}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.BERRY,amount:75},{resource:Mv.MUSHROOM,amount:75}],progress:10},{cost:[{resource:Mv.SHOVEL,amount:20}],progress:10},{cost:[{resource:Mv.WHEAT,amount:100}],progress:10},{cost:[{resource:Mv.BARLEY,amount:100}],progress:10},{cost:[{resource:Mv.APPLE,amount:100}],progress:10},{cost:[{resource:Mv.HOP,amount:100}],progress:10},{cost:[{resource:Mv.COTTON,amount:100}],progress:10},{cost:[{resource:Mv.GRAPE,amount:100}],progress:10}],BUILDING_EFFECTS:[{building:Pv.FARM,value:15}],RP:20},COLOSSUS:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"This giant statue watches over our troops both during defense and attack",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.PICKAXE,amount:10},{resource:Mv.HAMMER,amount:10}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.STONE,amount:75},{resource:Mv.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.STONE,amount:75},{resource:Mv.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.STONE,amount:75},{resource:Mv.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.STONE,amount:75},{resource:Mv.CUT_STONE,amount:75}],progress:10},{cost:[{resource:Mv.COPPER,amount:100},{resource:Mv.HAMMER,amount:20}],progress:10}],ARMY_EFFECTS:[{troop:Bv.ALL,value:15}],RP:20},UNDERGROUND_CITY:{BASE_POWER:3,SIZE:0,COMPLEXITY:0,DESCRIPTION:"After connecting empty mines tunnels and repurposing them we will create entire underground city",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.HAMMER,amount:10},{resource:Mv.PICKAXE,amount:10}],progress:10},{cost:[{resource:Mv.LOG,amount:100}],progress:10},{cost:[{resource:Mv.SHOVEL,amount:20},{resource:Mv.HAMMER,amount:20},{resource:Mv.PICKAXE,amount:20}],progress:10},{cost:[{resource:Mv.LOG,amount:100}],progress:10},{cost:[{resource:Mv.SHOVEL,amount:20},{resource:Mv.HAMMER,amount:20},{resource:Mv.PICKAXE,amount:20}],progress:10},{cost:[{resource:Mv.LOG,amount:100}],progress:10},{cost:[{resource:Mv.SHOVEL,amount:20},{resource:Mv.HAMMER,amount:20},{resource:Mv.PICKAXE,amount:20}],progress:10},{cost:[{resource:Mv.LOG,amount:100}],progress:10},{cost:[{resource:Mv.SHOVEL,amount:20},{resource:Mv.HAMMER,amount:20},{resource:Mv.PICKAXE,amount:20}],progress:10},{cost:[{resource:Mv.LOG,amount:50},{resource:Mv.CUT_STONE,amount:50}],progress:10}],BUILDING_EFFECTS:[{building:Pv.DEEP_MINE,value:15},{building:Pv.PIT_MINE,value:15},{building:Pv.QUARRY,value:15},{building:Pv.GEOLOGIST,value:15}],RP:20},GREAT_LIGHTHOUSE:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"Light from this building can be seen as far as anyone would like to ever travel",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.HAMMER,amount:10},{resource:Mv.PICKAXE,amount:10}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:50}],progress:10},{cost:[{resource:Mv.CUT_STONE,amount:100}],progress:10},{cost:[{resource:Mv.PLANK,amount:100}],progress:10}],BUILDING_EFFECTS:[{building:Pv.BOAT_BUILDER,value:20},{building:Pv.SHIPYARD,value:10}],ARMY_EFFECTS:[{troop:Bv.BOAT,value:10},{troop:Bv.BRIGANTINE,value:10},{troop:Bv.GALLEON,value:10}],RP:20},SACRED_GROVE:{BASE_POWER:3,SIZE:50,COMPLEXITY:0,DESCRIPTION:"Collection of the oldest and greatest forest fauna and flora in one place",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.HAMMER,amount:10},{resource:Mv.PICKAXE,amount:10}],progress:10},{cost:[{resource:Mv.BERRY,amount:100},{resource:Mv.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Mv.CHICKEN,amount:20},{resource:Mv.HORSE,amount:10},{resource:Mv.PIG,amount:10}],progress:10},{cost:[{resource:Mv.BERRY,amount:200},{resource:Mv.MUSHROOM,amount:200}],progress:10},{cost:[{resource:Mv.BERRY,amount:100},{resource:Mv.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Mv.CHICKEN,amount:20},{resource:Mv.HORSE,amount:10},{resource:Mv.PIG,amount:10}],progress:10},{cost:[{resource:Mv.BERRY,amount:100},{resource:Mv.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Mv.CHICKEN,amount:20},{resource:Mv.HORSE,amount:10},{resource:Mv.PIG,amount:10}],progress:10},{cost:[{resource:Mv.BERRY,amount:100},{resource:Mv.MUSHROOM,amount:100}],progress:10},{cost:[{resource:Mv.BERRY,amount:200},{resource:Mv.MUSHROOM,amount:200}],progress:10}],BUILDING_EFFECTS:[{building:Pv.FORESTER,value:10},{building:Pv.LOGGERS_HUT,value:10},{building:Pv.LOGGERS_CAMP,value:10},{building:Pv.HUNTER_LODGE,value:10},{building:Pv.GATHERER,value:10},{building:Pv.GATHERERS_CAMP,value:10}],RP:20},ASCENSION_TEMPLE:{BASE_POWER:1.5,SIZE:100,COMPLEXITY:0,DESCRIPTION:"Mystical place where your fate will be determined",COST:[],STAGES:[{cost:[{resource:Mv.SHOVEL,amount:10},{resource:Mv.HAMMER,amount:10},{resource:Mv.PICKAXE,amount:10}],progress:5},{cost:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:100}],progress:5},{cost:[{resource:Mv.CUT_STONE,amount:100},{resource:Mv.PLANK,amount:100}],progress:10},{cost:[{resource:Mv.COPPER,amount:50},{resource:Mv.IRON,amount:50},{resource:Mv.STEEL,amount:50}],progress:5},{cost:[{resource:Mv.GOLD,amount:50},{resource:Mv.SILVER,amount:50}],progress:5},{cost:[{resource:Mv.CUT_STONE,amount:100},{resource:Mv.PLANK,amount:100}],progress:10},{cost:[{resource:Mv.COPPER,amount:50},{resource:Mv.IRON,amount:50},{resource:Mv.STEEL,amount:50}],progress:5},{cost:[{resource:Mv.GOLD,amount:50},{resource:Mv.SILVER,amount:50}],progress:5},{cost:[{resource:Mv.CUT_STONE,amount:100},{resource:Mv.PLANK,amount:100}],progress:10},{cost:[{resource:Mv.COPPER,amount:50},{resource:Mv.IRON,amount:50},{resource:Mv.STEEL,amount:50}],progress:5},{cost:[{resource:Mv.GOLD,amount:50},{resource:Mv.SILVER,amount:50}],progress:5},{cost:[{resource:Mv.CUT_STONE,amount:100},{resource:Mv.PLANK,amount:100}],progress:10},{cost:[{resource:Mv.COPPER,amount:50},{resource:Mv.IRON,amount:50},{resource:Mv.STEEL,amount:50}],progress:5},{cost:[{resource:Mv.GOLD,amount:50},{resource:Mv.SILVER,amount:50}],progress:5},{cost:[{resource:Mv.GOLD,amount:100},{resource:Mv.SILVER,amount:100}],progress:10}],RP:50}},CONSTRUCTION_SITE:{BASE_POWER:10,SIZE:0,COMPLEXITY:0,DESCRIPTION:"",COST:[],WEATHER:[{weather:tp.RAIN,effect:-75},{weather:tp.STORM,effect:-100}]},DECONSTRUCTION_SITE:{BASE_POWER:10,SIZE:0,COMPLEXITY:0,DESCRIPTION:"",COST:[],WEATHER:[{weather:tp.RAIN,effect:-75},{weather:tp.STORM,effect:-100}]}},vp={getResource:function(e){var t=this.getResources().find(function(t){return t[0]===Mv[e]});if(t)return t[1];console.warn("Invalid resource: "+Qv.prepareResourceName(e))},getResourcesByType:function(e){var t=this.getResources().filter(function(t){return t[1].TYPES.includes(e)});if(t)return t;console.warn("Invalid resource type: "+Qv.prepareResourceTypeName(e))},getResources:function(){return Object.entries(this.RAW).concat(Object.entries(this.PROCESSED)).concat(Object.entries(this.FOOD)).concat(Object.entries(this.TOOLS))},DEFAULT_AMOUNT:0,DEFAULT_LIMIT:50,DEFAULT_VISIBLE:!1,DEFAULT_HIGHLIGHTED:!1,RAW:{LOG:{TYPES:[Hv.RAW,Hv.FUEL],TRADE_VALUE:2,AMOUNT:20,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,FUEL_PRIORITY:3,POWER:10},BRUSHWOOD:{TYPES:[Hv.RAW,Hv.FUEL],TRADE_VALUE:1,AMOUNT:20,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,FUEL_PRIORITY:4,POWER:5.5},STONE:{TYPES:[Hv.RAW],TRADE_VALUE:3,AMOUNT:20,LIMIT:100,VISIBLE:!0},FUR:{TYPES:[Hv.RAW],TRADE_VALUE:3},WHEAT:{TYPES:[Hv.RAW],TRADE_VALUE:2},BARLEY:{TYPES:[Hv.RAW],TRADE_VALUE:3},HOP:{TYPES:[Hv.RAW],TRADE_VALUE:3},COTTON:{TYPES:[Hv.RAW],TRADE_VALUE:3},WOOL:{TYPES:[Hv.RAW],TRADE_VALUE:3},HERBS:{TYPES:[Hv.RAW],TRADE_VALUE:2},HAY:{TYPES:[Hv.RAW],TRADE_VALUE:2},CLAY:{TYPES:[Hv.RAW],TRADE_VALUE:2},CHICKEN:{TYPES:[Hv.RAW,Hv.ANIMAL],LIMIT:0,SIZE:2,MEAT:8,FUR:0,REPRODUCTION_SPEED:6,BUTCHERING_DIFFICULTY:1,TRADE_VALUE:20},SHEEP:{TYPES:[Hv.RAW,Hv.ANIMAL],LIMIT:0,SIZE:3,MEAT:16,FUR:1,REPRODUCTION_SPEED:4,BUTCHERING_DIFFICULTY:1,TRADE_VALUE:25},COW:{TYPES:[Hv.RAW,Hv.ANIMAL],LIMIT:0,SIZE:5,MEAT:60,FUR:3,REPRODUCTION_SPEED:1,BUTCHERING_DIFFICULTY:3,TRADE_VALUE:40},PIG:{TYPES:[Hv.RAW,Hv.ANIMAL],LIMIT:0,SIZE:3,MEAT:30,FUR:2,REPRODUCTION_SPEED:5,BUTCHERING_DIFFICULTY:3,TRADE_VALUE:30},HORSE:{TYPES:[Hv.RAW,Hv.ANIMAL],LIMIT:0,SIZE:5,MEAT:20,FUR:1,REPRODUCTION_SPEED:1,BUTCHERING_DIFFICULTY:5,TRADE_VALUE:50},COAL:{TYPES:[Hv.RAW,Hv.FUEL],TRADE_VALUE:8,FUEL_PRIORITY:2,POWER:50},GOLD_ORE:{TYPES:[Hv.RAW],TRADE_VALUE:40},SILVER_ORE:{TYPES:[Hv.RAW],TRADE_VALUE:20},COPPER_ORE:{TYPES:[Hv.RAW],TRADE_VALUE:13},TIN_ORE:{TYPES:[Hv.RAW],TRADE_VALUE:20},IRON_ORE:{TYPES:[Hv.RAW],TRADE_VALUE:40},GEMS:{TYPES:[Hv.RAW],TRADE_VALUE:100}},PROCESSED:{PLANK:{TYPES:[Hv.PROCESSED],TRADE_VALUE:3,VISIBLE:!0},CUT_STONE:{TYPES:[Hv.PROCESSED],TRADE_VALUE:5},FUEL:{TYPES:[Hv.PROCESSED,Hv.FUEL],TRADE_VALUE:3,FUEL_PRIORITY:1,POWER:12.5},FLOUR:{TYPES:[Hv.PROCESSED],TRADE_VALUE:3},FABRIC:{TYPES:[Hv.PROCESSED],TRADE_VALUE:7},LEATHER:{TYPES:[Hv.PROCESSED],TRADE_VALUE:4},PAPER:{TYPES:[Hv.PROCESSED],TRADE_VALUE:8},POTTERY:{TYPES:[Hv.PROCESSED],TRADE_VALUE:10},BRICKS:{TYPES:[Hv.PROCESSED],TRADE_VALUE:17},COINS:{TYPES:[Hv.PROCESSED],TRADE_VALUE:1,LIMIT:Number.MAX_SAFE_INTEGER},COPPER:{TYPES:[Hv.PROCESSED],TRADE_VALUE:32},GOLD:{TYPES:[Hv.PROCESSED],TRADE_VALUE:90},SILVER:{TYPES:[Hv.PROCESSED],TRADE_VALUE:45},TIN:{TYPES:[Hv.PROCESSED],TRADE_VALUE:45},BRONZE:{TYPES:[Hv.PROCESSED],TRADE_VALUE:50},IRON:{TYPES:[Hv.PROCESSED],TRADE_VALUE:135},STEEL:{TYPES:[Hv.PROCESSED],TRADE_VALUE:190},FISH_FOOD:{TYPES:[Hv.PROCESSED],TRADE_VALUE:5}},FOOD:{BERRY:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:2,AMOUNT:50,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,POWER:50},MUSHROOM:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:2,AMOUNT:50,LIMIT:100,VISIBLE:!0,HIGHLIGHTED:!0,POWER:50},FISH:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:3,POWER:75},APPLE:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:1,POWER:25},GRAPE:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:1,POWER:20},BREAD:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:10,POWER:300},MEAT:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:3,POWER:75},EGG:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:1,POWER:25},MILK:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:1,POWER:25},CHEESE:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:9,POWER:200},COOKED_FISH:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:8,POWER:175},COOKED_MEAT:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:8,POWER:175},VEGETABLE_SOUP:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:10,POWER:225},MEAT_SOUP:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:10,POWER:225},OMELETTE:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:10,POWER:225},PIE:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:12,POWER:250},BOUILLABAISSE:{TYPES:[Hv.FOOD,Hv.CONSUMABLE],TRADE_VALUE:32,POWER:900},BEER:{TYPES:[Hv.FOOD],TRADE_VALUE:3},WINE:{TYPES:[Hv.FOOD],TRADE_VALUE:5},HERBAL_MEDICINE:{TYPES:[Hv.FOOD],TRADE_VALUE:15}},TOOLS:{CLOTHES:{TYPES:[Hv.TOOLS],VISIBLE:!0,AMOUNT:10,TRADE_VALUE:25},PICKAXE:{TYPES:[Hv.TOOLS],TRADE_VALUE:35},SHOVEL:{TYPES:[Hv.TOOLS],TRADE_VALUE:35},AXE:{TYPES:[Hv.TOOLS],TRADE_VALUE:35},HAMMER:{TYPES:[Hv.TOOLS],TRADE_VALUE:35},BOW:{TYPES:[Hv.TOOLS],TRADE_VALUE:35},SPEAR:{TYPES:[Hv.TOOLS],TRADE_VALUE:35},NAILS:{TYPES:[Hv.TOOLS],TRADE_VALUE:12},MAP:{TYPES:[Hv.TOOLS],TRADE_VALUE:1e3},SWORD:{TYPES:[Hv.TOOLS],TRADE_VALUE:190},SHIELD:{TYPES:[Hv.TOOLS],TRADE_VALUE:30},LEATHER_ARMOR:{TYPES:[Hv.TOOLS],TRADE_VALUE:50},LIGHT_ARMOR:{TYPES:[Hv.TOOLS],TRADE_VALUE:400},HEAVY_ARMOR:{TYPES:[Hv.TOOLS],TRADE_VALUE:550},CANNON:{TYPES:[Hv.TOOLS],TRADE_VALUE:2e3},JEWELRY:{TYPES:[Hv.TOOLS],TRADE_VALUE:300}}},pp={getTroop:function(e){var t=Object.entries(this.TROOPS).find(function(t){return t[0]===Bv[e]});if(t)return t[1];console.warn("Invalid troop: "+Qv.prepareTroopName(e))},getMission:function(e){var t=Object.entries(this.MISSIONS).find(function(t){return t[0]===Fv[e]});if(t)return t[1];console.warn("Invalid mission: "+Qv.prepareMissionName(e))},TROOPS:{COLONIST:{SIZE:1,CARGO:0,SPEED:3},SPY:{SIZE:1,CARGO:0,RECRUIT_TIME:10,STRENGTH:0,DEFENSE:1,PAY:5,SPEED:10,COST:[{resource:Mv.CLOTHES,amount:1},{resource:Mv.COINS,amount:20}]},MILITIA:{SIZE:1,CARGO:0,RECRUIT_TIME:3,STRENGTH:0,DEFENSE:2,PAY:0,SPEED:3,COST:[{resource:Mv.FUR,amount:5}],AI_COST:3},SPEARMAN:{SIZE:1,CARGO:0,RECRUIT_TIME:12,STRENGTH:5,DEFENSE:2,PAY:2,SPEED:6,COST:[{resource:Mv.SPEAR,amount:1},{resource:Mv.LEATHER_ARMOR,amount:1}],AI_COST:6},ARCHER:{SIZE:1,CARGO:0,RECRUIT_TIME:12,STRENGTH:2,DEFENSE:5,PAY:2,SPEED:6,COST:[{resource:Mv.BOW,amount:1},{resource:Mv.LEATHER_ARMOR,amount:1}],AI_COST:6},SWORDSMAN:{SIZE:2,CARGO:0,RECRUIT_TIME:22,STRENGTH:9,DEFENSE:4,PAY:5,SPEED:5,COST:[{resource:Mv.SWORD,amount:1},{resource:Mv.SHIELD,amount:1},{resource:Mv.LEATHER_ARMOR,amount:1}],AI_COST:10},LIGHT_CAVALRY:{SIZE:3,CARGO:0,RECRUIT_TIME:30,STRENGTH:15,DEFENSE:6,PAY:10,SPEED:10,COST:[{resource:Mv.HORSE,amount:1},{resource:Mv.SWORD,amount:1},{resource:Mv.LIGHT_ARMOR,amount:1}],AI_COST:15},HORSE_ARCHER:{SIZE:3,CARGO:0,RECRUIT_TIME:30,STRENGTH:6,DEFENSE:15,PAY:10,SPEED:10,COST:[{resource:Mv.HORSE,amount:1},{resource:Mv.BOW,amount:1},{resource:Mv.LIGHT_ARMOR,amount:1}],AI_COST:15},BOAT:{SIZE:5,CARGO:5,COMPLEXITY:5,SPEED:5,STRENGTH:0,DEFENSE:0,COST:[{resource:Mv.PLANK,amount:10},{resource:Mv.LOG,amount:5},{resource:Mv.FABRIC,amount:10},{resource:Mv.HAMMER,amount:5},{resource:Mv.NAILS,amount:10}],PAY:10,CREW:1,AI_COST:0},BRIGANTINE:{SIZE:40,CARGO:40,COMPLEXITY:20,SPEED:15,STRENGTH:6,DEFENSE:6,COST:[{resource:Mv.PLANK,amount:100},{resource:Mv.LOG,amount:50},{resource:Mv.FABRIC,amount:40},{resource:Mv.IRON,amount:20},{resource:Mv.HAMMER,amount:20},{resource:Mv.NAILS,amount:40},{resource:Mv.CANNON,amount:6}],PAY:80,CREW:10,AI_COST:0},GALLEON:{SIZE:150,CARGO:300,COMPLEXITY:50,SPEED:10,STRENGTH:30,DEFENSE:30,COST:[{resource:Mv.PLANK,amount:350},{resource:Mv.LOG,amount:200},{resource:Mv.FABRIC,amount:200},{resource:Mv.IRON,amount:80},{resource:Mv.HAMMER,amount:50},{resource:Mv.NAILS,amount:200},{resource:Mv.CANNON,amount:20}],PAY:300,CREW:25,AI_COST:0},GUARD_TOWER:{SIZE:0,CARGO:0,COMPLEXITY:0,SPEED:0,STRENGTH:0,DEFENSE:10,COST:[],PAY:0,CREW:0,AI_COST:10}},MISSIONS:{MOVE:{TIME:3,ICON:"move",DESCRIPTION:"Move your troops to another region",COST:[{resource:Mv.FOOD,amount:20}]},BUILD:{TIME:10,ICON:"build",DESCRIPTION:"Improve region defenses",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.CUT_STONE,amount:20}]},COLONIZE:{TIME:3,ICON:"colonize",DESCRIPTION:"Connect this unowned land to your kingdom",COST:[{resource:Mv.FOOD,amount:200},{resource:Mv.LOG,amount:3},{resource:Mv.BRUSHWOOD,amount:2},{resource:Mv.FUEL,amount:1}]},SPY:{TIME:7,ICON:"spy",DESCRIPTION:"Try to find out military strength of the enemy and region wealth",COST:[{resource:Mv.FOOD,amount:100}]},PLUNDER:{TIME:2,ICON:"plunder",DESCRIPTION:"Plunder your enemies",COST:[{resource:Mv.FOOD,amount:100}]},CONQUER:{TIME:3,ICON:"conquer",DESCRIPTION:"Conquer your enemies and claim their land",COST:[{resource:Mv.FOOD,amount:200}]},FISHING:{TIME:3,ICON:"fish",DESCRIPTION:"Catch fish from the sea",COST:[{resource:Mv.FOOD,amount:200}]},HUNTING:{TIME:3,ICON:"hunting",DESCRIPTION:"Hunt the bigger fish",COST:[{resource:Mv.FOOD,amount:200}]},TREASURE:{TIME:2,ICON:"treasure",DESCRIPTION:"Collect treasure",COST:[{resource:Mv.FOOD,amount:200}]},CARTOGRAPHY:{TIME:3,ICON:"cartography",DESCRIPTION:"Gather information about all islands and stars during night",COST:[{resource:Mv.FOOD,amount:200}]},EXPEDITION:{TIME:12,ICON:"expedition",DESCRIPTION:"Discover distant lands",COST:[{resource:Mv.FOOD,amount:20}]},SEA_BATTLE:{TIME:2,ICON:"battle",DESCRIPTION:"Sea battle with other ships",COST:[{resource:Mv.FOOD,amount:200}]},SEA_PLUNDER:{TIME:2,ICON:"plunder",DESCRIPTION:"Plunder your enemies",COST:[{resource:Mv.FOOD,amount:100}]},SEA_CONQUER:{TIME:3,ICON:"conquer",DESCRIPTION:"Conquer your enemies and claim their land",COST:[{resource:Mv.FOOD,amount:200}]},SEA_MOVE:{TIME:3,ICON:"move",DESCRIPTION:"Move your troops to another region",COST:[{resource:Mv.FOOD,amount:20}]}}},mp={getCrop:function(e){var t=this.getCrops().find(function(t){return t[0]===Uv[e]});if(t)return t[1];console.warn("Invalid crop: "+Qv.prepareCropName(e))},getCrops:function(){return Object.entries(this.FIELD).concat(Object.entries(this.ORCHARD))},FIELD:{WHEAT:{CROP:Uv.WHEAT,GROWTH:20,YIELD_MULTIPLIER:2},BARLEY:{CROP:Uv.BARLEY,GROWTH:20,YIELD_MULTIPLIER:2,PREREQUISITE:wv.BARLEY},HAY:{CROP:Uv.HAY,GROWTH:10,YIELD_MULTIPLIER:1.5},HOP:{CROP:Uv.HOP,GROWTH:20,YIELD_MULTIPLIER:2,PREREQUISITE:wv.HOPS},HERBS:{CROP:Uv.HERBS,GROWTH:20,YIELD_MULTIPLIER:4,PREREQUISITE:wv.HERBALISM},MUSHROOM:{CROP:Uv.MUSHROOM,GROWTH:10,YIELD_MULTIPLIER:1},COTTON:{CROP:Uv.COTTON,GROWTH:20,YIELD_MULTIPLIER:2,PREREQUISITE:wv.COTTON}},ORCHARD:{BERRY:{CROP:Uv.BERRY,GROWTH:25,FRUITING:15,YIELD_MULTIPLIER:1},GRAPE:{CROP:Uv.GRAPE,GROWTH:50,FRUITING:15,YIELD_MULTIPLIER:1},APPLE:{CROP:Uv.APPLE,GROWTH:75,FRUITING:25,YIELD_MULTIPLIER:2}}},Sp={SCIENTIFIC_METHOD:{CATEGORY:np.SCIENCE,COST:[],RESEARCH_POINT:5,DESCRIPTION:"Maybe there is something we don't know about yet?",FINISH_DESCRIPTION:"We learned how to research things",PREREQUISITES:[],FINISH:function(e){e.getLogService().log("New research projects unlocked")}},FORESIGHT:{CATEGORY:np.SCIENCE,COST:[],RESEARCH_POINT:20,DESCRIPTION:"If only we knew what we don't know",FINISH_DESCRIPTION:"We gained insight into what can be researched in close future",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getTechService().increaseForesight(1),e.getLogService().log("Foresight level increased")}},CARTOGRAPHY:{CATEGORY:np.SCIENCE,COST:[],RESEARCH_POINT:50,DESCRIPTION:"What if we combine all the information we get from visitors and scouts?",FINISH_DESCRIPTION:"We unlocked world map and gained insight into what happens in the world",PREREQUISITES:[Lv.FORESIGHT],FINISH:function(e){e.getGameService().enable(wv.CARTOGRAPHY),e.getLogService().log("World map unlocked")}},MANAGEMENT:{CATEGORY:np.GENERAL,COST:[],RESEARCH_POINT:30,DESCRIPTION:"Maybe we could make some hard decisions which could help us survive?",FINISH_DESCRIPTION:"Now we have access to many management options",PREREQUISITES:[Lv.FORESIGHT],FINISH:function(e){e.getGameService().enable(wv.MANAGEMENT),e.getLogService().log("Management tab unlocked")}},TAX:{CATEGORY:np.GENERAL,COST:[],RESEARCH_POINT:100,DESCRIPTION:"Could we gather money from citizens?",FINISH_DESCRIPTION:"We invented tax and donations",PREREQUISITES:[Lv.MANAGEMENT,Lv.LONGHOUSE],FINISH:function(e){e.getGameService().enable(wv.TAX_COLLECTOR),e.getLogService().log("Tax collector unlocked")}},FISHING:{CATEGORY:np.AGRICULTURE,COST:[{resource:Mv.BERRY,amount:20}],RESEARCH_POINT:30,DESCRIPTION:"Could there be something edible in the water?",FINISH_DESCRIPTION:"We learned how to get fish out of the sea",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getGameService().enable(wv.SEA),e.getLogService().log("Sea unlocked"),e.getGameService().enable(wv.FISHERS_HUT),e.getLogService().log("Fisher's hut invented")}},ANIMALS:{CATEGORY:np.AGRICULTURE,COST:[{resource:Mv.HAY,amount:20}],RESEARCH_POINT:70,DESCRIPTION:"Is it possible to breed animals near farms?",FINISH_DESCRIPTION:"Now we know how to breed animals on pastures",PREREQUISITES:[Lv.AGRICULTURE,Lv.HUNTING],FINISH:function(e){e.getGameService().enable(wv.PASTURE),e.getLogService().log("Pastures invented"),e.getGameService().enable(wv.BUTCHER),e.getLogService().log("Butcher invented")}},TRADE:{CATEGORY:np.GENERAL,COST:[],RESEARCH_POINT:50,DESCRIPTION:"If others have resources we need maybe we could trade with them?",FINISH_DESCRIPTION:"We learned how to trade on marketplace",PREREQUISITES:[Lv.MANAGEMENT,Lv.CARTOGRAPHY],FINISH:function(e){e.getGameService().enable(wv.MARKETPLACE),e.getLogService().log("Marketplace invented"),e.getResourcesService().makeVisible(Mv.COINS)}},TANNERY:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.FUR,amount:20}],RESEARCH_POINT:50,DESCRIPTION:"Could we use dead animals fur in our advantage?",FINISH_DESCRIPTION:"Tanned fur is much better for armour",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.HUNTING],FINISH:function(e){e.getGameService().enable(wv.TANNERY),e.getLogService().log("Tannery invented"),e.getRecipeService().enable(ip.LEATHER)}},COTTON:{CATEGORY:np.AGRICULTURE,COST:[],RESEARCH_POINT:50,DESCRIPTION:"Maybe we can plant cotton?",FINISH_DESCRIPTION:"Now we can plant cotton on fields",PREREQUISITES:[Lv.AGRICULTURE],FINISH:function(e){e.getGameService().enable(wv.COTTON),e.getLogService().log("Cotton planting unlocked"),e.getResourcesService().makeVisible(Mv.COTTON)}},PARCHMENT:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.FUR,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"What if we make leather even thinner?",FINISH_DESCRIPTION:"We learned how to make parchment (paper) out of fur",PREREQUISITES:[Lv.TANNERY],FINISH:function(e){e.getLogService().log("Parchment recipe unlocked"),e.getResourcesService().makeVisible(Mv.PAPER),e.getRecipeService().enable(ip.PARCHMENT)}},PAPER_MILL:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.PAPER,amount:5}],RESEARCH_POINT:50,DESCRIPTION:"Maybe we could use trees to make paper?",FINISH_DESCRIPTION:"We invented paper mill where we can produce paper from logs",PREREQUISITES:[Lv.PARCHMENT,Lv.SAWMILL],FINISH:function(e){e.getLogService().log("Paper mill invented"),e.getGameService().enable(wv.PAPER_MILL)}},HERBALISM:{CATEGORY:np.AGRICULTURE,COST:[{resource:Mv.HERBS,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Is it possible to effectively plant herbs?",FINISH_DESCRIPTION:"We learned to how to plant herbs on fields",PREREQUISITES:[Lv.AGRICULTURE],FINISH:function(e){e.getGameService().enable(wv.HERBALISM),e.getLogService().log("Herbs planting unlocked"),e.getResourcesService().makeVisible(Mv.HERBS)}},FABRIC:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.COTTON,amount:20}],RESEARCH_POINT:50,DESCRIPTION:"Could we make fabric using cotton?",FINISH_DESCRIPTION:"We invented cotton mill and ways to spint cotton into fabric",PREREQUISITES:[Lv.COTTON],FINISH:function(e){e.getGameService().enable(wv.COTTON_MILL),e.getLogService().log("Cotton mill invented"),e.getRecipeService().enable(ip.FABRIC),e.getRecipeService().enable(ip.FABRIC_WOOL)}},TAILORING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.FABRIC,amount:5},{resource:Mv.FUR,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"How can me make new clothes?",FINISH_DESCRIPTION:"We can now make clothes out of fabric and fur",PREREQUISITES:[Lv.FABRIC],FINISH:function(e){e.getGameService().enable(wv.TAILOR),e.getLogService().log("Tailor invented"),e.getRecipeService().enable(ip.CLOTHES_FABRIC),e.getRecipeService().enable(ip.CLOTHES_FUR)}},SCHOLAR:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.FOOD,amount:1e4},{resource:Mv.PAPER,amount:30}],RESEARCH_POINT:200,DESCRIPTION:"Can we focus on science?",FINISH_DESCRIPTION:"We learned how to research new technologies more efficiently",PREREQUISITES:[Lv.PAPER_MILL,Lv.IMPROVED_FORESIGHT],FINISH:function(e){e.getGameService().enable(wv.SCHOLARS_LAB),e.getLogService().log("Scholar labs invented")}},ALCOHOL:{CATEGORY:np.GENERAL,COST:[],RESEARCH_POINT:100,DESCRIPTION:"Would it boost our moods if we took some time to have fun??",FINISH_DESCRIPTION:"We learned how to plants hops and barley, how to build buildings that will make alcohol and tavern where we can drink it",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.COOKING,Lv.AGRICULTURE],FINISH:function(e){e.getGameService().enable(wv.ALCOHOL),e.getGameService().enable(wv.TAVERN),e.getLogService().log("Tavern invented"),e.getGameService().enable(wv.BREWERY),e.getLogService().log("Brewery invented"),e.getGameService().enable(wv.WINERY),e.getLogService().log("Winery invented"),e.getGameService().enable(wv.BARLEY),e.getLogService().log("Barley planting unlocked"),e.getResourcesService().makeVisible(Mv.BARLEY),e.getGameService().enable(wv.HOPS),e.getLogService().log("Hops planting unlocked"),e.getResourcesService().makeVisible(Mv.HOP),e.getResourcesService().makeVisible(Mv.BEER),e.getResourcesService().makeVisible(Mv.WINE)}},CALENDAR:{CATEGORY:np.SCIENCE,COST:[{resource:Mv.LOG,amount:10}],RESEARCH_POINT:30,DESCRIPTION:"Is there some pattern to seasons?",FINISH_DESCRIPTION:"Now we know what day it is today",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getGameService().enable(wv.CALENDAR),e.getLogService().log("We are now able to track years and seasons")}},WEATHER:{CATEGORY:np.SCIENCE,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.STONE,amount:10},{resource:Mv.PLANK,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"Would it be good to know the weather in advance?",FINISH_DESCRIPTION:"We can now predict weather for a few days ahead",PREREQUISITES:[Lv.FORESIGHT],FINISH:function(e){e.getGameService().enable(wv.WEATHER),e.getLogService().log("We now can predict weather"),e.getWeatherService().increaseForecastPeriod(4)}},AGRICULTURE:{CATEGORY:np.AGRICULTURE,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.BERRY,amount:20},{resource:Mv.WHEAT,amount:20},{resource:Mv.SHOVEL,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Why should we risk looking for food in the forest if we can grow it it the open?",FINISH_DESCRIPTION:"We discovered how to build farms and cultivate crops on fields and orchards",PREREQUISITES:[Lv.WEATHER,Lv.CALENDAR,Lv.STONE_SHOVEL],FINISH:function(e){e.getGameService().isEnabled(wv.FIELD)||(e.getGameService().enable(wv.FIELD),e.getLogService().log("Field unlocked")),e.getGameService().enable(wv.FARM),e.getLogService().log("Farm invented"),e.getResourcesService().makeVisible(Mv.WHEAT),e.getResourcesService().makeVisible(Mv.BARLEY),e.getResourcesService().makeVisible(Mv.HAY),e.getResourcesService().makeVisible(Mv.APPLE),e.getResourcesService().makeVisible(Mv.GRAPE)}},CROPS_STORAGE:{CATEGORY:np.AGRICULTURE,COST:[{resource:Mv.FOOD,amount:5e3}],RESEARCH_POINT:50,DESCRIPTION:"Would it be more efficient if we had a storage building for crops closer to the fields?",FINISH_DESCRIPTION:"We found out that it is better to have a special building for storing crops",PREREQUISITES:[Lv.AGRICULTURE],FINISH:function(e){e.getGameService().enable(wv.BARN),e.getLogService().log("Barn invented")}},BOW:{CATEGORY:np.GENERAL,COST:[{resource:Mv.LOG,amount:20},{resource:Mv.BRUSHWOOD,amount:20}],RESEARCH_POINT:25,DESCRIPTION:"Could we kill without coming closer?",FINISH_DESCRIPTION:"We learned how to craft bows",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(ip.BOW)}},HUNTING:{CATEGORY:np.GENERAL,COST:[{resource:Mv.LOG,amount:5},{resource:Mv.BRUSHWOOD,amount:5},{resource:Mv.STONE,amount:5},{resource:Mv.BOW,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"What if hunted became the hunter?",FINISH_DESCRIPTION:"We learned how to hunt animals in the forest",PREREQUISITES:[Lv.BOW],FINISH:function(e){e.getGameService().enable(wv.HUNTER),e.getLogService().log("Hunter invented")}},FIRE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.BRUSHWOOD,amount:20},{resource:Mv.STONE,amount:2}],RESEARCH_POINT:30,DESCRIPTION:"Would it be useful if we could start fire on demand?",FINISH_DESCRIPTION:"We discovered ways to process brushwood into more efficient fuel",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getGameService().enable(wv.FIRE),e.getRecipeService().enable(ip.FUEL_BRUSHWOOD)}},BIGGER_FIRE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.STONE,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Could we make our fire bigger and last for longer?",FINISH_DESCRIPTION:"We learned how to turn logs into fuel",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.FIRE],FINISH:function(e){e.getRecipeService().enable(ip.FUEL_LOG)}},COOKING:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FUEL,amount:20},{resource:Mv.BERRY,amount:20},{resource:Mv.MUSHROOM,amount:20}],RESEARCH_POINT:30,DESCRIPTION:"What would happen if we heat up raw food?",FINISH_DESCRIPTION:"We discovered the art of cooking. We can prepare things with more nutrition value",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.FIRE],FINISH:function(e){e.getRecipeService().enable(ip.COOKED_MEAT),e.getRecipeService().enable(ip.COOKED_FISH),e.getRecipeService().enable(ip.BREAD),e.getRecipeService().enable(ip.VEGETABLE_SOUP_BERRY),e.getRecipeService().enable(ip.VEGETABLE_SOUP_MUSHROOM),e.getRecipeService().enable(ip.VEGETABLE_SOUP_BERRY_MUSHROOM),e.getRecipeService().enable(ip.MEAT_SOUP),e.getRecipeService().enable(ip.CHEESE)}},IMPROVED_COOKING:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FUEL,amount:30},{resource:Mv.EGG,amount:20},{resource:Mv.FLOUR,amount:20}],RESEARCH_POINT:70,DESCRIPTION:"Are there any better things to cook?",FINISH_DESCRIPTION:"We invented new cooking recipes",PREREQUISITES:[Lv.COOKING,Lv.BIGGER_FIRE],FINISH:function(e){e.getRecipeService().enable(ip.OMELETTE),e.getRecipeService().enable(ip.PIE)}},KITCHEN:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FUEL,amount:20},{resource:Mv.CUT_STONE,amount:5},{resource:Mv.COPPER,amount:2},{resource:Mv.POTTERY,amount:5}],RESEARCH_POINT:70,DESCRIPTION:"Can we improve food production rate?",FINISH_DESCRIPTION:"We realised that specialised building for food making can improve cooking speed",PREREQUISITES:[Lv.COOKING,Lv.POTTERY],FINISH:function(e){e.getGameService().enable(wv.KITCHEN),e.getLogService().log("Kitchen invented"),e.getLogService().log("Kitchen orders can be now placed in it's own submenu of crafting menu")}},BAKERY:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FUEL,amount:20},{resource:Mv.FLOUR,amount:20},{resource:Mv.CUT_STONE,amount:10}],RESEARCH_POINT:70,DESCRIPTION:"Could we improve bread making?",FINISH_DESCRIPTION:"We found out that by using special bread ovens we can greatly increase bread production",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.COOKING],FINISH:function(e){e.getGameService().enable(wv.BAKERY),e.getLogService().log("Bakery invented")}},MORTAR:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.STONE,amount:20}],RESEARCH_POINT:20,DESCRIPTION:"Would it be useful to grind things up?",FINISH_DESCRIPTION:"Now we can grind things up",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(ip.FLOUR)}},STONE_SPEAR:{CATEGORY:np.MILITARY,COST:[{resource:Mv.STONE,amount:10},{resource:Mv.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"Would we have better chance of survival if we keep enemy at distance?",FINISH_DESCRIPTION:"We learned how to craft stone spear",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(ip.STONE_SPEAR)}},STONE_AXE:{CATEGORY:np.GENERAL,COST:[{resource:Mv.STONE,amount:10},{resource:Mv.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"It's probably more effective to hit trees with sharp stone?",FINISH_DESCRIPTION:"We learned how to craft stone axe",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(ip.STONE_AXE)}},STONE_PICKAXE:{CATEGORY:np.GENERAL,COST:[{resource:Mv.STONE,amount:10},{resource:Mv.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"Would stone win against stone?",FINISH_DESCRIPTION:"We learned how to craft stone pickaxe",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(ip.STONE_PICKAXE)}},STONE_HAMMER:{CATEGORY:np.GENERAL,COST:[{resource:Mv.STONE,amount:10},{resource:Mv.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"Can hitting with stone be easier?",FINISH_DESCRIPTION:"We learned how to craft stone hammer",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(ip.STONE_HAMMER)}},STONE_SHOVEL:{CATEGORY:np.GENERAL,COST:[{resource:Mv.STONE,amount:10},{resource:Mv.LOG,amount:5}],RESEARCH_POINT:25,DESCRIPTION:"It should be better to get your stone dirty and not your hands?",FINISH_DESCRIPTION:"We learned how to craft stone shovel",PREREQUISITES:[Lv.SCIENTIFIC_METHOD],FINISH:function(e){e.getRecipeService().enable(ip.STONE_SHOVEL)}},COPPER_TOOLS:{CATEGORY:np.GENERAL,COST:[{resource:Mv.LOG,amount:20},{resource:Mv.COPPER,amount:20},{resource:Mv.HAMMER,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Could we make better tools with metal instead of stone? ",FINISH_DESCRIPTION:"We learned how to craft copper tools",PREREQUISITES:[Lv.ORE_PROCESSING,Lv.STONE_SHOVEL,Lv.STONE_PICKAXE,Lv.STONE_AXE,Lv.STONE_HAMMER,Lv.STONE_SPEAR],FINISH:function(e){e.getRecipeService().enable(ip.COPPER_AXE),e.getRecipeService().enable(ip.COPPER_PICKAXE),e.getRecipeService().enable(ip.COPPER_SHOVEL),e.getRecipeService().enable(ip.COPPER_SPEAR),e.getRecipeService().enable(ip.COPPER_HAMMER),e.getRecipeService().enable(ip.COPPER_NAILS)}},BRONZE_TOOLS:{CATEGORY:np.GENERAL,COST:[{resource:Mv.LOG,amount:20},{resource:Mv.BRONZE,amount:20},{resource:Mv.HAMMER,amount:2}],RESEARCH_POINT:100,DESCRIPTION:"Would bronze tools be even better than copper ones?",FINISH_DESCRIPTION:"We learned how to craft bronze tools",PREREQUISITES:[Lv.COPPER_TOOLS,Lv.METALLURGY],FINISH:function(e){e.getRecipeService().enable(ip.BRONZE_AXE),e.getRecipeService().enable(ip.BRONZE_PICKAXE),e.getRecipeService().enable(ip.BRONZE_SHOVEL),e.getRecipeService().enable(ip.BRONZE_SPEAR),e.getRecipeService().enable(ip.BRONZE_HAMMER),e.getRecipeService().enable(ip.BRONZE_NAILS),e.getRecipeService().enable(ip.BRONZE_SWORD),e.getRecipeService().enable(ip.BRONZE_SHIELD)}},IRON_TOOLS:{CATEGORY:np.GENERAL,COST:[{resource:Mv.LOG,amount:20},{resource:Mv.IRON,amount:20},{resource:Mv.HAMMER,amount:2}],RESEARCH_POINT:200,DESCRIPTION:"Can we craft tools from iron?",FINISH_DESCRIPTION:"We learned how to craft iron tools",PREREQUISITES:[Lv.BRONZE_TOOLS,Lv.MASTER_ORE_PROCESSING],FINISH:function(e){e.getRecipeService().enable(ip.IRON_AXE),e.getRecipeService().enable(ip.IRON_PICKAXE),e.getRecipeService().enable(ip.IRON_SHOVEL),e.getRecipeService().enable(ip.IRON_SPEAR),e.getRecipeService().enable(ip.IRON_HAMMER),e.getRecipeService().enable(ip.IRON_NAILS),e.getRecipeService().enable(ip.IRON_SWORD),e.getRecipeService().enable(ip.IRON_SHIELD)}},MINING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.STONE,amount:5},{resource:Mv.PICKAXE,amount:1}],RESEARCH_POINT:50,DESCRIPTION:"If we dig deep enough maybe there is something nice?",FINISH_DESCRIPTION:"We discovered that stone can be harvested in the mountains",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.STONE_PICKAXE],FINISH:function(e){e.getGameService().isEnabled(wv.MOUNTAINS)||(e.getGameService().enable(wv.MOUNTAINS),e.getLogService().log("Mountains unlocked"))}},DIGGING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.SHOVEL,amount:1}],RESEARCH_POINT:30,DESCRIPTION:"How can we move soil away efficiently?",FINISH_DESCRIPTION:"We discovered good ways of digging",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.STONE_SHOVEL],FINISH:function(e){e.getGameService().isEnabled(wv.FIELD)||(e.getGameService().enable(wv.FIELD),e.getLogService().log("Field unlocked")),e.getGameService().enable(wv.CLAY_PIT),e.getLogService().log("Clay pit unlocked"),e.getResourcesService().makeVisible(Mv.CLAY)}},POTTERY:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.FUEL,amount:5},{resource:Mv.CLAY,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"Can we do something useful with all that clay?",FINISH_DESCRIPTION:"We invented how to make pottery from clay",PREREQUISITES:[Lv.DIGGING,Lv.FIRE],FINISH:function(e){e.getRecipeService().enable(ip.POTTERY),e.getResourcesService().makeVisible(Mv.POTTERY)}},BRICKS:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.FUEL,amount:5},{resource:Mv.CLAY,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we can use clay for building?",FINISH_DESCRIPTION:"We discovered how to make bricks from clay and hay",PREREQUISITES:[Lv.POTTERY,Lv.BIGGER_FIRE,Lv.LONGHOUSE],FINISH:function(e){e.getRecipeService().enable(ip.BRICKS),e.getResourcesService().makeVisible(Mv.BRICKS)}},PROSPECTING_FOR_ORE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.PICKAXE,amount:10}],RESEARCH_POINT:50,DESCRIPTION:"There must be something useful under all this dirt",FINISH_DESCRIPTION:"We discovered that trained geologist can find ores deposits in the mountains",PREREQUISITES:[Lv.MINING],FINISH:function(e){e.getGameService().enable(wv.GEOLOGIST),e.getLogService().log("Geologist invented")}},ADVANCED_PROSPECTING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.PICKAXE,amount:20}],RESEARCH_POINT:75,DESCRIPTION:"There must be something even more valuable under the ground?",FINISH_DESCRIPTION:"We learned about more resources that mountains have to offer",PREREQUISITES:[Lv.PROSPECTING_FOR_ORE],FINISH:function(e){e.getGameService().enable(wv.GOLD),e.getGameService().enable(wv.SILVER)}},MASTER_PROSPECTING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.PICKAXE,amount:40}],RESEARCH_POINT:100,DESCRIPTION:"Is there anything else to find?",FINISH_DESCRIPTION:"We discovered iron",PREREQUISITES:[Lv.ADVANCED_PROSPECTING,Lv.IMPROVED_FORESIGHT],FINISH:function(e){e.getGameService().enable(wv.IRON)}},PIT_MINE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.STONE,amount:20},{resource:Mv.LOG,amount:20},{resource:Mv.PICKAXE,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Could we get precious resources from under the ground?",FINISH_DESCRIPTION:"We invented a way to mine ore deposits from the ground",PREREQUISITES:[Lv.PROSPECTING_FOR_ORE],FLAG_PREREQUISITES:[wv.BUILT_QUARRY],FINISH:function(e){e.getGameService().enable(wv.PIT_MINE),e.getLogService().log("Pit mine invented"),e.getRecipeService().enable(ip.FUEL_COAL)}},DEEP_MINE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:40},{resource:Mv.PLANK,amount:40},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.PICKAXE,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"Do we have to move all the dirt or could we just dig tunnels?",FINISH_DESCRIPTION:"It's now possible to build deep mines to mine ore",PREREQUISITES:[Lv.PIT_MINE,Lv.ADVANCED_MATHEMATICS],FLAG_PREREQUISITES:[],FINISH:function(e){e.getGameService().enable(wv.DEEP_MINE),e.getLogService().log("Deep mine invented")}},ORE_PROCESSING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.CUT_STONE,amount:40},{resource:Mv.STONE,amount:20},{resource:Mv.HAMMER,amount:10},{resource:Mv.COPPER_ORE,amount:20}],RESEARCH_POINT:100,DESCRIPTION:"What happens if we heat ore in fire?",FINISH_DESCRIPTION:"We discovered how to process ore into metal",PREREQUISITES:[Lv.PROSPECTING_FOR_ORE],FINISH:function(e){e.getGameService().enable(wv.SMITHY),e.getLogService().log("Smithy invented")}},ADVANCED_ORE_PROCESSING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.CUT_STONE,amount:40},{resource:Mv.STONE,amount:20},{resource:Mv.HAMMER,amount:5},{resource:Mv.GOLD_ORE,amount:5},{resource:Mv.SILVER_ORE,amount:5}],RESEARCH_POINT:150,DESCRIPTION:"What about heating other ores?",FINISH_DESCRIPTION:"We discovered how to process gold and silver ore",PREREQUISITES:[Lv.ADVANCED_PROSPECTING,Lv.ORE_PROCESSING],FLAG_PREREQUISITES:[wv.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(wv.ADVANCED_ORE_PROCESSING),e.getGameService().isEnabled(wv.BUILT_SMITHY)&&(e.getRecipeService().enable(ip.GOLD),e.getRecipeService().enable(ip.SILVER))}},MASTER_ORE_PROCESSING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.CUT_STONE,amount:40},{resource:Mv.STONE,amount:20},{resource:Mv.HAMMER,amount:5},{resource:Mv.IRON_ORE,amount:10}],RESEARCH_POINT:200,DESCRIPTION:"Can we smelt any ore we want?",FINISH_DESCRIPTION:"We learned to process iron ore",PREREQUISITES:[Lv.MASTER_PROSPECTING,Lv.ADVANCED_ORE_PROCESSING],FLAG_PREREQUISITES:[wv.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(wv.IRON),e.getGameService().isEnabled(wv.BUILT_SMITHY)&&e.getRecipeService().enable(ip.IRON)}},METALLURGY:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.COPPER,amount:10},{resource:Mv.TIN,amount:10}],RESEARCH_POINT:100,DESCRIPTION:"What would happen if we mix two metals?",FINISH_DESCRIPTION:"We discovered that mixing multiple metals can give better results",PREREQUISITES:[Lv.ORE_PROCESSING],FLAG_PREREQUISITES:[wv.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(wv.BRONZE),e.getGameService().isEnabled(wv.BUILT_SMITHY)&&e.getRecipeService().enable(ip.BRONZE)}},ADVANCED_METALLURGY:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.IRON,amount:10},{resource:Mv.COAL,amount:50}],RESEARCH_POINT:200,DESCRIPTION:"Could we mix iron with coal to make it stronger?",FINISH_DESCRIPTION:"We invented steel",PREREQUISITES:[Lv.MASTER_ORE_PROCESSING],FLAG_PREREQUISITES:[wv.BUILT_SMITHY,wv.IRON],FINISH:function(e){e.getGameService().enable(wv.STEEL),e.getGameService().isEnabled(wv.BUILT_SMITHY)&&e.getRecipeService().enable(ip.STEEL)}},COINS_MINTING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.GOLD,amount:10},{resource:Mv.SILVER,amount:20}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we can make our own coins?",FINISH_DESCRIPTION:"We learned how to mint our own coins",PREREQUISITES:[Lv.ADVANCED_ORE_PROCESSING],FLAG_PREREQUISITES:[wv.BUILT_SMITHY],FINISH:function(e){e.getGameService().enable(wv.MINT),e.getLogService().log("Mint invented")}},JEWELRY:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.GOLD,amount:10},{resource:Mv.SILVER,amount:20},{resource:Mv.GEMS,amount:5}],RESEARCH_POINT:200,DESCRIPTION:"Could we show our status by wearing expensive and beautiful things?",FINISH_DESCRIPTION:"We learned how to make jewelry",PREREQUISITES:[Lv.COINS_MINTING],FINISH:function(e){e.getGameService().enable(wv.JEWELRY),e.getRecipeService().enable(ip.JEWELRY),e.getLogService().log("Jewelry invented")}},HOUSE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],RESEARCH_POINT:100,DESCRIPTION:"What if huts were bigger?",FINISH_DESCRIPTION:"We learned how to build bigger and more efficient buildings for living",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.STONE_HAMMER,Lv.STONE_SHOVEL],FINISH:function(e){e.getGameService().enable(wv.HOUSE),e.getLogService().log("House invented")}},LONGHOUSE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.HAY,amount:20},{resource:Mv.HAMMER,amount:5}],RESEARCH_POINT:200,DESCRIPTION:"Could we house multiple families in one building?",FINISH_DESCRIPTION:"Now we can build longhouses that can house multiple families",PREREQUISITES:[Lv.HOUSE,Lv.AGRICULTURE],FINISH:function(e){e.getGameService().enable(wv.LONGHOUSE),e.getLogService().log("Longhouse invented")}},TUDOR_HOUSE:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:70},{resource:Mv.PLANK,amount:50},{resource:Mv.BRICKS,amount:40},{resource:Mv.HAMMER,amount:10}],RESEARCH_POINT:400,DESCRIPTION:"Can we use better building materials to build bigger houses?",FINISH_DESCRIPTION:"We worked out how to build tudor houses",PREREQUISITES:[Lv.LONGHOUSE,Lv.BRICKS],FINISH:function(e){e.getGameService().enable(wv.TUDOR_HOUSE),e.getLogService().log("Tudor House invented")}},SETTLEMENT:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:70},{resource:Mv.PLANK,amount:50},{resource:Mv.BRICKS,amount:40},{resource:Mv.NAILS,amount:50},{resource:Mv.HAMMER,amount:10}],RESEARCH_POINT:800,DESCRIPTION:"Could we build a new settlement to house more people?",FINISH_DESCRIPTION:"We can now construct whole settlements",PREREQUISITES:[Lv.TUDOR_HOUSE,Lv.BRICKS,Lv.TAILORING,Lv.COPPER_TOOLS],FINISH:function(e){e.getGameService().enable(wv.SETTLEMENT),e.getLogService().log("Settlements invented")}},URBAN_PLANNING:{CATEGORY:np.SCIENCE,COST:[],RESEARCH_POINT:50,DESCRIPTION:"Maybe we could rearrange buildings?",FINISH_DESCRIPTION:"Now we can combine and split some buildings like fields, orchards, pastures and warehouses",PREREQUISITES:[Lv.MANAGEMENT,Lv.MATHEMATICS],FINISH:function(e){e.getGameService().enable(wv.URBAN_PLANNING)}},WONDER_BUILDINGS:{CATEGORY:np.GENERAL,COST:[],RESEARCH_POINT:500,DESCRIPTION:"What if we built something remarkable?",FINISH_DESCRIPTION:"We learned that by building wonders we can boost future generations progress",PREREQUISITES:[Lv.HOUSE,Lv.URBAN_PLANNING,Lv.ADVANCED_MATHEMATICS],FINISH:function(e){e.getGameService().enable(wv.PLATEAU),e.getLogService().log("Plateau unlocked")}},SAWMILL:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:10},{resource:Mv.COPPER,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Is it possible to produce planks even faster?",FINISH_DESCRIPTION:"We discovered sawmill that efficiently turns logs into planks",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.STONE_HAMMER,Lv.STONE_AXE],FINISH:function(e){e.getGameService().enable(wv.SAWMILL),e.getLogService().log("Sawmill invented")}},WINDMILL:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:10},{resource:Mv.COPPER,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Could we use wind to do hard work for us?",FINISH_DESCRIPTION:"We invented windmill that can effortlessly turn wheat into flour",PREREQUISITES:[Lv.AGRICULTURE,Lv.MORTAR,Lv.MATHEMATICS],FINISH:function(e){e.getGameService().enable(wv.WINDMILL),e.getLogService().log("Windmill invented"),e.getResourcesService().makeVisible(Mv.FABRIC)}},FORESTRY:{CATEGORY:np.AGRICULTURE,COST:[{resource:Mv.LOG,amount:20},{resource:Mv.BRUSHWOOD,amount:20},{resource:Mv.SHOVEL,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Is there any reason why trees grow out of dirt?",FINISH_DESCRIPTION:"We now can hire foresters to plant new trees and manage forest better",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.MANAGEMENT,Lv.STONE_SHOVEL],FINISH:function(e){e.getGameService().enable(wv.FORESTER),e.getLogService().log("Forester invented"),e.getLogService().log("Forest management unlocked")}},BARRACKS:{CATEGORY:np.MILITARY,COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:20},{resource:Mv.SPEAR,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"How can we make those of us more aggressive less of a threat to others?",FINISH_DESCRIPTION:"We found out that we can form army and use it to our advantage",PREREQUISITES:[Lv.SCIENTIFIC_METHOD,Lv.CALENDAR,Lv.STONE_SPEAR],FINISH:function(e){e.getGameService().isEnabled(wv.FORT)||(e.getGameService().enable(wv.FORT),e.getLogService().log("Fort unlocked")),e.getRecipeService().enable(ip.WOODEN_SHIELD),e.getRecipeService().enable(ip.LEATHER_ARMOR),e.getGameService().enable(wv.BARRACKS),e.getLogService().log("Barracks invented")}},STASH:{CATEGORY:np.MILITARY,COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10}],RESEARCH_POINT:30,DESCRIPTION:"Can we hide our goods somewhere?",FINISH_DESCRIPTION:"We learned how to hide goods from invaders",PREREQUISITES:[Lv.FORESIGHT],FINISH:function(e){e.getGameService().isEnabled(wv.FORT)||(e.getGameService().enable(wv.FORT),e.getLogService().log("Fort unlocked")),e.getGameService().enable(wv.STASH)}},WOODEN_DEFENCES:{CATEGORY:np.MILITARY,COST:[{resource:Mv.LOG,amount:50}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we could use logs to defend ourselves?",FINISH_DESCRIPTION:"Now we can build simple wooden defences that will delay invasions",PREREQUISITES:[Lv.BARRACKS],FINISH:function(e){e.getGameService().enable(wv.STOCKADE),e.getLogService().log("Stockade invented"),e.getGameService().enable(wv.WOODEN_TOWER),e.getLogService().log("Wooden tower invented")}},STONE_DEFENCES:{CATEGORY:np.MILITARY,COST:[{resource:Mv.STONE,amount:50},{resource:Mv.CUT_STONE,amount:50}],RESEARCH_POINT:200,DESCRIPTION:"Maybe we could use stone to defend ourselves?",FINISH_DESCRIPTION:"We learned how to build more durable defences",PREREQUISITES:[Lv.WOODEN_DEFENCES],FINISH:function(e){e.getGameService().enable(wv.STONE_TOWER),e.getLogService().log("Stone tower invented")}},MATHEMATICS:{CATEGORY:np.SCIENCE,COST:[{resource:Mv.FOOD,amount:1e3}],RESEARCH_POINT:50,DESCRIPTION:"What if we calculate things first?",FINISH_DESCRIPTION:"By calculating things we are better at constructing and deconstructing buildings",PREREQUISITES:[Lv.FORESIGHT],FINISH:function(e){e.getEffectsService().addBuildingEffect(new rp("Mathematics",Pv.CONSTRUCTION,10,op.PERMANENT)),e.getEffectsService().addBuildingEffect(new rp("Mathematics",Pv.DECONSTRUCTION,10,op.PERMANENT))}},ADVANCED_MATHEMATICS:{CATEGORY:np.SCIENCE,COST:[{resource:Mv.FOOD,amount:4e3},{resource:Mv.PAPER,amount:20}],RESEARCH_POINT:200,DESCRIPTION:"Are there any better ways of calculations?",FINISH_DESCRIPTION:"Our calculations methods improved and we are now able to research more advanced things",PREREQUISITES:[Lv.MATHEMATICS,Lv.PARCHMENT],FINISH:function(e){}},IMPROVED_FORESIGHT:{CATEGORY:np.SCIENCE,COST:[{resource:Mv.FOOD,amount:5e3},{resource:Mv.PAPER,amount:50}],RESEARCH_POINT:300,DESCRIPTION:"Can we use our knowledge to foresight what we could learn?",FINISH_DESCRIPTION:"With our knowledge we can look further into the unknown and foresight future researches",PREREQUISITES:[Lv.ADVANCED_MATHEMATICS,Lv.PARCHMENT],FINISH:function(e){e.getTechService().increaseForesight(1),e.getLogService().log("Foresight level increased")}},LOGISTICS:{CATEGORY:np.MILITARY,COST:[{resource:Mv.STONE,amount:100},{resource:Mv.CLOTHES,amount:25}],RESEARCH_POINT:200,DESCRIPTION:"Can we improve travel speed between world regions?",FINISH_DESCRIPTION:"With improved military clothing and roads we can move faster between world regions",PREREQUISITES:[Lv.ADVANCED_MATHEMATICS],FINISH:function(e){e.getGameService().enable(wv.LOGISTICS),e.getLogService().log("Logistics invented")}},FERTILIZER:{CATEGORY:np.AGRICULTURE,COST:[{resource:Mv.FOOD,amount:3e3}],RESEARCH_POINT:100,DESCRIPTION:"Could we reuse what animals produce?",FINISH_DESCRIPTION:"By using animals manure we boost growth on fields and orchards",PREREQUISITES:[Lv.ANIMALS],FINISH:function(e){e.getEffectsService().addBuildingEffect(new rp("Fertilizer",Pv.FIELD,10,op.PERMANENT)),e.getEffectsService().addBuildingEffect(new rp("Fertilizer",Pv.ORCHARD,10,op.PERMANENT))}},PICKAXE_DESIGN:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:10},{resource:Mv.CUT_STONE,amount:10},{resource:Mv.PICKAXE,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Maybe we could redesign our pickaxes?",FINISH_DESCRIPTION:"We discovered different pickaxe design that improved mining speed",PREREQUISITES:[Lv.MINING],FINISH:function(e){e.getEffectsService().addBuildingEffect(new rp("Pickaxe Design",Pv.QUARRY,10,op.PERMANENT)),e.getEffectsService().addBuildingEffect(new rp("Pickaxe Design",Pv.PIT_MINE,10,op.PERMANENT)),e.getEffectsService().addBuildingEffect(new rp("Pickaxe Design",Pv.GEOLOGIST,10,op.PERMANENT)),e.getEffectsService().addBuildingEffect(new rp("Pickaxe Design",Pv.DEEP_MINE,10,op.PERMANENT))}},TRADE_ROUTES:{CATEGORY:np.GENERAL,COST:[{resource:Mv.COINS,amount:400}],RESEARCH_POINT:50,DESCRIPTION:"Is it possible to attract more merchants?",FINISH_DESCRIPTION:"By optimizing roads system we will have more visiting merchants",PREREQUISITES:[Lv.TRADE,Lv.MATHEMATICS],FINISH:function(e){e.getEffectsService().addBuildingEffect(new rp("Trade Routes",Pv.MARKETPLACE,15,op.PERMANENT))}},BUFF_PRODUCTION:{CATEGORY:np.GENERAL,COST:[{resource:Mv.AXE,amount:2},{resource:Mv.SHOVEL,amount:2},{resource:Mv.PICKAXE,amount:2},{resource:Mv.HAMMER,amount:2}],RESEARCH_POINT:50,DESCRIPTION:"Would people work better if we give them better tools?",FINISH_DESCRIPTION:"Now we can replace used tools to boost some buildings production",PREREQUISITES:[Lv.MANAGEMENT],FINISH:function(e){e.getGameService().enable(wv.BUFFS),e.getLogService().log("Production buffs invented")}},HUMAN_RESOURCES:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FOOD,amount:5e3}],RESEARCH_POINT:50,DESCRIPTION:"Maybe we can optimize work?",FINISH_DESCRIPTION:"We discovered automated work management for some buildings",PREREQUISITES:[Lv.MANAGEMENT],FINISH:function(e){e.getGameService().enable(wv.HUMAN_RESOURCES),e.getLogService().log("Automated work management available in management tab")}},BUILDERS_GUILD:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FOOD,amount:5e3},{resource:Mv.HAMMER,amount:5}],RESEARCH_POINT:100,DESCRIPTION:"Can we send unemployed to work?",FINISH_DESCRIPTION:"We learned that by creating builders guild we can send unemployed villagers to work",PREREQUISITES:[Lv.HUMAN_RESOURCES,Lv.SAWMILL],FINISH:function(e){e.getGameService().enable(wv.BUILDERS_GUILD),e.getLogService().log("Builders guild unlocked")}},SPECIALISED_PRODUCTION:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.FOOD,amount:3e3},{resource:Mv.HAMMER,amount:5},{resource:Mv.AXE,amount:5},{resource:Mv.PICKAXE,amount:5},{resource:Mv.SHOVEL,amount:5}],RESEARCH_POINT:50,DESCRIPTION:"Can we specialise in crafting one thing to do it better and faster?",FINISH_DESCRIPTION:"We realized that if we focus on crafting only one thing we can do it more efficiently",PREREQUISITES:[Lv.MATHEMATICS,Lv.STONE_HAMMER,Lv.STONE_AXE,Lv.STONE_PICKAXE,Lv.STONE_SHOVEL],FINISH:function(e){e.getGameService().enable(wv.SPECIALISED_PRODUCTION),e.getLogService().log("Manufacture invented")}},HERBAL_MEDICINE:{CATEGORY:np.SCIENCE,COST:[{resource:Mv.HERBS,amount:20}],RESEARCH_POINT:25,DESCRIPTION:"Would we heal faster if we used herbs?",FINISH_DESCRIPTION:"We learned how to craft medicine from herbs",PREREQUISITES:[Lv.MORTAR],FINISH:function(e){e.getRecipeService().enable(ip.HERBAL_MEDICINE)}},PRODUCTION_ZONES:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FOOD,amount:5e3}],RESEARCH_POINT:50,DESCRIPTION:"Would creating production camps help with productivity?",FINISH_DESCRIPTION:"We discovered that groups of production buildings can increase production",PREREQUISITES:[Lv.HUMAN_RESOURCES],FINISH:function(e){e.getGameService().enable(wv.PRODUCTION_ZONES),e.getLogService().log("Unlocked buildings camps")}},BOAT_BUILDING:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:100},{resource:Mv.NAILS,amount:50},{resource:Mv.FABRIC,amount:20}],RESEARCH_POINT:200,DESCRIPTION:"Could we utilize floating things to find better fishing spots or get from one place to another?",FINISH_DESCRIPTION:"We invented boats and boats builders",PREREQUISITES:[Lv.FISHING,Lv.COPPER_TOOLS],FINISH:function(e){e.getGameService().enable(wv.PIER),e.getGameService().enable(wv.BOAT_BUILDER),e.getLogService().log("Invented boat builder and pier")}},CANNON:{CATEGORY:np.MILITARY,COST:[{resource:Mv.IRON,amount:50},{resource:Mv.LOG,amount:50}],RESEARCH_POINT:200,DESCRIPTION:"How can we make our ships perform better in fights?",FINISH_DESCRIPTION:"We invented cannons that we can put on our ships",PREREQUISITES:[Lv.MASTER_ORE_PROCESSING,Lv.BOAT_BUILDING],FINISH:function(e){e.getRecipeService().enable(ip.CANNON),e.getLogService().log("Invented cannons crafting")}},BIGGER_SHIPS:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:200},{resource:Mv.NAILS,amount:200},{resource:Mv.HAMMER,amount:40},{resource:Mv.FABRIC,amount:50}],RESEARCH_POINT:400,DESCRIPTION:"Could our ships get bigger?",FINISH_DESCRIPTION:"We invented new ship design and construction methods",PREREQUISITES:[Lv.BOAT_BUILDING,Lv.CANNON],FINISH:function(e){e.getGameService().enable(wv.HARBOUR),e.getGameService().enable(wv.SHIPYARD),e.getGameService().enable(wv.BRIGANTINE),e.getLogService().log("Invented Harbour, Shipyard and Brigantine")}},GALLEON:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:200},{resource:Mv.NAILS,amount:200},{resource:Mv.HAMMER,amount:40},{resource:Mv.FABRIC,amount:60}],RESEARCH_POINT:700,DESCRIPTION:"How can we build even bigger ships?",FINISH_DESCRIPTION:"We learned how to build huge ships",PREREQUISITES:[Lv.BIGGER_SHIPS],FINISH:function(e){e.getGameService().enable(wv.GALLEON),e.getLogService().log("Invented Galleons")}},SEA_NAVIGATION:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.CUT_STONE,amount:50},{resource:Mv.BRICKS,amount:50},{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50}],RESEARCH_POINT:300,DESCRIPTION:"Can we improve sea navigation?",FINISH_DESCRIPTION:"We invented lighthouse to guide our ships at the sea",PREREQUISITES:[Lv.BIGGER_SHIPS],FINISH:function(e){e.getGameService().enable(wv.LIGHTHOUSE),e.getLogService().log("Invented Lighthouse")}},SEA_CARTOGRAPHY:{CATEGORY:np.TECHNOLOGY,COST:[{resource:Mv.FOOD,amount:5e3}],RESEARCH_POINT:300,DESCRIPTION:"Can we discover new lands across the sea?",FINISH_DESCRIPTION:"We discovered what data to gather from the sea to help create maps to distant lands",PREREQUISITES:[Lv.SEA_NAVIGATION],FINISH:function(e){e.getGameService().enable(wv.CARTOGRAPHER),e.getResourcesService().makeVisible(Mv.MAP),e.getLogService().log("Invented sea cartographer")}},SEA_CUISINE:{CATEGORY:np.GENERAL,COST:[{resource:Mv.FISH,amount:30},{resource:Mv.HERBS,amount:20},{resource:Mv.BREAD,amount:10}],RESEARCH_POINT:200,DESCRIPTION:"Can we make better dishes from what sea offers?",FINISH_DESCRIPTION:"We invented how to craft Bouillabaisse",PREREQUISITES:[Lv.KITCHEN,Lv.FISHING,Lv.BAKERY],FINISH:function(e){e.getRecipeService().enable(ip.BOUILLABAISSE),e.getLogService().log("Invented Bouillabaisse")}}},Ep={START_CRAFTING_QUEUE_SIZE:2,START_COOKING_QUEUE_SIZE:2,RECIPES:{PLANK:{RESOURCE:Mv.PLANK,AMOUNT:1,COST:[{resource:Mv.LOG,amount:5}],CRAFTING:5},CUT_STONE:{RESOURCE:Mv.CUT_STONE,AMOUNT:1,COST:[{resource:Mv.STONE,amount:5}],CRAFTING:10},LEATHER:{RESOURCE:Mv.LEATHER,AMOUNT:1,COST:[{resource:Mv.FUR,amount:2}],CRAFTING:10},POTTERY:{RESOURCE:Mv.POTTERY,AMOUNT:1,COST:[{resource:Mv.FUEL,amount:1},{resource:Mv.CLAY,amount:4}],CRAFTING:13},BRICKS:{RESOURCE:Mv.BRICKS,AMOUNT:1,COST:[{resource:Mv.FUEL,amount:1},{resource:Mv.CLAY,amount:5},{resource:Mv.HAY,amount:1}],CRAFTING:15},STONE_AXE:{NAME:"STONE AXE",RESOURCE:Mv.AXE,AMOUNT:1,COST:[{resource:Mv.BRUSHWOOD,amount:1},{resource:Mv.LOG,amount:2},{resource:Mv.STONE,amount:5}],CRAFTING:15},STONE_PICKAXE:{NAME:"STONE PICKAXE",RESOURCE:Mv.PICKAXE,AMOUNT:1,COST:[{resource:Mv.BRUSHWOOD,amount:1},{resource:Mv.LOG,amount:2},{resource:Mv.STONE,amount:5}],CRAFTING:15},STONE_SHOVEL:{NAME:"STONE SHOVEL",RESOURCE:Mv.SHOVEL,AMOUNT:1,COST:[{resource:Mv.BRUSHWOOD,amount:1},{resource:Mv.LOG,amount:2},{resource:Mv.STONE,amount:5}],CRAFTING:15},STONE_SPEAR:{NAME:"STONE SPEAR",RESOURCE:Mv.SPEAR,AMOUNT:1,COST:[{resource:Mv.BRUSHWOOD,amount:1},{resource:Mv.LOG,amount:2},{resource:Mv.STONE,amount:5}],CRAFTING:15},STONE_HAMMER:{NAME:"STONE HAMMER",RESOURCE:Mv.HAMMER,AMOUNT:1,COST:[{resource:Mv.BRUSHWOOD,amount:1},{resource:Mv.LOG,amount:2},{resource:Mv.STONE,amount:5}],CRAFTING:15},COPPER_AXE:{NAME:"COPPER AXE",RESOURCE:Mv.AXE,AMOUNT:2,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.COPPER,amount:1}],CRAFTING:12},COPPER_PICKAXE:{NAME:"COPPER PICKAXE",RESOURCE:Mv.PICKAXE,AMOUNT:2,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.COPPER,amount:1}],CRAFTING:12},COPPER_SHOVEL:{NAME:"COPPER SHOVEL",RESOURCE:Mv.SHOVEL,AMOUNT:2,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.COPPER,amount:1}],CRAFTING:12},COPPER_SPEAR:{NAME:"COPPER SPEAR",RESOURCE:Mv.SPEAR,AMOUNT:2,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.COPPER,amount:1}],CRAFTING:12},COPPER_HAMMER:{NAME:"COPPER HAMMER",RESOURCE:Mv.HAMMER,AMOUNT:2,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.COPPER,amount:1}],CRAFTING:12},COPPER_NAILS:{NAME:"COPPER NAILS",RESOURCE:Mv.NAILS,AMOUNT:4,COST:[{resource:Mv.COPPER,amount:2}],CRAFTING:6},BRONZE_AXE:{NAME:"BRONZE AXE",RESOURCE:Mv.AXE,AMOUNT:4,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.BRONZE,amount:1}],CRAFTING:15},BRONZE_PICKAXE:{NAME:"BRONZE PICKAXE",RESOURCE:Mv.PICKAXE,AMOUNT:4,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.BRONZE,amount:1}],CRAFTING:15},BRONZE_SHOVEL:{NAME:"BRONZE SHOVEL",RESOURCE:Mv.SHOVEL,AMOUNT:4,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.BRONZE,amount:1}],CRAFTING:15},BRONZE_SPEAR:{NAME:"BRONZE SPEAR",RESOURCE:Mv.SPEAR,AMOUNT:4,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.BRONZE,amount:1}],CRAFTING:15},BRONZE_HAMMER:{NAME:"BRONZE HAMMER",RESOURCE:Mv.HAMMER,AMOUNT:4,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.BRONZE,amount:1}],CRAFTING:15},BRONZE_NAILS:{NAME:"BRONZE NAILS",RESOURCE:Mv.NAILS,AMOUNT:5,COST:[{resource:Mv.BRONZE,amount:1}],CRAFTING:8},IRON_AXE:{NAME:"IRON AXE",RESOURCE:Mv.AXE,AMOUNT:8,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.IRON,amount:1}],CRAFTING:12},IRON_PICKAXE:{NAME:"IRON PICKAXE",RESOURCE:Mv.PICKAXE,AMOUNT:8,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.IRON,amount:1}],CRAFTING:12},IRON_SHOVEL:{NAME:"IRON SHOVEL",RESOURCE:Mv.SHOVEL,AMOUNT:8,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.IRON,amount:1}],CRAFTING:12},IRON_SPEAR:{NAME:"IRON SPEAR",RESOURCE:Mv.SPEAR,AMOUNT:8,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.IRON,amount:1}],CRAFTING:12},IRON_HAMMER:{NAME:"IRON HAMMER",RESOURCE:Mv.HAMMER,AMOUNT:8,COST:[{resource:Mv.LOG,amount:2},{resource:Mv.IRON,amount:1}],CRAFTING:12},IRON_NAILS:{NAME:"IRON NAILS",RESOURCE:Mv.NAILS,AMOUNT:15,COST:[{resource:Mv.IRON,amount:1}],CRAFTING:6},BOW:{RESOURCE:Mv.BOW,AMOUNT:1,COST:[{resource:Mv.BRUSHWOOD,amount:5},{resource:Mv.LOG,amount:10}],CRAFTING:15},PARCHMENT:{RESOURCE:Mv.PAPER,AMOUNT:1,COST:[{resource:Mv.FUR,amount:2}],CRAFTING:15},SWORD:{RESOURCE:Mv.SWORD,AMOUNT:1,COST:[{resource:Mv.COPPER,amount:5},{resource:Mv.LOG,amount:1},{resource:Mv.FUEL,amount:5}],CRAFTING:20},BRONZE_SWORD:{NAME:"BRONZE SWORD",RESOURCE:Mv.SWORD,AMOUNT:2,COST:[{resource:Mv.BRONZE,amount:4},{resource:Mv.LOG,amount:1},{resource:Mv.FUEL,amount:7}],CRAFTING:25},IRON_SWORD:{NAME:"IRON SWORD",RESOURCE:Mv.SWORD,AMOUNT:3,COST:[{resource:Mv.IRON,amount:3},{resource:Mv.LOG,amount:1},{resource:Mv.FUEL,amount:10}],CRAFTING:30},WOODEN_SHIELD:{NAME:"WOODEN SHIELD",RESOURCE:Mv.SHIELD,AMOUNT:1,COST:[{resource:Mv.PLANK,amount:5},{resource:Mv.LOG,amount:2},{resource:Mv.LEATHER,amount:1}],CRAFTING:20},BRONZE_SHIELD:{NAME:"BRONZE SHIELD",RESOURCE:Mv.SHIELD,AMOUNT:2,COST:[{resource:Mv.BRONZE,amount:1},{resource:Mv.LEATHER,amount:1}],CRAFTING:25},IRON_SHIELD:{NAME:"IRON SHIELD",RESOURCE:Mv.SHIELD,AMOUNT:4,COST:[{resource:Mv.IRON,amount:1},{resource:Mv.LEATHER,amount:1}],CRAFTING:30},LEATHER_ARMOR:{RESOURCE:Mv.LEATHER_ARMOR,AMOUNT:1,COST:[{resource:Mv.LEATHER,amount:10}],CRAFTING:20},LIGHT_ARMOR:{RESOURCE:Mv.LIGHT_ARMOR,AMOUNT:1,COST:[{resource:Mv.COPPER,amount:10},{resource:Mv.LEATHER,amount:5},{resource:Mv.FUEL,amount:10}],CRAFTING:25},HEAVY_ARMOR:{RESOURCE:Mv.HEAVY_ARMOR,AMOUNT:1,COST:[{resource:Mv.BRONZE,amount:8},{resource:Mv.LEATHER,amount:5},{resource:Mv.FUEL,amount:10}],CRAFTING:30},CANNON:{RESOURCE:Mv.CANNON,AMOUNT:1,COST:[{resource:Mv.IRON,amount:10},{resource:Mv.PLANK,amount:10},{resource:Mv.FUEL,amount:5}],CRAFTING:30},FUEL_BRUSHWOOD:{NAME:"BRUSHWOOD FUEL",RESOURCE:Mv.FUEL,AMOUNT:2,COST:[{resource:Mv.BRUSHWOOD,amount:4}],CRAFTING:2},FUEL_LOG:{NAME:"LOG FUEL",RESOURCE:Mv.FUEL,AMOUNT:4,COST:[{resource:Mv.LOG,amount:4}],CRAFTING:5},FUEL_COAL:{NAME:"COAL FUEL",RESOURCE:Mv.FUEL,AMOUNT:12,COST:[{resource:Mv.COAL,amount:2}],CRAFTING:5},COOKED_FISH:{RESOURCE:Mv.COOKED_FISH,AMOUNT:1,COST:[{resource:Mv.FISH,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:5},COOKED_MEAT:{RESOURCE:Mv.COOKED_MEAT,AMOUNT:1,COST:[{resource:Mv.MEAT,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:5},CHEESE:{RESOURCE:Mv.CHEESE,AMOUNT:1,COST:[{resource:Mv.MILK,amount:3}],CRAFTING:7},OMELETTE:{RESOURCE:Mv.OMELETTE,AMOUNT:1,COST:[{resource:Mv.EGG,amount:5},{resource:Mv.FUEL,amount:1}],CRAFTING:3},PIE:{RESOURCE:Mv.PIE,AMOUNT:1,COST:[{resource:Mv.APPLE,amount:3},{resource:Mv.FLOUR,amount:1},{resource:Mv.EGG,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:5},FLOUR:{RESOURCE:Mv.FLOUR,AMOUNT:1,COST:[{resource:Mv.WHEAT,amount:2}],CRAFTING:3},BREAD:{RESOURCE:Mv.BREAD,AMOUNT:1,COST:[{resource:Mv.FLOUR,amount:2},{resource:Mv.FUEL,amount:1}],CRAFTING:5},BOUILLABAISSE:{RESOURCE:Mv.BOUILLABAISSE,AMOUNT:1,COST:[{resource:Mv.FISH,amount:3},{resource:Mv.BREAD,amount:1},{resource:Mv.HERBS,amount:2},{resource:Mv.FUEL,amount:1}],CRAFTING:5},VEGETABLE_SOUP_BERRY:{RESOURCE:Mv.VEGETABLE_SOUP,AMOUNT:1,COST:[{resource:Mv.BERRY,amount:2},{resource:Mv.HERBS,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:5},VEGETABLE_SOUP_MUSHROOM:{RESOURCE:Mv.VEGETABLE_SOUP,AMOUNT:1,COST:[{resource:Mv.MUSHROOM,amount:2},{resource:Mv.HERBS,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:5},VEGETABLE_SOUP_BERRY_MUSHROOM:{RESOURCE:Mv.VEGETABLE_SOUP,AMOUNT:1,COST:[{resource:Mv.BERRY,amount:1},{resource:Mv.MUSHROOM,amount:1},{resource:Mv.HERBS,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:5},MEAT_SOUP:{RESOURCE:Mv.MEAT_SOUP,AMOUNT:1,COST:[{resource:Mv.MEAT,amount:1},{resource:Mv.HERBS,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:5},FABRIC:{NAME:"COTTON FABRIC",RESOURCE:Mv.FABRIC,AMOUNT:1,COST:[{resource:Mv.COTTON,amount:2}],CRAFTING:5},FABRIC_WOOL:{NAME:"WOOL FABRIC",RESOURCE:Mv.FABRIC,AMOUNT:1,COST:[{resource:Mv.WOOL,amount:3}],CRAFTING:5},CLOTHES_FABRIC:{NAME:"FABRIC CLOTHES",RESOURCE:Mv.CLOTHES,AMOUNT:1,COST:[{resource:Mv.FABRIC,amount:10}],CRAFTING:20},CLOTHES_FUR:{NAME:"FUR CLOTHES",RESOURCE:Mv.CLOTHES,AMOUNT:1,COST:[{resource:Mv.FUR,amount:15}],CRAFTING:20},GOLD:{RESOURCE:Mv.GOLD,AMOUNT:1,COST:[{resource:Mv.GOLD_ORE,amount:2},{resource:Mv.FUEL,amount:1}],CRAFTING:10},SILVER:{RESOURCE:Mv.SILVER,AMOUNT:1,COST:[{resource:Mv.SILVER_ORE,amount:2},{resource:Mv.FUEL,amount:1}],CRAFTING:10},COPPER:{RESOURCE:Mv.COPPER,AMOUNT:1,COST:[{resource:Mv.COPPER_ORE,amount:2},{resource:Mv.FUEL,amount:1}],CRAFTING:20},TIN:{RESOURCE:Mv.TIN,AMOUNT:1,COST:[{resource:Mv.TIN_ORE,amount:2},{resource:Mv.FUEL,amount:1}],CRAFTING:20},BRONZE:{RESOURCE:Mv.BRONZE,AMOUNT:2,COST:[{resource:Mv.COPPER,amount:1},{resource:Mv.TIN,amount:1},{resource:Mv.FUEL,amount:1}],CRAFTING:30},IRON:{RESOURCE:Mv.IRON,AMOUNT:1,COST:[{resource:Mv.IRON_ORE,amount:3},{resource:Mv.FUEL,amount:3}],CRAFTING:30},STEEL:{RESOURCE:Mv.STEEL,AMOUNT:1,COST:[{resource:Mv.IRON,amount:1},{resource:Mv.COAL,amount:5},{resource:Mv.FUEL,amount:1}],CRAFTING:40},HERBAL_MEDICINE:{RESOURCE:Mv.HERBAL_MEDICINE,AMOUNT:1,COST:[{resource:Mv.HERBS,amount:5}],CRAFTING:15},JEWELRY:{RESOURCE:Mv.JEWELRY,AMOUNT:1,COST:[{resource:Mv.GOLD,amount:1},{resource:Mv.SILVER,amount:1},{resource:Mv.GEMS,amount:1}],CRAFTING:20}}},yp={getReligion:function(e){var t=Object.entries(this.RELIGIONS).find(function(t){return t[0]===Gv[e]});if(t)return t[1];console.warn("Invalid religion: "+Qv.prepareReligionName(e))},RELIGIONS:{NONE:{FAITH_LEVEL:0,FAITH:0,TIME:0,OFFERING:[]},NATURE:{FAITH_LEVEL:1,FAITH:20,TIME:10,OFFERING:[{resource:Mv.LOG,amount:40},{resource:Mv.BERRY,amount:20},{resource:Mv.MUSHROOM,amount:20}]},FERTILITY:{FAITH_LEVEL:1,FAITH:30,TIME:10,OFFERING:[{resource:Mv.WHEAT,amount:40},{resource:Mv.BERRY,amount:40},{resource:Mv.APPLE,amount:40}]},TECHNOLOGY:{FAITH_LEVEL:1,FAITH:40,TIME:10,OFFERING:[{resource:Mv.PLANK,amount:20},{resource:Mv.CUT_STONE,amount:20},{resource:Mv.HAMMER,amount:5},{resource:Mv.PICKAXE,amount:5}]},WAR:{FAITH_LEVEL:1,FAITH:50,TIME:10,OFFERING:[{resource:Mv.SPEAR,amount:5},{resource:Mv.LEATHER_ARMOR,amount:5},{resource:Mv.FUR,amount:10},{resource:Mv.LEATHER,amount:10},{resource:Mv.FOOD,amount:1e3}]}},PRAYERS:{PRAY:{FAITH:20,FAITH_LEVEL:1,RELIGION:Gv.NONE,DESCRIPTION:"We feel better after prayer",FINISH:function(e){e.getHappinessService().addHappinessEffect(0,Kv.PRAYER,2,180)}},BLESSING:{FAITH:50,FAITH_LEVEL:2,RELIGION:Gv.NONE,DESCRIPTION:"May everything go according to our plans",FINISH:function(e){var t=[];Object.values(Yv).filter(function(e){return!isNaN(e)}).forEach(function(i){e.getServiceByRegion(i).getBuildings().forEach(function(e){t.includes(e.getBuildingType())||t.push(e.getBuildingType())})});var i=sp.randomExcept(t,[Pv.ALL,Pv.CONSTRUCTION,Pv.DECONSTRUCTION,Pv.BARN,Pv.FIELD,Pv.ORCHARD,Pv.PASTURE,Pv.WAREHOUSE,Pv.SMITHY,Pv.ASCENSION_TEMPLE,Pv.COLOSSUS,Pv.GREAT_LIGHTHOUSE,Pv.HANGING_GARDEN,Pv.PYRAMID,Pv.SACRED_GROVE,Pv.STONEHENGE,Pv.UNDERGROUND_CITY,Pv.PIER,Pv.HARBOUR,Pv.LIGHTHOUSE,Pv.TAX_COLLECTOR,Pv.BUILDERS_GUILD,Pv.STASH,Pv.WOODEN_TOWER,Pv.BARRACKS,Pv.STONE_TOWER,Pv.STOCKADE]);e.getLogService().log(Qv.prepareBuildingName(i)+" blessed"),e.getEffectsService().addBuildingEffect(new rp("Blessing",i,25,180))}},PREACH:{FAITH:20,FAITH_LEVEL:1,RELIGION:Gv.NONE,DESCRIPTION:"We shall spread our beliefs to others",FINISH:function(e){e.getService(Zv.RELIGION).increaseFaithLevel(1)}},FAITH_SHIELD:{FAITH:50,FAITH_LEVEL:3,RELIGION:Gv.NONE,DESCRIPTION:"Our faith will protect us from harm",FINISH:function(e){var t=25;t+=e.getService(Zv.RELIGION).getFaithLevel(),e.getService(Zv.RELIGION).increaseFaithShield(t)}},SOLDIER_PRAYER:{FAITH:50,FAITH_LEVEL:5,RELIGION:Gv.NONE,DESCRIPTION:"We shall win any enemy with our faith. All troops buffed 20% for one year",FINISH:function(e){e.getEffectsService().addArmyEffect(new ap("Soldier prayer",Bv.ALL,20,360))}},FAITHFUL_RESEARCH:{FAITH:100,FAITH_LEVEL:5,RELIGION:Gv.TECHNOLOGY,DESCRIPTION:"We live to improve our knowledge. Gain 100 research points spent only on current research",FINISH:function(e){e.getTechService().progressTech(100)}},BABY_BOOM:{FAITH:100,FAITH_LEVEL:5,RELIGION:Gv.FERTILITY,DESCRIPTION:"May we have a lot of children",FINISH:function(e){e.getEffectsService().addBuildingEffect(new rp("Baby boom",Pv.HUT,100,180)),e.getEffectsService().addBuildingEffect(new rp("Baby boom",Pv.HOUSE,100,180)),e.getEffectsService().addBuildingEffect(new rp("Baby boom",Pv.LONGHOUSE,100,180)),e.getEffectsService().addBuildingEffect(new rp("Baby boom",Pv.TUDOR_HOUSE,100,180)),e.getEffectsService().addBuildingEffect(new rp("Baby boom",Pv.SETTLEMENT,100,180))}},LIFE_CYCLE:{FAITH:100,FAITH_LEVEL:5,RELIGION:Gv.NATURE,DESCRIPTION:"We pray for all live to thrive. 10% buff to natural sources for 5 years",FINISH:function(e){e.getEffectsService().addNatureEffect(new up("Life cycle",10,1800))}},HOLY_WAR:{FAITH:100,FAITH_LEVEL:5,RELIGION:Gv.WAR,DESCRIPTION:"The only true faith must be spread at all cost. All troops buffed 10% for 5 years",FINISH:function(e){e.getEffectsService().addArmyEffect(new ap("Holy War",Bv.ALL,10,1800))}}}},Rp={GOLDEN_ITEMS:{GOLDEN_FISH_CHANCE:3e-4,GOLDEN_EGG_CHANCE:3e-4,GOLDEN_APPLE_CHANCE:3e-4,GOLDEN_FLEECE_CHANCE:3e-4},PERKS:{MOTIVATION_SPEECH:{DESCRIPTION:"Use your royal position to motivate people to harder work.<br>25% production upgrade for all buildings for 100 years or until reset (single use)",USAGES:0,MAX_USAGES:0,COST:20,RESET:function(e,t){},EFFECT:function(e,t){e.getEffectsService().addBuildingEffect(new rp("Motivation speech",Pv.ALL,25,36e3)),e.getRoyalService().unlockCallback(t)}},ROYAL_PROPHECY:{DESCRIPTION:"Your royal blood allows prophets to look into the future.<br>Unlocks certain research for each perk level (awarded immediately and after any soft reset or abdication)",USAGES:0,MAX_USAGES:3,COST:50,RESET:function(e,t){t.usages>=1&&e.getTechService().finishTech(Lv.FIRE),t.usages>=2&&e.getTechService().finishTech(Lv.COOKING),3===t.usages&&(e.getTechService().finishTech(Lv.BOW),e.getTechService().finishTech(Lv.HUNTING))},EFFECT:function(e,t){switch(t.usages){case 0:e.getTechService().finishTech(Lv.FIRE);break;case 1:e.getTechService().finishTech(Lv.COOKING);break;case 2:e.getTechService().finishTech(Lv.BOW),e.getTechService().finishTech(Lv.HUNTING)}e.getRoyalService().unlockCallback(t)}},HERITAGE:{DESCRIPTION:"Your predecessors ruled better.<br>You start with extra building (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:2,COST:20,RESET:function(e,t){t.usages>=1&&(e.getService(Zv.FOREST).addBuilding(Pv.GATHERER),e.getLandService().takeLand(fp.FOREST.GATHERER.SIZE)),2===t.usages&&(e.getVillageService().addBuilding(Pv.WORKSHOP),e.getLandService().takeLand(fp.VILLAGE.WORKSHOP.SIZE))},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},ROYAL_ARCHIVES:{DESCRIPTION:"With archives unlocked we can schedule one more research to be worked on.",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){e.getTechService().increaseTechQueueSize()},EFFECT:function(e,t){e.getTechService().increaseTechQueueSize(),e.getRoyalService().unlockCallback(t)}},FAMILY_JEWELS:{DESCRIPTION:"Your predecessors left you with more riches.<br>You start with extra resources (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:3,COST:20,RESET:function(e,t){t.usages>=1&&(e.getResourcesService().increaseResource(Mv.LOG,20,"Royal",!0),e.getResourcesService().increaseResource(Mv.BRUSHWOOD,10,"Royal",!0),e.getResourcesService().increaseResource(Mv.BERRY,20,"Royal",!0),e.getResourcesService().increaseResource(Mv.MUSHROOM,20,"Royal",!0)),t.usages>=2&&(e.getResourcesService().increaseResource(Mv.STONE,30,"Royal",!0),e.getResourcesService().increaseResource(Mv.PLANK,20,"Royal",!0),e.getResourcesService().increaseResource(Mv.FUEL,5,"Royal",!0),e.getResourcesService().increaseResource(Mv.LEATHER,5,"Royal",!0)),3===t.usages&&e.getResourcesService().increaseResource(Mv.COINS,300,"Royal",!0)},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_FOREST:{DESCRIPTION:"You rule everything in the forests.<br>You start with a few forest buildings unlocked (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){1===t.usages&&(e.getService(Zv.FOREST).addBuilding(Pv.GATHERER),e.getService(Zv.FOREST).addBuilding(Pv.FORESTER),e.getService(Zv.FOREST).addBuilding(Pv.HUNTER_LODGE),e.getLandService().takeLand(fp.FOREST.GATHERER.SIZE+fp.FOREST.FORESTER.SIZE+fp.FOREST.HUNTER_LODGE.SIZE))},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_PEOPLE:{DESCRIPTION:"People love you unconditionally.<br>You start with House unlocked and built instead of huts (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){1===t.usages&&(e.getTechService().finishTech(Lv.HOUSE),e.getVillageService().replaceWithHouses())},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_SEAS:{DESCRIPTION:"Seas obey your will.<br>You start with sea unlocked, pier building built, one boat and 120 coins",USAGES:0,MAX_USAGES:1,COST:100,RESET:function(e,t){e.getGameService().enable(wv.SEA),e.getGameService().enable(wv.NAVY),e.getService(Zv.SEA).addBuilding(Pv.PIER),e.getNavyService().addShip(Bv.BOAT),e.getLandService().takeLand(fp.SEA.PIER.SIZE),e.getResourcesService().increaseResource(Mv.COINS,120,"Royal",!0)},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},KING_OF_THE_WAR:{DESCRIPTION:"War is your game.<br>You start with military unlocked and small army (awarded after any soft reset or abdication)",USAGES:0,MAX_USAGES:1,COST:50,RESET:function(e,t){e.getGameService().enable(wv.ARMY),e.getGameService().enable(wv.FORT);var i=e.getArmyService();e.getService(Zv.FORT).addBuilding(Pv.BARRACKS),e.getService(Zv.FORT).addBuilding(Pv.BARRACKS),e.getLandService().takeLand(2*fp.FORT.BARRACKS.SIZE),i.addMilitia(20)},EFFECT:function(e,t){e.getRoyalService().unlockCallback(t)}},CALL_TO_ARMS:{DESCRIPTION:"We will fight till the last of us drops dead.<br>You can convert up to 10 villagers to militia (single use)",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){var i=e.getResourcesService(),n=e.getModalService(),r=e.getArmyService(),o=e.getRoyalService();n.open(_v.INPUT),n.setModalText("How many villagers would you like to convert to militia?<br>"+i.getPeople()+" recruits available");var s=n.registerForValueResponse().subscribe(function(e){if(s.unsubscribe(),null!==e&&!isNaN(e)){var a=i.getPeople();if(a>10)return void n.info("You can only convert up to 10 villagers");if(r.getFreeBarracks()<e)return void n.info("Not enough barracks space for so many militia");if(e>a)return void n.info("Not enough recruits");if(e<=0)return void n.info("Invalid amount of recruits");if(o.getRoyalPoints()<t.cost)return void n.info("Not enough royal points");i.removeRecruit(Number(e)),r.addMilitia(Number(e)),o.unlockCallback(t)}})}},UNITE_WITH_THE_PEOPLE:{DESCRIPTION:"You step down from your throne and live with others.<br>Permanent 20% upgrade to all buildings (persists through soft resets and abdications)",USAGES:0,MAX_USAGES:0,COST:100,RESET:function(e,t){},EFFECT:function(e,t){e.getEffectsService().addBuildingEffect(new rp("Unite with the people",Pv.ALL,20,op.ROYAL)),e.getRoyalService().unlockCallback(t)}},JESTER:{DESCRIPTION:"You hired jester to entertain you but who knows what can you expect from him?<br>Jester will pick random unlocked resource (except coins) and fill it to max storage.<br>Each time he fills resource or picks already full resource he has 50% chance to pick another one (single use)",USAGES:0,MAX_USAGES:0,COST:25,RESET:function(e,t){},EFFECT:function(e,t){for(var i=Array.from(e.getResourcesService().getResources().values()).filter(function(e){return e.isVisible()&&e.resource!==Mv.COINS});;){var n=i[sp.randomBetween(0,i.length-1)];if(n.amount<n.limit?(n.amount=n.limit,e.getLogService().success("Jester filled "+Qv.prepareResourceName(n.resource)+" storage!")):e.getLogService().warning("Jester couldn't fill "+Qv.prepareResourceName(n.resource)+" storage!"),sp.chance(.5))break}e.getRoyalService().unlockCallback(t)}},ASTROLOGICAL_NOTE:{DESCRIPTION:"Royal archives contain notes about old astrological events.<br>You unlock one meteorite in the mountains",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){e.getGameService().isEnabled(wv.MOUNTAINS)||(e.getGameService().enable(wv.MOUNTAINS),e.getLogService().log("Mountains unlocked")),e.getService(Zv.MOUNTAINS).addMeteorite(),e.getRoyalService().unlockCallback(t)}},ROYAL_FESTIVAL:{DESCRIPTION:"You organize a royal festival for your people.<br>You gain positive happiness boost for 6 months",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){e.getHappinessService().addHappinessEffect(0,Kv.ROYAL_FESTIVAL,10,180),e.getLogService().success("Royal festival has started!"),e.getRoyalService().unlockCallback(t)}},ROYAL_RESERVE:{DESCRIPTION:"You use gold from royal treasury that was reserved for a hard times.<br>You gain 2000 coins",USAGES:0,MAX_USAGES:0,COST:10,RESET:function(e,t){},EFFECT:function(e,t){e.getResourcesService().increaseResource(Mv.COINS,2e3,"Royal reserve",!0),e.getLogService().success("You gained 2000 coins"),e.getRoyalService().unlockCallback(t)}},ANCIENT_SEA_MAPS:{DESCRIPTION:"You found sea maps that show you places on the sea with something interesting.<br>You unlock up to 5 positive sea events",USAGES:0,MAX_USAGES:0,COST:20,RESET:function(e,t){},EFFECT:function(e,t){e.getWorldService().ROYAL_spawnPositiveSeaEvents(),e.getRoyalService().unlockCallback(t)}},ROYAL_ORDERS:{DESCRIPTION:"Your people work harder when you give them orders.<br>Your initial crafting queue is increased by 1 for each perk level",USAGES:0,MAX_USAGES:5,COST:10,RESET:function(e,t){t.usages>0&&e.getService(Zv.CRAFTING).increaseCraftingQueueSize(t.usages)},EFFECT:function(e,t){e.getService(Zv.CRAFTING).increaseCraftingQueueSize(1),e.getRoyalService().unlockCallback(t)}},ROYAL_TRADITIONS:{DESCRIPTION:"You show royal traditions to the people.You gain 10 Heritage Points",USAGES:0,MAX_USAGES:0,COST:50,RESET:function(e,t){},EFFECT:function(e,t){e.getService(Zv.HERITAGE).increaseHeritagePoints(10),e.getRoyalService().unlockCallback(t)}},ROYAL_GARDENS:{DESCRIPTION:"You open royal gardens for public use.<br>Permanent 1 point happiness effect per perk level",USAGES:0,MAX_USAGES:3,COST:25,RESET:function(e,t){1===t.usages?e.getHappinessService().addHappinessEffect(0,Kv.ROYAL_GARDENS,1,-1):2===t.usages?e.getHappinessService().addHappinessEffect(0,Kv.ROYAL_GARDENS,2,-1):3===t.usages&&e.getHappinessService().addHappinessEffect(0,Kv.ROYAL_GARDENS,3,-1)},EFFECT:function(e,t){e.getHappinessService().updateHappiness(Kv.ROYAL_GARDENS,t.usages+1,-1),e.getLogService().success("Royal gardens unlocked!"),e.getRoyalService().unlockCallback(t)}},HIRE_MERCENARIES:{DESCRIPTION:"Using your royal position you managed to convince mercenaries to fight for you.You gain 10 light cavalry units and 200 coins",USAGES:0,MAX_USAGES:0,COST:30,RESET:function(e,t){},EFFECT:function(e,t){var i=e.getModalService(),n=e.getArmyService(),r=e.getRoyalService();n.getFreeBarracks()<10?i.info("Not enough barracks space for 10 light cavalry units"):r.getRoyalPoints()<t.cost?i.info("Not enough royal points"):(n.addLightCavalry(10),e.getLogService().success("Mercenaries hired!"),e.getResourcesService().increaseResource(Mv.COINS,200,"Royal",!0),r.unlockCallback(t))}},HIRE_PIRATES:{DESCRIPTION:"Using your royal position you managed to convince pirates to fight for you.You gain 2 brigantines and 320 coins",USAGES:0,MAX_USAGES:0,COST:30,RESET:function(e,t){},EFFECT:function(e,t){var i=e.getModalService(),n=e.getNavyService(),r=e.getRoyalService();n.getFreeHarbourSpace()<80?i.info("Not enough harbour space for 2 brigantines"):r.getRoyalPoints()<t.cost?i.info("Not enough royal points"):(n.addBrigantines(2),e.getLogService().success("Pirates hired!"),e.getResourcesService().increaseResource(Mv.COINS,320,"Royal",!0),r.unlockCallback(t))}},ANCIENT_PROTECTION:{DESCRIPTION:"Using this ancient artifact will prevent any attacks.<br>Enemies won't be able to plunder or conquer your regions for a year.",USAGES:0,MAX_USAGES:0,COST:30,RESET:function(e,t){},EFFECT:function(e,t){var i=e.getLogService(),n=e.getWorldService(),r=e.getRoyalService();n.addProtection(360),i.success("Ancient protection enabled!"),r.unlockCallback(t)}}}},Op={getSeaEvent:function(e){var t=Object.entries(this.SEA_EVENTS).find(function(t){return t[0]===jv[e]});if(t)return t[1];console.warn("Invalid sea event: "+e)},KING_DEATH_CHANCE:.02,ROADS_DISTANCE_MODIFIER:.8,REGIONS:[{ID:0,PATH:"m 126.49907,133.07398 7.34991,7.88445 11.67185,8.93323 4.23333,15.875 11.37709,2.64584 7.14375,8.46666 0.26458,8.59896 13.89063,3.96875 15.08125,-9.525 -1.19063,-16.40417 9.78958,-4.36562 11.2448,5.68854 11.77395,-5.42396 17.33021,3.83646 3.57188,-11.50937 -7.80521,-10.58334 0.66146,-10.45104 7.40833,-7.14375 0.79375,-5.15937 -6.48229,-1.32292 -2.24896,-7.40833 -10.05417,-5.29167 -9.12812,3.96875 -1.71979,-6.21771 1.45521,-8.069789 0.66145,-5.89643 -6.04761,-5.858629 -11.90625,-0.944941 -15.11905,5.669645 -13.08608,0.871196 -12.96258,5.345393 -10.28987,7.617185 -5.07812,-7.750818 -10.55715,5.211754 -6.5481,6.681744 8.68626,10.15624 -7.75082,0.53454 z",LAND:500,FOREST:500,MOUNTAINS:100,CENTER:{x:187,y:127},NEIGHBOURS:[-1,1,2,13],WEALTH:0,HARBOUR:!0,TROOPS:[]},{ID:1,PATH:"m 126.49907,133.07398 -24.13484,-2.04836 -6.013569,-14.96709 -11.49259,-7.61718 4.677217,-1.33635 5.479026,-16.971615 -3.608139,-3.073598 3.741775,-19.510677 -2.405428,-3.340867 13.497118,-6.414468 11.22531,10.15624 11.09169,-3.073598 5.21176,5.211754 10.55714,-4.409945 2.53906,1.336347 4.00905,5.211754 -7.61719,5.479026 21.19488,15.545464 -10.28987,7.617183 -5.07812,-7.750816 -10.55715,5.211754 -6.5481,6.681742 8.68626,10.15624 -7.75082,0.53454 -6.41447,17.37252",LAND:80,FOREST:100,MOUNTAINS:0,CENTER:{x:116,y:97},NEIGHBOURS:[0,2,3,4,7,13,15],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:2,PATH:"m 126.49907,133.07398 -24.13484,-2.04836 0.4009,8.01809 -21.782464,-3.60814 -12.828937,12.96257 v 8.95353 l -11.893494,18.04069 -0.80181,16.83798 19.510677,-3.20723 14.03165,-4.67722 2.138156,-10.28988 9.488072,2.40543 6.949,-8.15172 5.61266,-0.80181 1.46999,12.82894 0.13363,11.49259 3.87541,0.53454 3.87541,-3.34087 3.20723,-9.75534 -0.53454,-8.81989 9.62171,2.13815 -6.28084,-10.28987 6.5481,-11.75986 -1.25576,-9.57787 z",LAND:80,FOREST:100,MOUNTAINS:0,CENTER:{x:100,y:155},NEIGHBOURS:[-1,0,1,3,5],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:3,PATH:"m 56.260235,175.39236 -5.233451,-16.73165 -9.827379,-12.28422 11.433778,-11.43378 1.039435,-11.2448 4.346725,-8.59895 0.566965,-9.92188 6.803573,-0.56696 V 92.703868 l 15.119045,1.700893 10.897249,-7.344976 3.608138,3.073598 -5.479026,16.971617 -4.677217,1.33635 11.49259,7.61718 6.01357,14.96709 0.4009,8.01809 -21.782464,-3.60814 -12.828937,12.96257 v 8.95353 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:71,y:125},NEIGHBOURS:[1,2,4,5],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:4,PATH:"m 41.199405,146.37649 -10.997948,-3.99191 -13.363477,-1.33635 4.577637,-11.0537 -3.508559,-16.87597 10.429075,-11.27348 6.676174,-23.33792 1.469982,-7.483546 14.83346,3.741772 2.405425,-8.285356 -1.202711,-5.879928 12.160763,-1.603618 7.617179,8.151722 8.953529,6.548102 13.898015,-6.1472 -3.741774,19.510677 -10.897251,7.344976 -15.119043,-1.700895 v 11.906254 l -6.803573,0.56696 -0.566965,9.92188 -4.346725,8.59895 -1.039435,11.2448 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:48,y:98},NEIGHBOURS:[1,3,5,6,7],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:5,PATH:"m 6.2808339,146.92816 -14.9670935,3.74177 6.2808339,12.02713 2.00452142,12.6953 -10.82441572,8.28536 0.534539,6.68174 8.9535291,6.949 12.1607629,0.66818 5.479026,8.01808 7.082642,5.07812 h 7.082642 l 0.400905,-10.0226 10.958049,-1.87089 6.013566,3.47451 7.082642,-2.93997 0.935442,-7.48355 0.80181,-16.83798 -5.233451,-16.73165 -9.827379,-12.28422 -10.997948,-3.99191 -13.363477,-1.33635 z",LAND:40,FOREST:70,MOUNTAINS:0,CENTER:{x:25,y:175},NEIGHBOURS:[-1,2,3,4,6,25],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:6,PATH:"M 16.83798,141.04823 6.2808339,146.92816 -0.13363471,129.0211 -12.828937,117.39488 l 4.0090427,-7.88446 -9.3544327,-9.48806 9.0871631,-4.810855 -4.2763121,-4.276313 0.133635,-15.234361 10.2898762,-5.746295 10.9580504,-0.935445 1.0690783,-7.349911 3.7417731,-6.414468 8.819894,3.207234 2.939965,4.009044 1.603617,-2.939966 7.483547,-1.603618 2.806329,13.096208 -1.469982,7.483544 -6.676174,23.337922 -10.429075,11.27348 3.508559,16.87597 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:10,y:92},NEIGHBOURS:[4,5,7,25,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:7,PATH:"M 36.482289,71.023614 33.67596,57.927406 26.192413,59.531024 24.588796,62.47099 21.648831,58.461946 12.828937,55.254712 10.824416,52.314747 7.4835466,48.706608 6.8153729,34.674958 19.91158,32.002264 l 9.888972,1.603616 4.81085,-10.289877 4.409948,3.474504 5.746295,1.469982 14.03165,-4.543581 10.423512,5.879928 16.169806,0.133636 4.276313,9.220798 7.082641,-2.405425 3.474503,2.80633 1.20271,6.815372 -7.349906,5.746295 -1.336353,12.294399 2.405428,3.340867 -13.898017,6.1472 -8.953527,-6.548102 -7.617179,-8.151722 -12.160763,1.603618 1.202711,5.879928 -2.405425,8.285356 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:56,y:44},NEIGHBOURS:[1,4,6,15,18,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:8,PATH:"m 130.40178,245.02827 -7.37053,9.26042 -11.33929,2.07887 -2.26785,7.18154 1.32291,11.15031 6.61459,6.42559 -3.96875,9.82737 -6.23661,1.13395 0.94494,2.64583 3.59077,1.70087 6.61459,-2.64583 1.13392,-3.77976 6.23661,-1.7009 7.55953,-0.94493 3.59077,-5.48066 1.88988,-1.13392 6.61458,1.13392 10.01637,-4.72469 6.99256,6.99257 5.85863,-8.12649 -5.10268,-6.04764 v -10.01636 l 2.26786,-7.9375 -7.37053,-6.23661 -11.1503,-1.88988 -5.29167,6.23661 -2.83482,-5.85863 -6.61458,-6.04762 z",LAND:40,FOREST:50,MOUNTAINS:0,CENTER:{x:138,y:265},NEIGHBOURS:[-1,9,10,11],WEALTH:0,HARBOUR:!0,TROOPS:[]},{ID:9,PATH:"m 165.36458,252.02083 6.22245,-3.26298 4.94449,-4.94449 8.41899,0.66817 5.61266,-5.21175 1.46998,-3.87541 1.73726,0.80181 -0.13364,2.80633 2.27179,4.27631 4.54358,0.66817 2.13816,4.54359 4.54358,0.4009 2.13816,4.94449 1.33635,7.61718 -0.66818,6.1472 -3.87541,4.67722 2.40543,0.93544 2.67269,-0.93544 2.6727,1.33633 -0.13364,2.80633 -4.94448,1.20272 -4.54358,-1.33633 -3.34087,-3.60815 -3.0736,-1.20272 -3.60814,2.53908 -0.53454,5.07812 3.20723,3.74176 3.87541,0.93544 -0.13363,3.8754 -4.14268,1.0691 -6.94901,1.46997 -7.21627,-1.73725 -5.47903,-3.8754 -5.61266,0.66817 -8.84536,-1.09132 5.85863,-8.12649 -5.10268,-6.04764 v -10.01636 z",LAND:40,FOREST:40,MOUNTAINS:10,CENTER:{x:186,y:263},NEIGHBOURS:[-1,8,11],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:10,PATH:"m 111.69196,296.43302 -4.51688,2.97241 -4.94449,1.60362 -1.87088,4.40994 v 6.68173 l 3.4745,-1.06907 -0.26727,4.81084 1.06908,4.9445 5.47902,2.93995 -0.8018,5.07812 5.34539,-1.46997 -1.06908,9.75534 -5.07812,4.6772 0.4009,3.47451 3.34087,0.13364 1.46998,-2.93997 5.87993,-1.20272 2.93997,4.40995 5.61266,2.00453 0.66817,5.21177 6.5481,2.53904 2.40543,-2.67269 5.87993,-2.00453 -0.40091,-4.40994 6.54811,-1.60362 -2.00452,-4.40994 1.87088,-3.34087 4.14268,-4.67722 2.13816,-5.87992 -8.01809,-3.47451 -1.73725,-6.28083 1.87089,-7.88445 -0.26727,-5.47902 0.4009,-6.94902 5.07812,-3.60815 -1.33635,-6.01355 -6.61088,-4.82918 -6.61458,-1.13392 -1.88988,1.13392 -3.59077,5.48066 -7.55953,0.94493 -6.23661,1.7009 -1.13392,3.77976 z",LAND:20,FOREST:50,MOUNTAINS:20,CENTER:{x:130,y:316},NEIGHBOURS:[-1,8,11],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:11,PATH:"m 200.58578,287.64555 3.20723,4.67723 6.41447,5.47901 0.13363,5.47905 4.54359,1.06907 1.06908,7.88445 3.60814,8.95353 -3.60814,5.61266 -4.40995,-1.60361 -4.00904,-0.53454 -0.80181,4.00905 -3.47451,4.14266 -11.89349,-0.4009 -0.13363,-4.54358 2.80633,-1.73726 v -4.00904 l -5.7463,-0.4009 -1.60362,3.60815 -2.53906,4.94448 -6.01356,2.4054 -4.14268,-5.34537 1.73725,-5.21176 5.47903,-5.74631 0.13363,-5.34537 -4.54358,-3.74177 -5.47903,4.94448 -0.53453,7.34992 -2.13816,7.88445 -6.94901,-2.80633 -5.74629,1.73725 -8.01809,-3.47451 -1.73725,-6.28083 1.87089,-7.88445 -0.26727,-5.47902 0.4009,-6.94902 5.07812,-3.60815 -1.33635,-6.01355 -6.61088,-4.82918 10.01637,-4.72469 6.99256,6.99257 8.84536,1.09132 5.61266,-0.66817 5.47903,3.8754 7.21627,1.73725 z",LAND:70,FOREST:20,MOUNTAINS:0,CENTER:{x:188,y:303},NEIGHBOURS:[-1,8,9,10],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:12,PATH:"m 263.52775,322.65786 0.26727,9.62171 -7.48355,5.3454 -1.06907,5.87992 3.74177,4.27632 h 7.7508 l 8.0181,6.94899 1.33635,6.68174 8.81989,2.40543 4.27633,-1.60361 10.4235,1.60361 1.33635,-4.2763 -6.94901,-5.87994 -0.53454,-5.87992 4.81084,2.40541 6.94901,0.53454 3.74177,-5.87992 -4.00902,-5.87994 -6.68176,-2.67269 4.54358,-5.07812 -1.87087,-7.75081 -9.08716,-2.67269 -5.07813,3.20723 -6.41447,-6.1472 -8.0181,0.8018 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:282,y:340},NEIGHBOURS:[-1],WEALTH:0,HARBOUR:!0,TROOPS:[]},{ID:13,PATH:"M 177.41392,87.905422 190.5,87.034226 l 15.11905,-5.669645 11.90625,0.944941 6.04761,5.858631 c -1.13392,0.377976 4.15774,-1.511905 4.15774,-1.511905 v -3.401785 l -6.99256,-7.9375 2.64583,-9.449403 h 6.04763 l -1.32292,-6.425597 -15.11905,-2.456844 -12.09524,-6.614583 -13.79613,3.023809 -7.18155,-8.882441 -9.82738,-4.157739 0.37798,-10.016368 -3.59077,-8.126488 -15.49703,-3.590774 -17.76488,13.040178 -0.37797,14.363097 1.32291,13.229166 9.76602,6.42525 2.53906,1.336347 4.00905,5.211752 -7.61719,5.479026 21.19488,15.545464 z",LAND:80,FOREST:40,MOUNTAINS:50,CENTER:{x:169,y:61},NEIGHBOURS:[-1,0,1,15,14],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:14,PATH:"m 228.10863,59.441963 7.18154,-1.700892 5.10268,2.834822 6.4256,-2.456847 -5.10268,-6.236607 -6.99256,-4.535712 10.20536,-1.133931 7.55952,3.590775 2.07887,-6.047619 5.10268,-6.236607 -0.18899,-7.559524 -8.12649,-8.126488 -12.28422,-2.834821 0.56696,-7.181548 -16.06399,1.322917 -26.45833,-2.456846 -6.42559,-5.6696423 -15.875,3.2127975 -7.9375,13.9851188 3.59077,8.126488 -0.37798,10.016368 9.82738,4.157739 7.18155,8.882441 13.79613,-3.023809 12.09524,6.614583 z",LAND:50,FOREST:80,MOUNTAINS:0,CENTER:{x:210,y:32},NEIGHBOURS:[-1,13,15,16],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:15,PATH:"m 85.392611,29.730472 -0.536956,-8.275115 13.985118,-2.267858 9.449407,-5.291666 4.91369,-7.7485118 12.47321,0.9449405 V -4.0580357 l 12.6622,-2.0788691 12.85119,4.7247023 -0.94494,5.6696428 3.96875,2.8348214 6.80358,-3.779762 8.12648,2.2678572 5.66965,2.6458333 -7.9375,13.9851188 -15.49703,-3.590774 -17.76488,13.040178 -0.37797,14.363097 1.32291,13.229166 9.76602,6.42525 -10.55714,4.409943 -5.21176,-5.211752 -11.09169,3.073596 -11.22531,-10.156237 -13.497121,6.414465 1.336355,-12.294399 7.349906,-5.746295 -1.20271,-6.815372 -3.474505,-2.80633 -7.082639,2.405425 z",LAND:50,FOREST:60,MOUNTAINS:50,CENTER:{x:119,y:32},NEIGHBOURS:[1,7,13,14,16,17,18],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:16,PATH:"m 138.33928,-6.1369048 -1.13392,-15.6860122 14.93005,-5.102678 3.2128,5.291667 15.30804,-5.858632 5.29166,-7.9375 12.09524,5.10268 15.30804,-12.662204 13.79613,0.566965 5.10268,10.772322 4.34672,-0.377975 4.34673,-5.291667 4.7247,3.023809 -2.07887,8.315475 1.88988,10.583334 7.9375,12.0952374 -12.47321,9.4494048 -7.37054,6.9925598 -26.45833,-2.456846 -6.42559,-5.6696423 -15.875,3.2127975 -5.66965,-2.6458333 -8.12648,-2.2678572 -6.80358,3.779762 -3.96875,-2.8348214 0.94494,-5.6696428 z",LAND:30,FOREST:30,MOUNTAINS:10,CENTER:{x:194,y:-12},NEIGHBOURS:[-1,14,15,17,108],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:17,PATH:"m 121.38705,-45.729911 -13.47485,-20.883184 -10.016368,9.827382 -14.174107,2.078868 0.755951,8.882441 6.803573,3.96875 3.96875,11.339285 -5.669643,6.047619 0.755952,9.449405 6.614581,7.9374999 0.188989,8.8824402 6.236612,3.0238094 6.04762,-2.6458332 3.77976,3.9687499 12.47321,0.9449405 V -4.0580357 l 12.6622,-2.0788691 -1.13392,-15.6860122 1.96547,-11.320386 z",LAND:20,FOREST:60,MOUNTAINS:50,CENTER:{x:114,y:-21},NEIGHBOURS:[15,16,18,19,20,108],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:18,PATH:"M 0.75595238,29.581845 -3.7797618,20.888392 -13.418155,15.029762 -9.8273808,6.5252975 0.56696427,3.8794642 6.8035714,8.9821426 5.6696427,-1.6011906 l 5.6696433,-2.6458333 4.157738,3.40178565 11.339285,-7.55952375 4.157739,-7.181547 13.229166,-1.133929 7.181546,9.8273808 5.858632,-4.9136908 -2.456844,-5.291666 10.583333,2.267857 5.102677,6.9925592 6.614584,-10.3943452 13.229166,3.212798 6.614583,7.9374997 0.188989,8.8824404 6.23661,3.0238094 6.04762,-2.6458332 3.77976,3.9687499 -4.91369,7.7485118 -9.449407,5.291666 -13.985118,2.267858 0.536956,8.275115 L 69.222807,29.596836 58.799295,23.716908 44.767645,28.260489 39.02135,26.790507 34.611402,23.316003 29.800552,33.60588 19.91158,32.002264 6.8153729,34.674958 Z",LAND:20,FOREST:80,MOUNTAINS:30,CENTER:{x:48,y:7},NEIGHBOURS:[7,15,17,19,22,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:19,PATH:"m 30.994048,-15.586309 -9.638393,-5.858632 -3.02381,-8.598956 -5.386161,-0.472472 2.173363,-3.590774 4.724703,-1.228421 0.377976,-6.331103 4.252232,-7.559522 5.669642,1.41741 7.087055,-1.795388 7.654018,-4.346726 4.630208,3.779763 7.559524,-1.417412 4.157737,-3.779761 3.685267,3.496281 1.228424,5.38616 3.401784,-0.850448 3.02381,-5.008184 4.535715,-2.267857 6.614583,-0.09449 0.755949,8.882441 6.803575,3.96875 3.96875,11.339285 -5.669645,6.047619 0.755954,9.449405 -13.229166,-3.212798 -6.614584,10.3943452 -5.102677,-6.9925592 -10.583333,-2.267857 2.456844,5.291666 -5.858632,4.9136908 -7.181546,-9.8273808 z",LAND:20,FOREST:60,MOUNTAINS:40,CENTER:{x:54,y:-32},NEIGHBOURS:[17,18,20,21,22],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:20,PATH:"m 109.80208,-78.519342 -8.23966,-5.473369 -4.543584,-9.354434 -10.557144,-1.469982 -10.557148,5.078121 -3.340867,6.68174 -11.49259,-0.668176 -4.276312,-7.082642 -13.096208,-0.400904 -7.082642,7.349913 -3.608139,6.681737 -13.363476,-5.078122 -8.018086,8.819896 -2.5390601,9.755339 -10.02260723,6.280832 3.47450383,7.082642 8.8198945,3.207234 8.862771,5.44285 4.252232,-7.559522 5.669642,1.41741 7.087055,-1.795388 7.654018,-4.346726 4.630208,3.779763 7.559524,-1.417412 4.157737,-3.779761 3.685267,3.496281 1.228424,5.38616 3.401784,-0.850448 3.02381,-5.008184 4.535715,-2.267857 6.614583,-0.09449 14.174104,-2.078874 10.016371,-9.827382 z",LAND:20,FOREST:40,MOUNTAINS:20,CENTER:{x:53,y:-68},NEIGHBOURS:[-1,17,19,21,33,108],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:21,PATH:"m -12.428033,-35.483294 -4.944486,-3.340867 -7.216277,0.400904 -4.409947,-4.142676 -1.603618,-7.082645 3.207234,-4.81085 7.884452,-2.672696 8.953529,3.608139 3.8754078,-4.81085 5.74629489,0.935442 3.47450381,7.082642 8.8198945,3.207234 8.862771,5.44285 -0.377976,6.331103 -4.724703,1.228421 -2.173363,3.590774 -8.1348325,-0.02244 -7.884451,5.61266 -4.8108512,-3.60814 0.5345388,-5.211754 z",LAND:10,FOREST:10,MOUNTAINS:20,CENTER:{x:-4,y:-42},NEIGHBOURS:[19,20,22,31,32,33],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:22,PATH:"m 12.945684,-30.516369 -8.1348325,-0.02244 -7.884451,5.61266 -4.8108514,-3.60814 0.534539,-5.211754 -5.0781211,-1.737252 -3.340869,5.61266 0.400904,6.280834 -13.22984,0.133635 -5.345391,5.34539 -9.621702,0.400904 -12.160766,5.345391 -3.741772,6.5481032 0.668174,7.7508163 -4.009044,5.2117558 -7.082641,2.0045214 3.608138,2.9399643 11.091685,6.548104 3.608139,9.888971 8.285356,-0.534537 6.414468,3.608138 6.815373,-0.53454 -0.400905,8.285356 9.354434,3.207234 3.727387,7.811127 6.425596,-6.236608 6.8035709,-3.212798 -0.7559524,-7.9375 5.66964288,-3.401785 -4.53571418,-8.693453 -9.6383932,-5.85863 3.5907742,-8.5044645 10.39434507,-2.6458333 6.23660713,5.1026782 -1.1339287,-10.583333 5.6696433,-2.6458333 4.157738,3.40178565 11.339285,-7.55952375 4.157739,-7.181547 -9.638393,-5.858632 -3.02381,-8.598956 z",LAND:30,FOREST:50,MOUNTAINS:20,CENTER:{x:-25,y:2},NEIGHBOURS:[18,19,21,23,30,31,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:23,PATH:"m -17.386905,50.370536 -3.727387,-7.811127 -9.354434,-3.207234 0.400905,-8.285356 -6.815373,0.53454 -6.414468,-3.608138 -8.285356,0.534537 -3.608139,-9.888971 -11.091685,-6.548104 -12.828936,3.34087 -8.151723,7.617181 -0.801806,10.690781 -8.285356,2.405425 1.069078,6.013564 -11.893495,6.414468 2.27179,2.672697 6.414471,-0.801809 -2.672701,8.953529 -5.21175,6.548104 8.819893,9.087164 3.059332,6.331924 6.614581,-0.755954 5.858634,-10.961307 3.779758,-11.150298 10.016371,2.645833 14.174108,-0.566962 8.504462,8.126487 14.363096,-1.700893 13.418154,-7.181548 z",LAND:30,FOREST:80,MOUNTAINS:0,CENTER:{x:-62,y:44},NEIGHBOURS:[22,24,28,29,30,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:24,PATH:"m -91.848214,135.22619 -10.016366,-6.80357 -2.26786,-8.50447 -10.58333,-7.9375 6.2366,-7.9375 12.851195,2.64584 8.504465,-10.583337 -6.992561,-7.74851 -0.377976,-6.992562 6.614583,-0.755952 5.858632,-10.961309 3.77976,-11.150298 10.016371,2.645833 14.174108,-0.566962 8.504462,8.126487 14.363096,-1.700893 -7.181548,7.748511 -2.267857,12.662204 1.889881,10.77232 -9.449405,5.858628 -4.157737,8.50447 5.669642,7.37053 -7.937499,7.18155 -3.212799,6.23661 -4.724701,3.40178 -13.607143,-3.59077 -9.07143,3.59077 z",LAND:40,FOREST:90,MOUNTAINS:40,CENTER:{x:-68,y:97},NEIGHBOURS:[23,25,26,28,106,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:25,PATH:"m -11.22532,183.67772 -14.855037,-2.33844 -17.197917,2.26786 -3.023809,-6.04762 5.669643,-3.96875 -7.370535,-6.61458 -12.851191,-1.51191 -1.889882,-10.39434 5.858632,-4.34673 4.157739,-11.52827 -5.10268,-5.85863 3.212799,-6.23661 7.937499,-7.18155 9.827382,-1.70089 0.755952,-7.37053 10.016368,-1.7009 7.90603,-9.12347 9.3544327,9.48806 -4.0090427,7.88446 12.69530229,11.62622 6.41446861,17.90706 -14.9670935,3.74177 6.2808339,12.02713 2.00452142,12.6953 z",LAND:30,FOREST:80,MOUNTAINS:20,CENTER:{x:-29,y:146},NEIGHBOURS:[-1,5,6,24,26,106],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:26,PATH:"m -60.854166,165.46428 -11.528274,8.31548 -4.913691,12.47321 -4.724701,13.04018 -16.063989,0.75595 -14.174109,4.72471 -9.63839,-5.85863 -2.83482,-9.6384 -8.50447,-11.52827 1.32292,-5.85863 0.56697,-10.96131 10.01636,-8.12649 16.63096,-3.40178 -1.13393,-8.12649 4.34672,1.13393 2.834826,4.53571 3.96875,2.83482 3.590774,-6.61458 -0.755954,-7.9375 6.614583,1.5119 9.07143,-3.59077 13.607143,3.59077 4.724701,-3.40178 5.10268,5.85863 -4.157739,11.52827 -5.858632,4.34673 z",LAND:30,FOREST:60,MOUNTAINS:30,CENTER:{x:-96,y:170},NEIGHBOURS:[-1,24,25,27,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:27,PATH:"m -133.23661,177.74851 -6.14445,7.53282 0.93545,7.75082 1.87088,10.15624 -4.54358,9.75534 -8.95353,-3.60814 0.26727,-6.1472 -3.87541,-5.74629 2.13816,-5.61266 -5.34539,0.4009 -5.07812,6.41447 -0.13364,6.54811 -8.68626,-2.53906 -8.01808,1.60361 -4.14268,-6.28083 2.6727,-5.61266 -6.28084,-0.93545 -3.87541,-7.88445 6.1472,-4.27631 4.00905,-9.2208 h 7.08264 l 2.40542,-7.61718 -1.73725,-4.27631 7.48355,-0.80181 3.60814,4.40995 1.73725,5.34539 6.41447,-8.95353 11.22532,-0.53454 2.93996,5.21176 7.76707,-1.90213 -0.56697,10.96131 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-158,y:180},NEIGHBOURS:[-1,26,39,40,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:28,PATH:"m -180.86161,118.40625 0.75596,-10.20536 10.20535,-6.99256 -4.53571,-5.480652 10.96131,1.511903 5.48065,-0.944938 3.59078,-11.150299 16.81994,2.456844 5.29167,-8.693451 -3.96875,-3.96875 1.5119,-3.401785 8.12649,3.401785 6.42559,-1.700893 -0.18899,-8.88244 5.29167,4.157739 8.72048,-2.5679 8.819893,9.087162 3.059332,6.331926 0.377976,6.992562 6.992559,7.748508 -8.504465,10.583339 -12.851195,-2.64584 -6.2366,7.9375 10.58333,7.9375 -9.54722,7.96695 -7.27652,2.27925 -4.4037,-4.96972 -0.28353,-14.18749 -10.61059,6.01356 -1.6838,7.64391 -6.21548,5.63935 -11.19493,3.03235 -8.12649,-7.74851 -11.33929,4.15773 z",LAND:10,FOREST:60,MOUNTAINS:50,CENTER:{x:-130,y:100},NEIGHBOURS:[23,24,29,38,39,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:29,PATH:"m -154.40327,85.144342 -7.18155,-7.748511 2.26786,-8.315476 -10.96131,-9.449403 -1.88988,-13.04018 3.77976,-9.071427 6.61458,-8.693452 -2.07887,-9.071429 11.33929,6.236607 11.71726,0.377976 6.99256,-7.9375 -2.64583,-7.370536 10.58333,3.212798 6.23661,11.90625 10.77232,3.401786 10.205356,-5.669643 11.388283,-0.863468 -0.801804,10.690781 -8.285358,2.405425 1.069078,6.013564 -11.893495,6.414468 2.27179,2.672697 6.414471,-0.801809 -2.672701,8.953529 -5.21175,6.548104 -8.72048,2.5679 -5.29167,-4.157739 0.18899,8.882438 -6.42559,1.700895 -8.12649,-3.401785 -1.5119,3.401785 3.96875,3.96875 -5.29167,8.693449 z",LAND:30,FOREST:80,MOUNTAINS:20,CENTER:{x:-140,y:51},NEIGHBOURS:[23,28,30,37,38,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:30,PATH:"m -59.467469,-5.8163777 -9.220798,-5.8799263 -12.294399,1.603617 -1.603618,-9.087164 4.009043,-4.009043 -6.147199,-2.939964 -7.750815,7.216276 -12.027135,-3.474503 -3.20723,-8.285357 -13.63075,7.483548 -3.20723,8.552625 -15.7689,4.8108514 1.60362,11.7598591 6.94901,4.0090428 -4.68553,5.1175267 10.58333,3.212798 6.23661,11.90625 10.77232,3.401786 10.205356,-5.669643 11.388283,-0.863468 8.151723,-7.617181 12.828936,-3.34087 -3.608138,-2.9399675 7.082641,-2.0045214 4.009044,-5.2117556 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-104,y:-2},NEIGHBOURS:[22,23,29,31,32,36,37],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:31,PATH:"m -84.72444,-26.128858 13.630746,-4.276312 4.276312,-8.285356 -1.603616,-4.810852 5.34539,-1.870887 0.80181,8.018086 4.543581,0.267269 4.810852,-9.354434 22.317004,-3.207234 1.603618,7.082645 4.409947,4.142676 7.216277,-0.400904 4.944486,3.340867 -3.340869,5.612659 0.400904,6.280834 -13.22984,0.133635 -5.345391,5.34539 -9.621702,0.400904 -12.160766,5.345391 -3.741772,6.5481033 -9.220798,-5.8799263 -12.294399,1.603617 -1.603618,-9.087164 4.009043,-4.009043 z",LAND:20,FOREST:60,MOUNTAINS:50,CENTER:{x:-50,y:-28},NEIGHBOURS:[21,22,30,32],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:32,PATH:"m -64.946495,-102.83521 -1.069078,10.42351 -9.888971,5.879928 -5.34539,11.49259 -9.621705,1.336347 -2.138157,8.552627 6.414471,-0.801809 5.879928,3.474503 -2.939965,8.285355 -2.939963,12.561668 -10.156242,-1.870887 -3.207235,8.552624 -7.750818,4.276312 3.20723,8.285357 12.027137,3.474503 7.750813,-7.216276 13.630746,-4.276312 4.276312,-8.285356 -1.603616,-4.810852 5.34539,-1.870887 0.80181,8.018086 4.543581,0.267269 4.810852,-9.354434 22.317004,-3.207234 3.207234,-4.81085 7.884452,-2.672696 8.953529,3.608139 -3.427973,-6.663516 4.1577382,-10.583333 4.5357142,-7.559521 -6.9925594,-6.614581 -5.102679,-1.322919 -9.072777,-2.402073 -15.234365,0.267269 -12.561667,-1.603616 z",LAND:20,FOREST:40,MOUNTAINS:90,CENTER:{x:-57,y:-64},NEIGHBOURS:[21,30,31,33,34,35,36,52],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:33,PATH:"m 56.794775,-90.808084 0.846593,-10.200846 11.339287,-10.01637 -9.092728,-8.51199 -10.075318,-5.00147 -5.635252,-10.79329 -7.313215,1.72579 -1.716291,5.14658 -4.468898,3.86557 -14.384054,0.56892 -4.199661,-7.69708 -6.5002804,4.10109 -3.9743132,9.24176 -7.6666341,4.15346 0.6681736,7.75293 -7.1898919,3.9522 -4.819197,16.252975 5.102679,1.322917 6.9925594,6.614583 -4.5357142,7.559521 -4.1577382,10.583333 3.427973,6.663516 3.8754078,-4.81085 5.74629489,0.935442 10.02260701,-6.280832 2.5390603,-9.755339 8.018086,-8.819896 13.363476,5.078122 3.608139,-6.681737 7.082642,-7.349911 z",LAND:30,FOREST:50,MOUNTAINS:70,CENTER:{x:20,y:-101},NEIGHBOURS:[-1,20,21,32,34],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:34,PATH:"m 5.5949574,-127.62118 -12.8112346,-9.42453 -4.8108518,-9.6217 -10.95805,-2.6727 -5.879928,-10.42351 -9.354434,5.34539 -9.087165,9.88897 -16.83798,-4.00904 -5.612659,7.75082 9.888972,14.43255 2.672696,14.96709 -7.750818,8.55263 10.690781,12.828935 12.561667,1.603616 15.234365,-0.267269 9.072777,2.402073 4.819197,-16.252975 7.189892,-3.9522 -0.6681737,-7.75293 7.6666341,-4.15346 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-34,y:-117},NEIGHBOURS:[-1,32,33,35],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:35,PATH:"m -69.757345,-140.78748 -4.276315,-2.53906 -8.819893,1.46998 -4.142676,8.68626 -7.216278,0.53454 -2.004523,4.94448 -9.88897,1.87089 1.06908,6.28083 7.349908,7.34992 -1.870885,8.81989 7.349911,6.280834 3.741774,8.552624 6.414468,3.207234 0.801812,10.289876 5.345388,-11.49259 9.888971,-5.879928 1.069078,-10.42351 7.750818,-8.55263 -2.672696,-14.96709 z",LAND:20,FOREST:10,MOUNTAINS:20,CENTER:{x:-81,y:-112},NEIGHBOURS:[-1,32,34,52,53],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:36,PATH:"m -121.34037,-23.188894 -6.949,-5.879929 -1.06908,-12.561668 -8.28535,-0.267269 -4.54359,5.34539 -5.61266,-10.423511 5.34539,-10.156243 12.2944,-4.81085 -4.27631,-8.285355 0.53454,-16.570712 4.27631,4.009044 1.87089,5.879928 6.68174,5.078121 9.35443,-4.81085 6.94901,4.009041 3.20723,-7.483546 10.690783,6.414468 -2.138159,8.552627 6.414471,-0.801809 5.879928,3.474503 -2.939965,8.285355 -2.939963,12.561668 -10.15624,-1.870887 -3.207237,8.552624 -7.750818,4.276312 z",LAND:20,FOREST:60,MOUNTAINS:10,CENTER:{x:-114,y:-52},NEIGHBOURS:[30,32,37,50,51,52],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:37,PATH:"m -192.57887,9.1711303 7.37054,2e-7 4.53571,-4.9136905 7.9375,2.8348215 5.29167,3.5907735 5.85863,-3.4017854 5.48066,0.9449403 3.96875,-7.37053545 -6.23661,-5.66964285 -2.07887,-5.2916666 6.42559,0.3779764 4.91369,-3.7797624 -0.18898,-6.236607 h 7.55952 l 6.23661,-3.212797 1.70089,-5.480656 5.5142,-0.631322 6.949,5.879929 -3.20723,8.552625 -15.7689,4.8108514 1.60362,11.7598591 6.94901,4.0090428 -4.68553,5.1175267 2.64583,7.370536 -6.99256,7.9375 -11.71726,-0.377976 -11.33929,-6.236607 -16.28698,1.423383 -20.31248,-8.552624 7.30631,-0.241295 z",LAND:10,FOREST:30,MOUNTAINS:10,CENTER:{x:-146,y:10},NEIGHBOURS:[29,30,36,48,49,50,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:38,PATH:"m -210.91071,87.979162 -16.80293,-8.536559 5.3454,-13.898015 17.35916,-9.795427 17.53764,3.566014 15.30329,-12.724403 1.88988,13.04018 10.96131,9.449403 -2.26786,8.315476 7.18155,7.748511 -3.59078,11.150301 -5.48065,0.944938 -10.96131,-1.511903 4.53571,5.480652 -10.20535,6.99256 -12.66221,-5.85863 -3.0238,-12.095238 -10.20536,-10.961309 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-183,y:80},NEIGHBOURS:[-2,28,29,47,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:39,PATH:"m -249.46428,177.74851 0.75595,-13.41816 16.06399,-11.33928 -5.10268,-10.01637 -5.85863,-12.09524 17.19791,-4.53571 2.64584,-7.74851 -6.4256,-8.12649 6.23661,-2.26786 6.99256,7.9375 -1.51191,12.47321 13.41816,-6.42559 7.55952,-10.58333 16.63095,6.80357 6.04762,11.33928 11.33929,-4.15773 8.12649,7.74851 -3.02381,14.74107 5.09295,10.0761 -6.41447,8.95353 -1.73725,-5.34539 -3.60814,-4.40995 -7.48355,0.80181 1.73725,4.27631 -2.40542,7.61718 h -7.08264 l -4.00905,9.2208 -6.1472,4.27631 -13.29962,-11.84314 -0.18899,8.50441 -14.74107,1.32297 -12.66221,-7.18155 0.56697,9.82733 -13.60714,7.9375 z",LAND:20,FOREST:100,MOUNTAINS:50,CENTER:{x:-202,y:151},NEIGHBOURS:[-2,27,28,40,41,109],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:40,PATH:"m -182.94599,197.97664 -6.23109,10.57693 5.85863,10.20536 -14.93006,0.18898 -2.91317,-7.67206 -6.15826,-0.0764 -4.7247,6.4256 5.48065,10.20535 -3.21279,10.39435 -8.88244,6.99256 -5.66965,2.45684 -4.34672,-3.59077 -9.82738,-4.53571 1.13392,-13.60715 6.61459,-9.26041 -0.94494,-6.61459 -6.12787,-0.5266 -9.93612,6.76321 -4.15774,10.96131 -7.35164,10.34705 -1.33945,-7.70599 0.5646,-10.76755 -2.06955,-10.52743 6.53439,-10.09117 11.22118,-6.4067 13.60714,-7.9375 -0.56697,-9.82738 12.66221,7.18155 14.74107,-1.32292 0.18899,-8.50446 13.29962,11.84314 3.87541,7.8845 6.28084,0.93545 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-220,y:202},NEIGHBOURS:[-1,27,39,41],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:41,PATH:"m -260.61222,229.9045 -16.25534,-4.53099 0.56697,9.63839 -25.13541,3.40179 -11.71726,-3.02381 -4.72472,-13.98512 4.91371,-13.79613 -8.31548,-13.98512 6.61458,-10.39435 14.1741,4.91369 7.9375,-11.33928 12.28423,-7.55953 2.07886,-11.33928 13.60715,5.10268 0.18899,11.1503 14.93006,3.59077 5.10268,14.36309 -11.22118,6.40675 -6.53439,10.09117 2.06955,10.52738 z",LAND:20,FOREST:60,MOUNTAINS:10,CENTER:{x:-283,y:201},NEIGHBOURS:[-1,-2,39,40,42,43],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:42,PATH:"m -317.87798,221.40476 -5.25087,-3.51654 -10.15624,5.07812 1.60361,10.15624 -5.3454,5.61266 -12.56165,3.74177 -10.42352,-6.949 2.67268,-9.88898 -8.28534,-6.41447 1.33635,-8.28535 7.48356,-9.6217 -3.47451,-8.01809 11.75986,-2.93996 10.15624,-2.13816 6.41445,-8.01809 5.3454,4.00905 11.93819,-0.9831 -6.61458,10.39435 8.31548,13.98512 z",LAND:10,FOREST:60,MOUNTAINS:20,CENTER:{x:-340,y:210},NEIGHBOURS:[-1,41,43,44,65],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:43,PATH:"m -314.66517,183.22916 -11.93819,0.9831 -5.3454,-4.00905 -8.5526,-0.8018 1.60361,-12.02713 -4.27633,-10.15625 7.48356,0.26728 8.28534,8.81989 -1.33633,-10.15624 -7.48355,-9.35444 5.61266,-6.68173 5.87994,1.33634 -4.54358,-11.75986 14.79986,-0.88868 4.15774,12.47322 19.65476,3.77976 12.4732,12.85119 -2.07886,11.33928 -12.28423,7.55953 -7.9375,11.33928 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-308,y:163},NEIGHBOURS:[-2,41,42,44,45],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:44,PATH:"m -339.69957,130.22381 -10.4235,1.60362 -3.74179,7.75082 -8.01806,5.07812 -5.87994,15.50163 8.28534,7.75082 -4.54358,12.56166 -11.49257,7.75082 2.4054,12.2944 8.81991,10.42351 7.48356,-9.6217 -3.47451,-8.01809 21.9161,-5.07812 6.41445,-8.01809 -8.5526,-0.8018 1.60361,-12.02713 -4.27633,-10.15625 7.48356,0.26728 8.28534,8.81989 -1.33633,-10.15624 -7.48355,-9.35444 5.61266,-6.68173 5.87994,1.33634 -4.54358,-11.75986 -4.27633,4.00905 z",LAND:20,FOREST:40,MOUNTAINS:10,CENTER:{x:-351,y:162},NEIGHBOURS:[42,43,45,63,64,65],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:45,PATH:"m -320.45616,56.190154 -13.89801,2.405425 -12.82895,-2.672693 -0.53454,10.958049 -10.4235,12.561668 11.75986,3.207234 -2.40544,13.630746 8.0181,15.768897 8.55263,1.87089 -7.48356,16.30344 6.1472,3.47451 4.27633,-4.00905 14.79986,-0.88868 8.31546,-15.11904 -14.36309,-25.324407 12.85121,-1.13393 -14.11992,-9.116957 -4.00904,-12.561668 z",LAND:20,FOREST:50,MOUNTAINS:0,CENTER:{x:-330,y:97},NEIGHBOURS:[-2,43,44,46,62,63],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:46,PATH:"m -307.6726,87.223213 -14.11992,-9.116957 -4.00904,-12.561668 5.3454,-9.354434 -1.33636,-14.699823 -10.69078,-1.336347 -2.67269,-8.552625 6.41448,-2.138156 19.24341,-3.207235 8.81989,4.810851 13.63075,-10.69078 17.37251,-4.810852 14.16529,4.009043 9.35443,-0.534539 11.75986,-5.61266 10.95805,7.750816 -8.55263,15.501634 -7.21627,-1.870888 -8.8199,-6.147199 -6.41447,9.087165 1.60362,9.888971 -12.56167,0.267269 -10.95804,-4.009043 -8.01809,2.405427 1.60361,11.225318 7.75081,13.898018 -17.90705,7.483546 0.75181,9.827051 z",LAND:30,FOREST:60,MOUNTAINS:80,CENTER:{x:-286,y:38},NEIGHBOURS:[-2,45,47,48,60,61,62,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:47,PATH:"m -292.17559,88.735116 -0.75181,-9.827051 17.90705,-7.483546 -7.75081,-13.898018 -1.60361,-11.225318 8.01809,-2.405427 10.95804,4.009043 12.56167,-0.267269 -1.60362,-9.888971 6.41447,-9.087165 8.8199,6.147199 7.21627,1.870888 8.55263,9.621702 1.06908,19.243405 -5.3454,13.898015 16.80293,8.536559 -21.92262,5.291669 h -15.875 l -9.07143,17.008929 -19.65475,-1.88988 -10.96132,-9.071428 z",LAND:10,FOREST:60,MOUNTAINS:50,CENTER:{x:-254,y:73},NEIGHBOURS:[-2,38,46,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:48,PATH:"m -234.39537,13.427031 1.18406,-11.2484599 -5.66964,-8.5044643 3.77976,-9.4494048 4.15774,2.834822 3.2128,-7.9375 -6.23661,-6.99256 2.83482,-9.071427 13.41816,-4.535715 11.52827,7.9375 2.07887,12.473214 8.50446,0.755952 3.02381,6.992559 -0.37797,12.47321459 -5.48066,2.45684521 5.85863,7.5595237 -0.56696,3.2127975 -7.30631,0.241295 -22.98518,8.552624 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-216,y:-3},NEIGHBOURS:[-3,37,46,49,60,107],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:49,PATH:"m -149.11161,-13.507441 -8.69345,-3.96875 1.32292,-8.504464 -9.07143,-3.968749 -7.37054,4.157737 -2.64583,-5.85863 -7.18155,-5.669642 -7.74851,0.377976 -5.66964,-6.425597 -7.37054,3.023809 -2.64583,6.803573 2.07887,12.473214 8.50446,0.755952 3.02381,6.992559 -0.37797,12.47321459 -5.48066,2.45684521 5.85863,7.5595235 h 7.37054 l 4.53571,-4.9136903 7.9375,2.8348215 5.29167,3.5907735 5.85863,-3.4017854 5.48066,0.9449401 3.96875,-7.37053525 -6.23661,-5.66964285 -2.07887,-5.2916666 6.42559,0.3779766 z",LAND:20,FOREST:40,MOUNTAINS:0,CENTER:{x:-177,y:-11},NEIGHBOURS:[-3,37,48,50],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:50,PATH:"m -178.02678,-53.572917 8.12648,-2.078869 3.2128,-7.181548 -5.10268,-9.260416 6.99256,0.94494 4.34673,3.590775 3.40178,-5.858632 -3.77976,-4.724702 7.9375,-2.078868 9.6384,0.944941 1.70089,7.370535 7.11551,1.676434 4.27631,8.285353 -12.2944,4.81085 -5.34539,10.156243 5.61266,10.423511 4.54359,-5.34539 8.28535,0.267269 1.06908,12.561668 -5.5142,0.631322 -1.70089,5.480656 -6.23661,3.212797 h -7.55952 l 0.18898,6.236607 -8.69345,-3.96875 1.32292,-8.504464 -9.07143,-3.968749 -0.56696,-6.425597 -10.39435,-1.322917 1.32292,-7.370534 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-159,y:-47},NEIGHBOURS:[-3,36,37,49,51],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:51,PATH:"m -188.23214,-70.581845 4.61798,-8.199109 7.75081,-0.801809 -3.4745,-8.018087 9.88897,-3.474503 -7.21627,-6.147199 3.20723,-2.405425 2.67269,2.405425 5.87993,-1.069078 -0.53454,-6.1472 5.87993,-1.33635 3.47451,-3.74177 8.81989,1.46998 6.28084,4.54359 -3.74178,2.67269 4.54358,5.07812 8.8199,-2.806326 6.81537,1.336346 1.60362,4.27631 4.00904,-1.603616 5.07812,4.409948 -3.34087,3.073601 5.7463,5.612659 -0.26727,4.81085 -9.35443,4.81085 -6.68174,-5.078121 -1.87089,-5.879928 -4.27631,-4.009044 -0.53454,16.570714 -7.11551,-1.676434 -1.70089,-7.370535 -9.6384,-0.944941 -7.9375,2.078868 3.77976,4.724702 -3.40178,5.858632 -4.34673,-3.590775 -6.99256,-0.944938 5.10268,9.260414 -3.2128,7.181548 -8.12648,2.078869 -8.12649,-9.638393 z",LAND:10,FOREST:30,MOUNTAINS:50,CENTER:{x:-153,y:-90},NEIGHBOURS:[-3,36,50,52,55,56],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:52,PATH:"m -111.71866,-76.642798 0.26727,-4.810852 -5.7463,-5.612659 3.34087,-3.073601 -5.07812,-4.409946 -4.00904,1.603616 -1.60362,-4.276312 2.93997,-5.879928 -2.53906,-4.40995 4.67721,-2.13815 1.60362,-5.21176 4.40995,-4.81085 8.41899,0.13363 7.34991,7.34992 -1.870887,8.81989 7.349913,6.280836 3.741772,8.552622 6.414468,3.207234 0.801812,10.289876 -9.621705,1.336347 -10.690783,-6.414466 -3.20723,7.483544 z",LAND:10,FOREST:20,MOUNTAINS:10,CENTER:{x:-107,y:-93},NEIGHBOURS:[35,36,51,53,55],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:53,PATH:"m -82.853553,-141.85656 -4.810852,-2.27179 -0.400902,-7.48355 -4.409948,-3.20723 -10.824415,-0.13364 -4.00904,4.94449 -6.01357,-1.20271 0.53454,-7.88446 -4.94449,0.40091 -9.88897,2.27179 -0.4009,7.21628 -4.67722,5.74629 3.60814,5.34539 7.34991,3.20723 -0.26727,7.88446 2.00452,6.28083 -2.00452,5.7463 4.14268,0.13363 4.40995,-4.81085 8.41899,0.13363 -1.06908,-6.28083 9.88897,-1.87089 2.004523,-4.94448 7.216278,-0.53454 z",LAND:10,FOREST:10,MOUNTAINS:10,CENTER:{x:-111,y:-137},NEIGHBOURS:[-1,35,52,54,55],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:54,PATH:"m -158.08992,-140.25295 -6.94901,-1.60361 -3.20724,-3.34087 -6.68173,-1.06908 -2.00453,-3.87541 -0.26727,-2.27179 2.53907,-5.74629 11.35895,-3.20724 6.5481,4.67722 7.34992,-3.74178 5.34539,3.07361 2.53906,3.74177 6.5481,-4.27631 7.34991,1.46998 -0.4009,7.21628 -4.67722,5.74629 -0.80181,4.81085 -4.14267,0.93545 -7.61719,-0.80181 -4.54358,-4.67722 z",LAND:10,FOREST:10,MOUNTAINS:0,CENTER:{x:-153,y:-150},NEIGHBOURS:[-1,53,55,56],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:55,PATH:"m -124.5476,-97.22255 -6.81537,-1.336349 -8.8199,2.806329 -4.54358,-5.07812 3.74178,-2.67269 -6.28084,-4.54359 -0.53454,-6.949 -8.28535,-2.13816 -4.00904,-5.47903 3.8754,-5.21175 -4.40994,-5.21176 2.53906,-7.21628 8.28535,-2.93996 4.54358,4.67722 7.61719,0.80181 4.14267,-0.93545 0.80181,-4.81085 3.60814,5.34539 7.34991,3.20723 -0.26727,7.88446 2.00452,6.28083 -2.00452,5.7463 4.14268,0.13363 -1.60362,5.21176 -4.67721,2.13815 2.53906,4.40995 z",LAND:10,FOREST:20,MOUNTAINS:0,CENTER:{x:-136,y:-119},NEIGHBOURS:[51,52,53,54,56],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:56,PATH:"m -174.9279,-146.26651 -8.57954,-0.28855 -7.37053,-6.80357 2.64583,-6.04762 -12.47321,0.37798 -7.37054,8.69345 -9.44941,3.40179 -8.12648,7.37053 6.2366,8.12649 8.12649,1.32292 -2.45684,6.61458 -11.52828,2.64583 1.13393,7.37054 -1.88988,10.96131 2.64583,10.016367 4.91369,1.511904 1.88989,10.205357 6.99255,1.511906 -2.07886,3.212798 6.42559,5.669643 17.00893,-0.18899 4.61798,-8.199109 7.75081,-0.801809 -3.4745,-8.018087 9.88897,-3.474503 -7.21627,-6.147197 3.20723,-2.405424 2.67269,2.405424 5.87993,-1.069078 -0.53454,-6.147202 5.87993,-1.33635 3.47451,-3.74177 8.81989,1.46998 -0.53454,-6.949 -8.28535,-2.13816 -4.00904,-5.47903 3.8754,-5.21175 -4.40994,-5.21176 2.53906,-7.21628 -6.94901,-1.60361 -3.20724,-3.34087 z",LAND:10,FOREST:80,MOUNTAINS:40,CENTER:{x:-192,y:-118},NEIGHBOURS:[-1,-3,51,54,55,57,58],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:57,PATH:"m -225.65178,-139.5625 -6.99256,0.94494 -4.15774,-5.29167 1.13393,-5.10267 -4.34673,-7.9375 -8.50446,-0.75596 -10.96131,3.96875 -6.80358,6.04762 3.40179,13.04018 -5.66964,4.7247 -4.53573,10.01637 7.55955,9.6384 9.26041,-1.32292 4.53571,8.69345 7.74851,4.15774 7.74851,-1.32292 5.10268,6.236611 3.2128,3.779761 4.53571,-2.456845 -2.64583,-10.016367 1.88988,-10.96131 -1.13393,-7.37054 11.52828,-2.64583 2.45684,-6.61458 -8.12649,-1.32292 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-248,y:-125},NEIGHBOURS:[-1,56,58,75,76],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:58,PATH:"m -251.73214,-102.89881 -4.15774,4.535716 2.45685,4.913691 -2.26786,7.74851 -4.7247,4.724702 2.26785,6.614583 -4.34672,5.480656 -4.7247,0.755952 0.56697,3.212798 3.21279,2.456847 4.91369,0.566962 -1.32292,4.913691 6.23661,5.480656 6.42559,-4.724705 -4.7247,-7.74851 7.74851,-6.992559 17.76488,0.94494 14.74108,-6.047618 2.07886,-3.212798 -6.99255,-1.511906 -1.88989,-10.205355 -4.91369,-1.511906 -4.53571,2.456847 -8.31548,-10.016374 -7.74851,1.32292 z",LAND:30,FOREST:60,MOUNTAINS:20,CENTER:{x:-241,y:-84},NEIGHBOURS:[-3,56,57,59,75],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:59,PATH:"m -295.86737,-44.035916 0.66797,-5.568251 4.72471,-5.102678 0.37796,-7.181548 7.37055,0.377976 4.5357,-5.858629 0.94496,-6.425597 5.85861,-1.322917 5.66966,-4.346725 7.55951,5.102677 -4.34672,5.480656 -4.7247,0.755954 0.56697,3.212796 3.21279,2.456847 4.91369,0.566962 -1.32292,4.913691 6.23661,5.480656 6.42559,-4.724705 8.31548,1.511906 1.70089,3.96875 -11.15029,3.212799 -4.53572,7.74851 1.51191,7.559524 -7.9375,1.133928 -7.55952,5.291667 -13.98513,-1.322917 -0.86577,-5.963283 9.08716,2.405425 2.40544,-9.087162 -8.55263,-7.216277 -6.68174,-4.276312 z",LAND:10,FOREST:60,MOUNTAINS:0,CENTER:{x:-267,y:-50},NEIGHBOURS:[-3,58,60,61,74,75],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:60,PATH:"m -287.04746,20.376039 -7.77396,-7.614135 3.02382,-10.5833329 -6.23663,-1.1339286 -2.07886,-4.5357142 4.5357,-3.0238094 h 6.42562 l 6.2366,1.3229166 3.49628,-3.9687502 -7.27604,-6.6145833 -1.7009,-6.614583 7.55952,-4.724703 13.98513,1.322917 7.55952,-5.291667 7.9375,-1.133928 3.96875,2.456844 8.31547,-3.77976 h 2.83482 l 2.26786,5.669642 6.23661,6.99256 -3.2128,7.9375 -4.15774,-2.834822 -3.77976,9.4494048 5.66964,8.5044643 -1.18406,11.2484599 -11.75986,5.61266 -9.35443,0.534539 -14.16529,-4.009043 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-262,y:-5},NEIGHBOURS:[-3,46,48,59,61],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:61,PATH:"m -336.22506,9.9525269 1.87089,-6.4144683 -6.14719,-7.216277 2.93994,-9.3544336 6.41448,-6.681738 -5.61266,-9.621702 2.40543,-10.156243 10.15625,-5.078121 10.69078,5.34539 7.21627,-9.087162 10.4235,4.276312 10.42352,-7.216277 6.68174,4.276312 8.55263,7.216277 -2.40544,9.087162 -9.08716,-2.405425 0.86577,5.963283 -7.55952,4.724703 1.7009,6.614583 7.27604,6.6145833 -3.49628,3.9687502 -6.2366,-1.3229166 h -6.42562 l -4.5357,3.0238094 2.07886,4.5357142 6.23663,1.1339286 -3.02382,10.5833329 7.77396,7.614135 -13.63075,10.69078 -8.81989,-4.810851 -6.41448,-9.354433 -12.56167,0.801808 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-313,y:-14},NEIGHBOURS:[46,59,60,62,72,73,74],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:62,PATH:"m -395.36309,71.726189 -0.46307,-6.716139 9.08717,-6.949008 -2.13818,-9.087165 -9.35442,-8.285356 7.48355,-4.00904 8.01809,2.405425 8.28535,-0.534541 2.40543,-6.147196 5.34538,-8.819896 7.48355,-5.61266 7.75081,3.741773 4.27631,-4.276312 2.67271,-9.621703 8.28535,2.1381561 7.75081,7.7508159 12.56167,-0.801808 6.41448,9.354433 -19.24341,3.207235 -6.41448,2.138156 2.67269,8.552625 10.69078,1.336347 1.33636,14.699823 -13.89801,2.405425 -12.82895,-2.672693 -0.53454,10.958049 -15.51744,4.467278 -8.69347,5.291664 z",LAND:40,FOREST:50,MOUNTAINS:50,CENTER:{x:-355,y:44},NEIGHBOURS:[45,46,61,63,70,71,72],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:63,PATH:"m -361.88292,144.65637 -14.95933,1.53113 -10.20535,-6.80357 -6.80358,-11.33929 -19.65476,5.29167 -3.4018,-19.65476 9.44941,-6.4256 4.53573,4.91369 13.60712,-3.02381 2.26788,-10.205354 -9.44941,-15.119048 -11.3393,-4.535715 12.47322,-7.559524 23.43452,4.91369 8.69347,-5.291666 15.51744,-4.467278 -10.4235,12.561668 11.75986,3.207234 -2.40544,13.630746 8.0181,15.768897 8.55263,1.87089 -7.48356,16.30344 -10.4235,1.60362 -3.74179,7.75082 z",LAND:30,FOREST:100,MOUNTAINS:10,CENTER:{x:-370,y:112},NEIGHBOURS:[44,45,62,64,68,69],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:64,PATH:"m -408.65509,185.5486 -2.40543,-5.07812 7.48355,-5.34539 -2.67272,-6.68174 8.81992,-1.06907 3.20722,4.81085 5.34538,-2.6727 -3.20723,-6.41447 -5.07812,-2.13815 0.53454,-6.41447 5.61266,-2.6727 2.67271,-6.68173 1.29501,-5.80698 10.20535,6.80357 14.95933,-1.53113 -5.87994,15.50163 8.28534,7.75082 -4.54358,12.56166 -11.49257,7.75082 2.4054,12.2944 -15.7689,3.74177 -8.5526,-5.61266 -1.33636,-12.02713 z",LAND:10,FOREST:10,MOUNTAINS:40,CENTER:{x:-380,y:174},NEIGHBOURS:[44,63,65,67,68],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:65,PATH:"m -373.10827,200.5157 -15.7689,3.74177 -8.5526,-5.61266 -6.41448,-8.28535 -8.81989,12.56166 -9.6217,6.68174 -0.80182,13.63075 6.68173,10.95805 7.75084,4.54358 1.87087,-6.41447 -4.2763,-4.81085 9.35442,-0.80181 8.01809,4.81085 5.87994,-3.74177 3.74177,9.35443 6.14719,-5.34539 8.01809,-1.06908 12.56165,-5.07812 -8.28534,-6.41447 1.33635,-8.28535 z",LAND:10,FOREST:70,MOUNTAINS:0,CENTER:{x:-392,y:217},NEIGHBOURS:[-1,42,44,64,66,67],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:66,PATH:"m -408.65509,238.73524 -11.75988,4.81085 -2.40541,9.6217 -9.35445,9.35444 2.40543,11.22531 -4.81084,6.68174 -6.68176,2.40543 -11.22532,1.33636 -6.41445,-2.93997 1.33633,-4.54359 7.48356,-0.80182 6.94901,-2.67268 1.06908,-6.1472 -1.8709,-7.48355 -13.09621,1.06908 -6.94899,-4.27631 -5.87994,-14.16529 4.54358,-9.08716 5.07812,-8.55262 7.48356,4.81085 11.75985,0.80181 7.21628,-4.00905 10.69078,-2.93996 6.68173,10.95805 z",LAND:10,FOREST:50,MOUNTAINS:20,CENTER:{x:-444,y:246},NEIGHBOURS:[-1,65,67,90],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:67,PATH:"m -476.80882,228.31173 4.2763,-8.28536 -2.93997,-9.35443 9.35445,-4.00904 v -5.61266 l 4.54358,-8.55263 3.47449,2.6727 -2.13816,6.68174 1.60362,4.00904 9.08717,-4.81085 0.53453,-8.28536 8.81991,-6.949 10.69079,0.8018 6.68173,5.07812 6.41445,-5.61266 7.75084,-0.53454 9.88896,1.06908 1.33636,12.02713 -6.41448,-8.28535 -8.81989,12.56166 -9.6217,6.68174 -0.80182,13.63075 -10.69078,2.93996 -7.21628,4.00905 -11.75985,-0.80181 -7.48356,-4.81085 -5.07812,8.55262 z",LAND:20,FOREST:60,MOUNTAINS:20,CENTER:{x:-443,y:211},NEIGHBOURS:[64,65,66,68,89,90,91],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:68,PATH:"m -449.01281,192.76488 -4.36962,-7.07887 5.48066,-5.48066 -11.52829,-7.55952 -3.77976,-10.39434 16.06399,-4.15774 8.12649,-6.99256 3.40178,-8.88244 -2.45684,-6.99256 6.2366,-6.99256 8.50447,0.37797 -0.18899,-9.07142 -4.72469,-4.91369 5.29167,-1.13393 6.0476,0.18899 3.4018,19.65476 19.65476,-5.29167 6.80358,11.33929 -1.29501,5.80698 -2.67271,6.68173 -5.61266,2.6727 -0.53454,6.41447 5.07812,2.13815 3.20723,6.41447 -5.34538,2.6727 -3.20722,-4.81085 -8.81992,1.06907 2.67272,6.68174 -7.48355,5.34539 2.40543,5.07812 -7.75084,0.53454 -6.41445,5.61266 -6.68173,-5.07812 -10.69079,-0.8018 z",LAND:30,FOREST:50,MOUNTAINS:30,CENTER:{x:-423,y:160},NEIGHBOURS:[63,64,67,69,87,88,89],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:69,PATH:"m -430.78607,119.90506 -6.73414,-7.05377 2.13815,-8.55262 6.41448,-6.949009 -11.22532,-2.672694 -10.15624,5.345393 -1.60364,-7.750818 6.41448,-4.810853 -6.41448,-5.612659 7.2163,-7.483549 10.69078,-2.405425 -4.27633,-4.276312 5.07812,-9.621702 14.16529,4.009043 4.81087,10.423512 6.43144,6.792116 11.3393,4.535715 9.44941,15.119048 -2.26788,10.205354 -13.60712,3.02381 -4.53573,-4.91369 -9.44941,6.4256 -6.0476,-0.18899 -5.29167,1.13393 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-420,y:91},NEIGHBOURS:[63,68,70,87,88],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:70,PATH:"m -407.83631,79.285713 -6.43144,-6.792116 -4.81087,-10.423512 -14.16529,-4.009043 -11.22531,3.474503 -0.53454,-13.096206 8.55263,-7.750818 0.26725,-8.285352 5.34541,-8.285357 -4.54359,-4.810852 15.76891,-0.534539 9.08716,8.819895 10.69078,-5.345391 10.95804,2.405426 6.14722,14.432555 -8.01809,-2.405425 -7.48355,4.00904 9.35442,8.285356 2.13818,9.087165 -9.08717,6.949008 0.46307,6.716139 z",LAND:20,FOREST:60,MOUNTAINS:50,CENTER:{x:-417,y:47},NEIGHBOURS:[62,63,69,71,85,87],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:71,PATH:"m -366.69379,23.583273 -3.72287,-9.876428 -9.82739,-5.1026787 -7.74851,-0.3779764 -1.13393,-6.2366069 0.37799,-6.047619 -6.99257,-0.1889881 -3.40177,4.34672617 -7.74851,-1.88988097 -6.23663,-6.8035713 -4.15774,3.5907736 -5.48063,5.85863105 -10.20538,-4.72470225 -3.21278,-6.4255952 -5.85864,2.6458331 0.37798,6.0476191 6.2366,4.1577381 0.94493,7.3705356 -5.29166,5.1026781 -0.37796,5.858631 -2.45684,6.614585 6.42622,4.900192 5.34541,-8.285357 -4.54359,-4.810852 15.76891,-0.534539 9.08716,8.819895 10.69078,-5.345391 10.95804,2.405426 6.14722,14.432555 8.28535,-0.534541 2.40543,-6.147196 z",LAND:10,FOREST:40,MOUNTAINS:20,CENTER:{x:-405,y:10},NEIGHBOURS:[62,70,72,84,85],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:72,PATH:"m -395.74107,-4.2470241 -2.45684,-6.8035709 4.34673,-4.724703 -3.21281,-6.425595 -7.37052,-2.456845 5.29167,-4.157739 -0.189,-4.157736 4.15775,-2.834823 0.75594,-6.80357 -5.85862,-3.401787 3.77976,-1.511903 3.02379,1.889879 5.48066,-1.133928 2.64583,-4.346726 11.15031,9.638393 6.2366,-1.322917 -1.13393,6.992559 -6.80357,0.755952 -1.32292,3.779763 11.15031,1.511903 3.40178,5.10268 -1.13393,5.858631 7.37053,5.291666 9.07145,-3.023809 9.79868,3.498598 -2.93994,9.3544336 6.14719,7.216277 -1.87089,6.4144683 -8.28535,-2.1381559 -2.67271,9.621703 -4.27631,4.276312 -7.75081,-3.741773 -7.48355,5.61266 -3.72287,-9.876428 -9.82739,-5.1026787 -7.74851,-0.3779766 -1.13393,-6.2366067 0.37799,-6.047619 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-373,y:-5},NEIGHBOURS:[61,62,71,73,83,84],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:73,PATH:"m -337.56142,-13.032652 -9.79868,-3.498598 -9.07145,3.023809 -7.37053,-5.291666 1.13393,-5.858631 -3.40178,-5.10268 -11.15031,-1.511903 1.32292,-3.779763 6.80357,-0.755952 1.13393,-6.992559 -6.42559,-4.346726 7.37052,-7.748513 3.96875,5.669645 9.26042,-1.13393 1.7009,-5.858632 8.88243,-6.992559 7.9375,3.212799 11.3393,-1.889882 6.42559,7.559524 4.72469,6.992559 6.48444,-0.975918 -7.21627,9.087162 -10.69078,-5.34539 -10.15625,5.078121 -2.40543,10.156243 5.61266,9.621702 z",LAND:10,FOREST:60,MOUNTAINS:0,CENTER:{x:-348,y:-39},NEIGHBOURS:[61,72,74,82,83],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:74,PATH:"m -343.20239,-63.21131 -2.10984,-6.883386 3.87541,-3.608139 8.95352,-2.00452 -3.34086,-5.345391 3.8754,-2.138156 5.07812,0.400905 5.21176,-3.34087 2.53908,-4.944486 5.87991,-1.469982 5.47902,-4.944486 3.11206,-1.251249 3.4018,10.583333 -11.3393,5.10268 1.51191,9.449403 9.82739,8.882441 8.50445,-2.267857 2.64583,5.102677 -0.37796,7.181548 -4.72471,5.102678 -0.66797,5.568251 -10.4235,-4.276312 -6.48444,0.975918 -4.72469,-6.992559 -6.42559,-7.559524 -11.3393,1.889882 z",LAND:10,FOREST:60,MOUNTAINS:50,CENTER:{x:-319,y:-67},NEIGHBOURS:[59,61,73,75,77,82],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:75,PATH:"m -273.08781,-119.90774 h -6.99254 l -13.04017,4.15774 -4.53573,-6.04762 -10.01635,3.59078 -2.07889,4.7247 -1.51191,6.80357 5.85865,-2.26786 3.96875,4.15774 -3.21281,6.04762 3.4018,10.583333 -11.3393,5.102678 1.51191,9.449405 9.82739,8.882441 8.50445,-2.267857 2.64583,5.102677 7.37055,0.377976 4.5357,-5.858629 0.94496,-6.425597 5.85861,-1.322917 5.66966,-4.346725 7.55951,5.102677 -2.26785,-6.614583 4.7247,-4.724702 2.26786,-7.748508 -2.45685,-4.913691 4.15774,-4.535718 -4.53571,-8.69345 -9.26041,1.32292 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-282,y:-93},NEIGHBOURS:[57,58,59,74,76,77],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:76,PATH:"m -336.96576,-143.15327 -3.21281,-2.83482 7.37055,-3.40179 v -6.04762 l 4.72469,-5.48065 -3.96875,-6.61459 -7.74851,2.45685 -3.21281,-4.53572 0.56698,-5.85863 3.02382,-6.04762 16.44195,0.37798 9.26041,8.12649 7.37055,-3.59078 7.18154,3.40179 6.80357,9.4494 9.26042,-6.2366 5.29166,4.15774 8.50448,-2.83483 6.23659,-5.48065 6.4256,7.74851 -2.64583,8.31548 -0.18899,4.34672 -6.80358,6.04762 3.40179,13.04018 -5.66964,4.7247 -4.53573,10.01637 h -6.99254 l -13.04017,4.15774 1.88987,-6.80357 -0.56695,-7.9375 -2.26788,-7.9375 -7.37052,3.2128 -9.07143,-1.32292 -7.74851,-5.66964 -6.61458,3.02381 -3.02382,-3.59078 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-300,y:-150},NEIGHBOURS:[-1,57,75,77,78],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:77,PATH:"m -335.82416,-81.052746 -7.18924,-0.301421 -11.33927,0.755954 -5.29167,-6.803572 3.77976,-9.260417 -6.42559,-6.047618 -9.44941,-1.51191 5.85864,-8.69345 12.09522,-2.26785 1.32292,-8.88245 13.22916,-8.31547 2.26788,-10.77232 9.07142,0.37797 3.02382,3.59078 6.61458,-3.02381 7.74851,5.66964 9.07143,1.32292 7.37052,-3.2128 2.26788,7.9375 0.56695,7.9375 -1.88987,6.80357 -4.53573,-6.04762 -10.01635,3.59078 -2.07889,4.7247 -1.51191,6.80357 5.85865,-2.26786 3.96875,4.15774 -3.21281,6.04762 -3.11206,1.251249 -5.47902,4.944488 -5.87991,1.46998 -2.53908,4.944486 -5.21176,3.34087 -5.07812,-0.400905 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-334,y:-112},NEIGHBOURS:[74,75,76,78,81,82],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:78,PATH:"m -343.0134,-169.61161 -4.72469,3.59078 -8.31548,-5.48066 -2.83483,-5.10268 -7.37052,-2.07886 -6.42559,5.29166 -3.77976,-5.48065 -6.23663,8.50446 3.96875,9.63839 6.99257,1.7009 2.83483,6.99256 -4.91369,4.34672 -3.4018,10.01637 -7.18153,3.40179 2.64583,3.96875 6.2366,6.04762 7.9375,-5.85863 5.66965,2.07886 6.80355,-0.56696 2.64584,4.53571 13.22916,-8.31547 2.26788,-10.77232 -3.21281,-2.83482 7.37055,-3.40179 v -6.04762 l 4.72469,-5.48065 -3.96875,-6.61459 -7.74851,2.45685 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-357,y:-147},NEIGHBOURS:[-1,76,77,79,81],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:79,PATH:"m -395.17409,-137.48363 -8.50448,-4.34673 -3.40177,-6.04762 2.83482,-8.88244 -6.42562,-4.7247 0.18899,-9.63839 5.29167,-5.48066 -3.77976,-6.04761 7.18156,-2.64584 5.48066,2.45685 7.37052,-2.64584 6.04761,6.23661 4.72472,-6.04762 7.9375,-3.2128 7.18153,4.34673 4.15774,7.55952 -7.37052,-2.07886 -6.42559,5.29166 -3.77976,-5.48065 -6.23663,8.50446 3.96875,9.63839 6.99257,1.7009 2.83483,6.99256 -4.91369,4.34672 -3.4018,10.01637 -5.29166,-2.83482 -6.04761,-1.32292 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-394,y:-160},NEIGHBOURS:[-1,78,80,81],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:80,PATH:"m -408.97024,-182.65178 -6.42559,-3.77976 0.18899,-4.9137 -3.59076,-7.37053 -10.20538,2.45684 -2.45684,6.04762 -0.75594,9.07143 -9.44941,2.83482 -6.2366,7.18155 -1.7009,6.04762 3.96875,4.91369 -2.64583,8.31547 10.39434,2.26786 -2.64583,5.48066 7.37052,2.07887 5.48066,4.53571 6.99257,-0.18899 4.15774,5.85863 8.69344,-2.26785 8.12649,1.88988 4.53573,-5.29167 -8.50448,-4.34673 -3.40177,-6.04762 2.83482,-8.88244 -6.42562,-4.7247 0.18899,-9.63839 5.29167,-5.48066 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-427,y:-161},NEIGHBOURS:[-1,79,81,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:81,PATH:"m -393.66219,-108.00149 -7.18155,-0.37797 -3.21281,-3.59078 -9.26042,-4.53571 0.94496,-5.66964 -1.88989,-4.72471 6.42559,-7.18154 8.12649,1.88988 4.53573,-5.29167 6.61458,-4.34673 6.04761,1.32292 5.29166,2.83482 -7.18153,3.40179 2.64583,3.96875 6.2366,6.04762 7.9375,-5.85863 5.66965,2.07886 6.80355,-0.56696 2.64584,4.53571 -1.32292,8.88245 -12.09522,2.26785 -9.26041,-4.34672 -3.02382,4.91369 -6.04763,3.96875 z",LAND:10,FOREST:60,MOUNTAINS:40,CENTER:{x:-395,y:-121},NEIGHBOURS:[77,78,79,80,82,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:82,PATH:"m -405.37947,-74.550592 -3.02379,-2.338731 5.33359,-4.84282 -1.64554,-6.324385 -5.19996,-0.290198 3.314,-5.734492 6.70236,-0.880091 1.7009,-6.803571 4.53572,-6.23661 9.44939,-0.37797 6.04763,-3.96875 3.02382,-4.91369 9.26041,4.34672 -5.85864,8.69345 9.44941,1.51191 6.42559,6.047618 -3.77976,9.260417 5.29167,6.803572 11.33927,-0.755954 7.18924,0.301421 3.34086,5.345393 -8.95352,2.004518 -3.87541,3.608139 2.10984,6.883386 -8.88243,6.992559 -1.7009,5.858632 -9.26042,1.13393 1.32292,-7.9375 -6.99254,-6.236607 -2.64583,-7.748514 -3.96875,-5.102677 -6.4256,4.535712 -8.69346,-4.346723 -8.29649,2.953056 z",LAND:30,FOREST:60,MOUNTAINS:50,CENTER:{x:-378,y:-89},NEIGHBOURS:[74,77,81,83,103,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:83,PATH:"m -393.47322,-45.635417 0.18899,-4.913689 -9.63837,-1.322916 -8.50448,-5.291667 0.37799,-6.803572 5.66962,-10.583333 6.63358,1.441152 8.29649,-2.953058 8.69346,4.346725 6.4256,-4.535712 3.96875,5.102677 2.64583,7.748514 6.99254,6.236607 -1.32292,7.9375 -3.96875,-5.669645 -7.37052,7.748513 6.42559,4.346726 -6.2366,1.322917 -11.15031,-9.638393 -2.64583,4.346726 z",LAND:10,FOREST:60,MOUNTAINS:0,CENTER:{x:-388,y:-61},NEIGHBOURS:[72,73,82,84,103],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:84,PATH:"m -411.42708,-57.163689 -4.91368,5.480653 1.32292,4.913691 -4.72472,6.425594 -8.50445,2.078871 -4.72472,6.614583 h -7.9375 l -8.12649,3.779761 -0.37796,-6.047618 -4.34673,-2.267858 -6.2366,10.205357 -0.75597,6.614583 3.4018,6.52009 7.74851,-2.078869 5.00819,-5.197173 7.55952,2.834821 8.59896,-1.984375 3.59076,5.953125 7.55952,8.3154764 4.15774,-3.5907736 6.23663,6.8035713 7.74851,1.88988097 3.40177,-4.34672617 -2.45684,-6.8035709 4.34673,-4.724703 -3.21281,-6.425595 -7.37052,-2.456845 5.29167,-4.157739 -0.189,-4.157736 4.15775,-2.834823 0.75594,-6.80357 -5.85862,-3.401787 3.77976,-1.511903 3.02379,1.889879 0.18899,-4.913689 -9.63837,-1.322916 z",LAND:20,FOREST:40,MOUNTAINS:0,CENTER:{x:-418,y:-28},NEIGHBOURS:[71,72,83,85,102,103],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:85,PATH:"m -480.40774,26.180059 -5.85861,-0.377977 -0.18899,-7.559523 5.57514,-3.212798 1.51191,-7.0870533 3.21278,-6.1421129 9.54392,0.188988 -1.51191,-7.9374999 6.04761,-1.8898809 4.72471,-5.008184 7.74851,-2.078869 5.00819,-5.197173 7.55952,2.834821 8.59896,-1.984375 3.59076,5.953125 7.55952,8.3154764 -5.48063,5.85863105 -10.20538,-4.72470225 -3.21278,-6.4255952 -5.85864,2.6458331 0.37798,6.0476191 6.2366,4.1577381 0.94493,7.3705354 -5.29166,5.1026783 -0.37796,5.858631 -2.45684,6.614585 6.42622,4.900192 -0.26725,8.285352 -5.97001,-5.815009 -7.55951,-2.078869 -9.26042,-2.834822 -8.69344,-0.755952 -9.07143,2.456844 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-457,y:11},NEIGHBOURS:[70,71,84,87,98,99,102],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:86,PATH:"",LAND:0,FOREST:0,MOUNTAINS:0,CENTER:{x:0,y:0},NEIGHBOURS:[],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:87,PATH:"m -450.34914,100.02236 -1.60364,-7.750818 6.41448,-4.810855 -6.41448,-5.612657 7.2163,-7.483549 10.69078,-2.405425 -4.27633,-4.276312 5.07812,-9.621702 -11.22531,3.474503 -0.53454,-13.096206 8.55263,-7.750818 -5.97001,-5.815009 -7.55951,-2.078869 -1.32292,5.102678 1.7009,4.724701 -5.85864,5.480656 -7.9375,-7.9375 -7.37053,2.078869 -3.2128,4.157739 2.64583,4.346725 9.44941,4.157737 0.94493,8.315478 -6.42559,4.535713 -0.18899,5.669642 -1.90236,2.808288 -4.27633,1.870887 -1.46997,3.34087 -3.47451,2.138156 1.33636,8.018084 -3.87543,0.400902 0.13364,6.280838 7.48356,2.138154 3.34086,6.68174 -3.74176,1.87089 -1.47,2.93996 7.08266,-0.13363 2.80633,3.74177 5.74627,-0.93544 5.3454,-0.13364 -2.53907,2.93996 1.47,3.60814 6.94902,-3.60814 6.68173,-0.13363 4.40994,-4.40995 2.13815,-8.55262 6.41448,-6.949009 -11.22532,-2.672694 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-459,y:82},NEIGHBOURS:[69,70,85,88,95,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:88,PATH:"m -437.52021,112.85129 -4.40994,4.40995 -6.68173,0.13363 -6.94902,3.60814 -1.47,-3.60814 2.53907,-2.93996 -5.3454,0.13364 -2.80633,3.74177 -7.34991,3.0736 2.13818,3.0736 -7.34992,4.00904 -7.08265,-3.34087 -2.40541,5.34539 -1.47,8.68626 2.40543,4.14268 2.80633,2.13816 -1.46997,7.75081 6.68173,-7.21627 6.68174,0.53453 5.34538,-9.35443 6.94901,1.87089 9.08717,-0.26727 12.05889,3.44231 -2.45684,-6.99256 6.2366,-6.99256 8.50447,0.37797 -0.18899,-9.07142 -4.72469,-4.91369 -2.53905,5.27857 z",LAND:30,FOREST:30,MOUNTAINS:0,CENTER:{x:-456,y:130},NEIGHBOURS:[68,69,87,89,95],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:89,PATH:"m -466.11804,206.6629 -12.02714,-5.61266 2.40543,-5.87993 -9.6217,-5.34539 -1.8709,-13.89802 3.20723,-9.6217 -7.75081,-6.41447 1.8709,-8.01809 7.48355,1.33635 6.68173,-7.21627 6.68174,0.53453 5.34538,-9.35443 6.94901,1.87089 9.08717,-0.26727 12.05889,3.44231 -3.40178,8.88244 -8.12649,6.99256 -16.06399,4.15774 3.77976,10.39434 11.52829,7.55952 -5.48066,5.48066 4.36962,7.07887 -0.53453,8.28536 -9.08717,4.81085 -1.60362,-4.00904 2.13816,-6.68174 -3.47449,-2.6727 -4.54358,8.55263 z",LAND:10,FOREST:30,MOUNTAINS:40,CENTER:{x:-474,y:170},NEIGHBOURS:[67,68,91,94,95],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:90,PATH:"m -463.97989,256.37503 -7.75081,4.81085 -12.64187,1.22944 -1.7907,-9.24753 -2.6326,-1.87088 -4.75739,0.66817 -3.47451,2.28516 -1.80407,4.07586 -5.5993,4.34313 -10.98477,-4.58367 -0.14701,-8.65954 -3.47448,-9.08716 3.74176,-8.8199 9.35442,-8.01808 9.08717,-3.20724 10.69078,8.01809 h 9.35445 l 11.49257,4.81085 -4.54358,9.08716 z",LAND:20,FOREST:60,MOUNTAINS:20,CENTER:{x:-493,y:237},NEIGHBOURS:[-1,66,67,91],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:91,PATH:"m -519.0374,240.33886 -8.80634,4.50042 -11.71726,-0.18899 -2.07889,-15.30803 2.45687,-8.88244 7.9375,-3.96875 7.9375,-0.94494 5.48063,-6.61459 5.10271,-4.53571 8.69344,0.75595 10.01635,2.83482 9.6384,-2.83482 1.32292,-4.34672 7.31382,-5.63475 -2.40543,5.87993 12.02714,5.61266 -9.35445,4.00904 2.93997,9.35443 -4.2763,8.28536 h -9.35445 l -10.69078,-8.01809 -9.08717,3.20724 -9.35442,8.01808 z",LAND:10,FOREST:50,MOUNTAINS:10,CENTER:{x:-509,y:216},NEIGHBOURS:[-1,67,89,90,92,94],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:92,PATH:"m -539.18302,220.45982 1.43674,-6.84792 -1.06907,-8.28535 -6.68174,1.33635 -10.42352,0.53454 -7.21627,-6.94901 -1.33636,-8.01809 9.6217,-4.27631 8.28535,-7.48355 9.35445,3.20724 8.81989,-5.07812 5.87994,-9.88898 7.75081,3.47451 5.34537,9.6217 2.67272,10.15624 6.41445,7.48355 6.31367,8.53998 -10.01635,-2.83482 -8.69344,-0.75595 -5.10271,4.53571 -5.48063,6.61459 -7.9375,0.94494 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-529,y:196},NEIGHBOURS:[-1,91,93,94],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:93,PATH:"m -517.96833,134.23285 -3.20725,-6.949 -12.02711,-4.00904 -7.75084,3.74177 -3.74176,-7.48355 -8.81989,-2.13816 -5.61266,11.49259 8.01809,8.28536 -0.80182,8.28536 -7.21627,-4.00905 -5.07812,-6.68173 -8.81991,-2.40543 -2.93995,3.74177 2.40541,9.88898 -4.2763,13.0962 5.34538,8.28536 -5.07813,11.49259 -10.15621,3.74177 4.2763,5.34539 6.1472,9.88897 6.68173,-4.27631 7.48356,6.68174 -1.33636,-8.01809 9.6217,-4.27631 8.28535,-7.48355 9.35445,3.20724 8.81989,-5.07812 5.87994,-9.88898 -0.80182,-7.75081 -4.2763,-8.01809 6.14719,-6.949 z",LAND:20,FOREST:60,MOUNTAINS:20,CENTER:{x:-550,y:161},NEIGHBOURS:[-1,92,94,95,96],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:94,PATH:"m -522.51191,168.71062 -0.80182,-7.75081 -4.2763,-8.01809 6.14719,-6.949 3.47451,-11.75987 7.75081,-1.33634 2.13815,8.55262 6.41448,5.07812 1.60361,10.15625 10.15625,-4.81086 -1.8709,8.01809 7.75081,6.41447 -3.20723,9.6217 1.8709,13.89802 9.6217,5.34539 -7.31382,5.63475 -1.32292,4.34672 -9.6384,2.83482 -6.31367,-8.53998 -6.41445,-7.48355 -2.67272,-10.15624 -5.34537,-9.6217 z",LAND:10,FOREST:20,MOUNTAINS:40,CENTER:{x:-504,y:168},NEIGHBOURS:[89,91,92,93,95],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:95,PATH:"m -521.17558,127.28385 3.34819,-4.90885 10.20538,-0.56697 2.83483,-7.9375 -1.70091,-6.2366 6.4256,0.37797 0.56697,2.83483 6.2366,-2.64584 1.32292,-5.85863 8.31548,0.37798 1.88987,7.18154 7.72816,-0.92589 -1.47,2.93996 7.08266,-0.13363 2.80633,3.74177 5.74627,-0.93544 -2.80633,3.74177 -7.34991,3.0736 2.13818,3.0736 -7.34992,4.00904 -7.08265,-3.34087 -2.40541,5.34539 -1.47,8.68626 2.40543,4.14268 2.80633,2.13816 -1.46997,7.75081 -7.48355,-1.33635 -10.15625,4.81086 -1.60361,-10.15625 -6.41448,-5.07812 -2.13815,-8.55262 -7.75081,1.33634 z",LAND:30,FOREST:40,MOUNTAINS:0,CENTER:{x:-495,y:127},NEIGHBOURS:[87,88,89,93,94,96,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:96,PATH:"m -544.69529,119.53303 3.43339,-6.04047 -5.29167,-6.61458 -2.07886,-9.638399 -6.61458,-3.779761 3.59077,-3.401785 4.15774,2.645833 7.55951,-1.322916 h 8.31549 l 6.2366,-4.535715 7.9375,5.291666 3.59076,-3.590774 1.7009,-3.96875 6.99257,3.023809 8.12649,-0.566962 -0.75596,7.181546 5.10267,2.834822 0.75597,5.291666 -1.32292,5.85863 -6.2366,2.64584 -0.56697,-2.83483 -6.4256,-0.37797 1.70091,6.2366 -2.83483,7.9375 -10.20538,0.56697 -3.34819,4.90885 -12.02711,-4.00904 -7.75084,3.74177 z",LAND:20,FOREST:30,MOUNTAINS:10,CENTER:{x:-523,y:107},NEIGHBOURS:[-1,93,95,97,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:97,PATH:"m -539.93899,91.380952 -2.26784,-5.669643 -4.26125,-5.654448 1.71228,-5.871928 -2.26978,-6.225209 -0.18896,-10.919524 8.65927,-2.642033 5.31982,5.061077 3.69081,-2.096149 0.93544,-3.320824 -0.36278,-5.33464 4.5566,-4.339129 7.15497,5.813044 0.37798,8.504465 8.69344,2.83482 7.18156,10.583331 -8.12649,5.480658 -3.02382,6.992557 -1.7009,3.96875 -3.59076,3.590774 -7.9375,-5.291664 -6.2366,4.535715 z",LAND:20,FOREST:20,MOUNTAINS:20,CENTER:{x:-523,y:74},NEIGHBOURS:[-1,96,98],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:98,PATH:"m -512.15774,84.577377 3.02382,-6.992557 8.12649,-5.480656 -7.18156,-10.583333 -8.69344,-2.83482 -0.37798,-8.504465 7.18156,-9.827381 -0.94496,-8.126487 10.39434,-2.078868 12.09524,5.102677 8.12649,-9.071428 3.4018,5.480654 9.07143,-2.456844 8.69344,0.755952 9.26042,2.834822 -1.32292,5.102678 1.7009,4.724701 -5.85864,5.480656 -7.9375,-7.9375 -7.37053,2.078869 -3.2128,4.157739 2.64583,4.346725 9.44941,4.157737 0.94493,8.315478 -6.42559,4.535713 -0.18899,5.669642 -1.90236,2.808288 -4.27633,1.870887 -1.46997,3.34087 -3.47451,2.138156 1.33636,8.018084 -3.87543,0.400902 0.13364,6.280838 7.48356,2.138154 3.34086,6.68174 -3.74176,1.87089 -7.72816,0.92589 -1.88987,-7.18154 -8.31548,-0.37798 -0.75597,-5.291668 -5.10267,-2.83482 0.75596,-7.181546 -8.12649,0.56696 z",LAND:30,FOREST:60,MOUNTAINS:30,CENTER:{x:-488,y:62},NEIGHBOURS:[-1,85,87,95,96,97,99],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:99,PATH:"m -500.62947,30.14881 -3.02379,-4.724703 -9.07142,0.377976 -10.01639,-1.700893 -5.48066,-5.480655 -0.18899,-8.315476 3.59079,-5.6696427 -7.18156,-2.6458333 -6.80357,1.7008928 -0.94493,-6.0476189 7.37052,-4.7247022 3.21281,-8.3154767 7.9375,3.401786 7.37052,-3.023809 12.47323,0.94494 3.40177,6.4255951 13.79615,-4.9136901 3.59076,7.3705355 4.44122,6.9925593 -3.21278,6.1421129 -1.51191,7.0870533 -5.57514,3.212798 0.18899,7.559523 5.85861,0.377977 -8.12649,9.071428 z",LAND:30,FOREST:50,MOUNTAINS:0,CENTER:{x:-507,y:8},NEIGHBOURS:[-1,85,98,100,102],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:100,PATH:"m -497.03868,-59.431546 -8.31548,0.944941 -6.04761,4.724701 -5.1027,-4.157739 -0.94493,-4.913691 -7.37053,1.13393 -7.55954,5.102678 -5.48063,-3.96875 -4.91371,1.700892 v 3.779763 l 4.34673,2.456845 2.26785,5.858631 4.15774,3.401785 5.66966,-0.377976 3.40177,2.645834 -0.18899,2.078868 -3.40178,0.188989 -6.42559,-0.944941 -7.55951,2.456847 -8.1265,-0.377979 -3.77975,6.047621 3.40177,4.535713 5.48066,2.267858 4.5357,1.889881 -0.18897,6.992559 3.96875,3.96875 6.04761,-3.401786 7.9375,3.401786 7.37052,-3.023809 12.47323,0.94494 3.77976,-3.023809 -6.04761,-6.425596 -1.32292,-8.504462 6.04761,-4.346729 1.13393,-7.9375 -2.26785,-6.047618 z",LAND:20,FOREST:50,MOUNTAINS:0,CENTER:{x:-517,y:-32},NEIGHBOURS:[-1,99,101,102],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:101,PATH:"m -478.13989,-71.526785 -4.91368,-2.078869 -2.26785,-4.157739 -5.48066,-3.401785 -8.50447,1.700893 -3.96875,-5.480656 -6.04761,1.700895 -5.66965,-1.700895 -1.88987,-5.102677 -5.10267,-1.511906 -12.09524,3.590774 0.37795,4.535715 5.10271,2.456844 1.70087,5.858631 -3.40177,3.212799 2.45684,4.913691 3.02381,5.291666 7.37053,-1.13393 0.94493,4.913691 5.1027,4.157739 6.04761,-4.724701 8.31548,-0.944941 5.85862,-5.858632 7.37055,-1.133927 z",LAND:20,FOREST:20,MOUNTAINS:0,CENTER:{x:-509,y:-69},NEIGHBOURS:[-1,100,102,104],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:102,PATH:"m -457.35118,-12.845982 -3.4018,-6.52009 0.75597,-6.614583 6.2366,-10.205357 -1.51191,-6.614583 4.91368,-3.212798 0.189,-7.559524 -3.40178,-4.157737 -2.26785,-8.504465 6.2366,-4.157736 -0.18899,-3.968753 -6.04761,0.188989 -5.48066,3.212799 -5.66965,1.133927 -3.40177,-5.669642 -6.23663,0.377975 -1.51191,3.590775 -5.66962,5.10268 -7.37055,1.133927 -5.85862,5.858632 -3.02381,9.071427 2.26785,6.047618 -1.13393,7.9375 -6.04761,4.346729 1.32292,8.504462 6.04761,6.425596 -3.77976,3.023809 3.40177,6.4255951 13.79615,-4.9136901 3.59076,7.3705355 4.44122,6.9925593 9.54392,0.188988 -1.51191,-7.9374999 6.04761,-1.8898809 z",LAND:50,FOREST:60,MOUNTAINS:0,CENTER:{x:-480,y:-37},NEIGHBOURS:[84,85,99,100,101,103,104],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:103,PATH:"m -409.91517,-88.346726 -6.04763,-1.700892 -5.29167,4.346725 -1.32292,5.480656 -5.66962,2.078868 -6.80358,3.401785 -0.56697,5.669645 -3.96875,8.126487 -6.61458,1.322916 -3.21279,-4.157736 -6.42559,-2.456847 2.26785,8.504465 3.40178,4.157737 -0.189,7.559524 -4.91368,3.212798 1.51191,6.614583 4.34673,2.267858 0.37796,6.047618 8.12649,-3.779761 h 7.9375 l 4.72472,-6.614583 8.50445,-2.078871 4.72472,-6.425594 -1.32292,-4.913691 4.91368,-5.480653 0.37799,-6.803572 5.66962,-10.583331 -3.02379,-2.338731 5.3336,-4.84282 -1.64555,-6.324383 z",LAND:10,FOREST:30,MOUNTAINS:0,CENTER:{x:-429,y:-54},NEIGHBOURS:[82,83,84,102,104,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:104,PATH:"m -485.32142,-77.763393 2.07886,-5.480653 6.04763,-1.889882 6.42559,-3.023809 2.07886,-3.779763 4.91371,-4.157737 5.85862,-0.188989 5.66965,-0.755952 6.61458,4.157737 5.29167,3.590774 5.48066,-3.401785 7.18153,1.700893 -0.75594,-5.102678 -2.64584,-3.023809 3.96875,-0.944944 4.5357,2.645837 0.56698,3.77976 6.99257,-0.377975 -0.94496,3.968752 -5.29167,4.346723 -1.32292,5.480656 -5.66962,2.078868 -6.80358,3.401785 -0.56697,5.669645 -3.96875,8.126487 -6.61458,1.322916 -3.21279,-4.157736 -6.42559,-2.456847 6.2366,-4.157736 -0.18899,-3.968753 -6.04761,0.188989 -5.48066,3.212799 -5.66965,1.133927 -3.40177,-5.669642 -6.23663,0.377975 -1.51191,3.590775 -4.91368,-2.078869 z",LAND:20,FOREST:30,MOUNTAINS:30,CENTER:{x:-449,y:-82},NEIGHBOURS:[-1,101,102,103,105],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:105,PATH:"m -452.2485,-97.040178 2.26785,-6.236602 -2.64584,-6.04762 6.04764,-4.34673 0.37796,-4.7247 -4.91369,-7.55953 3.21281,-6.04762 -2.45687,-5.29166 0.94496,-6.23661 8.88244,-0.56696 7.37052,2.07887 5.48066,4.53571 6.99257,-0.18899 4.15774,5.85863 8.69344,-2.26785 -6.42559,7.18154 1.88989,4.72471 -0.94496,5.66964 9.26042,4.53571 3.21281,3.59078 7.18155,0.37797 -4.53572,6.23661 -1.7009,6.803573 -6.70235,0.880089 -3.31401,5.734492 -6.04763,-1.70089 0.94496,-3.96875 -6.99257,0.377973 -0.56698,-3.779758 -4.5357,-2.645839 -3.96875,0.944944 2.64584,3.023809 0.75594,5.10268 -7.18153,-1.700895 -5.48066,3.401785 z",LAND:30,FOREST:60,MOUNTAINS:0,CENTER:{x:-429,y:-115},NEIGHBOURS:[-1,80,81,82,103,104],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:106,PATH:"m -46.680059,119.91815 -5.669642,-7.37053 4.157737,-8.50447 9.449405,-5.858628 -1.889881,-10.77232 2.267857,-12.662204 7.181548,-7.748511 13.418154,-7.181548 0.377976,-9.449403 6.425596,-6.236608 6.8035709,-3.212798 -0.7559524,-7.9375 5.66964288,-3.401785 6.05942052,5.093113 0.6681737,14.03165 3.3408694,3.608139 2.004521,2.939965 -3.7417733,6.414468 -1.0690783,7.349911 -10.9580502,0.935445 -10.2898762,5.746295 -0.133635,15.234359 4.2763123,4.276315 -9.0871633,4.810855 -7.90603,9.12347 -10.016368,1.7009 -0.755952,7.37053 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:-20,y:75},NEIGHBOURS:[6,7,18,22,23,24,25],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:107,PATH:"m -231.98995,36.679481 8.55263,9.621702 1.06908,19.243405 17.35916,-9.795428 17.53764,3.566015 15.30329,-12.724403 3.77976,-9.071427 6.61458,-8.693452 -2.07887,-9.071429 -16.28698,1.423383 -20.31248,-8.552624 -22.98518,8.552624 z",LAND:20,FOREST:50,MOUNTAINS:0,CENTER:{x:-200,y:36},NEIGHBOURS:[29,37,38,46,47,48],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:108,PATH:"m 175.94791,-35.43006 4.49792,-4.781399 9.12813,-5.423958 -3.3073,-6.746875 -6.35,-0.132292 -6.61458,-3.307292 -1.45521,-5.688541 5.95313,-5.291667 -0.66146,-4.630208 -5.15938,-6.35 -1.5875,4.7625 0.66146,3.96875 -3.57187,4.233333 -6.21771,-0.132292 -9.12813,-3.968749 0.66146,-7.672917 -4.63021,-5.688542 -11.64166,-4.365625 -4.49792,2.778125 -10.31875,3.836459 -5.29166,-1.719792 -6.61459,3.2317 -1.88988,11.906247 13.47485,20.883184 17.78378,12.586608 -1.96547,11.320386 14.93005,-5.102678 3.2128,5.291667 15.30804,-5.858632 z",LAND:20,FOREST:60,MOUNTAINS:0,CENTER:{x:150,y:-48},NEIGHBOURS:[-1,16,17,20],WEALTH:0,HARBOUR:!1,TROOPS:[]},{ID:109,PATH:"m -155.34821,133.33631 -3.02381,14.74107 5.09295,10.0761 11.22532,-0.53454 2.93996,5.21176 7.76707,-1.90213 10.01636,-8.12649 16.63096,-3.40178 -1.13393,-8.12649 4.34672,1.13393 2.834826,4.53571 3.96875,2.83482 3.590774,-6.61458 -0.755954,-7.9375 -10.016366,-6.80357 -2.26786,-8.50447 -9.54722,7.96695 -7.27652,2.27925 -4.4037,-4.96972 -0.28353,-14.18749 -10.61059,6.01356 -1.6838,7.64391 -6.21548,5.63935 z",LAND:20,FOREST:30,MOUNTAINS:0,CENTER:{x:-129,y:140},NEIGHBOURS:[24,26,27,28,39],WEALTH:0,HARBOUR:!1,TROOPS:[]}],COUNTRIES:[{COUNTRY:Vv.PLAYER,NAME:"Player nation",DIPLOMACY:0,POTENTIAL:0,COLOUR:"darkgreen",FOCUS:Wv.NONE,REGIONS:[0],CAPITAL:0},{COUNTRY:Vv.NEUTRAL,NAME:"none",DIPLOMACY:0,COLOUR:"gray",FOCUS:Wv.NONE,REGIONS:[1,2,3,4,5,7,13,14,15,16,17,18,22,27,30,31,37,38,39,40,41,42,43,44,45,47,48,49,50,51,53,54,55,56,58,59,63,64,69,73,74,82,83,87,88,93,95,96,97,98,99,100,101,102,103,104,107,108],CAPITAL:-1},{COUNTRY:Vv.CLEADAL,NAME:"Cleadal",DIPLOMACY:0,COLOUR:"darkred",FOCUS:Wv.ECONOMY,REGIONS:[6,23,24,25,26,28,29,106,109],CAPITAL:24},{COUNTRY:Vv.GRIERIA,NAME:"Grieria",DIPLOMACY:0,COLOUR:"#bcaa4f",FOCUS:Wv.PEACE,REGIONS:[8,9,10,11,12],CAPITAL:10},{COUNTRY:Vv.BOTHIL,NAME:"Bothil",DIPLOMACY:0,COLOUR:"#286fbc",FOCUS:Wv.DEFENSE,REGIONS:[19,20,21,32,33,34,35,36,52],CAPITAL:34},{COUNTRY:Vv.DOSHOR,NAME:"Doshor",DIPLOMACY:0,COLOUR:"#a163bc",FOCUS:Wv.OFFENSE,REGIONS:[57,75,76,77,78,79,80,81,105],CAPITAL:80},{COUNTRY:Vv.CREURUS,NAME:"Creurus",DIPLOMACY:0,COLOUR:"#bc6935",FOCUS:Wv.OFFENSE,REGIONS:[65,66,67,68,89,90,91,92,94],CAPITAL:90},{COUNTRY:Vv.ESTRAILA,NAME:"Estraila",DIPLOMACY:0,COLOUR:"#49a37e",FOCUS:Wv.ECONOMY,REGIONS:[46,60,61,62,70,71,72,84,85],CAPITAL:71}],SEA_AREAS:[{ID:-1,CENTER:{x:226,y:203},R:15,NEIGHBOURS:[-2,-46,-55,0,9]},{ID:-2,CENTER:{x:273,y:172},R:15,NEIGHBOURS:[-1,-3,-55,-57,-58]},{ID:-3,CENTER:{x:275,y:110},R:15,NEIGHBOURS:[-2,-4,-58,13]},{ID:-4,CENTER:{x:286,y:66},R:15,NEIGHBOURS:[-3,-5,-58,-59,14,13]},{ID:-5,CENTER:{x:280,y:9},R:15,NEIGHBOURS:[-4,-6,-59,14]},{ID:-6,CENTER:{x:256,y:-49},R:15,NEIGHBOURS:[-5,-7,-59,-60,16]},{ID:-7,CENTER:{x:210,y:-89},R:15,NEIGHBOURS:[-6,-8,-60,16]},{ID:-8,CENTER:{x:149,y:-118},R:15,NEIGHBOURS:[-7,-9,-60,-61,20,108]},{ID:-9,CENTER:{x:94,y:-137},R:15,NEIGHBOURS:[-8,-10,-61,20]},{ID:-10,CENTER:{x:33,y:-161},R:15,NEIGHBOURS:[-9,-11,-61,-62,33]},{ID:-11,CENTER:{x:-17,y:-182},R:15,NEIGHBOURS:[-10,-12,-62,35,34]},{ID:-12,CENTER:{x:-76,y:-176},R:15,NEIGHBOURS:[-11,-13,-62,-63,54,53,35,34]},{ID:-13,CENTER:{x:-131,y:-187},R:15,NEIGHBOURS:[-12,-14,-63,56,54]},{ID:-14,CENTER:{x:-185,y:-189},R:15,NEIGHBOURS:[-13,-15,-63,56,54]},{ID:-15,CENTER:{x:-224,y:-170},R:15,NEIGHBOURS:[-14,-16,57,56,54]},{ID:-16,CENTER:{x:-262,y:-190},R:15,NEIGHBOURS:[-15,-17,-64,76]},{ID:-17,CENTER:{x:-318,y:-196},R:15,NEIGHBOURS:[-16,-18,-64,78,76]},{ID:-18,CENTER:{x:-367,y:-209},R:15,NEIGHBOURS:[-17,-19,-64,79,78]},{ID:-19,CENTER:{x:-417,y:-214},R:15,NEIGHBOURS:[-18,-20,-65,80,79]},{ID:-20,CENTER:{x:-460,y:-202},R:15,NEIGHBOURS:[-19,-21,-65,-66,80]},{ID:-21,CENTER:{x:-469,y:-161},R:15,NEIGHBOURS:[-20,-22,-66,80]},{ID:-22,CENTER:{x:-471,y:-121},R:15,NEIGHBOURS:[-21,-23,104,105,80]},{ID:-23,CENTER:{x:-507,y:-105},R:15,NEIGHBOURS:[-22,-24,-66,104]},{ID:-24,CENTER:{x:-544,y:-102},R:15,NEIGHBOURS:[-23,-25,-66,-67]},{ID:-25,CENTER:{x:-563,y:-63},R:15,NEIGHBOURS:[-24,-26,-67,101]},{ID:-26,CENTER:{x:-570,y:-15},R:15,NEIGHBOURS:[-25,-27,-67,100]},{ID:-27,CENTER:{x:-553,y:20},R:15,NEIGHBOURS:[-26,-28,97,98,99]},{ID:-28,CENTER:{x:-563,y:60},R:15,NEIGHBOURS:[-27,-29,-68,97,98]},{ID:-29,CENTER:{x:-582,y:105},R:15,NEIGHBOURS:[-28,-30,-68,96]},{ID:-30,CENTER:{x:-597,y:154},R:15,NEIGHBOURS:[-29,-31,-69,93,96]},{ID:-31,CENTER:{x:-599,y:204},R:15,NEIGHBOURS:[-30,-32,-69,91]},{ID:-32,CENTER:{x:-570,y:242},R:15,NEIGHBOURS:[-31,-33,-70,91,92]},{ID:-33,CENTER:{x:-527,y:280},R:15,NEIGHBOURS:[-32,-34,-70,66,90,91]},{ID:-34,CENTER:{x:-476,y:294},R:15,NEIGHBOURS:[-33,-35,-71,66,90]},{ID:-35,CENTER:{x:-424,y:296},R:15,NEIGHBOURS:[-34,-36,-71,-72]},{ID:-36,CENTER:{x:-395,y:259},R:15,NEIGHBOURS:[-35,-37,42,65]},{ID:-37,CENTER:{x:-338,y:259},R:15,NEIGHBOURS:[-36,-38,-72,41,42]},{ID:-38,CENTER:{x:-279,y:261},R:15,NEIGHBOURS:[-37,-39,-72,40,41]},{ID:-39,CENTER:{x:-234,y:265},R:15,NEIGHBOURS:[-38,-40,-73]},{ID:-40,CENTER:{x:-174,y:250},R:15,NEIGHBOURS:[-39,-41,-73,27]},{ID:-41,CENTER:{x:-126,y:232},R:15,NEIGHBOURS:[-40,-42,26]},{ID:-42,CENTER:{x:-67,y:224},R:15,NEIGHBOURS:[-41,-43,-74,25,26]},{ID:-43,CENTER:{x:-10,y:223},R:15,NEIGHBOURS:[-42,-44,-74]},{ID:-44,CENTER:{x:48,y:233},R:15,NEIGHBOURS:[-43,-45,-47,2,5]},{ID:-45,CENTER:{x:103,y:229},R:15,NEIGHBOURS:[-44,-46,-47,2,5]},{ID:-46,CENTER:{x:167,y:215},R:15,NEIGHBOURS:[-45,-1]},{ID:-47,CENTER:{x:75,y:280},R:15,NEIGHBOURS:[-44,-45,-48,-74,8]},{ID:-48,CENTER:{x:76,y:338},R:15,NEIGHBOURS:[-47,-49,-74,-75]},{ID:-49,CENTER:{x:124,y:381},R:15,NEIGHBOURS:[-48,-50,-75,10]},{ID:-50,CENTER:{x:192,y:367},R:15,NEIGHBOURS:[-49,-51,-56,-76,11]},{ID:-51,CENTER:{x:250,y:381},R:15,NEIGHBOURS:[-50,-52,-56,-76]},{ID:-52,CENTER:{x:316,y:384},R:15,NEIGHBOURS:[-51,-53,-77]},{ID:-53,CENTER:{x:330,y:331},R:15,NEIGHBOURS:[-52,-54,-78]},{ID:-54,CENTER:{x:287,y:293},R:15,NEIGHBOURS:[-53,-55,-56,-57,12]},{ID:-55,CENTER:{x:243,y:253},R:15,NEIGHBOURS:[-54,-1,-2,-56,-57,9]},{ID:-56,CENTER:{x:237,y:334},R:15,NEIGHBOURS:[-50,-54,-55,-51,11]},{ID:-57,CENTER:{x:350,y:229},R:58,NEIGHBOURS:[-78,-58,-79,-54,-55,-2]},{ID:-58,CENTER:{x:366,y:97},R:58,NEIGHBOURS:[-57,-58,-59,-79,-80,-2,-3,-4]},{ID:-59,CENTER:{x:361,y:-30},R:58,NEIGHBOURS:[-58,-60,-80,-4,-5,-6]},{ID:-60,CENTER:{x:271,y:-144},R:58,NEIGHBOURS:[-59,-61,-81,-6,-7,-8]},{ID:-61,CENTER:{x:147,y:-212},R:58,NEIGHBOURS:[-60,-62,-81,-82,-8,-9,-10]},{ID:-62,CENTER:{x:4,y:-256},R:58,NEIGHBOURS:[-61,-63,-82,-83,-10,-11,-12]},{ID:-63,CENTER:{x:-146,y:-265},R:58,NEIGHBOURS:[-62,-64,-83,-12,-13,-14]},{ID:-64,CENTER:{x:-289,y:-271},R:58,NEIGHBOURS:[-63,-65,-83,-84,-16,-17,-18]},{ID:-65,CENTER:{x:-433,y:-291},R:58,NEIGHBOURS:[-64,-66,-84,-85,-19,-20]},{ID:-66,CENTER:{x:-556,y:-189},R:58,NEIGHBOURS:[-65,-67,-85,-86,-20,-21,-23,-24]},{ID:-67,CENTER:{x:-648,y:-80},R:58,NEIGHBOURS:[-66,-68,-86,-87,-24,-25,-26]},{ID:-68,CENTER:{x:-663,y:58},R:58,NEIGHBOURS:[-67,-69,-87,-28,-29]},{ID:-69,CENTER:{x:-688,y:195},R:58,NEIGHBOURS:[-68,-70,-87,-88,-30,-31]},{ID:-70,CENTER:{x:-609,y:320},R:58,NEIGHBOURS:[-69,-71,-88,-89,-32,-33]},{ID:-71,CENTER:{x:-476,y:370},R:58,NEIGHBOURS:[-70,-72,-89,-90,-35,-34]},{ID:-72,CENTER:{x:-336,y:341},R:58,NEIGHBOURS:[-71,-73,-90,-91,-35,-37,-38]},{ID:-73,CENTER:{x:-185,y:332},R:58,NEIGHBOURS:[-72,-74,-90,-91,-39,-40]},{ID:-74,CENTER:{x:-37,y:307},R:58,NEIGHBOURS:[-73,-75,-91,-42,-43,-47,-48]},{ID:-75,CENTER:{x:52,y:423},R:58,NEIGHBOURS:[-74,-76,-91,-92,-48,-49]},{ID:-76,CENTER:{x:202,y:456},R:58,NEIGHBOURS:[-75,-77,-92,-50,-51]},{ID:-77,CENTER:{x:348,y:455},R:58,NEIGHBOURS:[-76,-78,-92,-93,-94,-52]},{ID:-78,CENTER:{x:421,y:339},R:58,NEIGHBOURS:[-77,-79,-94,-53,-57]},{ID:-79,CENTER:{x:575,y:187},R:120,NEIGHBOURS:[-80,-94,-57,-58,-78,-9999]},{ID:-80,CENTER:{x:552,y:-76},R:120,NEIGHBOURS:[-79,-81,-58,-59]},{ID:-81,CENTER:{x:401,y:-296},R:120,NEIGHBOURS:[-80,-82,-60,-61]},{ID:-82,CENTER:{x:165,y:-412},R:120,NEIGHBOURS:[-81,-83,-61,-62]},{ID:-83,CENTER:{x:-97,y:-460},R:120,NEIGHBOURS:[-82,-84,-62,-63,-64]},{ID:-84,CENTER:{x:-358,y:-479},R:120,NEIGHBOURS:[-83,-85,-64,-65]},{ID:-85,CENTER:{x:-614,y:-397},R:120,NEIGHBOURS:[-84,-86,-65,-66]},{ID:-86,CENTER:{x:-809,y:-216},R:120,NEIGHBOURS:[-85,-87,-66,-67]},{ID:-87,CENTER:{x:-873,y:47},R:120,NEIGHBOURS:[-86,-88,-67,-68,-69]},{ID:-88,CENTER:{x:-863,y:312},R:120,NEIGHBOURS:[-87,-89,-69,-70]},{ID:-89,CENTER:{x:-654,y:515},R:120,NEIGHBOURS:[-88,-90,-70,-71]},{ID:-90,CENTER:{x:-379,y:552},R:120,NEIGHBOURS:[-89,-91,-71,-72,-73]},{ID:-91,CENTER:{x:-111,y:534},R:120,NEIGHBOURS:[-90,-92,-72,-73,-74,-75]},{ID:-92,CENTER:{x:150,y:643},R:120,NEIGHBOURS:[-91,-93,-75,-76,-77]},{ID:-93,CENTER:{x:420,y:654},R:120,NEIGHBOURS:[-92,-94,-77]},{ID:-94,CENTER:{x:598,y:456},R:120,NEIGHBOURS:[-93,-79,-77,-78]},{ID:0,CENTER:{x:203,y:161},R:0,NEIGHBOURS:[-1]},{ID:2,CENTER:{x:112,y:169},R:0,NEIGHBOURS:[-45,-44]},{ID:5,CENTER:{x:31,y:202},R:0,NEIGHBOURS:[-44,-45]},{ID:25,CENTER:{x:-48,y:168},R:0,NEIGHBOURS:[-42]},{ID:26,CENTER:{x:-98,y:201},R:0,NEIGHBOURS:[-41,-42]},{ID:27,CENTER:{x:-156,y:193},R:0,NEIGHBOURS:[-40]},{ID:40,CENTER:{x:-233,y:211},R:0,NEIGHBOURS:[-38]},{ID:41,CENTER:{x:-305,y:238},R:0,NEIGHBOURS:[-38,-37]},{ID:42,CENTER:{x:-350,y:243},R:0,NEIGHBOURS:[-37,-36]},{ID:65,CENTER:{x:-388,y:229},R:0,NEIGHBOURS:[-36]},{ID:66,CENTER:{x:-445,y:260},R:0,NEIGHBOURS:[-34,-33]},{ID:90,CENTER:{x:-489,y:252},R:0,NEIGHBOURS:[-34,-33]},{ID:91,CENTER:{x:-540,y:245},R:0,NEIGHBOURS:[-33,-32,-31]},{ID:92,CENTER:{x:-539,y:206},R:0,NEIGHBOURS:[-32]},{ID:93,CENTER:{x:-574,y:167},R:0,NEIGHBOURS:[-30]},{ID:96,CENTER:{x:-549,y:98},R:0,NEIGHBOURS:[-29,-30]},{ID:97,CENTER:{x:-530,y:48},R:0,NEIGHBOURS:[-28,-27]},{ID:98,CENTER:{x:-511,y:36},R:0,NEIGHBOURS:[-28,-27]},{ID:99,CENTER:{x:-526,y:5},R:0,NEIGHBOURS:[-27]},{ID:100,CENTER:{x:-540,y:-22},R:0,NEIGHBOURS:[-26]},{ID:101,CENTER:{x:-528,y:-76},R:0,NEIGHBOURS:[-25]},{ID:104,CENTER:{x:-472,y:-89},R:0,NEIGHBOURS:[-23,-22]},{ID:105,CENTER:{x:-447,y:-115},R:0,NEIGHBOURS:[-22]},{ID:80,CENTER:{x:-449,y:-171},R:0,NEIGHBOURS:[-21,-20,-19,-22]},{ID:79,CENTER:{x:-396,y:-184},R:0,NEIGHBOURS:[-19,-18]},{ID:78,CENTER:{x:-355,y:-172},R:0,NEIGHBOURS:[-17,-18]},{ID:76,CENTER:{x:-270,y:-169},R:0,NEIGHBOURS:[-16,-17]},{ID:57,CENTER:{x:-232,y:-140},R:0,NEIGHBOURS:[-15]},{ID:56,CENTER:{x:-195,y:-160},R:0,NEIGHBOURS:[-15,-14,-13]},{ID:54,CENTER:{x:-149,y:-161},R:0,NEIGHBOURS:[-15,-14,-13,-12]},{ID:53,CENTER:{x:-112,y:-152},R:0,NEIGHBOURS:[-12]},{ID:35,CENTER:{x:-80,y:-143},R:0,NEIGHBOURS:[-12,-11]},{ID:34,CENTER:{x:-48,y:-146},R:0,NEIGHBOURS:[-12,-11]},{ID:33,CENTER:{x:17,y:-125},R:0,NEIGHBOURS:[-10]},{ID:20,CENTER:{x:86,y:-96},R:0,NEIGHBOURS:[-9,-8]},{ID:108,CENTER:{x:167,y:-66},R:0,NEIGHBOURS:[-8]},{ID:16,CENTER:{x:221,y:-35},R:0,NEIGHBOURS:[-7,-6]},{ID:14,CENTER:{x:256,y:44},R:0,NEIGHBOURS:[-5,-4]},{ID:13,CENTER:{x:222,y:75},R:0,NEIGHBOURS:[-4,-3]},{ID:8,CENTER:{x:115,y:281},R:0,NEIGHBOURS:[-47]},{ID:9,CENTER:{x:203,y:247},R:0,NEIGHBOURS:[-1,-55]},{ID:10,CENTER:{x:128,y:348},R:0,NEIGHBOURS:[-49]},{ID:11,CENTER:{x:209,y:326},R:0,NEIGHBOURS:[-50,-56]},{ID:12,CENTER:{x:287,y:323},R:0,NEIGHBOURS:[-54]},{ID:-9999,CENTER:{x:1204,y:149},R:0,NEIGHBOURS:[-79]}],SEA_EVENTS:{FISH:{FOR_RADIUS:0,NUMBER_INIT:5,SPAWN_CHANCE:.01,SPAWN_DECREASE:5e-4,NUMBER_MIN:1,NUMBER_MAX:15,POWER_MIN:500,POWER_MAX:1e3,TIME_MIN:10,TIME_MAX:0},SHARK:{FOR_RADIUS:0,NUMBER_INIT:4,SPAWN_CHANCE:.005,SPAWN_DECREASE:4e-4,NUMBER_MIN:0,NUMBER_MAX:10,POWER_MIN:250,POWER_MAX:750,TIME_MIN:0,TIME_MAX:0},TREASURE:{FOR_RADIUS:0,NUMBER_INIT:2,SPAWN_CHANCE:.001,SPAWN_DECREASE:3e-4,NUMBER_MIN:1,NUMBER_MAX:3,POWER_MIN:500,POWER_MAX:2e3,TIME_MIN:0,TIME_MAX:0},PIRATES:{FOR_RADIUS:0,NUMBER_INIT:3,SPAWN_CHANCE:.002,SPAWN_DECREASE:2e-4,NUMBER_MIN:1,NUMBER_MAX:7,POWER_MIN:100,POWER_MAX:1e3,TIME_MIN:0,TIME_MAX:0},PIRATES_BASE:{FOR_RADIUS:100,NUMBER_INIT:0,SPAWN_CHANCE:5e-4,SPAWN_DECREASE:4e-4,NUMBER_MIN:0,NUMBER_MAX:1,POWER_MIN:2e3,POWER_MAX:3e3,TIME_MIN:100,TIME_MAX:300},WHIRLPOOL:{FOR_RADIUS:0,NUMBER_INIT:2,SPAWN_CHANCE:.012,SPAWN_DECREASE:.002,NUMBER_MIN:0,NUMBER_MAX:5,POWER_MIN:1,POWER_MAX:1,TIME_MIN:100,TIME_MAX:360},CARTOGRAPHY:{FOR_RADIUS:20,NUMBER_INIT:1,SPAWN_CHANCE:.1,SPAWN_DECREASE:.03,NUMBER_MIN:1,NUMBER_MAX:3,POWER_MIN:50,POWER_MAX:300,TIME_MIN:0,TIME_MAX:0}},REGION_BUILDINGS:{DEFENSES:{REGION_BUILDING:dp.DEFENSES,NAME:"Defenses",DESCRIPTION:"Each defense level decreases attacking unit strength by 1 but only up to half of that unit total strength",COST:[]},ROADS:{REGION_BUILDING:dp.ROADS,NAME:"Roads",DESCRIPTION:"Roads allow troops to travel faster through the region",COST:[{resource:Mv.LOG,amount:20},{resource:Mv.PLANK,amount:10},{resource:Mv.STONE,amount:100},{resource:Mv.CUT_STONE,amount:50}]},WATCHTOWER:{REGION_BUILDING:dp.WATCHTOWER,NAME:"Watchtower",DESCRIPTION:"Watchtower allows to gain insight into enemy neighbour regions troops information",COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:80},{resource:Mv.BRICKS,amount:20}]},GUARD_TOWER:{REGION_BUILDING:dp.GUARD_TOWER,NAME:"Guard tower",DESCRIPTION:"Guard tower adds passive defenses forces that cannot move to another region",COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50},{resource:Mv.BOW,amount:5}]},HARBOUR:{REGION_BUILDING:dp.HARBOUR,NAME:"Harbour",DESCRIPTION:"Harbour allow your ships to station in this region",COST:[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:50},{resource:Mv.COPPER,amount:20}]}}},Tp={getSickness:function(e){var t=Object.entries(this.SICKNESS).find(function(t){return t[0]===zv[e]});if(t)return t[1];console.warn("Invalid sickness: "+Qv.prepareSicknessName(e))},SICKNESS:{COLD:{CHANCE:20,DURATION:20,LETHALITY:20},FLU:{CHANCE:10,DURATION:30,LETHALITY:40},PNEUMONIA:{CHANCE:5,DURATION:60,LETHALITY:70}}},Ip={SMALL_REFUGEE:{EVENT:cp.SMALL_REFUGEE,CHANCE:.0023,MIN_POWER:3,MAX_POWER:7,PREREQUISITES:[],LOG:{MESSAGE:"Small group of refugees came to your village",LOG_TYPE:lp.LOG}},MEDIUM_REFUGEE:{EVENT:cp.MEDIUM_REFUGEE,CHANCE:33e-5,MIN_POWER:10,MAX_POWER:20,PREREQUISITES:[wv.LONGHOUSE],LOG:{MESSAGE:"Medium group of refugees came to your village",LOG_TYPE:lp.LOG}},METEORITE:{EVENT:cp.METEORITE,CHANCE:18e-5,MIN_POWER:100,MAX_POWER:200,PREREQUISITES:[wv.MOUNTAINS],LOG:{MESSAGE:"A meteoroid has fallen somewhere in the mountains",LOG_TYPE:lp.SUCCESS}}},bp=(function(e){e[e.DEV=0]="DEV",e[e.KONGREGATE=1]="KONGREGATE",e[e.VK=2]="VK",e[e.ITCH=3]="ITCH"}(bp||(bp={})),bp),Cp={production:!0,target:bp.ITCH,gameName:"Villager Kings",saveName:"VillagerKingsSave",versionString:"1.3.10",saveVersion:ep.V1_0_0},Ap={name:"New King",building:Pv.ALL,effect:100,duration:90},kp=360,Np=gp,_p=[{text:"Welcome to this quick tutorial that will guide you through basic controls of Villager Kings",position:{width:"250px",top:"180px",left:"275px"}},{text:'To the left you can see navigation menu that will allow you to browse tabs representing different aspects of your village<br><div class="tutorialCenter"><img src="assets/pictures/tutorials/village2.png"></div>',position:{width:"400px",top:"50px",left:"110px"}},{text:"Right now we are in the village tab and using top menu you can navigate between village regions",position:{width:"200px",top:"65px",left:"130px"}},{text:'In the middle of the village region you can see your buildings.<div class="tutorialCenter"><img src="assets/pictures/tutorials/village3.png"></div>There are many different types of buildings in this game. <br> Some of them produce items, others consume them to produce more advanced items. <br>Currently in your village there are only Huts which produce workers for your village.<br>Housing buildings cannot be stopped and require constant supply of food, fuel (in winter) and clothes',position:{width:"600px",top:"220px",left:"200px"}},{text:'Above your buildings you can see most important metrics for current region.<div class="tutorialCenter"><img src="assets/pictures/tutorials/village4.png"></div>For village those are:<br>1. Population of your village/max population<br>2. Free workers that can be assigned to work<br>3. Size of your empty land where you can build<br>4. Size of your whole village (all regions)<br>5. Your people happiness, which will influence their productivity<br>',position:{width:"400px",top:"130px",left:"110px"}},{text:"That's all here for now let's move into the Forest region using top menu and continue the tutorial there<br><img src=\"assets/pictures/tutorials/village1.png\">",position:{width:"400px",top:"180px",left:"200px"}}],wp=[{text:"In the forest you have two working buildings<br>Logger's hut that cuts forest trees and produces logs<br>and Gatherer that collects various resources when wandering in the forest.<br><br>Gatherer has two operating modes<br>Worker working here can either focus on looking for food or useful and sometimes rare resources",position:{width:"400px",top:"240px",left:"200px"}},{text:'There are two icons on both sides of building name.<br>To the left there is details icon. If you hover over it, <br>a tooltip with more technical details regarding a building will popup (not active during tutorial).<div class="tutorialCenter"><img src="assets/pictures/tutorials/forest1.png"></div><br>To the right you can see a cog icon which allows you to stop and start production by hiring or firing worker<div class="tutorialCenter"><img src="assets/pictures/tutorials/forest2.png"></div>',position:{width:"450px",top:"200px",left:"150px"}},{text:"Above buildings you can see 'Build' and 'Demolish' buttons.<br>First one opens a window with all buildings you can build in this region.<br>In future you will discover many more types of building to build.<br>Second one allows you to set buildings to be demolished by free worker<br>You will receive small portion of resources used to build demolished building",position:{width:"450px",top:"100px",left:"50px"}},{text:"Now let's order your people to build more gatherers and continue to the 'Resources' tab in the left menu",position:{width:"250px",top:"180px",left:"275px"}}],Pp=[{text:"Field region has many buildings with different mechanics than other regions.<br>Field, Orchard and Pasture buildings require Farm with workers <br>who will work on planting, sowing, harvesting and tending to animals.<br><br>Fields yearly cycle starts in spring, after you have selected what type of crops should be planted,<br>your Farm workers will start plowing the land and then sowing selected crop.<br>After sowing is completed your crops will start to grow until Autumn.<br>On autumn all crops will stop growing and will be ready for harvest performed by Farm workers.<br>If there are any crops not harvested by the beginning of winter they will wither and will be lost.<br><br>",position:{width:"400px",top:"150px",left:"200px"}},{text:"Orchards are a bit different. Those also need to be plowed and plants need to be planted,<br>after that they keep growing for several years without any work input.<br>Once they matured they will fruit every year with only harvest work required.<br><br>",position:{width:"400px",top:"150px",left:"200px"}},{text:"Pastures allow animals breeding. They require work input for the whole year (chores)<br>and animals require Hay to eat during winter.<br>If no hay is available animals can starve to death.<br> They eat grass and other natural food during other seasons.<br>Some animals produce animals products like eggs and milk which add to your food supplies.<br>All animals can be butchered for meat when butcher building is built.<br>Once animals are researched Hunters can try to tame animals for which there is empty pasture space.",position:{width:"400px",top:"150px",left:"200px"}}],Mp=[{text:"Most mountains buildings require mountains space instead of free land.<br>This mountain area is finite and after the building deplete resources it can be demolished to add empty land instead of back to mountains.<br><br>To gain more mountains areas you will need to run expeditions or conquer enemies (Army).<br><br>After geologist is unlocked and built he will start looking for ores deposits which is very slow process.<br>Once 20 deposits of certain resource has been found Pit Mine can be used to mine it.",position:{width:"400px",top:"150px",left:"200px"}}],Dp=[{text:"In this special area Wonder buildings can be constructed.<br>These require much more resources and much more work to be completed.<br>Each Wonder building adds permanent buff corresponding to it's nature.<br>Wonder building also allows you to abdicate what performs soft reset and additionally award you with Royal Points to spend on Royal perks.<br>Wonder building and it's buff persist through soft resets and abdications.",position:{width:"400px",top:"150px",left:"200px"}}],Lp=[{text:"By the sea fishers can catch fish from the sea.<br>",position:{width:"400px",top:"150px",left:"200px"}}],xp=[{text:"In this tab you can browse all of the resources that you have discovered<br>Next to the resource icon there is current amount that you have and storage limit for that resource.<br><br>Storage can be extended by building warehouses in the village",position:{width:"400px",top:"150px",left:"200px"}},{text:"To the right there are two additional icons present for each resource<br>First one allows you to set amount that will be reserved and no automated action can use them<br>Player initiated action can on the other hand use reserved resources<br>(keep in mind that some actions like for example invasion can still reduce resources below reserved amount!)<br><br>Second icon toggles which resources should be highlighted in the game header",position:{width:"400px",top:"150px",left:"200px"}},{text:"In the header you can highlight resources to know their amounts in any tab of the game",position:{width:"400px",top:"30px",left:"30px"}},{text:"That's all for the basics.<br>To really start progressing you should work towards building Workshop in the village which will open new opportunities<br>",position:{width:"400px",top:"150px",left:"200px"}}],Fp=[{text:"<br>Winter is coming!<br>",position:{width:"400px",top:"150px",left:"200px"}},{text:"During winter things get much harder.<br><br>Your people will need to start heating their houses or they will freeze, get sick and die.<br><br> To stop freezing your people will need a good supply of things to burn.<br>To heat houses villagers can use Fuel, coal, logs or brushwood",position:{width:"400px",top:"150px",left:"200px"}},{text:"It may be a good idea to reserve or entirely block your people from burning some important resources that you need for building or cooking food.",position:{width:"400px",top:"30px",left:"30px"}},{text:"If your people get sick you will need medicine to increase their chance for getting better.<br><br>Pasture animals may also die during winter when you do not have enough hay to feed them.",position:{width:"400px",top:"150px",left:"200px"}}],Up=!0,Hp=!0,Gp=!0,Bp=!1,Wp=!1,Vp=!1,zp=!1,Yp=!1,jp=!1,Kp=!1,Qp=!1,qp=!1,Xp=!1,Zp=!1,$p=!0,Jp=!0,em=!1,tm=500,im=500,nm=100,rm=.05,om=100,sm=3600,am=[{population:0,name:"Village"},{population:2e3,name:"Town"}],um=fp,cm=vp,lm=pp,hm=mp,dm=Sp,gm=Ep,fm=yp,vm=Rp,pm=Op,mm=Tp,Sm=Ip,Em=function e(t,i,n,r,o){p(this,e),this.forestSizeRule=t,this.forestSizeRuleEnabled=i,this.landSizeRule=n,this.landSizeRuleEnabled=r,this.forestSizeReserved=o},ym=(function(e){e[e.SPRING=0]="SPRING",e[e.SUMMER=1]="SUMMER",e[e.AUTUMN=2]="AUTUMN",e[e.WINTER=3]="WINTER"}(ym||(ym={})),ym),Rm=function e(t,i){p(this,e),this.day=t,this.year=i},Om=function(){var e=function(){function e(t){p(this,e),this.servicesService=t,this.optionsSubject=new U,this.options=new Map}return S(e,[{key:"init",value:function(){this.options.set(Xv.AUTO_SAVE_STATUS,Np.AUTO_SAVE_STATUS),this.options.set(Xv.AUTO_SAVE_PERIOD,Np.AUTO_SAVE_PERIOD),this.options.set(Xv.METRIC,Np.METRIC),this.options.set(Xv.SAVE_LOGS,Np.SAVE_LOGS),this.options.set(Xv.PAUSE_ON_INIT,Np.PAUSE_ON_INIT),this.options.set(Xv.KEEP_RESERVATION_SETTINGS_ON_RESET,Np.KEEP_RESERVATION_SETTINGS_ON_RESET),this.options.set(Xv.KEEP_MANAGEMENT_SETTINGS_ON_RESET,Np.KEEP_MANAGEMENT_SETTINGS_ON_RESET),this.options.set(Xv.KEEP_AUTO_TRADE_ON_RESET,Np.KEEP_AUTO_TRADE_ON_RESET),this.options.set(Xv.SOUND_MASTER,Np.SOUND_MASTER),this.options.set(Xv.SOUND_MASTER_VOLUME,Np.SOUND_MASTER_VOLUME),this.options.set(Xv.SOUND_MUSIC,Np.SOUND_MUSIC),this.options.set(Xv.SOUND_MUSIC_VOLUME,Np.SOUND_MUSIC_VOLUME),this.options.set(Xv.SOUND_EFFECTS,Np.SOUND_EFFECTS),this.options.set(Xv.SOUND_EFFECTS_VOLUME,Np.SOUND_EFFECTS_VOLUME),this.options.set(Xv.SOUND_EFFECT_MARKET,Np.SOUND_EFFECT_MARKET),this.options.set(Xv.SOUND_EFFECT_RESEARCH,Np.SOUND_EFFECT_RESEARCH),this.options.set(Xv.SOUND_EFFECT_INVASION,Np.SOUND_EFFECT_INVASION),this.options.set(Xv.SOUND_EFFECT_SEASON,Np.SOUND_EFFECT_SEASON),this.options.set(Xv.VISUAL_PROGRESS_BARS,Np.VISUAL_PROGRESS_BARS),this.options.set(Xv.AUTO_TEXT_FITTING,Np.AUTO_TEXT_FITTING),this.options.set(Xv.PAGED_VIEW,Np.PAGED_VIEW),this.options.set(Xv.BUILDINGS_PER_PAGE,Np.BUILDINGS_PER_PAGE),this.options.set(Xv.POSITIVE_COLOUR,Np.POSITIVE_COLOUR),this.options.set(Xv.NEGATIVE_COLOUR,Np.NEGATIVE_COLOUR),this.options.set(Xv.PLAYER_COLOUR,Np.PLAYER_COLOUR),this.options.set(Xv.AI_DIFFICULTY,Np.AI_DIFFICULTY),this.changePositiveColour(),this.changeNegativeColour(),this.optionsSubject.next()}},{key:"getName",value:function(){return"OptionsService"}},{key:"load",value:function(e){this.options=new Map(JSON.parse(e.options)),this.options.has(Xv.KEEP_RESERVATION_SETTINGS_ON_RESET)||this.options.set(Xv.KEEP_RESERVATION_SETTINGS_ON_RESET,Np.KEEP_RESERVATION_SETTINGS_ON_RESET),this.options.has(Xv.KEEP_MANAGEMENT_SETTINGS_ON_RESET)||this.options.set(Xv.KEEP_MANAGEMENT_SETTINGS_ON_RESET,Np.KEEP_MANAGEMENT_SETTINGS_ON_RESET),this.options.has(Xv.KEEP_AUTO_TRADE_ON_RESET)||this.options.set(Xv.KEEP_AUTO_TRADE_ON_RESET,Np.KEEP_AUTO_TRADE_ON_RESET),this.options.has(Xv.VISUAL_PROGRESS_BARS)||this.options.set(Xv.VISUAL_PROGRESS_BARS,Np.VISUAL_PROGRESS_BARS),this.options.has(Xv.SOUND_MASTER)||this.options.set(Xv.SOUND_MASTER,Np.SOUND_MASTER),this.options.has(Xv.SOUND_MASTER_VOLUME)||this.options.set(Xv.SOUND_MASTER_VOLUME,Np.SOUND_MASTER_VOLUME),this.options.has(Xv.SOUND_MUSIC)||this.options.set(Xv.SOUND_MUSIC,Np.SOUND_MUSIC),this.options.has(Xv.SOUND_MUSIC_VOLUME)||this.options.set(Xv.SOUND_MUSIC_VOLUME,Np.SOUND_MUSIC_VOLUME),this.options.has(Xv.SOUND_EFFECTS)||this.options.set(Xv.SOUND_EFFECTS,Np.SOUND_EFFECTS),this.options.has(Xv.SOUND_EFFECTS_VOLUME)||this.options.set(Xv.SOUND_EFFECTS_VOLUME,Np.SOUND_EFFECTS_VOLUME),this.options.has(Xv.SOUND_EFFECT_MARKET)||this.options.set(Xv.SOUND_EFFECT_MARKET,Np.SOUND_EFFECT_MARKET),this.options.has(Xv.SOUND_EFFECT_RESEARCH)||this.options.set(Xv.SOUND_EFFECT_RESEARCH,Np.SOUND_EFFECT_RESEARCH),this.options.has(Xv.SOUND_EFFECT_INVASION)||this.options.set(Xv.SOUND_EFFECT_INVASION,Np.SOUND_EFFECT_INVASION),this.options.has(Xv.SOUND_EFFECT_SEASON)||this.options.set(Xv.SOUND_EFFECT_SEASON,Np.SOUND_EFFECT_SEASON),this.options.has(Xv.AUTO_TEXT_FITTING)||this.options.set(Xv.AUTO_TEXT_FITTING,Np.AUTO_TEXT_FITTING),this.options.has(Xv.PAGED_VIEW)||this.options.set(Xv.PAGED_VIEW,Np.PAGED_VIEW),this.options.has(Xv.BUILDINGS_PER_PAGE)||this.options.set(Xv.BUILDINGS_PER_PAGE,Np.BUILDINGS_PER_PAGE),this.options.has(Xv.POSITIVE_COLOUR)||this.options.set(Xv.POSITIVE_COLOUR,Np.POSITIVE_COLOUR),this.options.has(Xv.NEGATIVE_COLOUR)||this.options.set(Xv.NEGATIVE_COLOUR,Np.NEGATIVE_COLOUR),this.options.has(Xv.PLAYER_COLOUR)||this.options.set(Xv.PLAYER_COLOUR,Np.PLAYER_COLOUR),this.options.has(Xv.PAUSE_ON_INIT)||this.options.set(Xv.PAUSE_ON_INIT,Np.PAUSE_ON_INIT),this.options.has(Xv.AI_DIFFICULTY)||this.options.set(Xv.AI_DIFFICULTY,Np.AI_DIFFICULTY),this.changePositiveColour(),this.changeNegativeColour(),this.changePlayerColour(),this.optionsSubject.next()}},{key:"save",value:function(){return{options:JSON.stringify(Array.from(this.options.entries()))}}},{key:"reset",value:function(e,t){}},{key:"registerForOptionsChange",value:function(){return this.optionsSubject.asObservable()}},{key:"setOption",value:function(e,t){this.options.set(e,t),this.optionsSubject.next()}},{key:"setOptions",value:function(e){var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.options.set(r.option,r.value)}}catch(o){i.e(o)}finally{i.f()}this.optionsSubject.next()}},{key:"getOption",value:function(e){return this.options.get(e)}},{key:"setPositiveColour",value:function(e){this.options.set(Xv.POSITIVE_COLOUR,e),this.changePositiveColour()}},{key:"setNegativeColour",value:function(e){this.options.set(Xv.NEGATIVE_COLOUR,e),this.changeNegativeColour()}},{key:"setPlayerColour",value:function(e){this.options.set(Xv.PLAYER_COLOUR,e),this.changePlayerColour()}},{key:"changePositiveColour",value:function(){document.getElementById("VillagerKings").style.setProperty("--positive-colour",this.options.get(Xv.POSITIVE_COLOUR))}},{key:"changeNegativeColour",value:function(){document.getElementById("VillagerKings").style.setProperty("--negative-colour",this.options.get(Xv.NEGATIVE_COLOUR))}},{key:"changePlayerColour",value:function(){this.servicesService.getService(Zv.WORLD).setPlayerColour(this.options.get(Xv.PLAYER_COLOUR))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Tm=function(){var e=function(){function e(t,i){var n=this;p(this,e),this.servicesService=t,this.optionsService=i,this.audios=[],this.musicFiles=["assets/sounds/medieval_life.mp3","assets/sounds/medieval_village.mp3"],t.addService(Zv.SOUND,this),this.optionsService.registerForOptionsChange().subscribe(function(){var e=n.optionsService.getOption(Xv.SOUND_MASTER)&&n.optionsService.getOption(Xv.SOUND_MUSIC),t=n.optionsService.getOption(Xv.SOUND_MASTER)&&n.optionsService.getOption(Xv.SOUND_EFFECTS);n.audios.forEach(function(i){i.audio.volume=i.effect?t?n.optionsService.getOption(Xv.SOUND_MASTER_VOLUME)/100*(n.optionsService.getOption(Xv.SOUND_EFFECTS_VOLUME)/100):0:e?n.optionsService.getOption(Xv.SOUND_MASTER_VOLUME)/100*(n.optionsService.getOption(Xv.SOUND_MUSIC_VOLUME)/100):0})})}return S(e,[{key:"playAudio",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.audios=this.audios.filter(function(e){return!e.audio.ended}),e.load();var i=this.optionsService.getOption(Xv.SOUND_MASTER)&&this.optionsService.getOption(Xv.SOUND_MUSIC),n=this.optionsService.getOption(Xv.SOUND_MASTER)&&this.optionsService.getOption(Xv.SOUND_EFFECTS);return e.volume=t?n?this.optionsService.getOption(Xv.SOUND_MASTER_VOLUME)/100*(this.optionsService.getOption(Xv.SOUND_EFFECTS_VOLUME)/100):0:i?this.optionsService.getOption(Xv.SOUND_MASTER_VOLUME)/100*(this.optionsService.getOption(Xv.SOUND_MUSIC_VOLUME)/100):0,e.play(),this.audios.push({audio:e,effect:t}),e}},{key:"playMarket",value:function(){this.optionsService.getOption(Xv.SOUND_EFFECT_MARKET)&&this.playAudio(new Audio("assets/sounds/village_bells.mp3"))}},{key:"playResearch",value:function(){this.optionsService.getOption(Xv.SOUND_EFFECT_RESEARCH)&&this.playAudio(new Audio("assets/sounds/village_bells.mp3"))}},{key:"playBattle",value:function(){this.optionsService.getOption(Xv.SOUND_EFFECT_INVASION)&&this.playAudio(new Audio("assets/sounds/battle.mp3"))}},{key:"playSeason",value:function(e){if(this.optionsService.getOption(Xv.SOUND_EFFECT_SEASON))switch(e){case ym.SPRING:this.playAudio(new Audio("assets/sounds/spring.mp3"));break;case ym.SUMMER:this.playAudio(new Audio("assets/sounds/summer.mp3"));break;case ym.AUTUMN:this.playAudio(new Audio("assets/sounds/autumn.mp3"));break;case ym.WINTER:this.playAudio(new Audio("assets/sounds/winter.mp3"))}}},{key:"playMusic",value:function(){var e=this.servicesService;this.playAudio(new Audio(sp.randomArrayElement(this.musicFiles)),!1).addEventListener("ended",function(){e.getService(Zv.SOUND).checkForMusic()})}},{key:"checkForMusic",value:function(){this.audios=this.audios.filter(function(e){return!e.audio.ended}),this.audios.find(function(e){return!e.effect})||this.playMusic()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Om))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Im=function(){var e=function(){function e(t,i){p(this,e),this.servicesService=t,this.soundService=i,this.daySubject=new U,this.monthSubject=new U,this.yearSubject=new U,this.year=1,this.day=1,this.tickInDay=1,this.season=ym.SPRING,t.addService(Zv.CALENDAR,this)}return S(e,[{key:"getName",value:function(){return"CalendarService"}},{key:"load",value:function(e){this.day=e.day,this.year=e.year,this.season=e.season,this.tickInDay=e.tickInDay}},{key:"save",value:function(){return{day:this.day,year:this.year,season:this.season,tickInDay:this.tickInDay}}},{key:"reset",value:function(e,t){this.day=1,this.tickInDay=1,this.season=ym.SPRING,e?this.year=1:this.year+=1}},{key:"tick",value:function(e){this.tickInDay+=1,11===this.tickInDay&&(this.tickInDay=1,this.day+=1,361===this.day&&(this.day=1,this.year+=1,this.servicesService.getGameService().isEnabled(wv.CALENDAR)&&(this.servicesService.getLogService().success("New Year!"),this.monthSubject.next(Math.floor(this.day/30+1))),this.yearSubject.next(this.year)),this.daySubject.next(this.day),this.day%30==1&&0!==Math.floor(this.day/30)&&this.monthSubject.next(Math.floor(this.day/30+1)));var t=this.season;this.day>=1&&this.day<=90?this.season=ym.SPRING:this.day>90&&this.day<=180?this.season=ym.SUMMER:this.day>180&&this.day<=270?(this.season!==ym.AUTUMN&&(this.servicesService.getResourcesService().checkResourcesBeforeWinter(),this.servicesService.getService(Zv.TUTORIAL).checkWinterTutorial()),this.season=ym.AUTUMN):this.day>270&&this.day<=kp&&(this.season=ym.WINTER),t!==this.season&&this.soundService.playSeason(this.season)}},{key:"getDay",value:function(){return this.day}},{key:"getYear",value:function(){return this.year}},{key:"getSeason",value:function(){return this.season}},{key:"getAbsoluteDay",value:function(){return(this.year-1)*kp+this.day}},{key:"getSeasonForAbsoluteDay",value:function(e){var t=(e-1)%kp+1;return t>=1&&t<=90?ym.SPRING:t>90&&t<=180?ym.SUMMER:t>180&&t<=270?ym.AUTUMN:t>270&&t<=kp?ym.WINTER:void 0}},{key:"registerForDayChange",value:function(){return this.daySubject.asObservable()}},{key:"registerForMonthChange",value:function(){return this.monthSubject.asObservable()}},{key:"registerForYearChange",value:function(){return this.yearSubject.asObservable()}},{key:"getDate",value:function(){return new Rm(this.day,this.year)}},{key:"progressDays",value:function(e){this.day+=10}},{key:"getTickInDay",value:function(){return this.tickInDay}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Tm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),bm=function e(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;p(this,e),this.type=i,this.day=n,this.message=t,this.data=r},Cm=function(){var e=function(){function e(t,i,n){p(this,e),this.servicesService=t,this.calendarService=i,this.optionsService=n,this.entries=[],this.servicesService.addService(Zv.LOG,this),this.logSubject=new U}return S(e,[{key:"customLog",value:function(e,t){this.entries.push(new bm(e,t,this.calendarService.getDay())),this.logSubject.next()}},{key:"log",value:function(e){this.entries.push(new bm(e,lp.LOG,this.calendarService.getDay())),this.logSubject.next()}},{key:"warning",value:function(e){this.entries.push(new bm(e,lp.WARNING,this.calendarService.getDay())),this.logSubject.next()}},{key:"success",value:function(e){this.entries.push(new bm(e,lp.SUCCESS,this.calendarService.getDay())),this.logSubject.next()}},{key:"mystical",value:function(e){this.entries.push(new bm(e,lp.MYSTICAL,this.calendarService.getDay())),this.logSubject.next()}},{key:"fightReport",value:function(e){this.entries.push(new bm(e.message,lp.FIGHT_REPORT,this.calendarService.getDay(),e)),this.logSubject.next()}},{key:"errorReport",value:function(e){this.entries.push(new bm(e.message,lp.ERROR,this.calendarService.getDay(),e)),this.logSubject.next()}},{key:"autoSave",value:function(){if(this.entries.length>0){var e=this.entries[this.entries.length-1];if(e.message&&e.message.includes("Auto saved")){var t=2,i=e.message.replace("Auto saved","").replace(" ","");i.length>0&&(t=Number(i)+1),e.message="Auto saved "+t,this.logSubject.next()}else this.log("Auto saved")}else this.log("Auto saved")}},{key:"registerForLogs",value:function(){return this.logSubject.asObservable()}},{key:"getEntries",value:function(){return this.entries}},{key:"clearEntries",value:function(){this.entries=[],this.logSubject.next()}},{key:"getName",value:function(){return"LogService"}},{key:"load",value:function(e){this.entries=e.logs}},{key:"reset",value:function(e,t){this.entries=e?[]:this.entries.slice(-5).filter(function(e){return e.type===lp.MYSTICAL})}},{key:"save",value:function(){return this.optionsService.getOption(Xv.SAVE_LOGS)?{logs:this.entries.slice(Math.max(0,this.entries.length-100),this.entries.length)}:{logs:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Im),An(Om))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Am=function(){var e=function(){function e(t,i,n){var r=this;p(this,e),this.servicesService=t,this.calendarService=i,this.logService=n,this.buildingEffects=[],this.natureEffects=[],this.armyEffects=[],t.addService(Zv.EFFECTS,this),this.daySubscription=i.registerForDayChange().subscribe(function(e){r.buildingEffects.forEach(function(e){e.duration>0&&(e.duration-=1)}),r.armyEffects.forEach(function(e){e.duration>0&&(e.duration-=1)}),r.natureEffects.forEach(function(e){e.duration>0&&(e.duration-=1)})})}return S(e,[{key:"getName",value:function(){return"EffectsService"}},{key:"load",value:function(e){var t=this;this.buildingEffects=[],e.buildingEffects.forEach(function(e){t.buildingEffects.push(new rp(e.name,e.building,e.effect,e.duration,e.buff))}),this.armyEffects=[],e.armyEffects.forEach(function(e){t.armyEffects.push(new ap(e.name,e.troop,e.effect,e.duration))}),this.natureEffects=[],e.natureEffects.forEach(function(e){t.natureEffects.push(new up(e.name,e.effect,e.duration))})}},{key:"save",value:function(){return{buildingEffects:this.buildingEffects,armyEffects:this.armyEffects,natureEffects:this.natureEffects}}},{key:"reset",value:function(e,t){e?(this.buildingEffects=[],this.armyEffects=[],this.natureEffects=[]):t?(this.buildingEffects=this.buildingEffects.filter(function(e){return e.isRoyal()}),this.armyEffects=this.armyEffects.filter(function(e){return e.isRoyal()}),this.natureEffects=this.natureEffects.filter(function(e){return e.isRoyal()})):(this.buildingEffects=this.buildingEffects.filter(function(e){return e.isRoyal()||e.isWonder()}),this.armyEffects=this.armyEffects.filter(function(e){return e.isRoyal()||e.isWonder()}),this.natureEffects=this.natureEffects.filter(function(e){return e.isRoyal()||e.isWonder()}))}},{key:"tick",value:function(e){this.buildingEffects=this.buildingEffects.filter(function(e){return 0!==e.duration}),this.armyEffects=this.armyEffects.filter(function(e){return 0!==e.duration}),this.natureEffects=this.natureEffects.filter(function(e){return 0!==e.duration})}},{key:"getBuildingEffectsValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=0;return i>0?this.buildingEffects.filter(function(t){return t.building===e||t.building===Pv.ALL}).filter(function(e){return e.isPermanent()===t}).filter(function(e){return!e.isBuff()||e.isBuff()&&e.buff===i}).forEach(function(e){return n+=e.effect}):this.buildingEffects.filter(function(t){return t.building===e||t.building===Pv.ALL}).filter(function(e){return e.isPermanent()===t}).forEach(function(e){return n+=e.effect}),n}},{key:"getBuildingEffects",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return e?t>0?this.buildingEffects.filter(function(t){return t.building===e||t.building===Pv.ALL}).filter(function(e){return e.buff===t}):this.buildingEffects.filter(function(t){return t.building===e||t.building===Pv.ALL}):this.buildingEffects}},{key:"hasWonderEffects",value:function(e){return this.buildingEffects.filter(function(t){return t.name===e}).length>0||this.armyEffects.filter(function(t){return t.name===e}).length>0||this.natureEffects.filter(function(t){return t.name===e}).length>0}},{key:"getNatureEffectsValue",value:function(){var e=0;return this.natureEffects.forEach(function(t){return e+=t.effect}),e}},{key:"getNatureEffects",value:function(){return this.natureEffects}},{key:"addNatureEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.natureEffects.push(e),t){var i=e.name;e.isPermanent()?i+=" will permanently affect ":i+=" will affect ",i+="most natural sources with ",i+=e.effect>0?"+"+e.effect+"%":e.effect+"%",i+=" of their base power",e.isPermanent()||(i+=" for "+e.duration+" days"),this.logService.log(i)}}},{key:"addBuildingEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.buildingEffects.push(e),t){var i=e.name;e.isPermanent()?i+=" will permanently affect ":i+=" will affect ",i+=e.building===Pv.ALL?"all buildings with ":Qv.prepareBuildingName(e.building)+" with ",i+=e.effect>0?"+"+e.effect+"%":e.effect+"%",i+=e.building===Pv.ALL?" of their base power":" of its base power",e.isPermanent()||(i+=e.duration%kp==0?e.duration===kp?" for "+e.duration/kp+" year":" for "+e.duration/kp+" years":" for "+e.duration+" days"),this.logService.log(i)}}},{key:"addArmyEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.armyEffects.push(e),t){var i=e.name;e.isPermanent()?i+=" will permanently affect ":i+=" will affect ",i+=e.troop===Bv.ALL?"all troops with ":Qv.prepareTroopName(e.troop)+" with ",i+=e.effect>0?"+"+e.effect+"%":e.effect+"%",i+=" of their base strength and defense",e.isPermanent()||(i+=" for "+e.duration+" days"),this.logService.log(i)}}},{key:"getArmyEffects",value:function(){return this.armyEffects}},{key:"hasBuildingEffect",value:function(e,t){return void 0!==this.buildingEffects.find(function(i){return i.name===e&&i.building===t})}},{key:"hasArmyEffect",value:function(e,t){return void 0!==this.armyEffects.find(function(i){return i.name===e&&i.troop===t})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Im),An(Cm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),km=[{VERSION:"v1.0.1",MESSAGE:['<ul><li>Fixed barracks not unlocking after being researched</li><li>Fixed weather research description</li><li>Shrine and Church will be available earlier</li><li>"New year!" message will appear on day 1 and only after researching calendar</li><li>Shrine and Church will now log when they become available</li><li>Fixed wrapper boxes sizes</li><li>Pit mine research description changed</li><li>Reduced building button and dropdown font size to prevent overflow</li><li>Aligned building icon and text</li><li>Reduced amount of fur produced by hunter</li><li>Fixed merchant buying items for 0 coins</li><li>Reduced required research points for forestry</li><li>Last tutorial step no longer has "skip tutorial" button</li><li>Available nutrition metric doesn\'t include reserved food</li><li>Researching animals require hay</li><li>Fixed geologist last find description</li></ul>']},{VERSION:"v1.0.2",MESSAGE:["<ul><li>Fixed building line icons alignment</li><li>Refactored dev message window into changelog</li><li>Reduced low happiness severity</li><li>Doubled starting food amount</li><li>Buffed berry and mushroom find chance</li></ul>"]},{VERSION:"v1.0.3",MESSAGE:["<ul><li><b>Famine is now satisfied with 50% less food</b></li><li><b>Refactored happiness so that multiple things combined cannot bring it down to 0</b></li><li>It is now possible to pause the game through settings dropdown menu</li><li>The game is now paused during tutorials</li><li>Reduced brushwood cost of stone tools and bow.</li><li>Buildings are now taking action in random order instead of left to right top to bottom</li><li>Tavern decrease happiness over 75% when no alcohol is available</li><li>Changed Tavern building lines to show amount of alcohols</li><li>Added option to produce fish food for fishers</li><li>Added option to boost school of fish with fish food</li><li>Fixed new school of fish not spawning</li><li>Fixed new sharks not spawning</li><li>Added new Research for Fish Food</li><li>Added tutorials for Field, Mountains, Sea and Plateau regions</li><li>Added close button for royal points modal</li><li>Greatly increased animal taming chance <br>(Taming is supposed to be slow, as this only to be used to kick-start pastures. Another method is to buy animals on the market)</li><li>Fixed animal amount calculation errors resulting in negative, doubled<br> or over the limit amount of animals</li><li>Added notification to market tab if there is no marketplace</li><li>Changed marketplace bribe button text</li></ul>"]},{VERSION:"v1.0.4",MESSAGE:["<ul><li><b>Fixed demolishing huts and houses</b></li><li>Fixed Crafting tab display for Chrome and Edge</li><li>Increased gatherer chance for finding stone and brushwood</li><li>Added several warning for low forest size</li><li>Increased minimal yearly forest growth</li></ul>"]},{VERSION:"v1.0.5",MESSAGE:['<ul><li><b>Fixed wrong army mission being started</b></li><li><b>Fixed Food nutrition value displaying NaN and blocking anything that requires FOOD nutrition as cost</b></li><li>Fixed "Spy" mission not displaying enemy power</li><li>Church will now unlock Religion tab when built</li><li>Urban Planning no longer require house to be researched</li></ul>']},{VERSION:"v1.0.6",MESSAGE:["Bug fixes:<ul><li><b>Fixed King of the People royal perk not allowing to build houses</b></li><li><b>Fixed royal perks not processing unlocked research correctly</b></li><li><b>Fixed research permanent effects not to persist through soft reset and abdication</b></li><li><b>Fixed geologist not finding gold, silver and iron</b></li><li><b>Fixed Tavern not appearing after being researched</b></li><li><b>Fixed fields, orchards and pastures splitting value</b></li><li><b>Fixed 'Blessing' prayer and excluded a lot of buildings that would not benefit from it</b></li><li><b>Fixed changing religion to be player action</b></li></ul>Performance:<ul><li>Improved performance for reloading region<br>It will still take regular time on the first visit but after that I got about 3 times better loading time for region with 36 buildings</li></ul>Other:<ul><li>Improved butcher meat transporting. It no longer requires whole warehouse space to be available at once</li><li>Increased geologist deposits find chances</li><li>Renamed 'Entertainment' research to 'Alcohol'</li><li>Housing buildings show when they are using fuel</li><li>Added research tab warning when no workshop is set to research</li><li>Added button to show finished research projects</li><li>Increased average meat production for hunter lodge</li><li>Improved scrolling in modals</li><li>Urban planning research points requirement greatly reduced</li><li>Improved some prayers descriptions</li><li>Nature effects are now logged when added</li><li>Decreased recruitment times for all troops</li><li>Fishers huts will now work during rain (apparently fish can catch even better during rain due to more oxygen in the water)</li></ul>"]},{VERSION:"v1.0.7",MESSAGE:["Bug fixes:<ul><li><b>Fixed forecast period saving. It will no longer go back to one day after researching weather and reloading game</b></li><li><b>Fixed pastures filling only one butcher. Pasture will now give animal to butcher with shortest queue</b></li><li><b>Fixed demolishing buildings other than housing buildings</b></li><li><b>Fixed work management output to start with maxed output resources</b></li><li><b>Fixed mission not returning troops</b></li><li><b>Fixed possibility to build next wonder without researching</b></li><li><b>Lost wonder effects will be restored on abdication or soft reset</b></li><li><b>Fixed harvesting from field in summer</b></li><li><b>Fixed buying animal filling entire pasture</b></li><li><b>Fixed animals produce filling warehouse when chores went over 50</b></li></ul>Other:<ul><li><b>Changed expedition to take longer and cost more but give more land and kill less troops</b></li><li><b>Improved building filtering and made it persistent</b></li><li><b>Increased game size by about 25%</b></li><li><b>Arrange doesn't require to be researched anymore</b></li><li><b>New option to change visual progress bars to text progress value</b></li><li>Workshops show what is being researched</li><li>Geologist is no longer limited by mountains size</li><li>Slightly improved Royal perks descriptions</li><li>Added special warning for demolishing housing building when there is no enough free space to move all occupants to</li><li>Increased amount of fuel crafted from coal and heating power of coal</li><li>Pit mine now warn that it requires 20 deposits</li><li>Slightly corrected research display</li><li>Changes for Royal Points granting events</li><li>Disabled Ascension temple until it will be fixed</li></ul>Information:<ul><li>Drag and drop arrange seems to work on some computers and not on others. I have tested on a PC and laptop with the same operating system and browser version and it does work on PC and not on laptop.</li></ul>"]},{VERSION:"v1.0.8",MESSAGE:['Bug fixes:<ul><li><b>Fixed workshop display that caused buildings to display in two columns</b></li><li><b>Changes regarding workshop logic that might fix locking issue</b></li><li><b>Fixed "R Quarry" and "R Smithy" prerequisites display</b></li><li><b>Fixed incorrect animals moving when splitting or demolishing pasture</b></li><li><b>Gatherers won\'t lock on warehouse. Locking resource will be removed</b></li><li><b>Fixed field and orchard harvest scale display</b></li><li><b>Fixed bread recipe wheat cost to 2 instead of 1</b></li><li><b>Work management will fire worker after finishing work cycle if rules are not satisfied</b></li><li><b>Fixed and enabled Ascension Temple (requires conditions to be met to become available)</b></li><li><b>Fixed Missions again</b></li><li><b>Fixed some metals recipes not adding after research and smithy built</b></li><li><b>Fixed smithy demolishing</b></li></ul>Other:<ul><li><b>Added tooltips to resources in resource tab.<br>Consumable resources display nutrition<br>Fuel resources display heating power</b></li><li><b>Resources tooltip will now show what building/action used each resource in previous 30 days.</b></li><li>Increased hay consumption of animals by 30%</li><li>Increased apples nutrition value</li><li>Increased apples harvest multiplier</li><li>Increased great lighthouse royal points temporary (to make up for no effects)</li></ul>']},{VERSION:"v1.0.9",MESSAGE:["New features<ul><li><b>Implemented new extended reserver that can define different limit for most of the consumers</b></li></ul>Bug fixes:<ul><li><b>Fixed building Smithy required to research tech allowing to build it</b></li><li><b>Fixed limited buildings allowed to build over the limit</b></li><li><b>Fixed missions finishing without calculating outcome</b></li><li><b>Most probably fixed overscrolling from game to kongregate window</b></li></ul>Other:<ul><li>Doubled iron deposit find chance</li><li>Ore deposits found limited at 50 each</li><li>Troops multiplier now shows multiplied required resources in tooltip. If you cannot afford - troop turns grey</li><li>Slightly increased happiness reduction from half food rations</li><li>Buildings number limit is now added to build window</li><li>Decreased brushwood fuel cost and increased brushwood energy</li></ul>"]},{VERSION:"v1.0.10",MESSAGE:["New features<ul><li><b>Added more production details to buildings in build window</b></li><li><b>Added Manufacture building for specialised crafting</b></li><li><b>Added Specialised production research to unlock manufacture</b></li></ul>Bug fixes:<ul><li><b>Fixed and improved building power modifier display to include permanent effects and correctly use weather multiplier</b></li><li><b>Fixed pastures limits updating to resources tab</b></li><li><b>Fixed wooden tower starting with decreased health</b></li><li><b>Fixed metallurgy to add bronze recipe</b></li><li><b>Fixed orchard harvest calculation when in autumn</b></li><li><b>Fixed bug with New King buff lasting 0 days after reset or abdication</b></li></ul>Other:<ul><li>Changed work management option description (management tab) and added description message after researching Human Resources</li><li>Extended some buildings descriptions</li><li>Increased fur production from hunters</li></ul>"]},{VERSION:"v1.0.11",MESSAGE:["New features<ul><li><b>Forest management improved and moved into management tab</b></li></ul>Bug fixes:<ul><li><b>Fixed some wonders add effects after each reset</b></li><li><b>Fixed Forester not returning land when demolished</b></li></ul>Other:<ul><li>Added option to show only current view tutorial</li><li>Added buttons to hire/fire workers in all currently viewed buildings</li><li>Removed autofill '1' for crafting amount input</li><li>Increased expeditions cost</li><li>Decreased chicken and pigs breeding speed </li><li>Forestry research now requires management to be researched</li><li>Added Stonehenge effect for manufacture</li><li>Changed wonders to reapply missing effects on soft reset or abdication</li><li>Changed some missions times</li><li>Added troops list to mission in progress</li></ul>"]},{VERSION:"v1.0.12",MESSAGE:["New features<ul><li><b>Added new housing building</b></li><li><b>Added crafting cheese from milk (might require new run)</b></li><li><b>Added new army troop</b></li></ul>Bug fixes:<ul><li><b>Fixed huts and houses ignoring fuel items reserved amounts</b></li><li><b>Smithy can no longer be blessed</b></li><li><b>Fixed manufacture producing even when there are no required resources</b></li><li><b>Fixed pastures not producing when there is more than 1000 animals</b></li><li><b>Fixed some imperfections on the background image</b></li><li><b>Fixed orchard resources not available in resources and market before discovered via harvest</b></li></ul>Other:<ul><li><b>Warehouses can be combined and split</b></li><li>Warehouse building size increased (resource storage stays the same)</li><li>Nutrition display has been moved to header (might cause highlighted items to overflow)</li><li>Increased hay required by animals during winter</li><li>Animals now require food for the whole year ( less food required during spring, summer and autumn than in winter )</li><li>Added tooltip to market offers to show more information regarding the offer</li><li>Removed horse cost from expeditions</li><li>Manufacture moved closer in the research tree and has cost decreased</li><li>Mint now requires gold and silver to make coins</li><li>Added nutrition usage to header nutrition tooltip</li><li>Forest low size warnings will now display only when forestry is not researched</li><li>Crafting tab orders will now display how many workshops are crafting particular item</li></ul>"]},{VERSION:"v1.0.13",MESSAGE:["New features<ul><li><b>Added new health resources (no use yet)</b></li><li><b>It's now possible to switch reserved value to be interpreted as reserve % of total limit</b></li><li><b>Added possibility to add second row to header through management menu</b></li><li><b>Added Heritage system that awards points based on population size on reset</b></li></ul>Performance<ul><li><b>Big performance improvement</b></li><li><b>New performance option in settings (give current default performance a try before changing options)</b></li></ul>Bug fixes:<ul><li><b>Fixed wonder construction not benefiting from construction effects</b></li><li><b>Church will employ worker when finished building</b></li></ul>Other:<ul><li><b>Changed arrange drag and drop to click and click</b></li><li>Researching windmill will now make fabric visible and tradeable</li><li>Upgrade arrow will now have green outline</li><li>Farm can now be upgraded to level 2</li><li>Shrine and Church now have diminishing return from population size</li><li>Apples growth time reduced by 25%</li><li>Greatly reduced alcohol consumption rate</li><li>Invasions will now only happen when village reach certain size</li><li>Invasions will now have a recharge period when invasion threat will not grow</li><li>Workers and population can now be added to header</li><li>Nutrition value will show in the header from the start</li></ul>"]},{VERSION:"v1.0.14",MESSAGE:["New features<ul><li><b>Army troops will now require soldiers pay every 30 days.<br>If there is no enough coins to pay soldier has 25% chance to desert</b></li><li><b>Added new buildings filter for all/working/idle buildings</b></li></ul>Bug fixes:<ul><li><b>Fixed iron recipe not added after researching</b></li></ul>Other:<ul><li>Renamed 'Leather' research to 'Tannery' and removed it from tailor prerequisites</li><li>Added warning about low heating resources on start of autumn</li><li>Added herbs to gatherer building description</li><li>Vegetable and meat soups now require herbs</li><li>Increased high (90-100) happiness effect from 35% to 50%</li><li>Prioritized resources have higher chance to appear on market</li><li>Added new royal perk</li><li>Added a window for nature effects in effects management</li><li>Increased workshops building size</li><li>Decreased animals reproduction rate</li><li>Farm upgrade increases farm power</li></ul>"]},{VERSION:"v1.0.15",MESSAGE:["New features<ul><li><b>Added 'Herbalism' research that allows to plant herbs at fields</b></li></ul>Bug fixes:<ul><li><b>Fixed field harvest display and yield calculation</b></li><li><b>Fixed House building awarded with King of the People perk. It now starts with 3 occupants</b></li><li><b>Fixed game freeze when coins were reserved</b></li></ul>Other:<ul><li>Manufacture no longer stops production during storm</li><li>Mint building size increased, power decreased, output coins increased to be worth more than input resources</li><li>Initial housing buildings start equipped with clothes</li><li>Mathematics research will now also buff deconstructions</li><li>Added pause/resume button in the footer</li><li>Added options to change positive and negative colours to user defined</li></ul>"]},{VERSION:"v1.0.16",MESSAGE:["New features<ul><li><b>Added food priority to management</b></li></ul>Performance<ul><li><b>Added settings option that allows to paginate buildings in regions.<br>Number of buildings per page can be also defined in settings</b></li></ul>Bug fixes:<ul><li><b>Fixed king of the people House building having too much population from start (6 instead of 3)</b></li><li><b>Fixed selling animals removing more than it should</b></li><li><b>Fixed pit mine mining only 199 resources</b></li></ul>Other:<ul><li>Pit mine base power reduced</li><li>Workshops now show what resource they are waiting to deposit</li><li>Workshops won't start crafting if there is no space in warehouse or if warehouse will be filled to full by other workshops</li></ul>"]},{VERSION:"v1.0.17",MESSAGE:["New features<ul><li><b>Resources tooltips will now show who produced that item in the last 30 days</b></li></ul>Bug fixes:<ul><li><b>Fixed mountains tab deposits causing scroll bar to go below the screen</b></li><li><b>Tooltips should no longer go under the screen</b></li><li><b>Probably fixed tavern bug</b></li><li><b>Fixed army payday countdown stuck and invasions being tied to this countdown</b></li><li><b>Fixed day being 11 ticks instead of 10</b></li><li><b>Fixed golden items not resetting correctly</b></li></ul>Other:<ul><li>Changed 'Royal prophecy' 3rd perk to grant 'Bow' and 'Hunting' research instead of 'Mortar'</li><li>Added display of what golden items have been found during current run</li><li>Farms will now work on pastures during rain</li><li>Pastures details now show how much meat current animals will yield</li><li>Alcohol unlocks beer and wine resources</li><li>Windmill power and flour amount doubled, flour recipe cost reduced</li><li>Longhouse require hay instead of fabric (for roof), House require brushwood (also for roof)</li><li>Limited tavern to 1 (having more might be bad if they lack alcohol as negative/positive effects would be applied multiple times)</li></ul>"]},{VERSION:"v1.0.18",MESSAGE:["Bug fixes:<ul><li><b>Fixed huts not arranging correctly</b></li><li><b>Fixed importing showing researches blocked and as done</b></li><li><b>Fixed temperature in weather tab not showing in fahrenheit</b></li><li><b>Fixed workshop waiting for warehouse text breaking buildings order</b></li></ul>Other:<ul><li>Added description to finished research projects describing what has been learned</li></ul>"]},{VERSION:"v1.0.19",MESSAGE:["New features<ul><li><b>Added cooked fish. Researching 'cooking' required to get recipe</b></li><li><b>Added sheep and wool. Wool can be used to craft fabric</b></li></ul>Bug fixes:<ul></ul>Other:<ul><li><b>Reservation settings carry over soft resets/abdications but are deactivated. Added settings option to carry over activated reservations.</b></li><li><b>Management menu options carry over soft resets/abdications if settings option is enabled. Some options require research to become available so until they are researched default values will be used.</b></li><li>Mushrooms can now be planted on farms</li><li>Increased shrine building power</li><li>Increased single buildings buffs power from 5% to 10%. Added more buff information to buff tooltip</li><li>Added agriculture as prerequisite for alcohol</li><li>Unlocking shrine or church will log in green</li><li>Leather recipe no longer available from start</li><li>Removed 'waiting for trees' from loggers hut if forest is available</li><li>Added management option to display research progress in the header</li><li>Quarry and pit mine will log when resources finished</li><li>Increased bigger housing buildings food and fuel storage. Changed their cost to that value.</li></ul>"]},{VERSION:"v1.0.20",MESSAGE:["Bug fixes:<ul><li><b>Produced/used by data will no longer persist through resets</b></li></ul>Other:<ul><li>Added pasture description to hint where to find first animals</li><li>Added management option to display faith in the header</li><li>Added new royal perk to increase initial crafting queue size</li><li>Increased 'Motivation Speech' perk to last 5 years instead of just 1 year</li><li>Soft reset and abdication now shows how many people are needed for the next heritage point</li><li>Chores cap now scale with pasture size</li><li>Hay nutrition for animals reduced from 25 to 10</li><li>'Auto save' messages will now combine into one with number of total saves</li><li>Added log message when worker is removed from the building. This can be disabled in management</li><li>Used up building (quarry, pit mine) will now have greyed out background</li><li>Greatly increased fruiting rate for all orchard crops. Orchards can now fruit also in summer</li></ul>"]},{VERSION:"v1.1.0",MESSAGE:["New Features:<ul><li><b>Introduced world map tab with new mechanics and reworked army missions</b></li><li><b>New buildings: Embassy, Paper mill, Deep mine</b></li><li><b>A few new researches</b></li><li><b>Added average daily nutrition production display to nutrition tooltip</b></li></ul>Bug fixes:<ul><li>Lack of alcohol now reduces happiness again down to 75%</li><li>Added better verification to auto save period input</li><li>Fixed stuck payday counter when no pay is due</li></ul>Other:<ul><li><b>New level of 'Family jewels' that add coins to starting resources</b></li><li>'Motivation speech' duration increased to 100 years</li><li>Reduced alcohol consumption and happiness increase/decrease</li><li>Used up buildings (quarry, pit mine) will not require demolish confirmation anymore</li><li>Wiki link added to footer</li><li>Pit mine base power decreased</li></ul>"]},{VERSION:"v1.1.1",MESSAGE:["Bug fixes:<ul><li><b>Fixed deep mine not working after upgrade</b></li><li><b>Underground City will now also buff deep mine</b></li><li><b>Player plunder and conquer no longer will fight player region when conquered</b></li><li><b>Fixed issue with region selection moving map instead</b></li></ul>Other:<ul><li><b>Increased cost for AI colonization (so that it happens less frequently)</b></li><li><b>Increased cost for AI troops</b></li><li>Deep mine will take longer to find new ores and longer to upgrade</li><li>Royal perks split into permanent and one time use groups</li><li>When demolishing housing buildings villagers will take their share of food, fuel and clothes to the new building</li><li>There are reports about golden apples in the orchards!</li><li>Removed stone from colonization cost</li></ul>"]},{VERSION:"v1.1.2",MESSAGE:["New Features:<ul><li><b>Auto trade options in resource settings window</b></li></ul>Bug fixes:<ul><li><b>Fixed pasture chores to use farm power bonus</b></li><li><b>Fixed player regions being attacked even with friendly standing</b></li></ul>Other:<ul><li>Reduced troops training time</li><li>Reduced AI attacks chance</li><li>Removed fabric from paper mill cost</li><li>Pit mine require only 20 mountains again</li><li>Added confirm window when trying to buy resource over the limit</li></ul>"]},{VERSION:"v1.1.3",MESSAGE:["New Features:<ul><li><b>Work management has now a season rule</b></li><li><b>Work management can be set to craft always to max</b></li><li><b>Work management for training square added</b></li><li><b>Work management can be set to all buildings of the same type</b></li><li><b>Work management for farm added</b></li></ul>Bug fixes:<ul><li><b>Added Paper mill to resource settings</b></li><li><b>Fixed spy mission</b></li><li><b>'Move' mission troops will return if target region has been conquered</b></li></ul>Other:<ul><li><b>Reduced AI income</b></li><li>Reduced number of AI starting regions</li><li>Changed shrine cost to raw resources</li><li>Deep mine ore finding rate per ore increase with each building level</li><li>Added logs when player region is conquered</li></ul>"]},{VERSION:"v1.1.4",MESSAGE:["New Features:<ul><li><b>Added fight reports</b></li></ul>Other:<ul><li>Diplomacy will be decreased much more after hostile actions towards friendly kingdoms</li><li>AI regions will start with 2 archers to slow down early rush</li><li>Added settings option that will pause the game on page open/refresh</li></ul>"]},{VERSION:"v1.1.5",MESSAGE:["Bug fixes:<ul><li><b>Added missing fight reports on won defense</b></li><li><b>Fixed missing path connection from one of the regions</b></li><li><b>Fixed farm work management not saving</b></li><li><b>Added scroll bar to general management tab to prevent food priority hiding</b></li><li><b>Fixed player kingdom name changing</b></li><li><b>Loot message will combine the same resources</b></li><li><b>'Pickaxe design' will now add bonus to deep mine</b></li></ul>Other:<ul><li>Max colonists set to 20 (as there is no point in sending more)</li><li>Reduced hay yield multiplier from 2 to 1.5</li><li>Reduced the cost of 'specialised production' research</li><li>Increased pit mine base power</li><li>Reduced wine fermenting time from 1 year to 30 days</li><li>Recruits can be 'drag and drop' arranged</li><li>Soft reset/abdication message will now say on what year current run has started</li></ul>"]},{VERSION:"v1.1.6",MESSAGE:["New Features:<ul><li><b>Added research crafting queue</b></li><li><b>Added Buildings auto-sort.<br>Order of buildings will be the same as the order of appearance.</b></li></ul>Bug fixes:<ul><li><b>Chrome map bugs should be fixed now</b></li><li><b>Fixed building confirmation (triggered by button) to work incorrectly when confirmed with enter</b></li></ul>Other:<ul><li>Village region will be now remembered and redirected on reentry</li><li>Added management switch to change default workshop mode</li><li>Added management switch to prevent hunters stop taming</li></ul>"]},{VERSION:"v1.1.7",MESSAGE:["New Features:<ul><li><b>Added percentage auto trade</b></li></ul>Bug fixes:<ul><li><b>Fixed research progress resetting on load. Might not work for research already in the queue (finish or cancel and add again)</b></li></ul>Other:<ul><li>Added queue size display to research tab</li><li>Added pause 'p' and world map 'm' hotkeys</li><li>Improved pasture, field and orchard splitting and combining</li><li>Added management option to allow summer plowing</li><li>Added focus on input to some popup windows</li><li>Added settings option to keep auto trade on after reset</li><li>Added management option to disable auto trade logs</li><li>Changed skirmish win chance calculation</li><li>Added army bonus to each skirmish if army is at least twice the size of the enemy army</li><li>Reduce attack/defense of troop that won skirmish by 1 (tiredness)</li></ul>"]},{VERSION:"v1.1.8",MESSAGE:["Bug fixes:<ul><li><b>Fixed winter happiness from clothes not being applied</b></li></ul>Other:<ul><li>Soft reset renamed to abdication</li><li>World map regions ownership won't reset on abdications unless ordered to</li><li>Added map switch to show capitals, armies and spies</li></ul>"]},{VERSION:"v1.1.9",MESSAGE:["New Features:<ul><li><b>Added Gatherers camp (upgrades will come in future patches)</b></li><li><b>Added sickness mechanic. Freezing villagers will get sick.<br>Each sickness has a chance that sick villager will die.<br>Sick villagers cannot work<br>Herbal medicine reduces sickness time (and indirectly lethality)</b></li><li><b>Added research unlocking with Heritage Points</b></li></ul>Bug fixes:<ul><li><b>Fixed research queue entry canceling when selecting 'no' in confirmation window</b></li><li><b>Fixed header size when importing save with 2-line header on 1-line header state</b></li><li><b>Added Gatherers camp (upgrades will come in future patches)</b></li></ul>Other:<ul><li>Added heating efficiency descriptions to house building</li><li>Auto sort should now also consider manufacture recipe while sorting</li><li>Added log message when faith is full</li><li>Added header entries that list all resources of each category</li><li>Slightly changed buildings sizes</li></ul>"]},{VERSION:"v1.1.10",MESSAGE:["Bug fixes:<ul><li><b>Added Gatherers camp effect from sacred grove</b></li><li><b>Removed 'reset heritage' from abdication</b></li><li><b>Fixed auto sort buildings disappearing when sorting with manufacture without recipe</b></li><li><b>Gatherers camp local storage cleared when mode is changed</b></li><li><b>Fixed colonizing player owned regions would gain extra land</b></li><li><b>Fixed tavern not applying negative alcohol happiness when disabled</b></li><li><b>Fixed research unlocking blocked by buildings prerequisites even if those are fulfilled</b></li></ul>Other:<ul><li>Moved food priority section of management tab higher</li><li>Doubled amount of alcohol added to tavern (1 beer adds 2 beer in tavern, same for wine)</li><li>Increased amount of hay consumed by animals during winter by 50%</li></ul>"]},{VERSION:"v1.1.11",MESSAGE:["New Features:<ul><li><b>Added cloud(server) saving to settings window. Can only be triggered manually during testing period</b></li></ul>Bug fixes:<ul><li><b>QUICKFIX: fixed critical population related bug that could cause game being stuck in infinite loop</b></li><li><b>Fixed research spending HPs when prerequisites are not met</b></li><li><b>More fixes to auto sort function (for manufactures)</b></li></ul>Other:<ul><li>Loot will be sorted alphabetically</li></ul>"]},{VERSION:"v1.1.12",MESSAGE:["New Features:<ul><li><b>Added AI difficulty settings to options menu</b></li></ul>Bug fixes:<ul><li><b>QUICKFIX: Fixed report of defeated units showing for enemy colonisation</b></li><li><b>Fixed AI bug that caused AI daily code to be executed multiple times a day after abdication</b></li><li><b>Fixed server related popups</b></li><li><b>Fixed move army mission not to return from neutral regions</b></li><li><b>Fixed land, forest and mountains not being reset correctly on abdication</b></li><li><b>Fixed gatherers camps, their local storage can now store 1 of each item they can find in current mode.<br>Workers assigned here will work until local storage has all of the resources they can find</b></li></ul>Other:<ul><li>Slightly changed Troops stats</li><li>Militia can no longer be used to attack enemy</li><li>Reduced Spy troop gold cost</li><li>Work management buildings will start with output resources 'full' enabled</li><li>Reduced troops training time</li><li>Removed 50% progress start from gatherer when no resource is found</li></ul>"]},{VERSION:"v1.1.13",MESSAGE:["New Features:<ul><li><b>Added option to build multiple buildings at once</b></li></ul>Bug fixes:<ul><li><b>King of kingdom that has been conquered will no longer die</b></li><li><b>Fixed army effects not applying correctly to troops</b></li><li><b>Pasture will now add 'produced by' and 'used by' data to resources</b></li><li><b>Fixed some of the world map army sending bugs</b></li></ul>Other:<ul><li>World map display option will now be saved</li><li>Changed troops skirmish win calculation to linear function to benefit from army effects</li><li>Changed pig icon to one that looks more like a pig</li><li>Added new vegetable soup recipe that takes 1 berry and 1 mushroom (abdication required to enable)</li><li>Deep mine can now also mine stone</li></ul>"]},{VERSION:"v1.1.14",MESSAGE:["New Features:<ul><li><b>Added 'Royal Archives' royal perk</b></li><li><b>Added 'Barn' building for specialised storage of some crops<br>and a research project to unlock it</b></li><li><b>Added 'Golden fleece'</b></li><li><b>Tools can now be crafted also from copper, bronze and iron</b></li></ul>Other:<ul><li>'Stone' removed from tools names</li><li>Improved crafting recipe naming for some recipes</li></ul>"]},{VERSION:"v1.1.15",MESSAGE:["New Features:<ul><li><b>Added background music and new settings to control sound volume</b></li><li><b>Added different sound effect for invasion</b></li></ul>Bug fixes:<ul><li><b>Fixed one of the regions not being connected to the other one (Creurus land)</b></li></ul>Other:<ul><li>Each sound effect can be enabled/disabled in settings</li></ul>"]},{VERSION:"v1.1.16",MESSAGE:["New Features:<ul><li><b>Added Kitchen building and separate cooking order list in Crafting menu</b></li><li><b>Added Clay pit building</b></li><li><b>Added Tudor House building</b></li><li><b>Added clay, pottery and bricks resources</b></li></ul>Bug fixes:<ul><li><b>Research projects unlocked by royal perks will now correctly show as finished</b></li><li><b>Fixed adding research to queue over queue size</b></li></ul>Other:<ul><li>Reduced brushwood fuel crafting difficulty</li><li>Added Herbs and Berries to Barn storage options</li><li>Increased amount of alcohol added to tavern by 25%</li><li>Winery and Brewery now require pottery to build</li><li>Heating fuel used by housing building will now be affected by building size and heating efficiency</li><li>Bakery now needs to be researched separately after researching cooking</li><li>Increased food rations can now increase happiness more than regular rations <br>(1.5 rations up to 30 happiness and double rations up to 40 happiness)</li></ul>"]},{VERSION:"v1.1.17",MESSAGE:["Bug fixes:<ul><li><b>Digging will now unlock field region</b></li></ul>Other:<ul><li>Changed heritage points calculation to make it harder to acquire the more HPs player has</li><li>Abdicating through top right menu will now add RPs for wonder buildings</li><li>Pasture can breed animals into another pasture of the same type with free space for animals</li><li>Iron prospecting and processing technologies have been moved higher in the tech tree</li><li>Butchers will now acquire fur from animals</li><li>Planks can no longer be burned to heat houses</li><li>Added first winter tutorial</li><li>Improved village and forest tutorials</li></ul>"]},{VERSION:"v1.1.18",MESSAGE:["New Features:<ul><li><b>Added new food recipes: omelette and pie</b></li><li><b>Added new research for cooking recipes</b></li><li><b>Housing buildings can be disabled when there is no occupants inside</b></li></ul>Bug fixes:<ul><li><b>Fixed animals transforming to another animals when switching pasture type</b></li></ul>Other:<ul><li>Changed heritage points algorithm to allows for partial progress carry over</li><li>Decreased heritage points acquiring difficulty</li><li>Decreased land amount from heritage</li><li>Deep mine require ore deposits to recharge</li><li>Kitchen is now faster</li><li>Added resources list filter for empty and non active resources</li></ul>"]},{VERSION:"v1.1.19",MESSAGE:["New Features:<ul><li><b>Added troops speed stat that influence travel speed</b></li><li><b>It's now possible to cancel move, plunder and conquer missions before they reach their target</b></li><li><b>New troop: Horse archer</b></li></ul>Bug fixes:<ul><li><b>Ascension is no longer possible through abdication menu</b></li><li><b>Fixed heritage points xp calculation</b></li></ul>Other:<ul><li>Unite with the people now shows how much times it has been acquired</li><li>Added 'clear all' and 'select all' buttons to troops selection in mission window</li><li>AI will not attack player troops in neutral regions if diplomacy standing allows to</li><li>AI won't send militia to attack</li><li>AI returning army will try to conquer it's origin region if it has been conquered while army was on mission</li><li>AI capitals will keep being displayed after conquered <br>(this can prevent capitals from displaying at all before reset/abdication)</li><li>AI will try to reclaim their capital with high priority</li><li>AI and player missions can now evaluate paths to find shorter path during mission</li><li>AI and player missions will need to fight enemy if passing through enemy region</li></ul>"]},{VERSION:"v1.1.20",MESSAGE:["New Features:<ul><li><b>Housing buildings can be upgraded to the next tier building once it is unlocked</b></li></ul>Bug fixes:<ul><li><b>Added missing resource reservation entry for 'Tudor house' and moved kitchen reservation <br>to separate entry instead of included in crafting</b></li><li><b>Fixed headers entry text in effects management</b></li><li><b>Fixed strength calculation not including defender \"defense\" stat for first attacker troop</b></li><li><b>Fixed defense building mission from freezing the game</b></li></ul>Other:<ul><li>Doubled production output of brewery and winery</li><li>Reduced coins value of beer and wine</li></ul>"]},{VERSION:"v1.1.21",MESSAGE:["New Features:<ul><li><b>Added loggers camps building</b></li><li><b>Added simple summary page for buildings (management menu)</b></li><li><b>Added events engine with a few initial events (more to come in the future)</b></li></ul>Bug fixes:<ul><li><b>Fixed gatherer camps not to get stuck on resources</b></li><li><b>Fixed and improved win chance calculation</b></li></ul>Other:<ul><li>Gatherer camps will get small bonus chance to find resources that are not in the local storage already</li><li>Added log message after researching kitchen that says where to place orders</li><li>Improved butcher resources transport logic and  status reporting</li></ul>"]},{VERSION:"v1.1.22",MESSAGE:['New Features:<ul><li><b>Crafting to % percent of total storage</b></li></ul>Bug fixes:<ul><li><b>Added missing buff for loggers camp from Sacred grove</b></li><li><b>Fixed meteorite not to allow mining below 0</b></li><li><b>Fixed Unite with the people perk not displaying usages when RPs 100 or more</b></li></ul>Other:<ul><li>Added management option to disable "merchant arrived" logging</li></ul>']},{VERSION:"v1.1.23",MESSAGE:["Bug fixes:<ul><li><b>Blessing won't target Barn building anymore</b></li><li><b>'all on' button will now fill up partially staffed multi workers buildings</b></li></ul>Other:<ul><li>Changed basic tools icons (hammer, pickaxe, axe and shovel)</li><li>Bakery research now requires Scientific Method to be researched</li><li>Technical changes regarding buildings with multiple workers</li><li>Added 'reset' button to resource management window</li><li>Changed heritage menu display</li></ul>"]},{VERSION:"v1.1.24",MESSAGE:["New Features:<ul><li><b>It's now possible to dismiss army and recruits</b></li></ul>Bug fixes:<ul><li><b>Fixed Cooking % crafting order showing warnings for missing resources</b></li><li><b>Fixed gatherer camps not being able to collect more than 1 of each resource in each cycle</b></li><li><b>Changed ascension temple stages cost (and number of stages) to avoid icons overflow building box.<br>Total cost remains unchanged</b></li></ul>Other:<ul><li>Added management option to switch default gatherers mode</li><li>Changed Orchard status text to avoid confusion</li><li>Improved Butcher status reporting and added local storage to details list</li><li>Doubled pasture animals produce progress each tick</li><li>Nation name in world map will include Kongregate username by default</li></ul>"]},{VERSION:"v1.1.25",MESSAGE:["Bug fixes:<ul><li><b>Baby boom prayer will now also affect Tudor house</b></li></ul>Other:<ul><li>It's now possible to add crafting and cooking orders to the top of the list by shift clicking on the recipe</li><li>Added help tooltips to crafting and cooking tabs</li><li>Fixed text align to icons for food priority</li><li>Added upgrades to loggers camp</li><li>Added local storage display to loggers camp details</li><li>In build window header with filters and number of buildings will follow when buildings are scrolled</li></ul>"]},{VERSION:"v1.2.0",MESSAGE:["<b>The Sea Update!</b><br><br>New Features:<ul><li><b>Reworked sea region with many new buildings</b></li><li><b>New sea based events and missions</b></li><li><b>New tools resources</b></li><li><b>New Royal perk to unlock</b></li></ul>Bug fixes:<ul><li><b>Fixed deep mine mining below 0 resources</b></li><li><b>Changed recipes filters to also match recipe name</b></li></ul>Other:<ul><li>Changed missions to follow shortest path in terms of real distance and not number of regions 'hops'</li><li>Great Lighthouse RP bonus reduced but bonus effects added that affect some sea buildings and ships</li></ul>"]},{VERSION:"v1.2.1",MESSAGE:["Bug fixes:<ul><li><b>Fixed navy related data being \"NaN\"</b></li><li><b>Fixed doubled report for sea conquer mission</b></li><li><b>Fixed sea missions travel speed being influenced by land troops</b></li><li><b>Fixed 'sea move' mission button not visible when no land troops are present</b></li><li><b>Fixed fight reports breaking after page reload</b></li><li><b>QUICKFIX: Fixed pre 1.2.0 save files loading</b></li></ul>Other:<ul><li>Added 'cancel mission' to all sea missions</li><li>Added tooltip to ships in navy tab and shipyard window</li><li>It's now possible to decommission navy units</li><li>Added total cargo display to the sea mission description</li></ul>"]},{VERSION:"v1.2.2",MESSAGE:["Bug fixes:<ul><li><b>Fixed pirates sea event freezing the game</b></li><li><b>Fixed sea cartography research freezing the game</b></li></ul>"]},{VERSION:"v1.2.3",MESSAGE:["Bug fixes:<ul><li><b>Fixed boat builder and shipyard invalid values freezing game</b></li><li><b>Fixed fisher huts being stuck on waiting for fish after update</b></li><li><b>Added logic to clear corrupted save of pirates and pirates base events</b></li><li><b>Fixed expedition not consuming correct amount of resources</b></li><li><b>Probably fixed negative amount of mountains from expeditions</b></li><li><b>Fixed shipyard turning off on load and destroying employed people</b></li><li><b>Fixed ascension temple being available too soon</b></li></ul>Other:<ul><li>Improved game error handling to reduce chance for game freezing (game will now pause due to internal errors)</li><li>Land discovered on expeditions will be preserved through abdication</li><li>Expedition mission cargo is also restricted by the amount of food required for the mission</li><li>Ships no longer cost food on missions</li><li>Reduced small components wraps in resources, crafting and cooking tabs</li><li>Improved mission progress display to be calculated based on total distance to travel and not 20% per region</li></ul>"]},{VERSION:"v1.2.4",MESSAGE:["Bug fixes:<ul><li><b>Fixed some buildings showing error message on upgrade</b></li><li><b>Fixed butcher being stuck on waiting for fur warehouse space</b></li><li><b>Fixed mission movement attack friendly region when passing by sometimes</b></li><li><b>Fixed port size calculation when selecting ship to build</b></li><li><b>Fixed loggers camp consuming land on upgrade</b></li><li><b>Buildings from royal perks will now take correct amount of land</b></li><li><b>QUICKFIX: Additional fix for buildings upgrading issues</b></li></ul>Other:<ul><li>'Village' text changes depending on population cap</li><li>Build window will now focus text filter input by default</li><li>Added effective speed display to mission description</li></ul>"]},{VERSION:"v1.2.5",MESSAGE:["New Features:<ul><li><b>Added new housing building</b></li><li><b>Added new research building</b></li></ul>Bug fixes:<ul><li><b>Fixed forest and mountains from expedition not being saved</b></li><li><b>Fixed food cargo space being required for sea missions other than expeditions</b></li><li><b>Fixed sea plunder and sea conquer icons not displayed in world map buttons</b></li><li><b>Fixed NaN cargo value for some sea missions</b></li><li><b>Fixed cooking menu not showing number of items being crafted</b></li></ul>Other:<ul><li>Added circle ticker for next day</li><li>It's now possible to dismiss market offers</li><li>Added sounds for season changes</li><li>Crafting type selection won't change when switching tabs</li><li>Market filter selection won't change when switching tabs</li><li>When a spy is killed it will generate a fight report so that players can remember the last known army size</li><li>Added display option to change player regions colour</li></ul>"]},{VERSION:"v1.2.6",MESSAGE:["Bug fixes:<ul><li><b>Added missing settlement resource reservation</b></li><li><b>Fixed forest found on expeditions reducing land</b></li></ul></ul>"]},{VERSION:"v1.3.0",MESSAGE:["<b>The Happiness Update!</b><br><br>New Features:<ul><li><b>Reworked happiness system</b></li><li><b>Added new prayer</b></li><li><b>Added tax collector building and tax settings to management</b></li><li><b>Added new resources</b></li><li><b>New Royal perks</b></li></ul>Bug fixes:<ul><li><b>Fixed orchard grown crops switching</b></li><li><b>Added additional value checks for boat builder and shipyard</b></li><li><b>Fixed world map issue that reset world map progress</b></li></ul></ul>"]},{VERSION:"v1.3.1",MESSAGE:["Bug fixes:<ul><li><b>Fixed happiness effects calculation causing NaN happiness value</b></li><li><b>Added additional check for invalid value in building progress data</b></li></ul></ul>"]},{VERSION:"v1.3.2",MESSAGE:["Bug fixes:<ul><li><b>Fixed fired worker log message reporting wrong building</b></li><li><b>Fixed deep mine not starting after upgrade is finished</b></li><li><b>Fixed tavern happiness effect causing NaN and not clearing after tavern is disabled</b></li><li><b>Fixed fur clothes happiness effect getting stuck</b></li></ul>Other:<ul><li>Happiness management show duration setting will now save it's state</li><li>Surplus animals added to storage will be sent to butchers</li><li>Reduced refugees events chance</li><li>Combinable buildings that are compatible will no longer require confirmation</li><li>Added auto merge option that combines all compatible buildings in the region</li><li>Limited number of log entries being saved to 100</li><li>Added error reports that show more error information for better reporting<br>(this will be extended with option to send error reports to the server)</li></ul>"]},{VERSION:"v1.3.3",MESSAGE:["Bug fixes:<ul><li><b>Fixed festivals being blocked after abdication due to locked resources</b></li><li><b>Fixed sea missions calculating failing when previous mission removed the event</b></li><li><b>Fixed pirates base negative happiness effect not removed after defeating pirates base</b></li></ul>Other:<ul><li>Reduced gem chance for deep mine</li></ul>"]},{VERSION:"v1.3.4",MESSAGE:["New Features:<ul><li><b>Added new options to world map region build mission (roads, watchtower, guard towers and harbour)</b></li></ul>Bug fixes:<ul><li><b>Fixed settlement buildings consuming food faster than restocking causing famine while there was food available</b></li></ul>Other:<ul><li>Added action buttons to switch all workshops to crafting or researching</li><li>Added new recipes to craft swords, shields from bronze and iron</li><li>Changed heavy armor cost from copper to bronze</li></ul>"]},{VERSION:"v1.3.5",MESSAGE:["Bug fixes:<ul><li><b>Fixed sea missions causing type error while calculating distance</b></li></ul>"]},{VERSION:"v1.3.6",MESSAGE:["Bug fixes:<ul><li><b>Fixed stuck AI missions</b></li></ul>Other:<ul><li>Added text reason for why mission cannot be started to most reasons</li></ul>"]},{VERSION:"v1.3.7",MESSAGE:["Bug fixes:<ul><li><b>Fixed building buffing affecting every building of that type after reloading</b></li><li><b>Fixed disabled housing building accepting occupants but not resuming resources consumption</b></li><li><b>Probably fixed unexpected negative fur clothes issue (could not reproduce the issue)</b></li></ul>Other:<ul><li>AI can no longer build new guard towers</li><li>Changed watchtowers cost from nails to bricks</li></ul>"]},{VERSION:"v1.3.8",MESSAGE:['New Features:<ul><li><b>Added builders guild building</b></li></ul>Bug fixes:<ul><li><b>Fixed tax collector demolishing decreasing faith cap</b></li><li><b>Fixed corrupted missions data loading and freezing game</b></li><li><b>Fixed error in builders guild research</b></li><li><b>Fixed "Arrange" not working</b></li></ul>Other:<ul><li>Upgraded Angular version 8->10</li></ul>']},{VERSION:"v1.3.9",MESSAGE:["Bug fixes:<ul><li><b>Fixed a bug allowing to build fraction of buildings</b></li><li><b>Fixed two regions border connection working only in one direction</b></li><li><b>Marketplace should no longer report removed workers</b></li><li><b>Fixed some log typos</b></li><li><b>Fixed stuck Fur clothes negative happiness effect</b></li><li><b>Fixed world map build missions disappearing after loading game save</b></li></ul>"]},{VERSION:"v1.3.10",MESSAGE:["Bug fixes:<ul><li><b>Refugees won't occupy disabled houses</b></li><li><b>Fixed one of the borders above south lake</b></li><li><b>Fixed doubled text on heritage page</b></li></ul>Other:<ul><li>Game can now scale with screen size</li><li>Upgraded Angular version 10->12</li><li>Made changes to allow for standalone offline builds</li></ul>"]}],Nm=function(){var e=function(){function e(t,i,n){p(this,e),this.modalService=t,this.servicesService=i,this.router=n,this.tutorialsEnabled=!1,this.villageTutorialState=0,this.forestTutorialState=0,this.fieldTutorialState=0,this.mountainsTutorialState=0,this.plateauTutorialState=0,this.seaTutorialState=0,this.resourcesTutorialState=0,this.winterTutorialState=0,i.addService(Zv.TUTORIAL,this)}return S(e,[{key:"getName",value:function(){return"TutorialService"}},{key:"load",value:function(e){this.villageTutorialState=void 0!==e.villageTutorialState?e.villageTutorialState:0,this.forestTutorialState=void 0!==e.forestTutorialState?e.forestTutorialState:0,this.resourcesTutorialState=void 0!==e.resourcesTutorialState?e.resourcesTutorialState:0,this.fieldTutorialState=void 0!==e.fieldTutorialState?e.fieldTutorialState:0,this.mountainsTutorialState=void 0!==e.mountainsTutorialState?e.mountainsTutorialState:0,this.plateauTutorialState=void 0!==e.plateauTutorialState?e.plateauTutorialState:0,this.seaTutorialState=void 0!==e.seaTutorialState?e.seaTutorialState:0,this.winterTutorialState=void 0!==e.winterTutorialState?e.winterTutorialState:0}},{key:"save",value:function(){return{villageTutorialState:this.villageTutorialState,forestTutorialState:this.forestTutorialState,resourcesTutorialState:this.resourcesTutorialState,fieldTutorialState:this.fieldTutorialState,mountainsTutorialState:this.mountainsTutorialState,plateauTutorialState:this.plateauTutorialState,seaTutorialState:this.seaTutorialState,winterTutorialState:this.winterTutorialState}}},{key:"reset",value:function(e,t){}},{key:"checkRegionTutorial",value:function(e){var t=this;if(this.tutorialsEnabled)switch(e){case Yv.VILLAGE:if(0===this.villageTutorialState){this.startTutorial(_p);var i=this.modalService.registerForTutorialResponse().subscribe(function(e){i.unsubscribe(),t.villageTutorialState=e})}break;case Yv.FOREST:if(0===this.forestTutorialState){this.startTutorial(wp);var n=this.modalService.registerForTutorialResponse().subscribe(function(e){n.unsubscribe(),t.forestTutorialState=e})}break;case Yv.FIELD:if(0===this.fieldTutorialState){this.startTutorial(Pp);var r=this.modalService.registerForTutorialResponse().subscribe(function(e){r.unsubscribe(),t.fieldTutorialState=e})}break;case Yv.MOUNTAINS:if(0===this.mountainsTutorialState){this.startTutorial(Mp);var o=this.modalService.registerForTutorialResponse().subscribe(function(e){o.unsubscribe(),t.mountainsTutorialState=e})}break;case Yv.PLATEAU:if(0===this.plateauTutorialState){this.startTutorial(Dp);var s=this.modalService.registerForTutorialResponse().subscribe(function(e){s.unsubscribe(),t.plateauTutorialState=e})}break;case Yv.SEA:if(0===this.seaTutorialState){this.startTutorial(Lp);var a=this.modalService.registerForTutorialResponse().subscribe(function(e){a.unsubscribe(),t.seaTutorialState=e})}}}},{key:"checkResourcesTutorial",value:function(){var e=this;if(0===this.resourcesTutorialState){this.startTutorial(xp);var t=this.modalService.registerForTutorialResponse().subscribe(function(i){t.unsubscribe(),e.resourcesTutorialState=i})}}},{key:"enableTutorials",value:function(){this.tutorialsEnabled=!0}},{key:"resetTutorials",value:function(){this.villageTutorialState=0,this.forestTutorialState=0,this.fieldTutorialState=0,this.mountainsTutorialState=0,this.plateauTutorialState=0,this.seaTutorialState=0,this.resourcesTutorialState=0,this.winterTutorialState=0,this.router.url.endsWith("village")?this.checkRegionTutorial(Yv.VILLAGE):this.router.url.endsWith("forest")?this.checkRegionTutorial(Yv.FOREST):this.router.url.endsWith("field")?this.checkRegionTutorial(Yv.FIELD):this.router.url.endsWith("mountains")?this.checkRegionTutorial(Yv.MOUNTAINS):this.router.url.endsWith("plateau")?this.checkRegionTutorial(Yv.PLATEAU):this.router.url.endsWith("sea")?this.checkRegionTutorial(Yv.SEA):this.router.url.endsWith("resources")?this.checkResourcesTutorial():this.modalService.info("Tutorials have been enabled")}},{key:"startTutorial",value:function(e){this.modalService.setTutorial(e),this.servicesService.getService(Zv.TICKER).stop(),this.modalService.openTutorialModal(e[0].position)}},{key:"showCurrentViewTutorial",value:function(){this.router.url.endsWith("village")?this.startTutorial(_p):this.router.url.endsWith("forest")?this.startTutorial(wp):this.router.url.endsWith("field")?this.startTutorial(Pp):this.router.url.endsWith("mountains")?this.startTutorial(Mp):this.router.url.endsWith("plateau")?this.startTutorial(Dp):this.router.url.endsWith("sea")?this.startTutorial(Lp):this.router.url.endsWith("resources")?this.startTutorial(xp):this.modalService.info("There is no tutorial for this tab")}},{key:"checkWinterTutorial",value:function(){var e=this;if(0===this.winterTutorialState){this.startTutorial(Fp);var t=this.modalService.registerForTutorialResponse().subscribe(function(i){t.unsubscribe(),e.winterTutorialState=i})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Jv),An($v),An(sv))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),_m=function(){var e=function(){function e(t,i,n,r,o){p(this,e),this.servicesService=t,this.modalService=i,this.logService=n,this.calendarService=r,this.tutorialsService=o,this.flags=[],this.gameState=0,this.abdicationLevel=0,this.gameStartedYear=1,this.devMessage=Number.MAX_SAFE_INTEGER,this.headerRowsSubject=new U,this.demolishReturn=um.DEMOLITION_RETURN,this.servicesService.addService(Zv.GAME,this)}return S(e,[{key:"init",value:function(){var e=this;Cp.production?this.flags=[]:(this.flags=[],Object.keys(wv).filter(function(e){return!isNaN(e)}).map(function(e){return Number(e)}).forEach(function(t){e.flags.push(t)}))}},{key:"getName",value:function(){return"GameService"}},{key:"load",value:function(e){this.flags=e.flags,this.gameState=e.gameState,this.demolishReturn=e.demolishReturn,this.devMessage=e.devMessage,this.abdicationLevel=e.abdicationLevel,this.gameStartedYear=void 0!==e.gameStartedYear?e.gameStartedYear:1}},{key:"save",value:function(){return{flags:this.flags,gameState:this.gameState,demolishReturn:this.demolishReturn,devMessage:this.devMessage,abdicationLevel:this.abdicationLevel,gameStartedYear:this.gameStartedYear}}},{key:"reset",value:function(e,t){this.flags=[],this.gameState=0,this.gameStartedYear=this.calendarService.getYear(),this.demolishReturn=um.DEMOLITION_RETURN,this.init(),e&&(this.devMessage=Number.MAX_SAFE_INTEGER,this.abdicationLevel=0,this.gameStartedYear=1),t&&(this.abdicationLevel=0)}},{key:"isEnabled",value:function(e){return this.flags.includes(e)}},{key:"enable",value:function(e){this.flags.includes(e)||this.flags.push(e)}},{key:"disable",value:function(e){this.flags.includes(e)&&this.flags.splice(this.flags.indexOf(e),1)}},{key:"setGameState",value:function(e){this.gameState=e}},{key:"getGameState",value:function(){return this.gameState}},{key:"tick",value:function(e){0===this.getGameState()&&(this.displayWelcomeModal(),this.addStartBoost(),this.tutorialsService.checkRegionTutorial(Yv.VILLAGE),this.setGameState(1)),this.displayDevMessage()}},{key:"displayWelcomeModal",value:function(){var e=this;this.modalService.info("Welcome to <b>Villager Kings</b><br>You start as a leader of a small village.<br>Will you manage to lead your people to greatness? <br>First thing you need to focus on is to make sure that your people will survive winter.<br>You will need to increase food production and have some wood to heat houses.<br>Remember that winter is not the only threat to your people!<br>Good luck!");var t=this.modalService.registerForCloseModal().subscribe(function(){e.devMessage===Number.MAX_SAFE_INTEGER&&(e.devMessage=0),t.unsubscribe()})}},{key:"displayDevMessage",value:function(){var e=km.length;this.devMessage<e&&(this.showDevNotes(),this.devMessage=e)}},{key:"showDevNotes",value:function(){this.modalService.open(_v.CHANGELOG)}},{key:"addStartBoost",value:function(){Ap&&this.servicesService.getEffectsService().addBuildingEffect(new rp(Ap.name,Ap.building,Ap.effect,Ap.duration))}},{key:"getAbdicationLevel",value:function(){return this.abdicationLevel}},{key:"incrementAbdicationLevel",value:function(){this.abdicationLevel+=1,this.abdicationLevel>=7&&this.logService.mystical("As you finish last wonder building strange thoughts of ancient structures appear in your head. Who knows what purpose this building serve")}},{key:"updateHeader",value:function(e){this.headerRowsSubject.next(e)}},{key:"registerForHeaderRowsChange",value:function(){return this.headerRowsSubject.asObservable()}},{key:"getGameStartedYear",value:function(){return this.gameStartedYear}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Jv),An(Cm),An(Im),An(Nm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),wm=function(){var e=function(){function e(t,i,n,r,o){p(this,e),this.servicesService=t,this.effectsService=i,this.gameService=n,this.optionsService=r,this.logService=o,this.land=tm,this.forest=im,this.mountains=nm,this.takenLand=0,this.ores=[[Mv.COAL,0],[Mv.GOLD_ORE,0],[Mv.SILVER_ORE,0],[Mv.COPPER_ORE,0],[Mv.TIN_ORE,0],[Mv.IRON_ORE,0]],this.forestGrowTick=0,this.forestGrowTicks=sm,this.forestGrowPercentage=rm,this.defaultForestOptions=new Em(0,!1,25,!0,0),this.forestOptions=new Em(0,!1,25,!0,0),this.servicesService.addService(Zv.LAND,this)}return S(e,[{key:"getName",value:function(){return"LandService"}},{key:"load",value:function(e){this.land=e.land,this.forest=e.forest,this.mountains=e.mountains,this.forestGrowTick=e.forestGrowTick,this.takenLand=e.takenLand,e.forestLandLimit&&(this.forestOptions=new Em(0,!1,e.forestLandLimit,!0,0)),e.forestOptions&&(this.forestOptions=e.forestOptions),this.ores=e.ores}},{key:"save",value:function(){return{land:this.land,forest:this.forest,mountains:this.mountains,forestGrowTick:this.forestGrowTick,takenLand:this.takenLand,forestOptions:this.forestOptions,ores:this.ores}}},{key:"reset",value:function(e,t){if(this.land=tm,this.forest=im,this.mountains=nm,this.takenLand=0,(!this.optionsService.getOption(Xv.KEEP_MANAGEMENT_SETTINGS_ON_RESET)||e)&&(this.forestOptions=new Em(0,!1,25,!0,0)),!e&&!t){var i=this.servicesService.getWorldService();this.increaseLand(i.getDiscoveredLand(),!0),this.increaseForest(i.getDiscoveredForest(),!1),this.increaseMountains(i.getDiscoveredMountains())}this.ores=[[Mv.COAL,0],[Mv.GOLD_ORE,0],[Mv.SILVER_ORE,0],[Mv.COPPER_ORE,0],[Mv.TIN_ORE,0],[Mv.IRON_ORE,0]]}},{key:"tick",value:function(e){this.growForest()}},{key:"growForest",value:function(){if(this.forestGrowTick<this.forestGrowTicks&&(this.forestGrowTick+=1),this.forestGrowTick===this.forestGrowTicks){var e=Math.floor(this.forestGrowPercentage*this.forest*(1+this.effectsService.getNatureEffectsValue()/100));e<om&&(e=om),this.increaseForest(e),this.forestGrowTick=0}}},{key:"removeForest",value:function(e){this.forest>=e&&(this.forest-=e)}},{key:"reduceForest",value:function(e){var t=this.forest;return this.forest-e>=this.forestOptions.forestSizeReserved&&(this.forest-=e,this.gameService.isEnabled(wv.FORESTER)||(t>=400&&this.forest<400&&this.logService.warning("There are less than 400 trees in the forest!"),t>=250&&this.forest<250&&this.logService.warning("There are less than 250 trees in the forest!"),t>=100&&this.forest<100&&(this.logService.warning("Critical forest size!"),this.logService.warning("There are less than 100 trees in the forest!"))),!0)}},{key:"increaseForest",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var i=0;this.forestOptions.landSizeRuleEnabled&&(i=this.forestOptions.landSizeRule),i<0&&(i=0);var n=this.land-i;return n<0&&(n=0),n-e>=0?(this.forest+=e,this.land-=e,0):(this.forest+=n,this.land-=n,e-n)}return this.forest+=e,0}},{key:"removeLand",value:function(e){this.land>=e&&(this.land-=e)}},{key:"reduceLand",value:function(e){var t=0;return this.forestOptions.landSizeRuleEnabled&&(t=this.forestOptions.landSizeRule),t<0&&(t=0),this.land-t-e>=0&&(this.land-=e,!0)}},{key:"increaseLand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.land+=e,t||(this.takenLand-=e),!0}},{key:"increaseMountains",value:function(e){return this.mountains+=e,!0}},{key:"getForest",value:function(){return this.forest}},{key:"decreaseLand",value:function(e){if(!(this.land-e>=0))return e-this.land;this.takenLand+=e,this.land-=e}},{key:"hasLand",value:function(e){return this.land-e>=0}},{key:"getLand",value:function(){return this.land}},{key:"getMountains",value:function(){return this.mountains}},{key:"hasMountains",value:function(e){return this.mountains-e>=0}},{key:"removeMountains",value:function(e){this.mountains>=e&&(this.mountains-=e)}},{key:"decreaseMountains",value:function(e){if(!(this.mountains-e>=0))return e-this.mountains;this.mountains-=e,this.takenLand+=e}},{key:"getOre",value:function(e){return this.ores.find(function(t){return t[0]===e})[1]}},{key:"hasOre",value:function(e,t){return this.ores.find(function(t){return t[0]===e})[1]>=t}},{key:"increaseOre",value:function(e,t){this.ores.find(function(t){return t[0]===e})[1]+=t}},{key:"decreaseOre",value:function(e,t){var i=this.ores.find(function(t){return t[0]===e});if(i[1]>=t)return i[1]-=t,0;var n=t-i[1];return i[1]=0,n}},{key:"getTakenLand",value:function(){return this.takenLand}},{key:"takeLand",value:function(e){this.land-=e,this.takenLand+=e}},{key:"getForestOptions",value:function(){return this.gameService.isEnabled(wv.FORESTER)?this.forestOptions:this.defaultForestOptions}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Am),An(_m),An(Om),An(Cm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Pm=(function(e){e[e.TEXT=0]="TEXT",e[e.PROGRESS_BAR=1]="PROGRESS_BAR",e[e.BUTTON=2]="BUTTON",e[e.CHECKBOX=3]="CHECKBOX",e[e.BUTTON_CHECKBOX=4]="BUTTON_CHECKBOX",e[e.TWO_BUTTON=5]="TWO_BUTTON",e[e.DROPDOWN=6]="DROPDOWN",e[e.ICON=7]="ICON"}(Pm||(Pm={})),Pm),Mm=function(){function e(t,i){p(this,e),this.valueType=t,this.value=i}return S(e,[{key:"getValueType",value:function(){return this.valueType}},{key:"getValue",value:function(){return this.value}}],[{key:"emptyValue",value:function(){return new e(Pm.TEXT,"")}},{key:"textValue",value:function(t){return new e(Pm.TEXT,t)}},{key:"progressValue",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new e(Pm.PROGRESS_BAR,{value:t,label:i})}},{key:"buttonValue",value:function(t,i){return new e(Pm.BUTTON,{buttonText:t,callbackValue:i})}},{key:"buttonCheckboxValue",value:function(t,i,n,r,o){return new e(Pm.BUTTON_CHECKBOX,{buttonText:t,callbackValue:i,checkboxState:r,checkboxLabel:n,checkboxCallbackValue:o})}},{key:"checkboxValue",value:function(t,i,n){return new e(Pm.CHECKBOX,{checkboxState:i,checkboxLabel:t,checkboxCallbackValue:n})}},{key:"twoButtonValue",value:function(t,i,n,r,o){return new e(Pm.TWO_BUTTON,{button1Text:t,callback1Value:i,textBetween:n,button2Text:r,callback2Value:o})}},{key:"dropdownValue",value:function(t,i){return new e(Pm.DROPDOWN,{values:t,selected:i})}},{key:"iconValue",value:function(t){return new e(Pm.ICON,t)}}]),e}(),Dm=(function(e){e[e.FIRST=0]="FIRST",e[e.SECOND=1]="SECOND",e[e.THIRD=2]="THIRD",e[e.FOURTH=3]="FOURTH"}(Dm||(Dm={})),Dm),Lm=function e(t,i,n,r){p(this,e),this.name=t,this.effect=i,this.duration=n,this.cost=r},xm=function(){function e(t,i,n,r,o,s,a,u){p(this,e),this.servicesService=n,this.id=t,this.buildingType=i,this.demolishable=s,this.settings=r,this.stoppable=a,this.working=o,this.level=u,this.size=r.SIZE,this.complexity=r.COMPLEXITY,n&&(this.resourcesService=n.getResourcesService(),this.effectsService=n.getEffectsService(),this.happinessService=n.getHappinessService(),this.gameService=n.getGameService(),this.logService=n.getLogService(),this.modalService=n.getModalService(),this.weatherService=n.getWeatherService())}return S(e,[{key:"build",value:function(){return this.startProduction(),this}},{key:"getBuildingId",value:function(){return this.id}},{key:"callback",value:function(e){}},{key:"finishDemolish",value:function(){var e=this;Array.from(this.getCost().entries()).forEach(function(t){return e.resourcesService.increaseResource(t[0],Math.floor(.3*t[1]),"Demolition")})}},{key:"fireWorker",value:function(){return!!this.working&&(this.resourcesService.fireWorker(),this.working=!1,!0)}},{key:"getBuildingType",value:function(){return this.buildingType}},{key:"getComplexity",value:function(){return this.complexity}},{key:"getCost",value:function(){var e=new Map;return this.settings.COST.forEach(function(t){return e.set(t.resource,t.amount)}),e}},{key:"getDescription",value:function(){return this.settings.DESCRIPTION}},{key:"hasDetails",value:function(){return!0}},{key:"getDetails",value:function(){var e="";(this.getBuildingLevel()>1||this.hasUpgrade())&&(e+="building level: "+this.level+"<br>");var t=0;return 1===this.level||this.buildingType===Pv.CONSTRUCTION?t=this.settings.BASE_POWER:this.settings.UPGRADES&&(t=this.settings.UPGRADES[this.level-2].BASE_POWER),e+="building base power: "+t+"<br>",this.getPower()%1==0?e+="building power: "+this.getPower()+"<br>":e+="building power: "+Qv.round(this.getPower(),2)+"<br>",0!==this.getPermanentEffects()&&(e+="permanent effects: "+this.getPermanentEffects()+"%<br>"),0!==this.getEffects()&&(e+="temporary effects: "+this.getEffects()+"%<br>"),0!==this.getHappinessEffect()&&(e+="happiness effects: "+this.getHappinessEffect()+"%<br>"),0!==this.getWeatherMultiplier()&&(e+="weather multiplier: "+this.getWeatherMultiplier()+"%<br>"),e}},{key:"getEffects",value:function(){return this.effectsService.getBuildingEffectsValue(this.buildingType,!1,this.id)}},{key:"getPermanentEffects",value:function(){return this.effectsService.getBuildingEffectsValue(this.buildingType,!0)}},{key:"getHappinessEffect",value:function(){return this.happinessService.getHappinessEffect()}},{key:"getWeatherMultiplier",value:function(){var e=this,t=(this.settings.WEATHER?this.settings.WEATHER:[]).find(function(t){return e.weatherService.isWeather(t.weather)});return t?t.effect:0}},{key:"getDisplayableEffectsValue",value:function(){var e=0;return 1===this.level||this.buildingType===Pv.CONSTRUCTION?e=this.settings.BASE_POWER:this.settings.UPGRADES&&(e=this.settings.UPGRADES[this.level-2].BASE_POWER),Number(Qv.round(100*(this.getPower()/e-1),2))}},{key:"getPower",value:function(){var e=0;return 1===this.level||this.buildingType===Pv.CONSTRUCTION?e=this.settings.BASE_POWER:this.settings.UPGRADES&&(e=this.settings.UPGRADES[this.level-2].BASE_POWER),e*(1+(this.getPermanentEffects()+this.getEffects()+this.getHappinessEffect())/100)*(1+this.getWeatherMultiplier()/100)}},{key:"isUsedUp",value:function(){return!1}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:case Dm.SECOND:case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"getName",value:function(){return Qv.titleCase(Qv.prepareBuildingName(this.buildingType))}},{key:"getSize",value:function(){return this.size}},{key:"buildOnMountain",value:function(){return!1}},{key:"getWorkers",value:function(){return this.working?1:0}},{key:"hireWorker",value:function(){return!(this.working||!this.resourcesService.hireWorker()||(this.working=!0,0))}},{key:"isDemolishable",value:function(){return this.demolishable}},{key:"isStoppable",value:function(){return this.stoppable}},{key:"isComplexManagement",value:function(){return!1}},{key:"getWorkSettings",value:function(){return null}},{key:"setWorkSettings",value:function(e){}},{key:"isWorking",value:function(){return this.working}},{key:"prepareDemolish",value:function(){return this.stopProduction(),!0}},{key:"startProduction",value:function(){return!(this.working||!this.resourcesService.hireWorker()||(this.working=!0,0))}},{key:"stopProduction",value:function(){this.working&&(this.resourcesService.fireWorker(),this.working=!1)}},{key:"tick",value:function(e){}},{key:"isCombinable",value:function(){return!1}},{key:"isSplittable",value:function(){return!1}},{key:"hasBuff",value:function(){return this.settings.BUFF}},{key:"isBuffed",value:function(){var e=this;return!!this.hasBuff()&&this.effectsService.getBuildingEffects(this.buildingType).filter(function(t){return t.buff===e.id}).length>0}},{key:"getBuff",value:function(){if(this.settings.BUFF){var e=new Map;return this.settings.BUFF.cost.forEach(function(t){return e.set(t.resource,t.amount)}),new Lm(this.settings.BUFF.name,this.settings.BUFF.effect,this.settings.BUFF.duration,e)}return null}},{key:"hasUpgrade",value:function(){var e=this;if(this.settings.UPGRADES&&this.settings.UPGRADES.length>=this.getBuildingLevel()){if(this.settings.UPGRADES[this.getBuildingLevel()-1].PREREQUISITES){var t=!0;return this.settings.UPGRADES[this.getBuildingLevel()-1].PREREQUISITES.forEach(function(i){e.gameService.isEnabled(i)||(t=!1)}),t}return!0}return!1}},{key:"getUpgradeSettings",value:function(){return this.settings.UPGRADES&&this.settings.UPGRADES.length>=this.getBuildingLevel()?this.settings.UPGRADES[this.getBuildingLevel()-1]:null}},{key:"getUpgradeCost",value:function(){var e=new Map;return this.hasUpgrade()&&this.settings.UPGRADES[this.level-1].COST.forEach(function(t){return e.set(t.resource,t.amount)}),e}},{key:"setBuildingLevel",value:function(e){this.level=e}},{key:"getBuildingLevel",value:function(){return this.level}},{key:"getBuildingData",value:function(){return null}},{key:"setBuildingData",value:function(e){}}]),e}(),Fm=function(e){c(i,e);var t=h(i);function i(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,h=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,g=arguments.length>10?arguments[10]:void 0;return p(this,i),(r=t.call(this,e,n,o,s,a,u,c,l)).progress=h,r.buildingComplexity=d,r.workingAt=g,r}return S(i,[{key:"getProgress",value:function(){return this.progress}},{key:"increaseProgress",value:function(e){this.progress+=e/this.buildingComplexity,this.progress>100&&(this.progress=100)}},{key:"getWorkingAt",value:function(){return this.workingAt}},{key:"getComplexity",value:function(){return 0}}]),i}(xm),Um=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return p(this,i),(e=t.call(this,r,Pv.DECONSTRUCTION,n,um.DECONSTRUCTION_SITE,l,!1,!0,1,c,a,s)).region=o,e.buildingSize=u,e.servicesService&&(e.regionService=n.getServiceByRegion(o)),e}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:return Mm.textValue("deconstructing "+Qv.prepareBuildingName(this.workingAt));case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(){this.progress>=100&&this.regionService.finishDeconstruction(this),this.working&&(this.progress<100?(this.progress+=this.getPower()/this.buildingComplexity,this.progress>100&&(this.progress=100)):this.regionService.finishDeconstruction(this))}},{key:"toJSON",value:function(){return{id:this.id,buildingType:this.buildingType,region:this.region,deconstructing:this.workingAt,buildingComplexity:this.buildingComplexity,progress:this.progress,working:this.working,buildingSize:this.buildingSize}}},{key:"getSize",value:function(){return this.buildingSize}},{key:"prepareDemolish",value:function(){return!1}},{key:"finishDemolish",value:function(){}},{key:"getBuildingBeingDemolished",value:function(){return this.workingAt}}]),i}(Fm);function Hm(e){return null!=e&&"false"!="".concat(e)}function Gm(e){return e instanceof Ua?e.nativeElement:e}function Bm(e,t,n,r){return f(n)&&(r=n,n=void 0),r?Bm(e,t,n).pipe(B(function(e){return O(e)?r.apply(void 0,i(e)):r(e)})):new M(function(i){Wm(e,t,function(e){i.next(arguments.length>1?Array.prototype.slice.call(arguments):e)},i,n)})}function Wm(e,t,i,n,r){var o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var s=e;e.addEventListener(t,i,r),o=function(){return s.removeEventListener(t,i,r)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var a=e;e.on(t,i),o=function(){return a.off(t,i)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var u=e;e.addListener(t,i),o=function(){return u.removeListener(t,i)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,l=e.length;c<l;c++)Wm(e[c],t,i,n,r)}n.add(o)}var Vm=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).scheduler=e,r.work=n,r.pending=!1,r}return S(i,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),i)}},{key:"recycleAsyncId",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var i,n=!1;try{this.work(e)}catch(r){n=!0,i=!!r&&r||new Error(r)}if(n)return this.unsubscribe(),i}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,i=t.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),i}(function(e){c(i,e);var t=h(i);function i(e,n){return p(this,i),t.call(this)}return S(i,[{key:"schedule",value:function(e){return this}}]),i}(C)),zm=function(){var e=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;p(this,e),this.SchedulerAction=t,this.now=i}return S(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(i,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Ym=function(e){c(i,e);var t=h(i);function i(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zm.now;return p(this,i),(n=t.call(this,e,function(){return i.delegate&&i.delegate!==g(n)?i.delegate.now():r()})).actions=[],n.active=!1,n.scheduled=void 0,n}return S(i,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return i.delegate&&i.delegate!==this?i.delegate.schedule(e,t,n):u(v(i.prototype),"schedule",this).call(this,e,t,n)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}}]),i}(zm),jm=new(function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t,i=this.actions,n=-1,r=i.length;e=e||i.shift();do{if(t=e.execute(e.state,e.delay))break}while(++n<r&&(e=i.shift()));if(this.active=!1,t){for(;++n<r&&(e=i.shift());)e.unsubscribe();throw t}}}]),i}(Ym))(function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).scheduler=e,r.work=n,r}return S(i,[{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==n&&n>0?u(v(i.prototype),"requestAsyncId",this).call(this,e,t,n):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(function(){return e.flush(null)})))}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&n>0||null===n&&this.delay>0)return u(v(i.prototype),"recycleAsyncId",this).call(this,e,t,n);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}}]),i}(Vm)),Km=1,Qm=Promise.resolve(),qm={};function Xm(e){return e in qm&&(delete qm[e],!0)}var Zm=function(e){var t=Km++;return qm[t]=!0,Qm.then(function(){return Xm(t)&&e()}),t},$m=function(e){Xm(e)},Jm=(new(function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t,i=this.actions,n=-1,r=i.length;e=e||i.shift();do{if(t=e.execute(e.state,e.delay))break}while(++n<r&&(e=i.shift()));if(this.active=!1,t){for(;++n<r&&(e=i.shift());)e.unsubscribe();throw t}}}]),i}(Ym))(function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).scheduler=e,r.work=n,r}return S(i,[{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==n&&n>0?u(v(i.prototype),"requestAsyncId",this).call(this,e,t,n):(e.actions.push(this),e.scheduled||(e.scheduled=Zm(e.flush.bind(e,null))))}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&n>0||null===n&&this.delay>0)return u(v(i.prototype),"recycleAsyncId",this).call(this,e,t,n);0===e.actions.length&&($m(t),e.scheduled=void 0)}}]),i}(Vm)),new Ym(Vm)),eS=function(){function e(t){p(this,e),this.durationSelector=t}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new tS(e,this.durationSelector))}}]),e}(),tS=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e)).durationSelector=n,r.hasValue=!1,r}return S(i,[{key:"_next",value:function(e){if(this.value=e,this.hasValue=!0,!this.throttled){var t;try{var i;t=(0,this.durationSelector)(e)}catch(i){return this.destination.error(i)}var n=J(t,new Z(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}},{key:"clearThrottle",value:function(){var e=this.value,t=this.hasValue,i=this.throttled;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),t&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))}},{key:"notifyNext",value:function(){this.clearThrottle()}},{key:"notifyComplete",value:function(){this.clearThrottle()}}]),i}($);function iS(e){return!O(e)&&e-parseFloat(e)+1>=0}function nS(e){var t=e.index,i=e.period,n=e.subscriber;if(n.next(t),!n.closed){if(-1===i)return n.complete();e.index=t+1,this.schedule(e,i)}}function rS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jm;return function(e){return function(t){return t.lift(new eS(e))}}(function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=-1;return iS(t)?n=Number(t)<1?1:Number(t):G(t)&&(i=t),G(i)||(i=Jm),new M(function(t){var r=iS(e)?e:+e-i.now();return i.schedule(nS,r,{index:0,period:n,subscriber:t})})}(e,t)})}function oS(e){return function(t){return t.lift(new sS(e))}}var sS=function(){function e(t){p(this,e),this.notifier=t}return S(e,[{key:"call",value:function(e,t){var i=new aS(e),n=J(this.notifier,new Z(i));return n&&!i.seenValue?(i.add(n),t.subscribe(i)):i}}]),e}(),aS=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this,e)).seenValue=!1,n}return S(i,[{key:"notifyNext",value:function(){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),i}($);function uS(e,t){return new M(t?function(i){return t.schedule(cS,0,{error:e,subscriber:i})}:function(t){return t.error(e)})}function cS(e){var t=e.error;e.subscriber.error(t)}new(function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(Ym))(function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this,e,n)).scheduler=e,r.work=n,r}return S(i,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?u(v(i.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?u(v(i.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==n&&n>0||null===n&&this.delay>0?u(v(i.prototype),"requestAsyncId",this).call(this,e,t,n):e.flush(this)}}]),i}(Vm));var lS,hS=function(){function e(t,i,n){p(this,e),this.kind=t,this.value=i,this.error=n,this.hasValue="N"===t}return S(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}},{key:"accept",value:function(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Lh(this.value);case"E":return uS(this.error);case"C":return jh()}throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}();hS.completeNotification=new hS("C"),hS.undefinedValueNotification=new hS("N",void 0);try{lS="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(I){lS=!1}var dS,gS,fS=function(){var e=function e(t){p(this,e),this._platformId=t,this.isBrowser=this._platformId?function(e){return e===eh}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!lS)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT};return e.\u0275fac=function(t){return new(t||e)(An(pc))},e.\u0275prov=be({factory:function(){return new e(An(pc))},token:e,providedIn:"root"}),e}();function vS(e){return function(){if(null==dS&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){return dS=!0}}))}finally{dS=dS||!1}return dS}()?e:!!e.capture}var pS=new an("cdk-dir-doc",{providedIn:"root",factory:function(){return kn(cl)}}),mS=function(){var e=function(){function e(t){if(p(this,e),this.value="ltr",this.change=new Yu,t){var i=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||i;this.value="ltr"===n||"rtl"===n?n:"ltr"}}return S(e,[{key:"ngOnDestroy",value:function(){this.change.complete()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(pS,8))},e.\u0275prov=be({factory:function(){return new e(An(pS,8))},token:e,providedIn:"root"}),e}(),SS=function(){var e=function(){function e(t,i,n){p(this,e),this._ngZone=t,this._platform=i,this._scrolled=new U,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}return S(e,[{key:"register",value:function(e){var t=this;this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(function(){return t._scrolled.next(e)}))}},{key:"deregister",value:function(e){var t=this.scrollContainers.get(e);t&&(t.unsubscribe(),this.scrollContainers.delete(e))}},{key:"scrolled",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this._platform.isBrowser?new M(function(i){e._globalSubscription||e._addGlobalListener();var n=t>0?e._scrolled.pipe(rS(t)).subscribe(i):e._scrolled.subscribe(i);return e._scrolledCount++,function(){n.unsubscribe(),e._scrolledCount--,e._scrolledCount||e._removeGlobalListener()}}):Lh()}},{key:"ngOnDestroy",value:function(){var e=this;this._removeGlobalListener(),this.scrollContainers.forEach(function(t,i){return e.deregister(i)}),this._scrolled.complete()}},{key:"ancestorScrolled",value:function(e,t){var i=this.getAncestorScrollContainers(e);return this.scrolled(t).pipe(od(function(e){return!e||i.indexOf(e)>-1}))}},{key:"getAncestorScrollContainers",value:function(e){var t=this,i=[];return this.scrollContainers.forEach(function(n,r){t._scrollableContainsElement(r,e)&&i.push(r)}),i}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_scrollableContainsElement",value:function(e,t){var i=t.nativeElement,n=e.getElementRef().nativeElement;do{if(i==n)return!0}while(i=i.parentElement);return!1}},{key:"_addGlobalListener",value:function(){var e=this;this._globalSubscription=this._ngZone.runOutsideAngular(function(){return Bm(e._getWindow().document,"scroll").subscribe(function(){return e._scrolled.next()})})}},{key:"_removeGlobalListener",value:function(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(wc),An(fS),An(cl,8))},e.\u0275prov=be({factory:function(){return new e(An(wc),An(fS),An(cl,8))},token:e,providedIn:"root"}),e}(),ES=function(){var e=function(){function e(t,i,n){var r=this;p(this,e),this._platform=t,this._change=new U,this._changeListener=function(e){r._change.next(e)},this._document=n,i.runOutsideAngular(function(){if(t.isBrowser){var e=r._getWindow();e.addEventListener("resize",r._changeListener),e.addEventListener("orientationchange",r._changeListener)}r.change().subscribe(function(){return r._updateViewportSize()})})}return S(e,[{key:"ngOnDestroy",value:function(){if(this._platform.isBrowser){var e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}},{key:"getViewportSize",value:function(){this._viewportSize||this._updateViewportSize();var e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}},{key:"getViewportRect",value:function(){var e=this.getViewportScrollPosition(),t=this.getViewportSize(),i=t.width,n=t.height;return{top:e.top,left:e.left,bottom:e.top+n,right:e.left+i,height:n,width:i}}},{key:"getViewportScrollPosition",value:function(){if(!this._platform.isBrowser)return{top:0,left:0};var e=this._getDocument(),t=this._getWindow(),i=e.documentElement,n=i.getBoundingClientRect();return{top:-n.top||e.body.scrollTop||t.scrollY||i.scrollTop||0,left:-n.left||e.body.scrollLeft||t.scrollX||i.scrollLeft||0}}},{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return e>0?this._change.pipe(rS(e)):this._change}},{key:"_getDocument",value:function(){return this._document||document}},{key:"_getWindow",value:function(){return this._getDocument().defaultView||window}},{key:"_updateViewportSize",value:function(){var e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(fS),An(wc),An(cl,8))},e.\u0275prov=be({factory:function(){return new e(An(fS),An(wc),An(cl,8))},token:e,providedIn:"root"}),e}(),yS=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({}),e}();function RS(e){var t=e.subscriber,i=e.counter,n=e.period;t.next(i),this.schedule({subscriber:t,counter:i+1,period:n},n)}function OS(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function TS(e,t){var i=t?"":"none";OS(e.style,{touchAction:t?"":"none",webkitUserDrag:t?"":"none",webkitTapHighlightColor:t?"":"transparent",userSelect:i,msUserSelect:i,webkitUserSelect:i,MozUserSelect:i})}function IS(e){var t=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*t}function bS(e,t){return e.getPropertyValue(t).split(",").map(function(e){return e.trim()})}function CS(e){var t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}}function AS(e,t,i){var n=e.top,r=e.bottom,o=e.left,s=e.right;return i>=n&&i<=r&&t>=o&&t<=s}function kS(e,t,i){e.top+=t,e.bottom=e.top+e.height,e.left+=i,e.right=e.left+e.width}function NS(e,t,i,n){var r=e.top,o=e.right,s=e.bottom,a=e.left,u=e.width*t,c=e.height*t;return n>r-c&&n<s+c&&i>a-u&&i<o+u}var _S=function(){function e(t,i){p(this,e),this._document=t,this._viewportRuler=i,this.positions=new Map}return S(e,[{key:"clear",value:function(){this.positions.clear()}},{key:"cache",value:function(e){var t=this;this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),e.forEach(function(e){t.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:CS(e)})})}},{key:"handleScroll",value:function(e){var t=e.target,i=this.positions.get(t);if(!i)return null;var n,r,o=t===this._document?t.documentElement:t,s=i.scrollPosition;if(t===this._document){var a=this._viewportRuler.getViewportScrollPosition();n=a.top,r=a.left}else n=t.scrollTop,r=t.scrollLeft;var u=s.top-n,c=s.left-r;return this.positions.forEach(function(e,i){e.clientRect&&t!==i&&o.contains(i)&&kS(e.clientRect,u,c)}),s.top=n,s.left=r,{top:u,left:c}}}]),e}();function wS(e){var t=e.cloneNode(!0),i=t.querySelectorAll("[id]"),n=e.nodeName.toLowerCase();t.removeAttribute("id");for(var r=0;r<i.length;r++)i[r].removeAttribute("id");return"canvas"===n?DS(e,t):("input"===n||"select"===n||"textarea"===n)&&MS(e,t),PS("canvas",e,t,DS),PS("input, textarea, select",e,t,MS),t}function PS(e,t,i,n){var r=t.querySelectorAll(e);if(r.length)for(var o=i.querySelectorAll(e),s=0;s<r.length;s++)n(r[s],o[s])}function MS(e,t){t.value=e.value}function DS(e,t){var i=t.getContext("2d");if(i)try{i.drawImage(e,0,0)}catch(n){}}var LS=vS({passive:!0}),xS=vS({passive:!1}),FS=function(){function e(t,i,n,r,o,s){var a=this;p(this,e),this._config=i,this._document=n,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=s,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new U,this._pointerMoveSubscription=C.EMPTY,this._pointerUpSubscription=C.EMPTY,this._scrollSubscription=C.EMPTY,this._resizeSubscription=C.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new U,this.started=new U,this.released=new U,this.ended=new U,this.entered=new U,this.exited=new U,this.dropped=new U,this.moved=this._moveEvents.asObservable(),this._pointerDown=function(e){if(a.beforeStarted.next(),a._handles.length){var t=a._handles.find(function(t){var i=e.target;return!!i&&(i===t||t.contains(i))});t&&!a._disabledHandles.has(t)&&!a.disabled&&a._initializeDragSequence(t,e)}else a.disabled||a._initializeDragSequence(a._rootElement,e)},this._pointerMove=function(e){e.preventDefault();var t=a._getPointerPositionOnPage(e);if(a._hasStartedDragging){a._boundaryElement&&(!a._previewRect||!a._previewRect.width&&!a._previewRect.height)&&(a._previewRect=(a._preview||a._rootElement).getBoundingClientRect());var i=a._getConstrainedPointerPosition(t);if(a._hasMoved=!0,a._lastKnownPointerPosition=t,a._updatePointerDirectionDelta(i),a._dropContainer)a._updateActiveDropContainer(i,t);else{var n=a._activeTransform;n.x=i.x-a._pickupPositionOnPage.x+a._passiveTransform.x,n.y=i.y-a._pickupPositionOnPage.y+a._passiveTransform.y,a._applyRootElementTransform(n.x,n.y),"undefined"!=typeof SVGElement&&a._rootElement instanceof SVGElement&&a._rootElement.setAttribute("transform","translate(".concat(n.x," ").concat(n.y,")"))}a._moveEvents.observers.length&&a._ngZone.run(function(){a._moveEvents.next({source:a,pointerPosition:i,event:e,distance:a._getDragDistance(i),delta:a._pointerDirectionDelta})})}else if(Math.abs(t.x-a._pickupPositionOnPage.x)+Math.abs(t.y-a._pickupPositionOnPage.y)>=a._config.dragStartThreshold){if(!(Date.now()>=a._dragStartTime+a._getDragStartDelay(e)))return void a._endDragSequence(e);(!a._dropContainer||!a._dropContainer.isDragging())&&(a._hasStartedDragging=!0,a._ngZone.run(function(){return a._startDragSequence(e)}))}},this._pointerUp=function(e){a._endDragSequence(e)},this.withRootElement(t),this._parentPositions=new _S(n,o),s.registerDragItem(this)}return S(e,[{key:"disabled",get:function(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)},set:function(e){var t=Hm(e);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions())}},{key:"getPlaceholderElement",value:function(){return this._placeholder}},{key:"getRootElement",value:function(){return this._rootElement}},{key:"getVisibleElement",value:function(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}},{key:"withHandles",value:function(e){return this._handles=e.map(function(e){return Gm(e)}),this._handles.forEach(function(e){return TS(e,!1)}),this._toggleNativeDragInteractions(),this}},{key:"withPreviewTemplate",value:function(e){return this._previewTemplate=e,this}},{key:"withPlaceholderTemplate",value:function(e){return this._placeholderTemplate=e,this}},{key:"withRootElement",value:function(e){var t=this,i=Gm(e);return i!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(function(){i.addEventListener("mousedown",t._pointerDown,xS),i.addEventListener("touchstart",t._pointerDown,LS)}),this._initialTransform=void 0,this._rootElement=i),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}},{key:"withBoundaryElement",value:function(e){var t=this;return this._boundaryElement=e?Gm(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(function(){return t._containInsideBoundaryOnResize()})),this}},{key:"dispose",value:function(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&GS(this._rootElement),GS(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}},{key:"isDragging",value:function(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}},{key:"reset",value:function(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}},{key:"disableHandle",value:function(e){this._handles.indexOf(e)>-1&&this._disabledHandles.add(e)}},{key:"enableHandle",value:function(e){this._disabledHandles.delete(e)}},{key:"withDirection",value:function(e){return this._direction=e,this}},{key:"_withDropContainer",value:function(e){this._dropContainer=e}},{key:"getFreeDragPosition",value:function(){var e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}},{key:"setFreeDragPosition",value:function(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}},{key:"_sortFromLastPointerPosition",value:function(){var e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}},{key:"_removeSubscriptions",value:function(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}},{key:"_destroyPreview",value:function(){this._preview&&GS(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}},{key:"_destroyPlaceholder",value:function(){this._placeholder&&GS(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}},{key:"_endDragSequence",value:function(e){var t=this;!this._dragDropRegistry.isDragging(this)||(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(function(){t._cleanupDragArtifacts(e),t._cleanupCachedDimensions(),t._dragDropRegistry.stopDragging(t)})):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(function(){t.ended.next({source:t,distance:t._getDragDistance(t._getPointerPositionOnPage(e))})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}},{key:"_startDragSequence",value:function(e){BS(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();var t=this._dropContainer;if(t){var i=this._rootElement,n=i.parentNode,r=this._preview=this._createPreviewElement(),o=this._placeholder=this._createPlaceholderElement(),s=this._anchor=this._anchor||this._document.createComment("");n.insertBefore(s,i),i.style.display="none",this._document.body.appendChild(n.replaceChild(o,i)),function(e){return e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement||e.body}(this._document).appendChild(r),this.started.next({source:this}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}},{key:"_initializeDragSequence",value:function(e,t){var i=this;t.stopPropagation();var n=this.isDragging(),r=BS(t),o=!r&&0!==t.button,s=this._rootElement,a=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(t.target&&t.target.draggable&&"mousedown"===t.type&&t.preventDefault(),!(n||o||a)){this._handles.length&&(this._rootElementTapHighlight=s.style.webkitTapHighlightColor||"",s.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe(function(e){i._updateOnScroll(e)}),this._boundaryElement&&(this._boundaryRect=CS(this._boundaryElement));var u=this._previewTemplate;this._pickupPositionInElement=u&&u.template&&!u.matchSize?{x:0,y:0}:this._getPointerPositionInElement(e,t);var c=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:c.x,y:c.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}}},{key:"_cleanupDragArtifacts",value:function(e){var t=this;this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run(function(){var i=t._dropContainer,n=i.getItemIndex(t),r=t._getPointerPositionOnPage(e),o=t._getDragDistance(t._getPointerPositionOnPage(e)),s=i._isOverContainer(r.x,r.y);t.ended.next({source:t,distance:o}),t.dropped.next({item:t,currentIndex:n,previousIndex:t._initialIndex,container:i,previousContainer:t._initialContainer,isPointerOverContainer:s,distance:o}),i.drop(t,n,t._initialContainer,s,o,t._initialIndex),t._dropContainer=t._initialContainer})}},{key:"_updateActiveDropContainer",value:function(e,t){var i=this,n=e.x,r=e.y,o=t.x,s=t.y,a=this._initialContainer._getSiblingContainerFromPosition(this,n,r);!a&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,r)&&(a=this._initialContainer),a&&a!==this._dropContainer&&this._ngZone.run(function(){i.exited.next({item:i,container:i._dropContainer}),i._dropContainer.exit(i),i._dropContainer=a,i._dropContainer.enter(i,n,r,a===i._initialContainer&&a.sortingDisabled?i._initialIndex:void 0),i.entered.next({item:i,container:a,currentIndex:a.getItemIndex(i)})}),this._dropContainer._startScrollingIfNecessary(o,s),this._dropContainer._sortItem(this,n,r,this._pointerDirectionDelta),this._preview.style.transform=US(n-this._pickupPositionInElement.x,r-this._pickupPositionInElement.y)}},{key:"_createPreviewElement",value:function(){var e,t=this._previewTemplate,i=this.previewClass,n=t?t.template:null;if(n&&t){var r=t.matchSize?this._rootElement.getBoundingClientRect():null,o=t.viewContainer.createEmbeddedView(n,t.context);o.detectChanges(),e=WS(o,this._document),this._previewRef=o,t.matchSize?VS(e,r):e.style.transform=US(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{var s=this._rootElement;VS(e=wS(s),s.getBoundingClientRect())}return OS(e.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:"".concat(this._config.zIndex||1e3)}),TS(e,!1),e.classList.add("cdk-drag-preview"),e.setAttribute("dir",this._direction),i&&(Array.isArray(i)?i.forEach(function(t){return e.classList.add(t)}):e.classList.add(i)),e}},{key:"_animatePreviewToPlaceholder",value:function(){var e=this;if(!this._hasMoved)return Promise.resolve();var t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=US(t.left,t.top);var i=function(e){var t=getComputedStyle(e),i=bS(t,"transition-property"),n=i.find(function(e){return"transform"===e||"all"===e});if(!n)return 0;var r=i.indexOf(n),o=bS(t,"transition-duration"),s=bS(t,"transition-delay");return IS(o[r])+IS(s[r])}(this._preview);return 0===i?Promise.resolve():this._ngZone.runOutsideAngular(function(){return new Promise(function(t){var n=function i(n){(!n||n.target===e._preview&&"transform"===n.propertyName)&&(e._preview.removeEventListener("transitionend",i),t(),clearTimeout(r))},r=setTimeout(n,1.5*i);e._preview.addEventListener("transitionend",n)})})}},{key:"_createPlaceholderElement",value:function(){var e,t=this._placeholderTemplate,i=t?t.template:null;return i?(this._placeholderRef=t.viewContainer.createEmbeddedView(i,t.context),this._placeholderRef.detectChanges(),e=WS(this._placeholderRef,this._document)):e=wS(this._rootElement),e.classList.add("cdk-drag-placeholder"),e}},{key:"_getPointerPositionInElement",value:function(e,t){var i=this._rootElement.getBoundingClientRect(),n=e===this._rootElement?null:e,r=n?n.getBoundingClientRect():i,o=BS(t)?t.targetTouches[0]:t,s=this._getViewportScrollPosition();return{x:r.left-i.left+(o.pageX-r.left-s.left),y:r.top-i.top+(o.pageY-r.top-s.top)}}},{key:"_getPointerPositionOnPage",value:function(e){var t=this._getViewportScrollPosition(),i=BS(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,n=i.pageX-t.left,r=i.pageY-t.top;if(this._ownerSVGElement){var o=this._ownerSVGElement.getScreenCTM();if(o){var s=this._ownerSVGElement.createSVGPoint();return s.x=n,s.y=r,s.matrixTransform(o.inverse())}}return{x:n,y:r}}},{key:"_getConstrainedPointerPosition",value:function(e){var t=this._dropContainer?this._dropContainer.lockAxis:null,i=this.constrainPosition?this.constrainPosition(e,this):e,n=i.x,r=i.y;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(n=this._pickupPositionOnPage.x),this._boundaryRect){var o=this._pickupPositionInElement,s=o.x,a=o.y,u=this._boundaryRect,c=this._previewRect,l=u.top+a,h=u.bottom-(c.height-a);n=HS(n,u.left+s,u.right-(c.width-s)),r=HS(r,l,h)}return{x:n,y:r}}},{key:"_updatePointerDirectionDelta",value:function(e){var t=e.x,i=e.y,n=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,o=Math.abs(t-r.x),s=Math.abs(i-r.y);return o>this._config.pointerDirectionChangeThreshold&&(n.x=t>r.x?1:-1,r.x=t),s>this._config.pointerDirectionChangeThreshold&&(n.y=i>r.y?1:-1,r.y=i),n}},{key:"_toggleNativeDragInteractions",value:function(){if(this._rootElement&&this._handles){var e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,TS(this._rootElement,e))}}},{key:"_removeRootElementListeners",value:function(e){e.removeEventListener("mousedown",this._pointerDown,xS),e.removeEventListener("touchstart",this._pointerDown,LS)}},{key:"_applyRootElementTransform",value:function(e,t){var i=US(e,t);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?i+" "+this._initialTransform:i}},{key:"_getDragDistance",value:function(e){var t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}},{key:"_cleanupCachedDimensions",value:function(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}},{key:"_containInsideBoundaryOnResize",value:function(){var e=this._passiveTransform,t=e.x,i=e.y;if(!(0===t&&0===i||this.isDragging())&&this._boundaryElement){var n=this._boundaryElement.getBoundingClientRect(),r=this._rootElement.getBoundingClientRect();if(!(0===n.width&&0===n.height||0===r.width&&0===r.height)){var o=n.left-r.left,s=r.right-n.right,a=n.top-r.top,u=r.bottom-n.bottom;n.width>r.width?(o>0&&(t+=o),s>0&&(t-=s)):t=0,n.height>r.height?(a>0&&(i+=a),u>0&&(i-=u)):i=0,(t!==this._passiveTransform.x||i!==this._passiveTransform.y)&&this.setFreeDragPosition({y:i,x:t})}}}},{key:"_getDragStartDelay",value:function(e){var t=this.dragStartDelay;return"number"==typeof t?t:BS(e)?t.touch:t?t.mouse:0}},{key:"_updateOnScroll",value:function(e){var t=this._parentPositions.handleScroll(e);if(t){var i=e.target;this._boundaryRect&&(i===this._document||i!==this._boundaryElement&&i.contains(this._boundaryElement))&&kS(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}},{key:"_getViewportScrollPosition",value:function(){var e=this._parentPositions.positions.get(this._document);return e?e.scrollPosition:this._viewportRuler.getViewportScrollPosition()}}]),e}();function US(e,t){return"translate3d(".concat(Math.round(e),"px, ").concat(Math.round(t),"px, 0)")}function HS(e,t,i){return Math.max(t,Math.min(i,e))}function GS(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function BS(e){return"t"===e.type[0]}function WS(e,t){var i=e.rootNodes;if(1===i.length&&i[0].nodeType===t.ELEMENT_NODE)return i[0];var n=t.createElement("div");return i.forEach(function(e){return n.appendChild(e)}),n}function VS(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px"),e.style.transform=US(t.left,t.top)}function zS(e,t,i){var n=YS(t,e.length-1),r=YS(i,e.length-1);if(n!==r){for(var o=e[n],s=r<n?-1:1,a=n;a!==r;a+=s)e[a]=e[a+s];e[r]=o}}function YS(e,t){return Math.max(0,Math.min(t,e))}var jS=function(){function e(t,i,n,r,o){var s=this;p(this,e),this._dragDropRegistry=i,this._ngZone=r,this._viewportRuler=o,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=function(){return!0},this.beforeStarted=new U,this.entered=new U,this.exited=new U,this.dropped=new U,this.sorted=new U,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=C.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new U,this._cachedShadowRoot=null,this._startScrollInterval=function(){s._stopScrolling(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jm;return(!iS(e)||e<0)&&(e=0),(!t||"function"!=typeof t.schedule)&&(t=Jm),new M(function(i){return i.add(t.schedule(RS,e,{subscriber:i,counter:0,period:e})),i})}(0,jm).pipe(oS(s._stopScrollTimers)).subscribe(function(){var e=s._scrollNode;1===s._verticalScrollDirection?QS(e,-2):2===s._verticalScrollDirection&&QS(e,2),1===s._horizontalScrollDirection?qS(e,-2):2===s._horizontalScrollDirection&&qS(e,2)})},this.element=Gm(t),this._document=n,this.withScrollableParents([this.element]),i.registerDropContainer(this),this._parentPositions=new _S(n,o)}return S(e,[{key:"dispose",value:function(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}},{key:"isDragging",value:function(){return this._isDragging}},{key:"start",value:function(){var e=this,t=Gm(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach(function(t){return t._startReceiving(e)}),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}},{key:"enter",value:function(e,t,i,n){var r;this.start(),null==n?-1===(r=this.sortingDisabled?this._draggables.indexOf(e):-1)&&(r=this._getItemIndexFromPointerPosition(e,t,i)):r=n;var o=this._activeDraggables,s=o.indexOf(e),a=e.getPlaceholderElement(),u=o[r];if(u===e&&(u=o[r+1]),s>-1&&o.splice(s,1),u&&!this._dragDropRegistry.isDragging(u)){var c=u.getRootElement();c.parentElement.insertBefore(a,c),o.splice(r,0,e)}else if(this._shouldEnterAsFirstChild(t,i)){var l=o[0].getRootElement();l.parentNode.insertBefore(a,l),o.unshift(e)}else Gm(this.element).appendChild(a),o.push(e);a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}},{key:"exit",value:function(e){this._reset(),this.exited.next({item:e,container:this})}},{key:"drop",value:function(e,t,i,n,r,o){this._reset(),null==o&&(o=i.getItemIndex(e)),this.dropped.next({item:e,currentIndex:t,previousIndex:o,container:this,previousContainer:i,isPointerOverContainer:n,distance:r})}},{key:"withItems",value:function(e){var t=this,i=this._draggables;return this._draggables=e,e.forEach(function(e){return e._withDropContainer(t)}),this.isDragging()&&(i.filter(function(e){return e.isDragging()}).every(function(t){return-1===e.indexOf(t)})?this._reset():this._cacheItems()),this}},{key:"withDirection",value:function(e){return this._direction=e,this}},{key:"connectedTo",value:function(e){return this._siblings=e.slice(),this}},{key:"withOrientation",value:function(e){return this._orientation=e,this}},{key:"withScrollableParents",value:function(e){var t=Gm(this.element);return this._scrollableElements=-1===e.indexOf(t)?[t].concat(i(e)):e.slice(),this}},{key:"getScrollableParents",value:function(){return this._scrollableElements}},{key:"getItemIndex",value:function(e){return this._isDragging?KS("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,function(t){return t.drag===e}):this._draggables.indexOf(e)}},{key:"isReceiving",value:function(){return this._activeSiblings.size>0}},{key:"_sortItem",value:function(e,t,i,n){if(!this.sortingDisabled&&NS(this._clientRect,.05,t,i)){var r=this._itemPositions,o=this._getItemIndexFromPointerPosition(e,t,i,n);if(!(-1===o&&r.length>0)){var s="horizontal"===this._orientation,a=KS(r,function(t){return t.drag===e}),u=r[o],c=u.clientRect,l=a>o?1:-1,h=this._getItemOffsetPx(r[a].clientRect,c,l),d=this._getSiblingOffsetPx(a,r,l),g=r.slice();zS(r,a,o),this.sorted.next({previousIndex:a,currentIndex:o,container:this,item:e}),r.forEach(function(t,i){if(g[i]!==t){var n=t.drag===e,r=n?h:d,o=n?e.getPlaceholderElement():t.drag.getRootElement();t.offset+=r,s?(o.style.transform="translate3d(".concat(Math.round(t.offset),"px, 0, 0)"),kS(t.clientRect,0,r)):(o.style.transform="translate3d(0, ".concat(Math.round(t.offset),"px, 0)"),kS(t.clientRect,r,0))}}),this._previousSwap.overlaps=AS(c,t,i),this._previousSwap.drag=u.drag,this._previousSwap.delta=s?n.x:n.y}}}},{key:"_startScrollingIfNecessary",value:function(e,i){var n=this;if(!this.autoScrollDisabled){var r,o=0,s=0;if(this._parentPositions.positions.forEach(function(a,u){var c;u===n._document||!a.clientRect||r||NS(a.clientRect,.05,e,i)&&(c=t(function(e,t,i,n){var r=XS(t,n),o=ZS(t,i),s=0,a=0;if(r){var u=e.scrollTop;1===r?u>0&&(s=1):e.scrollHeight-u>e.clientHeight&&(s=2)}if(o){var c=e.scrollLeft;1===o?c>0&&(a=1):e.scrollWidth-c>e.clientWidth&&(a=2)}return[s,a]}(u,a.clientRect,e,i),2),o=c[0],s=c[1],(o||s)&&(r=u))}),!o&&!s){var a=this._viewportRuler.getViewportSize(),u=a.width,c=a.height,l={width:u,height:c,top:0,right:u,bottom:c,left:0};o=XS(l,i),s=ZS(l,e),r=window}r&&(o!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||r!==this._scrollNode)&&(this._verticalScrollDirection=o,this._horizontalScrollDirection=s,this._scrollNode=r,(o||s)&&r?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}}},{key:"_stopScrolling",value:function(){this._stopScrollTimers.next()}},{key:"_cacheParentPositions",value:function(){var e=Gm(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(e).clientRect}},{key:"_cacheItemPositions",value:function(){var e="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(function(e){var t=e.getVisibleElement();return{drag:e,offset:0,clientRect:CS(t)}}).sort(function(t,i){return e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top})}},{key:"_reset",value:function(){var e=this;this._isDragging=!1;var t=Gm(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(function(e){var t=e.getRootElement();t&&(t.style.transform="")}),this._siblings.forEach(function(t){return t._stopReceiving(e)}),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}},{key:"_getSiblingOffsetPx",value:function(e,t,i){var n="horizontal"===this._orientation,r=t[e].clientRect,o=t[e+-1*i],s=r[n?"width":"height"]*i;if(o){var a=n?"left":"top",u=n?"right":"bottom";-1===i?s-=o.clientRect[a]-r[u]:s+=r[a]-o.clientRect[u]}return s}},{key:"_getItemOffsetPx",value:function(e,t,i){var n="horizontal"===this._orientation,r=n?t.left-e.left:t.top-e.top;return-1===i&&(r+=n?t.width-e.width:t.height-e.height),r}},{key:"_shouldEnterAsFirstChild",value:function(e,t){if(!this._activeDraggables.length)return!1;var i=this._itemPositions,n="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){var r=i[i.length-1].clientRect;return n?e>=r.right:t>=r.bottom}var o=i[0].clientRect;return n?e<=o.left:t<=o.top}},{key:"_getItemIndexFromPointerPosition",value:function(e,t,i,n){var r=this,o="horizontal"===this._orientation;return KS(this._itemPositions,function(s,a,u){var c=s.drag,l=s.clientRect;if(c===e)return u.length<2;if(n){var h=o?n.x:n.y;if(c===r._previousSwap.drag&&r._previousSwap.overlaps&&h===r._previousSwap.delta)return!1}return o?t>=Math.floor(l.left)&&t<Math.floor(l.right):i>=Math.floor(l.top)&&i<Math.floor(l.bottom)})}},{key:"_cacheItems",value:function(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}},{key:"_isOverContainer",value:function(e,t){return AS(this._clientRect,e,t)}},{key:"_getSiblingContainerFromPosition",value:function(e,t,i){return this._siblings.find(function(n){return n._canReceive(e,t,i)})}},{key:"_canReceive",value:function(e,t,i){if(!AS(this._clientRect,t,i)||!this.enterPredicate(e,this))return!1;var n=this._getShadowRoot().elementFromPoint(t,i);if(!n)return!1;var r=Gm(this.element);return n===r||r.contains(n)}},{key:"_startReceiving",value:function(e){var t=this._activeSiblings;t.has(e)||(t.add(e),this._cacheParentPositions(),this._listenToScrollEvents())}},{key:"_stopReceiving",value:function(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe()}},{key:"_listenToScrollEvents",value:function(){var e=this;this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe(function(t){if(e.isDragging()){var i=e._parentPositions.handleScroll(t);i&&(e._itemPositions.forEach(function(e){kS(e.clientRect,i.top,i.left)}),e._itemPositions.forEach(function(t){var i=t.drag;e._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()}))}else e.isReceiving()&&e._cacheParentPositions()})}},{key:"_getShadowRoot",value:function(){if(!this._cachedShadowRoot){var e=function(e){if(function(){if(null==gS){var e="undefined"!=typeof document?document.head:null;gS=!(!e||!e.createShadowRoot&&!e.attachShadow)}return gS}()){var t=e.getRootNode?e.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(Gm(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}}]),e}();function KS(e,t){for(var i=0;i<e.length;i++)if(t(e[i],i,e))return i;return-1}function QS(e,t){e===window?e.scrollBy(0,t):e.scrollTop+=t}function qS(e,t){e===window?e.scrollBy(t,0):e.scrollLeft+=t}function XS(e,t){var i=e.top,n=e.bottom,r=.05*e.height;return t>=i-r&&t<=i+r?1:t>=n-r&&t<=n+r?2:0}function ZS(e,t){var i=e.left,n=e.right,r=.05*e.width;return t>=i-r&&t<=i+r?1:t>=n-r&&t<=n+r?2:0}var $S=vS({passive:!1,capture:!0}),JS=function(){var e=function(){function e(t,i){var n=this;p(this,e),this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new U,this.pointerUp=new U,this.scroll=new U,this._preventDefaultWhileDragging=function(e){n._activeDragInstances.size&&e.preventDefault()},this._document=i}return S(e,[{key:"registerDropContainer",value:function(e){this._dropInstances.has(e)||this._dropInstances.add(e)}},{key:"registerDragItem",value:function(e){var t=this;this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(function(){t._document.addEventListener("touchmove",t._preventDefaultWhileDragging,$S)})}},{key:"removeDropContainer",value:function(e){this._dropInstances.delete(e)}},{key:"removeDragItem",value:function(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,$S)}},{key:"startDragging",value:function(e,t){var i=this;if(!this._activeDragInstances.has(e)&&(this._activeDragInstances.add(e),1===this._activeDragInstances.size)){var n=t.type.startsWith("touch"),r=n?"touchend":"mouseup";this._globalListeners.set(n?"touchmove":"mousemove",{handler:function(e){return i.pointerMove.next(e)},options:$S}).set(r,{handler:function(e){return i.pointerUp.next(e)},options:!0}).set("scroll",{handler:function(e){return i.scroll.next(e)},options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:$S}),this._ngZone.runOutsideAngular(function(){i._globalListeners.forEach(function(e,t){i._document.addEventListener(t,e.handler,e.options)})})}}},{key:"stopDragging",value:function(e){this._activeDragInstances.delete(e),0===this._activeDragInstances.size&&this._clearGlobalListeners()}},{key:"isDragging",value:function(e){return this._activeDragInstances.has(e)}},{key:"ngOnDestroy",value:function(){var e=this;this._dragInstances.forEach(function(t){return e.removeDragItem(t)}),this._dropInstances.forEach(function(t){return e.removeDropContainer(t)}),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}},{key:"_clearGlobalListeners",value:function(){var e=this;this._globalListeners.forEach(function(t,i){e._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(wc),An(cl))},e.\u0275prov=be({factory:function(){return new e(An(wc),An(cl))},token:e,providedIn:"root"}),e}(),eE={dragStartThreshold:5,pointerDirectionChangeThreshold:5},tE=function(){var e=function(){function e(t,i,n,r){p(this,e),this._document=t,this._ngZone=i,this._viewportRuler=n,this._dragDropRegistry=r}return S(e,[{key:"createDrag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eE;return new FS(e,t,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}},{key:"createDropList",value:function(e){return new jS(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(cl),An(wc),An(ES),An(JS))},e.\u0275prov=be({factory:function(){return new e(An(cl),An(wc),An(ES),An(JS))},token:e,providedIn:"root"}),e}(),iE=new an("CdkDropListGroup"),nE=new an("CDK_DRAG_CONFIG"),rE=0,oE=new an("CdkDropList"),sE=function(){var e=function(){function e(t,i,n,r,o,s,a){var u=this;p(this,e),this.element=t,this._changeDetectorRef=n,this._dir=r,this._group=o,this._scrollDispatcher=s,this._destroyed=new U,this.connectedTo=[],this.id="cdk-drop-list-"+rE++,this.enterPredicate=function(){return!0},this.dropped=new Yu,this.entered=new Yu,this.exited=new Yu,this.sorted=new Yu,this._unsortedItems=new Set,this._dropListRef=i.createDropList(t),this._dropListRef.data=this,a&&this._assignDefaults(a),this._dropListRef.enterPredicate=function(e,t){return u.enterPredicate(e.data,t.data)},this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),o&&o._items.add(this)}return S(e,[{key:"disabled",get:function(){return this._disabled||!!this._group&&this._group.disabled},set:function(e){this._dropListRef.disabled=this._disabled=Hm(e)}},{key:"addItem",value:function(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}},{key:"removeItem",value:function(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}},{key:"getSortedItems",value:function(){return Array.from(this._unsortedItems).sort(function(e,t){return e._dragRef.getVisibleElement().compareDocumentPosition(t._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1})}},{key:"ngOnDestroy",value:function(){var t=e._dropLists.indexOf(this);t>-1&&e._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}},{key:"_setupInputSyncSubscription",value:function(t){var i=this;this._dir&&this._dir.change.pipe(td(this._dir.value),oS(this._destroyed)).subscribe(function(e){return t.withDirection(e)}),t.beforeStarted.subscribe(function(){var n=function(e){return Array.isArray(e)?e:[e]}(i.connectedTo).map(function(t){if("string"==typeof t){var i=e._dropLists.find(function(e){return e.id===t});return!i&&zc()&&console.warn('CdkDropList could not find connected drop list with id "'.concat(t,'"')),i}return t});if(i._group&&i._group._items.forEach(function(e){-1===n.indexOf(e)&&n.push(e)}),!i._scrollableParentsResolved&&i._scrollDispatcher){var r=i._scrollDispatcher.getAncestorScrollContainers(i.element).map(function(e){return e.getElementRef().nativeElement});i._dropListRef.withScrollableParents(r),i._scrollableParentsResolved=!0}t.disabled=i.disabled,t.lockAxis=i.lockAxis,t.sortingDisabled=Hm(i.sortingDisabled),t.autoScrollDisabled=Hm(i.autoScrollDisabled),t.connectedTo(n.filter(function(e){return e&&e!==i}).map(function(e){return e._dropListRef})).withOrientation(i.orientation)})}},{key:"_handleEvents",value:function(e){var t=this;e.beforeStarted.subscribe(function(){t._syncItemsWithRef(),t._changeDetectorRef.markForCheck()}),e.entered.subscribe(function(e){t.entered.emit({container:t,item:e.item.data,currentIndex:e.currentIndex})}),e.exited.subscribe(function(e){t.exited.emit({container:t,item:e.item.data}),t._changeDetectorRef.markForCheck()}),e.sorted.subscribe(function(e){t.sorted.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,container:t,item:e.item.data})}),e.dropped.subscribe(function(e){t.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,item:e.item.data,isPointerOverContainer:e.isPointerOverContainer,distance:e.distance}),t._changeDetectorRef.markForCheck()})}},{key:"_assignDefaults",value:function(e){var t=e.lockAxis,i=e.draggingDisabled,n=e.sortingDisabled,r=e.listAutoScrollDisabled,o=e.listOrientation;this.disabled=null!=i&&i,this.sortingDisabled=null!=n&&n,this.autoScrollDisabled=null!=r&&r,this.orientation=o||"vertical",t&&(this.lockAxis=t)}},{key:"_syncItemsWithRef",value:function(){this._dropListRef.withItems(this.getSortedItems().map(function(e){return e._dragRef}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ua),Bs(tE),Bs(cu),Bs(mS,8),Bs(iE,12),Bs(SS),Bs(nE,8))},e.\u0275dir=ut({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(e,t){2&e&&(pa("id",t.id),sa("cdk-drop-list-disabled",t.disabled)("cdk-drop-list-dragging",t._dropListRef.isDragging())("cdk-drop-list-receiving",t._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Pa([{provide:iE,useValue:void 0},{provide:oE,useExisting:e}])]}),e._dropLists=[],e}(),aE=new an("CDK_DRAG_PARENT"),uE=new an("CdkDragHandle"),cE=new an("CdkDragPlaceholder"),lE=new an("CdkDragPreview"),hE=function(){var e=function(){function e(t,i,n,r,o,s,a,u,c,l){var h=this;p(this,e),this.element=t,this.dropContainer=i,this._document=n,this._ngZone=r,this._viewContainerRef=o,this._dir=a,this._changeDetectorRef=c,this._selfHandle=l,this._destroyed=new U,this.started=new Yu,this.released=new Yu,this.ended=new Yu,this.entered=new Yu,this.exited=new Yu,this.dropped=new Yu,this.moved=new M(function(e){var t=h._dragRef.moved.pipe(B(function(e){return{source:h,pointerPosition:e.pointerPosition,event:e.event,delta:e.delta,distance:e.distance}})).subscribe(e);return function(){t.unsubscribe()}}),this._dragRef=u.createDrag(t,{dragStartThreshold:s&&null!=s.dragStartThreshold?s.dragStartThreshold:5,pointerDirectionChangeThreshold:s&&null!=s.pointerDirectionChangeThreshold?s.pointerDirectionChangeThreshold:5,zIndex:null==s?void 0:s.zIndex}),this._dragRef.data=this,s&&this._assignDefaults(s),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}return S(e,[{key:"disabled",get:function(){return this._disabled||this.dropContainer&&this.dropContainer.disabled},set:function(e){this._disabled=Hm(e),this._dragRef.disabled=this._disabled}},{key:"getPlaceholderElement",value:function(){return this._dragRef.getPlaceholderElement()}},{key:"getRootElement",value:function(){return this._dragRef.getRootElement()}},{key:"reset",value:function(){this._dragRef.reset()}},{key:"getFreeDragPosition",value:function(){return this._dragRef.getFreeDragPosition()}},{key:"ngAfterViewInit",value:function(){var e=this;this._ngZone.onStable.asObservable().pipe($h(1),oS(this._destroyed)).subscribe(function(){e._updateRootElement(),e._handles.changes.pipe(td(e._handles),Id(function(t){var i=t.filter(function(t){return t._parentDrag===e}).map(function(e){return e.element});e._selfHandle&&e.rootElementSelector&&i.push(e.element),e._dragRef.withHandles(i)}),Qh(function(e){return oe.apply(void 0,i(e.map(function(e){return e._stateChanges.pipe(td(e))})))}),oS(e._destroyed)).subscribe(function(t){var i=e._dragRef,n=t.element.nativeElement;t.disabled?i.disableHandle(n):i.enableHandle(n)}),e.freeDragPosition&&e._dragRef.setFreeDragPosition(e.freeDragPosition)})}},{key:"ngOnChanges",value:function(e){var t=e.rootElementSelector,i=e.freeDragPosition;t&&!t.firstChange&&this._updateRootElement(),i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}},{key:"ngOnDestroy",value:function(){this.dropContainer&&this.dropContainer.removeItem(this),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()}},{key:"_updateRootElement",value:function(){var e=this.element.nativeElement,t=this.rootElementSelector?dE(e,this.rootElementSelector):e;if(t&&t.nodeType!==this._document.ELEMENT_NODE)throw Error('cdkDrag must be attached to an element node. Currently attached to "'.concat(t.nodeName,'".'));this._dragRef.withRootElement(t||e)}},{key:"_getBoundaryElement",value:function(){var e=this.boundaryElement;if(!e)return null;if("string"==typeof e)return dE(this.element.nativeElement,e);var t=Gm(e);if(zc()&&!t.contains(this.element.nativeElement))throw Error("Draggable element is not inside of the node passed into cdkDragBoundary.");return t}},{key:"_syncInputs",value:function(e){var t=this;e.beforeStarted.subscribe(function(){if(!e.isDragging()){var i=t._dir,n=t.dragStartDelay,r=t._placeholderTemplate?{template:t._placeholderTemplate.templateRef,context:t._placeholderTemplate.data,viewContainer:t._viewContainerRef}:null,o=t._previewTemplate?{template:t._previewTemplate.templateRef,context:t._previewTemplate.data,matchSize:t._previewTemplate.matchSize,viewContainer:t._viewContainerRef}:null;e.disabled=t.disabled,e.lockAxis=t.lockAxis,e.dragStartDelay="object"==typeof n&&n?n:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}(n),e.constrainPosition=t.constrainPosition,e.previewClass=t.previewClass,e.withBoundaryElement(t._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(o),i&&e.withDirection(i.value)}})}},{key:"_handleEvents",value:function(e){var t=this;e.started.subscribe(function(){t.started.emit({source:t}),t._changeDetectorRef.markForCheck()}),e.released.subscribe(function(){t.released.emit({source:t})}),e.ended.subscribe(function(e){t.ended.emit({source:t,distance:e.distance}),t._changeDetectorRef.markForCheck()}),e.entered.subscribe(function(e){t.entered.emit({container:e.container.data,item:t,currentIndex:e.currentIndex})}),e.exited.subscribe(function(e){t.exited.emit({container:e.container.data,item:t})}),e.dropped.subscribe(function(e){t.dropped.emit({previousIndex:e.previousIndex,currentIndex:e.currentIndex,previousContainer:e.previousContainer.data,container:e.container.data,isPointerOverContainer:e.isPointerOverContainer,item:t,distance:e.distance})})}},{key:"_assignDefaults",value:function(e){var t=e.lockAxis,i=e.dragStartDelay,n=e.constrainPosition,r=e.previewClass,o=e.boundaryElement,s=e.draggingDisabled,a=e.rootElementSelector;this.disabled=null!=s&&s,this.dragStartDelay=i||0,t&&(this.lockAxis=t),n&&(this.constrainPosition=n),r&&(this.previewClass=r),o&&(this.boundaryElement=o),a&&(this.rootElementSelector=a)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ua),Bs(oE,12),Bs(cl),Bs(wc),Bs(yu),Bs(nE,8),Bs(mS,8),Bs(tE),Bs(cu),Bs(uE,10))},e.\u0275dir=ut({type:e,selectors:[["","cdkDrag",""]],contentQueries:function(e,t,i){var n;(1&e&&(oc(i,lE,5),oc(i,cE,5),oc(i,uE,5)),2&e)&&(nc(n=sc())&&(t._previewTemplate=n.first),nc(n=sc())&&(t._placeholderTemplate=n.first),nc(n=sc())&&(t._handles=n))},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(e,t){2&e&&sa("cdk-drag-disabled",t.disabled)("cdk-drag-dragging",t._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Pa([{provide:aE,useExisting:e}]),Rt]}),e}();function dE(e,t){for(var i=e.parentElement;i;){if(i.matches?i.matches(t):i.msMatchesSelector(t))return i;i=i.parentElement}return null}var gE=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({providers:[tE],imports:[yS]}),e}(),fE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;return p(this,i),(e=t.call(this,r,Pv.CONSTRUCTION,n,um.CONSTRUCTION_SITE,h,1===c,!0,c,l,a,s)).region=o,e.buildingSize=u,e.upgradeLevel=c,e.data=d,e.servicesService&&(e.resourcesService=e.servicesService.getResourcesService(),e.buildingFactoryService=e.servicesService.getService(Zv.BUILDING_FACTORY),e.regionService=e.servicesService.getServiceByRegion(o)),e}return S(i,[{key:"isUpgrade",value:function(){return 1!==this.upgradeLevel}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:return this.isUpgrade()?Mm.textValue("upgrading "+Qv.prepareBuildingName(this.workingAt)):Mm.textValue("constructing "+Qv.prepareBuildingName(this.workingAt));case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(){0===this.buildingComplexity&&(this.isUpgrade()?this.regionService.finishUpgrade(this,this.workingAt):this.regionService.finishConstruction(this,this.workingAt)),this.progress>=100&&(this.isUpgrade()?this.regionService.finishUpgrade(this,this.workingAt):this.regionService.finishConstruction(this,this.workingAt)),this.working&&(this.progress<100?(this.progress+=this.getPower()/this.buildingComplexity,this.progress>100&&(this.progress=100)):this.isUpgrade()?this.regionService.finishUpgrade(this,this.workingAt):this.regionService.finishConstruction(this,this.workingAt))}},{key:"build",value:function(){return!this.startProduction()&&0!==this.buildingComplexity&&this.servicesService.getModalService().info("Couldn't unlock construction. Not enough free workers."),this}},{key:"toJSON",value:function(){return{id:this.id,upgradeLevel:this.upgradeLevel,buildingType:this.buildingType,region:this.region,constructing:this.workingAt,buildingComplexity:this.buildingComplexity,progress:this.progress,working:this.working,buildingSize:this.buildingSize,data:this.data}}},{key:"getSize",value:function(){return this.buildingSize}},{key:"finishDemolish",value:function(){var e=this;Array.from(this.buildingFactoryService.createBuildingShell(this.workingAt).getCost().entries()).forEach(function(t){return e.resourcesService.increaseResource(t[0],Math.floor(t[1]*(1-e.progress/100)+t[1]*(e.progress/100*.3)),"Cancel construction")})}},{key:"getBuildingData",value:function(){return this.data}}]),i}(Fm),vE=function(){function e(t,i,n,r,o,s,a){p(this,e),this.buildings=[],this.filterBuilding=Pv.ALL,this.filterWorking=qv.ALL,this.thisRegion=s,this.buildingFactoryService=t,this.resourcesService=i,this.servicesService=n,this.landService=r,this.idService=o,i.addCallback(this,s),n.addService(a,this)}return S(e,[{key:"init",value:function(){}},{key:"getBuildings",value:function(){return this.buildings}},{key:"tick",value:function(e){this.shuffleArray(this.buildings).forEach(function(t){return t.tick(e)})}},{key:"shuffleArray",value:function(e){for(var t=e.slice(),i=t.length-1;i>0;i--){var n=Math.floor(Math.random()*(i+1)),r=[t[n],t[i]];t[i]=r[0],t[n]=r[1]}return t}},{key:"getName",value:function(){return"AbstractRegionService"}},{key:"save",value:function(){return{buildings:this.buildings,filterBuilding:this.filterBuilding,filterWorking:this.filterWorking}}},{key:"reset",value:function(e,t){this.buildings=[],this.filterBuilding=Pv.ALL,this.filterWorking=qv.ALL,this.init()}},{key:"load",value:function(e){this.buildings=[],this.filterBuilding=void 0!==e.filterBuilding?e.filterBuilding:Pv.ALL,this.filterWorking=void 0!==e.filterWorking?e.filterWorking:qv.ALL;var t,i=n(e.buildings);try{for(i.s();!(t=i.n()).done;){var r=t.value;-1===r.id&&(r.id=this.idService.getNextId()),this.buildings.push(this.buildingFactoryService.loadBuilding(r))}}catch(o){i.e(o)}finally{i.f()}}},{key:"getFilterBuilding",value:function(){return this.filterBuilding}},{key:"setFilterBuildings",value:function(e){this.filterBuilding=e}},{key:"setFilterWorking",value:function(e){this.filterWorking=e}},{key:"getFilterWorking",value:function(){return this.filterWorking}},{key:"getUnemployed",value:function(){return this.resourcesService.getPeople()}},{key:"finishConstruction",value:function(e,t){var i=this.buildings.indexOf(e);-1!==i&&(this.buildings[i].stopProduction(),this.buildings[i]=this.buildingFactoryService.createBuilding(t,this.buildings[i].getBuildingId()))}},{key:"createConstruction",value:function(e){this.buildings.push(e)}},{key:"demolish",value:function(e){var t=this.buildings.indexOf(e);-1!==t&&(this.buildings[t].getBuildingType()===Pv.CONSTRUCTION?(this.buildings[t].stopProduction(),this.buildings[t].finishDemolish(),this.landService.increaseLand(this.buildings[t].getSize()),this.buildings.splice(t,1)):this.buildings[t]=new Um(this.servicesService,this.buildings[t].getBuildingId(),this.thisRegion,this.buildings[t].getBuildingType(),this.buildings[t].getComplexity(),this.buildings[t].getSize()).build())}},{key:"finishDeconstruction",value:function(e){var t=this.buildings.indexOf(e);-1!==t&&(this.buildings[t].stopProduction(),this.buildingFactoryService.createBuildingShell(this.buildings[t].getBuildingBeingDemolished()).finishDemolish(),this.landService.increaseLand(this.buildings[t].getSize()),this.buildings.splice(t,1))}},{key:"finishUpgrade",value:function(e,t){var i=this.buildings.indexOf(e);if(-1!==i){this.buildings[i].stopProduction();var n=this.buildingFactoryService.createBuildingShell(t,this.buildings[i].getBuildingId());n.getUpgradeSettings().NEW_BUILDING&&(n=this.buildingFactoryService.createBuildingShell(n.getUpgradeSettings().NEW_BUILDING,this.buildings[i].getBuildingId())),n.setBuildingData(this.buildings[i].getBuildingData()),n.setBuildingLevel(this.buildings[i].getBuildingLevel()),n.build(),this.buildings[i]=n}}},{key:"fireRandomWorker",value:function(){var e=this.buildings.filter(function(e){return void 0===e.getOccupants&&e.isWorking()&&e.getWorkers()>0});if(e.length>0){var t=Math.floor(Math.random()*e.length);return e[t].fireWorker(),this.servicesService.getManagementService().getLogFiredWorkers()&&this.servicesService.getLogService().warning("Worker removed from "+e[t].getName()),!0}return!1}},{key:"moveBuildingInList",value:function(e,t){zS(this.buildings,e,t)}},{key:"moveBuildingInListByBuildingId",value:function(e,t){var i=this.buildings.findIndex(function(t){return e===t.getBuildingId()}),n=this.buildings.findIndex(function(e){return t===e.getBuildingId()});zS(this.buildings,i,n)}},{key:"canCombine",value:function(e){if(this.buildings.filter(function(e){return e.isCombinable()}).length>1)return this.toCombine?this.toCombine!==e&&this.toCombine.getBuildingType()===e.getBuildingType():!!this.buildings.find(function(t){return t!==e&&t.getBuildingType()===e.getBuildingType()})}},{key:"combine",value:function(e){if(!this.toCombine)return this.toCombine=e,!1;e.combine(this.toCombine,this)}},{key:"finaliseCombine",value:function(e){if(e){var t=this.buildings.indexOf(this.toCombine);if(t>=0)return this.buildings[t].prepareDemolish()?(this.toCombine=null,this.buildings.splice(t,1),!0):(this.toCombine=null,!1)}else this.toCombine=null}},{key:"clearCombineMode",value:function(){this.toCombine=null}},{key:"split",value:function(e){e.isSplittable()&&e.split(this)}},{key:"finaliseSplit",value:function(e){this.buildings.push(e)}},{key:"addBuilding",value:function(e){this.buildings.push(this.buildingFactoryService.createBuilding(e))}},{key:"upgradeBuilding",value:function(e){var t=this,i=this.buildings.find(function(t){return t.getBuildingId()===e}),n=this.servicesService.getModalService(),r=this.servicesService.getVillageService();if(i)if(i.hasUpgrade())if(i.getOccupants)if(void 0!==i.getMaxSize&&r.getPopulation()>r.getPopulationCap()-i.getMaxSize()){n.open(_v.CONFIRM),n.setModalText("You don't have enough housing space to move this building occupants.<br> People that won't find new home will leave the village<br>Do you still want to upgrade this building?");var o=n.registerForConfirmation().subscribe(function(e){o.unsubscribe(),e&&t.upgrade(i,n)})}else this.upgrade(i,n);else this.upgrade(i,n);else n.info("This building cannot be upgraded");else n.info("Error! Building not found")}},{key:"upgrade",value:function(e,t){if(!e.getUpgradeSettings().SIZE||this.landService.hasLand(e.getUpgradeSettings().SIZE))if(this.resourcesService.hasResources(e.getUpgradeCost(),"Upgrade",1,!0)){this.landService.decreaseLand(e.getUpgradeSettings().SIZE),this.resourcesService.decreaseResources(e.getUpgradeCost(),"Upgrade",!0);var i=this.buildings.indexOf(e),n=um.getBuilding(e.getBuildingType());e.stopProduction();var r=new fE(this.servicesService,e.getBuildingId(),this.thisRegion,e.getBuildingType(),n.UPGRADES[e.getBuildingLevel()-1].COMPLEXITY,e.getSize(),e.getBuildingLevel()+1,0,!1,e.getBuildingData()).build();e.prepareDemolish(),this.buildings[i]=r}else t.info("Not enough resources to upgrade!");else t.info("Not enough empty land to upgrade!")}},{key:"move",value:function(e){if(!this.toArrange)return this.toArrange=e,!1;this.moveBuildingInListByBuildingId(this.toArrange.getBuildingId(),e.getBuildingId()),this.toArrange=null}},{key:"canMove",value:function(e){return!(this.toArrange&&e.getBuildingId()===this.toArrange.getBuildingId())}},{key:"autoSort",value:function(){for(var e=this,t=[],i=this.buildings,n=function(){var i=e.buildings[0].getBuildingType();if(i===Pv.MANUFACTURE){var n=e.buildings.filter(function(e){return e.getBuildingType()===i||e.getBuildingType()===Pv.CONSTRUCTION&&e.getWorkingAt()===i}).map(function(e){return e}),r=function(){var e=n[0].getRecipe&&null!==n[0].getRecipe()?n[0].getRecipe().id:null;t=t.concat(n.filter(function(t){return t.getBuildingType()===Pv.CONSTRUCTION||null===t.getRecipe()?null===e:t.getRecipe().id===e})),n=n.filter(function(t){return t.getBuildingType()===Pv.CONSTRUCTION||null===t.getRecipe()?null!==e:t.getRecipe().id!==e})};for(e.buildings=e.buildings.filter(function(e){return!(e.getBuildingType()===i||e.getBuildingType()===Pv.CONSTRUCTION&&e.getWorkingAt()===i)});n.length>0;)r()}else t=t.concat(e.buildings.filter(function(e){return e.getBuildingType()===i||e.getBuildingType()===Pv.CONSTRUCTION&&e.getWorkingAt()===i})),e.buildings=e.buildings.filter(function(e){return!(e.getBuildingType()===i||e.getBuildingType()===Pv.CONSTRUCTION&&e.getWorkingAt()===i)})};this.buildings.length>0;)n();this.buildings=i.length===t.length?t:i}},{key:"hasBuilding",value:function(e){return void 0!==this.buildings.find(function(t){return t.getBuildingId()===e})}},{key:"autoMerge",value:function(){var e=this,t=!1,i=this.buildings.filter(function(e){return e.isCombinable()});if(i.length>1){var n=new Map;i.forEach(function(e){n.has(e.getBuildingType())?n.get(e.getBuildingType()).push(e):n.set(e.getBuildingType(),[e])}),n.forEach(function(i){for(var n=function(){for(var n=i.shift(),r=[],o=0;o<i.length;o++)i[o].isCompatible(n)&&r.push(i[o]);r.forEach(function(i){t=!0,e.clearCombineMode(),e.combine(i),e.combine(n)}),i=i.filter(function(t){return e.hasBuilding(t.getBuildingId())})};i.length>1;)n()})}t||this.servicesService.getModalService().info("No buildings to combine")}}]),e}(),pE=function(){var e=function(){function e(t,i,n,r,o,s,a,u){p(this,e),this.modalService=t,this.landService=i,this.gameService=n,this.regionService=r,this.tutorialService=o,this.optionsService=s,this.changeDetectorRef=a,this.thisRegion=u,this.demolishMode=!1,this.arrangeMode=!1,this.combineMode=!1,this.splitMode=!1,this.filterBuilding=this.regionService.getFilterBuilding(),this.filterWorking=this.regionService.getFilterWorking(),this.currentPage=0,this.allBuildings=Pv.ALL,this.buildingStates=qv}return S(e,[{key:"ngOnInit",value:function(){this.tutorialService.checkRegionTutorial(this.thisRegion)}},{key:"getUniqueBuildingsFromCurrentView",value:function(){var e=[];return this.regionService.buildings.forEach(function(t){e.includes(t.getBuildingType())||e.push(t.getBuildingType()),(t.getBuildingType()===Pv.CONSTRUCTION&&!e.includes(t.getWorkingAt())||t.getBuildingType()===Pv.DECONSTRUCTION&&!e.includes(t.getWorkingAt()))&&e.push(t.getWorkingAt())}),e}},{key:"getBuildings",value:function(){var e=this,t=this.regionService.getBuildings().filter(function(t){return e.filterWorking===qv.ALL||e.filterWorking===qv.WORKING&&t.isWorking()||e.filterWorking===qv.IDLE&&!t.isWorking()&&t.isStoppable()}).filter(function(t){return e.filterBuilding===Pv.ALL||t.getBuildingType()===Pv.CONSTRUCTION&&t.getWorkingAt()===e.filterBuilding||t.getBuildingType()===Pv.DECONSTRUCTION&&t.getWorkingAt()===e.filterBuilding||t.getBuildingType()===e.filterBuilding});return 0===t.length&&this.filterBuilding!==Pv.ALL&&!this.getUniqueBuildingsFromCurrentView().includes(this.filterBuilding)&&(this.filterBuilding=Pv.ALL,this.regionService.setFilterBuildings(Pv.ALL)),t}},{key:"getBuildingName",value:function(e){return Qv.prepareBuildingName(e)}},{key:"updateFilter",value:function(e){this.filterBuilding=Pv[Pv[e.target.value]],this.regionService.setFilterBuildings(this.filterBuilding),this.currentPage=0}},{key:"updateFilter2",value:function(e){this.filterWorking=Pv[Pv[e.target.value]],this.regionService.setFilterWorking(this.filterWorking),this.currentPage=0}},{key:"openBuildModal",value:function(){this.demolishMode=!1,this.arrangeMode=!1,this.modalService.setRegion(this.thisRegion),this.modalService.open(_v.BUILD)}},{key:"getUnemployed",value:function(){return this.regionService.getUnemployed()}},{key:"getFreeLand",value:function(){return this.landService.getLand()}},{key:"toggleDemolishMode",value:function(){this.demolishMode=!this.demolishMode,this.arrangeMode=!1,this.splitMode=!1,this.clearCombineMode()}},{key:"toggleArrangeMode",value:function(){this.arrangeMode=!this.arrangeMode,this.demolishMode=!1,this.splitMode=!1,this.clearCombineMode()}},{key:"toggleCombineMode",value:function(){this.combineMode=!this.combineMode,this.splitMode=!1,this.demolishMode=!1,this.arrangeMode=!1}},{key:"toggleSplitMode",value:function(){this.splitMode=!this.splitMode,this.combineMode=!1,this.demolishMode=!1,this.arrangeMode=!1}},{key:"clearCombineMode",value:function(){this.combineMode=!1,this.regionService.clearCombineMode()}},{key:"isUrbanPlanningEnabled",value:function(){return this.gameService.isEnabled(wv.URBAN_PLANNING)}},{key:"hasCombinableBuildings",value:function(){return this.getBuildings().filter(function(e){return e.isCombinable()}).length>1}},{key:"hasSplittableBuildings",value:function(){return this.getBuildings().filter(function(e){return e.isSplittable()}).length>=1}},{key:"onKeydownHandler",value:function(e){this.demolishMode=!1,this.arrangeMode=!1,this.clearCombineMode()}},{key:"enableAll",value:function(){this.getBuildings().filter(function(e){return e.isStoppable()}).forEach(function(e){e.stopProduction(),e.startProduction()})}},{key:"disableAll",value:function(){this.getBuildings().filter(function(e){return e.isStoppable()}).forEach(function(e){return e.stopProduction()})}},{key:"isPagedViewEnabled",value:function(){return this.optionsService.getOption(Xv.PAGED_VIEW)}},{key:"getBuildingPerPage",value:function(){return this.optionsService.getOption(Xv.BUILDINGS_PER_PAGE)}},{key:"getPagesNumber",value:function(){var e=Math.ceil(this.getBuildings().length/this.getBuildingPerPage());return 0===e&&(e=1),Array.apply(null,Array(e)).map(function(e,t){return t})}},{key:"setPage",value:function(e){this.currentPage=e}},{key:"getPagedBuildings",value:function(){var e=this.getBuildingPerPage();return this.getBuildings().slice(this.currentPage*e,this.currentPage*e+e)}},{key:"autoSort",value:function(){var e=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to <b>auto sort</b> buildings?");var t=this.modalService.registerForConfirmation().subscribe(function(i){t.unsubscribe(),i&&e.regionService.autoSort()})}},{key:"autoMerge",value:function(){var e=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to <b>auto merge</b> buildings?");var t=this.modalService.registerForConfirmation().subscribe(function(i){t.unsubscribe(),i&&e.regionService.autoMerge()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(vE),Bs(Nm),Bs(Om),Bs(cu),Bs(Yv))},e.\u0275cmp=it({type:e,selectors:[["ng-component"]],hostBindings:function(e,t){1&e&&$s("keydown.escape",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),mE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,h=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,g=arguments.length>10?arguments[10]:void 0;return p(this,i),(e=t.call(this,r,o,n,s,!1,!0,!1,d)).occupants=a,e.progress=u,e.food=c,e.fuel=l,e.clothes=h,e.enabled=g,e.maxSize=s.MAX_OCCUPANTS,e.servicesService&&(e.villageService=n.getVillageService(),e.weatherService=n.getWeatherService(),e.religionService=n.getService(Zv.RELIGION),e.managementService=n.getManagementService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,occupants:this.occupants,maxSize:this.maxSize,progress:this.progress,food:this.food,fuel:this.fuel,clothes:this.clothes,enabled:this.enabled}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("occupants: "+this.occupants+"/"+this.maxSize);case Dm.SECOND:return Mm.progressValue(this.occupants<this.maxSize?this.progress:-1);case Dm.THIRD:return this.food>0||0===this.occupants?Mm.emptyValue():Mm.progressValue(Math.abs(this.food),"famine");case Dm.FOURTH:return this.fuel>=0?this.weatherService.getCurrentTemperature()<10&&this.occupants>0?Mm.textValue("heating"):Mm.emptyValue():Mm.progressValue(Math.abs(this.fuel),"freezing")}}},{key:"tick",value:function(){if(this.enabled){if(this.occupants>0){var e=this.getHousingQuality(this.getBuildingType()),t=this.getBestHousingQualityPossible();e<t&&this.happinessService.registerHouseQualityHappiness((e-t)*this.occupants,this.occupants)}this.clothes<50&&(this.resourcesService.decreaseResource(Mv.CLOTHES,1,this.getName()+" clothing")?(this.clothes+=50,this.happinessService.updateFurClothes(this.getBuildingId(),!1)):this.managementService.getFurClothes()&&this.resourcesService.decreaseResource(Mv.FUR,1,this.getName()+" clothing")?(this.clothes+=2,this.happinessService.updateFurClothes(this.getBuildingId(),!0)):0===this.clothes&&this.happinessService.clearFurClothes(this.getBuildingId()));for(var i=!0;this.food<=this.settings.STORAGE-50&&i;){var n=this.resourcesService.getPriorityFood(this.getName());if(0===n&&(i=!1),this.food<0){var r=Math.abs(this.food)/2;n>=r?(n-=r,this.food=0):(this.food-=2*n,n=0)}this.food+=n}for(var o=Number(this.managementService.getRations()),s=0;s<this.occupants;s++)this.food>0?(this.food-=.5*o,1===o?this.happinessService.registerFoodHappiness(-1):this.happinessService.getHappiness()<75&&(2===o||(3===o?this.happinessService.registerFoodHappiness(2):4===o&&this.happinessService.registerFoodHappiness(3)))):(this.food-=.5,this.happinessService.registerFoodHappiness(-3));this.food<0&&0===this.occupants&&(this.food=0),this.food<-100&&this.occupants>0&&(this.occupants-=1,this.food=-1,this.resourcesService.removePeople(1)),this.food<0&&this.occupants>0&&this.religionService.getFaithShield()>0&&(this.food=100*this.religionService.decreaseFaithShield(Math.abs(this.food)/100)),this.fuel<=this.settings.STORAGE-50&&(this.fuel+=this.resourcesService.getFuel(this.getName()));var a=this.weatherService.getCurrentTemperature(),u=this.managementService.getClothesRations();if(a<10&&this.occupants>0){var c=.2*(10-a)/10*(this.settings.SIZE/10*(1-this.settings.FUEL_EFFICIENCY));if(this.clothes>0?(this.clothes-=.01*this.occupants*u,c/=u+1,this.clothes<0&&(this.clothes=0),this.happinessService.registerClothesHappiness(u*this.occupants,this.occupants)):this.happinessService.registerClothesHappiness(-3*this.occupants,this.occupants),this.fuel-c<-100&&this.resourcesService.getPeople()+this.resourcesService.getWorkers()>0){var l=[{item:zv.COLD,chance:mm.getSickness(zv.COLD).CHANCE},{item:zv.FLU,chance:mm.getSickness(zv.FLU).CHANCE},{item:zv.PNEUMONIA,chance:mm.getSickness(zv.PNEUMONIA).CHANCE}],h=sp.randomElement(l,!0);null!=h&&(this.managementService.getLogSickness()&&this.logService.warning(h===zv.PNEUMONIA?"Villager developed "+Qv.prepareSicknessName(h):"Villager caught a "+Qv.prepareSicknessName(h)),this.resourcesService.addSick(h)),this.fuel=0}else this.fuel-=c;if(this.fuel<0&&this.occupants>0&&this.religionService.getFaithShield()>0)return void(this.fuel=200*this.religionService.decreaseFaithShield(Math.abs(this.food)/200));this.fuel<0&&this.happinessService.registerFreezingHappiness(-1*this.occupants,this.occupants)}else this.fuel<0&&(this.fuel=0),a>10&&(this.clothes>0?(this.clothes-=.005*this.occupants*u,this.clothes<0&&(this.clothes=0),this.happinessService.registerClothesHappiness(u*this.occupants,this.occupants)):this.happinessService.registerClothesHappiness(-3*this.occupants,this.occupants));this.progress<100&&this.occupants<this.maxSize&&this.food>0?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):this.occupants<this.maxSize&&100===this.progress?(this.occupants+=1,this.resourcesService.createPeople(1),this.progress=0):this.progress>0&&this.food<=0&&(this.progress-=this.getPower())}}},{key:"build",value:function(){return this.resourcesService.increasePopulationCap(this.maxSize),this}},{key:"prepareDemolish",value:function(){if(this.occupants>0){var e=this.villageService.moveOccupants(this,this.occupants,this.food,this.fuel,this.clothes);this.resourcesService.removePeople(e)}return this.resourcesService.decreasePopulationCap(this.maxSize),!0}},{key:"getDetails",value:function(){return"occupants: "+this.occupants+"/"+this.maxSize+"<br>food nutrition: "+Qv.round(this.food,2)+"<br>heating fuel: "+Qv.round(this.fuel,2)+"<br>clothes: "+Qv.round(this.clothes,2)+"<br>"+u(v(i.prototype),"getDetails",this).call(this)}},{key:"hasDetails",value:function(){return!0}},{key:"stopProduction",value:function(){this.enabled=!1}},{key:"startProduction",value:function(){return this.enabled=!0,!0}},{key:"isStoppable",value:function(){return 0===this.occupants||!this.enabled}},{key:"isWorking",value:function(){return this.enabled}},{key:"getMaxSize",value:function(){return this.maxSize}},{key:"getOccupants",value:function(){return this.occupants}},{key:"addOccupant",value:function(){return this.occupants<this.maxSize&&(this.occupants+=1,this.occupants===this.maxSize&&(this.progress=0),!0)}},{key:"removeOccupant",value:function(){return this.occupants>0&&(this.occupants-=1,!0)}},{key:"addFood",value:function(e){this.food+=e}},{key:"addFuel",value:function(e){this.fuel+=e}},{key:"addClothes",value:function(e){this.clothes+=e}},{key:"fireWorker",value:function(){return!1}},{key:"hireWorker",value:function(){return!1}},{key:"getWorkers",value:function(){return 0}},{key:"setBuildingLevel",value:function(e){}},{key:"getBuildingData",value:function(){return{food:this.food,fuel:this.fuel,clothes:this.clothes,enabled:this.enabled}}},{key:"setBuildingData",value:function(e){this.food=e.food,this.fuel=e.fuel,this.clothes=e.clothes,this.enabled=e.enabled}},{key:"getHousingQuality",value:function(e){switch(e){case Pv.HUT:return 1;case Pv.HOUSE:return 2;case Pv.LONGHOUSE:return 3;case Pv.TUDOR_HOUSE:return 4;case Pv.SETTLEMENT:return 5;default:return 0}}},{key:"getBestHousingQualityPossible",value:function(){return this.gameService.isEnabled(wv.SETTLEMENT)?this.getHousingQuality(Pv.SETTLEMENT):this.gameService.isEnabled(wv.TUDOR_HOUSE)?this.getHousingQuality(Pv.TUDOR_HOUSE):this.gameService.isEnabled(wv.LONGHOUSE)?this.getHousingQuality(Pv.LONGHOUSE):this.gameService.isEnabled(wv.HOUSE)?this.getHousingQuality(Pv.HOUSE):this.getHousingQuality(Pv.HUT)}}]),i}(xm),SE=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];return p(this,i),t.call(this,e,n,Pv.HUT,um.VILLAGE.HUT,r,o,s,a,u,c,l)}return i}(mE),EE=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];return p(this,i),t.call(this,e,n,Pv.HOUSE,um.VILLAGE.HOUSE,r,o,s,a,u,c,l)}return i}(mE),yE=function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];p(this,e),this.name=t,this.enabled=i,this.reserved=n,this.reservedPercent=r},RE=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;p(this,e),this.autoSellEnabled=t,this.autoSellAmount=i,this.autoSellPercentage=n,this.autoSellOrder=r,this.autoBuyEnabled=o,this.autoBuyAmount=s,this.autoBuyPercentage=a,this.autoBuyOrder=u}return S(e,null,[{key:"clone",value:function(t){return new e(t.autoSellEnabled,t.autoSellAmount,t.autoSellPercentage,t.autoSellOrder,t.autoBuyEnabled,t.autoBuyAmount,t.autoBuyPercentage,t.autoBuyOrder)}}]),e}(),OE=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[new yE("Crafting"),new yE("Kitchen"),new yE("Manufacture"),new yE("Hut"),new yE("House"),new yE("Longhouse"),new yE("Tudor house"),new yE("Settlement"),new yE("Bakery"),new yE("Tailor"),new yE("Tavern"),new yE("Tannery"),new yE("Sawmill"),new yE("Windmill"),new yE("Cotton mill"),new yE("Brewery"),new yE("Winery"),new yE("Stonemason"),new yE("Mint"),new yE("Fishers hut"),new yE("Paper mill")].sort(function(e,t){return e.name.localeCompare(t.name)}),r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;p(this,e),this.resource=t,this.reserve=i,this.reservePercent=r,this.consumers=n,this.autoTrade=null===o?new RE:o}return S(e,[{key:"getReservedAmountBySource",value:function(e,t,i){var n=0,r=!1;return i?0:(n=this.reserve,r=this.reservePercent,this.consumers.forEach(function(t){t.enabled&&t.name===e&&(n=t.reserved,r=t.reservedPercent)}),r?Math.floor(n/100*t.getLimit()):n)}},{key:"isUsed",value:function(){var e=!1;return 0!==this.reserve||(this.consumers.forEach(function(t){t.enabled&&(e=!0)}),(this.autoTrade.autoSellEnabled||this.autoTrade.autoBuyEnabled)&&(e=!0),e)}}],[{key:"clone",value:function(t){var i=[];return t.consumers.forEach(function(e){return i.push(new yE(e.name,e.enabled,e.reserved,e.reservedPercent))}),new e(t.resource,t.reserve,i,t.reservePercent,RE.clone(t.autoTrade))}}]),e}(),TE=function(){function e(t,i,n,r,o,s,a,u){p(this,e),this.resource=t,this.name=i,this.amount=n,this.limit=r,this.resourceTypes=o,this.visible=s,this.highlighted=a,this.prioritise=u,this.options=new OE(t)}return S(e,[{key:"toJSON",value:function(){return{amount:this.amount,limit:this.limit,visible:this.visible,highlighted:this.highlighted,prioritise:this.prioritise,options:this.options}}},{key:"addResource",value:function(e){return this.amount+e>this.limit?(this.amount=this.limit,this.amount):(this.amount+=e,this.amount)}},{key:"removeResource",value:function(e){return this.amount-e>0&&(this.amount-=e,!0)}},{key:"getResource",value:function(){return this.resource}},{key:"getName",value:function(){return this.name}},{key:"getAmount",value:function(){return this.amount}},{key:"getLimit",value:function(){return this.limit}},{key:"getResourceTypes",value:function(){return this.resourceTypes}},{key:"hasResourceType",value:function(e){return this.resourceTypes.indexOf(e)>-1}},{key:"isVisible",value:function(){return this.visible}},{key:"toggleVisible",value:function(){return this.visible=!this.visible,this.visible}},{key:"isHighlighted",value:function(){return this.highlighted}},{key:"toggleHighlighted",value:function(){return this.highlighted=!this.highlighted,this.highlighted}},{key:"getFreeSpace",value:function(){return this.limit-this.amount}}]),e}(),IE=function(){function e(){p(this,e),this.amount=0,this.limit=0,this.resourceTypes=[],this.visible=!1,this.highlighted=!1,this.prioritise=!1}return S(e,[{key:"forResource",value:function(e){return this.resource=e,this}},{key:"withName",value:function(e){return this.name=e,this}},{key:"withAmount",value:function(e){return this.amount=e,this}},{key:"withLimit",value:function(e){return this.limit=e,this}},{key:"withResourceTypes",value:function(e){var t=this;return e.forEach(function(e){return t.resourceTypes.push(e)}),this}},{key:"withResourceType",value:function(e){return this.resourceTypes.push(e),this}},{key:"withVisible",value:function(e){return this.visible=e,this}},{key:"withHighlighted",value:function(e){return this.highlighted=e,this}},{key:"withPrioritise",value:function(e){return this.prioritise=e,this}},{key:"build",value:function(){var e=new TE(this.resource,this.name,this.amount,this.limit,this.resourceTypes,this.visible,this.highlighted,this.prioritise);return this.resource=void 0,this.name=void 0,this.amount=0,this.limit=0,this.resourceTypes=[],this.visible=!1,this.highlighted=!1,this.prioritise=!1,e}}]),e}(),bE=(function(e){e.ERROR_1="ERROR_1: Copying failed",e.ERROR_2="ERROR_2: Resource limit below 0",e.ERROR_3="ERROR_3: Workers below 0",e.ERROR_4="ERROR_4: Population Cap below 0",e.ERROR_5="ERROR_5: ",e.ERROR_6="ERROR_6: ",e.ERROR_7="ERROR_7: ",e.ERROR_8="ERROR_8: "}(bE||(bE={})),bE),CE=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;p(this,e),this.userName=t,this.value=i,this.daysAgo=n}return S(e,[{key:"incrementDaysAgo",value:function(){this.daysAgo+=1}}]),e}(),AE=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;p(this,e),this.producerName=t,this.value=i,this.daysAgo=n}return S(e,[{key:"incrementDaysAgo",value:function(){this.daysAgo+=1}}]),e}(),kE=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;p(this,e),this.sickness=t,this.progress=i,this.medicine=n},NE=function e(t,i,n,r){p(this,e),this.id=t,this.effect=i,this.value=n,this.duration=r},_E=function(){var e=function(){function e(t,i){var n=this;p(this,e),this.servicesService=t,this.calendarService=i,this.happiness=15,this.happinessEffects=[],this.foodHappiness={value:0,weight:0},this.clothesHappiness={value:0,weight:0},this.freezingHappiness={value:0,weight:0},this.housingQuality={value:0,weight:0},this.furClothes=[],this.showDuration=!1,t.addService(Zv.HAPPINESS,this),i.registerForDayChange().subscribe(function(e){n.servicesService.getGameService().isEnabled(wv.GALLEON)&&n.servicesService.getWorldService().hasPiratesBase()?n.updateHappiness(Kv.PIRATES_BASE_PRESENT,-3,-1):n.updateHappiness(Kv.PIRATES_BASE_PRESENT,0,-1),n.happinessEffects.filter(function(e){return e.duration>0}).forEach(function(e){return e.duration-=1}),n.happinessEffects=n.happinessEffects.filter(function(e){return 0!==e.duration})})}return S(e,[{key:"getName",value:function(){return"HappinessService"}},{key:"load",value:function(e){var t=this.servicesService.getVillageService();this.happiness=null==e.happiness||isNaN(e.happiness)?15:e.happiness,this.happinessEffects=void 0!==e.effects?e.effects:[],this.furClothes=void 0!==e.furClothes?e.furClothes.filter(function(e){return t.hasBuilding(e.id)}):[],this.foodHappiness=void 0!==e.foodHappiness?e.foodHappiness:{value:0,weight:0},this.clothesHappiness=void 0!==e.clothesHappiness?e.clothesHappiness:{value:0,weight:0},this.freezingHappiness=void 0!==e.freezingHappiness?e.freezingHappiness:{value:0,weight:0},this.housingQuality=void 0!==e.housingQuality?e.housingQuality:{value:0,weight:0},this.showDuration=void 0!==e.showDuration&&e.showDuration}},{key:"save",value:function(){return{happiness:this.happiness,effects:this.happinessEffects,foodHappiness:this.foodHappiness,clothesHappiness:this.clothesHappiness,freezingHappiness:this.freezingHappiness,housingQuality:this.housingQuality,furClothes:this.furClothes,showDuration:this.showDuration}}},{key:"reset",value:function(e,t){this.happiness=15,this.happinessEffects=[],this.furClothes=[],this.foodHappiness={value:0,weight:0},this.clothesHappiness={value:0,weight:0},this.freezingHappiness={value:0,weight:0}}},{key:"processSpecialHappiness",value:function(e,t){var i=Math.floor(e.value/(0!==e.weight?e.weight:1)),n=this.getHappinessEffectByEffect(t);0!==i?n?n.value=i:this.addHappinessEffect(0,t,i,-1):this.happinessEffects=this.happinessEffects.filter(function(e){return e.effect!==t}),e.value=0,e.weight=0}},{key:"tick",value:function(e){var t=this;if(this.processSpecialHappiness(this.foodHappiness,Kv.FOOD),this.processSpecialHappiness(this.clothesHappiness,Kv.CLOTHES),this.processSpecialHappiness(this.freezingHappiness,Kv.FREEZING),this.processSpecialHappiness(this.housingQuality,Kv.LOW_QUALITY_HOUSING),this.furClothes=this.furClothes.filter(function(e){return t.servicesService.getVillageService().hasBuilding(e.id)&&void 0!==t.servicesService.getVillageService().getBuildings().find(function(t){return t.getBuildingId()===e.id}).getOccupants&&t.servicesService.getVillageService().getBuildings().find(function(t){return t.getBuildingId()===e.id}).isWorking()}),this.furClothes.length>0){var i=0;if(this.furClothes.forEach(function(e){e.fur&&(i-=1)}),0!==i){var n=this.furClothes.length+i;i=Math.floor(i/(0!==n?n:-i)),this.updateHappiness(Kv.FUR_CLOTHES,i,-1)}else this.updateHappiness(Kv.FUR_CLOTHES,0,-1)}else this.updateHappiness(Kv.FUR_CLOTHES,0,-1);this.happiness+=this.calculateDailyChange()/10,this.happiness<0?this.happiness=0:this.happiness>100&&(this.happiness=100)}},{key:"updateHappiness",value:function(e,t,i){var n=this.getHappinessEffectByEffect(e);n?(n.value=t,n.duration=i):this.addHappinessEffect(0,e,t,i)}},{key:"getHappiness",value:function(){return this.happiness}},{key:"updateFurClothes",value:function(e,t){var i=this.furClothes.find(function(t){return t.id===e});i?i.fur=t:this.furClothes.push({id:e,fur:t})}},{key:"clearFurClothes",value:function(e){this.furClothes=this.furClothes.filter(function(t){return t.id!==e})}},{key:"getHappinessEffect",value:function(){return this.happiness>=0&&this.happiness<=10?-10:this.happiness>10&&this.happiness<=40?0:this.happiness>40&&this.happiness<=60?10:this.happiness>60&&this.happiness<=90?20:this.happiness>90&&this.happiness<=100?50:void 0}},{key:"registerFoodHappiness",value:function(e){this.foodHappiness.value+=e,this.foodHappiness.weight+=1}},{key:"registerClothesHappiness",value:function(e,t){this.clothesHappiness.value+=e,this.clothesHappiness.weight+=t}},{key:"registerFreezingHappiness",value:function(e,t){this.freezingHappiness.value+=e,this.freezingHappiness.weight+=t}},{key:"registerHouseQualityHappiness",value:function(e,t){this.housingQuality.value+=e,this.housingQuality.weight+=t}},{key:"resetHappiness",value:function(){this.happiness<15&&(this.happiness=15),this.clear()}},{key:"addHappinessEffect",value:function(e,t,i,n){this.happinessEffects.push(new NE(e,t,i,n))}},{key:"getHappinessEffectById",value:function(e){return this.happinessEffects.filter(function(t){return t.id===e})}},{key:"getHappinessEffects",value:function(){return this.happinessEffects.filter(function(e){return 0!==e.value})}},{key:"getHappinessEffectByEffect",value:function(e){return this.happinessEffects.find(function(t){return t.effect===e})}},{key:"calculateDailyChange",value:function(){var e=0;return this.happinessEffects.forEach(function(t){return e+=t.value}),e/300}},{key:"clear",value:function(){this.happinessEffects=[]}},{key:"toggleShowDuration",value:function(){this.showDuration=!this.showDuration}},{key:"getShowDuration",value:function(){return this.showDuration}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Im))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),wE=function e(t,i,n,r,o,s,a){p(this,e),this.perk=t,this.usages=i,this.maxUsages=n,this.description=r,this.cost=o,this.reset=s,this.effect=a},PE=function(){var e=function(){function e(t,i,n){p(this,e),this.modalService=t,this.logService=i,this.servicesService=n,this.royalPoints=0,this.perks=[],this.goldenFish=!1,this.goldenEgg=!1,this.goldenApple=!1,this.goldenFleece=!1,this.servicesService.addService(Zv.ROYAL,this),this.initPerks()}return S(e,[{key:"initPerks",value:function(){var e=this;this.perks=[],Object.entries(vm.PERKS).forEach(function(t){e.perks.push(new wE(Dv[t[0]],t[1].USAGES,t[1].MAX_USAGES,t[1].DESCRIPTION,t[1].COST,t[1].RESET,t[1].EFFECT))})}},{key:"getName",value:function(){return"RoyalService"}},{key:"load",value:function(e){var t=this;this.royalPoints=e.royalPoints,this.goldenFish=void 0!==e.goldenFish&&e.goldenFish,this.goldenEgg=void 0!==e.goldenEgg&&e.goldenEgg,this.goldenApple=void 0!==e.goldenApple&&e.goldenApple,this.goldenFleece=void 0!==e.goldenFleece&&e.goldenFleece,e.progress.forEach(function(e){var i=t.perks.find(function(t){return t.perk===e[0]});i&&(i.usages=e[1])})}},{key:"save",value:function(){var e=[];return this.perks.forEach(function(t){return e.push([t.perk,t.usages])}),{royalPoints:this.royalPoints,progress:e,goldenFish:this.goldenFish,goldenEgg:this.goldenEgg,goldenApple:this.goldenApple,goldenFleece:this.goldenFleece}}},{key:"reset",value:function(e,t){var i=this;e?(this.royalPoints=0,this.initPerks()):this.perks.forEach(function(e){e.reset&&e.usages>0&&e.reset(i.servicesService,e)}),this.goldenFish=!1,this.goldenEgg=!1,this.goldenApple=!1,this.goldenFleece=!1}},{key:"getRoyalPoints",value:function(){return this.royalPoints}},{key:"buyRoyalPoints",value:function(){this.modalService.open(_v.ROYAL)}},{key:"increaseRoyalPoints",value:function(e){this.royalPoints+=e}},{key:"getRoyalPerks",value:function(){return this.perks}},{key:"unlock",value:function(e){(0===e.maxUsages||e.usages<e.maxUsages)&&(this.royalPoints>=e.cost?this.perks.find(function(t){return e===t}).effect(this.servicesService,e):this.modalService.info("Not enough Royal Points!<br>"+e.cost+" RP required but only "+this.royalPoints+" available"))}},{key:"unlockCallback",value:function(e){this.royalPoints-=Number(e.cost),e.usages+=1}},{key:"isGoldenFishCaught",value:function(){return this.goldenFish}},{key:"isGoldenEggLaid",value:function(){return this.goldenEgg}},{key:"isGoldenApplePicked",value:function(){return this.goldenApple}},{key:"isGoldenFleeceFound",value:function(){return this.goldenFleece}},{key:"catchGoldenFish",value:function(){return!(this.goldenFish||!sp.chance(vm.GOLDEN_ITEMS.GOLDEN_FISH_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("You have caught a golden fish. You let it go and it granted you 5 Royal Points"),this.goldenFish=!0,0))}},{key:"layGoldenEgg",value:function(){return!(this.goldenEgg||!sp.chance(vm.GOLDEN_ITEMS.GOLDEN_EGG_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("Your chicken laid golden egg. You decided to keep it and was granted 5 Royal Points"),this.goldenEgg=!0,0))}},{key:"pickGoldenApple",value:function(){return!(this.goldenApple||!sp.chance(vm.GOLDEN_ITEMS.GOLDEN_APPLE_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("You picked golden apple in the orchard. You decided to keep it and was granted 5 Royal Points"),this.goldenApple=!0,0))}},{key:"getGoldenFleece",value:function(){return!(this.goldenFleece||!sp.chance(vm.GOLDEN_ITEMS.GOLDEN_FLEECE_CHANCE)||(this.increaseRoyalPoints(5),this.logService.mystical("You got a golden fleece from one of your sheep. You decided to keep it and was granted 5 Royal Points"),this.goldenFleece=!0,0))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Jv),An(Cm),An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ME=function(){var e=function(){function e(t,i,n,r){p(this,e),this.servicesService=t,this.modalService=i,this.royalService=n,this.logService=r,t.addService(Zv.KONGREGATE,this);try{kongregateAPI.loadAPI(function(){window.kongregate=kongregateAPI.getAPI();var e=[],t=function(t){if(t.success){var i=e.find(function(e){return e[0]===t.id});i&&n.increaseRoyalPoints(i[1])}};window.kongregate.mtx.requestUserItemList(null,function(i){if(i.success)for(var n=0;n<i.data.length;n++){var r=i.data[n];e.push([r.id,Number(r.identifier.replace("rp_pack",""))]),window.kongregate.mtx.useItemInstance(r.id,t)}})})}catch(o){console.error(o)}}return S(e,[{key:"isSet",value:function(){return!!window.kongregate}},{key:"isAvailable",value:function(){return window.kongregate&&0!==this.getUserId()}},{key:"submitStat",value:function(e,t){window.kongregate.stats.submit(e,t)}},{key:"getUsername",value:function(){if(this.isSet())return window.kongregate.services.getUsername()}},{key:"isGuest",value:function(){return!this.isSet()||window.kongregate.services.isGuest()}},{key:"getUserId",value:function(){if(this.isSet())return window.kongregate.services.getUserId()}},{key:"getGameAuthToken",value:function(){if(this.isSet())return window.kongregate.services.getGameAuthToken()}},{key:"buyItem",value:function(e){var t=this.modalService,i=this.royalService,n=this.logService,r=[],o=function(e){if(e.success){var t=r.find(function(t){return t[0]===e.id});t&&(i.increaseRoyalPoints(t[1]),n.log("Added "+t[1]+" Royal Points"))}},s=function(e){if(e.success)for(var t=0;t<e.data.length;t++){var i=e.data[t];r.push([i.id,Number(i.identifier.replace("rp_pack",""))]),window.kongregate.mtx.useItemInstance(i.id,o)}};window.kongregate.mtx.purchaseItems([e],function(e){e.success&&(t.close(_v.ROYAL),window.kongregate.mtx.requestUserItemList(null,s))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Jv),An(PE),An(Cm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),DE=function(){var e=function(){function e(t,i,n,r,o,s,a,u){var c=this;p(this,e),this.logService=t,this.servicesService=i,this.gameService=n,this.modalService=r,this.optionsService=o,this.happinessService=s,this.calendarService=a,this.kongregateService=u,this.resources=new Map,this.resourcesUse=new Map,this.resourcesProduction=new Map,this.sick=[],this.populationScore=0,this.resourcesSubject=new U,this.callbacks=new Map,this.hideEmpty=!1,i.addService(Zv.RESOURCES,this),this.init(),a.registerForDayChange().subscribe(function(){Array.from(c.resourcesUse.keys()).forEach(function(e){c.resourcesUse.set(e,c.resourcesUse.get(e).filter(function(e){return e.daysAgo<30})),c.resourcesUse.get(e).forEach(function(e){return e.incrementDaysAgo()}),0===c.resourcesUse.get(e).length&&c.resourcesUse.delete(e)}),Array.from(c.resourcesProduction.keys()).forEach(function(e){c.resourcesProduction.set(e,c.resourcesProduction.get(e).filter(function(e){return e.daysAgo<30})),c.resourcesProduction.get(e).forEach(function(e){return e.incrementDaysAgo()}),0===c.resourcesProduction.get(e).length&&c.resourcesProduction.delete(e)})})}return S(e,[{key:"init",value:function(){var e=this,t=new IE;cm.getResources().forEach(function(i){e.resources.set(Mv[i[0]],t.forResource(Mv[i[0]]).withName(Qv.prepareResourceName(Mv[i[0]])).withAmount(void 0!==i[1].AMOUNT?i[1].AMOUNT:cm.DEFAULT_AMOUNT).withLimit(void 0!==i[1].LIMIT?i[1].LIMIT:cm.DEFAULT_LIMIT).withResourceTypes(i[1].TYPES).withResourceType(Hv.ALL).withVisible(void 0!==i[1].VISIBLE?i[1].VISIBLE:cm.DEFAULT_VISIBLE).withHighlighted(void 0!==i[1].HIGHLIGHTED?i[1].HIGHLIGHTED:cm.DEFAULT_HIGHLIGHTED).build())}),this.people=1,this.workers=0,this.populationCap=1,Cp.production||this.resources.forEach(function(e){return e.visible=!0})}},{key:"getResource",value:function(e){return this.resources.get(e)}},{key:"makeVisible",value:function(e){this.resources.get(e).visible=!0}},{key:"increaseResource",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e===Mv.FOOD||e===Mv.NOTHING)return!0;var o=this.resources.get(e);if(o.getResourceTypes().includes(Hv.ANIMAL)){var s=this.servicesService.getServiceByRegion(Yv.FIELD),a=s.getBuildings().filter(function(e){return e.getBuildingType()===Pv.PASTURE}).map(function(e){return e}).filter(function(t){return t.getResourceType()===e}),u=0;if(a.forEach(function(e){return u+=e.getMaxAnimals()-e.getAnimals()}),t>u&&!r)return!1;if(r&&t>u){var c=t-u;t=u;for(var l=s.getBuildings().filter(function(e){return e.getBuildingType()===Pv.BUTCHER}).map(function(e){return e}).filter(function(e){return e.getFreeSpace()>0});l.length>0&&c>0;)l[0].addAnimalToButcher(e),c-=1,l=l.filter(function(e){return e.getFreeSpace()>0})}for(;t>0&&u>0;){var h,d=n(a);try{for(d.s();!(h=d.n()).done;){for(var g=h.value;g.getAnimals()<g.getMaxAnimals()&&t>0;)g.increaseAnimal(1),t-=1,this.addResourceProduction(e,i,1),u-=1;if(0===t)return!0}}catch(f){d.e(f)}finally{d.f()}}return!0}return!(!r&&o.amount+t>o.limit||(o.amount+=t,this.addResourceProduction(e,i,t),o.amount>o.limit&&(o.amount=o.limit),this.resourcesSubject.next(this.resources),o.isVisible()||(o.toggleVisible(),this.logService.log("New resource discovered: "+Qv.prepareResourceName(e))),0))}},{key:"decreaseResource",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e===Mv.FOOD)return this.getFoodValue(i,r)>=t&&(this.getFood(t,i,r),!0);var o=this.resources.get(e);if(o.getResourceTypes().includes(Hv.ANIMAL)){var s=this.servicesService.getServiceByRegion(Yv.FIELD).getBuildings().filter(function(e){return e.getBuildingType()===Pv.PASTURE}).map(function(e){return e}).filter(function(t){return t.getResourceType()===e&&t.getAnimals()>0}),a=0;if(s.forEach(function(e){return a+=e.getAnimals()}),a>=t){var u,c=n(s);try{for(c.s();!(u=c.n()).done;){for(var l=u.value;t>0&&l.getAnimals()>0;)l.decreaseAnimal(1),this.addResourceUse(e,i,1),t-=1;if(0===t)return!0}}catch(h){c.e(h)}finally{c.f()}return!0}return!1}return 0!==this.hasResource(e,t,i,r)?(this.resourcesSubject.next(this.resources),!1):(o.amount-=t,this.addResourceUse(e,i,t),this.resourcesSubject.next(this.resources),!0)}},{key:"hasResource",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e===Mv.FOOD)return this.getFoodValue(i,n)>=t?0:t-this.getFoodValue(i,n);var r=this.resources.get(e);return n?r.amount>=t?0:t-this.resources.get(e).amount:r.amount-r.options.getReservedAmountBySource(i,r,n)>=t?0:t-(r.amount-r.options.getReservedAmountBySource(i,r,n))}},{key:"hasLimit",value:function(e){return this.resources.get(e).amount<this.resources.get(e).limit}},{key:"decreaseResources",value:function(e,i){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s="",a=!0,u=0,c=Array.from(e);u<c.length;u++){var l=t(c[u],2),h=l[0],d=l[1],g=this.hasResource(h,d*r,i,n);0!==g&&(s+="Missing "+g+" "+Qv.prepareResourceName(h)+"<br>",a=!1)}if(!a)return o||this.modalService.info(s),!1;for(var f=0,v=Array.from(e);f<v.length;f++){var p=t(v[f],2),m=p[0],S=p[1];this.decreaseResource(m,S*r,i,n)}return!0}},{key:"hasResources",value:function(e,i){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!0,s=0,a=Array.from(e);s<a.length;s++){var u=t(a[s],2),c=u[0],l=u[1];0!==this.hasResource(c,l*n,i,r)&&(o=!1)}return o}},{key:"increaseLimit",value:function(e,t){this.resources.forEach(function(i){i.getResourceTypes().includes(e)&&!i.getResourceTypes().includes(Hv.ANIMAL)&&(i.limit+=t)})}},{key:"increaseResourceLimit",value:function(e,t){this.resources.get(e).limit+=t}},{key:"decreaseLimit",value:function(e,t){this.resources.forEach(function(i){i.getResourceTypes().includes(e)&&!i.getResourceTypes().includes(Hv.ANIMAL)&&(i.limit-=t,i.limit<0&&(i.limit=0,console.error(bE.ERROR_2,i.getResource(),i.limit)),i.amount>i.limit&&(i.amount=i.limit))})}},{key:"decreaseResourceLimit",value:function(e,t){var i=this.resources.get(e);i.limit-=t,i.limit<0&&(i.limit=0,console.error(bE.ERROR_2,i.getResource(),i.limit)),i.amount>i.limit&&(i.amount=i.limit)}},{key:"getResources",value:function(){return this.resources}},{key:"save",value:function(){var e="[";return this.resources.forEach(function(t){e+="["+t.resource+","+JSON.stringify(t)+"],"}),{resources:e=e.slice(0,-1)+"]",people:this.people,workers:this.workers,sick:this.sick,populationCap:this.populationCap}}},{key:"getName",value:function(){return"ResourcesService"}},{key:"load",value:function(e){var t=this;JSON.parse(e.resources).forEach(function(e){if(t.resources.get(e[0]).amount=e[1].amount,t.resources.get(e[0]).limit=e[1].limit,t.resources.get(e[0]).visible=e[1].visible,t.resources.get(e[0]).highlighted=e[1].highlighted,t.resources.get(e[0]).prioritise=e[1].prioritise,e[1].reserved)t.resources.get(e[0]).options=new OE(t.resources.get(e[0]).resource,e[1].reserved);else if(e[1].options){var i=[],n=new RE;e[1].options.consumers.forEach(function(e){i.push(new yE(e.name,e.enabled,e.reserved,void 0!==e.reservedPercent&&e.reservedPercent))}),i.find(function(e){return"Paper mill"===e.name})||i.push(new yE("Paper mill")),i.find(function(e){return"Tudor house"===e.name})||i.push(new yE("Tudor house")),i.find(function(e){return"Settlement"===e.name})||i.push(new yE("Settlement")),i.find(function(e){return"Kitchen"===e.name})||i.push(new yE("Kitchen")),e[1].options.autoTrade&&(n.autoSellEnabled=e[1].options.autoTrade.autoSellEnabled,n.autoSellAmount=e[1].options.autoTrade.autoSellAmount,n.autoSellOrder=e[1].options.autoTrade.autoSellOrder,n.autoBuyEnabled=e[1].options.autoTrade.autoBuyEnabled,n.autoBuyAmount=e[1].options.autoTrade.autoBuyAmount,n.autoBuyOrder=e[1].options.autoTrade.autoBuyOrder,void 0!==e[1].options.autoTrade.autoSellPercentage?(n.autoSellPercentage=e[1].options.autoTrade.autoSellPercentage,n.autoBuyPercentage=e[1].options.autoTrade.autoBuyPercentage):(n.autoSellPercentage=!1,n.autoBuyPercentage=!1)),i=i.sort(function(e,t){return e.name.localeCompare(t.name)}),t.resources.get(e[0]).options=new OE(e[1].options.resource,e[1].options.reserve,i,void 0!==e[1].options.reservePercent&&e[1].options.reservePercent,n)}else t.resources.get(e[0]).options=new OE(t.resources.get(e[0]).resource)}),this.sick=void 0!==e.sick?e.sick:[],this.people=e.people,this.workers=e.workers,this.populationCap=e.populationCap,this.resourcesSubject.next(this.resources)}},{key:"reset",value:function(e,t){var i=this;if(!e){var n=this.servicesService.getService(Zv.HERITAGE).calculateHeritagePoints(!0);n.hp>0&&this.servicesService.getService(Zv.HERITAGE).increaseHeritagePoints(n.hp),n.xp>0&&this.servicesService.getService(Zv.HERITAGE).increaseXP(n.xp)}var r=this.resources;this.resources=new Map,this.people=1,this.workers=0,this.populationCap=1,this.sick=[],this.populationScore=0,this.resourcesUse=new Map,this.resourcesProduction=new Map,this.init(),e||Array.from(this.resources.values()).forEach(function(e){i.optionsService.getOption(Xv.KEEP_RESERVATION_SETTINGS_ON_RESET)?e.options=r.get(e.resource).options:(e.options=r.get(e.resource).options,e.options.reservePercent=!1,e.options.reserve=0,e.options.consumers.forEach(function(e){return e.enabled=!1})),i.optionsService.getOption(Xv.KEEP_AUTO_TRADE_ON_RESET)||(e.options.autoTrade.autoSellEnabled=!1,e.options.autoTrade.autoBuyEnabled=!1)}),this.resourcesSubject.next(this.resources)}},{key:"registerForResourcesChange",value:function(){return this.resourcesSubject.asObservable()}},{key:"createPeople",value:function(e){this.people+=e}},{key:"removePeople",value:function(e){if(this.people-=e,this.people-e<0)for(;this.people<0;)if(this.sick.length>0)this.sick.shift(),this.people+=1;else{var t=Math.floor(Math.random()*this.callbacks.size);Array.from(this.callbacks.values())[t].fireRandomWorker()}}},{key:"hireWorker",value:function(){return this.people>0&&(this.people-=1,this.workers+=1,!0)}},{key:"fireWorker",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;0===this.workers&&console.error(bE.ERROR_3),this.workers-=e,this.people+=e}},{key:"getPeople",value:function(){return this.people}},{key:"getWorkers",value:function(){return this.workers}},{key:"getPopulationCap",value:function(){return this.populationCap}},{key:"increasePopulationCap",value:function(e){return this.populationCap+=e}},{key:"decreasePopulationCap",value:function(e){return this.populationCap-e<0&&console.error(bE.ERROR_4),this.populationCap-=e}},{key:"addCallback",value:function(e,t){this.callbacks.set(t,e)}},{key:"tick",value:function(e){var t=this;this.kongregateService.isAvailable()&&this.getTotalPeople()>this.populationScore&&(this.populationScore=this.getTotalPeople(),this.kongregateService.submitStat("Population",this.populationScore)),1===this.getTotalPeople()&&this.happinessService.resetHappiness(),this.people+this.workers>=um.VILLAGE.SHRINE.POPULATION&&(this.gameService.isEnabled(wv.SHRINE)||(this.gameService.enable(wv.SHRINE),this.logService.success("Shrine unlocked"))),this.people+this.workers>=um.VILLAGE.CHURCH.POPULATION&&(this.gameService.isEnabled(wv.CHURCH)||(this.gameService.enable(wv.CHURCH),this.logService.success("Church unlocked"))),this.getTotalPeople()>1500?this.happinessService.updateHappiness(Kv.POPULATION_SIZE,-3,-1):this.getTotalPeople()>500?this.happinessService.updateHappiness(Kv.POPULATION_SIZE,-2,-1):this.getTotalPeople()>100&&this.happinessService.updateHappiness(Kv.POPULATION_SIZE,-1,-1),this.sick=this.sick.filter(function(e){return!sp.chance(mm.getSickness(e.sickness).LETHALITY/100/(10*mm.getSickness(e.sickness).DURATION))||(t.callbacks.get(Yv.VILLAGE).removeRecruit(1,!1),t.servicesService.getManagementService().getLogSickness()&&(t.logService.warning("Villager died from "+Qv.prepareSicknessName(e.sickness)),t.happinessService.addHappinessEffect(0,Kv.SICKNESS_DEATH,-2,sp.randomBetween(20,40))),!1)}),this.sick.forEach(function(e){0===e.medicine&&t.decreaseResource(Mv.HERBAL_MEDICINE,1,"Sickness")&&(e.medicine=1),e.progress+=e.medicine>0?100/(10*mm.getSickness(e.sickness).DURATION)*2:100/(10*mm.getSickness(e.sickness).DURATION)}),this.sick.forEach(function(e){e.progress>=100&&(t.people+=1)}),this.sick=this.sick.filter(function(e){return e.progress<100})}},{key:"getPriorityFood",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.servicesService.getManagementService().getFoodPriority();for(var r in n){var o=n[r].filter(function(n){return t.getAvailableAmount(n,e,i)>0});if(o.length>0&&o.length>0){var s=o[Math.floor(Math.random()*o.length)];return this.decreaseResource(s,1,e,i),cm.getResource(s).POWER}}return 0}},{key:"getFood",value:function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e>0;)e-=this.getPriorityFood(t,i)}},{key:"getFoodValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0;return t?Array.from(this.resources.entries()).filter(function(e){return e[1].resourceTypes.includes(Hv.CONSUMABLE)&&e[1].amount>0}).forEach(function(e){return i+=cm.getResource(e[0]).POWER*e[1].amount}):Array.from(this.resources.entries()).filter(function(i){return i[1].resourceTypes.includes(Hv.CONSUMABLE)&&i[1].amount-i[1].options.getReservedAmountBySource(e,i[1],t)>0}).forEach(function(e){return i+=cm.getResource(e[0]).POWER*(e[1].amount-e[1].options.reserve)}),i}},{key:"getResourceTypes",value:function(e){return this.resources.get(e).getResourceTypes()}},{key:"increaseResources",value:function(e,i){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0,o=Array.from(e);r<o.length;r++){var s=t(o[r],2),a=s[0],u=s[1];this.increaseResource(a,u,i,n)}}},{key:"removeRecruit",value:function(e){return this.people>=e&&this.callbacks.get(Yv.VILLAGE).removeRecruit(e)}},{key:"getFuel",value:function(e){var t,i=n(cm.getResourcesByType(Hv.FUEL).sort(function(e,t){return e[1].FUEL_PRIORITY-t[1].FUEL_PRIORITY}));try{for(i.s();!(t=i.n()).done;){var r=t.value;if(this.decreaseResource(Mv[String(r[0])],1,e))return r[1].POWER}}catch(o){i.e(o)}finally{i.f()}return 0}},{key:"getTotalPeople",value:function(){return this.people+this.workers+this.sick.length}},{key:"getResourcesValue",value:function(){var e=0;return this.resources.forEach(function(t){t.amount>0&&(e+=cm.getResource(t.resource).TRADE_VALUE*t.getAmount())}),e}},{key:"getAvailableAmount",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.resources.get(e),r=n.amount-n.options.getReservedAmountBySource(t,n,i);return r<0&&(r=0),r}},{key:"updateAnimals",value:function(){var e=Array.from(this.getResources().values()).filter(function(e){return e.getResourceTypes().includes(Hv.ANIMAL)}),t=this.servicesService.getServiceByRegion(Yv.FIELD).getBuildings().filter(function(e){return e.getBuildingType()===Pv.PASTURE}).map(function(e){return e});e.forEach(function(e){var i=0,n=0;t.filter(function(t){return t.getResourceType()===e.resource}).forEach(function(e){i+=e.getAnimals(),n+=e.getMaxAnimals()}),e.amount=i,e.limit=n})}},{key:"getLimit",value:function(e){var t=this.resources.get(e);return t.limit-t.amount}},{key:"addResourceUse",value:function(e,t,i){this.resourcesUse.has(e)?this.resourcesUse.get(e).push(new CE(t,i)):this.resourcesUse.set(e,[new CE(t,i)])}},{key:"addResourceProduction",value:function(e,t,i){this.resourcesProduction.has(e)?this.resourcesProduction.get(e).push(new AE(t,i)):this.resourcesProduction.set(e,[new AE(t,i)])}},{key:"getResourceUses",value:function(e){return this.resourcesUse.get(e)}},{key:"getResourceProductions",value:function(e){return this.resourcesProduction.get(e)}},{key:"getResourcesByType",value:function(e){return Array.from(this.resources.values()).filter(function(t){return t.getResourceTypes().includes(e)})}},{key:"getFuelValue",value:function(){var e=0;return Array.from(this.resources.values()).filter(function(e){return e.getResourceTypes().includes(Hv.FUEL)}).forEach(function(t){return e+=t.amount*cm.getResource(t.resource).POWER}),e}},{key:"checkResourcesBeforeWinter",value:function(){160*this.servicesService.getVillageService().getHousingBuildings().length>this.getFuelValue()&&this.logService.warning("We might not have enough available resources to heat our homes during winter!")}},{key:"getAverageNutritionProduction",value:function(){var e=this,t=0,i=1;return this.getResourcesByType(Hv.CONSUMABLE).forEach(function(n){var r=e.getResourceProductions(n.resource);r&&r.forEach(function(e){e.daysAgo>i&&(i=e.daysAgo),t+=e.value*cm.getResource(n.resource).POWER})}),t/i}},{key:"addSick",value:function(e){if(this.people-=1,this.sick.push(new kE(e)),this.people-1<0)for(;this.people<0;){var t=Math.floor(Math.random()*this.callbacks.size);Array.from(this.callbacks.values())[t].fireRandomWorker()}}},{key:"getSick",value:function(){return this.sick}},{key:"addAnimalProducedData",value:function(e,t,i){this.addResourceProduction(e,t,i)}},{key:"addAnimalUsedData",value:function(e,t,i){this.addResourceUse(e,t,i)}},{key:"getHideEmpty",value:function(){return this.hideEmpty}},{key:"toggleHideEmpty",value:function(){this.hideEmpty=!this.hideEmpty}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Cm),An($v),An(_m),An(Jv),An(Om),An(_E),An(Im),An(ME))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),LE=(function(e){e.CHOPPING_TREES="chopping trees",e.WAITING_FOR_TREES="waiting for trees",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING_LOG="transporting log"}(LE||(LE={})),LE),xE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:LE.WAITING_FOR_TREES,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.LOGGERS_HUT,n,um.FOREST.LOGGERS_HUT,u,!0,!0,c)).progress=o,e.reservedTrees=s,e.status=a,e.servicesService&&(e.landService=n.getLandService()),e}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(){!this.working||(this.status===LE.WAITING_FOR_TREES?this.landService.reduceForest(1)&&(this.status=LE.CHOPPING_TREES):this.status===LE.CHOPPING_TREES?this.progress<100&&(this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.status=LE.TRANSPORTING_LOG)):(this.status===LE.TRANSPORTING_LOG||this.status===LE.WAITING_FOR_WAREHOUSE_SPACE)&&(this.resourcesService.increaseResource(Mv.LOG,1,this.getName())?(this.landService.increaseLand(1,!0),this.status=this.landService.reduceForest(1)?LE.CHOPPING_TREES:LE.WAITING_FOR_TREES):this.status=LE.WAITING_FOR_WAREHOUSE_SPACE))}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,reservedTrees:this.reservedTrees}}}]),i}(xm),FE=(function(e){e.PLANTING_TREES="planting trees",e.WAITING_FOR_LAND="waiting for land",e.NO_ENOUGH_LAND="no enough free land",e.FOREST_TOO_BIG="forest too big"}(FE||(FE={})),FE),UE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:FE.WAITING_FOR_LAND,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;return p(this,i),(e=t.call(this,r,Pv.FORESTER,n,um.FOREST.FORESTER,c,!0,!0,l)).progress=o,e.localStorage=s,e.status=a,e.effectiveness=u,e.servicesService&&(e.landService=n.getLandService(),e.modalService=n.getModalService()),e}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(){if(this.working){if(0===this.localStorage){var e=this.landService.getForestOptions();if(e.forestSizeRuleEnabled&&this.landService.getForest()>=e.forestSizeRule)return void(this.status=FE.FOREST_TOO_BIG);if(e.landSizeRuleEnabled&&this.landService.getLand()<=e.landSizeRule)return void(this.status=FE.NO_ENOUGH_LAND);this.landService.reduceLand(this.effectiveness)?(this.localStorage=this.effectiveness,this.status=FE.PLANTING_TREES):this.status=FE.WAITING_FOR_LAND}this.localStorage>0&&(this.progress<100?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):(this.landService.increaseForest(this.localStorage,!1),this.progress=0,this.localStorage=0))}}},{key:"prepareDemolish",value:function(){return this.localStorage>0&&this.landService.increaseLand(this.localStorage,!0),u(v(i.prototype),"prepareDemolish",this).call(this)}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,localStorage:this.localStorage,status:this.status,effectiveness:this.effectiveness,working:this.working}}}]),i}(xm),HE=function(){function e(t,i,n,r,o){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";p(this,e),this.enabled=t,this.buildingType=i,this.seasons=n,this.inputSettings=r,this.outputSettings=o,this.customRuleEnabled=a,this.hasCustomRule=s,this.customRuleText=u}return S(e,null,[{key:"clone",value:function(t){var i=null,n=null;return t.inputSettings&&(i=[],t.inputSettings.forEach(function(e){i.push([e[0],e[1]])})),t.outputSettings&&(n=[],t.outputSettings.forEach(function(e){n.push([e[0],e[1],e[2]])})),new e(t.enabled,t.buildingType,[t.seasons[0],t.seasons[1],t.seasons[2],t.seasons[3]],i,n,t.hasCustomRule,t.customRuleEnabled,t.customRuleText)}}]),e}(),GE=(function(e){e.FETCHING_INPUT="fetching {in}",e.WAITING_FOR_INPUT="waiting for {wait}",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.PREPARING="preparing {out}",e.PRODUCING_OUTPUT="{prod} {out}",e.TRANSPORTING_OUTPUT="transporting {out}"}(GE||(GE={})),GE),BE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],g=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,f=arguments.length>10?arguments[10]:void 0;if(p(this,i),(e=t.call(this,r,o,n,s,h,!0,!0,f)).status=a,e.progress=u,e.inputStorage=c,e.outputStorage=l,e.workSettings=g,e.productionText=s.TEXT,n)if(e.managementService=n.getManagementService(),e.calendarService=n.getCalendarService(),null===e.workSettings){var v=s.INPUT_RESOURCES.map(function(e){return[e.resource,0]}),m=s.OUTPUT_RESOURCES.map(function(t){return t.resource===Mv.COINS?[t.resource,0,!0]:[t.resource,e.resourcesService.getResource(t.resource).getLimit(),!0]});e.workSettings=new HE(!0,o,[!0,!0,!0,!0],v,m)}else if(!e.workSettings.seasons){var S=[!0,!0,!0,!0],E=[];g.outputSettings.forEach(function(e){return E.push([e[0],e[1],void 0===e[2]||e[2]])}),e.workSettings=new HE(!0,o,S,g.inputSettings,E)}return d(e)}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,workSettings:this.workSettings,buildingType:this.buildingType,progress:this.progress,status:this.status,inputStorage:this.inputStorage,outputStorage:this.outputStorage,working:this.working}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:var t=Qv.resourcesArraysDiff(this.settings.INPUT_RESOURCES,this.inputStorage),i=String(this.status);return t.length>0&&(i=i.replace("{wait}",Qv.prepareResourcesNamesList(t))),i=(i=(i=i.replace("{in}",Qv.prepareResourcesNamesList(this.settings.INPUT_RESOURCES))).replace("{out}",Qv.prepareResourcesNamesList(this.settings.OUTPUT_RESOURCES))).replace("{prod}",this.productionText+" "),Mm.textValue(i);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"isMet",value:function(){var e=this,t=!0;return this.workSettings.seasons[this.calendarService.getSeason()]||t&&(t=!1),this.workSettings.inputSettings.forEach(function(i){t&&(t=e.resourcesService.getResource(i[0]).amount>i[1])}),this.workSettings.outputSettings.forEach(function(i){t&&(t=i[2]?e.resourcesService.getResource(i[0]).amount<e.resourcesService.getResource(i[0]).limit:e.resourcesService.getResource(i[0]).amount<i[1])}),t}},{key:"tick",value:function(){this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.isWorking()||this.hireWorker():this.isWorking()&&this.status!==GE.PRODUCING_OUTPUT&&this.status!==GE.TRANSPORTING_OUTPUT&&this.fireWorker()),this.isWorking()&&(this.outputStorage.length>0?this.collectOutputResources():this.inputStorage.length<this.settings.INPUT_RESOURCES.length&&0===this.outputStorage.length?this.collectInputResources():this.progress<100?(this.status=GE.PRODUCING_OUTPUT,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.inputStorage=[],this.outputStorage=Qv.copyResourceArray(this.settings.OUTPUT_RESOURCES),this.status=GE.TRANSPORTING_OUTPUT))}},{key:"collectInputResources",value:function(){var e=this,t=!0;return this.settings.INPUT_RESOURCES.forEach(function(i){e.inputStorage.find(function(e){return e.resource===i.resource})||(e.resourcesService.decreaseResource(i.resource,i.amount,e.getName())?e.inputStorage.push({resource:i.resource,amount:i.amount}):t=!1)}),t?(this.status=GE.FETCHING_INPUT,!0):(this.status=GE.WAITING_FOR_INPUT,!1)}},{key:"collectOutputResources",value:function(){var e=this,t=!0;return this.outputStorage.forEach(function(i){e.resourcesService.increaseResource(i.resource,i.amount,e.getName())?i.amount=0:t=!1}),this.outputStorage=this.outputStorage.filter(function(e){return e.amount>0}),t?0===this.outputStorage.length?(this.status=GE.FETCHING_INPUT,!0):void 0:(this.status=GE.WAITING_FOR_WAREHOUSE_SPACE,!1)}},{key:"isComplexManagement",value:function(){return!0}},{key:"getWorkSettings",value:function(){return this.workSettings}},{key:"setWorkSettings",value:function(e){this.workSettings=e}}]),i}(xm),WE=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.SAWMILL,um.FOREST.SAWMILL,o,r,s,a,u,c,l)}return i}(BE),VE=(function(e){e.GATHERING_FOOD="gathering food",e.GATHERING_RESOURCES="gathering resources",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting"}(VE||(VE={})),VE),zE=(function(e){e[e.FOOD=0]="FOOD",e[e.RESOURCES=1]="RESOURCES"}(zE||(zE={})),zE),YE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:VE.GATHERING_FOOD,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:zE.FOOD,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[null,0],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;return p(this,i),(e=t.call(this,r,Pv.GATHERER,n,um.FOREST.GATHERER,a,!0,!0,l)).progress=o,e.status=s,e.mode=u,e.storage=c,e.lastFind=null,e.servicesService&&(e.weatherService=n.getWeatherService()),e}return S(i,[{key:"rollForFind",value:function(){var e=null;return this.mode===zE.FOOD?e=sp.randomElement([{item:Mv.BERRY,chance:this.settings.BERRY_CHANCE},{item:Mv.MUSHROOM,chance:this.settings.MUSHROOM_CHANCE},{item:Mv.WHEAT,chance:this.settings.WHEAT_CHANCE},{item:Mv.HERBS,chance:this.settings.HERBS_CHANCE}]):this.mode===zE.RESOURCES&&(e=sp.randomElement([{item:Mv.BRUSHWOOD,chance:this.settings.BRUSHWOOD_CHANCE},{item:Mv.STONE,chance:this.settings.STONE_CHANCE},{item:Mv.LOG,chance:this.settings.LOG_CHANCE},{item:Mv.COPPER,chance:this.settings.COPPER_CHANCE},{item:Mv.HERBS,chance:this.settings.HERBS_CHANCE}])),e}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,mode:this.mode}}},{key:"build",value:function(){return this.servicesService.getManagementService().getDefaultGathererFood()||(this.mode=zE.RESOURCES,this.status=VE.GATHERING_RESOURCES),u(v(i.prototype),"build",this).call(this)}},{key:"callback",value:function(e){e===zE.FOOD?(this.mode=zE.FOOD,this.progress=0,this.status=VE.GATHERING_FOOD):e===zE.RESOURCES&&(this.mode=zE.RESOURCES,this.progress=0,this.status=VE.GATHERING_RESOURCES)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.mode===zE.FOOD?Mm.buttonValue("gather resources",zE.RESOURCES):Mm.buttonValue("gather food",zE.FOOD);case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return null!=this.lastFind?Mm.textValue("last find: "+Qv.prepareResourceName(this.lastFind)):Mm.emptyValue()}}},{key:"tick",value:function(e){if(this.working)if(this.storage[1]>0)this.resourcesService.increaseResource(this.storage[0],this.storage[1],this.getName()),this.storage=[null,0],this.setStatus();else if(this.progress<100)this.progress+=this.getPower(),this.progress>100&&(this.progress=100);else if(100===this.progress){this.progress=0;var t=this.rollForFind();if(null!==t&&!this.resourcesService.hasLimit(t))return void(t=null);t?(this.lastFind=t,this.storage=[t,1],this.status=VE.TRANSPORTING):(this.lastFind=Mv.NOTHING,this.progress=0)}}},{key:"setStatus",value:function(){this.status=this.mode===zE.FOOD?VE.GATHERING_FOOD:VE.GATHERING_RESOURCES}}]),i}(xm),jE=(function(e){e.MINING_STONE="mining stone",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more resources",e.TRANSPORTING="transporting"}(jE||(jE={})),jE),KE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jE.MINING_STONE,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:200,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;return p(this,i),(e=t.call(this,r,Pv.QUARRY,n,um.MOUNTAINS.QUARRY,a,!0,!0,l)).progress=o,e.status=s,e.storage=u,e.resources=c,e.servicesService&&(e.gameService=n.getGameService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,resources:this.resources}}},{key:"build",value:function(){return this.startProduction(),this.gameService.enable(wv.BUILT_QUARRY),this}},{key:"buildOnMountain",value:function(){return!0}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("stone: "+this.resources);case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"isStoppable",value:function(){return this.resources>0}},{key:"isUsedUp",value:function(){return this.status===jE.NO_MORE_RESOURCES}},{key:"hasBuff",value:function(){return!this.isUsedUp()&&u(v(i.prototype),"hasBuff",this).call(this)}},{key:"tick",value:function(e){this.resources<=0&&(this.status!==jE.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Quarry mined all stone"),this.status=jE.NO_MORE_RESOURCES,this.stopProduction()),this.working&&(this.storage>0?this.resourcesService.increaseResource(Mv.STONE,this.storage,this.getName())?(this.storage=0,this.status=jE.MINING_STONE):this.status=jE.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=jE.MINING_STONE,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=jE.TRANSPORTING))}}]),i}(xm),QE=(function(e){e.RESEARCHING="researching",e.CRAFTING="crafting {craft}",e.WAITING_FOR_WAREHOUSE="waiting for {craft} space",e.NO_RESEARCH="nothing to research",e.NO_CRAFTING="nothing to craft"}(QE||(QE={})),QE),qE=(function(e){e[e.RESEARCH=0]="RESEARCH",e[e.CRAFT=1]="CRAFT",e[e.SWITCH_TO_RESEARCH=2]="SWITCH_TO_RESEARCH"}(qE||(qE={})),qE),XE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:QE.NO_RESEARCH,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qE.RESEARCH,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;return p(this,i),(e=t.call(this,r,Pv.WORKSHOP,n,um.VILLAGE.WORKSHOP,u,!0,!0,h)).progress=o,e.status=s,e.mode=a,e.storage=d,e.recipe=null,e.icon=null,e.servicesService&&(l?e.recipe=l:c>=0&&(e.recipe=e.servicesService.getRecipeService().getRecipeById(c)),e.craftingService=n.getService(Zv.CRAFTING),e.techService=n.getTechService(),e.gameService=n.getGameService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,mode:this.mode,working:this.working,recipeId:null!==this.recipe?this.recipe.id:-1,storage:this.storage}}},{key:"build",value:function(){this.servicesService.getManagementService().getDefaultWorkshopResearch()||(this.mode=qE.CRAFT),this.startProduction();var e=this.servicesService.getLogService();return this.gameService.isEnabled(wv.RESEARCH)||(this.gameService.enable(wv.RESEARCH),e.log("Researching unlocked")),this.gameService.isEnabled(wv.CRAFTING)||(this.gameService.enable(wv.CRAFTING),e.log("Crafting unlocked")),this.craftingService.increaseCraftingQueueSize(1),this}},{key:"prepareDemolish",value:function(){return this.craftingService.decreaseCraftingQueueSize(1),u(v(i.prototype),"prepareDemolish",this).call(this)}},{key:"callback",value:function(e){var t=this;if("switch"===e){if(this.mode===qE.RESEARCH)this.progress=0,this.mode=qE.CRAFT,this.recipe=this.craftingService.getCraftingOrder(),this.icon=null,this.status=null!==this.recipe?QE.CRAFTING:QE.NO_CRAFTING;else if(this.mode===qE.SWITCH_TO_RESEARCH)this.mode=qE.CRAFT,this.status=null!==this.recipe?QE.CRAFTING:QE.NO_CRAFTING;else if(this.mode===qE.CRAFT)if(this.recipe){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Workshop will switch to research after finishing current craft.");var i=this.modalService.registerForConfirmation().subscribe(function(e){i.unsubscribe(),e&&(t.mode=qE.SWITCH_TO_RESEARCH)})}else this.progress=0,this.mode=qE.RESEARCH,this.status=this.techService.isResearchStarted()?QE.RESEARCHING:QE.NO_RESEARCH}else"cancel"===e&&(this.recipe=null,this.progress=0,this.mode===qE.SWITCH_TO_RESEARCH?(this.mode=qE.RESEARCH,this.status=this.techService.isResearchStarted()?QE.RESEARCHING:QE.NO_RESEARCH):this.status=QE.NO_CRAFTING)}},{key:"switchToResearch",value:function(){this.mode===qE.CRAFT&&(this.recipe?this.mode=qE.SWITCH_TO_RESEARCH:(this.progress=0,this.mode=qE.RESEARCH,this.status=this.techService.isResearchStarted()?QE.RESEARCHING:QE.NO_RESEARCH))}},{key:"switchToCrafting",value:function(){this.mode===qE.RESEARCH?(this.progress=0,this.mode=qE.CRAFT,this.recipe=this.craftingService.getCraftingOrder(),this.icon=null,this.status=null!==this.recipe?QE.CRAFTING:QE.NO_CRAFTING):this.mode===qE.SWITCH_TO_RESEARCH&&(this.mode=qE.CRAFT,this.status=null!==this.recipe?QE.CRAFTING:QE.NO_CRAFTING)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.firstLine();case Dm.SECOND:return this.recipe?(this.icon||(this.prepareIcon(),this.status===QE.CRAFTING?this.icon[0].prefix="crafting ":this.status===QE.WAITING_FOR_WAREHOUSE&&(this.icon[0].prefix="waiting for ",this.icon[0].suffix=" space")),Mm.iconValue(this.icon)):Mm.textValue(this.status.replace("{craft}","warehouse"));case Dm.THIRD:if(this.recipe)return Mm.buttonValue("cancel crafting","cancel");var t="";return this.techService.getCurrentResearch()&&(t=Qv.prepareTechName(this.techService.getCurrentResearch().getTech())),Mm.textValue(t);case Dm.FOURTH:return Mm.progressValue(this.progress)}}},{key:"firstLine",value:function(){return Mm.buttonValue(this.mode===qE.RESEARCH||this.mode===qE.SWITCH_TO_RESEARCH?"craft":"research","switch")}},{key:"tick",value:function(e){if(this.working)if(this.mode===qE.RESEARCH)this.techService.isResearchStarted()?(this.status!==QE.RESEARCHING&&(this.progress=0),this.status=QE.RESEARCHING,this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.techService.progressTech(um.VILLAGE.WORKSHOP.RESEARCH_POWER))):(this.status=QE.NO_RESEARCH,this.progress=0);else if(this.mode===qE.CRAFT||this.mode===qE.SWITCH_TO_RESEARCH)if(null===this.recipe&&(this.recipe=this.craftingService.getCraftingOrder(),this.icon=null,this.progress=0),null===this.recipe)this.status=QE.NO_CRAFTING;else if(this.status===QE.WAITING_FOR_WAREHOUSE){var t=this.resourcesService.getLimit(this.recipe.resource);this.storage>t?(this.storage-=t,this.resourcesService.increaseResource(this.recipe.resource,t,this.getName())):(this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName()),this.status=QE.CRAFTING,this.progress=0,this.recipe=null)}else if(this.status=QE.CRAFTING,this.progress<100&&(this.progress+=this.getPower()/this.recipe.craftingDifficulty*um.VILLAGE.WORKSHOP.CRAFTING_POWER),this.progress>=100){this.progress=100,this.storage=this.recipe.amount;var i=this.resourcesService.getLimit(this.recipe.resource);this.storage>i?(this.storage-=i,this.resourcesService.increaseResource(this.recipe.resource,i,this.getName()),this.status=QE.WAITING_FOR_WAREHOUSE,this.icon=null):this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName())?(this.progress=0,this.storage=0,this.recipe=null,this.mode===qE.SWITCH_TO_RESEARCH&&(this.mode=qE.RESEARCH,this.status=this.techService.isResearchStarted()?QE.RESEARCHING:QE.NO_RESEARCH)):(this.status=QE.WAITING_FOR_WAREHOUSE,this.icon=null)}}},{key:"getRecipe",value:function(){return this.recipe}},{key:"cancelCrafting",value:function(){this.recipe=null}},{key:"willResearch",value:function(){return this.mode===qE.RESEARCH||this.mode===qE.SWITCH_TO_RESEARCH}},{key:"prepareIcon",value:function(){this.recipe&&(this.icon=[{name:Qv.prepareResourceName(this.recipe.resource),path:"resources",prefix:"",suffix:""}])}}]),i}(xm),ZE=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hv.NONE,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return p(this,i),(e=t.call(this,r,Pv.WAREHOUSE,n,um.VILLAGE.WAREHOUSE,!1,!0,!1,a)).resource=o,e.storage=s,e.servicesService&&(e.modalService=n.getModalService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,resource:this.resource,storage:this.storage}}},{key:"callback",value:function(e){var t=this;if(this.resource===Hv.NONE)this.resource=Hv[String(e.target.value)],this.resourcesService.increaseLimit(this.resource,this.storage);else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to switch warehouse storage type?<br>All excess resources will be lost");var i=this.modalService.registerForConfirmation().subscribe(function(n){n?(t.resourcesService.decreaseLimit(t.resource,t.storage),t.resource=Hv[String(e.target.value)],t.resourcesService.increaseLimit(t.resource,t.storage)):e.target.selectedIndex=t.resource-1,i.unsubscribe()})}}},{key:"getComplexity",value:function(){return u(v(i.prototype),"getComplexity",this).call(this)*(this.storage/this.settings.SIZE)}},{key:"getSize",value:function(){return this.storage}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.firstLine();case Dm.SECOND:return Mm.textValue("storage: "+this.storage);case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"firstLine",value:function(){var e=[];return e.push(Hv[Hv.NONE]),e.push(Hv[Hv.RAW]),e.push(Hv[Hv.PROCESSED]),e.push(Hv[Hv.FOOD]),e.push(Hv[Hv.TOOLS]),Mm.dropdownValue(e,Hv[this.resource])}},{key:"prepareDemolish",value:function(){return this.resourcesService.decreaseLimit(this.resource,this.storage),!0}},{key:"startProduction",value:function(){return!1}},{key:"stopProduction",value:function(){}},{key:"fireWorker",value:function(){return!1}},{key:"hireWorker",value:function(){return!1}},{key:"getWorkers",value:function(){return 0}},{key:"getHappinessEffect",value:function(){return 0}},{key:"isCombinable",value:function(){return!0}},{key:"isSplittable",value:function(){return!0}},{key:"combine",value:function(e,t){var i=this;if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will store <b>"+Qv.prepareResourceTypeName(this.resource)+" resources</b><br>All resources exceeding decreased limit of <b>"+Qv.prepareResourceTypeName(e.resource)+"</b> will be lost");var n=this.modalService.registerForConfirmation().subscribe(function(r){n.unsubscribe(),r?i.doCombine(e,t):t.finaliseCombine(!1)})}}},{key:"doCombine",value:function(e,t){this.storage+=e.getSize(),this.resource!==Hv.NONE&&this.resourcesService.increaseLimit(this.resource,e.getSize()),t.finaliseCombine(!0)}},{key:"split",value:function(e){var t=this;this.modalService.open(_v.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");var n=this.modalService.registerForValueResponse().subscribe(function(r){n.unsubscribe(),null!==r&&!isNaN(r)&&0!==r&&(r>=1&&r<t.getSize()?(t.storage-=Number(r),e.finaliseSplit(new i(t.servicesService,t.servicesService.getIdService().getNextId(),t.resource,Number(r)).build())):t.modalService.info("Invalid size value!"))})}},{key:"isCompatible",value:function(e){return this.resource===e.resource}}]),i}(xm),$E=(function(e){e.HUNTING="hunting",e.TAME="taming animals",e.WAITING_FOR_PASTURE_SPACE="waiting for pasture space",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting"}($E||($E={})),$E),JE=(function(e){e[e.HUNTING=0]="HUNTING",e[e.TAMING=1]="TAMING"}(JE||(JE={})),JE),ey=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$E.HUNTING,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:JE.HUNTING,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;return p(this,i),(e=t.call(this,r,Pv.HUNTER_LODGE,n,um.FOREST.HUNTER_LODGE,u,!0,!0,d)).progress=o,e.status=s,e.mode=a,e.storage=c,e.storage2=l,e.animal=h,e.lastFind=null,e.servicesService&&(e.weatherService=n.getWeatherService(),e.gameService=n.getGameService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,mode:this.mode,working:this.working,storage:this.storage,storage2:this.storage2,animal:this.animal}}},{key:"callback",value:function(e){"tame"===e?(this.mode=JE.TAMING,this.progress=0,this.storage=0,this.storage2=0,this.status=$E.TAME):(this.mode=JE.HUNTING,this.progress=0,this.storage=0,this.storage2=0,this.lastFind=null,this.status=$E.HUNTING)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.gameService.isEnabled(wv.PASTURE)?this.mode===JE.HUNTING?Mm.buttonValue("tame animals","tame"):Mm.buttonValue("hunt","hunt"):Mm.emptyValue();case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return null!==this.lastFind?Mm.textValue("last tamed: "+Qv.prepareResourceName(this.lastFind)):Mm.emptyValue()}}},{key:"tick",value:function(e){if(this.working)if(this.mode===JE.HUNTING)this.status=0!==this.storage&&0!==this.storage2?$E.TRANSPORTING:$E.HUNTING,this.status===$E.HUNTING?this.progress<100&&(this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.storage<5&&(this.storage+=sp.randomBetween(1,3),this.storage>5&&(this.storage=5)),this.storage2<5&&(this.storage2+=sp.randomBetween(0,2),this.storage2>5&&(this.storage2=5)),this.status=$E.TRANSPORTING)):(this.status===$E.TRANSPORTING||this.status===$E.WAITING_FOR_WAREHOUSE_SPACE)&&(0!==this.storage&&this.resourcesService.increaseResource(Mv.MEAT,this.storage,this.getName())&&(this.storage=0),0!==this.storage2&&this.resourcesService.increaseResource(Mv.FUR,this.storage2,this.getName())&&(this.storage2=0),0!==this.storage&&0!==this.storage2&&(this.status=$E.WAITING_FOR_WAREHOUSE_SPACE));else if(this.mode===JE.TAMING)if(this.status===$E.TAME){if(this.progress<100&&(this.progress+=this.getPower(),this.progress>=100)){this.progress=0;var t=[];this.resourcesService.hasLimit(Mv.CHICKEN)&&t.push({item:Mv.CHICKEN,chance:6}),this.resourcesService.hasLimit(Mv.SHEEP)&&t.push({item:Mv.SHEEP,chance:5}),this.resourcesService.hasLimit(Mv.PIG)&&t.push({item:Mv.PIG,chance:5}),this.resourcesService.hasLimit(Mv.COW)&&t.push({item:Mv.COW,chance:4}),this.resourcesService.hasLimit(Mv.HORSE)&&t.push({item:Mv.HORSE,chance:3}),0===t.length&&!this.servicesService.getManagementService().getSwitchHunterFromTaming()&&(this.logService.log("No more space for animals. Hunter switched to hunting"),this.callback("hunt"));var i=sp.randomElement(t);null!=i?(this.lastFind=i,this.animal=i,this.status=$E.TRANSPORTING):(this.lastFind=Mv.NOTHING,this.animal=null)}}else(this.status===$E.TRANSPORTING||this.status===$E.WAITING_FOR_PASTURE_SPACE)&&this.animal&&(this.resourcesService.increaseResource(this.animal,1,this.getName())?(this.animal=null,this.status=$E.TAME):this.status=$E.WAITING_FOR_PASTURE_SPACE)}}]),i}(xm),ty=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return p(this,i),(e=t.call(this,r,Pv.SHRINE,n,um.VILLAGE.SHRINE,!1,!0,!1,s)).progress=o,e.servicesService&&(e.religionService=n.getService(Zv.RELIGION)),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress}}},{key:"build",value:function(){return this.religionService.increaseFaithCap(10),this.servicesService.getGameService().enable(wv.RELIGION),this}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:case Dm.SECOND:return Mm.emptyValue();case Dm.THIRD:return Mm.progressValue(this.progress,"prayers");case Dm.FOURTH:return Mm.emptyValue()}}},{key:"prepareDemolish",value:function(){return this.religionService.decreaseFaithCap(10),!0}},{key:"startProduction",value:function(){return!0}},{key:"stopProduction",value:function(){}},{key:"tick",value:function(e){var t=this.servicesService.getVillageService().getPopulation();this.progress+=.01*(Math.pow(Math.log(t),2)+1)*this.getPower(),this.progress>100&&(this.progress=0,this.religionService.increaseFaith(1))}},{key:"fireWorker",value:function(){return!1}},{key:"hireWorker",value:function(){return!1}},{key:"getWorkers",value:function(){return 0}}]),i}(xm),iy=(function(e){e.WORKING="working",e.BAD_WEATHER="bad weather",e.STOPPED="stopped"}(iy||(iy={})),iy),ny=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:iy.WORKING,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return p(this,i),(e=t.call(this,r,Pv.FARM,n,um.FIELD.FARM,o>0,!0,!0,a)).workers=o,e.maxWorkers=s,e.status=u,e.workSettings=c,e.servicesService&&(e.weatherService=n.getWeatherService(),e.calendarService=n.getCalendarService(),e.managementService=n.getManagementService(),e.fieldService=n.getServiceByRegion(Yv.FIELD),null===c&&(e.workSettings=new HE(!0,e.getBuildingType(),[!0,!0,!0,!0],null,null))),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,workers:this.workers,maxWorkers:this.maxWorkers,workSettings:this.workSettings}}},{key:"callback",value:function(e){"hire"===e&&this.workers<this.maxWorkers&&this.resourcesService.hireWorker()?this.workers+=1:"fire"===e&&this.workers>0&&(this.resourcesService.fireWorker(),this.workers-=1)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("workers: "+this.workers+"/"+this.maxWorkers);case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.twoButtonValue("hire worker","hire","","fire worker","fire");case Dm.FOURTH:return Mm.emptyValue()}}},{key:"isWorking",value:function(){return this.workers>0}},{key:"startProduction",value:function(){if(0===this.workers){for(;this.workers<this.maxWorkers&&this.resourcesService.hireWorker();)this.workers+=1;if(this.workers>0)return!0}return!1}},{key:"stopProduction",value:function(){this.workers>0&&(this.resourcesService.fireWorker(this.workers),this.workers=0)}},{key:"isMet",value:function(){var e=!0;return this.workSettings.seasons[this.calendarService.getSeason()]||e&&(e=!1),e}},{key:"tick",value:function(e){var t=this;this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.workers<this.maxWorkers&&this.hireWorker():this.isWorking()&&this.stopProduction()),this.workers>0?this.weatherService.isWeather(tp.RAIN,tp.STORM)?this.weatherService.isWeather(tp.STORM)?this.status=iy.BAD_WEATHER:function(){t.status=iy.WORKING;for(var e=t.workers;e>0;){var i=t.fieldService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.PASTURE&&e.hasWork()});if(0===i.length){t.status=iy.BAD_WEATHER;break}i.forEach(function(i){e>0&&i.work(t.getPower())&&(e-=1)})}}():function(){t.status=iy.WORKING;for(var e=t.workers;e>0;){var i=t.fieldService.getBuildings().filter(function(e){return(e.getBuildingType()===Pv.FIELD||e.getBuildingType()===Pv.ORCHARD||e.getBuildingType()===Pv.PASTURE)&&e.hasWork()});if(0===i.length)break;i.forEach(function(i){e>0&&i.work(t.getPower())&&(e-=1)})}}():this.status=iy.STOPPED}},{key:"fireWorker",value:function(){return this.workers>0&&(this.resourcesService.fireWorker(1),this.workers-=1,!0)}},{key:"hireWorker",value:function(){return!!(this.workers<this.maxWorkers&&this.resourcesService.hireWorker())&&(this.workers+=1,!0)}},{key:"getWorkers",value:function(){return this.workers}},{key:"setBuildingLevel",value:function(e){u(v(i.prototype),"setBuildingLevel",this).call(this,e),this.maxWorkers=2+2*e}},{key:"isComplexManagement",value:function(){return!0}},{key:"getWorkSettings",value:function(){return this.workSettings}},{key:"setWorkSettings",value:function(e){this.workSettings=e}}]),i}(xm),ry=(function(e){e.PLOW_FIELD="plowing {crop} field",e.SOWING="sowing {crop}",e.GROWING="{crop} growing",e.HARVEST="harvesting {crop}",e.FALLOW="fallow"}(ry||(ry={})),ry),oy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:um.FIELD.FIELD.SIZE,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uv.NONE,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ry.FALLOW,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),(e=t.call(this,r,Pv.FIELD,n,um.FIELD.FIELD,c,!0,!0,h)).currentSize=o,e.crop=s,e.status=a,e.progress=u,e.growth=l,e.servicesService&&(e.gameService=n.getGameService(),e.modalService=n.getModalService(),e.weatherService=n.getWeatherService(),e.calendarService=n.getCalendarService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,size:this.currentSize,crop:this.crop,status:this.status,progress:this.progress,working:this.working,growth:this.growth}}},{key:"getSize",value:function(){return this.currentSize}},{key:"getComplexity",value:function(){return u(v(i.prototype),"getComplexity",this).call(this)*(this.getSize()/this.settings.SIZE)}},{key:"callback",value:function(e){var t=this;if(this.crop===Uv.NONE||this.status===ry.FALLOW)this.crop=Uv[String(e.target.value)],this.status=ry.FALLOW,this.progress=0;else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to switch field crop type?<br>All field progress will be lost");var i=this.modalService.registerForConfirmation().subscribe(function(n){n?(t.crop=Uv[String(e.target.value)],t.status=ry.FALLOW,t.progress=0):e.target.selectedIndex=t.crop,i.unsubscribe()})}}},{key:"finishDemolish",value:function(){}},{key:"getLine",value:function(e){var t=this;switch(e){case Dm.FIRST:return Mm.textValue("size: "+this.getSize());case Dm.SECOND:var i=[];return i.push(Uv[Uv.NONE]),Object.entries(Object(hm.FIELD)).forEach(function(e){hm.getCrop(Uv[e[0]]).PREREQUISITE?t.gameService.isEnabled(hm.getCrop(Uv[e[0]]).PREREQUISITE)&&i.push(e[0]):i.push(e[0])}),Mm.dropdownValue(i,Uv[this.crop]);case Dm.THIRD:return Mm.textValue(this.status.replace("{crop}",Uv[this.crop].toLowerCase()));case Dm.FOURTH:return this.status===ry.HARVEST?Mm.progressValue(Math.floor(this.growth/(hm.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize())*100),"harvest: "+this.growth):Mm.progressValue(this.progress)}}},{key:"getName",value:function(){return this.crop===Uv.NONE?"Field":Uv[this.crop].charAt(0).toUpperCase()+Uv[this.crop].slice(1).toLowerCase()+" field"}},{key:"startProduction",value:function(){return this.working=!0,!0}},{key:"stopProduction",value:function(){this.working=!1}},{key:"tick",value:function(e){if(this.calendarService.getSeason()===ym.WINTER&&(this.status=ry.FALLOW,this.growth=0,this.progress=0),this.status===ry.GROWING)if(this.calendarService.getSeason()===ym.AUTUMN)this.status=ry.HARVEST,this.growth=Math.floor(this.progress*hm.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize()/100),this.progress=0;else if(this.progress<100){var t=this.getPower()*(1+this.effectsService.getNatureEffectsValue()/100)/hm.getCrop(this.crop).GROWTH;this.weatherService.getCurrentTemperature()<=5?t*=0:this.weatherService.getCurrentTemperature()<=10?t*=.2:this.weatherService.getCurrentTemperature()<=15?t*=.5:this.weatherService.getCurrentTemperature()<=20?t*=.8:this.weatherService.getCurrentTemperature()<=25?t*=1:this.weatherService.getCurrentTemperature()<=27?t*=.8:this.weatherService.getCurrentTemperature()<=29?t*=.6:this.weatherService.getCurrentTemperature()<=31?t*=.4:this.weatherService.getCurrentTemperature()<=33?t*=.2:this.weatherService.getCurrentTemperature()<=35&&(t*=0),this.progress+=t,this.progress>100&&(this.progress=100)}else 100===this.progress&&(this.growth=this.getSize()*hm.getCrop(this.crop).YIELD_MULTIPLIER,this.progress=0,this.status=ry.HARVEST)}},{key:"work",value:function(e){if(this.isWorking()&&this.status!==ry.GROWING&&this.crop!==Uv.NONE){if(this.status===ry.FALLOW&&this.calendarService.getSeason()===ym.SPRING)return this.status=ry.PLOW_FIELD,!0;if(this.status===ry.PLOW_FIELD&&(this.calendarService.getSeason()===ym.SPRING||this.calendarService.getSeason()===ym.SUMMER&&this.servicesService.getManagementService().getPlowInSummer()))return this.progress<100&&(this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=ry.SOWING)),!0;if(this.status===ry.SOWING&&(this.calendarService.getSeason()===ym.SPRING||this.calendarService.getSeason()===ym.SUMMER))return this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=ry.GROWING),!0;if(this.status===ry.HARVEST){var t=Mv[Uv[this.crop]];if(this.resourcesService.hasLimit(t))return this.resourcesService.increaseResource(t,1,this.getName()),this.growth-=1,this.growth<=0&&(this.status=ry.FALLOW),!0}}return!1}},{key:"fireWorker",value:function(){return!1}},{key:"hireWorker",value:function(){return!1}},{key:"getWorkers",value:function(){return 0}},{key:"hasWork",value:function(){return this.isWorking()&&this.status!==ry.GROWING&&this.crop!==Uv.NONE&&(this.status===ry.FALLOW&&this.calendarService.getSeason()===ym.SPRING||this.status===ry.PLOW_FIELD&&(this.calendarService.getSeason()===ym.SPRING||this.calendarService.getSeason()===ym.SUMMER&&this.servicesService.getManagementService().getPlowInSummer())||this.status===ry.SOWING&&(this.calendarService.getSeason()===ym.SPRING||this.calendarService.getSeason()===ym.SUMMER)||this.status===ry.HARVEST&&this.resourcesService.hasLimit(Mv[Uv[this.crop]]))}},{key:"getDetails",value:function(){return this.crop!==Uv.NONE?"growing difficulty: "+hm.getCrop(this.crop).GROWTH+"<br>yield multiplier: "+hm.getCrop(this.crop).YIELD_MULTIPLIER+"<br>"+u(v(i.prototype),"getDetails",this).call(this):u(v(i.prototype),"getDetails",this).call(this)}},{key:"getHappinessEffect",value:function(){return 0}},{key:"isCombinable",value:function(){return!0}},{key:"isSplittable",value:function(){return!0}},{key:"combine",value:function(e,t){var i=this;if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{var n;if(this.modalService.open(_v.CONFIRM),this.crop===e.crop?(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow if both are in different stages"),n=!0):(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow"),n=!0),n)var r=this.modalService.registerForConfirmation().subscribe(function(n){r.unsubscribe(),n?i.doCombine(e,t):t.finaliseCombine(!1)})}}},{key:"doCombine",value:function(e,t){if(this.crop===e.crop)if(this.status===e.status)if(this.status===ry.HARVEST)this.growth+=e.growth;else{var i=this.progress*this.getSize();i+=e.progress*e.getSize(),this.progress=i/(this.getSize()+e.getSize())}else this.status=ry.FALLOW,this.progress=0,this.growth=0;else this.status=ry.FALLOW,this.progress=0,this.growth=0;this.currentSize+=e.getSize(),t.finaliseCombine(!0)}},{key:"split",value:function(e){var t=this;this.modalService.open(_v.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");var n=this.modalService.registerForValueResponse().subscribe(function(r){if(n.unsubscribe(),null!==r&&!isNaN(r)&&0!==r)if(r>=1&&r<t.getSize()){var o=Math.floor(t.growth*r/t.currentSize);t.growth-=o,t.currentSize-=Number(r),e.finaliseSplit(new i(t.servicesService,t.servicesService.getIdService().getNextId(),Number(r),t.crop,t.status,t.progress,!0,o,t.level).build())}else t.modalService.info("Invalid size value!")})}},{key:"isCompatible",value:function(e){return this.crop===e.crop&&this.status===e.status}}]),i}(xm),sy=(function(e){e.FALLOW="fallow",e.PLANTING="planting {crop}",e.GROWING="{crop} growing",e.FRUITING="{crop} fruiting",e.HARVEST="picking {crop}",e.NO_FRUITS="no fruits",e.CLEAR="clear old plants"}(sy||(sy={})),sy),ay=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:um.FIELD.ORCHARD.SIZE,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uv.NONE,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:sy.FALLOW,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),(e=t.call(this,r,Pv.ORCHARD,n,um.FIELD.ORCHARD,c,!0,!0,h)).currentSize=o,e.crop=s,e.status=a,e.progress=u,e.growth=l,e.servicesService&&(e.modalService=n.getModalService(),e.weatherService=n.getWeatherService(),e.calendarService=n.getCalendarService(),e.royalService=n.getRoyalService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,size:this.currentSize,crop:this.crop,status:this.status,progress:this.progress,working:this.working,growth:this.growth}}},{key:"getSize",value:function(){return this.currentSize}},{key:"getComplexity",value:function(){return u(v(i.prototype),"getComplexity",this).call(this)*(this.getSize()/this.settings.SIZE)}},{key:"callback",value:function(e){var t=this;if(this.crop===Uv.NONE||this.status===sy.FALLOW)this.crop=Uv[String(e.target.value)],this.status=sy.FALLOW,this.progress=0;else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to switch orchard plant type?<br>All orchard progress will be lost");var i=this.modalService.registerForConfirmation().subscribe(function(n){i.unsubscribe(),n?(t.crop=Uv[String(e.target.value)],t.status=t.status===sy.FALLOW||t.status===sy.PLANTING?sy.FALLOW:sy.CLEAR,t.progress=0):e.target.selectedIndex=t.prepareParams().indexOf(Uv[t.crop])})}}},{key:"prepareParams",value:function(){var e=this,t=[];return t.push(Uv[Uv.NONE]),Object.entries(Object(hm.ORCHARD)).forEach(function(i){hm.getCrop(Uv[i[0]]).PREREQUISITE?e.gameService.isEnabled(hm.getCrop(Uv[i[0]]).PREREQUISITE)&&t.push(i[0]):t.push(i[0])}),t}},{key:"finishDemolish",value:function(){}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("size: "+this.getSize());case Dm.SECOND:return Mm.dropdownValue(this.prepareParams(),Uv[this.crop]);case Dm.THIRD:return Mm.textValue(this.status.replace("{crop}",Uv[this.crop].toLowerCase()));case Dm.FOURTH:return this.status===sy.HARVEST?Mm.progressValue(Math.floor(this.growth/(hm.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize())*100),"harvest: "+this.growth):this.status===sy.NO_FRUITS?Mm.emptyValue():Mm.progressValue(this.progress)}}},{key:"getName",value:function(){return this.crop===Uv.NONE?"Orchard":Uv[this.crop].charAt(0).toUpperCase()+Uv[this.crop].slice(1).toLowerCase()+" orchard"}},{key:"startProduction",value:function(){return this.working=!0,!0}},{key:"stopProduction",value:function(){this.working=!1}},{key:"tick",value:function(e){if(this.crop!==Uv.NONE){if(this.status!==sy.FALLOW&&this.status!==sy.CLEAR&&this.calendarService.getSeason()===ym.WINTER){if(this.status===sy.GROWING)return;this.status=sy.NO_FRUITS,this.growth=0,this.progress=0}else this.status===sy.NO_FRUITS&&(this.calendarService.getSeason()===ym.SPRING||this.calendarService.getSeason()===ym.SUMMER)&&(this.status=sy.FRUITING);if(this.status===sy.GROWING||this.status===sy.FRUITING)if(this.calendarService.getSeason()===ym.AUTUMN&&this.status===sy.FRUITING)this.status=sy.HARVEST,this.growth=Math.floor(this.progress*hm.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize()/100),this.progress=0;else if(this.progress<100){var t=this.getPower()*(1+this.effectsService.getNatureEffectsValue()/100);this.status===sy.GROWING?t/=hm.getCrop(this.crop).GROWTH:this.status===sy.FRUITING&&(t/=hm.getCrop(this.crop).FRUITING),this.weatherService.getCurrentTemperature()<=5?t*=0:this.weatherService.getCurrentTemperature()<=10?t*=.2:this.weatherService.getCurrentTemperature()<=15?t*=.5:this.weatherService.getCurrentTemperature()<=20?t*=.8:this.weatherService.getCurrentTemperature()<=25?t*=1:this.weatherService.getCurrentTemperature()<=27?t*=.8:this.weatherService.getCurrentTemperature()<=29?t*=.6:this.weatherService.getCurrentTemperature()<=31?t*=.4:this.weatherService.getCurrentTemperature()<=33?t*=.2:this.weatherService.getCurrentTemperature()<=35&&(t*=0),this.progress+=t,this.progress>100&&(this.progress=100)}else 100===this.progress&&(this.status===sy.GROWING?this.status=sy.FRUITING:this.status===sy.FRUITING&&(this.growth=hm.getCrop(this.crop).YIELD_MULTIPLIER*this.getSize(),this.status=sy.HARVEST),this.progress=0)}}},{key:"work",value:function(e){if(this.isWorking()&&this.status!==sy.GROWING&&this.crop!==Uv.NONE)if(this.status===sy.FALLOW){if(this.calendarService.getSeason()===ym.SPRING)return this.status=sy.PLANTING,!0}else{if(this.status===sy.PLANTING)return this.progress<100&&(this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=sy.GROWING)),!0;if(this.status===sy.HARVEST){var t=Mv[Uv[this.crop]];if(this.resourcesService.hasLimit(t))return t===Mv.APPLE&&this.royalService.pickGoldenApple()||(this.resourcesService.increaseResource(t,1,this.getName()),this.growth-=1,this.growth<=0&&(this.status=sy.NO_FRUITS)),!0}else if(this.status===sy.CLEAR)return this.progress<100&&(this.progress+=e/this.getSize(),this.progress>=100&&(this.progress=0,this.status=sy.FALLOW)),!0}return!1}},{key:"fireWorker",value:function(){return!1}},{key:"hireWorker",value:function(){return!1}},{key:"getWorkers",value:function(){return 0}},{key:"hasWork",value:function(){return this.isWorking()&&this.status!==sy.GROWING&&this.crop!==Uv.NONE&&(this.status===sy.FALLOW&&this.calendarService.getSeason()===ym.SPRING||this.status===sy.PLANTING||this.status===sy.CLEAR||this.status===sy.HARVEST&&this.resourcesService.hasLimit(Mv[Uv[this.crop]]))}},{key:"getDetails",value:function(){return this.crop!==Uv.NONE?"growing difficulty: "+hm.getCrop(this.crop).GROWTH+"<br>fruiting difficulty: "+hm.getCrop(this.crop).FRUITING+"<br>yield multiplier: "+hm.getCrop(this.crop).YIELD_MULTIPLIER+"<br>"+u(v(i.prototype),"getDetails",this).call(this):u(v(i.prototype),"getDetails",this).call(this)}},{key:"getHappinessEffect",value:function(){return 0}},{key:"isCombinable",value:function(){return!0}},{key:"isSplittable",value:function(){return!0}},{key:"combine",value:function(e,t){var i=this;if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{var n;if(this.modalService.open(_v.CONFIRM),this.crop===e.crop?(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow if both are in different stages"),n=!0):(this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will be changed to fallow"),n=!0),n)var r=this.modalService.registerForConfirmation().subscribe(function(n){r.unsubscribe(),n?i.doCombine(e,t):t.finaliseCombine(!1)})}}},{key:"doCombine",value:function(e,t){if(this.crop===e.crop)if(this.status===e.status)if(this.status===sy.HARVEST)this.growth+=e.growth;else{var i=this.progress*this.getSize();i+=e.progress*e.getSize(),this.progress=i/(this.getSize()+e.getSize())}else this.status=sy.FALLOW,this.progress=0,this.growth=0;else this.status=sy.FALLOW,this.progress=0,this.growth=0;this.currentSize+=e.getSize(),t.finaliseCombine(!0)}},{key:"split",value:function(e){var t=this;this.modalService.open(_v.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");var n=this.modalService.registerForValueResponse().subscribe(function(r){if(n.unsubscribe(),null!==r&&!isNaN(r)&&0!==r)if(r>=1&&r<t.getSize()){var o=Math.floor(t.growth*r/t.currentSize);t.growth-=o,t.currentSize-=Number(r),e.finaliseSplit(new i(t.servicesService,t.servicesService.getIdService().getNextId(),Number(r),t.crop,t.status,t.progress,!0,o,t.level).build())}else t.modalService.info("Invalid size value!")})}},{key:"isCompatible",value:function(e){return this.crop===e.crop&&this.status===e.status}}]),i}(xm),uy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.WINDMILL,um.FIELD.WINDMILL,o,r,s,a,u,c,l)}return i}(BE),cy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.BAKERY,um.VILLAGE.BAKERY,o,r,s,a,u,c,l)}return i}(BE),ly=(function(e){e.FISHING="fishing",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING_FISH="transporting fish"}(ly||(ly={})),ly),hy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ly.FISHING,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return p(this,i),(e=t.call(this,r,Pv.FISHERS_HUT,n,um.SEA.FISHERS_HUT,a,!0,!0,u)).progress=o,e.status=s,e.status!==ly.FISHING&&e.status!==ly.WAITING_FOR_WAREHOUSE_SPACE&&e.status!==ly.TRANSPORTING_FISH&&(e.status=ly.FISHING),e}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(this.status);case Dm.SECOND:return Mm.progressValue(this.progress);case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(){if(this.working)if(this.status===ly.FISHING){if(this.progress<100&&(this.progress+=this.getPower(),this.progress>=100)){if(this.progress=0,this.servicesService.getRoyalService().catchGoldenFish())return;this.status=ly.TRANSPORTING_FISH}}else(this.status===ly.TRANSPORTING_FISH||this.status===ly.WAITING_FOR_WAREHOUSE_SPACE)&&(this.status=this.resourcesService.increaseResource(Mv.FISH,1,this.getName())?ly.FISHING:ly.WAITING_FOR_WAREHOUSE_SPACE)}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working}}}]),i}(xm),dy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:um.FORT.BARRACKS.SIZE,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return p(this,i),(e=t.call(this,r,Pv.BARRACKS,n,um.FORT.BARRACKS,!1,!0,!1,s)).barracksSize=o,e.servicesService&&(e.armyService=n.getArmyService(),e.modalService=n.getModalService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,barracksSize:this.barracksSize}}},{key:"build",value:function(){return this.servicesService.getGameService().isEnabled(wv.ARMY)||this.servicesService.getGameService().enable(wv.ARMY),this.armyService.increaseBarracks(this.barracksSize),this}},{key:"prepareDemolish",value:function(){return this.armyService.getFreeBarracks()>=this.barracksSize?(this.armyService.decreaseBarracks(this.barracksSize),!0):(this.modalService.info("Your troops would have nowhere to sleep!<br>You cannot demolish barracks right now!"),!1)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("capacity: "+this.barracksSize);case Dm.SECOND:case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"getHappinessEffect",value:function(){return 0}},{key:"getEffects",value:function(){return 0}},{key:"getPermanentEffects",value:function(){return 0}}]),i}(xm),gy=(function(e){e.TRAINING="training",e.NO_RECRUITS="no recruits"}(gy||(gy={})),gy),fy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gy.NO_RECRUITS,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return p(this,i),(e=t.call(this,r,Pv.TRAINING_SQUARE,n,um.FORT.TRAINING_SQUARE,s,!0,!0,u)).progress=o,e.status=a,e.workSettings=c,e.servicesService&&(e.armyService=n.getArmyService(),e.managementService=n.getManagementService(),e.calendarService=n.getCalendarService(),null===e.workSettings)&&(e.workSettings=new HE(!0,e.buildingType,[!0,!0,!0,!0],null,null,!0,!0,"work when there are troops to train")),e}return S(i,[{key:"customWorkRule",value:function(){return this.armyService.hasRecruits()}},{key:"getWorkSettings",value:function(){return this.workSettings}},{key:"setWorkSettings",value:function(e){this.workSettings=e}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,working:this.working,workSettings:this.workSettings}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return this.status===gy.TRAINING?Mm.progressValue(this.progress):Mm.emptyValue();case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.isWorking()||this.hireWorker():this.isWorking()&&(this.status!==gy.TRAINING||0===this.progress)&&this.fireWorker()),this.working&&(this.armyService.hasRecruits()?(this.status=gy.TRAINING,this.progress<100&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.armyService.progressRecruitment(1))):(this.status=gy.NO_RECRUITS,this.progress=0))}},{key:"isMet",value:function(){var e=!0;return this.workSettings.seasons[this.calendarService.getSeason()]||e&&(e=!1),this.workSettings.customRuleEnabled&&e&&(e=this.customWorkRule()),e}},{key:"isComplexManagement",value:function(){return!0}}]),i}(xm),vy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.TANNERY,um.FOREST.TANNERY,o,r,s,a,u,c,l)}return i}(BE),py=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:um.FORT.STOCKADE.DURABILITY,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:um.FORT.STOCKADE.DURABILITY,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.STOCKADE,n,um.FORT.STOCKADE,u,!0,!1,c)).health=o,e.durability=s,e.progress=a,e.servicesService&&(e.armyService=n.getArmyService(),e.modalService=n.getModalService(),e.worldService=n.getWorldService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,health:this.health,durability:this.durability,progress:this.progress,working:this.working}}},{key:"build",value:function(){return this.worldService.getRegion(0).defense+=um.FORT.STOCKADE.DEFENSE,this}},{key:"prepareDemolish",value:function(){return this.worldService.getRegion(0).defense-=um.FORT.STOCKADE.DEFENSE,!0}},{key:"callback",value:function(e){var t=this;if("repair"===e){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to repair "+this.getName()+" for 1 log for each durability point missing?");var i=this.modalService.registerForConfirmation().subscribe(function(e){e&&(t.startProduction()||t.modalService.info("No free worker to repair stockade!")),i.unsubscribe()})}else"stop"===e&&this.fireWorker()}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("durability: "+this.health+"/"+this.durability);case Dm.SECOND:return Mm.textValue("defense: "+um.FORT.STOCKADE.DEFENSE);case Dm.THIRD:return this.health<this.durability&&!this.working?Mm.buttonValue("repair","repair"):this.health<this.durability&&this.working?Mm.buttonValue("stop repair","stop"):Mm.emptyValue();case Dm.FOURTH:return this.working?Mm.progressValue(this.progress):Mm.emptyValue()}}},{key:"tick",value:function(e){!this.working||(this.progress<100&&(0===this.progress&&this.resourcesService.decreaseResource(Mv.LOG,1,this.getName())||this.progress>0)&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.health+=1),this.health===this.durability&&this.fireWorker())}},{key:"getHappinessEffect",value:function(){return 0}}]),i}(xm),my=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.COTTON_MILL,um.FIELD.COTTON_MILL,o,r,s,a,u,c,l)}return i}(BE),Sy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.TAILOR,um.VILLAGE.TAILOR,o,r,s,a,u,c,l)}return i}(BE),Ey=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.BREWERY,um.FIELD.BREWERY,o,r,s,a,u,c,l)}return i}(BE),yy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:um.FORT.WOODEN_TOWER.DURABILITY,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:um.FORT.WOODEN_TOWER.DURABILITY,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.WOODEN_TOWER,n,um.FORT.WOODEN_TOWER,u,!0,!1,c)).health=o,e.durability=s,e.progress=a,e.servicesService&&(e.armyService=n.getArmyService(),e.modalService=n.getModalService(),e.worldService=n.getWorldService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,health:this.health,durability:this.durability,progress:this.progress,working:this.working}}},{key:"build",value:function(){return this.worldService.getRegion(0).defense+=um.FORT.STOCKADE.DEFENSE,this}},{key:"prepareDemolish",value:function(){return this.worldService.getRegion(0).defense-=um.FORT.STOCKADE.DEFENSE,!0}},{key:"callback",value:function(e){var t=this;if("repair"===e){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to repair "+this.getName()+" for 1 log for each durability point missing?");var i=this.modalService.registerForConfirmation().subscribe(function(e){e&&(t.startProduction()||t.modalService.info("No free worker to repair wooden tower!")),i.unsubscribe()})}else"stop"===e&&this.fireWorker()}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("durability: "+this.health+"/"+this.durability);case Dm.SECOND:return Mm.textValue("defense: "+um.FORT.WOODEN_TOWER.DEFENSE);case Dm.THIRD:return this.health<this.durability&&!this.working?Mm.buttonValue("repair","repair"):this.health<this.durability&&this.working?Mm.buttonValue("stop repair","stop"):Mm.emptyValue();case Dm.FOURTH:return this.working?Mm.progressValue(this.progress):Mm.emptyValue()}}},{key:"tick",value:function(e){!this.working||(this.progress<100&&(0===this.progress&&this.resourcesService.decreaseResource(Mv.LOG,1,this.getName())||this.progress>0)&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.health+=1),this.health===this.durability&&this.fireWorker())}},{key:"getHappinessEffect",value:function(){return 0}}]),i}(xm),Ry=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:um.FORT.STONE_TOWER.DURABILITY,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:um.FORT.STONE_TOWER.DURABILITY,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.STONE_TOWER,n,um.FORT.STONE_TOWER,u,!0,!1,c)).health=o,e.durability=s,e.progress=a,e.servicesService&&(e.armyService=n.getArmyService(),e.modalService=n.getModalService(),e.worldService=n.getWorldService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,health:this.health,durability:this.durability,progress:this.progress,working:this.working}}},{key:"build",value:function(){return this.worldService.getRegion(0).defense+=um.FORT.STOCKADE.DEFENSE,this}},{key:"prepareDemolish",value:function(){return this.worldService.getRegion(0).defense-=um.FORT.STOCKADE.DEFENSE,!0}},{key:"callback",value:function(e){var t=this;if("repair"===e){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to repair "+this.getName()+" for 1 stone for each durability point missing?");var i=this.modalService.registerForConfirmation().subscribe(function(e){e&&(t.startProduction()||t.modalService.info("No free worker to repair stone tower!")),i.unsubscribe()})}else"stop"===e&&this.fireWorker()}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("durability: "+this.health+"/"+this.durability);case Dm.SECOND:return Mm.textValue("defense: "+um.FORT.STONE_TOWER.DEFENSE);case Dm.THIRD:return this.health<this.durability&&!this.working?Mm.buttonValue("repair","repair"):this.health<this.durability&&this.working?Mm.buttonValue("stop repair","stop"):Mm.emptyValue();case Dm.FOURTH:return this.working?Mm.progressValue(this.progress):Mm.emptyValue()}}},{key:"tick",value:function(e){!this.working||(this.progress<100&&(0===this.progress&&this.resourcesService.decreaseResource(Mv.STONE,1,this.getName())||this.progress>0)&&(this.progress+=this.getPower()),this.progress>=100&&(this.progress=0,this.health+=1),this.health===this.durability&&this.fireWorker())}},{key:"getHappinessEffect",value:function(){return 0}}]),i}(xm),Oy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),e=t.call(this,n,r,Pv.WINERY,um.FIELD.WINERY,s,o,a,u,c,l,h),n&&(e.managementService=n.getManagementService()),e}return S(i,[{key:"tick",value:function(){this.managementService.getComplexWorkers()&&this.workSettings&&this.workSettings.enabled&&(this.isMet()?this.isWorking()||this.hireWorker():this.isWorking()&&this.fireWorker()),this.working&&(this.outputStorage.length>0?this.collectOutputResources():this.inputStorage.length<this.settings.INPUT_RESOURCES.length&&0===this.outputStorage.length?this.collectInputResources()&&(this.status=GE.PREPARING):this.progress<100&&this.status===GE.PREPARING?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&this.status===GE.PREPARING?(this.progress=0,this.status=GE.PRODUCING_OUTPUT):this.progress<100&&this.status===GE.PRODUCING_OUTPUT?(this.progress+=100/300,this.progress>=100&&(this.progress=100)):100===this.progress&&this.status===GE.PRODUCING_OUTPUT&&(this.progress=0,this.inputStorage=[],this.outputStorage=Qv.copyResourceArray(this.settings.OUTPUT_RESOURCES),this.status=GE.TRANSPORTING_OUTPUT))}}]),i}(BE),Ty=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.TAVERN,n,um.VILLAGE.TAVERN,u,!0,!0,c)).progress=o,e.beer=s,e.wine=a,e.servicesService&&(e.resourcesService=n.getResourcesService(),e.happinessService=n.getHappinessService(),e.managementService=n.getManagementService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,beer:this.beer,wine:this.wine,working:this.working}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(this.beer<.001&&this.wine<.001?"waiting for alcohol":this.working?"open":"closed");case Dm.SECOND:return Mm.emptyValue();case Dm.THIRD:return Mm.textValue("beer: "+Qv.round(this.beer,2));case Dm.FOURTH:return Mm.textValue("wine: "+Qv.round(this.wine,2))}}},{key:"tick",value:function(e){var t=this.resourcesService.getTotalPeople(),i=this.managementService.getAlcoholRations();if(this.working&&this.happinessService.getHappiness()<=100&&t>1&&(this.beer>.002||this.wine>.002)){for(var n=t;n>0;n--){var r=sp.randomBetween(0,1);(0===r||this.wine<.002)&&this.beer>=.002*i?(this.beer-=.005*i,this.happinessService.updateHappiness(Kv.ALCOHOL,Number(i),-1)):(1===r||this.beer<.002)&&this.wine>=.002*i&&(this.wine-=.005*i,this.happinessService.updateHappiness(Kv.ALCOHOL,Number(i),-1))}this.beer<0&&(this.beer=0),this.wine<0&&(this.wine=0)}else this.happinessService.getHappiness()>75&&t>1&&this.happinessService.updateHappiness(Kv.ALCOHOL,0,-1);if(this.working){for(;this.beer<10*Math.ceil(t/100)&&this.resourcesService.decreaseResource(Mv.BEER,1,this.getName());)this.beer+=2.5;for(;this.wine<10*Math.ceil(t/100)&&this.resourcesService.decreaseResource(Mv.WINE,1,this.getName());)this.wine+=2.5}else this.happinessService.updateHappiness(Kv.ALCOHOL,0,-1)}}]),i}(xm),Iy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return p(this,i),(e=t.call(this,r,Pv.GEOLOGIST,n,um.MOUNTAINS.GEOLOGIST,s,!0,!0,a)).progress=o,e.servicesService&&(e.gameService=n.getGameService(),e.resourcesService=n.getResourcesService(),e.landService=n.getLandService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,working:this.working}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("looking for ores");case Dm.SECOND:return Mm.progressValue(this.progress);case Dm.THIRD:return Mm.textValue(this.lastFind?"last find: "+Qv.prepareResourceName(this.lastFind)+" deposit":"last find: nothing");case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){if(this.working)if(this.progress<100)this.progress+=this.getPower(),this.progress>100&&(this.progress=100);else{var t=[];if(this.landService.getOre(Mv.COAL)<50&&t.push({item:Mv.COAL,chance:this.settings.COAL_CHANCE}),this.landService.getOre(Mv.COPPER_ORE)<50&&t.push({item:Mv.COPPER_ORE,chance:this.settings.COPPER_CHANCE}),this.landService.getOre(Mv.TIN_ORE)<50&&t.push({item:Mv.TIN_ORE,chance:this.settings.TIN_CHANCE}),this.gameService.isEnabled(wv.GOLD)&&this.landService.getOre(Mv.GOLD_ORE)<50&&t.push({item:Mv.GOLD_ORE,chance:this.settings.GOLD_CHANCE}),this.gameService.isEnabled(wv.SILVER)&&this.landService.getOre(Mv.SILVER_ORE)<50&&t.push({item:Mv.SILVER_ORE,chance:this.settings.SILVER_CHANCE}),this.gameService.isEnabled(wv.IRON)&&this.landService.getOre(Mv.IRON_ORE)<50&&t.push({item:Mv.IRON_ORE,chance:this.settings.IRON_CHANCE}),t.length>0){this.progress=0;var i=sp.randomElement(t);i?(this.landService.increaseOre(i,1),this.lastFind=i):this.lastFind=null}}}}]),i}(xm),by=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.STONEMASON,um.MOUNTAINS.STONEMASON,o,r,s,a,u,c,l)}return i}(BE),Cy=(function(e){e.MINING="mining {res}",e.WAITING_FOR_SELECTION="waiting for ore selection",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more {res}",e.TRANSPORTING="transporting {res}"}(Cy||(Cy={})),Cy),Ay=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cy.WAITING_FOR_SELECTION,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:200,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Mv.NOTHING,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),(e=t.call(this,r,Pv.PIT_MINE,n,um.MOUNTAINS.PIT_MINE,a,!0,!0,h)).progress=o,e.status=s,e.storage=u,e.resources=c,e.ore=l,e.servicesService&&(e.modalService=n.getModalService(),e.landService=n.getLandService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,resources:this.resources,ore:this.ore}}},{key:"callback",value:function(e){var t=this;if(this.ore===Mv.NOTHING)if(this.landService.hasOre(Mv[String(e.target.value).replace(" ","_")],20)){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to mine "+Qv.prepareResourceName(Mv[String(e.target.value).replace(" ","_")])+" in this mine?");var i=this.modalService.registerForConfirmation().subscribe(function(n){n?(t.landService.decreaseOre(Mv[String(e.target.value).replace(" ","_")],20),t.ore=Mv[String(e.target.value).replace(" ","_")],t.status=Cy.MINING,t.progress=0):e.target.selectedIndex=t.ore,i.unsubscribe()})}else this.modalService.info("Not enough "+Qv.prepareResourceName(Mv[String(e.target.value).replace(" ","_")])+" deposits available<br>20 "+Qv.prepareResourceName(Mv[String(e.target.value).replace(" ","_")])+" deposits required to start mining."),e.target.selectedIndex=this.ore}},{key:"buildOnMountain",value:function(){return!0}},{key:"isUsedUp",value:function(){return this.status===Cy.NO_MORE_RESOURCES}},{key:"hasBuff",value:function(){return!this.isUsedUp()&&u(v(i.prototype),"hasBuff",this).call(this)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.ore!==Mv.NOTHING?Mm.textValue(Qv.prepareResourceName(this.ore).toLowerCase()+": "+this.resources):Mm.emptyValue();case Dm.SECOND:return Mm.textValue(this.status.replace("{res}",Qv.prepareResourceName(this.ore).toLowerCase()));case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:if(this.ore===Mv.NOTHING){var t=[];return t.push(Mv[Mv.NOTHING].replace("_"," ")),t.push(Mv[Mv.COAL].replace("_"," ")),t.push(Mv[Mv.GOLD_ORE].replace("_"," ")),t.push(Mv[Mv.SILVER_ORE].replace("_"," ")),t.push(Mv[Mv.COPPER_ORE].replace("_"," ")),t.push(Mv[Mv.TIN_ORE].replace("_"," ")),t.push(Mv[Mv.IRON_ORE].replace("_"," ")),Mm.dropdownValue(t,Mv[this.ore])}return Mm.emptyValue()}}},{key:"isStoppable",value:function(){return this.resources>0}},{key:"tick",value:function(e){if(this.ore!==Mv.NOTHING){if(this.resources<=0&&0===this.storage&&(this.status!==Cy.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Pit mine mined all "+Qv.prepareResourceName(this.ore)),this.status=Cy.NO_MORE_RESOURCES,this.stopProduction()),!this.working)return;this.storage>0?this.resourcesService.increaseResource(this.ore,this.storage,this.getName())?(this.storage=0,sp.chance(this.settings.GEM_CHANCE)&&this.resourcesService.increaseResource(Mv.GEMS,1,this.getName()),this.status=Cy.MINING):this.status=Cy.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=Cy.MINING,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=Cy.TRANSPORTING)}}}]),i}(xm),ky=(function(e){e[e.NONE=0]="NONE",e[e.COW=1]="COW",e[e.CHICKEN=2]="CHICKEN",e[e.PIG=3]="PIG",e[e.HORSE=4]="HORSE",e[e.SHEEP=5]="SHEEP"}(ky||(ky={})),ky),Ny=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:um.FIELD.PASTURE.SIZE,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ky.NONE,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,g=arguments.length>10&&void 0!==arguments[10]&&arguments[10],f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1;return p(this,i),(e=t.call(this,r,Pv.PASTURE,n,um.FIELD.PASTURE,c,!0,!0,f)).currentSize=o,e.animal=s,e.progress=a,e.produceProgress=u,e.animals=l,e.food=h,e.chores=d,e.autoButcher=g,e.servicesService&&(e.modalService=n.getModalService(),e.weatherService=n.getWeatherService(),e.calendarService=n.getCalendarService(),e.fieldService=n.getService(Zv.FIELD)),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,size:this.currentSize,animal:this.animal,progress:this.progress,produceProgress:this.produceProgress,working:this.working,animals:this.animals,food:this.food,chores:this.chores,autoButcher:this.autoButcher}}},{key:"build",value:function(){return this.resourcesService.getResource(Mv.CHICKEN).isVisible()||(this.resourcesService.makeVisible(Mv.CHICKEN),this.logService.log("New resource discovered: "+Qv.prepareResourceName(Mv.CHICKEN)),this.resourcesService.makeVisible(Mv.SHEEP),this.logService.log("New resource discovered: "+Qv.prepareResourceName(Mv.SHEEP)),this.resourcesService.makeVisible(Mv.COW),this.logService.log("New resource discovered: "+Qv.prepareResourceName(Mv.COW)),this.resourcesService.makeVisible(Mv.PIG),this.logService.log("New resource discovered: "+Qv.prepareResourceName(Mv.PIG)),this.resourcesService.makeVisible(Mv.HORSE),this.logService.log("New resource discovered: "+Qv.prepareResourceName(Mv.HORSE))),this.resourcesService.updateAnimals(),u(v(i.prototype),"build",this).call(this)}},{key:"getSize",value:function(){return this.currentSize}},{key:"getComplexity",value:function(){return u(v(i.prototype),"getComplexity",this).call(this)*(this.getSize()/this.settings.SIZE)}},{key:"findButcher",value:function(){return this.fieldService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.BUTCHER}).map(function(e){return e}).sort(function(e,t){return e.getAnimalsNumber()-t.getAnimalsNumber()})[0]}},{key:"butcher",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.findButcher();t?t.addAnimalToButcher(this.getResourceType())&&(this.resourcesService.addAnimalUsedData(this.getResourceType(),"Butcher",1),this.decreaseAnimal(1)):e||this.modalService.info("No butcher available or their work queue is full")}},{key:"callback",value:function(e){var t=this;if("butcher"===e&&this.animals>0)this.butcher(!1);else if("x"===e)this.autoButcher=!this.autoButcher;else if(this.animal===ky.NONE||0===this.animals)this.animal!==ky.NONE&&this.resourcesService.decreaseResourceLimit(this.getResourceType(),this.getMaxAnimals()),this.animal=ky[String(e.target.value)],this.progress=0,this.animal!==ky.NONE&&this.resourcesService.increaseResourceLimit(this.getResourceType(),this.getMaxAnimals()),this.resourcesService.updateAnimals();else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to change animals?<br>All current animals will be moved to other pastures and if there is no enough space they will be lost");var i=this.modalService.registerForConfirmation().subscribe(function(n){n?(t.resourcesService.decreaseResourceLimit(t.getResourceType(),t.getMaxAnimals()),t.moveAnimals(t.animals),t.animal=ky[String(e.target.value)],t.progress=0,t.animals=0,t.animal!==ky.NONE&&t.resourcesService.increaseResourceLimit(t.getResourceType(),t.getMaxAnimals()),t.resourcesService.updateAnimals()):e.target.selectedIndex=t.animal-1,i.unsubscribe()})}}},{key:"finishDemolish",value:function(){}},{key:"prepareDemolish",value:function(){return this.stopProduction(),this.animal!==ky.NONE&&(this.moveAnimals(this.animals),this.resourcesService.decreaseResourceLimit(this.getResourceType(),this.getMaxAnimals())),!0}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.animal!==ky.NONE?Mm.textValue(ky[this.animal].toLowerCase()+": "+this.animals+"/"+this.getMaxAnimals()):Mm.emptyValue();case Dm.SECOND:if(this.animals>0&&this.food<0)return Mm.progressValue(Math.abs(this.food),"famine");var t=[];return t.push(ky[ky.NONE]),t.push(ky[ky.CHICKEN]),t.push(ky[ky.SHEEP]),t.push(ky[ky.COW]),t.push(ky[ky.PIG]),t.push(ky[ky.HORSE]),Mm.dropdownValue(t,ky[this.animal]);case Dm.THIRD:return this.animals>0&&this.findButcher()?Mm.buttonCheckboxValue("butcher","butcher","auto butcher",this.autoButcher,"x"):Mm.emptyValue();case Dm.FOURTH:return Mm.emptyValue()}}},{key:"getName",value:function(){return this.animal===ky.NONE?"Pasture":ky[this.animal].charAt(0).toUpperCase()+ky[this.animal].slice(1).toLowerCase()+" pasture"}},{key:"startProduction",value:function(){return this.working=!0,!0}},{key:"stopProduction",value:function(){this.working=!1}},{key:"tick",value:function(e){if(this.food<0&&this.calendarService.getSeason()!==ym.WINTER&&(this.food=0),this.autoButcher&&this.animals>0&&this.animals===this.getMaxAnimals()&&this.butcher(),this.animals>0?this.calendarService.getSeason()===ym.WINTER?(this.food-=.0015*this.getAnimalSettings().SIZE*this.animals,this.food<=-100&&(this.food=0,this.decreaseAnimal(1))):(this.food-=2e-4*this.getAnimalSettings().SIZE*this.animals,this.food<=-100&&(this.food=0,this.decreaseAnimal(1))):this.food<0&&(this.food=0),this.food>=0&&this.animals>1&&this.chores<this.getSize()&&(this.animals<this.getMaxAnimals()||this.resourcesService.hasLimit(this.getResourceType()))&&this.progress<100&&(this.progress+=.05/(10/this.getAnimalSettings().REPRODUCTION_SPEED)*this.animals*(1+this.effectsService.getNatureEffectsValue()/100),this.progress>=100&&(this.animals<this.getMaxAnimals()||this.resourcesService.hasLimit(this.getResourceType()))&&(this.progress=0,this.animals<this.getMaxAnimals()?(this.resourcesService.addAnimalProducedData(this.getResourceType(),"Pasture",1),this.increaseAnimal(1)):this.resourcesService.hasLimit(this.getResourceType())&&this.resourcesService.increaseResource(this.getResourceType(),1,"Pasture",!0))),(this.animal===ky.CHICKEN||this.animal===ky.COW||this.animal===ky.SHEEP)&&(0===this.animals&&(this.produceProgress=0),this.produceProgress<100&&this.chores<this.getSize()&&(this.produceProgress+=.2*this.animals*(1+this.effectsService.getNatureEffectsValue()/100),this.produceProgress>=100)))if(this.produceProgress=0,this.animal===ky.CHICKEN){if(this.servicesService.getRoyalService().layGoldenEgg())return;this.resourcesService.increaseResource(Mv.EGG,1,this.getName())}else if(this.animal===ky.COW)this.resourcesService.increaseResource(Mv.MILK,1,this.getName());else if(this.animal===ky.SHEEP){if(this.servicesService.getRoyalService().getGoldenFleece())return;this.resourcesService.increaseResource(Mv.WOOL,1,this.getName())}this.chores+=.05*this.animals,this.chores>2*this.getSize()&&(this.chores=2*this.getSize())}},{key:"work",value:function(e){return this.food<100&&0===this.resourcesService.hasResource(Mv.HAY,1,this.getName())?(this.resourcesService.decreaseResource(Mv.HAY,1,this.getName())&&(this.food+=10),!0):this.chores>=1&&(this.chores-=e/um.FIELD.FARM.BASE_POWER,this.chores<0&&(this.chores=0),!0)}},{key:"fireWorker",value:function(){return!1}},{key:"hireWorker",value:function(){return!1}},{key:"getWorkers",value:function(){return 0}},{key:"hasWork",value:function(){return!!this.isWorking()&&(this.food<50&&0===this.resourcesService.hasResource(Mv.HAY,1,this.getName())||this.chores>=1)}},{key:"getDetails",value:function(){return this.animal!==ky.NONE?"pasture size: "+Qv.round(this.getSize(),0)+"<br>progress: "+Qv.round(this.progress,2)+"%<br>produce progress: "+Qv.round(this.produceProgress,2)+"%<br>food: "+Qv.round(this.food,2)+"<br>chores: "+Qv.round(this.chores,2)+"<br>"+Qv.prepareResourceName(this.getResourceType())+" meat: "+this.getAnimalSettings().MEAT+"<br>"+Qv.prepareResourceName(this.getResourceType())+" fur: "+this.getAnimalSettings().FUR+"<br>"+Qv.prepareResourceName(this.getResourceType()).toLowerCase()+" size: "+this.getAnimalSettings().SIZE+"<br>"+u(v(i.prototype),"getDetails",this).call(this):u(v(i.prototype),"getDetails",this).call(this)}},{key:"getHappinessEffect",value:function(){return 0}},{key:"isCombinable",value:function(){return!0}},{key:"isSplittable",value:function(){return!0}},{key:"moveAnimals",value:function(e){var t,i=this,r=n(this.fieldService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.PASTURE&&e!==i&&e.getAnimals()<e.getMaxAnimals()}).map(function(e){return e}).filter(function(e){return e.getResourceType()===i.getResourceType()}));try{for(r.s();!(t=r.n()).done;){for(var o=t.value;e>0&&o.getAnimals()<o.getMaxAnimals();)o.increaseAnimal(1),e-=1,this.decreaseAnimal(1);if(0===e)return}}catch(s){r.e(s)}finally{r.f()}}},{key:"getResourceType",value:function(){return this.animal!==ky.NONE?Mv[ky[this.animal]]:Mv.NOTHING}},{key:"getAnimals",value:function(){return this.animals}},{key:"getAnimalSettings",value:function(){return cm.getResource(this.getResourceType())}},{key:"getMaxAnimals",value:function(){return this.getResourceType()!==Mv.NOTHING?Math.floor(this.currentSize/this.getAnimalSettings().SIZE):0}},{key:"increaseAnimal",value:function(e){this.animals+=e,this.resourcesService.updateAnimals()}},{key:"decreaseAnimal",value:function(e){this.animals-=e,this.resourcesService.updateAnimals()}},{key:"combine",value:function(e,t){var i=this;if(this.getBuildingType()===e.getBuildingType())if(this.isCompatible(e))this.doCombine(e,t);else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will keep animals");var n=this.modalService.registerForConfirmation().subscribe(function(r){n.unsubscribe(),r?i.doCombine(e,t):t.finaliseCombine(!1),i.resourcesService.updateAnimals()})}}},{key:"doCombine",value:function(e,t){this.currentSize+=e.getSize(),e.animal===this.animal?this.increaseAnimal(e.getAnimals()):this.animal===ky.NONE&&e.animal!==ky.NONE?(this.animal=e.animal,this.increaseAnimal(e.getAnimals())):e.moveAnimals(e.getAnimals()),e.animals=0,t.finaliseCombine(!0)}},{key:"split",value:function(e){var t=this;this.modalService.open(_v.INPUT),this.modalService.setModalText("Set new pasture size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");var n=this.modalService.registerForValueResponse().subscribe(function(r){if(n.unsubscribe(),null!==r){if(!isNaN(r)&&0!==r)if(r>=1&&r<t.getSize()){t.currentSize-=Number(r);var o=new i(t.servicesService,t.servicesService.getIdService().getNextId(),Number(r)).build();e.finaliseSplit(o),o.animal=t.animal,t.animals>t.getMaxAnimals()&&(t.moveAnimals(t.animals-t.getMaxAnimals()),t.animals>t.getMaxAnimals()&&t.decreaseAnimal(t.animals-t.getMaxAnimals()))}else t.modalService.info("Invalid size value!");t.resourcesService.updateAnimals()}})}},{key:"isCompatible",value:function(e){return this.animal===e.animal}}]),i}(xm),_y=(function(e){e.BUTCHERING="butchering {animal}",e.WAITING_FOR_ANIMALS="waiting for animals",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting goods"}(_y||(_y={})),_y),wy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_y.WAITING_FOR_ANIMALS,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],h=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;return p(this,i),(e=t.call(this,r,Pv.BUTCHER,n,um.FIELD.BUTCHER,a,!0,!0,d)).status=o,e.progress=s,e.outputStorage=u,e.outputFurStorage=c,e.animals=l,e.discardExcessFur=h,e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,status:this.status,progress:this.progress,working:this.working,outputStorage:this.outputStorage,animals:this.animals,discardExcessFur:this.discardExcessFur,outputFurStorage:this.outputFurStorage}}},{key:"callback",value:function(e){"toggleDiscard"===e&&(this.discardExcessFur=!this.discardExcessFur)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(this.animals.length>0?this.status.replace("{animal}",Qv.prepareResourceName(this.animals[0])):this.status);case Dm.SECOND:return Mm.progressValue(this.progress);case Dm.THIRD:return Mm.textValue("queue: "+this.animals.length+"/10");case Dm.FOURTH:return Mm.checkboxValue("discard excess fur",this.discardExcessFur,"toggleDiscard")}}},{key:"getAnimalsNumber",value:function(){return this.animals.length}},{key:"getFreeSpace",value:function(){return 10-this.getAnimalsNumber()}},{key:"addAnimalToButcher",value:function(e){return this.animals.length<10&&(this.animals.push(e),!0)}},{key:"tick",value:function(e){if(this.working)if(this.animals.length>0&&0===this.outputStorage&&0===this.outputFurStorage)if(this.status=_y.BUTCHERING,this.progress<100)this.progress+=this.getPower()/cm.getResource(this.animals[0]).BUTCHERING_DIFFICULTY,this.progress>100&&(this.progress=100);else{this.status=_y.TRANSPORTING,this.progress=0;var t=this.animals.shift();this.outputStorage=cm.getResource(t).MEAT,this.resourcesService.increaseResource(Mv.MEAT,this.outputStorage,this.getName())?this.outputStorage=0:this.status=_y.WAITING_FOR_WAREHOUSE_SPACE,this.outputFurStorage=cm.getResource(t).FUR,this.resourcesService.increaseResource(Mv.FUR,this.outputFurStorage,this.getName())||this.discardExcessFur?this.outputFurStorage=0:this.status=_y.WAITING_FOR_WAREHOUSE_SPACE}else{if(0!==this.outputStorage){var i=this.resourcesService.getResource(Mv.MEAT).getFreeSpace(),n=Math.max(Math.min(i,this.outputStorage),0);this.resourcesService.increaseResource(Mv.MEAT,n,this.getName())&&(this.outputStorage-=n,0===this.outputFurStorage&&0===this.outputStorage&&(this.status=_y.WAITING_FOR_ANIMALS))}if(0!==this.outputFurStorage){var r=this.resourcesService.getResource(Mv.FUR).getFreeSpace(),o=Math.max(Math.min(r,this.outputFurStorage),0);this.resourcesService.increaseResource(Mv.FUR,o,this.getName())&&(this.outputFurStorage-=o,0===this.outputFurStorage&&0===this.outputStorage&&(this.status=_y.WAITING_FOR_ANIMALS)),this.discardExcessFur&&(this.outputFurStorage=0,this.status=_y.WAITING_FOR_ANIMALS)}0===this.outputStorage&&0===this.outputFurStorage&&(this.status=_y.WAITING_FOR_ANIMALS)}}},{key:"getDetails",value:function(){return u(v(i.prototype),"getDetails",this).call(this)+"local storage:<br>&nbsp;&nbsp;meat: "+this.outputStorage+"<br>&nbsp;&nbsp;fur: "+this.outputFurStorage}}]),i}(xm),Py=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.MINT,um.MOUNTAINS.MINT,o,r,s,a,u,c,l)}return i}(BE),My=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u,c,l){var h;return p(this,i),(h=t.call(this,e,n,r,o,s>0,u,c,l)).servicesService=r,h.workers=s,h.maxWorkers=a,h}return S(i,[{key:"fireWorker",value:function(){return this.workers>0&&(this.resourcesService.fireWorker(1),this.workers-=1,!0)}},{key:"hireWorker",value:function(){return!!(this.workers<this.maxWorkers&&this.resourcesService.hireWorker())&&(this.workers+=1,!0)}},{key:"getWorkers",value:function(){return this.workers}},{key:"isWorking",value:function(){return this.workers>0}},{key:"startProduction",value:function(){if(0===this.workers){for(;this.workers<this.maxWorkers&&this.resourcesService.hireWorker();)this.workers+=1;if(this.workers>0)return!0}return!1}},{key:"stopProduction",value:function(){this.workers>0&&(this.resourcesService.fireWorker(this.workers),this.workers=0)}}]),i}(xm),Dy=(function(e){e[e.CONSTRUCTION=0]="CONSTRUCTION",e[e.BUILT=1]="BUILT",e[e.ABDICATED=2]="ABDICATED",e[e.USED=3]="USED"}(Dy||(Dy={})),Dy),Ly=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u,c,l,h){var d;return p(this,i),(d=t.call(this,e,n,r,o,h,i.maxWorkers,!1,!0,1)).progress=s,d.maxProgress=a,d.stage=u,d.state=c,d.year=l,d.prepareIcons(),d}return S(i,[{key:"toJSON",value:function(){return{id:this.id,buildingType:this.buildingType,progress:this.progress,maxProgress:this.maxProgress,stage:this.stage,state:this.state,year:this.year,workers:this.workers}}},{key:"prepareIcons",value:function(){var e=this;this.iconsValue=[],this.settings.STAGES[this.stage]&&this.settings.STAGES[this.stage].cost.forEach(function(t){return e.iconsValue.push({name:Mv[t.resource],path:"resources",prefix:t.amount,suffix:""})})}},{key:"callback",value:function(e){var t=this;if("add"===e){var i=this.settings.STAGES[this.stage];if(void 0===this.settings.STAGES[this.stage]&&this.maxProgress<100)return void(this.maxProgress=100);var n=new Map;i.cost.forEach(function(e){return n.set(e.resource,e.amount)}),this.resourcesService.decreaseResources(n,this.getName(),!0)&&(this.stage+=1,this.maxProgress+=i.progress,this.maxProgress>100&&(this.maxProgress=100),this.prepareIcons())}else if("abdicate"===e){this.modalService.open(_v.ABDICATION);var r=this.modalService.registerForAbdication().subscribe(function(e){r.unsubscribe(),e&&(t.state=Dy.ABDICATED,t.servicesService.getGameService().incrementAbdicationLevel())})}else"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}},{key:"forceAbdicate",value:function(){this.state===Dy.BUILT&&(this.state=Dy.ABDICATED,this.servicesService.getGameService().incrementAbdicationLevel())}},{key:"getName",value:function(){return this.progress>=100?u(v(i.prototype),"getName",this).call(this):u(v(i.prototype),"getName",this).call(this)+" construction"}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.state===Dy.CONSTRUCTION?Mm.progressValue(this.progress,Qv.round(this.progress,2)+"% / "+this.maxProgress+"%"):Mm.textValue("built in year "+this.year);case Dm.SECOND:return this.state===Dy.CONSTRUCTION?Mm.iconValue(this.iconsValue):this.state===Dy.BUILT?Mm.buttonValue(this.getAbdicationText(),"abdicate"):Mm.emptyValue();case Dm.THIRD:return this.maxProgress<100?Mm.buttonValue("add materials","add"):Mm.emptyValue();case Dm.FOURTH:return this.state===Dy.CONSTRUCTION?Mm.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire"):Mm.emptyValue()}}},{key:"getAbdicationText",value:function(){return"abdicate"}},{key:"tick",value:function(e){!this.isWorking()||(this.progress>=100&&(this.stopProduction(),this.addPermanentEffect(),this.progress=100,this.state=Dy.BUILT,this.year=this.servicesService.getCalendarService().getYear(),this.getBuildingType()===Pv.ASCENSION_TEMPLE&&this.servicesService.getLogService().mystical("As you enter the temple you have strange feeling of many eyes watching you, <br>however there is nobody there. At the end of a big hall you find a golden altar.<br>This is it, your whole life lead you here. You feel safe.")),this.progress<this.maxProgress&&(this.progress+=.001*this.getPower()*this.workers))}},{key:"getEffects",value:function(){return this.state===Dy.CONSTRUCTION?this.effectsService.getBuildingEffectsValue(Pv.CONSTRUCTION,!1):u(v(i.prototype),"getEffects",this).call(this)}},{key:"getPermanentEffects",value:function(){return this.state===Dy.CONSTRUCTION?this.effectsService.getBuildingEffectsValue(Pv.CONSTRUCTION,!0):u(v(i.prototype),"getPermanentEffects",this).call(this)}},{key:"getHappinessEffect",value:function(){return this.state===Dy.CONSTRUCTION?u(v(i.prototype),"getHappinessEffect",this).call(this):0}},{key:"isStoppable",value:function(){return this.state===Dy.CONSTRUCTION}},{key:"isFinished",value:function(){return this.state!==Dy.CONSTRUCTION}},{key:"addPermanentEffect",value:function(){this.addBuildingEffects(),this.addArmyEffects()}},{key:"addBuildingEffects",value:function(){var e=this;if(this.settings.BUILDING_EFFECTS&&this.settings.BUILDING_EFFECTS.length>0){var t=this.servicesService.getEffectsService();this.settings.BUILDING_EFFECTS.forEach(function(i){t.addBuildingEffect(new rp(e.getName(),i.building,Number(i.value),op.WONDER))})}}},{key:"addArmyEffects",value:function(){var e=this;if(this.settings.ARMY_EFFECTS&&this.settings.ARMY_EFFECTS.length>0){var t=this.servicesService.getEffectsService();this.settings.ARMY_EFFECTS.forEach(function(i){t.addArmyEffect(new ap(e.getName(),i.troop,Number(i.value),op.WONDER))})}}},{key:"verifyWonderEffects",value:function(){var e=this;if(this.isFinished()){if(this.settings.BUILDING_EFFECTS){var t=this.servicesService.getEffectsService();this.settings.BUILDING_EFFECTS.forEach(function(i){e.effectsService.hasBuildingEffect(e.getName(),i.building)||t.addBuildingEffect(new rp(e.getName(),i.building,Number(i.value),op.WONDER))})}if(this.settings.ARMY_EFFECTS){var i=this.servicesService.getEffectsService();this.settings.ARMY_EFFECTS.forEach(function(t){e.effectsService.hasArmyEffect(e.getName(),t.troop)||i.addArmyEffect(new ap(e.getName(),t.troop,Number(t.value),op.WONDER))})}}}}]),i}(My);return e.maxWorkers=5,e}(),xy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.STONEHENGE,e,um.PLATEAU.STONEHENGE,r,o,s,a,u,c)}return S(i,[{key:"tick",value:function(e){if(u(v(i.prototype),"tick",this).call(this,e),this.state===Dy.ABDICATED){this.state=Dy.USED,this.servicesService.getGameService().enable(wv.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");var t=this.servicesService.getKongregateService();t.isAvailable()&&t.submitStat("Stonehenge",!0)}}}]),i}(Ly),Fy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return p(this,i),(e=t.call(this,r,Pv.MARKETPLACE,n,um.VILLAGE.MARKETPLACE,!0,!0,!1,s)).progress=o,e.callMerchantPrice=[{name:"coins",path:"resources",prefix:"",suffix:"25"}],e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress}}},{key:"build",value:function(){return this.servicesService.getGameService().enable(wv.MARKET),u(v(i.prototype),"build",this).call(this)}},{key:"callback",value:function(e){"bribe"===e&&(this.resourcesService.decreaseResource(Mv.COINS,25,this.getName(),!0)?1===sp.randomBetween(1,2)&&(this.progress+=50,this.progress>=100&&(this.progress=0,this.servicesService.getService(Zv.MARKET).callMerchant())):this.modalService.info("Not enough coins for a bribe"))}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.progressValue(this.progress,"merchant arrival");case Dm.SECOND:return Mm.emptyValue();case Dm.THIRD:return Mm.iconValue(this.callMerchantPrice);case Dm.FOURTH:return Mm.buttonValue("bribe merchant (50% chance)","bribe")}}},{key:"tick",value:function(e){1===sp.randomBetween(1,10)&&(this.progress+=this.getPower()),this.progress>=100&&(this.servicesService.getService(Zv.MARKET).callMerchant(),this.progress=0)}},{key:"getWorkers",value:function(){return 0}}]),i}(xm),Uy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return p(this,i),e=t.call(this,r,Pv.SMITHY,n,um.MOUNTAINS.SMITHY,!1,!0,!1,o),n&&(e.gameService=n.getGameService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType}}},{key:"build",value:function(){var e=this;return this.settings.RECIPES.forEach(function(t){e.gameService.isEnabled(t.prerequisite)&&e.servicesService.getRecipeService().enable(t.recipe)}),this.gameService.enable(wv.BUILT_SMITHY),this}},{key:"prepareDemolish",value:function(){var e=this;return this.settings.RECIPES.forEach(function(t){return e.servicesService.getRecipeService().disable(t.recipe)}),this.gameService.disable(wv.BUILT_SMITHY),this.servicesService.getService(Zv.CRAFTING).filterCraftingQueue(this.settings.RECIPES),this.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).map(function(e){return e}).forEach(function(t){t.getRecipe()&&e.settings.RECIPES.includes(t.getRecipe().id)&&t.cancelCrafting()}),this.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.MANUFACTURE}).map(function(e){return e}).forEach(function(t){t.getRecipe()&&e.settings.RECIPES.includes(t.getRecipe().id)&&t.cancelCrafting()}),!0}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("Allows workshops");case Dm.SECOND:return Mm.textValue("to smelt ore");case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"getEffects",value:function(){return 0}},{key:"getHappinessEffect",value:function(){return 0}},{key:"getPermanentEffects",value:function(){return 0}}]),i}(xm),Hy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return p(this,i),(e=t.call(this,r,Pv.CHURCH,n,um.VILLAGE.CHURCH,o,!0,!0,a)).progress=s,e.servicesService&&(e.religionService=n.getService(Zv.RELIGION)),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,working:this.working,progress:this.progress}}},{key:"build",value:function(){return this.religionService.increaseFaithCap(50),this.servicesService.getGameService().enable(wv.RELIGION),this.startProduction(),this}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:case Dm.SECOND:return Mm.emptyValue();case Dm.THIRD:return Mm.progressValue(this.progress,"prayers");case Dm.FOURTH:return Mm.emptyValue()}}},{key:"prepareDemolish",value:function(){return this.religionService.decreaseFaithCap(50),!0}},{key:"tick",value:function(e){if(this.working){var t=this.servicesService.getVillageService().getPopulation();this.progress+=.1*(Math.pow(Math.log(t),2)+1)*this.getPower(),this.progress>100&&(this.progress=0,this.religionService.increaseFaith(1))}}}]),i}(xm),Gy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.PYRAMID,e,um.PLATEAU.PYRAMID,r,o,s,a,u,c)}return S(i,[{key:"tick",value:function(e){if(u(v(i.prototype),"tick",this).call(this,e),this.state===Dy.ABDICATED){this.state=Dy.USED,this.servicesService.getGameService().enable(wv.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");var t=this.servicesService.getKongregateService();t.isAvailable()&&t.submitStat("Pyramid",!0)}}}]),i}(Ly),By=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.HANGING_GARDEN,e,um.PLATEAU.HANGING_GARDEN,r,o,s,a,u,c)}return S(i,[{key:"tick",value:function(e){if(u(v(i.prototype),"tick",this).call(this,e),this.state===Dy.ABDICATED){this.state=Dy.USED,this.servicesService.getGameService().enable(wv.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");var t=this.servicesService.getKongregateService();t.isAvailable()&&t.submitStat("Hanging Garden",!0)}}}]),i}(Ly),Wy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.COLOSSUS,e,um.PLATEAU.COLOSSUS,r,o,s,a,u,c)}return S(i,[{key:"tick",value:function(e){if(u(v(i.prototype),"tick",this).call(this,e),this.state===Dy.ABDICATED){this.state=Dy.USED,this.servicesService.getGameService().enable(wv.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");var t=this.servicesService.getKongregateService();t.isAvailable()&&t.submitStat("Colossus",!0)}}}]),i}(Ly),Vy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.ASCENSION_TEMPLE,e,um.PLATEAU.ASCENSION_TEMPLE,r,o,s,a,u,c)}return S(i,[{key:"callback",value:function(e){var t=this;if("abdicate"===e){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to ascend?<br><br>You will start from the beginning and all progress except for</br>royal points, heritage points and permanent royal upgrades will be deleted.");var n=this.modalService.registerForConfirmation().subscribe(function(e){if(n.unsubscribe(),e){t.state=Dy.ABDICATED,t.servicesService.getRoyalService().increaseRoyalPoints(t.settings.RP),t.logService.mystical("Your ascension granted you "+t.settings.RP+" royal points");var i=t.servicesService.getKongregateService();i.isAvailable()&&i.submitStat("Ascension Temple",!0),t.servicesService.getService(Zv.SERIALIZER).ascensionReset()}})}else u(v(i.prototype),"callback",this).call(this,e)}},{key:"getAbdicationText",value:function(){return"ascend"}},{key:"forceAbdicate",value:function(){}}]),i}(Ly),zy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.UNDERGROUND_CITY,e,um.PLATEAU.UNDERGROUND_CITY,r,o,s,a,u,c)}return S(i,[{key:"tick",value:function(e){if(u(v(i.prototype),"tick",this).call(this,e),this.state===Dy.ABDICATED){this.state=Dy.USED,this.servicesService.getGameService().enable(wv.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");var t=this.servicesService.getKongregateService();t.isAvailable()&&t.submitStat("Underground City",!0)}}}]),i}(Ly),Yy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.GREAT_LIGHTHOUSE,e,um.PLATEAU.GREAT_LIGHTHOUSE,r,o,s,a,u,c)}return S(i,[{key:"tick",value:function(e){if(u(v(i.prototype),"tick",this).call(this,e),this.state===Dy.ABDICATED){this.state=Dy.USED,this.servicesService.getGameService().enable(wv.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");var t=this.servicesService.getKongregateService();t.isAvailable()&&t.submitStat("Great Lighthouse",!0)}}}]),i}(Ly),jy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dy.CONSTRUCTION,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),t.call(this,n,Pv.SACRED_GROVE,e,um.PLATEAU.SACRED_GROVE,r,o,s,a,u,c)}return S(i,[{key:"tick",value:function(e){if(u(v(i.prototype),"tick",this).call(this,e),this.state===Dy.ABDICATED){this.state=Dy.USED,this.servicesService.getGameService().enable(wv.PLATEAU),this.servicesService.getRoyalService().increaseRoyalPoints(this.settings.RP),this.logService.log("Your abdication granted you "+this.settings.RP+" royal points");var t=this.servicesService.getKongregateService();t.isAvailable()&&t.submitStat("Sacred Grove",!0)}}}]),i}(Ly),Ky=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return p(this,i),(e=t.call(this,r,Pv.STASH,n,um.FORT.STASH,!1,!0,!1,o)).servicesService&&(e.armyService=n.getArmyService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType}}},{key:"build",value:function(){return this.armyService.increaseStash(um.FORT.STASH.SIZE),this}},{key:"prepareDemolish",value:function(){return this.armyService.decreaseStash(um.FORT.STASH.SIZE),!0}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("stash size: "+um.FORT.STASH.SIZE);case Dm.SECOND:case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}}]),i}(xm),Qy=(function(e){e.CRAFTING="crafting {craft}",e.WAITING_FOR_RESOURCES="waiting for resources",e.WAITING_FOR_WAREHOUSE="waiting for warehouse space",e.NO_CRAFTING="no crafting recipe",e.PRODUCTION_SETUP="production setup",e.FETCHING_MATERIALS="fetching materials",e.TRANSPORTING="transporting goods"}(Qy||(Qy={})),Qy),qy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Qy.NO_CRAFTING,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return p(this,i),(e=t.call(this,r,Pv.MANUFACTURE,n,um.VILLAGE.MANUFACTURE,a,!0,!0,c)).progress=o,e.status=s,e.storage=l,e.recipe=null,e.iconsValue=[],n&&(e.resourcesService=n.getResourcesService(),e.modalService=n.getModalService(),e.recipeService=n.getRecipeService(),u>=0&&(e.recipe=e.recipeService.getRecipeById(u),e.prepareIcons())),e}return S(i,[{key:"prepareIcons",value:function(){var e=this;this.iconsValue=[],this.recipe&&Array.from(this.recipe.cost.entries()).forEach(function(t){e.iconsValue.push({name:Mv[t[0]],path:"resources",prefix:t[1],suffix:""})})}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,recipe:null!==this.recipe?this.recipe.id:-1,storage:this.storage}}},{key:"build",value:function(){return this.startProduction(),this}},{key:"prepareDemolish",value:function(){return u(v(i.prototype),"prepareDemolish",this).call(this)}},{key:"callback",value:function(e){var t=this;if("select"===e){this.modalService.open(_v.RECIPE);var i=this.modalService.registerForValueResponse().subscribe(function(e){i.unsubscribe(),null!==e&&(t.recipe=t.recipeService.getRecipeById(e),t.prepareIcons(),t.status=Qy.PRODUCTION_SETUP)})}else if("change"===e){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to change production recipe?");var n=this.modalService.registerForConfirmation().subscribe(function(e){if(n.unsubscribe(),e){t.modalService.open(_v.RECIPE),t.modalService.setModalValue(t.recipe.id);var i=t.modalService.registerForValueResponse().subscribe(function(e){i.unsubscribe(),null!==e&&(t.progress=0,t.recipe=t.recipeService.getRecipeById(e),t.prepareIcons(),t.status=Qy.PRODUCTION_SETUP)})}})}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(this.recipe?this.status.replace("{craft}",Qv.prepareResourceName(this.recipe.resource)):this.status);case Dm.SECOND:return Mm.progressValue(this.progress);case Dm.THIRD:return this.recipe?Mm.iconValue(this.iconsValue):Mm.emptyValue();case Dm.FOURTH:return null===this.recipe?Mm.buttonValue("select recipe","select"):Mm.buttonValue(Qv.prepareResourceName(this.recipe.resource),"change")}}},{key:"tick",value:function(e){if(this.working)if(this.status===Qy.PRODUCTION_SETUP)this.progress<100?(this.progress+=.5*this.getPower()/this.recipe.craftingDifficulty,this.progress>100&&(this.progress=100)):(this.progress=0,this.status=Qy.FETCHING_MATERIALS);else if(this.status===Qy.CRAFTING)this.progress<100?(this.progress+=this.getPower()/this.recipe.craftingDifficulty*um.VILLAGE.MANUFACTURE.CRAFTING_POWER,this.progress>100&&(this.progress=100)):(this.progress=0,this.storage=this.recipe.amount,this.status=Qy.TRANSPORTING);else if(this.status===Qy.FETCHING_MATERIALS||this.status===Qy.WAITING_FOR_RESOURCES)this.status=this.resourcesService.decreaseResources(this.recipe.cost,this.getName(),!1,1,!0)?Qy.CRAFTING:Qy.WAITING_FOR_RESOURCES;else if(this.status===Qy.TRANSPORTING||this.status===Qy.WAITING_FOR_WAREHOUSE){var t=this.resourcesService.getLimit(this.recipe.resource);this.storage>t?(this.storage-=t,this.resourcesService.increaseResource(this.recipe.resource,t,this.getName()),this.status=Qy.WAITING_FOR_WAREHOUSE):this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName())&&(this.status=Qy.FETCHING_MATERIALS)}}},{key:"getRecipe",value:function(){return this.recipe}},{key:"cancelCrafting",value:function(){this.recipe=null,this.progress=0,this.status=Qy.NO_CRAFTING}}]),i}(xm),Xy=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];return p(this,i),t.call(this,e,n,Pv.LONGHOUSE,um.VILLAGE.LONGHOUSE,r,o,s,a,u,c,l)}return i}(mE),Zy=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Vv.NONE,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.EMBASSY,n,um.FORT.EMBASSY,s,!0,!0,c)).progress=o,e.country=a,e.paper=u,e.servicesService&&(e.worldService=n.getWorldService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,working:this.working,progress:this.progress,country:this.country,paper:this.paper,buildingType:this.buildingType}}},{key:"callback",value:function(e){this.country=Vv[String(e.target.value)],this.progress=0}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:var t=this.worldService.getCountriesList();return t.includes(Vv[this.country])||(this.country=Vv.NONE),Mm.dropdownValue(t,Vv[this.country]);case Dm.SECOND:return this.country===Vv.NONE?Mm.emptyValue():Mm.textValue("current standing: "+this.worldService.getCountry(this.country).diplomacy);case Dm.THIRD:return this.country===Vv.NONE?Mm.emptyValue():Mm.progressValue(this.progress);case Dm.FOURTH:return this.paper<.5?Mm.textValue("No enough paper"):Mm.emptyValue()}}},{key:"tick",value:function(e){!this.working||(this.paper<5&&this.resourcesService.decreaseResource(Mv.PAPER,1,this.getName())&&(this.paper+=1),this.country!==Vv.NONE&&this.paper>=1&&this.worldService.getCountry(this.country).diplomacy<100&&(this.progress<100?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):(this.progress=0,this.paper-=.5,this.worldService.getCountry(this.country).increaseDiplomacy(1))))}},{key:"getDetails",value:function(){return u(v(i.prototype),"getDetails",this).call(this)+"paper: "+this.paper}}]),i}(xm),$y=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GE.FETCHING_INPUT,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),t.call(this,e,n,Pv.PAPER_MILL,um.FOREST.PAPER_MILL,o,r,s,a,u,c,l)}return i}(BE),Jy=(function(e){e.MINING="mining {res}",e.WAITING_FOR_SELECTION="waiting for ore selection",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.LOOKING_FOR_NEW_ORE_VEIN="looking for new ore vein",e.WAITING_FOR_ORE_DEPOSIT="waiting for ore deposit",e.TRANSPORTING="transporting {res}"}(Jy||(Jy={})),Jy),eR=function(){var e=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Jy.WAITING_FOR_SELECTION,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:20,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Mv.NOTHING,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;return p(this,i),(e=t.call(this,r,Pv.DEEP_MINE,n,um.MOUNTAINS.DEEP_MINE,u,i.maxWorkers,!0,!0,d)).progress=o,e.status=s,e.storage=a,e.resources=c,e.oreToFind=l,e.ore=h,e.maxResources=20*d,e.servicesService&&(e.modalService=n.getModalService(),e.landService=n.getLandService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,storage:this.storage,workers:this.workers,resources:this.resources,oreToFind:this.oreToFind,ore:this.ore}}},{key:"callback",value:function(e){var t=this;if(this.ore===Mv.NOTHING)if(Mv[String(e.target.value).replace(" ","_")]===Mv.STONE){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to mine "+Qv.prepareResourceName(Mv[String(e.target.value).replace(" ","_")])+" in this mine?");var i=this.modalService.registerForConfirmation().subscribe(function(n){n?(t.ore=Mv[String(e.target.value).replace(" ","_")],t.status=Jy.MINING,t.progress=0):e.target.selectedIndex=t.ore,i.unsubscribe()})}else if(this.landService.hasOre(Mv[String(e.target.value).replace(" ","_")],20)){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to mine "+Qv.prepareResourceName(Mv[String(e.target.value).replace(" ","_")])+" in this mine?");var n=this.modalService.registerForConfirmation().subscribe(function(i){i?(t.landService.decreaseOre(Mv[String(e.target.value).replace(" ","_")],20),t.ore=Mv[String(e.target.value).replace(" ","_")],t.status=Jy.MINING,t.progress=0,t.startProduction()):e.target.selectedIndex=t.ore,n.unsubscribe()})}else this.modalService.info("Not enough "+Qv.prepareResourceName(Mv[String(e.target.value).replace(" ","_")])+" deposits available<br>20 "+Qv.prepareResourceName(Mv[String(e.target.value).replace(" ","_")])+" deposits required to start mining."),e.target.selectedIndex=this.ore;else"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}},{key:"hasBuff",value:function(){return!this.isUsedUp()&&u(v(i.prototype),"hasBuff",this).call(this)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:if(this.ore!==Mv.NOTHING)return Mm.textValue(Qv.prepareResourceName(this.ore).toLowerCase()+": "+this.resources+"/"+this.maxResources);var t=[];return t.push(Mv[Mv.NOTHING].replace("_"," ")),t.push(Mv[Mv.STONE].replace("_"," ")),t.push(Mv[Mv.COAL].replace("_"," ")),t.push(Mv[Mv.GOLD_ORE].replace("_"," ")),t.push(Mv[Mv.SILVER_ORE].replace("_"," ")),t.push(Mv[Mv.COPPER_ORE].replace("_"," ")),t.push(Mv[Mv.TIN_ORE].replace("_"," ")),t.push(Mv[Mv.IRON_ORE].replace("_"," ")),Mm.dropdownValue(t,Mv[this.ore]);case Dm.SECOND:return Mm.textValue(this.status.replace("{res}",Qv.prepareResourceName(this.ore).toLowerCase()));case Dm.THIRD:return this.ore!==Mv.NOTHING?Mm.progressValue(this.progress):Mm.emptyValue();case Dm.FOURTH:return this.ore!==Mv.NOTHING?Mm.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire"):Mm.emptyValue()}}},{key:"tick",value:function(e){if(this.ore!==Mv.NOTHING){if(!this.isWorking())return;if(this.status===Jy.LOOKING_FOR_NEW_ORE_VEIN||this.status===Jy.WAITING_FOR_ORE_DEPOSIT){if(0===this.oreToFind)if(this.ore===Mv.STONE)this.oreToFind=this.maxResources;else{var t=this.landService.getOre(this.ore);if(!(t>0))return void(this.status=Jy.WAITING_FOR_ORE_DEPOSIT);10*t>this.maxResources?(this.landService.decreaseOre(this.ore,this.maxResources/10),this.oreToFind=this.maxResources):(this.landService.decreaseOre(this.ore,t),this.oreToFind=10*t)}this.progress<100?(this.progress+=this.getPower()*this.workers/(this.oreToFind/this.getBuildingLevel()),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources=this.oreToFind,this.oreToFind=0,this.status=Jy.MINING)}else this.storage>0?this.resourcesService.increaseResource(this.ore,this.storage,this.getName())?(this.storage=0,sp.chance(this.settings.GEM_CHANCE)&&this.resourcesService.increaseResource(Mv.GEMS,1,this.getName()),this.status=this.resources<=0?Jy.LOOKING_FOR_NEW_ORE_VEIN:Jy.MINING):this.status=Jy.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=Jy.MINING,this.progress+=this.getPower()*this.workers,this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=Jy.TRANSPORTING)}}},{key:"build",value:function(){return this.startProduction(),this}},{key:"isStoppable",value:function(){return this.status!==Jy.WAITING_FOR_SELECTION}},{key:"setBuildingLevel",value:function(e){u(v(i.prototype),"setBuildingLevel",this).call(this,e),this.maxResources=20*this.getBuildingLevel()}},{key:"getBuildingData",value:function(){return[this.ore,this.resources,this.status]}},{key:"setBuildingData",value:function(e){this.ore=e[0],this.resources=e[1],this.status=e[2],this.resources>0&&(this.status=Jy.MINING)}}]),i}(My);return e.maxWorkers=4,e}(),tR=(function(e){e.GATHERING_FOOD="gathering food",e.GATHERING_RESOURCES="gathering resources",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING="transporting"}(tR||(tR={})),tR),iR=(function(e){e[e.FOOD=0]="FOOD",e[e.RESOURCES=1]="RESOURCES"}(iR||(iR={})),iR),nR=function(){var e=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tR.GATHERING_FOOD,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:iR.FOOD,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;return p(this,i),(e=t.call(this,r,Pv.GATHERERS_CAMP,n,um.FOREST.GATHERERS_CAMP,a,i.maxWorkers,!0,!0,l)).progress=o,e.status=s,e.mode=u,e.storage=c,e.lastFind=[],e.servicesService&&(e.weatherService=n.getWeatherService()),e}return S(i,[{key:"rollForFind",value:function(){var e=[],t=1+this.storage.length/20;return this.mode===iR.FOOD?(this.storage.find(function(e){return e[0]===Mv.BERRY})||e.push({item:Mv.BERRY,chance:this.settings.BERRY_CHANCE*t}),this.storage.find(function(e){return e[0]===Mv.MUSHROOM})||e.push({item:Mv.MUSHROOM,chance:this.settings.MUSHROOM_CHANCE*t}),this.storage.find(function(e){return e[0]===Mv.WHEAT})||e.push({item:Mv.WHEAT,chance:this.settings.WHEAT_CHANCE*t}),this.storage.find(function(e){return e[0]===Mv.HERBS})||e.push({item:Mv.HERBS,chance:this.settings.HERBS_CHANCE*t})):this.mode===iR.RESOURCES&&(this.storage.find(function(e){return e[0]===Mv.BRUSHWOOD})||e.push({item:Mv.BRUSHWOOD,chance:this.settings.BRUSHWOOD_CHANCE*t}),this.storage.find(function(e){return e[0]===Mv.STONE})||e.push({item:Mv.STONE,chance:this.settings.STONE_CHANCE*t}),this.storage.find(function(e){return e[0]===Mv.LOG})||e.push({item:Mv.LOG,chance:this.settings.LOG_CHANCE*t}),this.storage.find(function(e){return e[0]===Mv.COPPER})||e.push({item:Mv.COPPER,chance:this.settings.COPPER_CHANCE*t}),this.storage.find(function(e){return e[0]===Mv.HERBS})||e.push({item:Mv.HERBS,chance:this.settings.HERBS_CHANCE*t})),sp.randomElement(e)}},{key:"build",value:function(){return this.servicesService.getManagementService().getDefaultGathererFood()||(this.mode=iR.RESOURCES,this.status=tR.GATHERING_RESOURCES),u(v(i.prototype),"build",this).call(this)}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,workers:this.workers,storage:this.storage,mode:this.mode}}},{key:"callback",value:function(e){e===iR.FOOD?(this.mode=iR.FOOD,this.progress=0,this.storage=[],this.lastFind=[],this.status=tR.GATHERING_FOOD):e===iR.RESOURCES?(this.mode=iR.RESOURCES,this.progress=0,this.storage=[],this.lastFind=[],this.status=tR.GATHERING_RESOURCES):"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.mode===iR.FOOD?Mm.buttonValue("gather resources",iR.RESOURCES):Mm.buttonValue("gather food",iR.FOOD);case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire")}}},{key:"tick",value:function(e){var t=this;if(this.isWorking())if(this.status===tR.TRANSPORTING||this.status===tR.WAITING_FOR_WAREHOUSE_SPACE)this.storage.forEach(function(e){t.resourcesService.increaseResource(e[0],1,t.getName())&&(e[1]-=1)}),this.storage=this.storage.filter(function(e){return e[1]>0}),this.storage.length>=this.canFindN()?this.status=tR.WAITING_FOR_WAREHOUSE_SPACE:this.setStatus();else if(this.storage.length<this.canFindN()){if(this.progress<100)this.setStatus(),this.progress+=this.getPower(),this.progress>100&&(this.progress=100);else if(100===this.progress){this.progress=0,this.lastFind=[];for(var i=function(e){var i=t.rollForFind();null!==i&&t.resourcesService.increaseResource(i,1,t.getName())?t.lastFind.push(i):null===i||t.storage.find(function(e){return e[0]===i})?i=null:(t.storage.push([i,1]),t.status=tR.TRANSPORTING),t.storage.length>0&&(t.status=tR.TRANSPORTING),t.progress=0},n=0;n<this.workers;n++)i()}}else this.progress=0,this.status=tR.WAITING_FOR_WAREHOUSE_SPACE}},{key:"canFindN",value:function(){return this.mode===iR.FOOD?4:5}},{key:"getDetails",value:function(){var e="last find:<br>";this.lastFind&&this.lastFind.length>0?this.lastFind.forEach(function(t){e+=Qv.prepareResourceName(t)+"<br>"}):e+="nothing<br>";var t="";return e.length>"last find:<br>".length&&(t=e),t+="local storage:<br>",this.storage.forEach(function(e){t+=Qv.prepareResourceName(e[0])+": "+e[1]+"<br>"}),u(v(i.prototype),"getDetails",this).call(this)+t}},{key:"setStatus",value:function(){this.status=this.mode===iR.FOOD?tR.GATHERING_FOOD:tR.GATHERING_RESOURCES}}]),i}(My);return e.maxWorkers=5,e}(),rR=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uv.NONE,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return p(this,i),(e=t.call(this,r,Pv.BARN,n,um.FIELD.BARN,!1,!0,!1,a)).crop=o,e.storage=s,e.servicesService&&(e.modalService=n.getModalService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,crop:this.crop,storage:this.storage}}},{key:"callback",value:function(e){var t=this;if(this.crop===Uv.NONE)this.crop=Uv[String(e.target.value)],this.resourcesService.increaseResourceLimit(Mv[Uv[this.crop]],6*this.storage);else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to switch barn storage type?<br>All excess resources will be lost");var i=this.modalService.registerForConfirmation().subscribe(function(n){n?(t.resourcesService.decreaseResourceLimit(Mv[Uv[t.crop]],6*t.storage),t.crop=Uv[String(e.target.value)],t.resourcesService.increaseResourceLimit(Mv[Uv[t.crop]],6*t.storage)):e.target.selectedIndex=t.crop-1,i.unsubscribe()})}}},{key:"getComplexity",value:function(){return u(v(i.prototype),"getComplexity",this).call(this)*(this.storage/this.settings.SIZE)}},{key:"getSize",value:function(){return this.storage}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.firstLine();case Dm.SECOND:return Mm.textValue("storage: "+6*this.storage);case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"firstLine",value:function(){var e=[];return e.push(Uv[Uv.NONE]),e.push(Uv[Uv.WHEAT]),e.push(Uv[Uv.HAY]),e.push(Uv[Uv.BERRY]),e.push(Uv[Uv.MUSHROOM]),this.resourcesService.getResource(Mv.BARLEY).isVisible()&&e.push(Uv[Uv.BARLEY]),this.resourcesService.getResource(Mv.HOP).isVisible()&&e.push(Uv[Uv.HOP]),this.resourcesService.getResource(Mv.COTTON).isVisible()&&e.push(Uv[Uv.COTTON]),this.resourcesService.getResource(Mv.HERBS).isVisible()&&e.push(Uv[Uv.HERBS]),Mm.dropdownValue(e,Uv[this.crop])}},{key:"prepareDemolish",value:function(){return this.crop!==Uv.NONE&&this.resourcesService.decreaseResourceLimit(Mv[Uv[this.crop]],6*this.storage),!0}},{key:"startProduction",value:function(){return!1}},{key:"stopProduction",value:function(){}},{key:"fireWorker",value:function(){return!1}},{key:"hireWorker",value:function(){return!1}},{key:"getWorkers",value:function(){return 0}},{key:"getHappinessEffect",value:function(){return 0}},{key:"isCombinable",value:function(){return!0}},{key:"isSplittable",value:function(){return!0}},{key:"combine",value:function(e,t){var i=this;if(this.getBuildingType()===e.getBuildingType()){this.modalService.open(_v.CONFIRM),this.modalService.setModalText(" Are you sure you want to combine "+this.getName()+" of size "+this.getSize()+" with "+e.getName()+" of size "+e.getSize()+"?<br>Resulting "+this.getName()+" of size "+(this.getSize()+e.getSize())+" will store <b>"+Qv.prepareCropName(this.crop)+"</b><br>All resources exceeding decreased limit of <b>"+Qv.prepareCropName(e.crop)+"</b> will be lost");var n=this.modalService.registerForConfirmation().subscribe(function(r){n.unsubscribe(),r?(i.storage+=e.getSize(),i.crop!==Uv.NONE&&i.resourcesService.increaseResourceLimit(Mv[Uv[i.crop]],6*e.getSize()),t.finaliseCombine(!0)):t.finaliseCombine(!1)})}}},{key:"split",value:function(e){var t=this;this.modalService.open(_v.INPUT),this.modalService.setModalText("Set split size (1-"+(this.getSize()-1)+")"),this.modalService.setModalValue("");var n=this.modalService.registerForValueResponse().subscribe(function(r){n.unsubscribe(),null!==r&&!isNaN(r)&&0!==r&&(r>=1&&r<t.getSize()?(t.storage-=Number(r),e.finaliseSplit(new i(t.servicesService,t.servicesService.getIdService().getNextId(),t.crop,Number(r)).build())):t.modalService.info("Invalid size value!"))})}}]),i}(xm),oR=(function(e){e.COOKING="cooking {craft}",e.WAITING_FOR_WAREHOUSE="waiting for {craft} space",e.NO_COOKING="nothing to cook"}(oR||(oR={})),oR),sR=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:oR.NO_COOKING,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return p(this,i),(e=t.call(this,r,Pv.KITCHEN,n,um.VILLAGE.KITCHEN,a,!0,!0,l)).progress=o,e.status=s,e.storage=h,e.recipe=null,e.icon=null,e.servicesService&&(c?e.recipe=c:u>=0&&(e.recipe=e.servicesService.getRecipeService().getRecipeById(u)),e.craftingService=n.getService(Zv.CRAFTING),e.gameService=n.getGameService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,recipeId:null!==this.recipe?this.recipe.id:-1,storage:this.storage}}},{key:"build",value:function(){return this.startProduction(),this.craftingService.increaseCookingQueueSize(1),this}},{key:"prepareDemolish",value:function(){return this.craftingService.decreaseCookingQueueSize(1),u(v(i.prototype),"prepareDemolish",this).call(this)}},{key:"callback",value:function(e){"cancel"===e&&(this.recipe=null,this.progress=0,this.status=oR.NO_COOKING)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:return this.recipe?(this.icon||(this.prepareIcon(),this.status===oR.COOKING?this.icon[0].prefix="cooking ":this.status===oR.WAITING_FOR_WAREHOUSE&&(this.icon[0].prefix="waiting for ",this.icon[0].suffix=" space")),Mm.iconValue(this.icon)):Mm.textValue(this.status.replace("{craft}","warehouse"));case Dm.THIRD:return this.recipe?Mm.buttonValue("cancel cooking","cancel"):Mm.emptyValue();case Dm.FOURTH:return Mm.progressValue(this.progress)}}},{key:"tick",value:function(e){if(this.working)if(null===this.recipe&&(this.recipe=this.craftingService.getCookingOrder(),this.icon=null,this.progress=0),null===this.recipe)this.status=oR.NO_COOKING;else if(this.status===oR.WAITING_FOR_WAREHOUSE){var t=this.resourcesService.getLimit(this.recipe.resource);this.storage>t?(this.storage-=t,this.resourcesService.increaseResource(this.recipe.resource,t,this.getName())):(this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName()),this.status=oR.COOKING,this.progress=0,this.recipe=null)}else if(this.status=oR.COOKING,this.progress<100&&(this.progress+=this.getPower()/this.recipe.craftingDifficulty*um.VILLAGE.KITCHEN.CRAFTING_POWER),this.progress>=100){this.progress=100,this.storage=this.recipe.amount;var i=this.resourcesService.getLimit(this.recipe.resource);this.storage>i?(this.storage-=i,this.resourcesService.increaseResource(this.recipe.resource,i,this.getName()),this.status=oR.WAITING_FOR_WAREHOUSE,this.icon=null):this.resourcesService.increaseResource(this.recipe.resource,this.storage,this.getName())?(this.progress=0,this.storage=0,this.recipe=null):(this.status=oR.WAITING_FOR_WAREHOUSE,this.icon=null)}}},{key:"getRecipe",value:function(){return this.recipe}},{key:"cancelCooking",value:function(){this.recipe=null}},{key:"prepareIcon",value:function(){this.recipe&&(this.icon=[{name:Qv.prepareResourceName(this.recipe.resource),path:"resources",prefix:"",suffix:""}])}}]),i}(xm),aR=(function(e){e.DIGGING_CLAY="digging clay",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more resources",e.TRANSPORTING="transporting"}(aR||(aR={})),aR),uR=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:aR.DIGGING_CLAY,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:400,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;return p(this,i),(e=t.call(this,r,Pv.CLAY_PIT,n,um.FIELD.CLAY_PIT,a,!0,!0,l)).progress=o,e.status=s,e.storage=u,e.resources=c,e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working,storage:this.storage,resources:this.resources}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("clay: "+this.resources);case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"isStoppable",value:function(){return this.resources>0}},{key:"isUsedUp",value:function(){return this.status===aR.NO_MORE_RESOURCES}},{key:"hasBuff",value:function(){return!this.isUsedUp()&&u(v(i.prototype),"hasBuff",this).call(this)}},{key:"tick",value:function(e){this.resources<=0&&(this.status!==aR.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Clay pit has no more clay"),this.status=aR.NO_MORE_RESOURCES,this.stopProduction()),this.working&&(this.storage>0?this.resourcesService.increaseResource(Mv.CLAY,this.storage,this.getName())?(this.storage=0,this.status=aR.DIGGING_CLAY):this.status=aR.WAITING_FOR_WAREHOUSE_SPACE:this.progress<100?(this.status=aR.DIGGING_CLAY,this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=aR.TRANSPORTING))}}]),i}(xm),cR=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];return p(this,i),t.call(this,e,n,Pv.TUDOR_HOUSE,um.VILLAGE.TUDOR_HOUSE,r,o,s,a,u,c,l)}return i}(mE),lR=(function(e){e.CHOPPING_TREES="chopping {amount} tree{plural}",e.WAITING_FOR_TREES="waiting for trees",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.TRANSPORTING_LOG="transporting log"}(lR||(lR={})),lR),hR=function(){var e=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:lR.WAITING_FOR_TREES,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.LOGGERS_CAMP,n,um.FOREST.LOGGERS_CAMP,u,i.maxWorkers,!0,!0,c)).progress=o,e.reservedTrees=s,e.status=a,e.servicesService&&(e.landService=n.getLandService()),e}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.emptyValue();case Dm.SECOND:var t=this.status.replace("{amount}",""+this.reservedTrees);return t=t.replace("{plural}",1===this.reservedTrees?"":"s"),Mm.textValue(t);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire")}}},{key:"callback",value:function(e){"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}},{key:"tick",value:function(){if(this.isWorking())if(this.status===lR.WAITING_FOR_TREES){var e=Math.min(this.workers,this.landService.getForest(),this.landService.getForest());this.landService.reduceForest(e)&&(this.reservedTrees=e,this.status=lR.CHOPPING_TREES)}else if(this.status===lR.CHOPPING_TREES)this.progress<100?(this.progress+=this.getPower()*(this.getWorkers()/this.reservedTrees),this.progress>=100&&(this.progress=100)):(this.progress=0,this.status=lR.TRANSPORTING_LOG);else if(this.status===lR.TRANSPORTING_LOG||this.status===lR.WAITING_FOR_WAREHOUSE_SPACE)if(this.resourcesService.increaseResource(Mv.LOG,this.reservedTrees,this.getName())){this.landService.increaseLand(this.reservedTrees,!0);var t=Math.min(this.workers,this.landService.getForest(),this.landService.getForest());this.landService.reduceForest(t)?(this.reservedTrees=t,this.status=lR.CHOPPING_TREES):this.status=lR.WAITING_FOR_TREES}else{var i=this.resourcesService.getLimit(Mv.LOG),n=Math.min(i,this.reservedTrees);this.reservedTrees-=n,this.landService.increaseLand(n,!0),this.resourcesService.increaseResource(Mv.LOG,n,this.getName()),this.status=lR.WAITING_FOR_WAREHOUSE_SPACE}}},{key:"prepareDemolish",value:function(){return this.landService.increaseForest(this.reservedTrees,!1),this.stopProduction(),!0}},{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,workers:this.workers,reservedTrees:this.reservedTrees}}},{key:"getDetails",value:function(){return this.status===lR.WAITING_FOR_WAREHOUSE_SPACE?u(v(i.prototype),"getDetails",this).call(this)+"local storage:<br>&nbsp;&nbsp;logs: "+this.reservedTrees:u(v(i.prototype),"getDetails",this).call(this)}}]),i}(My);return e.maxWorkers=5,e}(),dR=(function(e){e.MINING="mining {res}",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space",e.NO_MORE_RESOURCES="no more {res}",e.TRANSPORTING="transporting {res}"}(dR||(dR={})),dR),gR=function(){var e=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mv.NOTHING,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:dR.MINING,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;return p(this,i),(e=t.call(this,r,Pv.METEORITE,n,um.MOUNTAINS.METEORITE,l,i.maxWorkers,!0,!0,h)).resources=o,e.ore=s,e.progress=a,e.status=u,e.storage=c,e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,storage:this.storage,workers:this.workers,resources:this.resources,ore:this.ore}}},{key:"isUsedUp",value:function(){return this.status===dR.NO_MORE_RESOURCES}},{key:"callback",value:function(e){"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(Qv.prepareResourceName(this.ore).toLowerCase()+": "+this.resources);case Dm.SECOND:return Mm.textValue(this.status.replace("{res}",Qv.prepareResourceName(this.ore).toLowerCase()));case Dm.THIRD:return this.resources>0?Mm.progressValue(this.progress):Mm.emptyValue();case Dm.FOURTH:return this.resources>0?Mm.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire"):Mm.emptyValue()}}},{key:"tick",value:function(e){this.resources<=0&&0===this.storage&&(this.status!==dR.NO_MORE_RESOURCES&&this.servicesService.getLogService().warning("Meteorite fully mined "+Qv.prepareResourceName(this.ore)),this.status=dR.NO_MORE_RESOURCES,this.stopProduction()),this.isWorking()&&(this.storage>0?this.resourcesService.increaseResource(this.ore,this.storage,this.getName())?(this.storage=0,this.status=dR.MINING):this.status=dR.WAITING_FOR_WAREHOUSE_SPACE:this.resources>0&&this.progress<100?(this.status=dR.MINING,this.progress+=this.getPower()*this.workers,this.progress>100&&(this.progress=100)):100===this.progress&&(this.progress=0,this.resources-=1,this.storage=1,this.status=dR.TRANSPORTING))}},{key:"build",value:function(){return this}},{key:"isStoppable",value:function(){return this.resources>0}}]),i}(My);return e.maxWorkers=4,e}(),fR=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return p(this,i),t.call(this,n,Pv.PIER,e,um.SEA.PIER,!1,!0,!1,r)}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("size: "+this.getSize());case Dm.SECOND:return Mm.textValue("space for ships: "+this.settings.HARBOUR_SIZE);case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"toJSON",value:function(){return{buildingType:this.buildingType,id:this.id,level:this.level}}},{key:"build",value:function(){return this.servicesService.getNavyService().increaseHarbourSize(this.settings.HARBOUR_SIZE),this}},{key:"prepareDemolish",value:function(){return this.servicesService.getNavyService().decreaseHarbourSize(this.settings.HARBOUR_SIZE),u(v(i.prototype),"prepareDemolish",this).call(this)}}]),i}(xm),vR=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return p(this,i),t.call(this,n,Pv.HARBOUR,e,um.SEA.HARBOUR,!1,!0,!1,r)}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("size: "+this.getSize());case Dm.SECOND:return Mm.textValue("space for ships: "+this.settings.HARBOUR_SIZE);case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"toJSON",value:function(){return{buildingType:this.buildingType,id:this.id,level:this.level}}},{key:"build",value:function(){return this.servicesService.getNavyService().increaseHarbourSize(this.settings.HARBOUR_SIZE),this}},{key:"prepareDemolish",value:function(){return this.servicesService.getNavyService().decreaseHarbourSize(this.settings.HARBOUR_SIZE),u(v(i.prototype),"prepareDemolish",this).call(this)}}]),i}(xm),pR=(function(e){e.LIGHT_BURNING="light burning",e.WAITING_FOR_FUEL="waiting for fuel"}(pR||(pR={})),pR),mR=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pR.LIGHT_BURNING,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return p(this,i),(e=t.call(this,r,Pv.LIGHTHOUSE,n,um.SEA.LIGHTHOUSE,a,!0,!0,u)).status=o,e.fuel=s,n&&(e.worldService=n.getWorldService()),e}return S(i,[{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue("size: "+this.getSize());case Dm.SECOND:return Mm.textValue(this.status);case Dm.THIRD:return Mm.textValue("fuel: "+Qv.round(this.fuel,2));case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){!this.working||(this.fuel<5?this.resourcesService.decreaseResource(Mv.FUEL,1,this.getName())&&(this.fuel+=1):this.fuel<=0&&(this.status=pR.WAITING_FOR_FUEL),this.worldService.getPlayerSeaMissions().length>0&&this.fuel>=.005&&(this.fuel-=.005))}},{key:"isBurning",value:function(){return this.status===pR.LIGHT_BURNING&&this.isWorking()}},{key:"toJSON",value:function(){return{buildingType:this.buildingType,id:this.id,status:this.status,working:this.working,fuel:this.fuel,level:this.level}}}]),i}(xm),SR=(function(e){e.BUILDING_SHIP="building {ship}",e.WAITING_FOR_ORDER="waiting for order"}(SR||(SR={})),SR),ER=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:SR.WAITING_FOR_ORDER,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.BOAT_BUILDER,n,um.SEA.BOAT_BUILDER,a,!0,!0,c)).progress=o,e.status=s,e.ship=u,n&&(e.resourcesService=n.getResourcesService(),e.modalService=n.getModalService(),e.navyService=n.getNavyService()),e}return S(i,[{key:"toJSON",value:function(){return{buildingType:this.buildingType,id:this.id,progress:this.progress,status:this.status,working:this.working,ship:this.ship,level:this.level}}},{key:"build",value:function(){return this.startProduction(),this.gameService.isEnabled(wv.NAVY)||(this.gameService.enable(wv.NAVY),this.logService.log("Navy tab unlocked")),this}},{key:"callback",value:function(e){var t=this;if("select"===e){this.modalService.open(_v.SHIPYARD),this.modalService.setShipyardLimitBoat(!0);var i=this.modalService.registerForValueResponse().subscribe(function(e){i.unsubscribe(),null!==e&&(t.ship=e,t.status=SR.BUILDING_SHIP)})}else if("cancel"===e){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel building "+Qv.prepareTroopName(this.ship)+"?");var n=this.modalService.registerForConfirmation().subscribe(function(e){n.unsubscribe(),e&&(t.ship=null,t.progress=0,t.status=SR.WAITING_FOR_ORDER)})}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(this.ship?this.status.replace("{ship}",Qv.prepareTroopName(this.ship)):this.status);case Dm.SECOND:return this.ship?Mm.progressValue(this.progress):Mm.emptyValue();case Dm.THIRD:return null===this.ship?Mm.buttonValue("select ship","select"):Mm.buttonValue("cancel "+Qv.prepareTroopName(this.ship),"cancel");case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){(null==this.ship||this.ship!==Bv.BOAT)&&(this.ship=null,this.status=SR.WAITING_FOR_ORDER),this.working&&this.status===SR.BUILDING_SHIP&&(this.progress<100?(this.progress+=this.getPower()/lm.getTroop(this.ship).SIZE,this.progress>100&&(this.progress=100)):(this.progress=0,this.navyService.addShip(this.ship),this.ship=null,this.status=SR.WAITING_FOR_ORDER))}},{key:"getShipSize",value:function(){return(null==this.ship||this.ship!==Bv.BOAT&&this.ship!==Bv.BRIGANTINE&&this.ship!==Bv.GALLEON)&&(this.ship=null,this.status=SR.WAITING_FOR_ORDER),this.ship?lm.getTroop(this.ship).SIZE:0}}]),i}(xm),yR=(function(e){e.BUILDING_SHIP="building {ship}",e.WAITING_FOR_ORDER="waiting for order"}(yR||(yR={})),yR),RR=function(){var e=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yR.WAITING_FOR_ORDER,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return p(this,i),(e=t.call(this,r,Pv.SHIPYARD,n,um.SEA.SHIPYARD,a,i.maxWorkers,!0,!0,c)).progress=o,e.status=s,e.ship=u,n&&(e.resourcesService=n.getResourcesService(),e.modalService=n.getModalService(),e.navyService=n.getNavyService()),e}return S(i,[{key:"toJSON",value:function(){return{buildingType:this.buildingType,id:this.id,progress:this.progress,status:this.status,workers:this.workers,ship:this.ship,level:this.level}}},{key:"build",value:function(){return this.startProduction(),this.gameService.isEnabled(wv.NAVY)||(this.gameService.enable(wv.NAVY),this.logService.log("Navy tab unlocked")),this}},{key:"callback",value:function(e){var t=this;if("select"===e){this.modalService.open(_v.SHIPYARD),this.modalService.setShipyardLimitBoat(!1);var i=this.modalService.registerForValueResponse().subscribe(function(e){i.unsubscribe(),null!==e&&(t.ship=e,t.status=yR.BUILDING_SHIP)})}else if("cancel"===e){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel building "+Qv.prepareTroopName(this.ship)+"?");var n=this.modalService.registerForConfirmation().subscribe(function(e){n.unsubscribe(),e&&(t.ship=null,t.progress=0,t.status=yR.WAITING_FOR_ORDER)})}else"hire"===e?this.hireWorker():"fire"===e&&this.fireWorker()}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(this.ship?this.status.replace("{ship}",Qv.prepareTroopName(this.ship)):this.status);case Dm.SECOND:return this.ship?Mm.progressValue(this.progress):Mm.emptyValue();case Dm.THIRD:return null===this.ship?Mm.buttonValue("select ship","select"):Mm.buttonValue("cancel "+Qv.prepareTroopName(this.ship),"cancel");case Dm.FOURTH:return Mm.twoButtonValue("hire worker","hire",this.workers+"/"+this.maxWorkers,"fire worker","fire")}}},{key:"tick",value:function(e){(null==this.ship||this.ship!==Bv.BOAT&&this.ship!==Bv.BRIGANTINE&&this.ship!==Bv.GALLEON)&&(this.ship=null,this.status=yR.WAITING_FOR_ORDER),this.isWorking()&&this.status===yR.BUILDING_SHIP&&(this.progress<100?(this.progress+=this.getPower()/lm.getTroop(this.ship).SIZE*this.workers,this.progress>100&&(this.progress=100)):(this.progress=0,this.navyService.addShip(this.ship),this.ship=null,this.status=yR.WAITING_FOR_ORDER))}},{key:"getShipSize",value:function(){return(null==this.ship||this.ship!==Bv.BOAT&&this.ship!==Bv.BRIGANTINE&&this.ship!==Bv.GALLEON)&&(this.ship=null,this.status=yR.WAITING_FOR_ORDER),this.ship?lm.getTroop(this.ship).SIZE:0}}]),i}(My);return e.maxWorkers=10,e}(),OR=(function(e){e.DRAWING_MAP="drawing map",e.WAITING_FOR_CARTOGRAPHY_DATA="waiting for cartography data",e.WAITING_FOR_WAREHOUSE_SPACE="waiting for warehouse space"}(OR||(OR={})),OR),TR=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:OR.WAITING_FOR_CARTOGRAPHY_DATA,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return p(this,i),(e=t.call(this,r,Pv.CARTOGRAPHER,n,um.SEA.CARTOGRAPHER,a,!0,!0,u)).progress=o,e.status=s,e.servicesService&&(e.resourcesService=n.getResourcesService(),e.navyService=n.getNavyService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,working:this.working,status:this.status}}},{key:"build",value:function(){return this.servicesService.getResourcesService().makeVisible(Mv.MAP),u(v(i.prototype),"build",this).call(this)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return Mm.textValue(this.status);case Dm.SECOND:return Mm.progressValue(this.progress);case Dm.THIRD:return Mm.progressValue(this.navyService.getMapProgress(),"map progress");case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){!this.working||(this.status===OR.WAITING_FOR_CARTOGRAPHY_DATA?this.navyService.decreaseCartographyData(1)&&(this.status=OR.DRAWING_MAP):this.status===OR.DRAWING_MAP?this.progress<100?(this.progress+=this.getPower(),this.progress>100&&(this.progress=100)):this.navyService.getMapProgress()<100?(this.navyService.addMapProgress(),this.progress=0,this.status=OR.WAITING_FOR_CARTOGRAPHY_DATA):this.status=OR.WAITING_FOR_WAREHOUSE_SPACE:this.status===OR.WAITING_FOR_WAREHOUSE_SPACE&&(this.navyService.getMapProgress()>=100?this.navyService.createMap()&&(this.status=OR.WAITING_FOR_CARTOGRAPHY_DATA):this.status=OR.WAITING_FOR_CARTOGRAPHY_DATA))}}]),i}(xm),IR=function(e){c(i,e);var t=h(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];return p(this,i),t.call(this,e,n,Pv.SETTLEMENT,um.VILLAGE.SETTLEMENT,r,o,s,a,u,c,l)}return i}(mE),bR=(function(e){e.RESEARCHING="researching",e.NO_RESEARCH="nothing to research"}(bR||(bR={})),bR),CR=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bR.NO_RESEARCH,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return p(this,i),(e=t.call(this,r,Pv.SCHOLARS_LAB,n,um.VILLAGE.SCHOLARS_LAB,a,!0,!0,u)).progress=o,e.status=s,e.servicesService&&(e.techService=n.getTechService(),e.gameService=n.getGameService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,progress:this.progress,status:this.status,working:this.working}}},{key:"build",value:function(){return this.startProduction(),this}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:var t="";return this.techService.getCurrentResearch()&&(t=Qv.prepareTechName(this.techService.getCurrentResearch().getTech())),Mm.textValue(t);case Dm.SECOND:return Mm.progressValue(this.progress);case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){!this.working||(this.techService.isResearchStarted()?(this.status!==bR.RESEARCHING&&(this.progress=0),this.status=bR.RESEARCHING,this.progress+=this.getPower(),this.progress>=100&&(this.progress=0,this.techService.progressTech(um.VILLAGE.SCHOLARS_LAB.RESEARCH_POWER))):(this.status=bR.NO_RESEARCH,this.progress=0))}}]),i}(xm),AR=(function(e){e.COLLECTING_TAX="collecting tax",e.GIVING_DONATIONS="giving donations",e.WAITING_FOR_COINS="waiting for coins"}(AR||(AR={})),AR),kR=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:AR.COLLECTING_TAX,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return p(this,i),(e=t.call(this,r,Pv.TAX_COLLECTOR,n,um.VILLAGE.TAX_COLLECTOR,o,!0,!0,u)).status=s,e.progress=a,e.servicesService&&(e.happinessService=n.getHappinessService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,status:this.status,working:this.working,progress:this.progress}}},{key:"callback",value:function(e){"tax"===e?(this.progress=0,this.status=AR.COLLECTING_TAX):"donate"===e&&(this.progress=0,this.status=AR.GIVING_DONATIONS)}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.status===AR.COLLECTING_TAX?Mm.buttonValue("give donations","donate"):Mm.buttonValue("collect tax","tax");case Dm.SECOND:return 0===Number(this.servicesService.getManagementService().getTaxRate())?Mm.textValue("0% tax/donation"):Mm.textValue(this.status);case Dm.THIRD:return Mm.progressValue(this.progress);case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){if(this.working){var t=this.servicesService.getManagementService();if(0!==Number(t.getTaxRate()))if(this.status===AR.WAITING_FOR_COINS&&this.resourcesService.decreaseResource(Mv.COINS,this.calculateTax(),this.getName())&&(this.status=AR.GIVING_DONATIONS),this.progress<100)this.progress+=100/300,this.progress>100&&(this.progress=100);else{this.progress=0;var i=this.calculateTax(),n=Number(this.servicesService.getManagementService().getTaxRate());i>0&&(this.status===AR.COLLECTING_TAX?(this.resourcesService.increaseResource(Mv.COINS,i,this.getName()),this.updateHappinessEffect(-2*n,Kv.TAX)):(this.updateHappinessEffect(n,Kv.DONATION),this.resourcesService.decreaseResource(Mv.COINS,i,this.getName()),this.resourcesService.decreaseResource(Mv.COINS,i,this.getName())||(this.status=AR.WAITING_FOR_COINS)))}else this.progress=0}}},{key:"calculateTax",value:function(){var e=0;return this.servicesService.getVillageService().getHousingBuildings().map(function(e){return e}).forEach(function(t){return e+=um.getBuilding(t.getBuildingType()).TAX*t.getOccupants()}),e*=Number(this.servicesService.getManagementService().getTaxRate())}},{key:"updateHappinessEffect",value:function(e,t){var i=this.servicesService.getHappinessService(),n=i.getHappinessEffectByEffect(t);n?n.value=e:i.addHappinessEffect(0,t,e,29)}},{key:"getHappinessEffect",value:function(){return 0}},{key:"getEffects",value:function(){return 0}},{key:"getPermanentEffects",value:function(){return 0}}]),i}(xm),NR=(function(e){e.WORKING_AT_CONSTRUCTION="working at {}",e.WAITING_FOR_BUILDINGS="waiting for building sites",e.NO_SUPERVISOR="no supervisor"}(NR||(NR={})),NR),_R=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NR.WAITING_FOR_BUILDINGS,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return p(this,i),(e=t.call(this,r,Pv.BUILDERS_GUILD,n,um.VILLAGE.BUILDERS_GUILD,!0,!0,!0,s)).status=o,e.currentWorkplaceName="",e.servicesService&&(e.happinessService=n.getHappinessService(),e.regionsService=n.getRegionsService()),e}return S(i,[{key:"toJSON",value:function(){return{id:this.id,level:this.level,buildingType:this.buildingType,status:this.status,working:this.working}}},{key:"getLine",value:function(e){switch(e){case Dm.FIRST:return this.working?Mm.textValue("available workers: "+this.resourcesService.getPeople()):Mm.emptyValue();case Dm.SECOND:return Mm.textValue(this.status.replace("{}",this.currentWorkplaceName));case Dm.THIRD:case Dm.FOURTH:return Mm.emptyValue()}}},{key:"tick",value:function(e){if(this.working){var t=this.resourcesService.getPeople();if(t>0){var i=this.regionsService.getAllBuildingSites();if(0===(i=i.sort(function(e,t){return e.isWorking()&&t.isWorking()?e.getProgress()-t.getProgress():e.isWorking()&&!t.isWorking()?1:-1})).length)this.status=NR.WAITING_FOR_BUILDINGS;else{this.status=NR.WORKING_AT_CONSTRUCTION;var n=i[0];this.currentWorkplaceName=Qv.prepareBuildingName(n.getWorkingAt()),n.increaseProgress(t*this.getPower())}}}}},{key:"stopProduction",value:function(){this.status=NR.NO_SUPERVISOR,u(v(i.prototype),"stopProduction",this).call(this)}}]),i}(xm),wR=function(){var e=function(){function e(t){p(this,e),this.servicesService=t,this.nextId=1,t.addService(Zv.ID,this)}return S(e,[{key:"getNextId",value:function(){var e=this.nextId;return this.nextId+=1,e}},{key:"getName",value:function(){return"IdService"}},{key:"load",value:function(e){this.nextId=void 0===e.nextId||isNaN(e.nextId)?1:e.nextId}},{key:"reset",value:function(e,t){e&&(this.nextId=1)}},{key:"save",value:function(){return{nextId:this.nextId}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),PR=function(){var e=function(){function e(t,i){p(this,e),this.servicesService=t,this.idService=i,t.addService(Zv.BUILDING_FACTORY,this)}return S(e,[{key:"loadBuilding",value:function(e){return null==e.id&&(e.id=this.idService.getNextId()),void 0!==e.progress&&null===e.progress&&(e.progress=0),e.buildingType===Pv.HUT?new SE(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Pv.HOUSE?new EE(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Pv.LONGHOUSE?new Xy(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Pv.TUDOR_HOUSE?new cR(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Pv.SETTLEMENT?new IR(this.servicesService,e.id,e.occupants,e.progress,e.food,e.fuel,e.clothes,e.level,void 0===e.enabled||e.enabled):e.buildingType===Pv.BAKERY?new cy(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.TAILOR?new Sy(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.WORKSHOP?new XE(this.servicesService,e.id,e.progress,e.status,e.mode,e.working,void 0!==e.recipeId?e.recipeId:-1,e.recipe,e.level,void 0!==e.storage?e.storage:0):e.buildingType===Pv.SCHOLARS_LAB?new CR(this.servicesService,e.id,e.progress,e.status,e.working,e.level):e.buildingType===Pv.KITCHEN?new sR(this.servicesService,e.id,e.progress,e.status,e.working,e.recipeId,e.recipe,e.level,e.storage):e.buildingType===Pv.MANUFACTURE?new qy(this.servicesService,e.id,e.progress,e.status,e.working,e.recipe,e.level,e.storage):e.buildingType===Pv.WAREHOUSE?new ZE(this.servicesService,e.id,e.resource,void 0!==e.storage?e.storage:50,e.level):e.buildingType===Pv.MARKETPLACE?new Fy(this.servicesService,e.id,e.progress,e.level):e.buildingType===Pv.TAX_COLLECTOR?new kR(this.servicesService,e.id,e.working,e.status,e.progress,e.level):e.buildingType===Pv.BUILDERS_GUILD?new _R(this.servicesService,e.id,e.working,e.status,e.level):e.buildingType===Pv.TAVERN?new Ty(this.servicesService,e.id,e.progress,e.beer,e.wine,e.working,e.level):e.buildingType===Pv.SHRINE?new ty(this.servicesService,e.id,e.progress,e.level):e.buildingType===Pv.CHURCH?new Hy(this.servicesService,e.id,e.working,e.progress,e.level):e.buildingType===Pv.BARRACKS?new dy(this.servicesService,e.id,e.barracksSize,e.level):e.buildingType===Pv.EMBASSY?new Zy(this.servicesService,e.id,e.progress,e.working,e.country,e.paper,e.level):e.buildingType===Pv.TRAINING_SQUARE?new fy(this.servicesService,e.id,e.progress,e.working,e.status,e.level,void 0!==e.workSettings?e.workSettings:null):e.buildingType===Pv.STOCKADE?new py(this.servicesService,e.id,e.health,e.durability,e.progress,e.working,e.level):e.buildingType===Pv.WOODEN_TOWER?new yy(this.servicesService,e.id,e.health,e.durability,e.progress,e.working,e.level):e.buildingType===Pv.STONE_TOWER?new Ry(this.servicesService,e.id,e.health,e.durability,e.progress,e.working,e.level):e.buildingType===Pv.STASH?new Ky(this.servicesService,e.id,e.level):e.buildingType===Pv.LOGGERS_HUT?new xE(this.servicesService,e.id,e.progress,void 0!==e.reservedTrees?e.reservedTrees:0,e.status,e.working,e.level):e.buildingType===Pv.LOGGERS_CAMP?new hR(this.servicesService,e.id,e.progress,e.reservedTrees,e.status,e.workers,e.level):e.buildingType===Pv.GATHERER?new YE(this.servicesService,e.id,e.progress,e.status,e.working,e.mode,e.storage,e.level):e.buildingType===Pv.GATHERERS_CAMP?new nR(this.servicesService,e.id,e.progress,e.status,e.workers,e.mode,e.storage,e.level):e.buildingType===Pv.HUNTER_LODGE?new ey(this.servicesService,e.id,e.progress,e.status,e.mode,e.working,e.storage,e.storage2,e.animal,e.level):e.buildingType===Pv.TANNERY?new vy(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.PAPER_MILL?new $y(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.FORESTER?new UE(this.servicesService,e.id,e.progress,e.localStorage,e.status,e.effectiveness,e.working,e.level):e.buildingType===Pv.SAWMILL?new WE(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.FARM?new ny(this.servicesService,e.id,e.workers,e.maxWorkers,e.level,e.status,void 0!==e.workSettings?e.workSettings:null):e.buildingType===Pv.WINDMILL?new uy(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.BUTCHER?new wy(this.servicesService,e.id,e.status,e.progress,e.working,e.outputStorage,null!==e.outputFurStorage?e.outputFurStorage:0,e.animals,void 0===e.discardExcessFur||e.discardExcessFur,e.level):e.buildingType===Pv.COTTON_MILL?new my(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.BREWERY?new Ey(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.CLAY_PIT?new uR(this.servicesService,e.id,e.progress,e.status,e.working,e.storage,e.resources,e.level):e.buildingType===Pv.WINERY?new Oy(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.BARN?new rR(this.servicesService,e.id,e.crop,e.storage,e.level):e.buildingType===Pv.FIELD?new oy(this.servicesService,e.id,e.size,e.crop,e.status,e.progress,e.working,e.growth,e.level):e.buildingType===Pv.ORCHARD?new ay(this.servicesService,e.id,e.size,e.crop,e.status,e.progress,e.working,e.growth,e.level):e.buildingType===Pv.PASTURE?new Ny(this.servicesService,e.id,e.size,e.animal,e.progress,e.produceProgress,e.working,e.animals,e.food,e.chores,e.autoButcher,e.level):e.buildingType===Pv.QUARRY?new KE(this.servicesService,e.id,e.progress,e.status,e.working,e.storage,e.resources,e.level):e.buildingType===Pv.GEOLOGIST?new Iy(this.servicesService,e.id,e.progress,e.working,e.level):e.buildingType===Pv.STONEMASON?new by(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.MINT?new Py(this.servicesService,e.id,e.progress,e.status,e.inputStorage,e.outputStorage,e.working,e.workSettings,e.level):e.buildingType===Pv.SMITHY?new Uy(this.servicesService,e.id,e.level):e.buildingType===Pv.PIT_MINE?new Ay(this.servicesService,e.id,e.progress,e.status,e.working,e.storage,e.resources,e.ore,e.level):e.buildingType===Pv.METEORITE?new gR(this.servicesService,e.id,e.resources,e.ore,e.progress,e.status,e.storage,e.workers,e.level):e.buildingType===Pv.DEEP_MINE?new eR(this.servicesService,e.id,e.progress,e.status,e.storage,e.workers,e.resources,void 0!==e.oreToFind?e.oreToFind:0,e.ore,e.level):e.buildingType===Pv.STONEHENGE?new xy(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.PYRAMID?new Gy(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.HANGING_GARDEN?new By(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.COLOSSUS?new Wy(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.UNDERGROUND_CITY?new zy(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.GREAT_LIGHTHOUSE?new Yy(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.BOAT_BUILDER?new ER(this.servicesService,e.id,e.progress,e.status,e.working,e.ship,e.level):e.buildingType===Pv.SHIPYARD?new RR(this.servicesService,e.id,e.progress,e.status,e.workers,e.ship,e.level):e.buildingType===Pv.CARTOGRAPHER?new TR(this.servicesService,e.id,e.progress,e.status,e.working,e.level):e.buildingType===Pv.SACRED_GROVE?new jy(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.ASCENSION_TEMPLE?new Vy(this.servicesService,e.id,e.progress,e.maxProgress,e.stage,e.state,e.year,e.workers):e.buildingType===Pv.FISHERS_HUT?new hy(this.servicesService,e.id,e.progress,e.status,e.working,e.level):e.buildingType===Pv.PIER?new fR(this.servicesService,e.id,e.level):e.buildingType===Pv.HARBOUR?new vR(this.servicesService,e.id,e.level):e.buildingType===Pv.LIGHTHOUSE?new mR(this.servicesService,e.id,e.status,e.fuel,e.working,e.level):e.buildingType===Pv.CONSTRUCTION?new fE(this.servicesService,e.id,e.region,e.constructing,e.buildingComplexity,e.buildingSize,e.upgradeLevel,e.progress,e.working,void 0!==e.data?e.data:null):e.buildingType===Pv.DECONSTRUCTION?new Um(this.servicesService,e.id,e.region,e.deconstructing,e.buildingComplexity,e.buildingSize,e.progress,e.working):void console.error("Couldn't load building of type ["+e.buildingType+"]")}},{key:"createBuilding",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.idService.getNextId();return this.createBuildingShell(e,t).build()}},{key:"createBuildingShell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.idService.getNextId();switch(e){case Pv.HUT:return new SE(this.servicesService,t);case Pv.HOUSE:return new EE(this.servicesService,t);case Pv.LONGHOUSE:return new Xy(this.servicesService,t);case Pv.TUDOR_HOUSE:return new cR(this.servicesService,t);case Pv.SETTLEMENT:return new IR(this.servicesService,t);case Pv.BAKERY:return new cy(this.servicesService,t);case Pv.TAILOR:return new Sy(this.servicesService,t);case Pv.WORKSHOP:return new XE(this.servicesService,t);case Pv.SCHOLARS_LAB:return new CR(this.servicesService,t);case Pv.KITCHEN:return new sR(this.servicesService,t);case Pv.MANUFACTURE:return new qy(this.servicesService,t);case Pv.WAREHOUSE:return new ZE(this.servicesService,t);case Pv.MARKETPLACE:return new Fy(this.servicesService,t);case Pv.TAX_COLLECTOR:return new kR(this.servicesService,t);case Pv.BUILDERS_GUILD:return new _R(this.servicesService,t);case Pv.TAVERN:return new Ty(this.servicesService,t);case Pv.SHRINE:return new ty(this.servicesService,t);case Pv.CHURCH:return new Hy(this.servicesService,t);case Pv.BARRACKS:return new dy(this.servicesService,t);case Pv.EMBASSY:return new Zy(this.servicesService,t);case Pv.TRAINING_SQUARE:return new fy(this.servicesService,t);case Pv.STOCKADE:return new py(this.servicesService,t);case Pv.WOODEN_TOWER:return new yy(this.servicesService,t);case Pv.STONE_TOWER:return new Ry(this.servicesService,t);case Pv.STASH:return new Ky(this.servicesService,t);case Pv.LOGGERS_HUT:return new xE(this.servicesService,t);case Pv.LOGGERS_CAMP:return new hR(this.servicesService,t);case Pv.GATHERER:return new YE(this.servicesService,t);case Pv.GATHERERS_CAMP:return new nR(this.servicesService,t);case Pv.HUNTER_LODGE:return new ey(this.servicesService,t);case Pv.TANNERY:return new vy(this.servicesService,t);case Pv.PAPER_MILL:return new $y(this.servicesService,t);case Pv.FORESTER:return new UE(this.servicesService,t);case Pv.SAWMILL:return new WE(this.servicesService,t);case Pv.FARM:return new ny(this.servicesService,t);case Pv.WINDMILL:return new uy(this.servicesService,t);case Pv.BUTCHER:return new wy(this.servicesService,t);case Pv.COTTON_MILL:return new my(this.servicesService,t);case Pv.BREWERY:return new Ey(this.servicesService,t);case Pv.WINERY:return new Oy(this.servicesService,t);case Pv.CLAY_PIT:return new uR(this.servicesService,t);case Pv.BARN:return new rR(this.servicesService,t);case Pv.FIELD:return new oy(this.servicesService,t);case Pv.ORCHARD:return new ay(this.servicesService,t);case Pv.PASTURE:return new Ny(this.servicesService,t);case Pv.QUARRY:return new KE(this.servicesService,t);case Pv.GEOLOGIST:return new Iy(this.servicesService,t);case Pv.STONEMASON:return new by(this.servicesService,t);case Pv.MINT:return new Py(this.servicesService,t);case Pv.SMITHY:return new Uy(this.servicesService,t);case Pv.PIT_MINE:return new Ay(this.servicesService,t);case Pv.METEORITE:return new gR(this.servicesService,t);case Pv.DEEP_MINE:return new eR(this.servicesService,t);case Pv.STONEHENGE:return new xy(this.servicesService,t);case Pv.PYRAMID:return new Gy(this.servicesService,t);case Pv.HANGING_GARDEN:return new By(this.servicesService,t);case Pv.COLOSSUS:return new Wy(this.servicesService,t);case Pv.UNDERGROUND_CITY:return new zy(this.servicesService,t);case Pv.GREAT_LIGHTHOUSE:return new Yy(this.servicesService,t);case Pv.SACRED_GROVE:return new jy(this.servicesService,t);case Pv.ASCENSION_TEMPLE:return new Vy(this.servicesService,t);case Pv.FISHERS_HUT:return new hy(this.servicesService,t);case Pv.PIER:return new fR(this.servicesService,t);case Pv.HARBOUR:return new vR(this.servicesService,t);case Pv.LIGHTHOUSE:return new mR(this.servicesService,t);case Pv.BOAT_BUILDER:return new ER(this.servicesService,t);case Pv.SHIPYARD:return new RR(this.servicesService,t);case Pv.CARTOGRAPHER:return new TR(this.servicesService,t);case Pv.CONSTRUCTION:console.error("Building factory cannot create construction sites!");break;case Pv.DECONSTRUCTION:console.error("Building factory cannot create deconstruction sites!");break;default:console.error("Couldn't construct building of type ["+Pv[e]+"]!")}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(wR))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),MR=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){return p(this,i),t.call(this,n,e,r,s,o,Yv.VILLAGE,Zv.VILLAGE)}return S(i,[{key:"init",value:function(){var e=this;this.buildings.push(new SE(this.servicesService,this.idService.getNextId(),2,0,100,100,100).build()),this.buildings.push(new SE(this.servicesService,this.idService.getNextId(),1,0,100,100,100).build()),this.resourcesService.createPeople(3),this.buildings.forEach(function(t){return e.landService.takeLand(t.getSize())})}},{key:"getPopulation",value:function(){return this.resourcesService.getTotalPeople()}},{key:"getPopulationCap",value:function(){return this.resourcesService.getPopulationCap()}},{key:"moveOccupants",value:function(e,t,i,n,r){for(var o=t,s=0,a=this.buildings.filter(function(t){return t!==e&&void 0!==t.getOccupants&&t.getOccupants()<t.getMaxSize()}).sort(function(e,t){return e.isWorking()&&!t.isWorking()?-1:t.isWorking()&&!e.isWorking()?1:t.getMaxSize()!==e.getMaxSize()?t.getMaxSize()-e.getMaxSize():0});t>0&&s<a.length;){for(var u=a[s];u.getOccupants()<u.getMaxSize()&&t>0;)u.addOccupant()&&(u.isWorking()||u.startProduction(),u.addFood(i/o),u.addFuel(n/o),u.addClothes(r/o),t-=1);s+=1}return t}},{key:"removeRecruit",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.buildings.filter(function(e){return void 0!==e.getOccupants}).map(function(e){return e}).sort(function(e,t){return e.getOccupants()===e.getMaxSize()&&t.getOccupants()===t.getMaxSize()?e.getMaxSize()>t.getMaxSize()?-1:1:e.getOccupants()===e.getMaxSize()&&t.getOccupants()<t.getMaxSize()?-1:e.getOccupants()<e.getMaxSize()&&t.getOccupants()===t.getMaxSize()?1:void 0}),r=0;if(i.forEach(function(e){return r+=e.getOccupants()}),r>=e){for(;e>0;){var o,s=n(i);try{for(s.s();!(o=s.n()).done;){var a=o.value;if(!(e>0))return!0;a.removeOccupant()&&(t&&this.resourcesService.removePeople(1),e-=1)}}catch(u){s.e(u)}finally{s.f()}}if(0===e)return!0}return!1}},{key:"replaceWithHouses",value:function(){var e=this;this.buildings.push(new EE(this.servicesService,this.idService.getNextId(),0,0,100,100,200).build()),this.landService.takeLand(um.VILLAGE.HOUSE.SIZE),this.buildings.filter(function(e){return e.getBuildingType()===Pv.HUT}).forEach(function(t){t.prepareDemolish(),e.demolish(t)}),this.buildings.filter(function(e){return e.getBuildingType()===Pv.DECONSTRUCTION}).forEach(function(t){return e.finishDeconstruction(t)})}},{key:"getHousingBuildings",value:function(){return this.buildings.filter(function(e){return e.getBuildingType()===Pv.HUT||e.getBuildingType()===Pv.HOUSE||e.getBuildingType()===Pv.LONGHOUSE||e.getBuildingType()===Pv.TUDOR_HOUSE||e.getBuildingType()===Pv.SETTLEMENT})}},{key:"addVillagers",value:function(e){for(var t=this,i=this.getHousingBuildings().map(function(e){return e}).filter(function(e){return e.isWorking()}).filter(function(e){return e.getOccupants()<e.getMaxSize()}),n=e;n>0&&i.length>0;)i.forEach(function(e){e.addOccupant()&&(t.resourcesService.createPeople(1),n-=1)}),i=i.filter(function(e){return e.getOccupants()<e.getMaxSize()})}}]),i}(vE);return e.\u0275fac=function(t){return new(t||e)(An(DE),An(PR),An($v),An(wR),An(wm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),DR=function(){var e=function(){function e(t,i,n){p(this,e),this.servicesService=t,this.optionsService=i,this.gameService=n,this.rations=2,this.clothes=1,this.alcohol=1,this.tax=0,this.logFiredWorkers=Up,this.logAutoTrade=Hp,this.logSickness=Gp,this.logMerchant=true,this.furClothes=true,this.foodNutrition=true,this.complexWorkers=Bp,this.secondHeaderRow=Wp,this.showFreeWorkers=Vp,this.showPopulation=zp,this.showResearchProgress=Yp,this.showHappiness=Kp,this.showFaith=jp,this.showRaw=Qp,this.showProcessed=qp,this.showFood=Xp,this.showTools=Zp,this.defaultWorkshopResearch=$p,this.defaultGathererFood=Jp,this.switchHunterFromTaming=$p,this.plowInSummer=em,t.addService(Zv.MANAGEMENT,this),this.initFoodPriority()}return S(e,[{key:"initFoodPriority",value:function(){var e=this;return this.foodPriority=[[]],this.servicesService.getResourcesService().getResourcesByType(Hv.CONSUMABLE).forEach(function(t){return e.foodPriority[0].push(t.resource)}),this.foodPriority}},{key:"getName",value:function(){return"ManagementService"}},{key:"load",value:function(e){this.rations=e.rations,this.clothes=e.clothes,this.alcohol=e.alcohol,this.tax=void 0!==e.tax?e.tax:0,this.furClothes=e.furClothes,this.foodNutrition=e.foodNutrition,this.showRaw=void 0!==e.showRaw?e.showRaw:Qp,this.showProcessed=void 0!==e.showProcessed?e.showProcessed:qp,this.showFood=void 0!==e.showFood?e.showFood:Xp,this.showTools=void 0!==e.showTools?e.showTools:Zp,this.complexWorkers=e.complexWorkers,this.logFiredWorkers=void 0!==e.logFiredWorkers?e.logFiredWorkers:Up,this.logAutoTrade=void 0!==e.logAutoTrade?e.logAutoTrade:Hp,this.logSickness=void 0!==e.logSickness?e.logSickness:Gp,this.logMerchant=void 0===e.logMerchant||e.logMerchant,this.secondHeaderRow=void 0!==e.secondHeaderRow?e.secondHeaderRow:Wp,this.showFreeWorkers=void 0!==e.showFreeWorkers?e.showFreeWorkers:Vp,this.showPopulation=void 0!==e.showPopulation?e.showPopulation:zp,this.foodPriority=void 0!==e.foodPriority?e.foodPriority:this.initFoodPriority(),this.showResearchProgress=void 0!==e.showResearchProgress?e.showResearchProgress:Yp,this.showFaith=void 0!==e.showFaith?e.showFaith:jp,this.showHappiness=void 0!==e.showHappiness?e.showHappiness:Kp,this.defaultWorkshopResearch=void 0!==e.defaultWorkshopResearch?e.defaultWorkshopResearch:$p,this.defaultGathererFood=void 0!==e.defaultGathererFood?e.defaultGathererFood:Jp,this.switchHunterFromTaming=void 0===e.switchHunterFromTaming||e.switchHunterFromTaming,this.plowInSummer=void 0!==e.plowInSummer?e.plowInSummer:em,this.validateFoodPriority(),this.gameService.updateHeader(this.secondHeaderRow)}},{key:"save",value:function(){return{rations:this.rations,clothes:this.clothes,alcohol:this.alcohol,tax:this.tax,furClothes:this.furClothes,foodNutrition:this.foodNutrition,showRaw:this.showRaw,showProcessed:this.showProcessed,showFood:this.showFood,showTools:this.showTools,complexWorkers:this.complexWorkers,logFiredWorkers:this.logFiredWorkers,logAutoTrade:this.logAutoTrade,logSickness:this.logSickness,logMerchant:this.logMerchant,secondHeaderRow:this.secondHeaderRow,showFreeWorkers:this.showFreeWorkers,showPopulation:this.showPopulation,foodPriority:this.foodPriority,showResearchProgress:this.showResearchProgress,showFaith:this.showFaith,showHappiness:this.showHappiness,defaultWorkshopResearch:this.defaultWorkshopResearch,defaultGathererFood:this.defaultGathererFood,switchHunterFromTaming:this.switchHunterFromTaming,plowInSummer:this.plowInSummer}}},{key:"reset",value:function(e,t){!this.optionsService.getOption(Xv.KEEP_MANAGEMENT_SETTINGS_ON_RESET)||e?(this.rations=2,this.clothes=1,this.alcohol=1,this.tax=0,this.furClothes=true,this.foodNutrition=true,this.showRaw=Qp,this.showProcessed=qp,this.showFood=Xp,this.showTools=Zp,this.complexWorkers=Bp,this.logFiredWorkers=Up,this.logAutoTrade=Hp,this.logSickness=Gp,this.secondHeaderRow=Wp,this.showFreeWorkers=Vp,this.showPopulation=zp,this.showResearchProgress=Yp,this.showFaith=jp,this.showHappiness=Kp,this.defaultWorkshopResearch=$p,this.defaultGathererFood=Jp,this.switchHunterFromTaming=true,this.plowInSummer=em,this.initFoodPriority()):(this.complexWorkers=Bp,this.validateFoodPriority()),e&&(this.complexWorkers=Bp,this.initFoodPriority()),this.gameService.updateHeader(this.secondHeaderRow)}},{key:"getRations",value:function(){return this.rations}},{key:"getClothesRations",value:function(){return this.clothes}},{key:"getAlcoholRations",value:function(){return this.alcohol}},{key:"setRations",value:function(e){this.rations=e}},{key:"setClothesRations",value:function(e){this.clothes=e}},{key:"setAlcoholRations",value:function(e){this.alcohol=e}},{key:"getTaxRate",value:function(){return this.tax}},{key:"setTaxRate",value:function(e){this.tax=e}},{key:"toggleFurClothes",value:function(){this.furClothes=!this.furClothes}},{key:"getFurClothes",value:function(){return this.furClothes}},{key:"toggleFoodNutrition",value:function(){this.foodNutrition=!this.foodNutrition}},{key:"getFoodNutrition",value:function(){return this.foodNutrition}},{key:"toggleComplexWorkers",value:function(){this.complexWorkers=!this.complexWorkers}},{key:"getComplexWorkers",value:function(){return this.complexWorkers}},{key:"getSecondHeaderRow",value:function(){return this.secondHeaderRow}},{key:"toggleSecondHeaderRow",value:function(){this.secondHeaderRow=!this.secondHeaderRow,this.gameService.updateHeader(this.secondHeaderRow)}},{key:"getShowFreeWorkers",value:function(){return this.showFreeWorkers}},{key:"toggleShowFreeWorkers",value:function(){this.showFreeWorkers=!this.showFreeWorkers}},{key:"getShowPopulation",value:function(){return this.showPopulation}},{key:"toggleShowPopulation",value:function(){this.showPopulation=!this.showPopulation}},{key:"getShowResearchProgress",value:function(){return this.showResearchProgress}},{key:"toggleShowResearchProgress",value:function(){this.showResearchProgress=!this.showResearchProgress}},{key:"getFoodPriority",value:function(){if(this.gameService.isEnabled(wv.MANAGEMENT))return this.foodPriority;var e=[[]];return this.servicesService.getResourcesService().getResourcesByType(Hv.CONSUMABLE).forEach(function(t){return e[0].push(t.resource)}),e}},{key:"up",value:function(e,t){var i=this.foodPriority[t].findIndex(function(t){return t===e});t>0?(i>=0&&(this.foodPriority[t-1].push(this.foodPriority[t][i]),this.foodPriority[t].splice(i,1)),this.clearList(this.foodPriority)):(this.foodPriority.unshift([]),this.foodPriority[0].push(this.foodPriority[1][i]),this.foodPriority[1].splice(i,1))}},{key:"down",value:function(e,t){var i=this.foodPriority[t].findIndex(function(t){return t===e});i>=0&&t+1<9&&(this.foodPriority.length<t+2&&this.foodPriority.push([]),this.foodPriority[t+1].push(this.foodPriority[t][i]),this.foodPriority[t].splice(i,1)),this.clearList(this.foodPriority)}},{key:"clearList",value:function(e){for(;e.length>0&&0===e[e.length-1].length;)e.splice(e.length-1,1);for(;e.length>0&&0===e[0].length;)e.splice(0,1)}},{key:"validateFoodPriority",value:function(){var e=this,t=[];this.foodPriority.forEach(function(e){return e.forEach(function(e){return t.push(e)})}),cm.getResourcesByType(Hv.CONSUMABLE).forEach(function(i){t.find(function(e){return e===Mv[i[0]]})||e.foodPriority[0].push(Mv[i[0]])})}},{key:"getShowFaith",value:function(){return this.showFaith}},{key:"toggleShowFaith",value:function(){this.showFaith=!this.showFaith}},{key:"getShowHappiness",value:function(){return this.showHappiness}},{key:"toggleShowHappiness",value:function(){this.showHappiness=!this.showHappiness}},{key:"getLogFiredWorkers",value:function(){return this.logFiredWorkers}},{key:"toggleLogFiredWorkers",value:function(){this.logFiredWorkers=!this.logFiredWorkers}},{key:"getDefaultWorkshopResearch",value:function(){return this.defaultWorkshopResearch}},{key:"toggleDefaultWorkshopResearch",value:function(){this.defaultWorkshopResearch=!this.defaultWorkshopResearch}},{key:"getDefaultGathererFood",value:function(){return this.defaultGathererFood}},{key:"toggleDefaultGathererFood",value:function(){this.defaultGathererFood=!this.defaultGathererFood}},{key:"getSwitchHunterFromTaming",value:function(){return this.switchHunterFromTaming}},{key:"toggleSwitchHunterFromTaming",value:function(){this.switchHunterFromTaming=!this.switchHunterFromTaming}},{key:"getPlowInSummer",value:function(){return this.plowInSummer}},{key:"togglePlowInSummer",value:function(){this.plowInSummer=!this.plowInSummer}},{key:"getLogAutoTrade",value:function(){return this.logAutoTrade}},{key:"toggleLogAutoTrade",value:function(){this.logAutoTrade=!this.logAutoTrade}},{key:"getShowRaw",value:function(){return this.showRaw}},{key:"toggleShowRaw",value:function(){this.showRaw=!this.showRaw}},{key:"getShowProcessed",value:function(){return this.showProcessed}},{key:"toggleShowProcessed",value:function(){this.showProcessed=!this.showProcessed}},{key:"getShowFood",value:function(){return this.showFood}},{key:"toggleShowFood",value:function(){this.showFood=!this.showFood}},{key:"getShowTools",value:function(){return this.showTools}},{key:"toggleShowTools",value:function(){this.showTools=!this.showTools}},{key:"getLogSickness",value:function(){return this.logSickness}},{key:"toggleLogSickness",value:function(){this.logSickness=!this.logSickness}},{key:"getLogMerchant",value:function(){return this.logMerchant}},{key:"toggleLogMerchant",value:function(){this.logMerchant=!this.logMerchant}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Om),An(_m))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function LR(e,t){1&e&&(zs(0,"a",8),ha(1,"Fort"),Ys())}function xR(e,t){1&e&&(zs(0,"a",9),ha(1,"Field"),Ys())}function FR(e,t){1&e&&(zs(0,"a",10),ha(1,"Mountains"),Ys())}function UR(e,t){1&e&&(zs(0,"a",11),ha(1,"Plateau"),Ys())}function HR(e,t){1&e&&(zs(0,"a",12),ha(1,"Sea"),Ys())}var GR=function(){var e=function(){function e(t,i){p(this,e),this.gameService=t,this.resourcesService=i}return S(e,[{key:"ngOnInit",value:function(){}},{key:"isFortEnabled",value:function(){return this.gameService.isEnabled(wv.FORT)}},{key:"isFieldEnabled",value:function(){return this.gameService.isEnabled(wv.FIELD)}},{key:"isSeaEnabled",value:function(){return this.gameService.isEnabled(wv.SEA)}},{key:"isMountainsEnabled",value:function(){return this.gameService.isEnabled(wv.MOUNTAINS)}},{key:"isPlateauEnabled",value:function(){return this.gameService.isEnabled(wv.PLATEAU)}},{key:"getVillageStageName",value:function(){var e=this,t="Village";return am.forEach(function(i){e.resourcesService.getPopulationCap()>=i.population&&(t=i.name)}),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_m),Bs(DE))},e.\u0275cmp=it({type:e,selectors:[["app-top-menu"]],decls:10,vars:6,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","routerLink","/regions/village","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/fort","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/regions/forest","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/field","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/mountains","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/plateau","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/sea","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/regions/fort","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/field","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/mountains","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/plateau","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/sea","routerLinkActive","active",1,"entry"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"a",1),ha(2),Ys(),Gs(3,LR,2,0,"a",2),zs(4,"a",3),ha(5,"Forest"),Ys(),Gs(6,xR,2,0,"a",4),Gs(7,FR,2,0,"a",5),Gs(8,UR,2,0,"a",6),Gs(9,HR,2,0,"a",7),Ys()),2&e&&(ho(2),da(t.getVillageStageName()),ho(1),Ws("ngIf",t.isFortEnabled()),ho(3),Ws("ngIf",t.isFieldEnabled()),ho(1),Ws("ngIf",t.isMountainsEnabled()),ho(1),Ws("ngIf",t.isPlateauEnabled()),ho(1),Ws("ngIf",t.isSeaEnabled()))},directives:[uv,lv,Gl],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:row}.entry[_ngcontent-%COMP%]{flex:auto;display:flex;justify-content:center;flex-direction:column;height:100%;text-align:center;border-right:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1.1em}.entry[_ngcontent-%COMP%]:last-of-type{border:none}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour)}"]}),e}();function BR(e,t){return new M(function(i){var n=e.length;if(0!==n)for(var r=new Array(n),o=0,s=0,a=function(a){var u=X(e[a]),c=!1;i.add(u.subscribe({next:function(e){c||(c=!0,s++),r[a]=e},error:function(e){return i.error(e)},complete:function(){(++o===n||!c)&&(s===n&&i.next(t?t.reduce(function(e,t,i){return e[t]=r[i],e},{}):r),i.complete())}}))},u=0;u<n;u++)a(u);else i.complete()})}var WR=function(){var e=function(){function e(t,i){p(this,e),this._renderer=t,this._elementRef=i,this.onChange=function(e){},this.onTouched=function(){}}return S(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ba),Bs(Ua))},e.\u0275dir=ut({type:e}),e}(),VR=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return i}(WR);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,features:[bs]}),t}(),zR=new an("NgValueAccessor"),YR={provide:zR,useExisting:Se(function(){return jR}),multi:!0},jR=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"writeValue",value:function(e){this.setProperty("checked",e)}}]),i}(VR);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&$s("change",function(e){return t.onChange(e.target.checked)})("blur",function(){return t.onTouched()})},features:[Pa([YR]),bs]}),t}(),KR={provide:zR,useExisting:Se(function(){return qR}),multi:!0},QR=new an("CompositionEventMode"),qR=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,e,n))._compositionMode=r,o._composing=!1,null==o._compositionMode&&(o._compositionMode=!function(){var e=ul()?ul().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),o}return S(i,[{key:"writeValue",value:function(e){this.setProperty("value",null==e?"":e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),i}(WR);return e.\u0275fac=function(t){return new(t||e)(Bs(Ba),Bs(Ua),Bs(QR,8))},e.\u0275dir=ut({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&$s("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[Pa([KR]),bs]}),e}();function XR(e){return null==e||0===e.length}var ZR=new an("NgValidators"),$R=new an("NgAsyncValidators");function JR(e){return null}function eO(e){return null!=e}function tO(e){var t=Xs(e)?X(e):e;return Zs(t),t}function iO(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function nO(e,t){return t.map(function(t){return t(e)})}function rO(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function oO(e){return null!=e?function(e){if(!e)return null;var t=e.filter(eO);return 0==t.length?null:function(e){return iO(nO(e,t))}}(rO(e)):null}function sO(e){return null!=e?function(e){if(!e)return null;var t=e.filter(eO);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){var r=t[0];if(O(r))return BR(r,null);if(T(r)&&Object.getPrototypeOf(r)===Object.prototype){var o=Object.keys(r);return BR(o.map(function(e){return r[e]}),o)}}if("function"==typeof t[t.length-1]){var s=t.pop();return BR(t=1===t.length&&O(t[0])?t[0]:t,null).pipe(B(function(e){return s.apply(void 0,i(e))}))}return BR(t,null)}(nO(e,t).map(tO)).pipe(B(iO))}}(rO(e)):null}function aO(e,t){return null===e?[t]:Array.isArray(e)?[].concat(i(e),[t]):[e,t]}function uO(e){return e?Array.isArray(e)?e:[e]:[]}function cO(e,t){return Array.isArray(e)?e.includes(t):e===t}function lO(e,t){var i=uO(t);return uO(e).forEach(function(e){cO(i,e)||i.push(e)}),i}function hO(e,t){return uO(t).filter(function(t){return!cO(e,t)})}var dO=function(){var e=function(){function e(){p(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return S(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=oO(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=sO(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=ut({type:e}),e}(),gO=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),i}(dO);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,features:[bs]}),t}(),fO=function(e){c(i,e);var t=h(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return i}(dO),vO=function(){var e=function(e){c(i,e);var t=h(i);function i(e){return p(this,i),t.call(this,e)}return i}(function(){function e(t){p(this,e),this._cd=t}return S(e,[{key:"is",value:function(e){var t,i,n;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(n=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===n?void 0:n[e])}}]),e}());return e.\u0275fac=function(t){return new(t||e)(Bs(fO,2))},e.\u0275dir=ut({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&sa("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[bs]}),e}();function pO(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function mO(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function SO(e,t){var i=e.indexOf(t);i>-1&&e.splice(i,1)}var EO="VALID",yO="INVALID",RO="PENDING",OO="DISABLED";function TO(e){return(AO(e)?e.validators:e)||null}function IO(e){return Array.isArray(e)?oO(e):e||null}function bO(e,t){return(AO(t)?t.asyncValidators:e)||null}function CO(e){return Array.isArray(e)?sO(e):e||null}function AO(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var kO=function(){function e(t,i){p(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=i,this._composedValidatorFn=IO(this._rawValidators),this._composedAsyncValidatorFn=CO(this._rawAsyncValidators)}return S(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===EO}},{key:"invalid",get:function(){return this.status===yO}},{key:"pending",get:function(){return this.status==RO}},{key:"disabled",get:function(){return this.status===OO}},{key:"enabled",get:function(){return this.status!==OO}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=IO(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=CO(e)}},{key:"addValidators",value:function(e){this.setValidators(lO(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(lO(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(hO(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(hO(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return cO(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return cO(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=RO,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=OO,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=EO,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===EO||this.status===RO)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?OO:EO}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=RO,this._hasOwnPendingAsyncValidator=!0;var i=tO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(function(i){t._hasOwnPendingAsyncValidator=!1,t.setErrors(i,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,i){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var n=e;return t.forEach(function(e){n=n instanceof _O?n.controls.hasOwnProperty(e)?n.controls[e]:null:n instanceof wO&&n.at(e)||null}),n}(this,e)}},{key:"getError",value:function(e,t){var i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new Yu,this.statusChanges=new Yu}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?OO:this.errors?yO:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(RO)?RO:this._anyControlsHaveStatus(yO)?yO:EO}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){AO(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),NO=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return p(this,i),(e=t.call(this,TO(r),bO(o,r)))._onChange=[],e._applyFormState(n),e._setUpdateStrategy(r),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return S(i,[{key:"setValue",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==i.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==i.emitViewToModelChange)}),this.updateValueAndValidity(i)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){SO(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){SO(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),i}(kO),_O=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,TO(n),bO(r,n))).controls=e,o._initObservables(),o._setUpdateStrategy(n),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!!o.asyncValidator}),o}return S(i,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(n){t._throwIfControlMissing(n),t.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}},{key:"patchValue",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(n){t.controls[n]&&t.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(i,n){i.reset(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,i){return e[i]=t instanceof NO?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(i){var n=t.controls[i];n&&e(n,i)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,i=Object.keys(this.controls);t<i.length;t++){var n=i[t],r=this.controls[n];if(this.contains(n)&&e(r))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,i,n){return(i.enabled||e.disabled)&&(t[n]=i.value),t})}},{key:"_reduceChildren",value:function(e,t){var i=e;return this._forEachChild(function(e,n){i=t(i,e,n)}),i}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var i=t[e];if(this.controls[i].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,i){if(void 0===e[i])throw new Error("Must supply a value for form control with name: '".concat(i,"'."))})}}]),i}(kO),wO=function(e){c(i,e);var t=h(i);function i(e,n,r){var o;return p(this,i),(o=t.call(this,TO(n),bO(r,n))).controls=e,o._initObservables(),o._setUpdateStrategy(n),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!!o.asyncValidator}),o}return S(i,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,n){t._throwIfControlMissing(n),t.at(n).setValue(e,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}},{key:"patchValue",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,n){t.at(n)&&t.at(n).patchValue(e,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(i,n){i.reset(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof NO?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,i){e(t,i)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,i){if(void 0===e[i])throw new Error("Must supply a value for form control at index: ".concat(i,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=n(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(i){t.e(i)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),i}(kO),PO={provide:fO,useExisting:Se(function(){return DO})},MO=Promise.resolve(null),DO=function(){var e=function(e){c(n,e);var t=h(n);function n(e,i,r,o){var s;return p(this,n),(s=t.call(this)).control=new NO,s._registered=!1,s.update=new Yu,s._parent=e,s._setValidators(i),s._setAsyncValidators(r),s.valueAccessor=function(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===qR?i=e:function(e){return Object.getPrototypeOf(e.constructor)===VR}(e)?n=e:r=e}),r||n||i||null):null;var i,n,r}(0,o),s}return S(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;var i=e.model;return!!i.isFirstChange()||!Object.is(t,i.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?function(e,t){return[].concat(i(t.path),[e])}(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){(function(e,t){(function(e,t){var i=function(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(aO(i,t.validator)):"function"==typeof i&&e.setValidators([i]);var n=function(e){return e._rawAsyncValidators}(e);null!==t.asyncValidator?e.setAsyncValidators(aO(n,t.asyncValidator)):"function"==typeof n&&e.setAsyncValidators([n]);var r=function(){return e.updateValueAndValidity()};pO(t._rawValidators,r),pO(t._rawAsyncValidators,r)})(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(i){e._pendingValue=i,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&mO(e,t)})}(e,t),function(e,t){var i=function(e,i){t.valueAccessor.writeValue(e),i&&t.viewToModelUpdate(e)};e.registerOnChange(i),t._registerOnDestroy(function(){e._unregisterOnChange(i)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&mO(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var i=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(i),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(i)})}}(e,t)})(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;MO.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,i=e.isDisabled.currentValue,n=""===i||i&&"false"!==i;MO.then(function(){n&&!t.control.disabled?t.control.disable():!n&&t.control.disabled&&t.control.enable()})}}]),n}(fO);return e.\u0275fac=function(t){return new(t||e)(Bs(gO,9),Bs(ZR,10),Bs($R,10),Bs(zR,10))},e.\u0275dir=ut({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Pa([PO]),bs,Rt]}),e}(),LO={provide:zR,useExisting:Se(function(){return xO}),multi:!0},xO=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"writeValue",value:function(e){this.setProperty("value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),i}(VR);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&$s("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[Pa([LO]),bs]}),t}(),FO={provide:zR,useExisting:Se(function(){return GO}),multi:!0},UO=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({}),e}(),HO=function(){var e=function(){function e(){p(this,e),this._accessors=[]}return S(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach(function(i){t._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({factory:function(){return new e},token:e,providedIn:UO}),e}(),GO=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o){var s;return p(this,i),(s=t.call(this,e,n))._registry=r,s._injector=o,s.onChange=function(){},s}return S(i,[{key:"ngOnInit",value:function(){this._control=this._injector.get(fO),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(e){this._state=e===this.value,this.setProperty("checked",this._state)}},{key:"registerOnChange",value:function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}}},{key:"fireUncheck",value:function(e){this.writeValue(e)}},{key:"_checkName",value:function(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}]),i}(VR);return e.\u0275fac=function(t){return new(t||e)(Bs(Ba),Bs(Ua),Bs(HO),Bs(Ts))},e.\u0275dir=ut({type:e,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&$s("change",function(){return t.onChange()})("blur",function(){return t.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Pa([FO]),bs]}),e}(),BO={provide:zR,useExisting:Se(function(){return WO}),multi:!0},WO=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),i}(VR);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&$s("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[Pa([BO]),bs]}),t}(),VO={provide:zR,useExisting:Se(function(){return YO}),multi:!0};function zO(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var YO=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return S(i,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var i=zO(t,e);this.setProperty("value",i)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(i){t.value=t._getOptionValue(i),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,i=Array.from(this._optionMap.keys());t<i.length;t++){var n=i[t];if(this._compareWith(this._optionMap.get(n),e))return n}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),i}(VR);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&$s("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Pa([VO]),bs]}),t}(),jO=function(){var e=function(){function e(t,i,n){p(this,e),this._element=t,this._renderer=i,this._select=n,this._select&&(this.id=this._select._registerOption())}return S(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(zO(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ua),Bs(Ba),Bs(YO,9))},e.\u0275dir=ut({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),KO={provide:zR,useExisting:Se(function(){return qO}),multi:!0};function QO(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var qO=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return S(i,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,i=this;if(this.value=e,Array.isArray(e)){var n=e.map(function(e){return i._getOptionId(e)});t=function(e,t){e._setSelected(n.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(i){var n=[];if(void 0!==i.selectedOptions)for(var r=i.selectedOptions,o=0;o<r.length;o++){var s=r.item(o),a=t._getOptionValue(s.value);n.push(a)}else for(var u=i.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);n.push(h)}}t.value=n,e(n)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,i=Array.from(this._optionMap.keys());t<i.length;t++){var n=i[t];if(this._compareWith(this._optionMap.get(n)._value,e))return n}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),i}(VR);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&$s("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Pa([KO]),bs]}),t}(),XO=function(){var e=function(){function e(t,i,n){p(this,e),this._element=t,this._renderer=i,this._select=n,this._select&&(this.id=this._select._registerOption(this))}return S(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(QO(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(QO(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ua),Bs(Ba),Bs(qO,9))},e.\u0275dir=ut({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),ZO=function(){var e=function(){function e(){p(this,e),this._validator=JR}return S(e,[{key:"handleChanges",value:function(e){if(this.inputName in e){var t=this.normalizeInput(e[this.inputName].currentValue);this._validator=this.createValidator(t),this._onChange&&this._onChange()}}},{key:"validate",value:function(e){return this._validator(e)}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=ut({type:e}),e}(),$O={provide:ZR,useExisting:Se(function(){return JO}),multi:!0},JO=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).inputName="max",e.normalizeInput=function(e){return parseFloat(e)},e.createValidator=function(e){return function(e){return function(t){if(XR(t.value)||XR(e))return null;var i=parseFloat(t.value);return!isNaN(i)&&i>e?{max:{max:e,actual:t.value}}:null}}(e)},e}return S(i,[{key:"ngOnChanges",value:function(e){this.handleChanges(e)}}]),i}(ZO);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,t){var i;2&e&&Us("max",null!==(i=t.max)&&void 0!==i?i:null)},inputs:{max:"max"},features:[Pa([$O]),bs,Rt]}),t}(),eT={provide:ZR,useExisting:Se(function(){return tT}),multi:!0},tT=function(){var e,t=function(e){c(i,e);var t=h(i);function i(){var e;return p(this,i),(e=t.apply(this,arguments)).inputName="min",e.normalizeInput=function(e){return parseFloat(e)},e.createValidator=function(e){return function(e){return function(t){if(XR(t.value)||XR(e))return null;var i=parseFloat(t.value);return!isNaN(i)&&i<e?{min:{min:e,actual:t.value}}:null}}(e)},e}return S(i,[{key:"ngOnChanges",value:function(e){this.handleChanges(e)}}]),i}(ZO);return t.\u0275fac=function(i){return(e||(e=tn(t)))(i||t)},t.\u0275dir=ut({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,t){var i;2&e&&Us("min",null!==(i=t.min)&&void 0!==i?i:null)},inputs:{min:"min"},features:[Pa([eT]),bs,Rt]}),t}(),iT=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({imports:[[UO]]}),e}(),nT=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({imports:[iT]}),e}(),rT=function(e){return{margin:e}},oT=function(){var e=function(){function e(){p(this,e),this.margin="0"}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getTitle",value:function(){return""===this.title?"":this.title?this.title:"Food"===this.name?"Food nutrition":Qv.titleCase(this.name).replace("_"," ")}},{key:"getPath",value:function(){var e="assets/";return this.path&&(e+=this.path+"/"),e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=it({type:e,selectors:[["app-icon"]],inputs:{name:"name",path:"path",title:"title",margin:"margin"},decls:2,vars:6,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","onerror","if (this.src !== 'assets/question_mark.svg') this.src = 'assets/question_mark.svg';",1,"resourceIcon",3,"ngStyle","src","title","alt"]],template:function(e,t){1&e&&(zs(0,"div",0),js(1,"img",1),Ys()),2&e&&(ho(1),na("src","",t.getPath()+t.name.replace(" ","_").toLowerCase(),".svg",gr),ia("title",t.getTitle()),ia("alt",t.name),Ws("ngStyle",Du(4,rT,t.margin)))},directives:[jl],styles:["[_nghost-%COMP%]{display:inline-block;vertical-align:middle;height:24px}#wrapper[_ngcontent-%COMP%]{display:inline-block;height:24px;margin:0;padding:0}img[_ngcontent-%COMP%]{display:inline-block;margin:0;padding:0;height:24px;width:24px}"]}),e}(),sT=function(){var e=function(){function e(){p(this,e),this.xMargin=20,this.yMargin=20}return S(e,[{key:"onmousemove",value:function(e){var t=document.getElementById(this.elementId);if(t){var i=e.clientX+this.xMargin,n=e.clientY+this.yMargin;n+t.offsetHeight>740&&(n-=t.offsetHeight+2*this.yMargin),t.style.top=n+"px",t.style.left=i+"px"}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=ut({type:e,selectors:[["","appTooltip",""]],hostBindings:function(e,t){1&e&&$s("mousemove",function(e){return t.onmousemove(e)})},inputs:{elementId:"elementId"}}),e}();function aT(e,t){1&e&&js(0,"app-icon",9),2&e&&Ws("name","angry")("path","happiness")("title","")("margin","0 0 0 4px")}function uT(e,t){1&e&&js(0,"app-icon",9),2&e&&Ws("name","sad")("path","happiness")("title","")("margin","0 0 0 4px")}function cT(e,t){1&e&&js(0,"app-icon",9),2&e&&Ws("name","neutral")("path","happiness")("title","")("margin","0 0 0 4px")}function lT(e,t){1&e&&js(0,"app-icon",9),2&e&&Ws("name","happy")("path","happiness")("title","")("margin","0 0 0 4px")}function hT(e,t){1&e&&js(0,"app-icon",9),2&e&&Ws("name","overjoyed")("path","happiness")("title","")("margin","0 0 0 4px")}var dT=function(e,t){return{negativeColor:e,positiveColor:t}},gT=function(){var e=function(){function e(t){p(this,e),this.happinessService=t,this.id=Math.random()}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getHappiness",value:function(){return Qv.round(this.happinessService.getHappiness(),2)}},{key:"getHappinessValue",value:function(){return this.happinessService.getHappiness()}},{key:"getSum",value:function(){return this.happinessService.calculateDailyChange()}},{key:"getSumText",value:function(){return Qv.round(this.getSum(),2)}},{key:"getHappinessBonus",value:function(){return this.happinessService.getHappinessEffect()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_E))},e.\u0275cmp=it({type:e,selectors:[["app-happiness"]],decls:23,vars:22,consts:[["appTooltip","",1,"tooltip",3,"elementId"],[3,"id"],["id","title"],[1,"center"],[1,"inline",3,"ngClass"],[1,"center","inline"],[1,"center","inline",3,"ngClass"],["id","wrapper",1,"icon"],[3,"name","path","title","margin",4,"ngIf"],[3,"name","path","title","margin"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"span",1),zs(2,"div",2),zs(3,"div"),ha(4,"Happiness"),Ys(),Ys(),js(5,"br"),zs(6,"div",3),ha(7," (bonus: "),zs(8,"div",4),ha(9),Ys(),ha(10,") "),Ys(),zs(11,"div",5),zs(12,"div",6),ha(13),Ys(),ha(14," per day "),Ys(),Ys(),zs(15,"div",7),Gs(16,aT,1,4,"app-icon",8),Gs(17,uT,1,4,"app-icon",8),Gs(18,cT,1,4,"app-icon",8),Gs(19,lT,1,4,"app-icon",8),Gs(20,hT,1,4,"app-icon",8),zs(21,"div",4),ha(22),Ys(),Ys(),Ys()),2&e&&(Ws("elementId","happiness-"+t.id),ho(1),na("id","happiness-",t.id,""),ho(7),Ws("ngClass",Lu(13,dT,t.getHappinessBonus()<0,t.getHappinessBonus()>0)),ho(1),ga("",t.getHappinessBonus(),"%"),ho(3),Ws("ngClass",Lu(16,dT,t.getSum()<0,t.getSum()>0)),ho(1),ga("",t.getSumText(),"%"),ho(3),Ws("ngIf",t.getHappinessValue()>=0&&t.getHappinessValue()<=10),ho(1),Ws("ngIf",t.getHappinessValue()>10&&t.getHappinessValue()<=40),ho(1),Ws("ngIf",t.getHappinessValue()>40&&t.getHappinessValue()<=60),ho(1),Ws("ngIf",t.getHappinessValue()>60&&t.getHappinessValue()<=90),ho(1),Ws("ngIf",t.getHappinessValue()>90&&t.getHappinessValue()<=100),ho(1),Ws("ngClass",Lu(19,dT,t.getHappinessBonus()<=0,t.getHappinessBonus()>0)),ho(1),ga("",t.getHappiness(),"%"))},directives:[sT,xl,Gl,oT],styles:["[_nghost-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.inline[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.center[_ngcontent-%COMP%]{text-align:center}.positiveColor[_ngcontent-%COMP%]{color:var(--positive-colour)}.negativeColor[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e}();function fT(e,t){if(1&e&&(zs(0,"div"),ha(1),js(2,"app-icon",8),Ys()),2&e){var i=ta().$implicit,n=ta(2);ho(1),ga("",i.value," "),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function vT(e,t){if(1&e&&(zs(0,"div",9),ha(1),js(2,"app-icon",8),Ys()),2&e){var i=ta().$implicit,n=ta(2);ho(1),ga("",i.value," "),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function pT(e,t){if(1&e&&(zs(0,"div"),Gs(1,fT,3,3,"div",6),Gs(2,vT,3,3,"div",7),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("ngIf",n.hasResource(i)),ho(1),Ws("ngIf",!n.hasResource(i))}}function mT(e,t){if(1&e){var i=qs();zs(0,"div",2),$s("click",function(){return Kt(i),ta().buff()}),js(1,"img",3),zs(2,"span",4),ha(3),js(4,"br"),ha(5),js(6,"hr"),Gs(7,pT,3,2,"div",5),Hu(8,"keyvalue"),Ys(),Ys()}if(2&e){var n=ta();Ws("elementId",-n.id),ho(2),ia("id",-n.id),ho(1),ga(" ",n.buildingBuff.name,""),ho(2),fa(" ",n.buildingBuff.effect,"% buff for ",n.buildingBuff.duration," days "),ho(2),Ws("ngForOf",Gu(8,6,n.buildingBuff.cost))}}var ST=function(){var e=function(){function e(t,i,n,r){p(this,e),this.servicesService=t,this.resourcesService=i,this.effectsService=n,this.gameService=r,this.id=Math.random()}return S(e,[{key:"ngOnInit",value:function(){this.building.hasBuff()&&(this.buildingBuff=this.building.getBuff())}},{key:"hasResource",value:function(e){return 0===this.resourcesService.hasResource(e.key,e.value,"Building buff",!0)}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"buff",value:function(){var e=this.servicesService.getModalService();if(this.building.hasBuff()&&this.buffsEnabled())if(this.building.isBuffed())e.info("This building is already buffed");else{var t=this.building.getBuff();this.resourcesService.decreaseResources(t.cost,"Building buff",!0)&&this.effectsService.addBuildingEffect(new rp(t.name,this.building.getBuildingType(),t.effect,t.duration,this.building.id))}else e.info("This building cannot be buffed")}},{key:"buffsEnabled",value:function(){return this.gameService.isEnabled(wv.BUFFS)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs($v),Bs(DE),Bs(Am),Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-building-buff"]],inputs:{building:"building"},decls:2,vars:1,consts:[["id","wrapper"],["id","buff","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","buff","appTooltip","",1,"tooltip",3,"elementId","click"],["draggable","false","ondragstart","return false;","src","assets/buff.svg"],[3,"id"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","notMet",4,"ngIf"],[3,"name","path"],[1,"notMet"]],template:function(e,t){1&e&&(zs(0,"div",0),Gs(1,mT,9,8,"div",1),Ys()),2&e&&(ho(1),Ws("ngIf",t.buffsEnabled()&&t.building.hasBuff()&&!t.building.isBuffed()))},directives:[Gl,sT,Ul,oT],pipes:[Xl],styles:["#wrapper[_ngcontent-%COMP%]{cursor:pointer}img[_ngcontent-%COMP%]{height:24px;width:24px}hr[_ngcontent-%COMP%]{border-color:#000}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e}();function ET(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga("Upgrade to ",i.getBuildingName(i.building.getUpgradeSettings().NEW_BUILDING),"")}}function yT(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga("Upgrade to level ",i.building.getBuildingLevel()+1,"")}}var RT=function(e){return{notMet:e}};function OT(e,t){if(1&e&&(zs(0,"div",8),ha(1),js(2,"app-icon",9),Ys()),2&e){var i=ta(2);Ws("ngClass",Du(3,RT,!i.landService.hasLand(i.building.getUpgradeSettings().SIZE))),ho(1),ga(" ",i.building.getUpgradeSettings().SIZE,""),ho(1),Ws("name","land")}}function TT(e,t){if(1&e&&(zs(0,"div"),ha(1),js(2,"app-icon",11),Ys()),2&e){var i=ta().$implicit,n=ta(2);ho(1),ga("",i.value," "),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function IT(e,t){if(1&e&&(zs(0,"div",12),ha(1),js(2,"app-icon",11),Ys()),2&e){var i=ta().$implicit,n=ta(2);ho(1),ga("",i.value," "),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function bT(e,t){if(1&e&&(zs(0,"div"),Gs(1,TT,3,3,"div",5),Gs(2,IT,3,3,"div",10),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("ngIf",n.hasResource(i)),ho(1),Ws("ngIf",!n.hasResource(i))}}function CT(e,t){if(1&e){var i=qs();zs(0,"div",2),$s("click",function(){return Kt(i),ta().upgrade()}),js(1,"img",3),zs(2,"span",4),Gs(3,ET,2,1,"div",5),Gs(4,yT,2,1,"div",5),js(5,"hr"),Gs(6,OT,3,5,"div",6),Gs(7,bT,3,2,"div",7),Hu(8,"keyvalue"),Ys(),Ys()}if(2&e){var n=ta();Ws("elementId",-n.id),ho(2),ia("id",-n.id),ho(1),Ws("ngIf",n.building.getUpgradeSettings()&&n.building.getUpgradeSettings().NEW_BUILDING),ho(1),Ws("ngIf",n.building.getUpgradeSettings()&&void 0===n.building.getUpgradeSettings().NEW_BUILDING),ho(2),Ws("ngIf",n.building.getUpgradeSettings()&&n.building.getUpgradeSettings().SIZE),ho(1),Ws("ngForOf",Gu(8,6,n.building.getUpgradeCost()))}}var AT=function(){var e=function(){function e(t,i,n){p(this,e),this.resourcesService=t,this.landService=i,this.servicesService=n,this.id=Math.random()}return S(e,[{key:"ngOnInit",value:function(){}},{key:"hasResource",value:function(e){return 0===this.resourcesService.hasResource(e.key,e.value,this.building.getName()+" upgrade",!0)}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"upgrade",value:function(){this.parentRegion.upgradeBuilding(this.building.getBuildingId())}},{key:"getBuildingName",value:function(e){return Qv.prepareBuildingName(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(DE),Bs(wm),Bs($v))},e.\u0275cmp=it({type:e,selectors:[["app-building-upgrade"]],inputs:{building:"building",parentRegion:"parentRegion"},decls:2,vars:1,consts:[["id","wrapper"],["id","upgrade","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","upgrade","appTooltip","",1,"tooltip",3,"elementId","click"],["draggable","false","ondragstart","return false;","src","assets/upgrade.svg"],[3,"id"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"name"],["class","notMet",4,"ngIf"],[3,"name","path"],[1,"notMet"]],template:function(e,t){1&e&&(zs(0,"div",0),Gs(1,CT,9,8,"div",1),Ys()),2&e&&(ho(1),Ws("ngIf",t.building.hasUpgrade()))},directives:[Gl,sT,Ul,xl,oT],pipes:[Xl],styles:["#wrapper[_ngcontent-%COMP%]{cursor:pointer}img[_ngcontent-%COMP%]{height:24px;width:24px}hr[_ngcontent-%COMP%]{border-color:#000}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e}(),kT=["progress"],NT=["label"],_T=["label2"];function wT(e,t){1&e&&(zs(0,"div",2),js(1,"div",3,4),js(3,"div",5,6),Ys())}function PT(e,t){1&e&&(zs(0,"div",7),js(1,"div",8,9),Ys())}var MT=function(){var e=function(){function e(t){p(this,e),this.optionsService=t,this.progress=0,this.text=""}return S(e,[{key:"progressReInput",set:function(e){this.progressRef=e,this.ngOnChanges()}},{key:"labelRefInput",set:function(e){this.labelRef=e,this.ngOnChanges()}},{key:"label2RefInput",set:function(e){this.label2Ref=e,this.ngOnChanges()}},{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(){this.progressBarsEnabled()?(this.progressRef&&(this.progressRef.nativeElement.style.width=this.progress+"%"),this.labelRef&&(this.labelRef.nativeElement.innerHTML=this.text&&""!==this.text?this.text:this.progress.toFixed(2)+"%")):this.label2Ref&&(this.label2Ref.nativeElement.innerHTML=this.text,this.label2Ref.nativeElement.innerHTML=this.progress.toFixed(2)+"%")}},{key:"progressBarsEnabled",value:function(){return this.optionsService.getOption(Xv.VISUAL_PROGRESS_BARS)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Om))},e.\u0275cmp=it({type:e,selectors:[["app-progress-bar"]],viewQuery:function(e,t){var i;(1&e&&(rc(kT,5),rc(NT,5),rc(_T,5)),2&e)&&(nc(i=sc())&&(t.progressReInput=i.first),nc(i=sc())&&(t.labelRefInput=i.first),nc(i=sc())&&(t.label2RefInput=i.first))},inputs:{progress:"progress",text:"text"},features:[Rt],decls:2,vars:2,consts:[["id","progressBar",4,"ngIf"],["id","progressBar2",4,"ngIf"],["id","progressBar"],["id","progress"],["progress",""],["id","label"],["label",""],["id","progressBar2"],["id","label2"],["label2",""]],template:function(e,t){1&e&&(Gs(0,wT,5,0,"div",0),Gs(1,PT,3,0,"div",1)),2&e&&(Ws("ngIf",t.progressBarsEnabled()),ho(1),Ws("ngIf",!t.progressBarsEnabled()))},directives:[Gl],styles:["#progressBar[_ngcontent-%COMP%]{position:relative;width:95%;height:100%;display:inline-block;text-align:center;background-color:#ddd;border:black solid 1px;margin-top:-1px}#progressBar2[_ngcontent-%COMP%]{position:relative;width:95%;height:100%;display:inline-block;text-align:center;margin-top:-1px}#progress[_ngcontent-%COMP%]{height:100%;background-color:var(--active-colour);text-align:center;color:#fff}#label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;font-size:1em;text-align:center}#label2[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;font-size:1em;text-align:center;font-weight:bold}"],changeDetection:0}),e}();function DT(e,t){if(1&e&&(zs(0,"span"),zs(1,"span",7),js(2,"span",8),js(3,"app-icon",9),js(4,"span",8),Ys(),Ys()),2&e){var i=t.$implicit;ho(2),Ws("innerHTML",i.prefix,dr),ho(1),Ws("name",i.name)("path",i.path),ho(1),Ws("innerHTML",i.suffix,dr)}}function LT(e,t){if(1&e&&(zs(0,"span",5),Gs(1,DT,5,4,"span",6),Ys()),2&e){var i=ta(2);ho(1),Ws("ngForOf",i.building.getLine(i.line).getValue())}}function xT(e,t){if(1&e&&js(0,"span",10),2&e){var i=ta(2);Ws("innerHTML",i.building.getLine(i.line).getValue(),dr)}}function FT(e,t){if(1&e){var i=qs();zs(0,"span",11),zs(1,"button",12),$s("click",function(){Kt(i);var e=ta(2);return e.buildingCallback(e.building.getLine(e.line).getValue().callbackValue)}),ha(2),Ys(),Ys()}if(2&e){var n=ta(2);ho(2),ga("",n.building.getLine(n.line).getValue().buttonText," ")}}function UT(e,t){if(1&e){var i=qs();zs(0,"span",11),zs(1,"button",12),$s("click",function(){Kt(i);var e=ta(2);return e.buildingCallback(e.building.getLine(e.line).getValue().callbackValue)}),ha(2),Ys(),zs(3,"label"),zs(4,"input",13),$s("ngModelChange",function(e){Kt(i);var t=ta(2);return t.building.getLine(t.line).getValue().checkboxState=e})("click",function(){Kt(i);var e=ta(2);return e.buildingCallback(e.building.getLine(e.line).getValue().checkboxCallbackValue)}),Ys(),ha(5),Ys(),Ys()}if(2&e){var n=ta(2);ho(2),ga("",n.building.getLine(n.line).getValue().buttonText," "),ho(2),Ws("ngModel",n.building.getLine(n.line).getValue().checkboxState),ho(1),ga("",n.building.getLine(n.line).getValue().checkboxLabel," ")}}function HT(e,t){if(1&e){var i=qs();zs(0,"span",11),zs(1,"label"),zs(2,"input",13),$s("ngModelChange",function(e){Kt(i);var t=ta(2);return t.building.getLine(t.line).getValue().checkboxState=e})("click",function(){Kt(i);var e=ta(2);return e.buildingCallback(e.building.getLine(e.line).getValue().checkboxCallbackValue)}),Ys(),ha(3),Ys(),Ys()}if(2&e){var n=ta(2);ho(2),Ws("ngModel",n.building.getLine(n.line).getValue().checkboxState),ho(1),ga("",n.building.getLine(n.line).getValue().checkboxLabel," ")}}function GT(e,t){if(1&e){var i=qs();zs(0,"span",11),zs(1,"button",12),$s("click",function(){Kt(i);var e=ta(2);return e.buildingCallback(e.building.getLine(e.line).getValue().callback1Value)}),ha(2),Ys(),js(3,"span",8),zs(4,"button",12),$s("click",function(){Kt(i);var e=ta(2);return e.buildingCallback(e.building.getLine(e.line).getValue().callback2Value)}),ha(5),Ys(),Ys()}if(2&e){var n=ta(2);ho(2),da(n.building.getLine(n.line).getValue().button1Text),ho(1),Ws("innerHTML",n.building.getLine(n.line).getValue().textBetween,dr),ho(2),da(n.building.getLine(n.line).getValue().button2Text)}}function BT(e,t){if(1&e&&(zs(0,"option",16),ha(1),Ys()),2&e){var i=t.$implicit;Ws("value",i),ho(1),da(i)}}function WT(e,t){if(1&e){var i=qs();zs(0,"span",11),zs(1,"select",14),$s("change",function(e){return Kt(i),ta(2).buildingCallback(e)})("ngModelChange",function(e){Kt(i);var t=ta(2);return t.building.getLine(t.line).getValue().selected=e}),Gs(2,BT,2,2,"option",15),Ys(),Ys()}if(2&e){var n=ta(2);ho(1),Ws("ngModel",n.building.getLine(n.line).getValue().selected),ho(1),Ws("ngForOf",n.building.getLine(n.line).getValue().values)}}function VT(e,t){if(1&e&&js(0,"app-progress-bar",18),2&e){var i=ta(3);Ws("progress",i.building.getLine(i.line).getValue().value)("text",i.building.getLine(i.line).getValue().label)}}function zT(e,t){if(1&e&&(zs(0,"span",11),Gs(1,VT,1,2,"app-progress-bar",17),Ys()),2&e){var i=ta(2);ho(1),Ws("ngIf",i.building.getLine(i.line).getValue().value>=0)}}function YT(e,t){if(1&e&&(zs(0,"span",1),Gs(1,LT,2,1,"span",2),Gs(2,xT,1,1,"span",3),Gs(3,FT,3,1,"span",4),Gs(4,UT,6,3,"span",4),Gs(5,HT,4,2,"span",4),Gs(6,GT,6,3,"span",4),Gs(7,WT,3,2,"span",4),Gs(8,zT,2,1,"span",4),Ys()),2&e){var i=ta();ho(1),Ws("ngIf",i.isIconValue(i.building.getLine(i.line).getValueType())),ho(1),Ws("ngIf",i.isTextValue(i.building.getLine(i.line).getValueType())),ho(1),Ws("ngIf",i.isButtonValue(i.building.getLine(i.line).getValueType())),ho(1),Ws("ngIf",i.isButtonCheckboxValue(i.building.getLine(i.line).getValueType())),ho(1),Ws("ngIf",i.isCheckboxValue(i.building.getLine(i.line).getValueType())),ho(1),Ws("ngIf",i.isTwoButtonValue(i.building.getLine(i.line).getValueType())),ho(1),Ws("ngIf",i.isDropdownValue(i.building.getLine(i.line).getValueType())),ho(1),Ws("ngIf",i.isProgressValue(i.building.getLine(i.line).getValueType()))}}var jT=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"ngOnInit",value:function(){}},{key:"isTextValue",value:function(e){return e===Pm.TEXT}},{key:"isButtonValue",value:function(e){return e===Pm.BUTTON}},{key:"isTwoButtonValue",value:function(e){return e===Pm.TWO_BUTTON}},{key:"isProgressValue",value:function(e){return e===Pm.PROGRESS_BAR}},{key:"isDropdownValue",value:function(e){return e===Pm.DROPDOWN}},{key:"isIconValue",value:function(e){return e===Pm.ICON}},{key:"isButtonCheckboxValue",value:function(e){return e===Pm.BUTTON_CHECKBOX}},{key:"isCheckboxValue",value:function(e){return e===Pm.CHECKBOX}},{key:"buildingCallback",value:function(e){this.building.callback(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=it({type:e,selectors:[["app-building-line"]],inputs:{line:"line",building:"building"},decls:1,vars:1,consts:[["id","wrapper",4,"ngIf"],["id","wrapper"],["class","line iconsLine",4,"ngIf"],["class","line",3,"innerHTML",4,"ngIf"],["class","line",4,"ngIf"],[1,"line","iconsLine"],[4,"ngFor","ngForOf"],[1,"icon"],[3,"innerHTML"],[3,"name","path"],[1,"line",3,"innerHTML"],[1,"line"],[3,"click"],["type","checkbox",3,"ngModel","ngModelChange","click"],[3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"progress","text",4,"ngIf"],[3,"progress","text"]],template:function(e,t){1&e&&Gs(0,YT,9,8,"span",0),2&e&&Ws("ngIf",null!=t.line&&t.building)},directives:[Gl,Ul,oT,jR,vO,DO,YO,jO,XO,MT],styles:["#wrapper[_ngcontent-%COMP%]{font-size:1.3em}.iconsLine[_ngcontent-%COMP%]{display:flex;flex-direction:row}.iconsLine[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:auto}.line[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:1px 4px}button[_ngcontent-%COMP%]{font-size:.9em}select[_ngcontent-%COMP%]{font-size:.9em}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}.icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:2px;flex:0 0 auto}"]}),e}(),KT=["center"];function QT(e,t){if(1&e&&(zs(0,"span",18),js(1,"img",19),zs(2,"span",20),zs(3,"div",21),ha(4),Ys(),js(5,"hr"),js(6,"div",22),Ys(),Ys()),2&e){var i=ta();Ws("elementId",i.id),ho(2),ia("id",i.id),ho(2),da(i.building.getName()),ho(2),Ws("innerHTML",i.building.getDetails(),dr)}}function qT(e,t){if(1&e&&(zs(0,"span",23),ha(1),Ys()),2&e){var i=ta();ho(1),ga("(+",i.round(i.getDisplayableEffectsValue()),"%)")}}function XT(e,t){if(1&e&&(zs(0,"span",24),ha(1),Ys()),2&e){var i=ta();ho(1),ga("(",i.round(i.getDisplayableEffectsValue()),"%)")}}function ZT(e,t){if(1&e){var i=qs();zs(0,"span",26),$s("click",function(){return Kt(i),ta(2).stop()}),js(1,"img",27),Ys()}}function $T(e,t){if(1&e){var i=qs();zs(0,"span",26),$s("click",function(){return Kt(i),ta(2).stop()}),js(1,"img",28),Ys()}}function JT(e,t){if(1&e&&(Ks(0),Gs(1,ZT,2,0,"span",25),Gs(2,$T,2,0,"span",25),Qs()),2&e){var i=ta();ho(1),Ws("ngIf",i.isStoppable()&&i.isWorking()),ho(1),Ws("ngIf",i.isStoppable()&&!i.isWorking())}}function eI(e,t){1&e&&js(0,"img",33)}function tI(e,t){1&e&&js(0,"img",34)}function iI(e,t){1&e&&js(0,"img",35)}function nI(e,t){1&e&&js(0,"img",36)}function rI(e,t){if(1&e){var i=qs();zs(0,"span",26),$s("click",function(e){return Kt(i),ta(2).openWorkersManagement(e)}),Gs(1,eI,1,0,"img",29),Gs(2,tI,1,0,"img",30),Gs(3,iI,1,0,"img",31),Gs(4,nI,1,0,"img",32),Ys()}if(2&e){var n=ta(2);ho(1),Ws("ngIf",n.building.getWorkSettings().enabled&&n.building.isWorking()),ho(1),Ws("ngIf",n.building.getWorkSettings().enabled&&!n.building.isWorking()),ho(1),Ws("ngIf",!n.building.getWorkSettings().enabled&&n.building.isWorking()),ho(1),Ws("ngIf",!n.building.getWorkSettings().enabled&&!n.building.isWorking())}}function oI(e,t){if(1&e&&(Ks(0),Gs(1,rI,5,4,"span",25),Qs()),2&e){var i=ta();ho(1),Ws("ngIf",i.isStoppable())}}function sI(e,t){if(1&e){var i=qs();zs(0,"div",37),$s("click",function(){return Kt(i),ta().demolish()}),zs(1,"span",38),ha(2,"Demolish"),Ys(),Ys()}}function aI(e,t){if(1&e){var i=qs();zs(0,"div",39),$s("click",function(){return Kt(i),ta().combine()}),zs(1,"span",40),ha(2,"Combine"),Ys(),Ys()}}function uI(e,t){if(1&e){var i=qs();zs(0,"div",41),$s("click",function(){return Kt(i),ta().split()}),zs(1,"span",40),ha(2,"Split"),Ys(),Ys()}}function cI(e,t){if(1&e){var i=qs();zs(0,"div",42),$s("click",function(){return Kt(i),ta().arrange()}),zs(1,"span",40),ha(2,"Move"),Ys(),Ys()}}var lI=function(e){return{usedUp:e}},hI=function(){var e=function(){function e(t,i,n,r,o,s){p(this,e),this.modalService=t,this.servicesService=i,this.resourcesService=n,this.managementService=r,this.villageService=o,this.optionsService=s,this.demolishMode=!1,this.combineMode=!1,this.splitMode=!1,this.arrangeMode=!1,this.lines=Dm,this.id=Math.random(),this.lastEffectsDisplayValue=0,this.hasEffectsDisplayChanged=!1}return S(e,[{key:"ngOnInit",value:function(){}},{key:"fitText",value:function(){if(this.centerRef){this.hasEffectsDisplayChanged=!1;var e=this.centerRef.nativeElement,t=e.clientWidth,i=e.scrollWidth,n=parseInt(window.getComputedStyle(e,null).getPropertyValue("font-size"),10);if(i>t)n=(n=Math.ceil(n*t/i))>15?n=15:n-1,e.style.fontSize=n+"px";else for(;i===t&&n<15;)n=(n=Math.ceil(n)+1)>15?n=15:n,e.style.fontSize=n+"px",t=e.clientWidth,(i=e.scrollWidth)>t&&(e.style.fontSize=n-1+"px")}}},{key:"stop",value:function(){this.building.isWorking()?this.building.stopProduction():this.building.startProduction()||this.modalService.info("Cannot unlock production of "+this.building.getName()+". Number of free workers: "+this.resourcesService.getPeople())}},{key:"isStoppable",value:function(){return this.building.isStoppable()}},{key:"isWorking",value:function(){return this.building.isWorking()}},{key:"demolish",value:function(){var e=this;if(void 0!==this.building.getMaxSize&&this.villageService.getPopulation()>this.villageService.getPopulationCap()-this.building.getMaxSize()){this.modalService.open(_v.CONFIRM),this.modalService.setModalText("You don't have enough housing space to move this building occupants.<br> People that won't find new home will leave the village<br>Do you still want to demolish this building?");var t=this.modalService.registerForConfirmation().subscribe(function(i){t.unsubscribe(),i&&e.building.prepareDemolish()&&e.parentRegion.demolish(e.building)})}else if(this.building.isUsedUp())this.building.prepareDemolish()&&this.parentRegion.demolish(this.building);else{this.modalService.setModalText("Are you sure you want to demolish "+this.building.getName()+"?"),this.modalService.open(_v.CONFIRM);var i=this.modalService.registerForConfirmation().subscribe(function(t){i.unsubscribe(),t&&e.building.prepareDemolish()&&e.parentRegion.demolish(e.building)})}}},{key:"canCombine",value:function(){return this.parentRegion.canCombine(this.building)}},{key:"combine",value:function(){this.parentRegion.combine(this.building)}},{key:"split",value:function(){this.parentRegion.split(this.building)}},{key:"areComplexWorkersEnabled",value:function(){return this.managementService.getComplexWorkers()}},{key:"openWorkersManagement",value:function(e){e.ctrlKey?this.building.getWorkSettings().enabled?(this.building.getWorkSettings().enabled=!1,this.stop()):this.stop():e.shiftKey?this.building.getWorkSettings().enabled=!this.building.getWorkSettings().enabled:(this.modalService.open(_v.WORK_MANAGEMENT),this.modalService.setBuilding(this.building))}},{key:"round",value:function(e){return e%1!=0?Qv.round(e,2):e}},{key:"arrange",value:function(){this.parentRegion.move(this.building)}},{key:"canMove",value:function(){return this.parentRegion.canMove(this.building)}},{key:"getDisplayableEffectsValue",value:function(){var e=this.building.getDisplayableEffectsValue();return this.lastEffectsDisplayValue!==e&&(this.lastEffectsDisplayValue=e,this.hasEffectsDisplayChanged=!0),e}},{key:"isTextFittingEnabled",value:function(){return this.optionsService.getOption(Xv.AUTO_TEXT_FITTING)}},{key:"ngAfterViewChecked",value:function(){this.hasEffectsDisplayChanged&&this.isTextFittingEnabled()&&this.fitText()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs($v),Bs(DE),Bs(DR),Bs(MR),Bs(Om))},e.\u0275cmp=it({type:e,selectors:[["app-building"]],viewQuery:function(e,t){var i;(1&e&&rc(KT,5),2&e)&&(nc(i=sc())&&(t.centerRef=i.first))},inputs:{demolishMode:"demolishMode",combineMode:"combineMode",splitMode:"splitMode",arrangeMode:"arrangeMode",building:"building",parentRegion:"parentRegion"},decls:23,vars:24,consts:[["id","wrapper",3,"ngClass"],["id","nameBar"],["id","left"],["class","details tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","center"],["center",""],["class","positiveEffects",4,"ngIf"],["class","negativeEffects",4,"ngIf"],["id","right"],[4,"ngIf"],["id","lines"],[3,"building"],[3,"building","parentRegion"],[3,"line","building"],["id","demolish",3,"click",4,"ngIf"],["id","combine",3,"click",4,"ngIf"],["id","split",3,"click",4,"ngIf"],["id","arrange",3,"click",4,"ngIf"],["appTooltip","",1,"details","tooltip",3,"elementId"],["draggable","false","ondragstart","return false;","src","assets/details.svg","alt","details"],[1,"tooltipSpan",3,"id"],["id","title"],[3,"innerHTML"],[1,"positiveEffects"],[1,"negativeEffects"],["class","control",3,"click",4,"ngIf"],[1,"control",3,"click"],["draggable","false","ondragstart","return false;","src","assets/gear.svg","title","disable","alt","on"],["draggable","false","ondragstart","return false;","src","assets/gear_off.svg","title","enable","alt","off"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_on.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_off.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_on.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_off.svg","title","work settings",4,"ngIf"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_on.svg","title","work settings"],["draggable","false","ondragstart","return false;","src","assets/complex_management_on_off.svg","title","work settings"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_on.svg","title","work settings"],["draggable","false","ondragstart","return false;","src","assets/complex_management_off_off.svg","title","work settings"],["id","demolish",3,"click"],["id","demolishText"],["id","combine",3,"click"],[1,"combineText"],["id","split",3,"click"],["id","arrange",3,"click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),zs(2,"div",2),Gs(3,QT,7,4,"span",3),Ys(),zs(4,"div",4,5),ha(6),Gs(7,qT,2,1,"span",6),Gs(8,XT,2,1,"span",7),Ys(),zs(9,"div",8),Gs(10,JT,3,2,"ng-container",9),Gs(11,oI,2,1,"ng-container",9),Ys(),Ys(),zs(12,"div",10),js(13,"app-building-buff",11),js(14,"app-building-upgrade",12),js(15,"app-building-line",13),js(16,"app-building-line",13),js(17,"app-building-line",13),js(18,"app-building-line",13),Ys(),Gs(19,sI,3,0,"div",14),Gs(20,aI,3,0,"div",15),Gs(21,uI,3,0,"div",16),Gs(22,cI,3,0,"div",17),Ys()),2&e&&(Ws("ngClass",Du(22,lI,t.building.isUsedUp())),ho(3),Ws("ngIf",t.building.hasDetails()),ho(3),ga("",t.building.getName()," "),ho(1),Ws("ngIf",t.getDisplayableEffectsValue()>0),ho(1),Ws("ngIf",t.getDisplayableEffectsValue()<0),ho(2),Ws("ngIf",!t.building.isComplexManagement()||t.building.isComplexManagement()&&!t.areComplexWorkersEnabled()),ho(1),Ws("ngIf",t.building.isComplexManagement()&&t.areComplexWorkersEnabled()),ho(2),Ws("building",t.building),ho(1),Ws("building",t.building)("parentRegion",t.parentRegion),ho(1),Ws("line",t.lines.FIRST)("building",t.building),ho(1),Ws("line",t.lines.SECOND)("building",t.building),ho(1),Ws("line",t.lines.THIRD)("building",t.building),ho(1),Ws("line",t.lines.FOURTH)("building",t.building),ho(1),Ws("ngIf",t.demolishMode&&t.building.isDemolishable()),ho(1),Ws("ngIf",t.combineMode&&t.building.isCombinable()&&t.canCombine()),ho(1),Ws("ngIf",t.splitMode&&t.building.isSplittable()),ho(1),Ws("ngIf",t.arrangeMode&&t.canMove()))},directives:[xl,Gl,ST,AT,jT,sT],styles:["@media screen and (min-width : 0px) and (max-width : 1200px){[_nghost-%COMP%]{height:125px;width:206px;border:black solid 1px;overflow:hidden}}@media screen and (min-width : 1200px) and (max-width: 1500px){[_nghost-%COMP%]{height:138px;width:227px;border:black solid 1px;overflow:hidden}}@media screen and (min-width : 1500px){[_nghost-%COMP%]{height:150px;width:247px;border:black solid 1px;overflow:hidden}}#wrapper[_ngcontent-%COMP%]{position:relative;height:100%;text-align:center;font-size:.7em;overflow:hidden}.usedUp[_ngcontent-%COMP%]{background-color:#7e7a7999}#demolish[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}#demolishText[_ngcontent-%COMP%]{display:block}#combine[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}#split[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}#arrange[_ngcontent-%COMP%]{position:absolute;font-weight:600;font-size:2em;top:0;left:0;width:100%;height:100%;background-color:#7e7a79b3;justify-content:center;align-items:center;display:flex;cursor:pointer}.combineText[_ngcontent-%COMP%]{display:block}#nameBar[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;height:24px;font-size:1.4em;font-weight:bold;border-bottom:black solid 1px;white-space:nowrap}#left[_ngcontent-%COMP%]{flex:1 0 24px}#center[_ngcontent-%COMP%]{flex:1 0 152px;font-size:.8em;overflow:hidden;line-height:24px}#right[_ngcontent-%COMP%]{flex:1 0 24px}.control[_ngcontent-%COMP%]{float:right;font-size:.6em;margin-right:2px;cursor:pointer}.control[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px}#lines[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column}app-progress-bar[_ngcontent-%COMP%]{display:block;height:18px}app-building-line[_ngcontent-%COMP%]{height:20px;display:block;margin-top:3px;flex:1 0 auto}img[_ngcontent-%COMP%]{height:24px}.details[_ngcontent-%COMP%]{float:left;font-size:.75em;margin-right:2px}.positiveEffects[_ngcontent-%COMP%]{font-size:.7em;color:var(--positive-colour)}.negativeEffects[_ngcontent-%COMP%]{font-size:.7em;color:var(--negative-colour)}.tooltipSpan[_ngcontent-%COMP%]{font-size:1.5em;font-weight:100;text-align:left}.tooltipSpan[_ngcontent-%COMP%]   #title[_ngcontent-%COMP%]{text-align:center}.tooltipSpan[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border-color:#000}app-building-buff[_ngcontent-%COMP%]{position:absolute;right:0;top:0}app-building-upgrade[_ngcontent-%COMP%]{position:absolute;left:-2px;top:0}"]}),e}();function dI(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Demolish"),Ys()}}function gI(e,t){if(1&e){var i=qs();zs(0,"button",23),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Stop"),Ys()}}function fI(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Arrange"),Ys()}}function vI(e,t){if(1&e){var i=qs();zs(0,"button",23),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Stop"),Ys()}}function pI(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Combine"),Ys()}}function mI(e,t){if(1&e){var i=qs();zs(0,"button",23),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Stop"),Ys()}}function SI(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Split"),Ys()}}function EI(e,t){if(1&e){var i=qs();zs(0,"button",23),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Stop"),Ys()}}function yI(e,t){if(1&e&&(zs(0,"option",13),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("value",i),ho(1),da(n.getBuildingName(i))}}function RI(e,t){1&e&&(Ks(0),js(1,"img",28),Qs())}function OI(e,t){if(1&e&&(zs(0,"div"),ha(1),Hu(2,"number"),Gs(3,RI,2,0,"ng-container",27),Ys()),2&e){var i=t.$implicit,n=t.index,r=ta(2);ho(1),va(" ",n+1,". ",r.getSicknessName(i.sickness)," ",Bu(2,4,i.progress,"0.0-0"),"% "),ho(2),Ws("ngIf",i.medicine>0)}}function TI(e,t){if(1&e&&(zs(0,"span",24),js(1,"app-icon",17),ha(2),zs(3,"span",25),ha(4),js(5,"hr"),Gs(6,OI,4,7,"div",26),Ys(),ha(7," \xa0\xa0\xa0 "),Ys()),2&e){var i=ta();Ws("elementId","sick"),ho(1),Ws("name","sick")("title","")("margin","0 0 0 2px"),ho(1),ga(" ",i.getSick().length," "),ho(2),ga(" Sick: ",i.getSick().length," "),ho(2),Ws("ngForOf",i.getSick())}}function II(e,t){if(1&e&&(zs(0,"span",33),js(1,"app-building",34),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.villageService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function bI(e,t){if(1&e&&(zs(0,"div",29),zs(1,"div",30),zs(2,"span"),ha(3,"Buildings"),Ys(),Ys(),zs(4,"div",31),Gs(5,II,2,6,"span",32),Ys(),Ys()),2&e){var i=ta();ho(5),Ws("ngForOf",i.getBuildings())}}var CI=function(e){return{activePage:e}};function AI(e,t){if(1&e){var i=qs();zs(0,"span",37),$s("click",function(){var e=Kt(i).$implicit;return ta(2).setPage(e)}),ha(1),Ys()}if(2&e){var n=t.$implicit,r=ta(2);Ws("ngClass",Du(2,CI,r.currentPage===n)),ho(1),ga("page ",n+1,"")}}function kI(e,t){if(1&e&&(zs(0,"span",33),js(1,"app-building",34),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.villageService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function NI(e,t){if(1&e&&(zs(0,"div",29),zs(1,"div",35),Gs(2,AI,2,4,"span",36),Ys(),zs(3,"div",31),Gs(4,kI,2,6,"span",32),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getPagesNumber()),ho(2),Ws("ngForOf",i.getPagedBuildings())}}var _I=function(e){return{pointer:e}},wI=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u,c,l,h){var d;return p(this,i),(d=t.call(this,e,n,r,o,c,a,l,Yv.VILLAGE)).landService=n,d.villageService=o,d.resourcesService=s,d.managementService=u,d.router=h,d}return S(i,[{key:"getPopulation",value:function(){return this.villageService.getPopulation()}},{key:"getPopulationCap",value:function(){return this.villageService.getPopulationCap()}},{key:"getTakenLand",value:function(){return this.landService.getTakenLand()}},{key:"getSick",value:function(){return this.resourcesService.getSick()}},{key:"getSicknessName",value:function(e){return Qv.prepareSicknessName(e)}},{key:"openHappinessManagement",value:function(){this.isManagementUnlocked()&&this.router.navigate(["/management/happiness"])}},{key:"isManagementUnlocked",value:function(){return this.gameService.isEnabled(wv.MANAGEMENT)}},{key:"workshopsResearch",value:function(){this.villageService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).forEach(function(e){return e.switchToResearch()}),this.modalService.info("Workshops switched to researching")}},{key:"workshopsCraft",value:function(){this.villageService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).forEach(function(e){return e.switchToCrafting()}),this.modalService.info("Workshops switched to crafting")}}]),i}(pE);return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(MR),Bs(DE),Bs(Om),Bs(DR),Bs(Nm),Bs(cu),Bs(sv))},e.\u0275cmp=it({type:e,selectors:[["app-village"]],features:[bs],decls:60,vars:34,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name"],[3,"name","title","margin"],["class","icon tooltip","appTooltip","",3,"elementId",4,"ngIf"],[3,"name","title"],[3,"ngClass","click"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],["appTooltip","",1,"icon","tooltip",3,"elementId"],["id","sick"],[4,"ngFor","ngForOf"],[4,"ngIf"],["src","assets/resources/herbal_medicine.svg","alt","",1,"herbal"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"button",4),$s("click",function(){return t.openBuildModal()}),ha(6,"Build"),Ys(),Gs(7,dI,2,0,"button",5),Gs(8,gI,2,0,"button",6),Gs(9,fI,2,0,"button",5),Gs(10,vI,2,0,"button",6),Gs(11,pI,2,0,"button",5),Gs(12,mI,2,0,"button",6),Gs(13,SI,2,0,"button",5),Gs(14,EI,2,0,"button",6),zs(15,"button",7),ha(16,"Actions "),js(17,"img",8),zs(18,"ul",9),zs(19,"li",4),$s("click",function(){return t.autoSort()}),ha(20,"Sort"),Ys(),zs(21,"li",4),$s("click",function(){return t.autoMerge()}),ha(22,"Merge"),Ys(),zs(23,"li",4),$s("click",function(){return t.workshopsResearch()}),ha(24,"Workshops research"),Ys(),zs(25,"li",4),$s("click",function(){return t.workshopsCraft()}),ha(26,"Workshops craft"),Ys(),Ys(),Ys(),zs(27,"div",10),ha(28," Filter:"),js(29,"br"),zs(30,"div",11),zs(31,"select",12),$s("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),zs(32,"option",13),ha(33),Ys(),Gs(34,yI,2,2,"option",14),Ys(),zs(35,"select",12),$s("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),zs(36,"option",13),ha(37,"All"),Ys(),zs(38,"option",13),ha(39,"Working"),Ys(),zs(40,"option",13),ha(41,"Idle"),Ys(),Ys(),Ys(),Ys(),Ys(),zs(42,"div",15),js(43,"app-icon",16),ha(44),js(45,"app-icon",17),ha(46),Gs(47,TI,8,7,"span",18),js(48,"app-icon",16),ha(49),js(50,"app-icon",19),ha(51),zs(52,"app-happiness",20),$s("click",function(){return t.openHappinessManagement()}),Ys(),zs(53,"div",21),zs(54,"button",4),$s("click",function(){return t.enableAll()}),ha(55,"all on"),Ys(),zs(56,"button",4),$s("click",function(){return t.disableAll()}),ha(57,"all off"),Ys(),Ys(),Ys(),Gs(58,bI,6,1,"div",22),Gs(59,NI,5,2,"div",22),Ys(),Ys()),2&e&&(ho(7),Ws("ngIf",!t.demolishMode),ho(1),Ws("ngIf",t.demolishMode),ho(1),Ws("ngIf",!t.arrangeMode&&t.getBuildings().length>1),ho(1),Ws("ngIf",t.arrangeMode),ho(1),Ws("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),ho(1),Ws("ngIf",t.combineMode),ho(1),Ws("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),ho(1),Ws("ngIf",t.splitMode),ho(17),Ws("ngModel",t.filterBuilding),ho(1),Ws("value",t.allBuildings),ho(1),da(t.getBuildingName(t.allBuildings)),ho(1),Ws("ngForOf",t.getUniqueBuildingsFromCurrentView()),ho(1),Ws("ngModel",t.filterWorking),ho(1),Ws("value",t.buildingStates.ALL),ho(2),Ws("value",t.buildingStates.WORKING),ho(2),Ws("value",t.buildingStates.IDLE),ho(3),Ws("name","population"),ho(1),fa(" ",t.getPopulation(),"/",t.getPopulationCap()," \xa0\xa0 "),ho(1),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga(" ",t.getUnemployed()," \xa0\xa0\xa0 "),ho(1),Ws("ngIf",t.getSick().length>0),ho(1),Ws("name","land"),ho(1),ga(" ",t.getFreeLand()," \xa0\xa0\xa0 "),ho(1),Ws("name","village")("title","Village size"),ho(1),ga("\xa0",t.getTakenLand()," \xa0\xa0\xa0 "),ho(1),Ws("ngClass",Du(32,_I,t.isManagementUnlocked())),ho(6),Ws("ngIf",!t.isPagedViewEnabled()),ho(1),Ws("ngIf",t.isPagedViewEnabled()))},directives:[GR,Gl,YO,vO,DO,jO,XO,Ul,oT,gT,xl,sT,hI],pipes:[$l],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",".herbal[_ngcontent-%COMP%]{height:16px}.pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e}();function PI(e,t){if(1&e){var i=qs();zs(0,"button",30),$s("click",function(e){Kt(i);var t=ta(2).$implicit;return ta(2).addDevRes(t.resource,e)}),ha(1,"+"),Ys()}}function MI(e,t){if(1&e&&(Ks(0,31),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),fa("",i.getAmount(),"/",i.getLimit(),"")}}function DI(e,t){if(1&e&&(Ks(0,32),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),fa("",i.getAmount(),"/",i.getLimit(),"")}}function LI(e,t){if(1&e&&(Ks(0,32),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),da(i.getAmount())}}var xI=function(e){return{greyout:e}};function FI(e,t){if(1&e){var i=qs();zs(0,"span"),zs(1,"span",33),$s("click",function(){Kt(i);var e=ta(2).$implicit;return e.prioritise=!e.prioritise}),js(2,"img",34),Ys(),Ys()}if(2&e){var n=ta(2).$implicit;ho(1),Ws("ngClass",Du(1,xI,!n.prioritise))}}function UI(e,t){if(1&e){var i=qs();zs(0,"div",14),zs(1,"span",15),zs(2,"span",16),zs(3,"span",17),zs(4,"div",18),ha(5),Ys(),js(6,"div",19),js(7,"div",19),Ys(),js(8,"app-icon",20),Ys(),Gs(9,PI,2,0,"button",21),Gs(10,MI,2,2,"ng-container",22),Gs(11,DI,2,2,"ng-container",23),Gs(12,LI,2,1,"ng-container",23),Ys(),zs(13,"span",24),zs(14,"span",25),$s("click",function(){Kt(i);var e=ta().$implicit;return ta(2).openManageModal(e)}),js(15,"img",26),Ys(),Gs(16,FI,3,3,"span",27),zs(17,"span",28),$s("click",function(){Kt(i);var e=ta().$implicit;return ta(2).highlightResource(e)}),js(18,"img",29),Ys(),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta(2);ho(2),Ws("elementId",n.resource),ho(1),ia("id",n.resource),ho(2),da(n.name),ho(1),Ws("innerHTML",r.getResourceDescription(n),dr),ho(1),Ws("innerHTML",r.getResourceConsumers(n),dr),ho(1),Ws("name",n.getName())("path","resources")("title",""),ho(1),Ws("ngIf",r.isDev()),ho(1),Ws("ngIf",n.getAmount()===n.getLimit()),ho(1),Ws("ngIf",r.isNotCoins(n)&&n.getAmount()!==n.getLimit()),ho(1),Ws("ngIf",!r.isNotCoins(n)),ho(2),Ws("ngClass",Du(15,xI,!n.options.isUsed())),ho(2),Ws("ngIf",r.isMarketEnabled()),ho(1),Ws("ngClass",Du(17,xI,!n.highlighted))}}function HI(e,t){if(1&e&&(zs(0,"div"),Gs(1,UI,19,19,"div",13),Ys()),2&e){var i=t.$implicit;ho(1),Ws("ngIf",i.visible)}}function GI(e,t){if(1&e&&(zs(0,"div",10),zs(1,"span",11),ha(2),Ys(),Gs(3,HI,2,1,"div",12),Ys()),2&e){var i=t.$implicit,n=ta();ho(2),da(i),ho(1),Ws("ngForOf",n.getResourcesList(i))}}var BI=function(){var e=function(){function e(t,i,n,r){p(this,e),this.resourcesService=t,this.modalService=i,this.tutorialService=n,this.gameService=r,this.filterText=""}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.categories=Object.keys(Hv),this.categories=[Hv[Hv.RAW],Hv[Hv.PROCESSED],Hv[Hv.FOOD],Hv[Hv.TOOLS]],this.resources=this.resourcesService.getResources(),this.resourcesService.registerForResourcesChange().subscribe(function(t){e.resources=t}),this.tutorialService.checkResourcesTutorial()}},{key:"getResourcesList",value:function(e){var t=this;return Array.from(this.resourcesService.getResources().entries()).filter(function(i){return i[1].getResourceTypes().includes(Hv[e])&&Qv.prepareResourceName(i[1].getResource()).toLowerCase().includes(t.filterText)}).filter(function(e){return!t.resourcesService.getHideEmpty()||0!==e[1].amount||!!t.resourcesService.getResourceProductions(e[0])&&!!t.resourcesService.getResourceUses(e[0])}).map(function(e){return e[1]})}},{key:"openManageModal",value:function(e){this.modalService.open(_v.RESOURCE_MANAGEMENT),this.modalService.setResourceOptions(e.options);var t=this.modalService.registerForResourceOptionsResponse().subscribe(function(i){t.unsubscribe(),i&&(e.options=i)})}},{key:"isMarketEnabled",value:function(){return this.gameService.isEnabled(wv.MARKET)}},{key:"highlightResource",value:function(e){e.highlighted?e.highlighted=!1:(Array.from(this.resourcesService.getResources().values()).filter(function(e){return e.highlighted}),e.highlighted=!0)}},{key:"isNotCoins",value:function(e){return e.resource!==Mv.COINS}},{key:"isDev",value:function(){return!Cp.production}},{key:"addDevRes",value:function(e,t){this.resourcesService.increaseResource(e,e===Mv.COINS?1e3:t.shiftKey?200:5,"Dev",!0)}},{key:"getResourceDescription",value:function(e){var t="";return e.hasResourceType(Hv.CONSUMABLE)&&(t+="nutrition: "+cm.getResource(e.resource).POWER),e.hasResourceType(Hv.FUEL)&&(t+="heating energy: "+cm.getResource(e.resource).POWER),""!==t?"<hr>"+t:t}},{key:"getResourceConsumers",value:function(e){var t="",i="<b>used by:</b><br>",n=this.resourcesService.getResourceUses(e.resource),r=[];n&&(n.slice().forEach(function(e){var t=r.find(function(t){return t[0]===e.userName});t?t[1]+=e.value:r.push([e.userName,e.value])}),r.sort(function(e,t){return e[0].localeCompare(t[0])}).forEach(function(e){i+=e[0]+": "+e[1]+"<br>"})),"<b>used by:</b><br>"!==i&&(t+="<hr>"+i),i="<b>produced by:</b><br>";var o=this.resourcesService.getResourceProductions(e.resource),s=[];return o&&(o.slice().forEach(function(e){var t=s.find(function(t){return t[0]===e.producerName});t?t[1]+=e.value:s.push([e.producerName,e.value])}),s.sort(function(e,t){return e[0].localeCompare(t[0])}).forEach(function(e){i+=e[0]+": "+e[1]+"<br>"})),"<b>produced by:</b><br>"!==i&&(t+="<hr>"+i),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(DE),Bs(Jv),Bs(Nm),Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-resources"]],decls:14,vars:3,consts:[["id","wrapper"],["id","resourcesTitle"],[1,"side"],["id","center"],[1,"inline"],["for","hideEmpty"],["id","hideEmpty","type","checkbox",3,"checked","change"],["type","text","placeholder","filter",3,"ngModel","ngModelChange"],["id","categories"],["class","category",4,"ngFor","ngForOf"],[1,"category"],[1,"title"],[4,"ngFor","ngForOf"],["class","resource",4,"ngIf"],[1,"resource"],[1,"icon"],["appTooltip","",1,"tooltip",3,"elementId"],[3,"id"],[1,"center"],[1,"center",3,"innerHTML"],[3,"name","path","title"],[3,"click",4,"ngIf"],["class","text","class","full",4,"ngIf"],["class","text",4,"ngIf"],[1,"highlight"],[1,"manage",3,"ngClass","click"],["draggable","false","title","management","ondragstart","return false;","src","assets/manage.svg"],[4,"ngIf"],[3,"ngClass","click"],["draggable","false","ondragstart","return false;","src","assets/eye.svg","title","add to header"],[3,"click"],[1,"full"],[1,"text"],[1,"prioritise",3,"ngClass","click"],["draggable","false","ondragstart","return false;","src","assets/trade.svg","title","prioritise on market"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"span",1),js(2,"span",2),zs(3,"span",3),ha(4,"Resources"),Ys(),zs(5,"span",2),zs(6,"span",4),zs(7,"label",5),ha(8,"hide empty"),Ys(),zs(9,"input",6),$s("change",function(){return t.resourcesService.toggleHideEmpty()}),Ys(),Ys(),zs(10,"span",4),zs(11,"input",7),$s("ngModelChange",function(e){return t.filterText=e}),Ys(),Ys(),Ys(),Ys(),zs(12,"div",8),Gs(13,GI,4,2,"div",9),Ys(),Ys()),2&e&&(ho(9),Ws("checked",t.resourcesService.getHideEmpty()),ho(2),Ws("ngModel",t.filterText),ho(2),Ws("ngForOf",t.categories))},directives:[qR,vO,DO,Ul,Gl,sT,oT,xl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em;margin:.7%;text-align:center}#resourcesTitle[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-size:1.3em;font-weight:bolder;vertical-align:middle}#center[_ngcontent-%COMP%]{flex:10 0 auto}.side[_ngcontent-%COMP%]{flex:0 0 38%;flex-direction:row;font-size:.6em;width:15%;margin:3px;display:inline-block}#categories[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:94.8%;text-align:center}.category[_ngcontent-%COMP%]{text-align:left;flex:1 0 0;display:flex;flex-direction:column;border:black solid 1px}.resource[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-left:3px;width:100%;vertical-align:middle;margin-top:-1px}.title[_ngcontent-%COMP%]{text-align:center;padding:2px 0;width:100%;font-weight:bolder;font-size:1em;margin-bottom:5px;display:block;border-bottom:black solid 1px}.highlight[_ngcontent-%COMP%]{flex:1 0 auto;text-align:right;margin-right:3px}.highlight[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer}app-icon[_ngcontent-%COMP%]{flex:0 0 auto;margin-right:3px}.manage[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:22px;width:22px}.greyout[_ngcontent-%COMP%]{opacity:.3}.prioritise[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:22px;width:22px}.full[_ngcontent-%COMP%]{font-weight:600}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}hr[_ngcontent-%COMP%]{border-color:#000}.center[_ngcontent-%COMP%]{text-align:center}"]}),e}(),WI=function(){function e(t,i,n,r,o,s,a,u){var c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:function(){},l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;p(this,e),this.tech=t,this.category=i,this.prerequisites=n,this.flagPrerequisites=r,this.cost=o,this.requiredResearchPoints=s,this.description=a,this.finishDescription=u,this.researchPoints=l,this.finishFunction=c}return S(e,[{key:"getTech",value:function(){return this.tech}},{key:"getTechName",value:function(){return Qv.prepareTechName(this.tech)}},{key:"isResearched",value:function(){return this.researchPoints>=this.requiredResearchPoints&&(this.researchPoints=this.requiredResearchPoints),this.researchPoints===this.requiredResearchPoints}},{key:"getCategory",value:function(){return this.category}},{key:"getDescription",value:function(){return this.description}},{key:"getResearchPointsDue",value:function(){return this.requiredResearchPoints-this.researchPoints}},{key:"addResearchPoints",value:function(e){this.researchPoints+=e,this.researchPoints>this.requiredResearchPoints&&(this.researchPoints=this.requiredResearchPoints)}},{key:"getResearchPoints",value:function(){return this.researchPoints}},{key:"setResearchPoints",value:function(e){this.researchPoints=e}},{key:"setResearched",value:function(){this.researchPoints=this.requiredResearchPoints}},{key:"getCost",value:function(){return this.cost}},{key:"clearCost",value:function(){this.cost=new Map}},{key:"getPrerequisites",value:function(){return this.prerequisites}},{key:"getFlagPrerequisites",value:function(){return this.flagPrerequisites}},{key:"getFinishFunction",value:function(){return this.finishFunction}},{key:"getRequiredResearchPoints",value:function(){return this.requiredResearchPoints}},{key:"getFinishDescription",value:function(){return this.finishDescription}}]),e}(),VI=function(){function e(){p(this,e),this.prerequisites=[],this.flagPrerequisites=[],this.cost=new Map,this.researchPoints=0,this.finishFunction=function(){}}return S(e,[{key:"forTech",value:function(e){return this.tech=e,this}},{key:"withCategory",value:function(e){return this.category=e,this}},{key:"withPrerequisite",value:function(e){return this.prerequisites.push(e),this}},{key:"withPrerequisites",value:function(e){var t=this;return e.forEach(function(e){return t.prerequisites.push(e)}),this}},{key:"withFlagPrerequisite",value:function(e){return this.flagPrerequisites.push(e),this}},{key:"withFlagPrerequisites",value:function(e){var t=this;return e.forEach(function(e){return t.flagPrerequisites.push(e)}),this}},{key:"withCost",value:function(e,t){return this.cost.set(e,t),this}},{key:"withCosts",value:function(e){var t=this;return e.forEach(function(e,i){return t.cost.set(i,e)}),this}},{key:"withResearchPoints",value:function(e){return this.researchPoints=e,this}},{key:"withDescription",value:function(e){return this.description=e,this}},{key:"withFinishDescription",value:function(e){return this.finishDescription=e,this}},{key:"withFinishFunction",value:function(e){return this.finishFunction=e,this}},{key:"build",value:function(){var e=new WI(this.tech,this.category,this.prerequisites,this.flagPrerequisites,this.cost,this.researchPoints,this.description,this.finishDescription,this.finishFunction);return this.tech=void 0,this.category=void 0,this.prerequisites=[],this.flagPrerequisites=[],this.cost=new Map,this.researchPoints=0,this.description=void 0,this.finishDescription=void 0,this.finishFunction=function(){},e}}]),e}(),zI=function(){var e=function(){function e(t,i,n,r,o,s){p(this,e),this.servicesService=t,this.modalService=i,this.resourcesService=n,this.logService=r,this.soundService=o,this.gameService=s,this.techUpdate=new U,this.techList=[],this.techDone=[],this.techQueue=[],this.techStarted=[],this.techQueueSize=1,this.foresight=0,this.showDone=!1,this.servicesService.addService(Zv.RESEARCH,this),this.init()}return S(e,[{key:"init",value:function(){var e=this;this.techList=[];var t=new VI;Object.entries(dm).forEach(function(i){t.forTech(Lv[i[0]]).withCategory(i[1].CATEGORY).withFinishFunction(i[1].FINISH).withResearchPoints(i[1].RESEARCH_POINT).withPrerequisites(i[1].PREREQUISITES).withFlagPrerequisites(i[1].FLAG_PREREQUISITES?i[1].FLAG_PREREQUISITES:[]).withDescription(i[1].DESCRIPTION).withFinishDescription(i[1].FINISH_DESCRIPTION),i[1].COST.forEach(function(e){return t.withCost(e.resource,e.amount)}),e.techList.push(t.build())})}},{key:"isResearched",value:function(e){return null!=this.techDone.find(function(t){return t===e})}},{key:"startResearch",value:function(e){var t=this;if(!this.techQueue.find(function(t){return t.getTech()===e})){var i=this.techList.find(function(t){return t.getTech()===e}),n=!0,r="";if(i.getPrerequisites().forEach(function(e){!t.techDone.includes(e)&&!t.techQueue.find(function(t){return t.getTech()===e})&&(n=!1,r+=Qv.prepareTechName(e)+" not researched!<br>")}),i.getFlagPrerequisites().forEach(function(e){t.gameService.isEnabled(e)||(n=!1,r+=Qv.prepareFlagName(e)+" not unlocked!<br>")}),n){this.modalService.open(_v.RESEARCH_UNLOCK),this.modalService.setTech(this.techList.find(function(t){return t.getTech()===e}));var o=this.modalService.registerForConfirmation().subscribe(function(i){if(o.unsubscribe(),i){var n=t.techList.find(function(t){return t.getTech()===e});if(!t.techStarted.find(function(t){return t[0]===e})){var r=!0,s="";if(Array.from(n.getCost().entries()).forEach(function(e){var i=t.resourcesService.hasResource(e[0],e[1],"Research",!0);0!==i&&(s+="Missing "+i+" "+Qv.prepareResourceName(e[0])+"!<br>",r=!1)}),!r)return void t.modalService.info(s)}var a=!0,u="";if(Array.from(n.getCost().entries()).forEach(function(e){var i=t.resourcesService.hasResource(e[0],e[1],"Research",!0);0!==i&&(u+="Missing "+i+" "+Qv.prepareResourceName(e[0])+"!<br>",a=!1)}),!a)return void t.modalService.info(u);t.resourcesService.decreaseResources(n.getCost(),"Research",!0);var c=t.techList.find(function(t){return t.getTech()===e});c.clearCost(),t.techStarted.find(function(e){return e[0]===c.getTech()})||t.techStarted.push([c.getTech(),c.getResearchPoints()]),t.techQueue.push(c)}})}else this.modalService.info(r)}}},{key:"progressTech",value:function(e){var t=this;this.techQueue.length>0&&(this.techQueue[0].addResearchPoints(e),this.techQueue[0].isResearched()&&(this.logService.log(this.techQueue[0].getTechName()+" researched"),this.soundService.playResearch(),this.techQueue[0].getFinishFunction()(this.servicesService),this.techDone.push(this.techQueue[0].getTech()),this.techStarted=this.techStarted.filter(function(e){return e[0]!==t.techQueue[0].getTech()}),this.techQueue.shift()),this.techUpdate.next())}},{key:"save",value:function(){var e=this,t=[];return this.techQueue.forEach(function(i){t.push(i.getTech());var n=e.techStarted.find(function(e){return e[0]===i.getTech()});n&&(n[1]=i.getResearchPoints())}),{foresight:this.foresight,showDone:this.showDone,techDone:this.techDone,techStarted:this.techStarted,techQueue:t,techQueueSize:this.techQueueSize}}},{key:"getName",value:function(){return"TechService"}},{key:"load",value:function(e){var t=this;this.init(),this.foresight=e.foresight,this.showDone=void 0!==e.showDone&&e.showDone,this.techDone=e.techDone,this.techStarted=e.techStarted,this.techQueueSize=void 0!==e.techQueueSize?e.techQueueSize:1,this.techDone.forEach(function(e){var i=t.techList.find(function(t){return t.getTech()===e});i&&i.setResearched()}),this.techStarted.forEach(function(e){var i=t.techList.find(function(t){return t.getTech()===e[0]});i&&(i.clearCost(),i.setResearchPoints(e[1]))}),this.techQueue=[],e.techQueue?e.techQueue.forEach(function(e){t.techQueue.push(t.techList.find(function(t){return t.getTech()===e}))}):e.currentResearchTech&&this.techQueue.push(this.techList.find(function(t){return t.getTech()===e.currentResearchTech})),this.techDone.includes(Lv.BARRACKS)&&!this.gameService.isEnabled(wv.BARRACKS)&&(this.gameService.enable(wv.BARRACKS),this.logService.log("Barracks invented")),this.techDone.includes(Lv.COPPER_TOOLS)&&this.servicesService.getRecipeService().enable(ip.COPPER_NAILS),this.techDone.includes(Lv.BRONZE_TOOLS)&&this.servicesService.getRecipeService().enable(ip.BRONZE_NAILS),this.techDone.includes(Lv.IRON_TOOLS)&&this.servicesService.getRecipeService().enable(ip.IRON_NAILS)}},{key:"reset",value:function(e,t){this.techList=[],this.techDone=[],this.techStarted=[],this.techQueue=[],this.techQueueSize=1,this.foresight=0,this.showDone=!1,this.init()}},{key:"getTech",value:function(){var e=this;return this.techList.filter(function(t){if(e.techDone.includes(t.getTech()))return e.showDone;var i=!0;return t.getPrerequisites().forEach(function(t){e.checkPrerequisite(t,e.foresight)||(i=!1)}),i})}},{key:"checkPrerequisite",value:function(e,t){var i=this;if(this.techDone.includes(e))return!0;if(t>0){var n=!0;return this.techList.find(function(t){return t.getTech()===e}).getPrerequisites().forEach(function(e){i.checkPrerequisite(e,t-1)||(n=!1)}),n}return!1}},{key:"getCurrentResearch",value:function(){return this.techQueue.length>0?this.techQueue[0]:null}},{key:"increaseForesight",value:function(e){this.foresight+=e}},{key:"isResearchStarted",value:function(){return this.techQueue.length>0}},{key:"getTechPrerequisites",value:function(e){var t=this,i=[];return e.getPrerequisites().forEach(function(e){t.techDone.includes(e)||i.push(e)}),i}},{key:"registerForUpdate",value:function(){return this.techUpdate.asObservable()}},{key:"getForesight",value:function(){return this.foresight}},{key:"getTechFlagPrerequisites",value:function(e){var t=this,i=[];return e.getFlagPrerequisites().forEach(function(e){t.gameService.isEnabled(e)||i.push(e)}),i}},{key:"finishTech",value:function(e){this.techDone.push(e);var t=this.techList.find(function(t){return t.getTech()===e});t&&(this.logService.log(t.getTechName()+" researched"),t.setResearchPoints(t.getRequiredResearchPoints()),t.getFinishFunction()(this.servicesService)),this.techQueue=this.techQueue.filter(function(t){return t.getTech()!==e}),this.techUpdate.next()}},{key:"toggleShowDone",value:function(){this.showDone=!this.showDone}},{key:"shouldShowDone",value:function(){return this.showDone}},{key:"getTechQueue",value:function(){return this.techQueue}},{key:"removeFromQueue",value:function(e){var t=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Remove research from the queue?");var i=this.modalService.registerForConfirmation().subscribe(function(n){i.unsubscribe(),n&&function(){var i=t.techStarted.find(function(t){return t[0]===e.getTech()});i?i[1]=e.getResearchPoints():t.techStarted.push([e.getTech(),e.getResearchPoints()]),t.techQueue.splice(t.techQueue.indexOf(e),1);var n=null;do{n&&(t.techQueue.splice(t.techQueue.indexOf(n),1),n=null),t.techQueue.forEach(function(e){if(null===n){var i=t.techList.find(function(t){return t.getTech()===e.getTech()}),r=!0;i.getPrerequisites().forEach(function(e){!t.techDone.includes(e)&&!t.techQueue.find(function(t){return t.getTech()===e})&&(r=!1)}),i.getFlagPrerequisites().forEach(function(e){t.gameService.isEnabled(e)||(r=!1)}),r||(n=e)}})}while(null!==n)}()})}},{key:"increaseTechQueueSize",value:function(){this.techQueueSize+=1}},{key:"getTechQueueSize",value:function(){return this.techQueueSize}},{key:"hasQueueSpace",value:function(){return this.getTechQueue().length<this.techQueueSize+this.foresight}},{key:"getTechDone",value:function(){return this.techDone}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Jv),An(DE),An(Cm),An(Tm),An(_m))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),YI=["progress"];function jI(e,t){if(1&e&&(zs(0,"div",3),js(1,"div",4,5),zs(3,"div",6),ha(4),Ys(),zs(5,"span",7),ha(6),js(7,"br"),Ys(),Ys()),2&e){var i=ta();Ws("elementId",i.id),ho(4),da(i.tech.getTechName()),ho(1),ia("id",i.id),ho(1),ga(" ",i.tech.getFinishDescription(),"")}}function KI(e,t){1&e&&(zs(0,"div",10),ha(1,"Cost:"),js(2,"br"),Ys())}function QI(e,t){if(1&e&&(Ks(0),zs(1,"div"),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function qI(e,t){if(1&e&&(Ks(0),zs(1,"div",17),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function XI(e,t){if(1&e&&(zs(0,"div",14),Gs(1,QI,3,1,"ng-container",15),Gs(2,qI,3,1,"ng-container",15),js(3,"app-icon",16),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("ngIf",n.hasResource(i)),ho(1),Ws("ngIf",!n.hasResource(i)),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function ZI(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),ga(" ",n.getPrerequisiteName(i)," ")}}function $I(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),ga(" ",n.getFlagPrerequisiteName(i)," ")}}function JI(e,t){if(1&e&&(zs(0,"div",18),zs(1,"div",10),ha(2,"Prerequisites:"),js(3,"br"),Ys(),Gs(4,ZI,2,1,"div",19),Gs(5,$I,2,1,"div",19),Ys()),2&e){var i=ta(2);ho(4),Ws("ngForOf",i.getMissingPrerequisites()),ho(1),Ws("ngForOf",i.getMissingFlagPrerequisites())}}function eb(e,t){if(1&e){var i=qs();zs(0,"div",8),$s("click",function(){return Kt(i),ta().start()}),js(1,"div",9,5),zs(3,"div",6),ha(4),Ys(),zs(5,"span",7),ha(6),js(7,"br"),js(8,"hr"),zs(9,"div",10),ha(10),Ys(),Gs(11,KI,3,0,"div",11),Gs(12,XI,4,4,"div",12),Hu(13,"keyvalue"),Gs(14,JI,6,2,"div",13),Ys(),Ys()}if(2&e){var n=ta();Ws("elementId",n.id),ho(4),da(n.tech.getTechName()),ho(1),ia("id",n.id),ho(1),ga(" ",n.tech.getDescription(),""),ho(4),fa("Research points: ",n.tech.getResearchPoints(),"/",n.tech.getRequiredResearchPoints(),""),ho(1),Ws("ngIf",n.tech.getCost().size>0),ho(1),Ws("ngForOf",Gu(13,9,n.tech.getCost())),ho(2),Ws("ngIf",n.getMissingPrerequisites().length>0||n.getMissingFlagPrerequisites().length>0)}}function tb(e,t){1&e&&(zs(0,"div",10),ha(1,"Cost:"),js(2,"br"),Ys())}function ib(e,t){if(1&e&&(Ks(0),zs(1,"div"),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function nb(e,t){if(1&e&&(Ks(0),zs(1,"div",17),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function rb(e,t){if(1&e&&(zs(0,"div",14),Gs(1,ib,3,1,"ng-container",15),Gs(2,nb,3,1,"ng-container",15),js(3,"app-icon",16),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("ngIf",n.hasResource(i)),ho(1),Ws("ngIf",!n.hasResource(i)),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function ob(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),ga(" ",n.getPrerequisiteName(i)," ")}}function sb(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),ga(" ",n.getFlagPrerequisiteName(i)," ")}}function ab(e,t){if(1&e&&(zs(0,"div",18),zs(1,"div",10),ha(2,"Prerequisites:"),js(3,"br"),Ys(),Gs(4,ob,2,1,"div",19),Gs(5,sb,2,1,"div",19),Ys()),2&e){var i=ta(2);ho(4),Ws("ngForOf",i.getMissingPrerequisites()),ho(1),Ws("ngForOf",i.getMissingFlagPrerequisites())}}function ub(e,t){if(1&e){var i=qs();zs(0,"div",20),$s("click",function(){return Kt(i),ta().start()}),zs(1,"div",21),ha(2),Ys(),zs(3,"span",7),ha(4),js(5,"br"),js(6,"hr"),zs(7,"div",10),ha(8),Ys(),Gs(9,tb,3,0,"div",11),Gs(10,rb,4,4,"div",12),Hu(11,"keyvalue"),Gs(12,ab,6,2,"div",13),Ys(),Ys()}if(2&e){var n=ta();Ws("elementId",n.id),ho(2),da(n.tech.getTechName()),ho(1),ia("id",n.id),ho(1),ga(" ",n.tech.getDescription(),""),ho(4),fa("Research points: ",n.tech.getResearchPoints(),"/",n.tech.getRequiredResearchPoints(),""),ho(1),Ws("ngIf",n.tech.getCost().size>0),ho(1),Ws("ngForOf",Gu(11,9,n.tech.getCost())),ho(2),Ws("ngIf",n.getMissingPrerequisites().length>0||n.getMissingFlagPrerequisites().length>0)}}var cb=function(){var e=function(){function e(t,i){p(this,e),this.techService=t,this.resourcesService=i,this.id=e.randomId()}return S(e,[{key:"ngOnDestroy",value:function(){this.updateSubscription&&this.updateSubscription.unsubscribe()}},{key:"ngOnInit",value:function(){var e=this;this.updateSubscription=this.techService.registerForUpdate().subscribe(function(){e.progressRef&&(e.progressRef.nativeElement.style.width=e.tech.getResearchPoints()/e.tech.getRequiredResearchPoints()*100+"%")})}},{key:"ngAfterViewInit",value:function(){this.progressRef&&(this.progressRef.nativeElement.style.width=this.tech.getResearchPoints()/this.tech.getRequiredResearchPoints()*100+"%")}},{key:"ngOnChanges",value:function(){this.progressRef&&(this.progressRef.nativeElement.style.width=this.tech.getResearchPoints()/this.tech.getRequiredResearchPoints()*100+"%")}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"start",value:function(){this.techService.startResearch(this.tech.getTech())}},{key:"getPrerequisiteName",value:function(e){return Qv.prepareTechName(e)}},{key:"getMissingPrerequisites",value:function(){return this.techService.getTechPrerequisites(this.tech)}},{key:"hasResource",value:function(e){return 0===this.resourcesService.hasResource(e.key,e.value,"Research",!0)}},{key:"getMissingFlagPrerequisites",value:function(){return this.techService.getTechFlagPrerequisites(this.tech)}},{key:"getFlagPrerequisiteName",value:function(e){return Qv.prepareFlagName(e)}}],[{key:"randomId",value:function(){return Math.random()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(zI),Bs(DE))},e.\u0275cmp=it({type:e,selectors:[["app-tech"]],viewQuery:function(e,t){var i;(1&e&&rc(YI,5),2&e)&&(nc(i=sc())&&(t.progressRef=i.first))},inputs:{tech:"tech"},features:[Rt],decls:3,vars:3,consts:[["id","researched","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapper","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","researched","appTooltip","",1,"tooltip",3,"elementId"],["id","finished"],["progress",""],["id","text"],[3,"id"],["id","wrapper","appTooltip","",1,"tooltip",3,"elementId","click"],["id","progress"],[1,"title"],["class","title",4,"ngIf"],["class","icon",4,"ngFor","ngForOf"],["class","prerequisites",4,"ngIf"],[1,"icon"],[4,"ngIf"],[3,"name","path"],[1,"notMet"],[1,"prerequisites"],[4,"ngFor","ngForOf"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"elementId","click"],["id","titleGrey"]],template:function(e,t){1&e&&(Gs(0,jI,8,4,"div",0),Gs(1,eb,15,11,"div",1),Gs(2,ub,13,11,"div",2)),2&e&&(Ws("ngIf",t.tech.isResearched()),ho(1),Ws("ngIf",0===t.getMissingPrerequisites().length&&!t.tech.isResearched()),ho(1),Ws("ngIf",t.getMissingPrerequisites().length>0&&!t.tech.isResearched()))},directives:[Gl,sT,Ul,oT],pipes:[Xl],styles:["#wrapper[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:black solid 1px}#researched[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;cursor:auto;cursor:initial;border:black solid 1px}#wrapperNotAvailable[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:#57575a solid 1px}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#57575a}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#finished[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e}();function lb(e,t){if(1&e){var i=qs();zs(0,"app-tech",12),$s("click",function(){var e=Kt(i).$implicit;return ta(2).removeFromQueue(e)}),Ys()}2&e&&Ws("tech",t.$implicit)}function hb(e,t){if(1&e&&(zs(0,"span"),zs(1,"div",10),Gs(2,lb,1,1,"app-tech",11),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getTechQueue())}}function db(e,t){1&e&&(zs(0,"span"),ha(1,"nothing"),Ys())}function gb(e,t){if(1&e){var i=qs();zs(0,"button",13),$s("click",function(){return Kt(i),ta().research(10)}),ha(1,"Research"),Ys()}}function fb(e,t){1&e&&(zs(0,"span",14),ha(1,"No workshop set to research."),Ys())}function vb(e,t){if(1&e){var i=qs();zs(0,"button",15),$s("click",function(){return Kt(i),ta().showDone()}),ha(1,"show finished"),Ys()}}function pb(e,t){if(1&e){var i=qs();zs(0,"button",15),$s("click",function(){return Kt(i),ta().showDone()}),ha(1,"hide finished"),Ys()}}function mb(e,t){1&e&&js(0,"app-tech",20),2&e&&Ws("tech",t.$implicit)}function Sb(e,t){if(1&e&&(zs(0,"div",16),zs(1,"span",17),ha(2),Ys(),zs(3,"span",18),Gs(4,mb,1,1,"app-tech",19),Ys(),Ys()),2&e){var i=t.$implicit,n=ta();ho(2),da(i),ho(2),Ws("ngForOf",n.getTechList(i))}}var Eb=function(){var e=function(){function e(t,i){p(this,e),this.techService=t,this.villageService=i}return S(e,[{key:"ngOnInit",value:function(){this.categories=Object.keys(np),this.categories=this.categories.slice(this.categories.length/2)}},{key:"getTechList",value:function(e){return this.techService.getTech().filter(function(t){return t.getCategory()===np[e]})}},{key:"getCurrentResearch",value:function(){return this.techService.getCurrentResearch()}},{key:"research",value:function(e){this.techService.progressTech(e)}},{key:"isDev",value:function(){return!Cp.production}},{key:"getForesight",value:function(){return this.techService.getForesight()}},{key:"isResearcher",value:function(){return this.villageService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).map(function(e){return e}).filter(function(e){return e.willResearch()}).length>0}},{key:"shouldShowDone",value:function(){return this.techService.shouldShowDone()}},{key:"showDone",value:function(){this.techService.toggleShowDone()}},{key:"getTechQueue",value:function(){return this.techService.getTechQueue()}},{key:"removeFromQueue",value:function(e){this.techService.removeFromQueue(e)}},{key:"getTechQueueSize",value:function(){return this.techService.getTechQueueSize()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(zI),Bs(MR))},e.\u0275cmp=it({type:e,selectors:[["app-research"]],decls:14,vars:11,consts:[["id","wrapper"],["id","researching"],[4,"ngIf"],[3,"click",4,"ngIf"],[1,"icon"],[3,"name"],["id","noResearchers",4,"ngIf"],["class","showHiddenButton",3,"click",4,"ngIf"],["id","categories"],["class","category",4,"ngFor","ngForOf"],["id","techQueue"],["class","techQueueEntry",3,"tech","click",4,"ngFor","ngForOf"],[1,"techQueueEntry",3,"tech","click"],[3,"click"],["id","noResearchers"],[1,"showHiddenButton",3,"click"],[1,"category"],[1,"title"],["id","categoryBody"],["class","tech",3,"tech",4,"ngFor","ngForOf"],[1,"tech",3,"tech"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),ha(2),Gs(3,hb,3,1,"span",2),Gs(4,db,2,0,"span",2),Gs(5,gb,2,0,"button",3),Ys(),zs(6,"div",4),js(7,"app-icon",5),ha(8),Gs(9,fb,2,0,"span",6),Gs(10,vb,2,0,"button",7),Gs(11,pb,2,0,"button",7),Ys(),zs(12,"div",8),Gs(13,Sb,5,2,"div",9),Ys(),Ys()),2&e&&(ho(2),fa(" Research queue (",t.getTechQueue().length,"/",t.getTechQueueSize()+t.getForesight(),"): \xa0 "),ho(1),Ws("ngIf",t.getCurrentResearch()),ho(1),Ws("ngIf",!t.getCurrentResearch()),ho(1),Ws("ngIf",t.isDev()),ho(2),Ws("name","foresight"),ho(1),ga("\xa0",t.getForesight()," "),ho(1),Ws("ngIf",!t.isResearcher()),ho(1),Ws("ngIf",!t.shouldShowDone()),ho(1),Ws("ngIf",t.shouldShowDone()),ho(2),Ws("ngForOf",t.categories))},directives:[Gl,oT,Ul,cb],styles:["#wrapper[_ngcontent-%COMP%]{margin:.7%;height:100%}#categories[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;border:black solid 1px;height:86%;width:100%;text-align:center}.category[_ngcontent-%COMP%]{text-align:center;flex:0 0 19.75%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}#categoryBody[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden}.title[_ngcontent-%COMP%]{padding:2px;width:100%;font-weight:bolder;font-size:1em;margin-bottom:5px;display:block;border-bottom:black solid 1px}app-tech[_ngcontent-%COMP%]{display:inline-block;margin-bottom:4px;margin-top:4px;margin-left:-4px;width:75%;font-size:.7em}#researching[_ngcontent-%COMP%]{margin-bottom:8px}#currentTech[_ngcontent-%COMP%]{display:inline-block;width:auto;margin-right:10px}.tech[_ngcontent-%COMP%]{cursor:pointer}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#noResearchers[_ngcontent-%COMP%]{margin-left:175px;color:var(--negative-colour)}.showHiddenButton[_ngcontent-%COMP%]{font-size:.8em;padding:4px;margin-left:auto}#techQueue[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row}.techQueueEntry[_ngcontent-%COMP%]{width:110px;margin-right:20px;cursor:pointer}"]}),e}(),yb=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){return p(this,i),t.call(this,n,e,r,s,o,Yv.FOREST,Zv.FOREST)}return S(i,[{key:"init",value:function(){var e=this;this.buildings.push(new xE(this.servicesService,this.idService.getNextId()).build()),this.buildings.push(new YE(this.servicesService,this.idService.getNextId()).build()),this.buildings.forEach(function(t){return e.landService.takeLand(t.getSize())})}}]),i}(vE);return e.\u0275fac=function(t){return new(t||e)(An(DE),An(PR),An($v),An(wR),An(wm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Rb(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Demolish"),Ys()}}function Ob(e,t){if(1&e){var i=qs();zs(0,"button",22),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Stop"),Ys()}}function Tb(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Arrange"),Ys()}}function Ib(e,t){if(1&e){var i=qs();zs(0,"button",22),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Stop"),Ys()}}function bb(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Combine"),Ys()}}function Cb(e,t){if(1&e){var i=qs();zs(0,"button",22),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Stop"),Ys()}}function Ab(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Split"),Ys()}}function kb(e,t){if(1&e){var i=qs();zs(0,"button",22),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Stop"),Ys()}}function Nb(e,t){if(1&e&&(zs(0,"option",13),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("value",i),ho(1),da(n.getBuildingName(i))}}function _b(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta();ho(1),da(i.getForestSize())}}function wb(e,t){if(1&e&&(zs(0,"span",23),ha(1),Ys()),2&e){var i=ta();ho(1),da(i.getForestSize())}}function Pb(e,t){if(1&e&&(zs(0,"span",28),js(1,"app-building",29),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.forestService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function Mb(e,t){if(1&e&&(zs(0,"div",24),zs(1,"div",25),zs(2,"span"),ha(3,"Buildings"),Ys(),Ys(),zs(4,"div",26),Gs(5,Pb,2,6,"span",27),Ys(),Ys()),2&e){var i=ta();ho(5),Ws("ngForOf",i.getBuildings())}}var Db=function(e){return{activePage:e}};function Lb(e,t){if(1&e){var i=qs();zs(0,"span",32),$s("click",function(){var e=Kt(i).$implicit;return ta(2).setPage(e)}),ha(1),Ys()}if(2&e){var n=t.$implicit,r=ta(2);Ws("ngClass",Du(2,Db,r.currentPage===n)),ho(1),ga("page ",n+1,"")}}function xb(e,t){if(1&e&&(zs(0,"span",28),js(1,"app-building",29),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.forestService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function Fb(e,t){if(1&e&&(zs(0,"div",24),zs(1,"div",30),Gs(2,Lb,2,4,"span",31),Ys(),zs(3,"div",26),Gs(4,xb,2,6,"span",27),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getPagesNumber()),ho(2),Ws("ngForOf",i.getPagedBuildings())}}var Ub=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u){var c;return p(this,i),(c=t.call(this,e,n,r,s,o,a,u,Yv.FOREST)).landService=n,c.forestService=s,c}return S(i,[{key:"getForestSize",value:function(){return this.landService.getForest()}}]),i}(pE);return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(Nm),Bs(yb),Bs(Om),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-forest"]],features:[bs],decls:52,vars:27,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name"],[4,"ngIf"],["class","critical",4,"ngIf"],[3,"name","title","margin"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"critical"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"button",4),$s("click",function(){return t.openBuildModal()}),ha(6,"Build"),Ys(),Gs(7,Rb,2,0,"button",5),Gs(8,Ob,2,0,"button",6),Gs(9,Tb,2,0,"button",5),Gs(10,Ib,2,0,"button",6),Gs(11,bb,2,0,"button",5),Gs(12,Cb,2,0,"button",6),Gs(13,Ab,2,0,"button",5),Gs(14,kb,2,0,"button",6),zs(15,"button",7),ha(16,"Actions "),js(17,"img",8),zs(18,"ul",9),zs(19,"li",4),$s("click",function(){return t.autoSort()}),ha(20,"Sort"),Ys(),Ys(),Ys(),zs(21,"div",10),ha(22," Filter:"),js(23,"br"),zs(24,"div",11),zs(25,"select",12),$s("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),zs(26,"option",13),ha(27),Ys(),Gs(28,Nb,2,2,"option",14),Ys(),zs(29,"select",12),$s("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),zs(30,"option",13),ha(31,"All"),Ys(),zs(32,"option",13),ha(33,"Working"),Ys(),zs(34,"option",13),ha(35,"Idle"),Ys(),Ys(),Ys(),Ys(),Ys(),zs(36,"div",15),js(37,"app-icon",16),Gs(38,_b,2,1,"span",17),Gs(39,wb,2,1,"span",18),ha(40," \xa0\xa0 "),js(41,"app-icon",19),ha(42),js(43,"app-icon",16),ha(44),zs(45,"div",20),zs(46,"button",4),$s("click",function(){return t.enableAll()}),ha(47,"all on"),Ys(),zs(48,"button",4),$s("click",function(){return t.disableAll()}),ha(49,"all off"),Ys(),Ys(),Ys(),Gs(50,Mb,6,1,"div",21),Gs(51,Fb,5,2,"div",21),Ys(),Ys()),2&e&&(ho(7),Ws("ngIf",!t.demolishMode),ho(1),Ws("ngIf",t.demolishMode),ho(1),Ws("ngIf",!t.arrangeMode),ho(1),Ws("ngIf",t.arrangeMode),ho(1),Ws("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),ho(1),Ws("ngIf",t.combineMode),ho(1),Ws("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),ho(1),Ws("ngIf",t.splitMode),ho(11),Ws("ngModel",t.filterBuilding),ho(1),Ws("value",t.allBuildings),ho(1),da(t.getBuildingName(t.allBuildings)),ho(1),Ws("ngForOf",t.getUniqueBuildingsFromCurrentView()),ho(1),Ws("ngModel",t.filterWorking),ho(1),Ws("value",t.buildingStates.ALL),ho(2),Ws("value",t.buildingStates.WORKING),ho(2),Ws("value",t.buildingStates.IDLE),ho(3),Ws("name","forest"),ho(1),Ws("ngIf",t.getForestSize()>=400),ho(1),Ws("ngIf",t.getForestSize()<400),ho(2),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga(" ",t.getUnemployed()," \xa0\xa0\xa0 "),ho(1),Ws("name","land"),ho(1),ga(" ",t.getFreeLand()," "),ho(6),Ws("ngIf",!t.isPagedViewEnabled()),ho(1),Ws("ngIf",t.isPagedViewEnabled()))},directives:[GR,Gl,YO,vO,DO,jO,XO,Ul,oT,hI,xl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",".critical[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e}(),Hb=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){return p(this,i),t.call(this,n,e,r,s,o,Yv.FIELD,Zv.FIELD)}return i}(vE);return e.\u0275fac=function(t){return new(t||e)(An(DE),An(PR),An($v),An(wR),An(wm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Gb(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Demolish"),Ys()}}function Bb(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Stop"),Ys()}}function Wb(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Arrange"),Ys()}}function Vb(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Stop"),Ys()}}function zb(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Combine"),Ys()}}function Yb(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Stop"),Ys()}}function jb(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Split"),Ys()}}function Kb(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Stop"),Ys()}}function Qb(e,t){if(1&e&&(zs(0,"option",13),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("value",i),ho(1),da(n.getBuildingName(i))}}function qb(e,t){if(1&e&&(zs(0,"span",25),js(1,"app-building",26),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.fieldService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function Xb(e,t){if(1&e&&(zs(0,"div",21),zs(1,"div",22),zs(2,"span"),ha(3,"Buildings"),Ys(),Ys(),zs(4,"div",23),Gs(5,qb,2,6,"span",24),Ys(),Ys()),2&e){var i=ta();ho(5),Ws("ngForOf",i.getBuildings())}}var Zb=function(e){return{activePage:e}};function $b(e,t){if(1&e){var i=qs();zs(0,"span",29),$s("click",function(){var e=Kt(i).$implicit;return ta(2).setPage(e)}),ha(1),Ys()}if(2&e){var n=t.$implicit,r=ta(2);Ws("ngClass",Du(2,Zb,r.currentPage===n)),ho(1),ga("page ",n+1,"")}}function Jb(e,t){if(1&e&&(zs(0,"span",25),js(1,"app-building",26),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.fieldService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function eC(e,t){if(1&e&&(zs(0,"div",21),zs(1,"div",27),Gs(2,$b,2,4,"span",28),Ys(),zs(3,"div",23),Gs(4,Jb,2,6,"span",24),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getPagesNumber()),ho(2),Ws("ngForOf",i.getPagedBuildings())}}var tC=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u){var c;return p(this,i),(c=t.call(this,e,n,r,s,o,a,u,Yv.FIELD)).landService=n,c.fieldService=s,c}return i}(pE);return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(Nm),Bs(Hb),Bs(Om),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-field"]],features:[bs],decls:50,vars:24,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"button",4),$s("click",function(){return t.openBuildModal()}),ha(6,"Build"),Ys(),Gs(7,Gb,2,0,"button",5),Gs(8,Bb,2,0,"button",6),Gs(9,Wb,2,0,"button",5),Gs(10,Vb,2,0,"button",6),Gs(11,zb,2,0,"button",5),Gs(12,Yb,2,0,"button",6),Gs(13,jb,2,0,"button",5),Gs(14,Kb,2,0,"button",6),zs(15,"button",7),ha(16,"Actions "),js(17,"img",8),zs(18,"ul",9),zs(19,"li",4),$s("click",function(){return t.autoSort()}),ha(20,"Sort"),Ys(),zs(21,"li",4),$s("click",function(){return t.autoMerge()}),ha(22,"Merge"),Ys(),Ys(),Ys(),zs(23,"div",10),ha(24," Filter:"),js(25,"br"),zs(26,"div",11),zs(27,"select",12),$s("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),zs(28,"option",13),ha(29),Ys(),Gs(30,Qb,2,2,"option",14),Ys(),zs(31,"select",12),$s("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),zs(32,"option",13),ha(33,"All"),Ys(),zs(34,"option",13),ha(35,"Working"),Ys(),zs(36,"option",13),ha(37,"Idle"),Ys(),Ys(),Ys(),Ys(),Ys(),zs(38,"div",15),js(39,"app-icon",16),ha(40),js(41,"app-icon",17),ha(42),zs(43,"div",18),zs(44,"button",4),$s("click",function(){return t.enableAll()}),ha(45,"all on"),Ys(),zs(46,"button",4),$s("click",function(){return t.disableAll()}),ha(47,"all off"),Ys(),Ys(),Ys(),Gs(48,Xb,6,1,"div",19),Gs(49,eC,5,2,"div",19),Ys(),Ys()),2&e&&(ho(7),Ws("ngIf",!t.demolishMode),ho(1),Ws("ngIf",t.demolishMode),ho(1),Ws("ngIf",!t.arrangeMode&&t.getBuildings().length>1),ho(1),Ws("ngIf",t.arrangeMode),ho(1),Ws("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),ho(1),Ws("ngIf",t.combineMode),ho(1),Ws("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),ho(1),Ws("ngIf",t.splitMode),ho(13),Ws("ngModel",t.filterBuilding),ho(1),Ws("value",t.allBuildings),ho(1),da(t.getBuildingName(t.allBuildings)),ho(1),Ws("ngForOf",t.getUniqueBuildingsFromCurrentView()),ho(1),Ws("ngModel",t.filterWorking),ho(1),Ws("value",t.buildingStates.ALL),ho(2),Ws("value",t.buildingStates.WORKING),ho(2),Ws("value",t.buildingStates.IDLE),ho(3),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga(" ",t.getUnemployed()," \xa0\xa0\xa0 "),ho(1),Ws("name","land"),ho(1),ga(" ",t.getFreeLand()," "),ho(6),Ws("ngIf",!t.isPagedViewEnabled()),ho(1),Ws("ngIf",t.isPagedViewEnabled()))},directives:[GR,Gl,YO,vO,DO,jO,XO,Ul,oT,hI,xl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",""]}),e}(),iC=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a){var u;return p(this,i),(u=t.call(this,n,e,r,s,o,Yv.MOUNTAINS,Zv.MOUNTAINS)).logService=a,u}return S(i,[{key:"addMeteorite",value:function(){var e=sp.randomElement([{item:Mv.STONE,chance:35},{item:Mv.COPPER_ORE,chance:30},{item:Mv.TIN_ORE,chance:20},{item:Mv.GOLD_ORE,chance:5},{item:Mv.SILVER_ORE,chance:5},{item:Mv.IRON_ORE,chance:5}]);null===e&&(e=Mv.STONE),this.buildings.push(new gR(this.servicesService,this.idService.getNextId(),sp.randomBetween(100,200),e)),this.logService.success("Old meteorite found in the mountains!")}}]),i}(vE);return e.\u0275fac=function(t){return new(t||e)(An(DE),An(PR),An($v),An(wR),An(wm),An(Cm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function nC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Demolish"),Ys()}}function rC(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Stop"),Ys()}}function oC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Arrange"),Ys()}}function sC(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Stop"),Ys()}}function aC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Combine"),Ys()}}function uC(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Stop"),Ys()}}function cC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Split"),Ys()}}function lC(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Stop"),Ys()}}function hC(e,t){if(1&e&&(zs(0,"option",13),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("value",i),ho(1),da(n.getBuildingName(i))}}function dC(e,t){if(1&e&&(zs(0,"span",22),ha(1," \xa0\xa0\xa0 "),js(2,"app-icon",23),ha(3),Ys()),2&e){var i=ta();ho(2),Ws("name","coal")("path","resources")("title","coal deposit"),ho(1),ga(": ",i.getCoal()," ")}}function gC(e,t){if(1&e&&(zs(0,"span",22),ha(1," \xa0\xa0\xa0 "),js(2,"app-icon",23),ha(3),Ys()),2&e){var i=ta();ho(2),Ws("name","gold_ore")("path","resources")("title","gold deposit"),ho(1),ga(": ",i.getGoldOre()," ")}}function fC(e,t){if(1&e&&(zs(0,"span",22),ha(1," \xa0\xa0\xa0 "),js(2,"app-icon",23),ha(3),Ys()),2&e){var i=ta();ho(2),Ws("name","silver_ore")("path","resources")("title","silver deposit"),ho(1),ga(": ",i.getSilverOre()," ")}}function vC(e,t){if(1&e&&(zs(0,"span",22),ha(1," \xa0\xa0\xa0 "),js(2,"app-icon",23),ha(3),Ys()),2&e){var i=ta();ho(2),Ws("name","copper_ore")("path","resources")("title","copper deposit"),ho(1),ga(": ",i.getCopperOre()," ")}}function pC(e,t){if(1&e&&(zs(0,"span",22),ha(1," \xa0\xa0\xa0 "),js(2,"app-icon",23),ha(3),Ys()),2&e){var i=ta();ho(2),Ws("name","tin_ore")("path","resources")("title","tin deposit"),ho(1),ga(": ",i.getTinOre()," ")}}function mC(e,t){if(1&e&&(zs(0,"span",22),ha(1," \xa0\xa0\xa0 "),js(2,"app-icon",23),ha(3),Ys()),2&e){var i=ta();ho(2),Ws("name","iron_ore")("path","resources")("title","iron deposit"),ho(1),ga(": ",i.getIronOre()," ")}}function SC(e,t){if(1&e&&(zs(0,"span",28),js(1,"app-building",29),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.mountainsService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function EC(e,t){if(1&e&&(zs(0,"div",24),zs(1,"div",25),zs(2,"span"),ha(3,"Buildings"),Ys(),Ys(),zs(4,"div",26),Gs(5,SC,2,6,"span",27),Ys(),Ys()),2&e){var i=ta();ho(5),Ws("ngForOf",i.getBuildings())}}var yC=function(e){return{activePage:e}};function RC(e,t){if(1&e){var i=qs();zs(0,"span",32),$s("click",function(){var e=Kt(i).$implicit;return ta(2).setPage(e)}),ha(1),Ys()}if(2&e){var n=t.$implicit,r=ta(2);Ws("ngClass",Du(2,yC,r.currentPage===n)),ho(1),ga("page ",n+1,"")}}function OC(e,t){if(1&e&&(zs(0,"span",28),js(1,"app-building",29),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.mountainsService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function TC(e,t){if(1&e&&(zs(0,"div",24),zs(1,"div",30),Gs(2,RC,2,4,"span",31),Ys(),zs(3,"div",26),Gs(4,OC,2,6,"span",27),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getPagesNumber()),ho(2),Ws("ngForOf",i.getPagedBuildings())}}var IC=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u){var c;return p(this,i),(c=t.call(this,e,n,r,s,o,a,u,Yv.MOUNTAINS)).landService=n,c.mountainsService=s,c}return S(i,[{key:"getMountains",value:function(){return this.landService.getMountains()}},{key:"getCoal",value:function(){return this.landService.getOre(Mv.COAL)}},{key:"getGoldOre",value:function(){return this.landService.getOre(Mv.GOLD_ORE)}},{key:"getSilverOre",value:function(){return this.landService.getOre(Mv.SILVER_ORE)}},{key:"getCopperOre",value:function(){return this.landService.getOre(Mv.COPPER_ORE)}},{key:"getTinOre",value:function(){return this.landService.getOre(Mv.TIN_ORE)}},{key:"getIronOre",value:function(){return this.landService.getOre(Mv.IRON_ORE)}}]),i}(pE);return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(Nm),Bs(iC),Bs(Om),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-mountains"]],features:[bs],decls:56,vars:32,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name"],[3,"name","title","margin"],["class","deposit",4,"ngIf"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"deposit"],[3,"name","path","title"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"button",4),$s("click",function(){return t.openBuildModal()}),ha(6,"Build"),Ys(),Gs(7,nC,2,0,"button",5),Gs(8,rC,2,0,"button",6),Gs(9,oC,2,0,"button",5),Gs(10,sC,2,0,"button",6),Gs(11,aC,2,0,"button",5),Gs(12,uC,2,0,"button",6),Gs(13,cC,2,0,"button",5),Gs(14,lC,2,0,"button",6),zs(15,"button",7),ha(16,"Actions "),js(17,"img",8),zs(18,"ul",9),zs(19,"li",4),$s("click",function(){return t.autoSort()}),ha(20,"Sort"),Ys(),Ys(),Ys(),zs(21,"div",10),ha(22," Filter:"),js(23,"br"),zs(24,"div",11),zs(25,"select",12),$s("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),zs(26,"option",13),ha(27),Ys(),Gs(28,hC,2,2,"option",14),Ys(),zs(29,"select",12),$s("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),zs(30,"option",13),ha(31,"All"),Ys(),zs(32,"option",13),ha(33,"Working"),Ys(),zs(34,"option",13),ha(35,"Idle"),Ys(),Ys(),Ys(),Ys(),Ys(),zs(36,"div",15),js(37,"app-icon",16),ha(38),js(39,"app-icon",17),ha(40),js(41,"app-icon",16),ha(42),Gs(43,dC,4,4,"span",18),Gs(44,gC,4,4,"span",18),Gs(45,fC,4,4,"span",18),Gs(46,vC,4,4,"span",18),Gs(47,pC,4,4,"span",18),Gs(48,mC,4,4,"span",18),zs(49,"div",19),zs(50,"button",4),$s("click",function(){return t.enableAll()}),ha(51,"all on"),Ys(),zs(52,"button",4),$s("click",function(){return t.disableAll()}),ha(53,"all off"),Ys(),Ys(),Ys(),Gs(54,EC,6,1,"div",20),Gs(55,TC,5,2,"div",20),Ys(),Ys()),2&e&&(ho(7),Ws("ngIf",!t.demolishMode),ho(1),Ws("ngIf",t.demolishMode),ho(1),Ws("ngIf",!t.arrangeMode&&t.getBuildings().length>1),ho(1),Ws("ngIf",t.arrangeMode),ho(1),Ws("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),ho(1),Ws("ngIf",t.combineMode),ho(1),Ws("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),ho(1),Ws("ngIf",t.splitMode),ho(11),Ws("ngModel",t.filterBuilding),ho(1),Ws("value",t.allBuildings),ho(1),da(t.getBuildingName(t.allBuildings)),ho(1),Ws("ngForOf",t.getUniqueBuildingsFromCurrentView()),ho(1),Ws("ngModel",t.filterWorking),ho(1),Ws("value",t.buildingStates.ALL),ho(2),Ws("value",t.buildingStates.WORKING),ho(2),Ws("value",t.buildingStates.IDLE),ho(3),Ws("name","mountains"),ho(1),ga(" ",t.getMountains()," \xa0\xa0 "),ho(1),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga(" ",t.getUnemployed()," \xa0\xa0\xa0 "),ho(1),Ws("name","land"),ho(1),ga(" ",t.getFreeLand()," "),ho(1),Ws("ngIf",t.getCoal()>0),ho(1),Ws("ngIf",t.getGoldOre()>0),ho(1),Ws("ngIf",t.getSilverOre()>0),ho(1),Ws("ngIf",t.getCopperOre()>0),ho(1),Ws("ngIf",t.getTinOre()>0),ho(1),Ws("ngIf",t.getIronOre()>0),ho(6),Ws("ngIf",!t.isPagedViewEnabled()),ho(1),Ws("ngIf",t.isPagedViewEnabled()))},directives:[GR,Gl,YO,vO,DO,jO,XO,Ul,oT,hI,xl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",".deposit[_ngcontent-%COMP%]{display:inline-flex;font-size:.8em;height:24px;align-items:center}"]}),e}(),bC=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){return p(this,i),t.call(this,n,e,r,s,o,Yv.SEA,Zv.SEA)}return i}(vE);return e.\u0275fac=function(t){return new(t||e)(An(DE),An(PR),An($v),An(wR),An(wm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),CC=function(){function e(t,i){p(this,e),this.troop=t,this.size=i}return S(e,[{key:"getTroopStrength",value:function(){return lm.getTroop(this.troop).STRENGTH}},{key:"getTroopDefense",value:function(){return lm.getTroop(this.troop).DEFENSE}},{key:"getTroopSpeed",value:function(){return lm.getTroop(this.troop).SPEED}},{key:"getTroopPay",value:function(){return lm.getTroop(this.troop).PAY}},{key:"getRecruitTime",value:function(){return lm.getTroop(this.troop).RECRUIT_TIME}},{key:"getTroopSize",value:function(){return lm.getTroop(this.troop).SIZE}},{key:"getTroopCargo",value:function(){return lm.getTroop(this.troop).CARGO}},{key:"isNavy",value:function(){return this.troop===Bv.BOAT||this.troop===Bv.BRIGANTINE||this.troop===Bv.GALLEON}}]),e}(),AC=function(){function e(t){p(this,e),this.units=t}return S(e,[{key:"toJSON",value:function(){this.removeEmptyUnits();var e=[];return this.units.forEach(function(t){e.push({troop:t.troop,size:t.size})}),{units:e}}},{key:"getLandUnits",value:function(t){var i=new e([]);return this.units.forEach(function(e){e.isNavy()||(i.addTroop(e.troop,e.size),t&&(e.size=0))}),this.removeEmptyUnits(),i}},{key:"getNavy",value:function(t){var i=new e([]);return this.units.forEach(function(e){e.isNavy()&&(i.addTroop(e.troop,e.size),t&&(e.size=0))}),i}},{key:"getRandomUnit",value:function(){return sp.randomArrayElement(this.units.filter(function(e){return e.size>=0}))}},{key:"getUnit",value:function(e){return this.units.find(function(t){return t.troop===e})}},{key:"removeEmptyUnits",value:function(){this.units=this.units.filter(function(e){return e.size>0})}},{key:"hasAny",value:function(){return this.removeEmptyUnits(),!(0===this.units.length||1===this.units.length&&this.units[0].troop===Bv.GUARD_TOWER)}},{key:"addTroop",value:function(e,t){var i=this.units.find(function(t){return t.troop===e});i?i.size+=t:this.units.push(new CC(e,t))}},{key:"getArmySize",value:function(){var e=0;return this.removeEmptyUnits(),this.units.filter(function(e){return e.troop!==Bv.COLONIST}).forEach(function(t){return e+=t.size}),e}},{key:"getArmyPower",value:function(e){var t=0;return this.units.forEach(function(i){t+=e?i.size*i.getTroopStrength():i.size*i.getTroopDefense()}),t}},{key:"removeTroop",value:function(e,t){var i=this.units.find(function(t){return t.troop===e});i&&(i.size-=t),this.removeEmptyUnits()}},{key:"addArmy",value:function(e){var t=this;e.units.forEach(function(e){return t.addTroop(e.troop,e.size)})}},{key:"getArmyPay",value:function(){var e=0;return this.units.filter(function(e){return e.troop!==Bv.COLONIST}).forEach(function(t){return e+=t.getTroopPay()*t.size}),e}},{key:"clearArmy",value:function(){this.units=[]}},{key:"getArmySpeed",value:function(){this.removeEmptyUnits();var e=0;return this.units.forEach(function(t){0===e&&(e=t.getTroopSpeed()),t.getTroopSpeed()<e&&(e=t.getTroopSpeed())}),e}},{key:"getArmyCargo",value:function(){var e=0;return this.units.forEach(function(t){return e+=t.getTroopCargo()*t.size}),e}},{key:"hasTroop",value:function(e){return this.removeEmptyUnits(),void 0!==this.units.find(function(t){return t.troop===e})}}],[{key:"clone",value:function(t){var i=new e([]);return t.units.forEach(function(e){return i.addTroop(e.troop,e.size)}),i}}]),e}(),kC=function(){var e=function(){function e(t,i,n,r,o,s){var a=this;p(this,e),this.servicesService=t,this.resourcesService=i,this.logService=n,this.seaService=r,this.modalService=o,this.calendarService=s,this.maxHarbourSpace=0,this.cartographyData=0,this.mapProgress=0,this.paydayCounter=30,this.navy=new AC([]),t.addService(Zv.NAVY,this),this.calendarService.registerForDayChange().subscribe(function(e){a.calculatePayday()})}return S(e,[{key:"getName",value:function(){return"NavyService"}},{key:"load",value:function(e){var t=this;this.maxHarbourSpace=void 0===e.maxHarbourSpace||isNaN(e.maxHarbourSpace)?0:e.maxHarbourSpace,this.cartographyData=void 0===e.cartographyData||isNaN(e.cartographyData)?0:e.cartographyData,this.mapProgress=void 0===e.mapProgress||isNaN(e.mapProgress)?0:e.mapProgress,this.paydayCounter=void 0!==e.paydayCounter?e.paydayCounter:30,this.navy.units=[],void 0!==e.navy&&e.navy.forEach(function(e){t.navy.addTroop(e[0],e[1])})}},{key:"reset",value:function(e,t){this.maxHarbourSpace=0,this.cartographyData=0,this.mapProgress=0,this.navy=new AC([]),this.paydayCounter=30}},{key:"save",value:function(){var e=[];return this.navy.units.forEach(function(t){return e.push([t.troop,t.size])}),{maxHarbourSpace:this.maxHarbourSpace,cartographyData:this.cartographyData,mapProgress:this.mapProgress,navy:e,paydayCounter:this.paydayCounter}}},{key:"getWorldService",value:function(){return this.servicesService.getWorldService()}},{key:"tick",value:function(e){}},{key:"increaseHarbourSize",value:function(e){this.maxHarbourSpace+=e}},{key:"decreaseHarbourSize",value:function(e){this.maxHarbourSpace-=e,this.maxHarbourSpace<0&&(this.maxHarbourSpace=0)}},{key:"getHarbourSpace",value:function(){var e=this,t=0;return[Bv.BOAT,Bv.BRIGANTINE,Bv.GALLEON].forEach(function(i){t+=e.getTotalShips(i)*lm.getTroop(i).SIZE}),t+this.getSizeOfShipsInConstruction()}},{key:"getSizeOfShipsInConstruction",value:function(){var e=0;return this.seaService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.BOAT_BUILDER||e.getBuildingType()===Pv.SHIPYARD}).map(function(e){return e}).forEach(function(t){return e+=t.getShipSize()}),e}},{key:"getFreeHarbourSpace",value:function(){return this.maxHarbourSpace-this.getHarbourSpace()-this.getSizeOfShipsInConstruction()}},{key:"getMaxHarbourSpace",value:function(){return this.maxHarbourSpace}},{key:"addShip",value:function(e){this.navy.addTroop(e,1)}},{key:"getAvailableShips",value:function(e){var t=this.navy.getUnit(e);return void 0!==t?t.size:0}},{key:"getTotalShips",value:function(e){var t=0,i=this.navy.getUnit(e);return t+=void 0!==i?i.size:0,this.getWorldService().getPlayerSeaMissions().forEach(function(i){var n=i.army.getUnit(e);t+=void 0!==n?n.size:0}),this.getWorldService().getStationedNavy().forEach(function(i){var n=i.getUnit(e);n&&(t+=n.size)}),t}},{key:"getCartographyData",value:function(){return this.cartographyData}},{key:"increaseCartographyData",value:function(e){this.cartographyData+=e}},{key:"decreaseCartographyData",value:function(e){return this.cartographyData>=e&&(this.cartographyData-=e,!0)}},{key:"addMapProgress",value:function(){this.mapProgress+=1}},{key:"getMapProgress",value:function(){return this.mapProgress}},{key:"createMap",value:function(){return!!(this.mapProgress>=100&&this.resourcesService.increaseResource(Mv.MAP,1,"Cartographer"))&&(this.mapProgress-=100,!0)}},{key:"calculateNavyPay",value:function(){var e=this,t=0;return[Bv.BOAT,Bv.BRIGANTINE,Bv.GALLEON].forEach(function(i){t+=e.getTotalShips(i)*lm.getTroop(i).PAY}),t}},{key:"getNavy",value:function(){return this.navy}},{key:"getPaydayCounter",value:function(){return this.paydayCounter}},{key:"calculatePayday",value:function(){var e,t=this;if(this.getPaydayCounter()<=0){var i=this.calculateNavyPay();i>0&&((e=t.resourcesService.hasResource(Mv.COINS,i,"Navy"))>i&&(e=i),e>0?function(){t.resourcesService.decreaseResource(Mv.COINS,i-e,"Navy");for(var n=[],r=function(){var i=[];t.getWorldService().getPlayerSeaMissions().forEach(function(e){e.army.getNavy(!1).getArmySize()>0&&i.push(e.army.getNavy(!1))}),t.getWorldService().getStationedNavy().forEach(function(e){e.getArmySize()>0&&i.push(e)}),i.forEach(function(t){e>0&&t.units.forEach(function(t){if(e>0&&t.getTroopPay()>0&&t.size>0&&(e-=t.getTroopPay(),sp.chance(.25))){t.size-=1;var i=n.find(function(e){return e[0]===t.troop});i?i[1]+=1:n.push([t.troop,1])}}),t.removeEmptyUnits()})};e>0&&(t.navy.units.forEach(function(t){if(e>0&&t.getTroopPay()>0&&t.size>0&&(e-=t.getTroopPay(),sp.chance(.25))){t.size-=1;var i=n.find(function(e){return e[0]===t.troop});i?i[1]+=1:n.push([t.troop,1])}}),!(e<=0));)r();if(n.length>0){var o="Deserters:<br>";n.forEach(function(e){return o+="&emsp;"+e[1]+" "+Qv.prepareTroopName(e[0])+"<br>"}),t.logService.warning(o)}}():t.resourcesService.decreaseResource(Mv.COINS,i,"Navy")),this.paydayCounter=30}else this.paydayCounter-=1}},{key:"dismiss",value:function(e,t){var i=this.resourcesService.getPopulationCap()-this.resourcesService.getTotalPeople(),n=void 0!==this.navy.getUnit(e)?this.navy.getUnit(e).size:0;0!==n?t>n?this.modalService.info("There are not enough ships to decommission"):i>=t?(this.navy.removeTroop(e,t),this.servicesService.getVillageService().addVillagers(t)):this.modalService.info("There are not enough housing space for sailors from decommissioned ships!"):this.modalService.info("No ship to decommission")}},{key:"addBrigantines",value:function(e){this.navy.addTroop(Bv.BRIGANTINE,e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(DE),An(Cm),An(bC),An(Jv),An(Im))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function NC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Demolish"),Ys()}}function _C(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Stop"),Ys()}}function wC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Arrange"),Ys()}}function PC(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Stop"),Ys()}}function MC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Combine"),Ys()}}function DC(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Stop"),Ys()}}function LC(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Split"),Ys()}}function xC(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Stop"),Ys()}}function FC(e,t){if(1&e&&(zs(0,"option",13),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("value",i),ho(1),da(n.getBuildingName(i))}}function UC(e,t){if(1&e&&(zs(0,"span",26),js(1,"app-building",27),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.seaService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function HC(e,t){if(1&e&&(zs(0,"div",22),zs(1,"div",23),zs(2,"span"),ha(3,"Buildings"),Ys(),Ys(),zs(4,"div",24),Gs(5,UC,2,6,"span",25),Ys(),Ys()),2&e){var i=ta();ho(5),Ws("ngForOf",i.getBuildings())}}var GC=function(e){return{activePage:e}};function BC(e,t){if(1&e){var i=qs();zs(0,"span",30),$s("click",function(){var e=Kt(i).$implicit;return ta(2).setPage(e)}),ha(1),Ys()}if(2&e){var n=t.$implicit,r=ta(2);Ws("ngClass",Du(2,GC,r.currentPage===n)),ho(1),ga("page ",n+1,"")}}function WC(e,t){if(1&e&&(zs(0,"span",26),js(1,"app-building",27),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.seaService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function VC(e,t){if(1&e&&(zs(0,"div",22),zs(1,"div",28),Gs(2,BC,2,4,"span",29),Ys(),zs(3,"div",24),Gs(4,WC,2,6,"span",25),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getPagesNumber()),ho(2),Ws("ngForOf",i.getPagedBuildings())}}var zC=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u,c){var l;return p(this,i),(l=t.call(this,e,n,r,s,o,a,u,Yv.SEA)).landService=n,l.seaService=s,l.navyService=c,l}return S(i,[{key:"getHarbourSpace",value:function(){return this.navyService.getHarbourSpace()}},{key:"getMaxHarbourSpace",value:function(){return this.navyService.getMaxHarbourSpace()}}]),i}(pE);return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(Nm),Bs(bC),Bs(Om),Bs(cu),Bs(kC))},e.\u0275cmp=it({type:e,selectors:[["app-sea"]],features:[bs],decls:50,vars:28,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],[3,"name","path"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"button",4),$s("click",function(){return t.openBuildModal()}),ha(6,"Build"),Ys(),Gs(7,NC,2,0,"button",5),Gs(8,_C,2,0,"button",6),Gs(9,wC,2,0,"button",5),Gs(10,PC,2,0,"button",6),Gs(11,MC,2,0,"button",5),Gs(12,DC,2,0,"button",6),Gs(13,LC,2,0,"button",5),Gs(14,xC,2,0,"button",6),zs(15,"button",7),ha(16,"Actions "),js(17,"img",8),zs(18,"ul",9),zs(19,"li",4),$s("click",function(){return t.autoSort()}),ha(20,"Sort"),Ys(),Ys(),Ys(),zs(21,"div",10),ha(22," Filter:"),js(23,"br"),zs(24,"div",11),zs(25,"select",12),$s("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),zs(26,"option",13),ha(27),Ys(),Gs(28,FC,2,2,"option",14),Ys(),zs(29,"select",12),$s("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),zs(30,"option",13),ha(31,"All"),Ys(),zs(32,"option",13),ha(33,"Working"),Ys(),zs(34,"option",13),ha(35,"Idle"),Ys(),Ys(),Ys(),Ys(),Ys(),zs(36,"div",15),js(37,"app-icon",16),ha(38),js(39,"app-icon",17),ha(40),js(41,"app-icon",18),ha(42),zs(43,"div",19),zs(44,"button",4),$s("click",function(){return t.enableAll()}),ha(45,"all on"),Ys(),zs(46,"button",4),$s("click",function(){return t.disableAll()}),ha(47,"all off"),Ys(),Ys(),Ys(),Gs(48,HC,6,1,"div",20),Gs(49,VC,5,2,"div",20),Ys(),Ys()),2&e&&(ho(7),Ws("ngIf",!t.demolishMode),ho(1),Ws("ngIf",t.demolishMode),ho(1),Ws("ngIf",!t.arrangeMode&&t.getBuildings().length>1),ho(1),Ws("ngIf",t.arrangeMode),ho(1),Ws("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),ho(1),Ws("ngIf",t.combineMode),ho(1),Ws("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),ho(1),Ws("ngIf",t.splitMode),ho(11),Ws("ngModel",t.filterBuilding),ho(1),Ws("value",t.allBuildings),ho(1),da(t.getBuildingName(t.allBuildings)),ho(1),Ws("ngForOf",t.getUniqueBuildingsFromCurrentView()),ho(1),Ws("ngModel",t.filterWorking),ho(1),Ws("value",t.buildingStates.ALL),ho(2),Ws("value",t.buildingStates.WORKING),ho(2),Ws("value",t.buildingStates.IDLE),ho(3),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga(" ",t.getUnemployed()," \xa0\xa0\xa0 "),ho(1),Ws("name","land"),ho(1),ga(" ",t.getFreeLand()," \xa0\xa0\xa0 "),ho(1),Ws("name","port")("path","sea"),ho(1),fa(" ",t.getHarbourSpace(),"/",t.getMaxHarbourSpace()," "),ho(6),Ws("ngIf",!t.isPagedViewEnabled()),ho(1),Ws("ngIf",t.isPagedViewEnabled()))},directives:[GR,Gl,YO,vO,DO,jO,XO,Ul,oT,hI,xl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",""]}),e}(),YC=function e(){p(this,e),this.skirmish=[]},jC=function e(t,i,n,r,o){p(this,e),this.attackerTroop=t,this.defenderTroop=i,this.attack=n,this.defense=r,this.result=o},KC=function(){var e=function(){function e(t,i,n,r,o,s,a,u){var c=this;p(this,e),this.resourcesService=t,this.modalService=i,this.logService=n,this.landService=r,this.soundService=o,this.calendarService=s,this.effectsService=a,this.servicesService=u,this.barracksSize=0,this.defense=0,this.stashSize=0,this.paydayCounter=30,this.army=new AC([]),this.recruits=[],this.recruitsUpdate=new U,u.addService(Zv.ARMY,this),this.calendarService.registerForDayChange().subscribe(function(e){c.calculatePayday()})}return S(e,[{key:"tick",value:function(e){}},{key:"getName",value:function(){return"ArmyService"}},{key:"load",value:function(e){var t=this;this.barracksSize=e.barracksSize,this.defense=e.defense,this.paydayCounter=void 0!==e.paydayCounter?e.paydayCounter:30,this.stashSize=e.stashSize,this.army.units=[],void 0!==e.troops?e.troops.forEach(function(e){t.army.addTroop(e[0],e[1])}):void 0!==e.army&&e.army.forEach(function(e){t.army.addTroop(e[0],e[1])}),this.recruits=[],e.recruits.forEach(function(e){t.recruits.push([new CC(e[0],e[1]),e[2]])}),void 0!==e.missionsInProgress&&e.missionsInProgress.forEach(function(e){e[4].forEach(function(e){t.army.addTroop(e[0],e[1])})})}},{key:"save",value:function(){var e=[];this.army.units.forEach(function(t){return e.push([t.troop,t.size])});var t=[];return this.recruits.forEach(function(e){return t.push([e[0].troop,e[0].size,e[1]])}),{barracksSize:this.barracksSize,army:e,recruits:t,defense:this.defense,stashSize:this.stashSize,paydayCounter:this.paydayCounter}}},{key:"reset",value:function(e,t){this.recruits=[],this.barracksSize=0,this.defense=0,this.stashSize=0,this.paydayCounter=30,this.army.units=[]}},{key:"progressRecruitment",value:function(e){this.recruits.length>0&&(this.recruits[0][1]+=e,this.recruits[0][1]>=this.recruits[0][0].getRecruitTime()&&(this.army.addTroop(this.recruits[0][0].troop,1),this.recruits[0][0].size-=1,this.recruits[0][1]=0,this.recruits[0][0].size<=0&&this.recruits.shift()),this.recruitsUpdate.next())}},{key:"recruit",value:function(e,t){if(this.getFreeBarracks()>=t)if(this.resourcesService.getPeople()>=t){var i=new Map;lm.getTroop(e).COST.forEach(function(e){return i.set(e.resource,e.amount)}),this.resourcesService.decreaseResources(i,"Army",!0,t)&&(this.resourcesService.removeRecruit(t),this.recruits.push([new CC(e,t),0]))}else this.modalService.info("Not enough unemployed people to recruit!");else this.modalService.info("Not enough space in barracks for so many recruits")}},{key:"dismiss",value:function(e,t){var i=this.resourcesService.getPopulationCap()-this.resourcesService.getTotalPeople(),n=void 0!==this.army.getUnit(e)?this.army.getUnit(e).size:0;0!==n?t>n?this.modalService.info("There are not enough troops to dismiss"):i>=t?(this.army.removeTroop(e,t),this.servicesService.getVillageService().addVillagers(t)):this.modalService.info("There are not enough housing space for dismissed troops!"):this.modalService.info("No troops to dismiss")}},{key:"dismissRecruit",value:function(e,t){var i=this.resourcesService.getPopulationCap()-this.resourcesService.getTotalPeople();t>this.recruits[e][0].size?this.modalService.info("There are not enough recruits to dismiss"):i>=t?(this.recruits[e][0].size-=t,this.recruits[e][0].size<=0&&this.recruits.splice(e,1),this.servicesService.getVillageService().addVillagers(t)):this.modalService.info("There are not enough housing space for dismissed troops!")}},{key:"getRecruits",value:function(){return this.recruits}},{key:"getUnits",value:function(){return this.army.units}},{key:"getWorldService",value:function(){return this.servicesService.getWorldService()}},{key:"getArmySize",value:function(){var e=this.army.getArmySize();return this.recruits.forEach(function(t){return e+=t[0].size}),this.getWorldService().getPlayerLandMissions().forEach(function(t){e+=t.army.getArmySize()}),this.getWorldService().getPlayerSeaMissions().forEach(function(t){e+=t.army.getLandUnits(!1).getArmySize()}),this.getWorldService().getStationedArmies().forEach(function(t){e+=t.getArmySize()}),e}},{key:"getFreeBarracks",value:function(){return this.barracksSize-this.getArmySize()}},{key:"increaseBarracks",value:function(e){this.barracksSize+=e}},{key:"decreaseBarracks",value:function(e){this.barracksSize-=e}},{key:"getBarracksSize",value:function(){return this.barracksSize}},{key:"getDefenseStrength",value:function(){var e=this.defense;return this.army.units.forEach(function(t){return e+=t.getTroopDefense()*t.size}),e}},{key:"increaseDefense",value:function(e){this.defense+=e}},{key:"decreaseDefense",value:function(e){this.defense-=e}},{key:"hasRecruits",value:function(){return this.recruits.length>0}},{key:"registerForRecruitsUpdate",value:function(){return this.recruitsUpdate.asObservable()}},{key:"getAttackStrength",value:function(){var e=0;return this.army.units.forEach(function(t){return e+=t.getTroopStrength()*t.size}),e}},{key:"increaseStash",value:function(e){this.stashSize+=e}},{key:"decreaseStash",value:function(e){this.stashSize-=e}},{key:"calculateSoldiersPay",value:function(){var e=0;return e+=this.army.getArmyPay(),this.getWorldService().getPlayerLandMissions().forEach(function(t){e+=t.army.getArmyPay()}),this.getWorldService().getPlayerSeaMissions().forEach(function(t){e+=t.army.getLandUnits(!1).getArmyPay()}),this.getWorldService().getStationedArmies().forEach(function(t){e+=t.getArmyPay()}),e}},{key:"getPaydayCounter",value:function(){return this.paydayCounter}},{key:"calculatePayday",value:function(){var e,t=this;if(this.paydayCounter<=0){var i=this.calculateSoldiersPay();i>0&&((e=t.resourcesService.hasResource(Mv.COINS,i,"Army"))>i&&(e=i),e>0?function(){t.resourcesService.decreaseResource(Mv.COINS,i-e,"Army");for(var n=[],r=function(){var i=[];t.getWorldService().getPlayerLandMissions().forEach(function(e){e.army.getArmySize()>0&&i.push(e.army)}),t.getWorldService().getPlayerSeaMissions().forEach(function(e){e.army.getLandUnits(!1).getArmySize()>0&&i.push(e.army.getLandUnits(!1))}),t.getWorldService().getStationedArmies().forEach(function(e){e.getArmySize()>0&&i.push(e)}),i.forEach(function(t){e>0&&t.units.forEach(function(t){if(e>0&&t.getTroopPay()>0&&t.size>0&&(e-=t.getTroopPay(),sp.chance(.25))){t.size-=1;var i=n.find(function(e){return e[0]===t.troop});i?i[1]+=1:n.push([t.troop,1])}})})};e>0&&(t.army.units.forEach(function(t){if(e>0&&t.getTroopPay()>0&&t.size>0&&(e-=t.getTroopPay(),sp.chance(.25))){t.size-=1;var i=n.find(function(e){return e[0]===t.troop});i?i[1]+=1:n.push([t.troop,1])}}),!(e<=0));)r();if(n.length>0){var o="Deserters:<br>";n.forEach(function(e){return o+="&emsp;"+e[1]+" "+Qv.prepareTroopName(e[0])+"<br>"}),t.logService.warning(o)}}():t.resourcesService.decreaseResource(Mv.COINS,i,"Army")),this.paydayCounter=30}else this.paydayCounter-=1}},{key:"getTroopEffectsMultiplier",value:function(e){return 1+this.getTroopEffectsValue(e)/100}},{key:"getTroopEffectsValue",value:function(e){var t=0;return this.effectsService.getArmyEffects().filter(function(t){return t.troop===Bv.ALL||t.troop===e}).forEach(function(e){return t+=e.effect}),t}},{key:"addMilitia",value:function(e){this.army.addTroop(Bv.MILITIA,e)}},{key:"addLightCavalry",value:function(e){this.army.addTroop(Bv.LIGHT_CAVALRY,e)}},{key:"calculateAttack",value:function(e,t,i,n,r){var o=new YC;o.attackerArmy=AC.clone(e),o.defenderArmy=AC.clone(t),o.defense=i;var s=0,a=0;if(e.getArmySize()>t.getArmySize()?(s=Math.floor(e.getArmySize()/t.getArmySize())-1)>3&&(s=3):t.getArmySize()>e.getArmySize()&&((a=Math.floor(t.getArmySize()/e.getArmySize())-1)>3&&(a=3)),o.attackerArmySizeBonus=s,o.defenderArmySizeBonus=a,e.units.length>0&&t.units.length>0){var u=t.getRandomUnit(),c=u.getTroopDefense(),l=e.getRandomUnit(),h=l.getTroopStrength(),d=Math.floor(h/2);for(h-=d<i?d:i;e.units.length>0&&t.units.length>0;){if(1,null===l){h=(l=e.getRandomUnit()).getTroopStrength();var g=Math.floor(h/2);h-=g<i?g:i}null===u&&(c=(u=t.getRandomUnit()).getTroopDefense());var f=0,v=0,p=0;if(n)v=f=h*this.getTroopEffectsMultiplier(l.troop)+s,p=c+a,f-=c+a;else if(r){var m=c*this.getTroopEffectsMultiplier(u.troop)+a;p=m,v=h+s,f=-m+h+s}else v=f=h+s,p=c+a,f-=c+a;var S=this.calculateWinChance(f);sp.chance(S/100)?(o.skirmish.push(new jC(l.troop,u.troop,v,p,!0)),u.size-=1,t.removeEmptyUnits(),u=null,h-=1):(o.skirmish.push(new jC(l.troop,u.troop,v,p,!1)),l.size-=1,e.removeEmptyUnits(),l=null,c-=1)}}return e.units.length>0?(o.result=!0,o.armyAfterFight=AC.clone(e)):(o.result=!1,o.armyAfterFight=AC.clone(t)),o}},{key:"calculateWinChance",value:function(e){var t=50;if(e>0){var i=e;e>1&&(i=1),e-=i,t+=10*i}return Math.min(95,Math.max(5,5*e+t))}},{key:"getArmy",value:function(){return this.army}},{key:"loot",value:function(e){for(var t=this,i=new Map,n="Loot:<br>",r=Array.from(this.resourcesService.getResources().values()).filter(function(e){return e.isVisible()}).map(function(e){return{item:e.resource,chance:e.prioritise?10:1}});e>5;){var o=sp.randomWeightedExcept(r,[]),s=cm.getResource(o),a=0;for(a=sp.randomBetween(1,s.TRADE_VALUE<10?20:s.TRADE_VALUE<50?10:s.TRADE_VALUE<300?5:2);s.TRADE_VALUE*a>e;)a-=1;a>0&&(i.has(o)?i.set(o,i.get(o)+a):i.set(o,a),e-=a*s.TRADE_VALUE)}Array.from(i.keys()).sort(function(e,i){var n=t.resourcesService.getResource(e).name.toLowerCase(),r=t.resourcesService.getResource(i).name.toLowerCase();return n<r?-1:n>r?1:0}).forEach(function(e){n+="&emsp;"+i.get(e)+" "+Qv.prepareResourceName(e)+"<br>"}),this.logService.success(n),this.resourcesService.increaseResources(i,"Plunder",!0)}},{key:"lootPlayer",value:function(e){for(var t=this,i="<br>",n=[],r=function(){var i=Array.from(t.resourcesService.getResources().values()).filter(function(e){return e.amount>t.stashSize}),r=sp.randomExcept(i,[]);if(void 0===r)return e=0,"break";var o=cm.getResource(r.resource),s=0;s=sp.randomBetween(1,o.TRADE_VALUE<10?20:o.TRADE_VALUE<50?10:o.TRADE_VALUE<300?5:2),r.amount-t.stashSize<s&&(s=r.amount-t.stashSize),e-=o.TRADE_VALUE*s;var a=n.find(function(e){return e.resource===r.resource});a?a.amount+=s:n.push({resource:r.resource,amount:s}),t.resourcesService.decreaseResource(r.resource,s,"Invasion",!0)};e>0;){if("break"===r())break}var o=0;return n.sort(function(e,i){var n=t.resourcesService.getResource(e.resource).name.toLowerCase(),r=t.resourcesService.getResource(i.resource).name.toLowerCase();return n<r?-1:n>r?1:0}).forEach(function(e){i+="&emsp;"+e.amount+" "+Qv.prepareResourceName(e.resource)+"<br>",o+=e.amount*cm.getResource(e.resource).TRADE_VALUE}),this.logService.warning(n.length>0?"Plundered: "+i:"Nothing has been stolen"),Math.floor(o/100)}},{key:"moveRecipeInQueue",value:function(e){zS(this.recruits,e.previousIndex,e.currentIndex)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(DE),An(Jv),An(Cm),An(wm),An(Tm),An(Im),An(Am),An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),QC=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){return p(this,i),t.call(this,n,e,r,s,o,Yv.FORT,Zv.FORT)}return i}(vE);return e.\u0275fac=function(t){return new(t||e)(An(DE),An(PR),An($v),An(wR),An(wm))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),qC=["progressId"];function XC(e,t){1&e&&(zs(0,"div",13),ha(1,"dismiss "),Ys())}function ZC(e,t){1&e&&(zs(0,"div",13),ha(1,"recruit "),Ys())}function $C(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta().$implicit,n=ta(2);ho(1),da(i.amount*n.multiplier)}}function JC(e,t){if(1&e&&(Ks(0,16),zs(1,"div",16),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit,n=ta(2);ho(2),da(i.amount*n.multiplier)}}function eA(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",8),Gs(2,$C,2,1,"ng-container",14),Gs(3,JC,3,1,"ng-container",15),js(4,"app-icon",9),Ys(),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(2),Ws("ngIf",n.checkResource(i)),ho(1),Ws("ngIf",!n.checkResource(i)),ho(1),Ws("name",n.getResourceName(i.resource))("path","resources")}}var tA=function(e){return{dismiss:e}};function iA(e,t){if(1&e){var i=qs();zs(0,"div",2),$s("click",function(){return Kt(i),ta().dismissRecruit()}),js(1,"div",3,4),zs(3,"span",5),Gs(4,XC,2,0,"div",6),Gs(5,ZC,2,0,"div",6),ha(6),Hu(7,"titlecase"),js(8,"hr"),zs(9,"div",7),ha(10,"Stats (per soldier):"),Ys(),zs(11,"div",8),js(12,"app-icon",9),ha(13),Ys(),zs(14,"div",8),js(15,"app-icon",9),ha(16),Ys(),zs(17,"div",8),js(18,"app-icon",9),ha(19),Ys(),zs(20,"div",8),js(21,"app-icon",9),ha(22),Ys(),zs(23,"div",10),ha(24,"Cost:"),Ys(),Gs(25,eA,5,4,"div",11),Ys(),zs(26,"div",12),ha(27),Ys(),Ys()}if(2&e){var n=ta();Ws("ngClass",Du(24,tA,n.dismiss&&n.count>0))("elementId",n.id),ho(3),ia("id",n.id),ho(1),Ws("ngIf",n.dismiss),ho(1),Ws("ngIf",!n.dismiss&&!n.recruit),ho(1),fa(" ",n.multiplier," x ",Gu(7,22,n.getTroopName())," "),ho(6),Ws("name","attack")("path","army"),ho(1),ga(": ",n.getTroopStrength(),""),ho(2),Ws("name","defense")("path","army"),ho(1),ga(": ",n.getTroopDefense(),""),ho(2),Ws("name","speed")("path","army"),ho(1),ga(": ",n.getTroopSpeed(),""),ho(2),Ws("name","coins")("path","resources"),ho(1),ga(": ",n.getTroopPay(),""),ho(3),Ws("ngForOf",n.getRecruitCost()),ho(2),fa("",n.getTroopName()," - ",n.count,"")}}function nA(e,t){1&e&&(zs(0,"div",13),ha(1,"dismiss "),Ys())}function rA(e,t){1&e&&(zs(0,"div",13),ha(1,"recruit "),Ys())}function oA(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta().$implicit,n=ta(2);ho(1),da(i.amount*n.multiplier)}}function sA(e,t){if(1&e&&(Ks(0,16),zs(1,"div",16),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit,n=ta(2);ho(2),da(i.amount*n.multiplier)}}function aA(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",8),Gs(2,oA,2,1,"ng-container",14),Gs(3,sA,3,1,"ng-container",15),js(4,"app-icon",9),Ys(),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(2),Ws("ngIf",n.checkResource(i)),ho(1),Ws("ngIf",!n.checkResource(i)),ho(1),Ws("name",n.getResourceName(i.resource))("path","resources")}}function uA(e,t){if(1&e&&(zs(0,"div",17),js(1,"div",3,4),zs(3,"span",5),Gs(4,nA,2,0,"div",6),Gs(5,rA,2,0,"div",6),ha(6),Hu(7,"titlecase"),js(8,"hr"),zs(9,"div",7),ha(10,"Stats (per soldier):"),Ys(),zs(11,"div",8),js(12,"app-icon",9),ha(13),Ys(),zs(14,"div",8),js(15,"app-icon",9),ha(16),Ys(),zs(17,"div",8),js(18,"app-icon",9),ha(19),Ys(),zs(20,"div",8),js(21,"app-icon",9),ha(22),Ys(),zs(23,"div",10),ha(24,"Cost:"),Ys(),Gs(25,aA,5,4,"div",11),Ys(),zs(26,"div",18),ha(27),Ys(),Ys()),2&e){var i=ta();Ws("ngClass",Du(24,tA,i.dismiss&&i.count>0))("elementId",i.id),ho(3),ia("id",i.id),ho(1),Ws("ngIf",i.dismiss),ho(1),Ws("ngIf",!i.dismiss&&!i.recruit),ho(1),fa(" ",i.multiplier," x ",Gu(7,22,i.getTroopName())," "),ho(6),Ws("name","attack")("path","army"),ho(1),ga(": ",i.getTroopStrength(),""),ho(2),Ws("name","defense")("path","army"),ho(1),ga(": ",i.getTroopDefense(),""),ho(2),Ws("name","speed")("path","army"),ho(1),ga(": ",i.getTroopSpeed(),""),ho(2),Ws("name","coins")("path","resources"),ho(1),ga(": ",i.getTroopPay(),""),ho(3),Ws("ngForOf",i.getRecruitCost()),ho(2),fa("",i.getTroopName()," - ",i.count,"")}}var cA=function(){var e=function(){function e(t,i){p(this,e),this.armyService=t,this.resourcesService=i,this.id=Math.random(),this.recruit=!1,this.progress=0,this.multiplier=0,this.recruitIndex=-1,this.dismiss=!1}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.updateSubscription=this.armyService.registerForRecruitsUpdate().subscribe(function(){e.progressRef&&(e.progressRef.nativeElement.style.width=e.progress/e.getRecruitTime()*100+"%")})}},{key:"ngAfterViewInit",value:function(){this.progressRef&&(this.progressRef.nativeElement.style.width=this.progress/this.getRecruitTime()*100+"%")}},{key:"getTroopName",value:function(){return Qv.prepareTroopName(this.troop)}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"checkResource",value:function(e){return 0===this.resourcesService.hasResource(e.resource,e.amount*this.multiplier,"Army",!0)}},{key:"isAvailable",value:function(){if(this.dismiss&&this.count>this.multiplier||this.recruit)return!0;var e=new Map;return this.getRecruitCost().forEach(function(t){return e.set(t.resource,t.amount)}),this.resourcesService.hasResources(e,"Army",this.multiplier,!0)}},{key:"getRecruitTime",value:function(){return lm.getTroop(this.troop).RECRUIT_TIME}},{key:"getRecruitCost",value:function(){return lm.getTroop(this.troop).COST}},{key:"getTroopStrength",value:function(){return lm.getTroop(this.troop).STRENGTH}},{key:"getTroopDefense",value:function(){return lm.getTroop(this.troop).DEFENSE}},{key:"getTroopPay",value:function(){return lm.getTroop(this.troop).PAY}},{key:"getTroopSpeed",value:function(){return lm.getTroop(this.troop).SPEED}},{key:"dismissRecruit",value:function(){this.recruit&&this.dismiss&&this.armyService.dismissRecruit(this.recruitIndex,this.multiplier)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(KC),Bs(DE))},e.\u0275cmp=it({type:e,selectors:[["app-troop"]],viewQuery:function(e,t){var i;(1&e&&rc(qC,5),2&e)&&(nc(i=sc())&&(t.progressRef=i.first))},inputs:{id:"id",troop:"troop",count:"count",recruit:"recruit",progress:"progress",multiplier:"multiplier",recruitIndex:"recruitIndex",dismiss:"dismiss"},decls:2,vars:2,consts:[["id","wrapper","class","tooltip","appTooltip","",3,"ngClass","elementId","click",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"ngClass","elementId",4,"ngIf"],["id","wrapper","appTooltip","",1,"tooltip",3,"ngClass","elementId","click"],["id","progressId"],["progressId",""],[1,"tooltipSpan",3,"id"],["class","inline",4,"ngIf"],[1,"statsTitle"],[1,"icon"],[3,"name","path"],[1,"costTitle"],[4,"ngFor","ngForOf"],["id","text"],[1,"inline"],[4,"ngIf"],["class","missing",4,"ngIf"],[1,"missing"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"ngClass","elementId"],["id","textNotAvailable"]],template:function(e,t){1&e&&(Gs(0,iA,28,26,"div",0),Gs(1,uA,28,26,"div",1)),2&e&&(Ws("ngIf",t.isAvailable()),ho(1),Ws("ngIf",!t.isAvailable()))},directives:[Gl,sT,xl,oT,Ul],pipes:[ql],styles:["#wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%;padding:3px;text-align:center;border:black solid 1px;font-size:1.2em}#wrapperNotAvailable[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%;padding:3px;text-align:center;border:#57575a solid 1px;font-size:1.2em}.dismiss[_ngcontent-%COMP%]{border:var(--negative-colour) solid 1px!important}#text[_ngcontent-%COMP%]{position:relative;z-index:2}#textNotAvailable[_ngcontent-%COMP%]{position:relative;z-index:2;color:#57575a}#progressId[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}hr[_ngcontent-%COMP%]{border-color:#000}.costTitle[_ngcontent-%COMP%]{text-align:left}.statsTitle[_ngcontent-%COMP%]{text-align:left}.tooltipSpan[_ngcontent-%COMP%]{min-width:125px}.missing[_ngcontent-%COMP%]{color:var(--negative-colour)}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}.inline[_ngcontent-%COMP%]{display:inline-block}"]}),e}();function lA(e,t){if(1&e&&(zs(0,"div"),ha(1," \xa0\xa0 "),js(2,"app-icon",3),ha(3),Ys()),2&e){var i=ta();ho(2),Ws("name","protection")("path","army")("title","regions protection"),ho(1),ga("\xa0",i.getProtection()," ")}}function hA(e,t){1&e&&(zs(0,"span",19),ha(1,"No Training square available"),Ys())}function dA(e,t){if(1&e){var i=qs();zs(0,"span",20),$s("click",function(){return Kt(i),ta().changeSelection(1)}),ha(1,"1x"),Ys()}}function gA(e,t){if(1&e){var i=qs();zs(0,"span",21),$s("click",function(){return Kt(i),ta().changeSelection(1)}),ha(1,"1x"),Ys()}}function fA(e,t){if(1&e){var i=qs();zs(0,"span",20),$s("click",function(){return Kt(i),ta().changeSelection(5)}),ha(1,"5x"),Ys()}}function vA(e,t){if(1&e){var i=qs();zs(0,"span",21),$s("click",function(){return Kt(i),ta().changeSelection(5)}),ha(1,"5x"),Ys()}}function pA(e,t){if(1&e){var i=qs();zs(0,"span",20),$s("click",function(){return Kt(i),ta().changeSelection(10)}),ha(1,"10x"),Ys()}}function mA(e,t){if(1&e){var i=qs();zs(0,"span",21),$s("click",function(){return Kt(i),ta().changeSelection(10)}),ha(1,"10x"),Ys()}}function SA(e,t){if(1&e){var i=qs();zs(0,"span",20),$s("click",function(){return Kt(i),ta().changeDismiss(!0)}),ha(1,"dismiss"),Ys()}}function EA(e,t){if(1&e){var i=qs();zs(0,"span",21),$s("click",function(){return Kt(i),ta().changeDismiss(!1)}),ha(1,"dismiss"),Ys()}}function yA(e,t){if(1&e){var i=qs();zs(0,"app-troop",22),$s("click",function(){var e=Kt(i).$implicit;return ta().recruit(e)}),Ys()}if(2&e){var n=t.$implicit,r=ta();Ws("troop",n)("multiplier",r.selection)("dismiss",r.dismiss)("count",r.getTroopSize(n))}}function RA(e,t){if(1&e){var i=qs();zs(0,"button",23),$s("click",function(){return Kt(i),ta().progress()}),ha(1,"recruit"),Ys()}}function OA(e,t){if(1&e&&js(0,"app-troop",24),2&e){var i=t.$implicit,n=t.index,r=ta();Ws("troop",i[0].troop)("recruit",!0)("count",i[0].size)("progress",i[1])("multiplier",r.selection)("recruitIndex",n)("dismiss",r.dismiss)}}function TA(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),fa(" ",n.getTroopName(i.troop),": ",i.size," ")}}function IA(e,t){if(1&e){var i=qs();zs(0,"div",25),$s("click",function(){var e=Kt(i).$implicit;return ta().selectMission(e)}),ha(1),zs(2,"span",26),ha(3),js(4,"hr"),ha(5),Hu(6,"number"),Gs(7,TA,2,2,"div",27),Ys(),Ys()}if(2&e){var n=t.$implicit;Ws("elementId","mission-"+n.id),ho(1),ga(" ",n.getMissionName()," "),ho(1),na("id","mission-",n.id,""),ho(1),ga(" ",n.getMissionName()," "),ho(2),fa(" ",n.getStatus()," : ",Bu(6,7,n.getDisplayProgress(),"0.0-0"),"% "),ho(2),Ws("ngForOf",n.army.units)}}var bA=function(){var e=function(){function e(t,i,n,r,o,s){p(this,e),this.servicesService=t,this.armyService=i,this.resourcesService=n,this.fortService=r,this.router=o,this.changeDetectorRef=s,this.selection=1,this.dismiss=!1,this.troops=[Bv.MILITIA,Bv.SPY,Bv.SPEARMAN,Bv.ARCHER,Bv.SWORDSMAN,Bv.LIGHT_CAVALRY,Bv.HORSE_ARCHER]}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.armyService.registerForRecruitsUpdate().subscribe(function(){e.changeDetectorRef.destroyed||e.changeDetectorRef.detectChanges()})}},{key:"changeSelection",value:function(e){this.selection=e}},{key:"changeDismiss",value:function(e){this.dismiss=e}},{key:"getTroops",value:function(){return this.armyService.getUnits()}},{key:"getRecruits",value:function(){return this.armyService.getRecruits()}},{key:"recruit",value:function(e){this.dismiss?this.armyService.dismiss(e,this.selection):this.armyService.recruit(e,this.selection)}},{key:"isDev",value:function(){return!Cp.production}},{key:"progress",value:function(){this.armyService.progressRecruitment(10)}},{key:"getBarracksSize",value:function(){return this.armyService.getBarracksSize()}},{key:"getTroopsSize",value:function(){return this.armyService.getArmySize()}},{key:"getUnemployed",value:function(){return this.resourcesService.getPeople()}},{key:"getDefenseStrength",value:function(){return this.armyService.getDefenseStrength()}},{key:"getAttackStrength",value:function(){return this.armyService.getAttackStrength()}},{key:"checkForTrainingSquare",value:function(){return void 0!==this.fortService.getBuildings().find(function(e){return e.getBuildingType()===Pv.TRAINING_SQUARE})}},{key:"getSoldiersPay",value:function(){return this.armyService.calculateSoldiersPay()}},{key:"getPaydayCounter",value:function(){return this.armyService.getPaydayCounter()}},{key:"getMissions",value:function(){return this.servicesService.getWorldService().getPlayerLandMissions().concat(this.servicesService.getWorldService().getPlayerSeaMissions().filter(function(e){return e.army&&e.army.getLandUnits(!1).getArmySize()>0}))}},{key:"selectMission",value:function(e){this.servicesService.getWorldService().setSelectedMission(e),this.router.navigate(["/world"])}},{key:"getTroopSize",value:function(e){var t=this.armyService.getArmy().getUnit(e);return t?t.size:0}},{key:"getTroopName",value:function(e){return Qv.prepareTroopName(e)}},{key:"drop",value:function(e){this.armyService.moveRecipeInQueue(e)}},{key:"getProtection",value:function(){return this.servicesService.getWorldService().getProtection()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs($v),Bs(KC),Bs(DE),Bs(QC),Bs(sv),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-army"]],decls:41,vars:36,consts:[["id","wrapper"],["id","title"],[1,"icon"],[3,"name","path","title"],[3,"name","title","margin"],[4,"ngIf"],["id","noTrainingSquare",4,"ngIf"],["id","categories"],[1,"category"],[1,"title"],["id","numbers"],["class","number",3,"click",4,"ngIf"],["class","number active",3,"click",4,"ngIf"],[3,"troop","multiplier","dismiss","count","click",4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["id","recruitsList","cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"troop","recruit","count","progress","multiplier","recruitIndex","dismiss",4,"ngFor","ngForOf"],["id","missionsScroll"],["class","mission tooltip","appTooltip","",3,"elementId","click",4,"ngFor","ngForOf"],["id","noTrainingSquare"],[1,"number",3,"click"],[1,"number","active",3,"click"],[3,"troop","multiplier","dismiss","count","click"],[3,"click"],["cdkDrag","",3,"troop","recruit","count","progress","multiplier","recruitIndex","dismiss"],["appTooltip","",1,"mission","tooltip",3,"elementId","click"],[3,"id"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),ha(2,"Army"),Ys(),zs(3,"div",2),js(4,"app-icon",3),ha(5),js(6,"app-icon",4),ha(7),js(8,"app-icon",3),ha(9),js(10,"app-icon",3),ha(11),js(12,"app-icon",3),ha(13),Gs(14,lA,4,4,"div",5),Gs(15,hA,2,0,"span",6),Ys(),zs(16,"div",7),zs(17,"div",8),zs(18,"span",9),ha(19,"GARRISON"),Ys(),zs(20,"div",10),Gs(21,dA,2,0,"span",11),Gs(22,gA,2,0,"span",12),Gs(23,fA,2,0,"span",11),Gs(24,vA,2,0,"span",12),Gs(25,pA,2,0,"span",11),Gs(26,mA,2,0,"span",12),Gs(27,SA,2,0,"span",11),Gs(28,EA,2,0,"span",12),Ys(),Gs(29,yA,1,4,"app-troop",13),Ys(),zs(30,"div",8),zs(31,"span",9),ha(32,"RECRUITS"),Ys(),Gs(33,RA,2,0,"button",14),zs(34,"div",15),$s("cdkDropListDropped",function(e){return t.drop(e)}),Gs(35,OA,1,7,"app-troop",16),Ys(),Ys(),zs(36,"div",8),zs(37,"span",9),ha(38,"MISSIONS IN PROGRESS"),Ys(),zs(39,"div",17),Gs(40,IA,8,10,"div",18),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(4),Ws("name","barracks")("path","army")("title","Barracks"),ho(1),fa("\xa0",t.getTroopsSize()," /",t.getBarracksSize()," \xa0\xa0 "),ho(1),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga("\xa0",t.getUnemployed()," \xa0\xa0 "),ho(1),Ws("name","attack")("path","army")("title","Attack strength"),ho(1),ga("\xa0",t.getAttackStrength()," \xa0\xa0 "),ho(1),Ws("name","defense")("path","army")("title","Defense strength"),ho(1),ga("\xa0",t.getDefenseStrength()," \xa0\xa0 "),ho(1),Ws("name","coins")("path","resources")("title","Soldiers pay (collected every 30 days)"),ho(1),fa("\xa0",t.getSoldiersPay()," in ",t.getPaydayCounter()+1," days "),ho(1),Ws("ngIf",t.getProtection()>0),ho(1),Ws("ngIf",!t.checkForTrainingSquare()),ho(6),Ws("ngIf",1!==t.selection),ho(1),Ws("ngIf",1===t.selection),ho(1),Ws("ngIf",5!==t.selection),ho(1),Ws("ngIf",5===t.selection),ho(1),Ws("ngIf",10!==t.selection),ho(1),Ws("ngIf",10===t.selection),ho(1),Ws("ngIf",!t.dismiss),ho(1),Ws("ngIf",t.dismiss),ho(1),Ws("ngForOf",t.troops),ho(4),Ws("ngIf",t.isDev()),ho(2),Ws("ngForOf",t.getRecruits()),ho(5),Ws("ngForOf",t.getMissions()))},directives:[oT,Gl,Ul,sE,cA,hE,sT],pipes:[$l],styles:["#wrapper[_ngcontent-%COMP%]{margin:.7%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#categories[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:91.5%;text-align:center}.category[_ngcontent-%COMP%]{text-align:center;flex:0 0 33%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.recruits[_ngcontent-%COMP%]{text-align:center;flex:0 0 50%;display:flex;flex-direction:column;align-items:center;overflow-y:auto;overflow-x:hidden;border-bottom:black solid 1px}.title[_ngcontent-%COMP%]{padding:2px;width:100%;font-weight:bolder;font-size:.9em;margin-bottom:5px;display:block;border-bottom:black solid 1px}#numbers[_ngcontent-%COMP%]{margin-top:-6px;padding:0;margin-bottom:5px}.number[_ngcontent-%COMP%]{border:black solid 1px;padding:2px 4px;background-color:var(--passive-colour);font-size:.75em;cursor:pointer}.number[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}.active[_ngcontent-%COMP%]{background-color:var(--active-colour)}app-troop[_ngcontent-%COMP%]{display:inline-block;margin:4px;width:75%;font-size:.7em;cursor:pointer}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#noTrainingSquare[_ngcontent-%COMP%]{margin-left:4px;color:var(--negative-colour)}#missionsScroll[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;overflow-y:auto;align-items:center}.mission[_ngcontent-%COMP%]{padding:4px;border:black solid 1px;width:80%;cursor:pointer;margin:3px}#recruitsList[_ngcontent-%COMP%]{height:100%;width:100%}"]}),e}(),CA=function e(t,i,n,r,o,s){p(this,e),this.prayer=t,this.cost=i,this.requiredFaithLevel=n,this.religion=r,this.description=o,this.effect=s},AA=function(){var e=function(){function e(t,i,n,r){p(this,e),this.servicesService=t,this.modalService=i,this.logService=n,this.resourcesService=r,this.faith=0,this.faithCap=40,this.faithLevel=1,this.faithShield=0,this.religion=Gv.NONE,this.prayers=[],t.addService(Zv.RELIGION,this),this.initPrayers()}return S(e,[{key:"initPrayers",value:function(){var e=this;this.prayers=[],Object.entries(fm.PRAYERS).forEach(function(t){e.prayers.push(new CA(xv[t[0]],t[1].FAITH,t[1].FAITH_LEVEL,t[1].RELIGION,t[1].DESCRIPTION,t[1].FINISH))})}},{key:"getName",value:function(){return"ReligionService"}},{key:"load",value:function(e){this.faith=e.faith,this.faithCap=e.faithCap,this.faithLevel=e.faithLevel,this.religion=e.religion,this.faithShield=e.faithShield,this.prayers.find(function(e){return e.prayer===xv.PREACH}).cost=e.preachCost}},{key:"save",value:function(){return{faith:this.faith,faithCap:this.faithCap,faithLevel:this.faithLevel,religion:this.religion,faithShield:this.faithShield,preachCost:this.prayers.find(function(e){return e.prayer===xv.PREACH}).cost}}},{key:"reset",value:function(e,t){this.faith=0,this.faithCap=40,this.faithLevel=1,this.faithShield=0,this.religion=Gv.NONE,this.prayers=[],this.initPrayers()}},{key:"getFaith",value:function(){return this.faith}},{key:"increaseFaith",value:function(e){this.faith<this.faithCap&&(this.faith+=e,this.faith===this.faithCap&&this.logService.success("Full faith"),this.faith>this.faithCap&&(this.faith=this.faithCap))}},{key:"increaseFaithCap",value:function(e){this.faithCap+=e}},{key:"decreaseFaithCap",value:function(e){this.faithCap-=e,this.faith>this.faithCap&&(this.faith=this.faithCap)}},{key:"decreaseFaith",value:function(e){return this.faith-e>=0?(this.faith-=e,0):e-this.faith}},{key:"getFaithCap",value:function(){return this.faithCap}},{key:"getPrayers",value:function(){var e=this;return this.prayers.filter(function(t){return(t.religion===Gv.NONE||t.religion===e.religion)&&t.requiredFaithLevel<=e.faithLevel})}},{key:"pray",value:function(e){e.cost<=this.faith?(this.faith-=e.cost,e.effect(this.servicesService),e.prayer===xv.PREACH&&(this.prayers.find(function(e){return e.prayer===xv.PREACH}).cost+=10)):this.modalService.info("Not enough faith for this prayer!")}},{key:"increaseFaithLevel",value:function(e){this.faithLevel+=e}},{key:"increaseFaithShield",value:function(e){this.faithShield+=e}},{key:"decreaseFaithShield",value:function(e){if(this.faithShield>=e)return this.faithShield-=e,0;var t=e-this.faithShield;return this.faithShield=0,t}},{key:"getFaithLevel",value:function(){return this.faithLevel}},{key:"getFaithShield",value:function(){return this.faithShield}},{key:"getCurrentReligion",value:function(){return this.religion}},{key:"getReligionSettings",value:function(e){return fm.getReligion(e)}},{key:"changeReligion",value:function(e){var t=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to change religion?");var i=this.modalService.registerForConfirmation().subscribe(function(n){if(i.unsubscribe(),n){var r=t.getReligionSettings(e);if(t.faith<r.FAITH)return void t.modalService.info("Not enough faith");var o=new Map;if(r.OFFERING.forEach(function(e){return o.set(e.resource,e.amount)}),!t.resourcesService.hasResources(o,"Religion",1,!0))return void t.modalService.info("Not enough offering resources");t.faith-=r.FAITH,t.resourcesService.decreaseResources(o,"Religion",!0),t.religion=e}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Jv),An(Cm),An(DE))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function kA(e,t){if(1&e&&(zs(0,"div",2),zs(1,"div",3),ha(2),Ys(),zs(3,"span",4),ha(4),js(5,"hr"),ha(6),js(7,"app-icon",5),Ys(),Ys()),2&e){var i=ta();Ws("elementId",i.id),ho(2),da(i.getPrayerName()),ho(1),ia("id",i.id),ho(1),ga(" ",i.prayer.description," "),ho(2),ga(" ",i.prayer.cost," "),ho(1),Ws("name","faith")("path","religion")}}function NA(e,t){if(1&e&&(zs(0,"div",6),zs(1,"div",7),ha(2),Ys(),zs(3,"span",4),ha(4),js(5,"hr"),zs(6,"div",8),ha(7),js(8,"app-icon",5),Ys(),Ys(),Ys()),2&e){var i=ta();Ws("elementId",i.id),ho(2),da(i.getPrayerName()),ho(1),ia("id",i.id),ho(1),ga(" ",i.prayer.description," "),ho(3),ga(" ",i.prayer.cost," "),ho(1),Ws("name","faith")("path","religion")}}var _A=function(){var e=function(){function e(t){p(this,e),this.religionService=t}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getPrayerName",value:function(){return Qv.preparePrayerName(this.prayer.prayer)}},{key:"isAvailable",value:function(){return this.religionService.getFaith()>=this.prayer.cost}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(AA))},e.\u0275cmp=it({type:e,selectors:[["app-prayer"]],inputs:{prayer:"prayer",id:"id"},decls:2,vars:2,consts:[["id","wrapper","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapper","appTooltip","",1,"tooltip",3,"elementId"],["id","title"],[3,"id"],[3,"name","path"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"elementId"],["id","titleGrey"],[1,"icon"]],template:function(e,t){1&e&&(Gs(0,kA,8,7,"div",0),Gs(1,NA,9,7,"div",1)),2&e&&(Ws("ngIf",t.isAvailable()),ho(1),Ws("ngIf",!t.isAvailable()))},directives:[Gl,sT,oT],styles:["#wrapper[_ngcontent-%COMP%]{display:inline-block;width:47%;padding:3px;margin:3px;text-align:center;border:black solid 1px}#wrapperNotAvailable[_ngcontent-%COMP%]{display:inline-block;width:47%;padding:3px;margin:3px;text-align:center;border:#646464 solid 1px}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#646464}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e}();function wA(e,t){if(1&e){var i=qs();zs(0,"button",12),$s("click",function(){return Kt(i),ta().increaseFaith(10)}),ha(1,"Increase faith"),Ys()}}function PA(e,t){if(1&e){var i=qs();zs(0,"div",13),zs(1,"app-prayer",14),$s("click",function(){var e=Kt(i).$implicit;return ta().pray(e)}),Ys(),Ys()}if(2&e){var n=t.$implicit,r=t.index;ho(1),Ws("prayer",n)("id",r)}}function MA(e,t){if(1&e&&(zs(0,"div",17),ha(1),Ys()),2&e){var i=ta().$implicit,n=ta();ho(1),ga(" ",n.getReligionName(i)," ")}}function DA(e,t){if(1&e&&(zs(0,"div",25),ha(1),Ys()),2&e){var i=ta(2).$implicit,n=ta();ho(1),da(n.getReligionSettings(i).FAITH)}}function LA(e,t){if(1&e&&(zs(0,"div",26),ha(1),Ys()),2&e){var i=ta(2).$implicit,n=ta();ho(1),da(n.getReligionSettings(i).FAITH)}}function xA(e,t){1&e&&(zs(0,"div"),ha(1,"offering:"),Ys())}function FA(e,t){if(1&e&&(zs(0,"div",25),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.amount," ")}}function UA(e,t){if(1&e&&(zs(0,"div",26),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.amount," ")}}function HA(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",20),Gs(2,FA,2,1,"div",21),Gs(3,UA,2,1,"div",22),js(4,"app-icon",23),Ys(),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(2),Ws("ngIf",n.hasResource(i)),ho(1),Ws("ngIf",!n.hasResource(i)),ho(1),Ws("name",n.getResourceString(i.resource))("path","resources")}}function GA(e,t){if(1&e){var i=qs();zs(0,"div",18),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().changeReligion(e)}),ha(1),zs(2,"span",19),ha(3),js(4,"hr"),zs(5,"div",20),Gs(6,DA,2,1,"div",21),Gs(7,LA,2,1,"div",22),js(8,"app-icon",23),Ys(),Gs(9,xA,2,0,"div",24),Gs(10,HA,5,4,"div",11),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta();Ws("elementId",-n),ho(1),ga(" ",r.getReligionName(n)," "),ho(1),ia("id",-n),ho(1),ga(" ",r.getReligionName(n)," "),ho(3),Ws("ngIf",r.getFaith()>=r.getReligionSettings(n).FAITH),ho(1),Ws("ngIf",r.getFaith()<r.getReligionSettings(n).FAITH),ho(1),Ws("name","faith")("path","religion"),ho(1),Ws("ngIf",r.getReligionSettings(n).OFFERING.length>0),ho(1),Ws("ngForOf",r.getReligionSettings(n).OFFERING)}}function BA(e,t){if(1&e&&(zs(0,"div"),Gs(1,MA,2,1,"div",15),Gs(2,GA,11,10,"div",16),Ys()),2&e){var i=t.$implicit,n=ta();ho(1),Ws("ngIf",i===n.getCurrentReligion()),ho(1),Ws("ngIf",i!==n.getCurrentReligion())}}var WA=function(){var e=function(){function e(t,i){p(this,e),this.religionService=t,this.resourcesService=i}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getFaith",value:function(){return this.religionService.getFaith()}},{key:"getFaithCap",value:function(){return this.religionService.getFaithCap()}},{key:"increaseFaith",value:function(e){this.religionService.increaseFaith(e)}},{key:"isDev",value:function(){return!Cp.production}},{key:"getPrayers",value:function(){return this.religionService.getPrayers()}},{key:"pray",value:function(e){this.religionService.pray(e)}},{key:"getFaithShield",value:function(){return Qv.round(this.religionService.getFaithShield(),2)}},{key:"getReligions",value:function(){return[Gv.NONE,Gv.FERTILITY,Gv.NATURE,Gv.TECHNOLOGY,Gv.WAR]}},{key:"getReligionName",value:function(e){return Qv.prepareReligionName(e)}},{key:"getCurrentReligion",value:function(){return this.religionService.getCurrentReligion()}},{key:"getCurrentReligionName",value:function(){return Gv[this.getCurrentReligion()]}},{key:"getCurrentReligionDisplayName",value:function(){return Qv.prepareReligionName(this.getCurrentReligion())}},{key:"changeReligion",value:function(e){this.religionService.changeReligion(e)}},{key:"getReligionSettings",value:function(e){return fm.getReligion(e)}},{key:"getResourceString",value:function(e){return Mv[e]}},{key:"hasResource",value:function(e){return 0===this.resourcesService.hasResource(e.resource,e.amount,"Religion",!0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(AA),Bs(DE))},e.\u0275cmp=it({type:e,selectors:[["app-religion"]],decls:27,vars:14,consts:[["id","wrapper"],["id","title"],[1,"faith",3,"name","path"],[3,"click",4,"ngIf"],[1,"prayer",3,"name","title","path"],["id","table"],["id","prayers",1,"column"],[1,"tableTitle"],[3,"name","path","title"],["class","prayer",4,"ngFor","ngForOf"],["id","religions",1,"column"],[4,"ngFor","ngForOf"],[3,"click"],[1,"prayer"],[3,"prayer","id","click"],["class","religion active",4,"ngIf"],["class","religion tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],[1,"religion","active"],["appTooltip","",1,"religion","tooltip",3,"elementId","click"],[3,"id"],[1,"icon2"],["class","inline",4,"ngIf"],["class","inline notMet",4,"ngIf"],[3,"name","path"],[4,"ngIf"],[1,"inline"],[1,"inline","notMet"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),zs(2,"span"),ha(3,"Religion"),Ys(),Ys(),zs(4,"div"),Ks(5),ha(6,"Faith"),Qs(),js(7,"app-icon",2),Ks(8),ha(9,":"),Qs(),ha(10),Gs(11,wA,2,0,"button",3),Ys(),zs(12,"div"),ha(13," Faith shield "),js(14,"app-icon",4),ha(15),Ys(),zs(16,"div",5),zs(17,"div",6),zs(18,"span",7),ha(19," Prayers "),js(20,"app-icon",8),Ys(),zs(21,"div"),Gs(22,PA,2,2,"div",9),Ys(),Ys(),zs(23,"div",10),zs(24,"span",7),ha(25,"Religions"),Ys(),Gs(26,BA,3,2,"div",11),Ys(),Ys(),Ys()),2&e&&(ho(7),Ws("name","faith")("path","religion"),ho(3),fa(" ",t.getFaith(),"/",t.getFaithCap()," "),ho(1),Ws("ngIf",t.isDev()),ho(3),Ws("name","faith_shield")("title","Faith shield")("path","religion"),ho(1),ga(" : ",t.getFaithShield()," "),ho(5),Ws("name",t.getCurrentReligionName())("path","religion")("title",t.getCurrentReligionDisplayName()),ho(2),Ws("ngForOf",t.getPrayers()),ho(4),Ws("ngForOf",t.getReligions()))},directives:[oT,Gl,Ul,_A,sT],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;margin:.5%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#table[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:85%}.column[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:auto;border:black solid 1px}#prayers[_ngcontent-%COMP%]{flex:0 0 70%;overflow-y:auto}#religions[_ngcontent-%COMP%]{flex:1 0 auto;overflow-y:auto}.prayer[_ngcontent-%COMP%]{display:inline}.tableTitle[_ngcontent-%COMP%]{border-bottom:black solid 1px;text-align:center}app-prayer[_ngcontent-%COMP%]{cursor:pointer}.faith[_ngcontent-%COMP%]{margin-right:-2px}.religion[_ngcontent-%COMP%]{border:black solid 1px;text-align:center;margin:3px;cursor:pointer}.active[_ngcontent-%COMP%]{background-color:var(--active-colour);cursor:auto}.tooltip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100px}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.inline[_ngcontent-%COMP%]{display:inline}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.icon2[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e}();function VA(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Demolish"),Ys()}}function zA(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleDemolishMode()}),ha(1,"Stop"),Ys()}}function YA(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Arrange"),Ys()}}function jA(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Stop"),Ys()}}function KA(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Combine"),Ys()}}function QA(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleCombineMode()}),ha(1,"Stop"),Ys()}}function qA(e,t){if(1&e){var i=qs();zs(0,"button",4),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Split"),Ys()}}function XA(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){return Kt(i),ta().toggleSplitMode()}),ha(1,"Stop"),Ys()}}function ZA(e,t){if(1&e&&(zs(0,"option",13),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("value",i),ho(1),da(n.getBuildingName(i))}}function $A(e,t){if(1&e&&(zs(0,"span",25),js(1,"app-building",26),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.fortService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function JA(e,t){if(1&e&&(zs(0,"div",21),zs(1,"div",22),zs(2,"span"),ha(3,"Buildings"),Ys(),Ys(),zs(4,"div",23),Gs(5,$A,2,6,"span",24),Ys(),Ys()),2&e){var i=ta();ho(5),Ws("ngForOf",i.getBuildings())}}var ek=function(e){return{activePage:e}};function tk(e,t){if(1&e){var i=qs();zs(0,"span",29),$s("click",function(){var e=Kt(i).$implicit;return ta(2).setPage(e)}),ha(1),Ys()}if(2&e){var n=t.$implicit,r=ta(2);Ws("ngClass",Du(2,ek,r.currentPage===n)),ho(1),ga("page ",n+1,"")}}function ik(e,t){if(1&e&&(zs(0,"span",25),js(1,"app-building",26),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.fortService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function nk(e,t){if(1&e&&(zs(0,"div",21),zs(1,"div",27),Gs(2,tk,2,4,"span",28),Ys(),zs(3,"div",23),Gs(4,ik,2,6,"span",24),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getPagesNumber()),ho(2),Ws("ngForOf",i.getPagedBuildings())}}var rk=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u){var c;return p(this,i),(c=t.call(this,e,n,r,s,o,a,u,Yv.FORT)).landService=n,c.fortService=s,c}return i}(pE);return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(Nm),Bs(QC),Bs(Om),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-fort"]],features:[bs],decls:48,vars:24,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],[1,"dropdown"],["height","10px","src","assets/arrow_down.svg"],[1,"dropdown-content"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],["id","allControl"],["class","buildingsWrapper",4,"ngIf"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"button",4),$s("click",function(){return t.openBuildModal()}),ha(6,"Build"),Ys(),Gs(7,VA,2,0,"button",5),Gs(8,zA,2,0,"button",6),Gs(9,YA,2,0,"button",5),Gs(10,jA,2,0,"button",6),Gs(11,KA,2,0,"button",5),Gs(12,QA,2,0,"button",6),Gs(13,qA,2,0,"button",5),Gs(14,XA,2,0,"button",6),zs(15,"button",7),ha(16,"Actions "),js(17,"img",8),zs(18,"ul",9),zs(19,"li",4),$s("click",function(){return t.autoSort()}),ha(20,"Sort"),Ys(),Ys(),Ys(),zs(21,"div",10),ha(22," Filter:"),js(23,"br"),zs(24,"div",11),zs(25,"select",12),$s("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),zs(26,"option",13),ha(27),Ys(),Gs(28,ZA,2,2,"option",14),Ys(),zs(29,"select",12),$s("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),zs(30,"option",13),ha(31,"All"),Ys(),zs(32,"option",13),ha(33,"Working"),Ys(),zs(34,"option",13),ha(35,"Idle"),Ys(),Ys(),Ys(),Ys(),Ys(),zs(36,"div",15),js(37,"app-icon",16),ha(38),js(39,"app-icon",17),ha(40),zs(41,"div",18),zs(42,"button",4),$s("click",function(){return t.enableAll()}),ha(43,"all on"),Ys(),zs(44,"button",4),$s("click",function(){return t.disableAll()}),ha(45,"all off"),Ys(),Ys(),Ys(),Gs(46,JA,6,1,"div",19),Gs(47,nk,5,2,"div",19),Ys(),Ys()),2&e&&(ho(7),Ws("ngIf",!t.demolishMode),ho(1),Ws("ngIf",t.demolishMode),ho(1),Ws("ngIf",!t.arrangeMode&&t.getBuildings().length>1),ho(1),Ws("ngIf",t.arrangeMode),ho(1),Ws("ngIf",!t.combineMode&&t.isUrbanPlanningEnabled()&&t.hasCombinableBuildings()),ho(1),Ws("ngIf",t.combineMode),ho(1),Ws("ngIf",!t.splitMode&&t.isUrbanPlanningEnabled()&&t.hasSplittableBuildings()),ho(1),Ws("ngIf",t.splitMode),ho(11),Ws("ngModel",t.filterBuilding),ho(1),Ws("value",t.allBuildings),ho(1),da(t.getBuildingName(t.allBuildings)),ho(1),Ws("ngForOf",t.getUniqueBuildingsFromCurrentView()),ho(1),Ws("ngModel",t.filterWorking),ho(1),Ws("value",t.buildingStates.ALL),ho(2),Ws("value",t.buildingStates.WORKING),ho(2),Ws("value",t.buildingStates.IDLE),ho(3),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga(" ",t.getUnemployed()," \xa0\xa0\xa0 "),ho(1),Ws("name","land"),ho(1),ga(" ",t.getFreeLand()," "),ho(6),Ws("ngIf",!t.isPagedViewEnabled()),ho(1),Ws("ngIf",t.isPagedViewEnabled()))},directives:[GR,Gl,YO,vO,DO,jO,XO,Ul,oT,hI,xl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}",""]}),e}(),ok=function e(t,i,n,r,o,s){p(this,e),this.id=t,this.resource=i,this.amount=n,this.buy=r,this.price=o,this.duration=s},sk=function(){var e=function(){function e(t,i,n,r,o,s,a){var u=this;p(this,e),this.servicesService=t,this.calendarService=i,this.managementService=n,this.resourcesService=r,this.logService=o,this.soundService=s,this.modalService=a,this.offers=[],this.id=10,this.typeRadio="all",this.servicesService.addService(Zv.MARKET,this),this.calendarService.registerForDayChange().subscribe(function(e){u.offers.forEach(function(e){e.duration-=1,0===e.duration&&u.autoBuy([e])}),u.offers=u.offers.filter(function(e){return e.duration>0})})}return S(e,[{key:"autoBuy",value:function(e){var t=this;e.forEach(function(e){var i=e.amount,n=t.resourcesService.getResource(e.resource);if(e.buy&&n.options.autoTrade.autoBuyEnabled){var r=n.options.autoTrade.autoBuyAmount;n.options.autoTrade.autoBuyPercentage&&(r=Math.floor(n.limit*n.options.autoTrade.autoBuyAmount/100));var o=n.options.autoTrade.autoBuyOrder;n.amount+o<r&&r-n.amount>o&&(o=r-n.amount),i>o&&(i=o);var s=t.resourcesService.getLimit(e.resource);i>s&&(i=s),i>0&&t.resourcesService.decreaseResource(Mv.COINS,t.calculatePrice(e,i),"Auto trade",!0)&&(t.resourcesService.increaseResource(e.resource,i,"Auto trade",!0),n.options.autoTrade.autoBuyOrder>0&&(n.options.autoTrade.autoBuyOrder-=i,n.options.autoTrade.autoBuyOrder<0&&(n.options.autoTrade.autoBuyOrder=0)),t.managementService.getLogAutoTrade()&&t.logService.log("auto bought "+i+" "+Qv.prepareResourceName(e.resource))),e.amount===Number(i)?t.offers.splice(t.offers.indexOf(e),1):(e.price=t.calculatePrice(e,e.amount-i),e.amount-=i)}else if(!e.buy&&n.options.autoTrade.autoSellEnabled){var a=n.options.autoTrade.autoSellAmount;n.options.autoTrade.autoSellPercentage&&(a=Math.floor(n.limit*n.options.autoTrade.autoSellAmount/100));var u=n.options.autoTrade.autoSellOrder;a<n.amount-u&&(u=n.amount-a),i>u&&(i=u),i>0&&t.resourcesService.decreaseResource(e.resource,i,"Auto trade",!0)&&(t.resourcesService.increaseResource(Mv.COINS,t.calculatePrice(e,i),"Auto trade",!0),n.options.autoTrade.autoSellOrder>0&&(n.options.autoTrade.autoSellOrder-=i,n.options.autoTrade.autoSellOrder<0&&(n.options.autoTrade.autoSellOrder=0)),t.managementService.getLogAutoTrade()&&t.logService.log("auto sold "+i+" "+Qv.prepareResourceName(e.resource))),e.amount===Number(i)?t.offers.splice(t.offers.indexOf(e),1):(e.price=t.calculatePrice(e,e.amount-i),e.amount-=i)}})}},{key:"nextId",value:function(){return this.id+=1,this.id-1}},{key:"getName",value:function(){return"MarketService"}},{key:"load",value:function(e){this.offers=e.offers,this.id=e.id}},{key:"save",value:function(){return{offers:this.offers,id:this.id}}},{key:"reset",value:function(e,t){this.offers=[],this.id=10}},{key:"getOffers",value:function(){return this.offers}},{key:"accept",value:function(e){var t=this,i=this.offers.find(function(t){return t.id===e}),n=!1;if(i){this.modalService.open(_v.MARKET),this.modalService.setModalValue(i);var r=this.modalService.registerForValueResponse().subscribe(function(e){if(r.unsubscribe(),null!==e&&!isNaN(e)){if(e>i.amount&&(e=i.amount),i.buy)if(e>t.resourcesService.getLimit(i.resource)){t.modalService.open(_v.CONFIRM),t.modalService.setModalText("Selected amount exceeds available warehouse space.<br>Would you like to buy anyway?");var o=t.modalService.registerForConfirmation().subscribe(function(n){if(o.unsubscribe(),n){if(!t.resourcesService.decreaseResource(Mv.COINS,t.calculatePrice(i,e),"Market",!0))return void t.modalService.info("Not enough coins to buy "+e+" "+Qv.prepareResourceName(i.resource));t.resourcesService.increaseResource(i.resource,e,"Market",!0),i.amount===Number(e)?t.offers.splice(t.offers.indexOf(i),1):(i.price=t.calculatePrice(i,i.amount-e),i.amount-=e)}})}else{if(!t.resourcesService.decreaseResource(Mv.COINS,t.calculatePrice(i,e),"Market",!0))return void t.modalService.info("Not enough coins to buy "+e+" "+Qv.prepareResourceName(i.resource));t.resourcesService.increaseResource(i.resource,e,"Market",!0),n=!0}else{if(!t.resourcesService.decreaseResource(i.resource,e,"Market",!0))return void t.modalService.info("Not enough resources to sell");t.resourcesService.increaseResource(Mv.COINS,t.calculatePrice(i,e),"Market",!0),n=!0}n&&(i.amount===Number(e)?t.offers.splice(t.offers.indexOf(i),1):(i.price=t.calculatePrice(i,i.amount-e),i.amount-=e))}})}else this.modalService.info("Market offer not found")}},{key:"callMerchant",value:function(){for(var e=Array.from(this.resourcesService.getResources().values()).filter(function(e){return e.isVisible()}).map(function(e){return{item:e.resource,chance:e.prioritise?15:1}}),t=sp.randomBetween(3,8),i=sp.randomBetween(50,180),n=0;n<t;n++){var r=sp.randomWeightedExcept(e,[Mv.COINS]),o=sp.randomBetween(5,20),s=sp.randomBetween(0,1),a=sp.randomBetween(-5,25),u=cm.getResource(r).TRADE_VALUE*o;0===(u=s?Math.floor(u*(1+a/100)):Math.floor(u*(1-a/100)))?n--:this.offers.push(new ok(this.nextId(),r,o,!!s,u,i))}this.managementService.getLogMerchant()&&this.logService.log("Merchant arrived"),this.soundService.playMarket(),this.autoBuy(this.offers)}},{key:"calculatePrice",value:function(e,t){return e.buy?Math.ceil(t/e.amount*e.price):Math.floor(t/e.amount*e.price)}},{key:"dismiss",value:function(e){this.offers=this.offers.filter(function(t){return t.id!==e})}},{key:"getTypeRadio",value:function(){return this.typeRadio}},{key:"setTypeRadio",value:function(e){this.typeRadio=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Im),An(DR),An(DE),An(Cm),An(Tm),An(Jv))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function ak(e,t){1&e&&(zs(0,"span",18),ha(1,"No Marketplace available. No merchant will visit."),Ys())}function uk(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta().$implicit,n=ta();ho(1),ga("",n.getResourceName(i.resource)," buy offer")}}function ck(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta().$implicit,n=ta();ho(1),ga("",n.getResourceName(i.resource)," sell offer")}}function lk(e,t){if(1&e){var i=qs();zs(0,"button",24),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().accept(e.id)}),ha(1,"Buy"),Ys()}}function hk(e,t){if(1&e){var i=qs();zs(0,"button",24),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().accept(e.id)}),ha(1,"Sell"),Ys()}}function dk(e,t){if(1&e){var i=qs();zs(0,"button",24),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().dismiss(e.id)}),ha(1,"Dismiss"),Ys()}}function gk(e,t){if(1&e&&(zs(0,"div",19),zs(1,"span",20),Gs(2,uk,2,1,"div",21),Gs(3,ck,2,1,"div",21),js(4,"hr"),ha(5),js(6,"br"),ha(7),js(8,"br"),js(9,"br"),ha(10),Ys(),zs(11,"div",22),ha(12),js(13,"app-icon",3),Ys(),zs(14,"div",22),ha(15),js(16,"app-icon",3),Ys(),zs(17,"div",22),ha(18),Ys(),zs(19,"div"),Gs(20,lk,2,0,"button",23),Gs(21,hk,2,0,"button",23),Gs(22,dk,2,0,"button",23),Ys(),Ys()),2&e){var i=t.$implicit,n=ta();Ws("elementId",i.id),ho(1),ia("id",i.id),ho(1),Ws("ngIf",i.buy),ho(1),Ws("ngIf",!i.buy),ho(2),ga(" total price: ",i.price,""),ho(2),ga(" piece price: ",n.calculatePiecePrice(i),""),ho(3),fa(" storage: ",n.getResourceAmount(i),"/",n.getResourceLimit(i)," "),ho(2),ga(" ",i.amount," "),ho(1),Ws("name",n.getResourceName(i.resource))("path","resources"),ho(2),ga(" ",i.price," "),ho(1),Ws("name","coins")("path","resources"),ho(2),ga(" ",i.duration," days "),ho(2),Ws("ngIf",i.buy),ho(1),Ws("ngIf",!i.buy),ho(1),Ws("ngIf",n.dismissMode)}}var fk=function(){var e=function(){function e(t,i,n){p(this,e),this.marketService=t,this.villageService=i,this.resourcesService=n,this.filterText="",this.typeRadio="all",this.dismissMode=!1}return S(e,[{key:"ngOnInit",value:function(){this.typeRadio=this.marketService.getTypeRadio()}},{key:"getOffers",value:function(){var e,t=this;return e=null!==this.filterText&&this.filterText.length>0?this.marketService.getOffers().filter(function(e){return Qv.prepareResourceName(e.resource).toLowerCase().includes(t.filterText)}):this.marketService.getOffers(),"buy"===this.typeRadio?e=e.filter(function(e){return e.buy}):"sell"===this.typeRadio&&(e=e.filter(function(e){return!e.buy})),e}},{key:"getCoins",value:function(){return this.resourcesService.getResource(Mv.COINS).amount}},{key:"accept",value:function(e){this.marketService.accept(e)}},{key:"isMarketBuilt",value:function(){return void 0!==this.villageService.getBuildings().find(function(e){return e.getBuildingType()===Pv.MARKETPLACE})}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"calculatePiecePrice",value:function(e){return this.marketService.calculatePrice(e,1)}},{key:"getResourceAmount",value:function(e){return this.resourcesService.getResource(e.resource).amount}},{key:"getResourceLimit",value:function(e){return this.resourcesService.getResource(e.resource).limit}},{key:"dismiss",value:function(e){this.marketService.dismiss(e)}},{key:"updateTypeRadio",value:function(){this.marketService.setTypeRadio(this.typeRadio)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(sk),Bs(MR),Bs(DE))},e.\u0275cmp=it({type:e,selectors:[["app-market"]],decls:47,vars:10,consts:[["id","wrapper"],["id","title"],[1,"icon"],[3,"name","path"],["id","noMarket",4,"ngIf"],["id","market"],["id","offersBox"],[1,"boxTitle"],["id","headers"],["id","offers"],["class","offer tooltip","appTooltip","",3,"elementId",4,"ngFor","ngForOf"],["id","filterBox"],["id","filters"],["id","filter","type","text","placeholder","search",3,"ngModel","ngModelChange"],["type","radio","name","type","value","all",3,"ngModel","ngModelChange","change"],["type","radio","name","type","value","buy",3,"ngModel","ngModelChange","change"],["type","radio","name","type","value","sell",3,"ngModel","ngModelChange","change"],["type","checkbox","name","type","value","dismiss",3,"ngModel","ngModelChange"],["id","noMarket"],["appTooltip","",1,"offer","tooltip",3,"elementId"],[1,"tooltipOffer",3,"id"],[4,"ngIf"],[1,"icon2"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),zs(2,"span"),ha(3,"Market"),Ys(),Ys(),zs(4,"div",2),js(5,"app-icon",3),ha(6),Gs(7,ak,2,0,"span",4),Ys(),zs(8,"div",5),zs(9,"div",6),zs(10,"div",7),zs(11,"span"),ha(12,"Offers"),Ys(),Ys(),zs(13,"div",8),zs(14,"span"),ha(15,"offer"),Ys(),zs(16,"span"),ha(17,"price"),Ys(),zs(18,"span"),ha(19,"duration"),Ys(),zs(20,"span"),ha(21,"action"),Ys(),Ys(),zs(22,"div",9),Gs(23,gk,23,18,"div",10),Ys(),Ys(),zs(24,"div",11),zs(25,"div",7),zs(26,"span"),ha(27,"Filters"),Ys(),Ys(),zs(28,"div",12),zs(29,"input",13),$s("ngModelChange",function(e){return t.filterText=e}),Ys(),zs(30,"div"),zs(31,"label"),zs(32,"input",14),$s("ngModelChange",function(e){return t.typeRadio=e})("change",function(){return t.updateTypeRadio()}),Ys(),ha(33," All "),Ys(),js(34,"br"),zs(35,"label"),zs(36,"input",15),$s("ngModelChange",function(e){return t.typeRadio=e})("change",function(){return t.updateTypeRadio()}),Ys(),ha(37," Buy "),Ys(),js(38,"br"),zs(39,"label"),zs(40,"input",16),$s("ngModelChange",function(e){return t.typeRadio=e})("change",function(){return t.updateTypeRadio()}),Ys(),ha(41," Sell "),Ys(),js(42,"br"),js(43,"br"),zs(44,"label"),zs(45,"input",17),$s("ngModelChange",function(e){return t.dismissMode=e}),Ys(),ha(46," Dismiss "),Ys(),Ys(),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(5),Ws("name","coins")("path","resources"),ho(1),ga(" ",t.getCoins()," "),ho(1),Ws("ngIf",!t.isMarketBuilt()),ho(16),Ws("ngForOf",t.getOffers()),ho(6),Ws("ngModel",t.filterText),ho(3),Ws("ngModel",t.typeRadio),ho(4),Ws("ngModel",t.typeRadio),ho(4),Ws("ngModel",t.typeRadio),ho(5),Ws("ngModel",t.dismissMode))},directives:[oT,Gl,Ul,qR,vO,DO,GO,jR,sT],styles:["#wrapper[_ngcontent-%COMP%]{margin:.5%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.boxTitle[_ngcontent-%COMP%]{text-align:center;border-bottom:black solid 2px}#side[_ngcontent-%COMP%]{float:right;font-size:1em;width:25%;margin:.5%;display:inline-block;vertical-align:bottom}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}#headers[_ngcontent-%COMP%]{margin:3px 3px 0;display:flex;flex-direction:row;width:96.5%;text-align:center;font-size:1em;font-weight:bold}#headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:0 0 24%;padding:2px;border:black solid 1px;border-left:none}#headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{border-left:black solid 1px}#market[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 2px;height:91.5%}#offersBox[_ngcontent-%COMP%]{display:flex;flex:0 0 85%;flex-direction:column;border-right:black solid 2px;height:100%;font-size:1.2em}#filterBox[_ngcontent-%COMP%]{display:flex;flex:0 0 15%;flex-direction:column;height:100%;font-size:1.2em}#offers[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:100%;overflow-y:auto}.offer[_ngcontent-%COMP%]{flex:0 0 auto;width:98%;display:flex;flex-direction:row;border:black solid 1px;margin:3px}.offer[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:0 0 24%;padding:2px}.offer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.8em}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}#filter[_ngcontent-%COMP%]{width:90%}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.icon2[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}#noMarket[_ngcontent-%COMP%]{margin-left:112px;color:var(--negative-colour)}"]}),e}(),vk=function(){var e=function(){function e(t,i,n){p(this,e),this.servicesService=t,this.calendarService=i,this.optionsService=n,this.forecastPeriod=1,this.forecast=[],t.addService(Zv.WEATHER,this),this.tick(0)}return S(e,[{key:"getName",value:function(){return"WeatherService"}},{key:"load",value:function(e){this.forecastPeriod=void 0!==e.forecastPeriod?e.forecastPeriod:1,this.forecast=e.forecast}},{key:"save",value:function(){return{forecastPeriod:this.forecastPeriod,forecast:this.forecast}}},{key:"reset",value:function(e,t){this.forecastPeriod=1,this.forecast=[],this.today=null,this.tick(0)}},{key:"tick",value:function(e){for(var t=this.calendarService.getAbsoluteDay();this.forecast.length>0&&this.forecast[0][0]<t;)this.forecast.shift();for(;this.forecast.length<this.forecastPeriod;){var i=t;0!==this.forecast.length&&(i=this.forecast[this.forecast.length-1][0]+1),this.forecast.push(this.predictDay(i))}this.today=this.forecast[0]}},{key:"predictDay",value:function(e){var t,i;switch(this.calendarService.getSeasonForAbsoluteDay(e)){case ym.SPRING:t=sp.randomBetween(10,25),i=sp.randomElement([{item:tp.SUN,chance:40},{item:tp.CLOUDS,chance:25},{item:tp.WIND,chance:14},{item:tp.RAIN,chance:20},{item:tp.STORM,chance:1}]);break;case ym.SUMMER:t=sp.randomBetween(15,35),i=sp.randomElement([{item:tp.SUN,chance:50},{item:tp.CLOUDS,chance:10},{item:tp.WIND,chance:10},{item:tp.RAIN,chance:20},{item:tp.STORM,chance:10}]);break;case ym.AUTUMN:t=sp.randomBetween(10,25),i=sp.randomElement([{item:tp.SUN,chance:20},{item:tp.CLOUDS,chance:40},{item:tp.WIND,chance:10},{item:tp.RAIN,chance:25},{item:tp.STORM,chance:5}]);break;case ym.WINTER:t=sp.randomBetween(-20,5),i=sp.randomElement([{item:tp.SUN,chance:30},{item:tp.CLOUDS,chance:20},{item:tp.WIND,chance:15},{item:tp.SNOW,chance:25},{item:tp.STORM,chance:10}])}return[e,i,t]}},{key:"getCurrentWeather",value:function(){return this.today[1]}},{key:"getCurrentTemperature",value:function(){return this.optionsService.getOption(Xv.METRIC)?this.today[2]:1.8*this.today[2]+32}},{key:"increaseForecastPeriod",value:function(e){this.forecastPeriod+=e}},{key:"isWeather",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.includes(this.getCurrentWeather())}},{key:"getForecast",value:function(){return this.forecast}},{key:"getForecastPeriod",value:function(){return this.forecastPeriod}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Im),An(Om))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function pk(e,t){if(1&e){var i=qs();zs(0,"button",5),$s("click",function(){return Kt(i),ta().progress10Days()}),ha(1,"Progress 10 days"),Ys()}}function mk(e,t){1&e&&(zs(0,"span"),ha(1,"\xb0C"),Ys())}function Sk(e,t){1&e&&(zs(0,"span"),ha(1,"\xb0F"),Ys())}function Ek(e,t){1&e&&(zs(0,"span",11),ha(1,"today"),Ys())}function yk(e,t){if(1&e&&(zs(0,"span",11),ha(1),Ys()),2&e){var i=ta().index;ho(1),ga("+",i,"")}}function Rk(e,t){1&e&&(zs(0,"span"),ha(1,"\xb0C"),Ys())}function Ok(e,t){1&e&&(zs(0,"span"),ha(1,"\xb0F"),Ys())}function Tk(e,t){if(1&e&&(zs(0,"div",8),Gs(1,Ek,2,0,"span",9),Gs(2,yk,2,1,"span",9),js(3,"app-icon",3),zs(4,"span",10),ha(5),Hu(6,"number"),Gs(7,Rk,2,0,"span",4),Gs(8,Ok,2,0,"span",4),Ys(),Ys()),2&e){var i=t.$implicit,n=t.index,r=ta(2);ho(1),Ws("ngIf",0===n),ho(1),Ws("ngIf",0!==n),ho(1),Ws("name",r.getWeatherName(i[1]))("path","weather"),ho(2),da(Bu(6,7,r.calculateTemp(i[2]),"0.0-1")),ho(2),Ws("ngIf",r.metric),ho(1),Ws("ngIf",!r.metric)}}function Ik(e,t){if(1&e&&(zs(0,"div"),ha(1,"Weather forecast: "),zs(2,"div",6),Gs(3,Tk,9,10,"div",7),Ys(),Ys()),2&e){var i=ta();ho(3),Ws("ngForOf",i.getForecast())}}var bk=function(){var e=function(){function e(t,i,n){var r=this;p(this,e),this.weatherService=t,this.calendarService=i,this.optionsService=n,this.metric=this.optionsService.getOption(Xv.METRIC),this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(function(){return r.metric=r.optionsService.getOption(Xv.METRIC)}))}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getTodayWeather",value:function(){return this.weatherService.getCurrentWeather()}},{key:"getTodayTemperature",value:function(){return this.weatherService.getCurrentTemperature()}},{key:"getWeatherName",value:function(e){return tp[e].toLowerCase()}},{key:"getForecast",value:function(){return this.weatherService.getForecast()}},{key:"getForecastPeriod",value:function(){return this.weatherService.getForecastPeriod()}},{key:"calculateTemp",value:function(e){return this.optionsService.getOption(Xv.METRIC)?e:1.8*e+32}},{key:"isDev",value:function(){return!Cp.production}},{key:"progress10Days",value:function(){this.calendarService.progressDays(10)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(vk),Bs(Im),Bs(Om))},e.\u0275cmp=it({type:e,selectors:[["app-weather"]],decls:13,vars:11,consts:[["id","wrapper"],["id","title"],[3,"click",4,"ngIf"],[3,"name","path"],[4,"ngIf"],[3,"click"],["id","forecast"],["class","weather",4,"ngFor","ngForOf"],[1,"weather"],["class","day",4,"ngIf"],["id","temp"],[1,"day"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),zs(2,"span"),ha(3,"Weather"),Ys(),Ys(),Gs(4,pk,2,0,"button",2),ha(5),js(6,"app-icon",3),js(7,"br"),ha(8),Hu(9,"number"),Gs(10,mk,2,0,"span",4),Gs(11,Sk,2,0,"span",4),Gs(12,Ik,4,1,"div",4),Ys()),2&e&&(ho(4),Ws("ngIf",t.isDev()),ho(1),ga(" Weather: ",t.getWeatherName(t.getTodayWeather())," "),ho(1),Ws("name",t.getWeatherName(t.getTodayWeather()))("path","weather"),ho(2),ga(" Temperature: ",Bu(9,8,t.getTodayTemperature(),"0.0-1"),""),ho(2),Ws("ngIf",t.metric),ho(1),Ws("ngIf",!t.metric),ho(1),Ws("ngIf",t.getForecastPeriod()>1))},directives:[Gl,oT,Ul],pipes:[$l],styles:["#wrapper[_ngcontent-%COMP%]{margin:.5%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#forecast[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;text-align:center;overflow-x:auto}.weather[_ngcontent-%COMP%]{display:flex;flex:0 0 40px;flex-direction:column;border-right:black solid 1px}.day[_ngcontent-%COMP%]{width:60px;border-bottom:black solid 1px}"]}),e}(),Ck=function(){var e=function(){function e(t,i){p(this,e),this.gameService=t,this.router=i,this.lastRegion=Yv.VILLAGE}return S(e,[{key:"canActivate",value:function(e,t){switch(e.routeConfig.path){case"redirect":var i="/regions/"+Yv[this.lastRegion].toLowerCase();return this.router.navigate([i],{skipLocationChange:!1}),!1;case"crafting":return!!this.gameService.isEnabled(wv.CRAFTING)||(this.goToError(),!1);case"market":return!!this.gameService.isEnabled(wv.MARKET)||(this.goToError(),!1);case"research":return!!this.gameService.isEnabled(wv.RESEARCH)||(this.goToError(),!1);case"army":return!!this.gameService.isEnabled(wv.ARMY)||(this.goToError(),!1);case"religion":return!!this.gameService.isEnabled(wv.RELIGION)||(this.goToError(),!1);case"weather":return!!this.gameService.isEnabled(wv.WEATHER)||(this.goToError(),!1);case"world":return!!this.gameService.isEnabled(wv.CARTOGRAPHY)||(this.goToError(),!1);case"navy":return!!this.gameService.isEnabled(wv.NAVY)||(this.goToError(),!1);case"heritage":return!!this.gameService.isEnabled(wv.HERITAGE)||(this.goToError(),!1);case"village":return this.lastRegion=Yv.VILLAGE,!0;case"forest":return this.lastRegion=Yv.FOREST,!0;case"mountains":return this.gameService.isEnabled(wv.MOUNTAINS)?(this.lastRegion=Yv.MOUNTAINS,!0):(this.goToError(),!1);case"fort":return this.gameService.isEnabled(wv.FORT)?(this.lastRegion=Yv.FORT,!0):(this.goToError(),!1);case"sea":return this.gameService.isEnabled(wv.SEA)?(this.lastRegion=Yv.SEA,!0):(this.goToError(),!1);case"field":return this.gameService.isEnabled(wv.FIELD)?(this.lastRegion=Yv.FIELD,!0):(this.goToError(),!1);case"plateau":return this.gameService.isEnabled(wv.PLATEAU)?(this.lastRegion=Yv.PLATEAU,!0):(this.goToError(),!1);default:return!1}}},{key:"goToError",value:function(){this.router.navigate(["/404"],{skipLocationChange:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(_m),An(sv))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ak=function(){var e=function(){function e(t){p(this,e),this.router=t}return S(e,[{key:"ngOnInit",value:function(){}},{key:"goToVillage",value:function(){this.router.navigate(["/village"])}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(sv))},e.\u0275cmp=it({type:e,selectors:[["app-not-found"]],decls:5,vars:0,consts:[["id","wrapper"],[3,"click"]],template:function(e,t){1&e&&(zs(0,"div",0),ha(1," Page not found "),js(2,"br"),zs(3,"button",1),$s("click",function(){return t.goToVillage()}),ha(4,"Village"),Ys(),Ys())},styles:["#wrapper[_ngcontent-%COMP%]{margin:10px;font-size:4vw;text-align:center}button[_ngcontent-%COMP%]{font-size:1.5vw}"]}),e}();function kk(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),fa(" Usages: ",i.perk.usages,"/",i.perk.maxUsages," ")}}function Nk(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga(" Usages: ",i.perk.usages,"/unlimited ")}}function _k(e,t){if(1&e){var i=qs();zs(0,"div",2),$s("click",function(){return Kt(i),ta().unlock()}),zs(1,"div",3),zs(2,"div",4),ha(3),Ys(),Ys(),zs(4,"span",5),js(5,"div",6),js(6,"br"),js(7,"hr"),ha(8),js(9,"br"),Gs(10,kk,2,2,"div",7),Gs(11,Nk,2,1,"div",7),Ys(),Ys()}if(2&e){var n=ta();Ws("elementId",n.id),ho(3),ga(" ",n.getPerkName()," "),ho(1),ia("id",n.id),ho(1),Ws("innerHTML",n.perk.description,dr),ho(3),ga(" Cost: ",n.perk.cost," RP "),ho(2),Ws("ngIf",n.perk.maxUsages>0),ho(1),Ws("ngIf",0===n.perk.maxUsages)}}function wk(e,t){1&e&&js(0,"app-icon",11),2&e&&Ws("name","tick")}function Pk(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),fa(" Usages: ",i.perk.usages,"/",i.perk.maxUsages," ")}}function Mk(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga(" Usages: ",i.perk.usages,"/unlimited ")}}function Dk(e,t){if(1&e&&(zs(0,"div",8),zs(1,"div",9),zs(2,"div",4),Gs(3,wk,1,1,"app-icon",10),ha(4),Ys(),Ys(),zs(5,"span",5),js(6,"div",6),js(7,"br"),js(8,"hr"),ha(9),js(10,"br"),Gs(11,Pk,2,2,"div",7),Gs(12,Mk,2,1,"div",7),Ys(),Ys()),2&e){var i=ta();Ws("elementId",i.id),ho(3),Ws("ngIf",i.perk.usages===i.perk.maxUsages&&i.perk.maxUsages>0),ho(1),ga("",i.getPerkName()," "),ho(1),ia("id",i.id),ho(1),Ws("innerHTML",i.perk.description,dr),ho(3),ga(" Cost: ",i.perk.cost," RP "),ho(2),Ws("ngIf",i.perk.maxUsages>0),ho(1),Ws("ngIf",0===i.perk.maxUsages)}}var Lk=function(){var e=function(){function e(t){p(this,e),this.royalService=t,this.id=Math.random()}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getPerkName",value:function(){return Qv.preparePerkName(this.perk.perk)}},{key:"unlock",value:function(){this.royalService.unlock(this.perk)}},{key:"isAvailable",value:function(){return this.royalService.getRoyalPoints()>=this.perk.cost&&(0===this.perk.maxUsages||this.perk.usages<this.perk.maxUsages)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(PE))},e.\u0275cmp=it({type:e,selectors:[["app-royal-perk"]],inputs:{perk:"perk"},decls:2,vars:2,consts:[["id","wrapper","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","wrapperNotAvailable","class","tooltip","appTooltip","",3,"elementId",4,"ngIf"],["id","wrapper","appTooltip","",1,"tooltip",3,"elementId","click"],["id","text"],[1,"icon"],[1,"perkTooltip",3,"id"],[3,"innerHTML"],[4,"ngIf"],["id","wrapperNotAvailable","appTooltip","",1,"tooltip",3,"elementId"],["id","titleGrey"],[3,"name",4,"ngIf"],[3,"name"]],template:function(e,t){1&e&&(Gs(0,_k,12,7,"div",0),Gs(1,Dk,13,8,"div",1)),2&e&&(Ws("ngIf",t.isAvailable()),ho(1),Ws("ngIf",!t.isAvailable()))},directives:[Gl,sT,oT],styles:["#wrapper[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:black solid 1px;font-size:1.2em}#wrapperNotAvailable[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:3px;text-align:center;border:#57575a solid 1px;cursor:auto;cursor:initial;font-size:1.2em}#text[_ngcontent-%COMP%]{display:inline-block}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#57575a}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}app-icon[_ngcontent-%COMP%]{margin-top:-15px;height:17px}.perkTooltip[_ngcontent-%COMP%]{min-width:400px}"]}),e}();function xk(e,t){1&e&&js(0,"app-royal-perk",8),2&e&&Ws("perk",t.$implicit)}function Fk(e,t){1&e&&js(0,"app-royal-perk",8),2&e&&Ws("perk",t.$implicit)}function Uk(e,t){1&e&&(zs(0,"span"),js(1,"app-icon",9),Ys()),2&e&&(ho(1),Ws("name","fish")("path","resources")("title","golden fish"))}function Hk(e,t){1&e&&(zs(0,"span"),js(1,"app-icon",9),Ys()),2&e&&(ho(1),Ws("name","egg")("path","resources")("title","golden egg"))}function Gk(e,t){1&e&&(zs(0,"span"),js(1,"app-icon",9),Ys()),2&e&&(ho(1),Ws("name","apple")("path","resources")("title","golden apple"))}function Bk(e,t){1&e&&(zs(0,"span"),js(1,"app-icon",9),Ys()),2&e&&(ho(1),Ws("name","wool")("path","resources")("title","golden fleece"))}var Wk=function(){var e=function(){function e(t,i){p(this,e),this.logService=t,this.royalService=i}return S(e,[{key:"ngOnInit",value:function(){}},{key:"buyRoyalPoints",value:function(){this.royalService.buyRoyalPoints()}},{key:"getRoyalPoints",value:function(){return this.royalService.getRoyalPoints()}},{key:"getRoyalPerks",value:function(){return this.royalService.getRoyalPerks()}},{key:"isGoldenFishCaught",value:function(){return this.royalService.isGoldenFishCaught()}},{key:"isGoldenEggFound",value:function(){return this.royalService.isGoldenEggLaid()}},{key:"isGoldenApplePicked",value:function(){return this.royalService.isGoldenApplePicked()}},{key:"isGoldenFleeceFound",value:function(){return this.royalService.isGoldenFleeceFound()}},{key:"getOneTimeUseRoyalPerks",value:function(){return this.royalService.getRoyalPerks().filter(function(e){return e.perk===Dv.MOTIVATION_SPEECH||e.perk===Dv.JESTER||e.perk===Dv.CALL_TO_ARMS||e.perk===Dv.ASTROLOGICAL_NOTE||e.perk===Dv.ROYAL_FESTIVAL||e.perk===Dv.ROYAL_RESERVE||e.perk===Dv.ANCIENT_SEA_MAPS||e.perk===Dv.HIRE_MERCENARIES||e.perk===Dv.HIRE_PIRATES||e.perk===Dv.ANCIENT_PROTECTION||e.perk===Dv.ROYAL_TRADITIONS})}},{key:"getPermanentUseRoyalPerks",value:function(){return this.royalService.getRoyalPerks().filter(function(e){return e.perk!==Dv.MOTIVATION_SPEECH&&e.perk!==Dv.JESTER&&e.perk!==Dv.CALL_TO_ARMS&&e.perk!==Dv.ASTROLOGICAL_NOTE&&e.perk!==Dv.ROYAL_FESTIVAL&&e.perk!==Dv.ROYAL_RESERVE&&e.perk!==Dv.ANCIENT_SEA_MAPS&&e.perk!==Dv.HIRE_MERCENARIES&&e.perk!==Dv.HIRE_PIRATES&&e.perk!==Dv.ANCIENT_PROTECTION&&e.perk!==Dv.ROYAL_TRADITIONS})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Cm),Bs(PE))},e.\u0275cmp=it({type:e,selectors:[["app-royal"]],decls:30,vars:7,consts:[["id","wrapper"],["id","title"],[1,"bold"],[3,"click"],[1,"groupTitle"],[3,"perk",4,"ngFor","ngForOf"],["id","goldenItems"],[4,"ngIf"],[3,"perk"],[3,"name","path","title"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"span",1),ha(2,"Royal perks"),Ys(),js(3,"br"),zs(4,"span"),ha(5,"You have "),zs(6,"span",2),ha(7),Ys(),ha(8," royal points."),js(9,"br"),ha(10," You can use them to acquire special upgrades."),Ys(),zs(11,"div"),zs(12,"button",3),$s("click",function(){return t.buyRoyalPoints()}),ha(13,"Buy Royal points"),Ys(),Ys(),zs(14,"div"),zs(15,"div",4),ha(16,"One time use perks"),Ys(),Gs(17,xk,1,1,"app-royal-perk",5),Ys(),js(18,"hr"),zs(19,"div"),zs(20,"div",4),ha(21,"Permanent perks"),Ys(),Gs(22,Fk,1,1,"app-royal-perk",5),Ys(),zs(23,"div",6),zs(24,"h4"),ha(25,"Golden items found:"),Ys(),Gs(26,Uk,2,3,"span",7),Gs(27,Hk,2,3,"span",7),Gs(28,Gk,2,3,"span",7),Gs(29,Bk,2,3,"span",7),Ys(),Ys()),2&e&&(ho(7),da(t.getRoyalPoints()),ho(10),Ws("ngForOf",t.getOneTimeUseRoyalPerks()),ho(5),Ws("ngForOf",t.getPermanentUseRoyalPerks()),ho(4),Ws("ngIf",t.isGoldenFishCaught()),ho(1),Ws("ngIf",t.isGoldenEggFound()),ho(1),Ws("ngIf",t.isGoldenApplePicked()),ho(1),Ws("ngIf",t.isGoldenFleeceFound()))},directives:[Ul,Gl,Lk,oT],styles:["#wrapper[_ngcontent-%COMP%]{margin:5px;display:flex;flex-direction:column}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.bold[_ngcontent-%COMP%]{font-weight:600}app-royal-perk[_ngcontent-%COMP%]{font-size:1em;display:inline-block;width:30%;margin:4px 8px;cursor:pointer}#goldenItems[_ngcontent-%COMP%]{margin-top:10px}.groupTitle[_ngcontent-%COMP%]{font-weight:bold;font-size:1.1em;text-align:center}"]}),e}(),Vk=(function(e){e[e.NONE=0]="NONE",e[e.SELECTED=1]="SELECTED",e[e.UNTIL_X=2]="UNTIL_X",e[e.CONTINUOUS=3]="CONTINUOUS",e[e.UNTIL_PERCENT=4]="UNTIL_PERCENT"}(Vk||(Vk={})),Vk),zk=function(){function e(t,i,n,r,o,s){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];p(this,e),this.canceled=!1,this.id=t,this.title=i,this.resource=n,this.amount=r,this.cost=o,this.craftingDifficulty=s,this.available=a}return S(e,[{key:"getResource",value:function(){return this.resource}}]),e}(),Yk=function(){var e=function(){function e(t,i){p(this,e),this.servicesService=t,this.resourcesService=i,this.recipes=[],t.addService(Zv.RECIPE,this),this.initRecipes()}return S(e,[{key:"initRecipes",value:function(){var e=this;this.recipes=[],Object.entries(gm.RECIPES).forEach(function(t){var i=new Map;t[1].COST.forEach(function(e){return i.set(e.resource,e.amount)}),e.recipes.push(new zk(ip[t[0]],void 0!==t[1].NAME?t[1].NAME:Qv.prepareResourceName(t[1].RESOURCE),t[1].RESOURCE,t[1].AMOUNT?t[1].AMOUNT:1,i,t[1].CRAFTING,!1))}),this.recipes.find(function(e){return e.id===ip.PLANK}).available=!0,this.recipes.find(function(e){return e.id===ip.CUT_STONE}).available=!0,Cp.production||Object.values(ip).filter(function(e){return!isNaN(e)}).forEach(function(t){return e.enable(t)})}},{key:"getRecipes",value:function(){return this.recipes.filter(function(e){return e.available})}},{key:"getCookingRecipes",value:function(){var e=this;return this.recipes.filter(function(t){return t.available&&e.resourcesService.getResource(t.resource).getResourceTypes().includes(Hv.CONSUMABLE)})}},{key:"getRecipeById",value:function(e){return this.recipes.find(function(t){return t.id===e})}},{key:"enable",value:function(e){var t=this,i=this.recipes.find(function(t){return t.id===e});this.resourcesService.makeVisible(i.getResource()),Array.from(i.cost.keys()).forEach(function(e){return t.resourcesService.makeVisible(e)}),i.available=!0}},{key:"disable",value:function(e){var t=this.recipes.find(function(t){return t.id===e});this.resourcesService.makeVisible(t.getResource()),t.available=!1}},{key:"getName",value:function(){return"RecipeService"}},{key:"load",value:function(e){var t=this;this.initRecipes(),e.recipes.forEach(function(e){var i=t.recipes.find(function(t){return t.id===e});i&&(i.available=!0)})}},{key:"save",value:function(){return{recipes:this.recipes.filter(function(e){return e.available}).map(function(e){return e.id})}}},{key:"reset",value:function(e,t){this.initRecipes()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(DE))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),jk=function(){var e=function(){function e(t,i,n,r){p(this,e),this.resourcesService=t,this.servicesService=i,this.recipeService=n,this.modalService=r,this.recipeUpdate=new U,this.craftingQueue=[],this.cookingQueue=[],this.id=1,this.craftingQueueSize=gm.START_CRAFTING_QUEUE_SIZE,this.cookingQueueSize=gm.START_COOKING_QUEUE_SIZE,this.craftingType=Vk.SELECTED,this.cookingType=Vk.SELECTED,i.addService(Zv.CRAFTING,this)}return S(e,[{key:"craft",value:function(e,t,i,n){this.craftingQueue.length>=this.craftingQueueSize?this.modalService.info("Crafting order queue is full"):e.shiftKey?this.craftingQueue.unshift({id:this.nextId(),recipe:t,amount:i,type:n}):this.craftingQueue.push({id:this.nextId(),recipe:t,amount:i,type:n})}},{key:"cook",value:function(e,t,i,n){this.cookingQueue.length>=this.cookingQueueSize?this.modalService.info("Cooking order queue is full"):e.shiftKey?this.cookingQueue.unshift({id:this.nextId(),recipe:t,amount:i,type:n}):this.cookingQueue.push({id:this.nextId(),recipe:t,amount:i,type:n})}},{key:"getCraftingQueue",value:function(){return this.craftingQueue}},{key:"getCookingQueue",value:function(){return this.cookingQueue}},{key:"getCraftingOrder",value:function(){var e=this,t=this.craftingQueue.find(function(t){if(t.type===Vk.SELECTED&&t.amount>0&&e.resourcesService.hasResources(t.recipe.cost,"Crafting")){var i=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(i+=t.recipe.amount)});var n=e.resourcesService.getResource(t.recipe.resource);return n.amount+i<n.limit}if(t.type===Vk.UNTIL_X&&e.resourcesService.hasResources(t.recipe.cost,"Crafting")){var r=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(r+=t.recipe.amount)});var o=e.resourcesService.getResource(t.recipe.resource);return o.limit<t.amount?o.amount+r<o.limit:o.amount+r<t.amount}if(t.type===Vk.UNTIL_PERCENT&&e.resourcesService.hasResources(t.recipe.cost,"Crafting")){var s=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(s+=t.recipe.amount)});var a=e.resourcesService.getResource(t.recipe.resource);return a.limit<Math.ceil(t.amount/100*a.limit)?a.amount+s<a.limit:a.amount+s<Math.ceil(t.amount/100*a.limit)}if(t.type===Vk.CONTINUOUS&&e.resourcesService.hasResources(t.recipe.cost,"Crafting")){var u=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.WORKSHOP}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(u+=t.recipe.amount)});var c=e.resourcesService.getResource(t.recipe.resource);return c.amount+u<c.limit}});return t?(this.resourcesService.decreaseResources(t.recipe.cost,"Crafting"),t.type===Vk.SELECTED&&(t.amount-=1),this.craftingQueue=this.craftingQueue.filter(function(e){return e.type!==Vk.SELECTED||e.amount>0}),t.recipe):null}},{key:"getCookingOrder",value:function(){var e=this,t=this.cookingQueue.find(function(t){if(t.type===Vk.SELECTED&&t.amount>0&&e.resourcesService.hasResources(t.recipe.cost,"Kitchen")){var i=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.KITCHEN}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(i+=t.recipe.amount)});var n=e.resourcesService.getResource(t.recipe.resource);return n.amount+i<n.limit}if(t.type===Vk.UNTIL_X&&e.resourcesService.hasResources(t.recipe.cost,"Kitchen")){var r=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.KITCHEN}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(r+=t.recipe.amount)});var o=e.resourcesService.getResource(t.recipe.resource);return o.limit<t.amount?o.amount+r<o.limit:o.amount+r<t.amount}if(t.type===Vk.UNTIL_PERCENT&&e.resourcesService.hasResources(t.recipe.cost,"Kitchen")){var s=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.KITCHEN}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(s+=t.recipe.amount)});var a=e.resourcesService.getResource(t.recipe.resource);return a.limit<Math.ceil(t.amount/100*a.limit)?a.amount+s<a.limit:a.amount+s<Math.ceil(t.amount/100*a.limit)}if(t.type===Vk.CONTINUOUS&&e.resourcesService.hasResources(t.recipe.cost,"Kitchen")){var u=0;e.servicesService.getVillageService().buildings.filter(function(e){return e.getBuildingType()===Pv.KITCHEN}).forEach(function(e){e.getRecipe()&&e.getRecipe().id===t.recipe.id&&(u+=t.recipe.amount)});var c=e.resourcesService.getResource(t.recipe.resource);return c.amount+u<c.limit}});return t?(this.resourcesService.decreaseResources(t.recipe.cost,"Kitchen"),t.type===Vk.SELECTED&&(t.amount-=1),this.cookingQueue=this.cookingQueue.filter(function(e){return e.type!==Vk.SELECTED||e.amount>0}),t.recipe):null}},{key:"getName",value:function(){return"CraftingService"}},{key:"load",value:function(e){var t=this;this.craftingQueue=[],this.cookingQueue=[],Array.from(e.queue).forEach(function(e){t.craftingQueue.push({id:t.nextId(),recipe:t.recipeService.getRecipeById(e.recipeId),amount:e.amount,type:e.type})}),void 0!==e.cookingQueue&&Array.from(e.cookingQueue).forEach(function(e){t.cookingQueue.push({id:t.nextId(),recipe:t.recipeService.getRecipeById(e.recipeId),amount:e.amount,type:e.type})}),this.craftingQueueSize=e.queueSize,this.cookingQueueSize=void 0!==e.cookingQueueSize?e.cookingQueueSize:gm.START_COOKING_QUEUE_SIZE}},{key:"save",value:function(){return{queue:this.craftingQueue.map(function(e){return{recipeId:e.recipe.id,amount:e.amount,type:e.type}}),cookingQueue:this.cookingQueue.map(function(e){return{recipeId:e.recipe.id,amount:e.amount,type:e.type}}),queueSize:this.craftingQueueSize,cookingQueueSize:this.cookingQueueSize}}},{key:"reset",value:function(e,t){this.craftingQueue=[],this.cookingQueue=[],this.id=1,this.craftingQueueSize=gm.START_CRAFTING_QUEUE_SIZE,this.cookingQueueSize=gm.START_COOKING_QUEUE_SIZE}},{key:"registerForUpdate",value:function(){return this.recipeUpdate.asObservable()}},{key:"cancel",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.craftingQueue.find(function(t){return t.id===e});if(n)if(i)this.craftingQueue=this.craftingQueue.filter(function(t){return t.id!==e}),this.recipeUpdate.next();else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel crafting "+Qv.prepareResourceName(n.recipe.resource)+"?");var r=this.modalService.registerForConfirmation().subscribe(function(i){i&&(t.craftingQueue=t.craftingQueue.filter(function(t){return t.id!==e}),t.recipeUpdate.next()),r.unsubscribe()})}else if(n=this.cookingQueue.find(function(t){return t.id===e}))if(i)this.cookingQueue=this.cookingQueue.filter(function(t){return t.id!==e}),this.recipeUpdate.next();else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel cooking "+Qv.prepareResourceName(n.recipe.resource)+"?");var o=this.modalService.registerForConfirmation().subscribe(function(i){i&&(t.cookingQueue=t.cookingQueue.filter(function(t){return t.id!==e}),t.recipeUpdate.next()),o.unsubscribe()})}}},{key:"nextId",value:function(){var e=this.id;return this.id++,e}},{key:"moveRecipeInCraftingQueue",value:function(e){zS(this.craftingQueue,e.previousIndex,e.currentIndex)}},{key:"moveRecipeInCookingQueue",value:function(e){zS(this.cookingQueue,e.previousIndex,e.currentIndex)}},{key:"getCraftingQueueMaxSize",value:function(){return this.craftingQueueSize}},{key:"getCookingQueueMaxSize",value:function(){return this.cookingQueueSize}},{key:"increaseCraftingQueueSize",value:function(e){this.craftingQueueSize+=e}},{key:"decreaseCraftingQueueSize",value:function(e){this.craftingQueueSize-=e}},{key:"increaseCookingQueueSize",value:function(e){this.cookingQueueSize+=e}},{key:"decreaseCookingQueueSize",value:function(e){this.cookingQueueSize-=e}},{key:"filterCraftingQueue",value:function(e){var t=this;this.craftingQueue.forEach(function(i){e.includes(i.recipe.id)&&t.cancel(i.id,!0)})}},{key:"setCraftingType",value:function(e){this.craftingType=e}},{key:"setCookingType",value:function(e){this.cookingType=e}},{key:"getCookingType",value:function(){return this.cookingType}},{key:"getCraftingType",value:function(){return this.craftingType}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(DE),An($v),An(Yk),An(Jv))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Kk(e,t){1&e&&(zs(0,"a",3),ha(1,"Cooking"),Ys())}var Qk=function(){var e=function(){function e(t){p(this,e),this.gameService=t}return S(e,[{key:"ngOnInit",value:function(){}},{key:"isCookingEnabled",value:function(){return this.gameService.isEnabled(wv.KITCHEN)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-crafting-top-menu"]],decls:4,vars:1,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","routerLink","/crafting/crafting","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/crafting/cooking","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/crafting/cooking","routerLinkActive","active",1,"entry"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"a",1),ha(2,"Crafting"),Ys(),Gs(3,Kk,2,0,"a",2),Ys()),2&e&&(ho(3),Ws("ngIf",t.isCookingEnabled()))},directives:[uv,lv,Gl],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:row}.entry[_ngcontent-%COMP%]{flex:auto;display:flex;justify-content:center;flex-direction:column;height:100%;text-align:center;border-right:black solid 2px;border-bottom:black solid 1px;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry[_ngcontent-%COMP%]:last-of-type{border:none;border-bottom:black solid 1px}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour)}"]}),e}();function qk(e,t){if(1&e&&(zs(0,"div",12),ha(1),Ys()),2&e){var i=ta(2);ho(1),da(i.amount)}}function Xk(e,t){if(1&e&&(zs(0,"div",12),ha(1),Ys()),2&e){var i=ta(2);ho(1),fa("",i.getResourceAmount(),"/",i.amount,"")}}function Zk(e,t){if(1&e&&(zs(0,"div",12),ha(1),Ys()),2&e){var i=ta(2);ho(1),fa("",i.getResourceAmountPercentage(),"%/",i.amount,"%")}}function $k(e,t){1&e&&(zs(0,"div",12),ha(1,"\u221e"),Ys())}function Jk(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta(2);ho(1),ga(" (",i.getCurrentlyCrafted(),") ")}}function eN(e,t){if(1&e&&(zs(0,"div",8),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga("Crafted: ",i.recipe.amount,"")}}function tN(e,t){if(1&e&&(Ks(0),zs(1,"div"),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function iN(e,t){if(1&e&&(Ks(0),zs(1,"div",15),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function nN(e,t){if(1&e&&(zs(0,"div",13),Gs(1,tN,3,1,"ng-container",6),Gs(2,iN,3,1,"ng-container",6),js(3,"app-icon",14),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("ngIf",n.checkResource(i)),ho(1),Ws("ngIf",!n.checkResource(i)),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function rN(e,t){if(1&e){var i=qs();zs(0,"div",3),$s("click",function(){return Kt(i),ta().cancel()}),zs(1,"div",4),Gs(2,qk,2,1,"div",5),Gs(3,Xk,2,2,"div",5),Gs(4,Zk,2,2,"div",5),Gs(5,$k,2,0,"div",5),ha(6),Hu(7,"titlecase"),Gs(8,Jk,2,1,"ng-container",6),Ys(),zs(9,"span",7),ha(10),Hu(11,"titlecase"),js(12,"hr"),zs(13,"div",8),ha(14),Ys(),Gs(15,eN,2,1,"div",9),zs(16,"div",10),ha(17,"Cost:"),Ys(),Gs(18,nN,4,4,"div",11),Hu(19,"keyvalue"),Ys(),Ys()}if(2&e){var n=ta();Ws("elementId",n.id),ho(2),Ws("ngIf",n.type===n.craftingTypes.SELECTED),ho(1),Ws("ngIf",n.type===n.craftingTypes.UNTIL_X),ho(1),Ws("ngIf",n.type===n.craftingTypes.UNTIL_PERCENT),ho(1),Ws("ngIf",n.type===n.craftingTypes.CONTINUOUS),ho(1),ga(" ",Gu(7,12,n.recipe.title)," "),ho(2),Ws("ngIf",n.isStarted()),ho(1),ia("id",n.id),ho(1),ga(" ",Gu(11,14,n.getResourceName(n.recipe.resource))," "),ho(4),ga("Difficulty: ",n.recipe.craftingDifficulty,""),ho(1),Ws("ngIf",n.recipe.amount>1),ho(3),Ws("ngForOf",Gu(19,16,n.getCost()))}}function oN(e,t){if(1&e&&(zs(0,"div",12),ha(1),Ys()),2&e){var i=ta(2);ho(1),da(i.amount)}}function sN(e,t){if(1&e&&(zs(0,"div",12),ha(1),Ys()),2&e){var i=ta(2);ho(1),fa("",i.getResourceAmount(),"/",i.amount,"")}}function aN(e,t){if(1&e&&(zs(0,"div",12),ha(1),Ys()),2&e){var i=ta(2);ho(1),fa("",i.getResourceAmountPercentage(),"%/",i.amount,"%")}}function uN(e,t){1&e&&(zs(0,"div",12),ha(1,"\u221e"),Ys())}function cN(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta(2);ho(1),ga(" (",i.getCurrentlyCrafted(),") ")}}function lN(e,t){if(1&e&&(zs(0,"div",8),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga("Crafted: ",i.recipe.amount,"")}}function hN(e,t){if(1&e&&(Ks(0),zs(1,"div"),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function dN(e,t){if(1&e&&(Ks(0),zs(1,"div",15),ha(2),Ys(),Qs()),2&e){var i=ta().$implicit;ho(2),da(i.value)}}function gN(e,t){if(1&e&&(zs(0,"div",13),Gs(1,hN,3,1,"ng-container",6),Gs(2,dN,3,1,"ng-container",6),js(3,"app-icon",14),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("ngIf",n.checkResource(i)),ho(1),Ws("ngIf",!n.checkResource(i)),ho(1),Ws("name",n.getResourceName(i.key))("path","resources")}}function fN(e,t){if(1&e){var i=qs();zs(0,"div",16),$s("click",function(){return Kt(i),ta().cancel()}),zs(1,"div",17),Gs(2,oN,2,1,"div",5),Gs(3,sN,2,2,"div",5),Gs(4,aN,2,2,"div",5),Gs(5,uN,2,0,"div",5),ha(6),Hu(7,"titlecase"),Gs(8,cN,2,1,"ng-container",6),Ys(),zs(9,"span",7),ha(10),Hu(11,"titlecase"),js(12,"hr"),zs(13,"div",8),ha(14),Ys(),Gs(15,lN,2,1,"div",9),zs(16,"div",10),ha(17,"Cost:"),Ys(),Gs(18,gN,4,4,"div",11),Hu(19,"keyvalue"),Ys(),Ys()}if(2&e){var n=ta();Ws("elementId",n.id),ho(2),Ws("ngIf",n.type===n.craftingTypes.SELECTED),ho(1),Ws("ngIf",n.type===n.craftingTypes.UNTIL_X),ho(1),Ws("ngIf",n.type===n.craftingTypes.UNTIL_PERCENT),ho(1),Ws("ngIf",n.type===n.craftingTypes.CONTINUOUS),ho(1),ga(" ",Gu(7,12,n.recipe.title)," "),ho(2),Ws("ngIf",n.isStarted()),ho(1),ia("id",n.id),ho(1),ga(" ",Gu(11,14,n.getResourceName(n.recipe.resource))," "),ho(4),ga("Difficulty: ",n.recipe.craftingDifficulty,""),ho(1),Ws("ngIf",n.recipe.amount>1),ho(3),Ws("ngForOf",Gu(19,16,n.getCost()))}}var vN=function(){var e=function(){function e(t,i,n){p(this,e),this.craftingService=t,this.resourcesService=i,this.villageService=n,this.id=Math.random(),this.amount=1,this.type=Vk.NONE,this.craftingTypes=Vk}return S(e,[{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"ngOnInit",value:function(){}},{key:"cancel",value:function(){null!==this.id&&this.craftingService.cancel(this.id)}},{key:"getCost",value:function(){return this.recipe.cost}},{key:"isAvailable",value:function(){for(var e=0,i=Array.from(this.recipe.cost);e<i.length;e++){var n=t(i[e],2),r=n[0],o=n[1];if(0!==this.resourcesService.hasResource(r,o,"Crafting"))return!1}return!0}},{key:"checkResource",value:function(e){return 0===this.resourcesService.hasResource(e.key,e.value,"Crafting")}},{key:"getResourceAmount",value:function(){return this.resourcesService.getResource(this.recipe.resource).amount}},{key:"getCurrentlyCrafted",value:function(){var e=this;return this.villageService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.WORKSHOP&&e.isWorking()}).map(function(e){return e}).filter(function(t){return t.getRecipe()&&t.getRecipe().id===e.recipe.id}).length+this.villageService.getBuildings().filter(function(e){return e.getBuildingType()===Pv.KITCHEN&&e.isWorking()}).map(function(e){return e}).filter(function(t){return t.getRecipe()&&t.getRecipe().id===e.recipe.id}).length}},{key:"isStarted",value:function(){return this.id>=1&&this.getCurrentlyCrafted()>0}},{key:"getResourceAmountPercentage",value:function(){var e=this.resourcesService.getResource(this.recipe.resource);return Math.floor(e.amount/e.limit*100)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(jk),Bs(DE),Bs(MR))},e.\u0275cmp=it({type:e,selectors:[["app-recipe"]],inputs:{id:"id",recipe:"recipe",amount:"amount",type:"type"},decls:3,vars:2,consts:[["id","wrapper"],["id","available","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","notAvailable","class","tooltip","appTooltip","",3,"elementId","click",4,"ngIf"],["id","available","appTooltip","",1,"tooltip",3,"elementId","click"],["id","text"],["class","type",4,"ngIf"],[4,"ngIf"],[3,"id"],[1,"craftingTitle"],["class","craftingTitle",4,"ngIf"],[1,"costTitle"],["class","icon",4,"ngFor","ngForOf"],[1,"type"],[1,"icon"],[3,"name","path"],[1,"missing"],["id","notAvailable","appTooltip","",1,"tooltip",3,"elementId","click"],["id","titleGrey"]],template:function(e,t){1&e&&(zs(0,"div",0),Gs(1,rN,20,18,"div",1),Gs(2,fN,20,18,"div",2),Ys()),2&e&&(ho(1),Ws("ngIf",t.isAvailable()),ho(1),Ws("ngIf",!t.isAvailable()))},directives:[Gl,sT,Ul,oT],pipes:[ql,Xl],styles:["#wrapper[_ngcontent-%COMP%]{width:100%;display:inline-block}#available[_ngcontent-%COMP%]{position:relative;padding:3px;text-align:center;font-weight:100;font-size:1.1em;border:black solid 1px}#notAvailable[_ngcontent-%COMP%]{padding:3px;text-align:center;font-size:1.1em;border:#57575a solid 1px}#titleGrey[_ngcontent-%COMP%]{display:inline-block;color:#57575a}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}.title[_ngcontent-%COMP%]{text-align:left}hr[_ngcontent-%COMP%]{border-color:#000}#progressId[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;background-color:var(--active-colour);z-index:1}#text[_ngcontent-%COMP%]{position:relative;z-index:2}.costTitle[_ngcontent-%COMP%]{text-align:left}.missing[_ngcontent-%COMP%]{color:var(--negative-colour)}.tooltip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{min-width:200px}.craftingTitle[_ngcontent-%COMP%]{text-align:left}.type[_ngcontent-%COMP%]{display:inline-block}app-icon[_ngcontent-%COMP%]{flex:0 0 auto;margin-left:3px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center}"]}),e}();function pN(e,t){if(1&e&&(zs(0,"div",28),zs(1,"div",29),ha(2),Ys(),Ys()),2&e){var i=ta().$implicit;ho(2),da(i)}}function mN(e,t){if(1&e&&(zs(0,"div",30),zs(1,"div",29),ha(2),Ys(),Ys()),2&e){var i=ta().$implicit;ho(2),da(i)}}function SN(e,t){if(1&e){var i=qs();zs(0,"div",25),$s("click",function(){var e=Kt(i).$implicit;return ta().select(e)}),Gs(1,pN,3,1,"div",26),Gs(2,mN,3,1,"div",27),Ys()}if(2&e){var n=t.$implicit,r=ta();ho(1),Ws("ngIf",r.bookPage===n),ho(1),Ws("ngIf",r.bookPage!==n)}}function EN(e,t){if(1&e){var i=qs();zs(0,"app-recipe",31),$s("click",function(e){var t=Kt(i).$implicit;return ta().craft(e,t)}),Ys()}2&e&&Ws("recipe",t.$implicit)}function yN(e,t){if(1&e&&js(0,"app-recipe",32),2&e){var i=t.$implicit;Ws("recipe",i.recipe)("amount",i.amount)("type",i.type)("id",i.id)}}var RN=function(){var e=function(){function e(t,i,n,r,o){p(this,e),this.recipeService=t,this.resourcesService=i,this.craftingService=n,this.modalService=r,this.changeDetectorRef=o,this.craftingTypes=Vk,this.filterText="",this.amount=1,this.craftingType=this.craftingTypes.SELECTED,this.bookPage=Hv[Hv.ALL]}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.craftingService.registerForUpdate().subscribe(function(){e.changeDetectorRef.destroyed||e.changeDetectorRef.detectChanges()}),this.craftingType=this.craftingService.getCraftingType()}},{key:"getRecipes",value:function(){var e=this;return this.filterText&&this.filterText.length>0?this.recipeService.getRecipes().filter(function(t){return t.available&&(e.resourcesService.getResourceTypes(t.getResource()).includes(Hv[e.bookPage])&&t.title.toLowerCase().includes(e.filterText.toLowerCase())||e.resourcesService.getResourceTypes(t.getResource()).includes(Hv[e.bookPage])&&Qv.prepareResourceName(t.getResource()).toLowerCase().includes(e.filterText.toLowerCase()))}):this.recipeService.getRecipes().filter(function(t){return t.available&&e.resourcesService.getResourceTypes(t.getResource()).includes(Hv[e.bookPage])})}},{key:"getEntries",value:function(){var e=[];return e.push(Hv[Hv.ALL]),e.push(Hv[Hv.PROCESSED]),e.push(Hv[Hv.TOOLS]),e.push(Hv[Hv.FOOD]),e.push(Hv[Hv.OTHER]),e}},{key:"select",value:function(e){this.bookPage=e}},{key:"craft",value:function(e,t){this.validateAmountInput()&&this.craftingService.craft(e,t,this.amount,this.craftingType)}},{key:"getQueue",value:function(){return this.craftingService.getCraftingQueue()}},{key:"drop",value:function(e){this.craftingService.moveRecipeInCraftingQueue(e)}},{key:"getQueueMaxSize",value:function(){return this.craftingService.getCraftingQueueMaxSize()}},{key:"validateAmountInput",value:function(){return!(isNaN(this.amount)||Number(this.amount)<1)||(this.modalService.info("Invalid craft amount"),this.amount=1,!1)}},{key:"updateCraftingType",value:function(){this.craftingService.setCraftingType(this.craftingType)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Yk),Bs(DE),Bs(jk),Bs(Jv),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-crafting"]],decls:58,vars:18,consts:[["id","wrapper"],["id","title"],["id","boxes"],["id","recipes"],[1,"title"],[1,"icon"],["appTooltip","",1,"tooltip",3,"elementId"],[3,"name","title"],["id","help1"],["id","recipesBook"],["id","menu"],["class","entry",3,"click",4,"ngFor","ngForOf"],["id","book"],["id","side"],["id","filter"],["type","text",3,"ngModel","ngModelChange"],["id","amount"],["type","number","min","1",3,"ngModel","ngModelChange"],[1,"radios"],["type","radio","name","type",3,"ngModel","value","ngModelChange","change"],["id","bookRecipes"],[3,"recipe","click",4,"ngFor","ngForOf"],[1,"queue"],["id","queueRecipes","cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"recipe","amount","type","id",4,"ngFor","ngForOf"],[1,"entry",3,"click"],["class","activeEntry",4,"ngIf"],["class","inactiveEntry",4,"ngIf"],[1,"activeEntry"],[1,"entryText"],[1,"inactiveEntry"],[3,"recipe","click"],["cdkDrag","",3,"recipe","amount","type","id"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-crafting-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"span",4),zs(6,"span",5),ha(7,"Recipes "),zs(8,"div",6),js(9,"app-icon",7),zs(10,"span",8),ha(11," In this menu you can define orders for your workshops."),js(12,"br"),js(13,"br"),ha(14," Each workshop will try to take order from the orders lists starting from top."),js(15,"br"),js(16,"br"),ha(17," Only orders that meet requirements will be taken by workshops."),js(18,"br"),js(19,"br"),ha(20," You can add order to the top of the list by holding shift while clicking on a recipe. "),Ys(),Ys(),Ys(),Ys(),zs(21,"div",9),zs(22,"div",10),Gs(23,SN,3,2,"div",11),Ys(),zs(24,"div",12),zs(25,"div",13),zs(26,"div",14),ha(27," Filter:"),js(28,"br"),zs(29,"input",15),$s("ngModelChange",function(e){return t.filterText=e}),Ys(),Ys(),zs(30,"div",16),ha(31," amount:"),js(32,"br"),zs(33,"input",17),$s("ngModelChange",function(e){return t.amount=e}),Ys(),Ys(),zs(34,"div",18),zs(35,"label"),zs(36,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(37," selected amount "),Ys(),js(38,"br"),zs(39,"label"),zs(40,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(41," until X available "),Ys(),js(42,"br"),zs(43,"label"),zs(44,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(45," until % available "),Ys(),Ys(),zs(46,"div",18),zs(47,"label"),zs(48,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(49," continuous "),Ys(),Ys(),Ys(),zs(50,"div",20),Gs(51,EN,1,1,"app-recipe",21),Ys(),Ys(),Ys(),Ys(),zs(52,"div",22),zs(53,"span",4),ha(54,"Orders"),Ys(),ha(55),zs(56,"div",23),$s("cdkDropListDropped",function(e){return t.drop(e)}),Gs(57,yN,1,4,"app-recipe",24),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(8),Ws("elementId","help1"),ho(1),Ws("name","question")("title",""),ho(14),Ws("ngForOf",t.getEntries()),ho(6),Ws("ngModel",t.filterText),ho(4),Ws("ngModel",t.amount),ho(3),Ws("ngModel",t.craftingType)("value",t.craftingTypes.SELECTED),ho(4),Ws("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_X),ho(4),Ws("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_PERCENT),ho(4),Ws("ngModel",t.craftingType)("value",t.craftingTypes.CONTINUOUS),ho(3),Ws("ngForOf",t.getRecipes()),ho(4),fa(" ",t.getQueue().length,"/",t.getQueueMaxSize()," "),ho(2),Ws("ngForOf",t.getQueue()))},directives:[Qk,sT,oT,Ul,qR,vO,DO,tT,xO,GO,sE,Gl,vN,hE],styles:["#wrapper[_ngcontent-%COMP%]{height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#boxes[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:95%;margin:.5%;text-align:center}#recipes[_ngcontent-%COMP%]{text-align:center;flex:0 0 74.3%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.queue[_ngcontent-%COMP%]{text-align:center;flex:0 0 25%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}#queueRecipes[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden}#queueRecipes[_ngcontent-%COMP%] > app-recipe[_ngcontent-%COMP%]{min-width:80%}.title[_ngcontent-%COMP%]{width:100.5%;font-weight:bolder;font-size:1.1em;display:inline-block;border-bottom:black solid 1px}#modes[_ngcontent-%COMP%]{margin-top:-1px;padding:0;margin-bottom:5px}#recipesBook[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}#menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-right:black solid 1px;flex:0 0 10%}.entry[_ngcontent-%COMP%]{display:flex;border-bottom:black solid 1px;flex:1 0 0;height:100%;width:100%;margin-right:-30px;font-size:.8em;font-weight:600;cursor:pointer}.entry[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.entryText[_ngcontent-%COMP%]{-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-ms-transform:rotate(-90deg);-o-transform:rotate(-90deg)}.inactiveEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center}.activeEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center;background-color:var(--active-colour)}#book[_ngcontent-%COMP%]{flex:0 0 90%;width:100%}#bookRecipes[_ngcontent-%COMP%]{overflow-y:auto;border-top:black solid 1px;height:84.5%}app-recipe[_ngcontent-%COMP%]{font-size:.8em;display:inline-block;width:20%;min-width:130px;margin:4px 6px;cursor:pointer}#side[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-size:.8em;margin:1%;vertical-align:bottom}#filter[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:1.05em;margin-left:0;padding:0;border:none;outline:0}#amount[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#amount[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:65%;font-size:1.15em;margin-left:0;padding:0;border:none;outline:0}.radios[_ngcontent-%COMP%]{text-align:left;font-size:.9em}#progressButton[_ngcontent-%COMP%]{font-size:.6em}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:85px;margin:auto}#help1[_ngcontent-%COMP%]{font-size:.7em;font-weight:normal;text-align:left}"]}),e}();function ON(e,t){1&e&&(zs(0,"a",6),ha(1,"Forest"),Ys())}var TN=function(){var e=function(){function e(t){p(this,e),this.gameService=t}return S(e,[{key:"ngOnInit",value:function(){}},{key:"isForestManagementEnabled",value:function(){return this.gameService.isEnabled(wv.FORESTER)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-management-top-menu"]],decls:10,vars:1,consts:[["id","wrapper"],["draggable","false","ondragstart","return false;","routerLink","/management/general","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management/happiness","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management/effects","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/management/forestM","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/management/summary","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management/forestM","routerLinkActive","active",1,"entry"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"a",1),ha(2,"General"),Ys(),zs(3,"a",2),ha(4,"Happiness"),Ys(),zs(5,"a",3),ha(6,"Effects"),Ys(),Gs(7,ON,2,0,"a",4),zs(8,"a",5),ha(9,"Summary"),Ys(),Ys()),2&e&&(ho(7),Ws("ngIf",t.isForestManagementEnabled()))},directives:[uv,lv,Gl],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:row}.entry[_ngcontent-%COMP%]{flex:auto;display:flex;justify-content:center;flex-direction:column;height:100%;text-align:center;border-right:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry[_ngcontent-%COMP%]:last-of-type{border:none}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour)}"]}),e}();function IN(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span",4),ha(2),Ys(),zs(3,"div",5),zs(4,"input",49),$s("input",function(e){return Kt(i),ta().changeTaxRate(e)}),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(2),ga("tax/donation: ",10*n.getTaxRate(),"%"),ho(2),Ws("value",n.getTaxRate())}}function bN(e,t){if(1&e){var i=qs();Ks(0),zs(1,"input",50),$s("change",function(){return Kt(i),ta().updateComplexWorkers()}),Ys(),zs(2,"label",51),ha(3,"Enable automated work management for some buildings"),Ys(),Qs()}if(2&e){var n=ta();ho(1),Ws("checked",n.getComplexWorkers())}}function CN(e,t){if(1&e){var i=qs();zs(0,"div",55),zs(1,"span",56),js(2,"app-icon",57),zs(3,"span",58),zs(4,"button",59),$s("click",function(){var e=Kt(i).$implicit,t=ta().index;return ta().up(e,t)}),ha(5,"\u2191"),Ys(),zs(6,"button",59),$s("click",function(){var e=Kt(i).$implicit,t=ta().index;return ta().down(e,t)}),ha(7,"\u2193"),Ys(),Ys(),Ys(),Ys()}if(2&e){var n=t.$implicit,r=ta(2);ho(2),Ws("name",r.getResourceName(n))("path","resources")}}function AN(e,t){if(1&e&&(zs(0,"div",52),zs(1,"span",53),ha(2),Ys(),Gs(3,CN,8,2,"div",54),Ys()),2&e){var i=t.$implicit,n=t.index;ho(2),da(n+1),ho(1),Ws("ngForOf",i)}}function kN(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"input",60),$s("change",function(){return Kt(i),ta().updateShowFaith()}),Ys(),zs(2,"label",61),ha(3,"Show faith in the header"),Ys(),js(4,"br"),Ys()}if(2&e){var n=ta();ho(1),Ws("checked",n.getShowFaith())}}var NN=function(){var e=function(){function e(t,i,n){p(this,e),this.managementService=t,this.resourcesService=i,this.gameService=n}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getRations",value:function(){return this.managementService.getRations()}},{key:"changeFoodValue",value:function(e){this.managementService.setRations(e.target.value)}},{key:"changeClothesValue",value:function(e){this.managementService.setClothesRations(e.target.value)}},{key:"changeAlcoholValue",value:function(e){this.managementService.setAlcoholRations(e.target.value)}},{key:"getClothesRations",value:function(){return this.managementService.getClothesRations()}},{key:"getAlcoholRations",value:function(){return this.managementService.getAlcoholRations()}},{key:"updateFurClothes",value:function(){this.managementService.toggleFurClothes()}},{key:"getFurClothes",value:function(){return this.managementService.getFurClothes()}},{key:"updateFoodNutrition",value:function(){this.managementService.toggleFoodNutrition()}},{key:"getFoodNutrition",value:function(){return this.managementService.getFoodNutrition()}},{key:"updateComplexWorkers",value:function(){this.managementService.toggleComplexWorkers()}},{key:"getComplexWorkers",value:function(){return this.managementService.getComplexWorkers()}},{key:"isHREnabled",value:function(){return this.gameService.isEnabled(wv.HUMAN_RESOURCES)}},{key:"getSecondHeaderRow",value:function(){return this.managementService.getSecondHeaderRow()}},{key:"updateSecondHeaderRow",value:function(){this.managementService.toggleSecondHeaderRow()}},{key:"getShowFreeWorkers",value:function(){return this.managementService.getShowFreeWorkers()}},{key:"updateShowFreeWorkers",value:function(){this.managementService.toggleShowFreeWorkers()}},{key:"getShowPopulation",value:function(){return this.managementService.getShowPopulation()}},{key:"updateShowPopulation",value:function(){this.managementService.toggleShowPopulation()}},{key:"getFoodLines",value:function(){return this.managementService.getFoodPriority()}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"up",value:function(e,t){this.managementService.up(e,t)}},{key:"down",value:function(e,t){this.managementService.down(e,t)}},{key:"getShowResearchProgress",value:function(){return this.managementService.getShowResearchProgress()}},{key:"updateShowResearchProgress",value:function(){this.managementService.toggleShowResearchProgress()}},{key:"getShowFaith",value:function(){return this.managementService.getShowFaith()}},{key:"updateShowFaith",value:function(){this.managementService.toggleShowFaith()}},{key:"getShowHappiness",value:function(){return this.managementService.getShowHappiness()}},{key:"updateShowHappiness",value:function(){this.managementService.toggleShowHappiness()}},{key:"isFaithUnlocked",value:function(){return this.gameService.isEnabled(wv.RELIGION)}},{key:"getLogFiredWorkers",value:function(){return this.managementService.getLogFiredWorkers()}},{key:"updateLogFiredWorkers",value:function(){this.managementService.toggleLogFiredWorkers()}},{key:"getDefaultWorkshopResearch",value:function(){return this.managementService.getDefaultWorkshopResearch()}},{key:"updateDefaultWorkshopResearch",value:function(){this.managementService.toggleDefaultWorkshopResearch()}},{key:"getDefaultGathererFood",value:function(){return this.managementService.getDefaultGathererFood()}},{key:"updateDefaultGathererFood",value:function(){this.managementService.toggleDefaultGathererFood()}},{key:"getSwitchHunterFromTaming",value:function(){return this.managementService.getSwitchHunterFromTaming()}},{key:"updateSwitchHunterFromTaming",value:function(){this.managementService.toggleSwitchHunterFromTaming()}},{key:"getPlowInSummer",value:function(){return this.managementService.getPlowInSummer()}},{key:"updatePlowInSummer",value:function(){this.managementService.togglePlowInSummer()}},{key:"getLogAutoTrade",value:function(){return this.managementService.getLogAutoTrade()}},{key:"updateLogAutoTrade",value:function(){this.managementService.toggleLogAutoTrade()}},{key:"getShowRaw",value:function(){return this.managementService.getShowRaw()}},{key:"updateShowRaw",value:function(){this.managementService.toggleShowRaw()}},{key:"getShowProcessed",value:function(){return this.managementService.getShowProcessed()}},{key:"updateShowProcessed",value:function(){this.managementService.toggleShowProcessed()}},{key:"getShowFood",value:function(){return this.managementService.getShowFood()}},{key:"updateShowFood",value:function(){this.managementService.toggleShowFood()}},{key:"getShowTools",value:function(){return this.managementService.getShowTools()}},{key:"updateShowTools",value:function(){this.managementService.toggleShowTools()}},{key:"getLogSickness",value:function(){return this.managementService.getLogSickness()}},{key:"updateLogSickness",value:function(){this.managementService.toggleLogSickness()}},{key:"getLogMerchant",value:function(){return this.managementService.getLogMerchant()}},{key:"updateLogMerchant",value:function(){this.managementService.toggleLogMerchant()}},{key:"getTaxRate",value:function(){return this.managementService.getTaxRate()}},{key:"changeTaxRate",value:function(e){this.managementService.setTaxRate(e.target.value)}},{key:"isTaxUnlocked",value:function(){return this.gameService.isEnabled(wv.TAX_COLLECTOR)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(DR),Bs(DE),Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-management"]],decls:116,vars:29,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],[1,"label"],[1,"slidecontainer"],["type","range","min","1","max","4","value","2",1,"slider",3,"value","input"],["type","range","min","1","max","4","value","1",1,"slider",3,"value","input"],[4,"ngIf"],["id","furClothes","type","checkbox",3,"checked","change"],["for","furClothes"],["id","defaultWorkshopResearch","type","checkbox",3,"checked","change"],["for","defaultWorkshopResearch"],["id","defaultGathererFood","type","checkbox",3,"checked","change"],["for","defaultGathererFood"],["id","switchHunterFromTaming","type","checkbox",3,"checked","change"],["for","switchHunterFromTaming"],["id","plowInSummer","type","checkbox",3,"checked","change"],["for","plowInSummer"],["id","foodPriorityList"],["class","priorityLine icon",4,"ngFor","ngForOf"],["id","logMerchant","type","checkbox",3,"checked","change"],["for","logMerchant"],["id","logFiredWorkers","type","checkbox",3,"checked","change"],["for","logFiredWorkers"],["id","logAutoTrade","type","checkbox",3,"checked","change"],["for","logAutoTrade"],["id","logSickness","type","checkbox",3,"checked","change"],["for","logSickness"],["id","secondHeaderRow","type","checkbox",3,"checked","change"],["for","secondHeaderRow"],["id","foodNutrition","type","checkbox",3,"checked","change"],["for","foodNutrition"],["id","showRaw","type","checkbox",3,"checked","change"],["for","showRaw"],["id","showProcessed","type","checkbox",3,"checked","change"],["for","showProcessed"],["id","showFood","type","checkbox",3,"checked","change"],["for","showFood"],["id","showTools","type","checkbox",3,"checked","change"],["for","showTools"],["id","showPopulation","type","checkbox",3,"checked","change"],["for","showPopulation"],["id","showFreeWorkers","type","checkbox",3,"checked","change"],["for","showFreeWorkers"],["id","showHappiness","type","checkbox",3,"checked","change"],["for","showHappiness"],["id","showResearchProgress","type","checkbox",3,"checked","change"],["for","showResearchProgress"],["type","range","min","0","max","5","value","0",1,"slider",3,"value","input"],["id","workManagement","type","checkbox",3,"checked","change"],["for","workManagement"],[1,"priorityLine","icon"],["id","index"],["class","entry",4,"ngFor","ngForOf"],[1,"entry"],[1,"item"],[3,"name","path"],["id","arrows"],[1,"arrow",3,"click"],["id","showFaith","type","checkbox",3,"checked","change"],["for","showFaith"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-management-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"span"),ha(6,"General Management"),Ys(),Ys(),zs(7,"span"),ha(8,"Rations"),Ys(),js(9,"br"),zs(10,"div"),zs(11,"span",4),ha(12),Ys(),zs(13,"div",5),zs(14,"input",6),$s("input",function(e){return t.changeFoodValue(e)}),Ys(),Ys(),Ys(),zs(15,"div"),zs(16,"span",4),ha(17),Ys(),zs(18,"div",5),zs(19,"input",6),$s("input",function(e){return t.changeClothesValue(e)}),Ys(),Ys(),Ys(),zs(20,"div"),zs(21,"span",4),ha(22),Ys(),zs(23,"div",5),zs(24,"input",7),$s("input",function(e){return t.changeAlcoholValue(e)}),Ys(),Ys(),Ys(),Gs(25,IN,5,2,"div",8),js(26,"br"),zs(27,"input",9),$s("change",function(){return t.updateFurClothes()}),Ys(),zs(28,"label",10),ha(29,"Allow fur when no clothes are available"),Ys(),js(30,"br"),Gs(31,bN,4,1,"ng-container",8),js(32,"br"),Ks(33),zs(34,"input",11),$s("change",function(){return t.updateDefaultWorkshopResearch()}),Ys(),zs(35,"label",12),ha(36,"Workshops start with research mode (on) or crafting (off)"),Ys(),Qs(),js(37,"br"),Ks(38),zs(39,"input",13),$s("change",function(){return t.updateDefaultGathererFood()}),Ys(),zs(40,"label",14),ha(41,"Gatherers start with food mode (on) or resources (off)"),Ys(),Qs(),js(42,"br"),Ks(43),zs(44,"input",15),$s("change",function(){return t.updateSwitchHunterFromTaming()}),Ys(),zs(45,"label",16),ha(46,"If enabled hunters won't stop taming animals even if pastures are full"),Ys(),Qs(),js(47,"br"),Ks(48),zs(49,"input",17),$s("change",function(){return t.updatePlowInSummer()}),Ys(),zs(50,"label",18),ha(51,"Allow fields to be plowed in summer"),Ys(),Qs(),zs(52,"h4"),ha(53,"food priority"),Ys(),zs(54,"div",19),Gs(55,AN,4,2,"div",20),Ys(),zs(56,"h4"),ha(57,"Log management"),Ys(),zs(58,"input",21),$s("change",function(){return t.updateLogMerchant()}),Ys(),zs(59,"label",22),ha(60,"Log message when a new merchant has arrived"),Ys(),js(61,"br"),zs(62,"input",23),$s("change",function(){return t.updateLogFiredWorkers()}),Ys(),zs(63,"label",24),ha(64,"Log message when worker is removed from building"),Ys(),js(65,"br"),zs(66,"input",25),$s("change",function(){return t.updateLogAutoTrade()}),Ys(),zs(67,"label",26),ha(68,"Log message when auto trade has been performed"),Ys(),js(69,"br"),zs(70,"input",27),$s("change",function(){return t.updateLogSickness()}),Ys(),zs(71,"label",28),ha(72,"Log sickness related events"),Ys(),js(73,"br"),zs(74,"h4"),ha(75,"Header management"),Ys(),zs(76,"input",29),$s("change",function(){return t.updateSecondHeaderRow()}),Ys(),zs(77,"label",30),ha(78,"Display two rows in the header (resources will be displayed in second row)"),Ys(),js(79,"br"),zs(80,"input",31),$s("change",function(){return t.updateFoodNutrition()}),Ys(),zs(81,"label",32),ha(82,"Show food nutrition in the header"),Ys(),js(83,"br"),zs(84,"input",33),$s("change",function(){return t.updateShowRaw()}),Ys(),zs(85,"label",34),ha(86,"Show raw resources tooltip in the header"),Ys(),js(87,"br"),zs(88,"input",35),$s("change",function(){return t.updateShowProcessed()}),Ys(),zs(89,"label",36),ha(90,"Show processed resources tooltip in the header"),Ys(),js(91,"br"),zs(92,"input",37),$s("change",function(){return t.updateShowFood()}),Ys(),zs(93,"label",38),ha(94,"Show food resources tooltip in the header"),Ys(),js(95,"br"),zs(96,"input",39),$s("change",function(){return t.updateShowTools()}),Ys(),zs(97,"label",40),ha(98,"Show tools resources tooltip in the header"),Ys(),js(99,"br"),zs(100,"input",41),$s("change",function(){return t.updateShowPopulation()}),Ys(),zs(101,"label",42),ha(102,"Show population in the header"),Ys(),js(103,"br"),zs(104,"input",43),$s("change",function(){return t.updateShowFreeWorkers()}),Ys(),zs(105,"label",44),ha(106,"Show free workers in the header"),Ys(),js(107,"br"),zs(108,"input",45),$s("change",function(){return t.updateShowHappiness()}),Ys(),zs(109,"label",46),ha(110,"Show happiness in the header"),Ys(),js(111,"br"),Gs(112,kN,5,1,"div",8),zs(113,"input",47),$s("change",function(){return t.updateShowResearchProgress()}),Ys(),zs(114,"label",48),ha(115,"Show research progress in the header"),Ys(),Ys(),Ys()),2&e&&(ho(12),ga("food: ",.5*t.getRations(),""),ho(2),Ws("value",t.getRations()),ho(3),ga("clothes: ",t.getClothesRations(),""),ho(2),Ws("value",t.getClothesRations()),ho(3),ga("alcohol: ",t.getAlcoholRations(),""),ho(2),Ws("value",t.getAlcoholRations()),ho(1),Ws("ngIf",t.isTaxUnlocked()),ho(2),Ws("checked",t.getFurClothes()),ho(4),Ws("ngIf",t.isHREnabled()),ho(3),Ws("checked",t.getDefaultWorkshopResearch()),ho(5),Ws("checked",t.getDefaultGathererFood()),ho(5),Ws("checked",t.getSwitchHunterFromTaming()),ho(5),Ws("checked",t.getPlowInSummer()),ho(6),Ws("ngForOf",t.getFoodLines()),ho(3),Ws("checked",t.getLogMerchant()),ho(4),Ws("checked",t.getLogFiredWorkers()),ho(4),Ws("checked",t.getLogAutoTrade()),ho(4),Ws("checked",t.getLogSickness()),ho(6),Ws("checked",t.getSecondHeaderRow()),ho(4),Ws("checked",t.getFoodNutrition()),ho(4),Ws("checked",t.getShowRaw()),ho(4),Ws("checked",t.getShowProcessed()),ho(4),Ws("checked",t.getShowFood()),ho(4),Ws("checked",t.getShowTools()),ho(4),Ws("checked",t.getShowPopulation()),ho(4),Ws("checked",t.getShowFreeWorkers()),ho(4),Ws("checked",t.getShowHappiness()),ho(4),Ws("ngIf",t.isFaithUnlocked()),ho(1),Ws("checked",t.getShowResearchProgress()))},directives:[TN,Gl,Ul,oT],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#content[_ngcontent-%COMP%]{margin:.5%;height:94%;overflow-y:auto}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.label[_ngcontent-%COMP%]{display:inline-block;width:160px}.slidecontainer[_ngcontent-%COMP%]{display:inline-block;width:150px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}app-icon[_ngcontent-%COMP%]{display:inline-block}#arrows[_ngcontent-%COMP%]{display:flex;flex-direction:column}.arrow[_ngcontent-%COMP%]{font-size:.7em;width:12px;display:inline-block}.priorityLine[_ngcontent-%COMP%]{height:34px}.entry[_ngcontent-%COMP%]{display:inline-block;margin:2px}.item[_ngcontent-%COMP%]{display:flex;flex-direction:row}#index[_ngcontent-%COMP%]{display:inline-block;width:10px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}"]}),e}(),_N=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a){var u;return p(this,i),(u=t.call(this,n,e,r,o,s,Yv.PLATEAU,Zv.PLATEAU)).gameService=a,u}return S(i,[{key:"reset",value:function(e,t){e?u(v(i.prototype),"reset",this).call(this,e,t):t?this.buildings=[]:(this.buildings=this.buildings.filter(function(e){return e.isFinished()}),this.buildings.length>0&&this.gameService.enable(wv.PLATEAU),this.getBuildings().forEach(function(e){return e.verifyWonderEffects()}))}}]),i}(vE);return e.\u0275fac=function(t){return new(t||e)(An(DE),An(PR),An($v),An(wm),An(wR),An(_m))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function wN(e,t){if(1&e){var i=qs();zs(0,"button",15),$s("click",function(){return Kt(i),ta().openBuildModal()}),ha(1,"Build"),Ys()}}function PN(e,t){if(1&e){var i=qs();zs(0,"button",15),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Arrange"),Ys()}}function MN(e,t){if(1&e){var i=qs();zs(0,"button",16),$s("click",function(){return Kt(i),ta().toggleArrangeMode()}),ha(1,"Stop"),Ys()}}function DN(e,t){if(1&e&&(zs(0,"option",9),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("value",i),ho(1),da(n.getBuildingName(i))}}function LN(e,t){if(1&e&&(zs(0,"span",21),js(1,"app-building",22),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.plateauService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function xN(e,t){if(1&e&&(zs(0,"div",17),zs(1,"div",18),zs(2,"span"),ha(3,"Buildings"),Ys(),Ys(),zs(4,"div",19),Gs(5,LN,2,6,"span",20),Ys(),Ys()),2&e){var i=ta();ho(5),Ws("ngForOf",i.getBuildings())}}var FN=function(e){return{activePage:e}};function UN(e,t){if(1&e){var i=qs();zs(0,"span",25),$s("click",function(){var e=Kt(i).$implicit;return ta(2).setPage(e)}),ha(1),Ys()}if(2&e){var n=t.$implicit,r=ta(2);Ws("ngClass",Du(2,FN,r.currentPage===n)),ho(1),ga("page ",n+1,"")}}function HN(e,t){if(1&e&&(zs(0,"span",21),js(1,"app-building",22),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),Ws("building",i)("parentRegion",n.plateauService)("combineMode",n.combineMode)("splitMode",n.splitMode)("demolishMode",n.demolishMode)("arrangeMode",n.arrangeMode)}}function GN(e,t){if(1&e&&(zs(0,"div",17),zs(1,"div",23),Gs(2,UN,2,4,"span",24),Ys(),zs(3,"div",19),Gs(4,HN,2,6,"span",20),Ys(),Ys()),2&e){var i=ta();ho(2),Ws("ngForOf",i.getPagesNumber()),ho(2),Ws("ngForOf",i.getPagedBuildings())}}var BN=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u,c){var l;return p(this,i),(l=t.call(this,e,n,r,a,o,u,c,Yv.PLATEAU)).landService=n,l.techService=s,l.plateauService=a,l}return S(i,[{key:"areWonderBuildingsResearched",value:function(){return!Cp.production||this.techService.isResearched(Lv.WONDER_BUILDINGS)}}]),i}(pE);return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(wm),Bs(_m),Bs(Nm),Bs(zI),Bs(_N),Bs(Om),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-field"]],features:[bs],decls:30,vars:19,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","buttons"],[3,"click",4,"ngIf"],["class","off",3,"click",4,"ngIf"],["id","side"],["id","filters"],[3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","title","margin"],[3,"name"],["class","buildingsWrapper",4,"ngIf"],[3,"click"],[1,"off",3,"click"],[1,"buildingsWrapper"],["id","title"],[1,"buildings"],["class","buildingRegularWrapper",4,"ngFor","ngForOf"],[1,"buildingRegularWrapper"],[3,"building","parentRegion","combineMode","splitMode","demolishMode","arrangeMode"],[1,"title"],["class","page",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"page",3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),Gs(5,wN,2,0,"button",4),Gs(6,PN,2,0,"button",4),Gs(7,MN,2,0,"button",5),zs(8,"div",6),ha(9," Filter:"),js(10,"br"),zs(11,"div",7),zs(12,"select",8),$s("change",function(e){return t.updateFilter(e)})("ngModelChange",function(e){return t.filterBuilding=e}),zs(13,"option",9),ha(14),Ys(),Gs(15,DN,2,2,"option",10),Ys(),zs(16,"select",8),$s("change",function(e){return t.updateFilter2(e)})("ngModelChange",function(e){return t.filterWorking=e}),zs(17,"option",9),ha(18,"All"),Ys(),zs(19,"option",9),ha(20,"Working"),Ys(),zs(21,"option",9),ha(22,"Idle"),Ys(),Ys(),Ys(),Ys(),Ys(),zs(23,"div",11),js(24,"app-icon",12),ha(25),js(26,"app-icon",13),ha(27),Ys(),Gs(28,xN,6,1,"div",14),Gs(29,GN,5,2,"div",14),Ys(),Ys()),2&e&&(ho(5),Ws("ngIf",t.areWonderBuildingsResearched()),ho(1),Ws("ngIf",!t.arrangeMode&&t.getBuildings().length>1),ho(1),Ws("ngIf",t.arrangeMode),ho(5),Ws("ngModel",t.filterBuilding),ho(1),Ws("value",t.allBuildings),ho(1),da(t.getBuildingName(t.allBuildings)),ho(1),Ws("ngForOf",t.getUniqueBuildingsFromCurrentView()),ho(1),Ws("ngModel",t.filterWorking),ho(1),Ws("value",t.buildingStates.ALL),ho(2),Ws("value",t.buildingStates.WORKING),ho(2),Ws("value",t.buildingStates.IDLE),ho(3),Ws("name","hammer")("title","Workers")("margin","0 0 0 2px"),ho(1),ga(" ",t.getUnemployed()," \xa0\xa0\xa0 "),ho(1),Ws("name","land"),ho(1),ga(" ",t.getFreeLand()," "),ho(1),Ws("ngIf",!t.isPagedViewEnabled()),ho(1),Ws("ngIf",t.isPagedViewEnabled()))},directives:[GR,Gl,YO,vO,DO,jO,XO,Ul,oT,hI,xl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;max-height:100%;font-size:1em}#buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{font-size:.9em;padding:7px 10px}#content[_ngcontent-%COMP%]{margin:.5%;display:flex;flex-direction:column;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#side[_ngcontent-%COMP%]{float:right;font-size:.9em;width:20%;min-width:200px;text-align:center}#filters[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}#side[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:.8em;margin:0;padding:0;border:none;outline:0}.buildingsWrapper[_ngcontent-%COMP%]{height:84.9%}.buildings[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:100%;border:black solid 2px;overflow-y:auto;align-content:flex-start}.buildings[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}#title[_ngcontent-%COMP%]{text-align:center;border:black solid 2px;border-bottom:none}.title[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 2px;border-bottom:none}.page[_ngcontent-%COMP%]{flex:auto;text-align:center;border-right:black solid 2px;cursor:pointer}.activePage[_ngcontent-%COMP%]{background-color:var(--active-colour)}.page[_ngcontent-%COMP%]:last-of-type{border-right:none}.off[_ngcontent-%COMP%]{background-color:#555}.buildingRegularWrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:.6%}.buildingDropWrapper[_ngcontent-%COMP%]{display:flex;margin:.6%;cursor:move}.buildingDropWrapper[_ngcontent-%COMP%]   app-building[_ngcontent-%COMP%]{display:inline-block}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#allControl[_ngcontent-%COMP%]{margin-left:auto;display:flex;justify-content:right}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{white-space:nowrap;padding:4px}.dropdown[_ngcontent-%COMP%]{display:inline-block;position:relative}.dropdown[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;min-width:220px;top:5px;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}","#allControl[_ngcontent-%COMP%]{margin-left:auto;width:108px;display:inline-block}#allControl[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px}"]}),e}();function WN(e,t){if(1&e&&(zs(0,"span",17),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("+",i.effect,"% ")}}function VN(e,t){if(1&e&&(zs(0,"span",18),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.effect,"% ")}}function zN(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.duration," ")}}function YN(e,t){1&e&&(zs(0,"span"),ha(1,"permanent"),Ys())}function jN(e,t){if(1&e&&(zs(0,"div",13),zs(1,"span"),ha(2),Ys(),zs(3,"span"),ha(4),Ys(),zs(5,"span"),ha(6),Ys(),Gs(7,WN,2,1,"span",14),Gs(8,VN,2,1,"span",15),Gs(9,zN,2,1,"span",16),Gs(10,YN,2,0,"span",16),Ys()),2&e){var i=t.$implicit,n=t.index,r=ta();ho(2),ga("",n+1,"."),ho(2),da(i.name),ho(2),da(r.getBuildingName(i.building)),ho(1),Ws("ngIf",i.effect>=0),ho(1),Ws("ngIf",i.effect<0),ho(1),Ws("ngIf",i.duration>0),ho(1),Ws("ngIf",i.duration<0)}}function KN(e,t){if(1&e&&(zs(0,"span",17),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("+",i.effect,"% ")}}function QN(e,t){if(1&e&&(zs(0,"span",18),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.effect,"% ")}}function qN(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.duration," ")}}function XN(e,t){1&e&&(zs(0,"span"),ha(1,"permanent"),Ys())}function ZN(e,t){if(1&e&&(zs(0,"div",13),zs(1,"span"),ha(2),Ys(),zs(3,"span"),ha(4),Ys(),zs(5,"span"),ha(6),Ys(),Gs(7,KN,2,1,"span",14),Gs(8,QN,2,1,"span",15),Gs(9,qN,2,1,"span",16),Gs(10,XN,2,0,"span",16),Ys()),2&e){var i=t.$implicit,n=t.index,r=ta();ho(2),ga("",n+1,"."),ho(2),da(i.name),ho(2),da(r.getTroopName(i.troop)),ho(1),Ws("ngIf",i.effect>=0),ho(1),Ws("ngIf",i.effect<0),ho(1),Ws("ngIf",i.duration>0),ho(1),Ws("ngIf",i.duration<0)}}function $N(e,t){if(1&e&&(zs(0,"span",17),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("+",i.effect,"% ")}}function JN(e,t){if(1&e&&(zs(0,"span",18),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.effect,"% ")}}function e_(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("",i.duration," ")}}function t_(e,t){1&e&&(zs(0,"span"),ha(1,"permanent"),Ys())}function i_(e,t){if(1&e&&(zs(0,"div",19),zs(1,"span"),ha(2),Ys(),zs(3,"span"),ha(4),Ys(),Gs(5,$N,2,1,"span",14),Gs(6,JN,2,1,"span",15),Gs(7,e_,2,1,"span",16),Gs(8,t_,2,0,"span",16),Ys()),2&e){var i=t.$implicit,n=t.index;ho(2),ga("",n+1,"."),ho(2),da(i.name),ho(1),Ws("ngIf",i.effect>=0),ho(1),Ws("ngIf",i.effect<0),ho(1),Ws("ngIf",i.duration>0),ho(1),Ws("ngIf",i.duration<0)}}var n_=function(){var e=function(){function e(t){p(this,e),this.effectsService=t}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getBuildingsEffects",value:function(){return this.effectsService.getBuildingEffects().filter(function(e){return!e.isBuff()}).sort(function(e,t){return e.isPermanent()&&!t.isPermanent()?-1:e.isPermanent()&&t.isPermanent()?0:!e.isPermanent()&&t.isPermanent()?1:void 0})}},{key:"getArmyEffects",value:function(){return this.effectsService.getArmyEffects()}},{key:"getBuildingName",value:function(e){return Qv.prepareBuildingName(e)}},{key:"getTroopName",value:function(e){return Qv.prepareTroopName(e)}},{key:"getNatureEffects",value:function(){return this.effectsService.getNatureEffects()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Am))},e.\u0275cmp=it({type:e,selectors:[["app-effects-management"]],decls:53,vars:3,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],["id","buildingEffects"],[1,"headers"],[1,"rows"],["class","row",4,"ngFor","ngForOf"],["id","armyEffects"],["id","natureEffects"],[1,"headers","natureHeaders"],[1,"natureRows"],["class","row natureRow",4,"ngFor","ngForOf"],[1,"row"],["class","positive",4,"ngIf"],["class","negative",4,"ngIf"],[4,"ngIf"],[1,"positive"],[1,"negative"],[1,"row","natureRow"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-management-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"span"),ha(6,"Effects Management"),Ys(),Ys(),zs(7,"span"),ha(8,"Buildings effects"),Ys(),zs(9,"div",4),zs(10,"div",5),zs(11,"span"),ha(12,"#"),Ys(),zs(13,"span"),ha(14,"name"),Ys(),zs(15,"span"),ha(16,"building"),Ys(),zs(17,"span"),ha(18,"effect"),Ys(),zs(19,"span"),ha(20,"duration"),Ys(),Ys(),zs(21,"div",6),Gs(22,jN,11,7,"div",7),Ys(),Ys(),zs(23,"span"),ha(24,"Army effects"),Ys(),zs(25,"div",8),zs(26,"div",5),zs(27,"span"),ha(28,"#"),Ys(),zs(29,"span"),ha(30,"name"),Ys(),zs(31,"span"),ha(32,"troop"),Ys(),zs(33,"span"),ha(34,"effect"),Ys(),zs(35,"span"),ha(36,"duration"),Ys(),Ys(),zs(37,"div",6),Gs(38,ZN,11,7,"div",7),Ys(),Ys(),zs(39,"span"),ha(40,"Nature effects"),Ys(),zs(41,"div",9),zs(42,"div",10),zs(43,"span"),ha(44,"#"),Ys(),zs(45,"span"),ha(46,"name"),Ys(),zs(47,"span"),ha(48,"effect"),Ys(),zs(49,"span"),ha(50,"duration"),Ys(),Ys(),zs(51,"div",11),Gs(52,i_,9,6,"div",12),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(22),Ws("ngForOf",t.getBuildingsEffects()),ho(16),Ws("ngForOf",t.getArmyEffects()),ho(14),Ws("ngForOf",t.getNatureEffects()))},directives:[TN,Ul,Gl],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#content[_ngcontent-%COMP%]{margin:.5%;height:94%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#buildingEffects[_ngcontent-%COMP%]{height:40%;border:black solid 1px}#armyEffects[_ngcontent-%COMP%]{height:33%;border:black solid 1px}#natureEffects[_ngcontent-%COMP%]{height:15%;border:black solid 1px}.rows[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:90.5%;overflow-y:auto}.natureRows[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:79%;overflow-y:auto}.row[_ngcontent-%COMP%]{display:flex;border:black solid 1px;margin:3px}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{border-right:none}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 35%}.natureRow[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 50%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 30%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 13%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:auto;border-right:black solid 1px}.headers[_ngcontent-%COMP%]{margin:3px 3px 0;display:flex;width:98.3%;flex-direction:row;text-align:center;font-size:.9em}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border:black solid 1px;border-left:none}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{border-left:black solid 1px}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 35%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 30%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 13%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.natureHeaders[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 50%}.positive[_ngcontent-%COMP%]{color:var(--positive-colour)}.negative[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e}();function r_(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta();ho(1),da(i.getForestSize())}}function o_(e,t){if(1&e&&(zs(0,"span",16),ha(1),Ys()),2&e){var i=ta();ho(1),da(i.getForestSize())}}var s_=function(){var e=function(){function e(t){p(this,e),this.landService=t}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getForestSize",value:function(){return this.landService.getForest()}},{key:"getLandSize",value:function(){return this.landService.getLand()}},{key:"getForestOptions",value:function(){return this.landService.getForestOptions()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(wm))},e.\u0275cmp=it({type:e,selectors:[["app-forest-management"]],decls:33,vars:10,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],[1,"icon"],[3,"name"],[4,"ngIf"],["class","critical",4,"ngIf"],["id","forest","type","checkbox",3,"ngModel","ngModelChange"],["for","forest",1,"foresterLabel"],["id","forestSize","type","number","min","0",3,"ngModel","ngModelChange"],["id","land","type","checkbox",3,"ngModel","ngModelChange"],["for","land",1,"foresterLabel"],["id","landSize","type","number","min","0",3,"ngModel","ngModelChange"],["for","forestSize2"],["id","forestSize2","type","number","min","0",3,"ngModel","ngModelChange"],[1,"critical"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-management-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"span"),ha(6,"Forest Management"),Ys(),Ys(),zs(7,"div",4),js(8,"app-icon",5),Gs(9,r_,2,1,"span",6),Gs(10,o_,2,1,"span",7),ha(11," \xa0\xa0 "),js(12,"app-icon",5),ha(13),Ys(),js(14,"br"),ha(15," Plant trees if:"),js(16,"br"),zs(17,"input",8),$s("ngModelChange",function(e){return t.getForestOptions().forestSizeRuleEnabled=e}),Ys(),zs(18,"label",9),ha(19,"forest smaller than"),Ys(),zs(20,"input",10),$s("ngModelChange",function(e){return t.getForestOptions().forestSizeRule=e}),Ys(),js(21,"br"),zs(22,"input",11),$s("ngModelChange",function(e){return t.getForestOptions().landSizeRuleEnabled=e}),Ys(),zs(23,"label",12),ha(24,"free land bigger than"),Ys(),zs(25,"input",13),$s("ngModelChange",function(e){return t.getForestOptions().landSizeRule=e}),Ys(),js(26,"br"),js(27,"br"),ha(28," Cut trees if:"),js(29,"br"),zs(30,"label",14),ha(31,"Forest bigger than "),Ys(),zs(32,"input",15),$s("ngModelChange",function(e){return t.getForestOptions().forestSizeReserved=e}),Ys(),Ys(),Ys()),2&e&&(ho(8),Ws("name","forest"),ho(1),Ws("ngIf",t.getForestSize()>=400),ho(1),Ws("ngIf",t.getForestSize()<400),ho(2),Ws("name","land"),ho(1),ga(" ",t.getLandSize()," "),ho(4),Ws("ngModel",t.getForestOptions().forestSizeRuleEnabled),ho(3),Ws("ngModel",t.getForestOptions().forestSizeRule),ho(2),Ws("ngModel",t.getForestOptions().landSizeRuleEnabled),ho(3),Ws("ngModel",t.getForestOptions().landSizeRule),ho(7),Ws("ngModel",t.getForestOptions().forestSizeReserved))},directives:[TN,oT,Gl,jR,vO,DO,tT,xO,qR],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#content[_ngcontent-%COMP%]{margin:.5%;height:94%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.foresterLabel[_ngcontent-%COMP%]{display:inline-block;width:200px}input[type=number][_ngcontent-%COMP%]{width:6ch}"]}),e}(),a_=function(){var e=function(){function e(t,i,n){p(this,e),this.servicesService=t,this.resourcesService=i,this.gameService=n,this.heritagePoints=0,this.spentHeritagePoints=0,this.xp=0,t.addService(Zv.HERITAGE,this)}return S(e,[{key:"getName",value:function(){return"HeritageService"}},{key:"load",value:function(e){this.heritagePoints=void 0!==e.heritagePoints?e.heritagePoints:0,this.spentHeritagePoints=void 0!==e.spentHeritagePoints?e.spentHeritagePoints:0,this.xp=void 0!==e.xp?e.xp:0,this.heritagePoints>0&&this.gameService.enable(wv.HERITAGE)}},{key:"reset",value:function(e,t){e&&(this.heritagePoints=0,this.xp=0),this.heritagePoints>0&&this.gameService.enable(wv.HERITAGE),this.spentHeritagePoints=0}},{key:"save",value:function(){return{heritagePoints:this.heritagePoints,spentHeritagePoints:this.spentHeritagePoints,xp:this.xp}}},{key:"increaseHeritagePoints",value:function(e){this.gameService.enable(wv.HERITAGE),this.heritagePoints+=e}},{key:"increaseXP",value:function(e){this.xp+=e}},{key:"spendHeritagePoints",value:function(e){return e<=this.getAvailableHeritagePoints()&&(this.spentHeritagePoints+=e,!0)}},{key:"hasHeritagePoints",value:function(e){return e<=this.heritagePoints-this.spentHeritagePoints}},{key:"getHeritagePoints",value:function(){return this.heritagePoints}},{key:"calculateHeritagePoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.resourcesService.getTotalPeople(),i=this.xp,n=20+2*this.heritagePoints,r=0;t>=n;)r+=1,t-=n,n+=2;for(;t+i>=n;)r+=1,(t-=n)<0&&(i+=t),n+=2;return e&&(this.xp=i),(t-=50)<0&&(t=0),{hp:r,xp:t}}},{key:"peopleToNextHeritagePoint",value:function(){for(var e=this.resourcesService.getTotalPeople()+this.xp,t=20+2*this.heritagePoints;e>=t;)e-=t,t+=2;return t-e}},{key:"getAvailableHeritagePoints",value:function(){return this.heritagePoints-this.spentHeritagePoints}},{key:"getXP",value:function(){return this.xp}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(DE),An(_m))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function u_(e,t){if(1&e){var i=qs();zs(0,"button",6),$s("click",function(){return Kt(i),ta().addHeritagePoints()}),ha(1,"add"),Ys()}}function c_(e,t){if(1&e&&(zs(0,"span"),ha(1),js(2,"br"),Ys()),2&e){var i=ta();ho(1),ga("XP towards next heritage point: ",i.getXP(),"")}}var l_=function(e){return{selected:e}},h_=function(){var e=function(){function e(t,i,n){p(this,e),this.heritageService=t,this.landService=i,this.modalService=n,this.multiplier=1,this.selectedMode=0}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getHeritagePoints",value:function(){return this.heritageService.getHeritagePoints()}},{key:"getAvailableHeritagePoints",value:function(){return this.heritageService.getAvailableHeritagePoints()}},{key:"buyLand",value:function(){this.heritageService.spendHeritagePoints(this.multiplier)?this.landService.increaseLand(10*this.multiplier,!0):this.modalService.info("No enough Heritage Points!")}},{key:"buyForest",value:function(){this.heritageService.spendHeritagePoints(this.multiplier)?this.landService.increaseForest(10*this.multiplier,!1):this.modalService.info("No enough Heritage Points!")}},{key:"buyMountains",value:function(){this.heritageService.spendHeritagePoints(this.multiplier)?this.landService.increaseMountains(5*this.multiplier):this.modalService.info("No enough Heritage Points!")}},{key:"addHeritagePoints",value:function(){this.heritageService.increaseHeritagePoints(10)}},{key:"isDev",value:function(){return!Cp.production}},{key:"getXP",value:function(){return this.heritageService.getXP()}},{key:"getBuyButtonText",value:function(){return 0===this.selectedMode?"Buy "+10*this.multiplier+" land":1===this.selectedMode?"Buy "+10*this.multiplier+" forest":2===this.selectedMode?"Buy "+5*this.multiplier+" mountains":void 0}},{key:"buy",value:function(){0===this.selectedMode?this.buyLand():1===this.selectedMode?this.buyForest():2===this.selectedMode&&this.buyMountains()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(a_),Bs(wm),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-heritage"]],decls:41,vars:22,consts:[["id","wrapper"],["id","title"],[3,"click",4,"ngIf"],[4,"ngIf"],["for","multiplier"],["id","multiplier","type","number","min","1",3,"max","ngModel","ngModelChange"],[3,"click"],["id","modes"],[1,"mode",3,"ngClass","click"],[1,"title"],["src","assets/land.svg"],[1,"effect"],["src","assets/forest.svg"],["src","assets/mountains.svg"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),zs(2,"span"),ha(3,"Heritage"),Ys(),Ys(),js(4,"br"),ha(5),Gs(6,u_,2,0,"button",2),js(7,"br"),Gs(8,c_,3,1,"span",3),js(9,"br"),ha(10," Heritage points can be used to buy more land or unlock research projects. "),js(11,"br"),js(12,"br"),zs(13,"label",4),ha(14,"Spend "),Ys(),zs(15,"input",5),$s("ngModelChange",function(e){return t.multiplier=e}),Ys(),zs(16,"label",4),ha(17," Heritage Points to"),Ys(),zs(18,"button",6),$s("click",function(){return t.buy()}),ha(19),Ys(),js(20,"br"),js(21,"br"),zs(22,"div",7),zs(23,"div",8),$s("click",function(){return t.selectedMode=0}),zs(24,"span",9),ha(25,"Land"),Ys(),js(26,"img",10),zs(27,"span",11),ha(28),Ys(),Ys(),zs(29,"div",8),$s("click",function(){return t.selectedMode=1}),zs(30,"span",9),ha(31,"Forest"),Ys(),js(32,"img",12),zs(33,"span",11),ha(34),Ys(),Ys(),zs(35,"div",8),$s("click",function(){return t.selectedMode=2}),zs(36,"span",9),ha(37,"Mountains"),Ys(),js(38,"img",13),zs(39,"span",11),ha(40),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(5),fa(" Heritage points: ",t.getAvailableHeritagePoints(),"/",t.getHeritagePoints()," "),ho(1),Ws("ngIf",t.isDev()),ho(2),Ws("ngIf",t.getXP()>0),ho(7),ia("max",t.getAvailableHeritagePoints()),Ws("ngModel",t.multiplier),ho(4),da(t.getBuyButtonText()),ho(4),Ws("ngClass",Du(16,l_,0===t.selectedMode)),ho(5),fa("",10*t.multiplier," land for ",t.multiplier," HP"),ho(1),Ws("ngClass",Du(18,l_,1===t.selectedMode)),ho(5),fa("",10*t.multiplier," forest for ",t.multiplier," HP"),ho(1),Ws("ngClass",Du(20,l_,2===t.selectedMode)),ho(5),fa("",5*t.multiplier," mountains for ",t.multiplier," HP"))},directives:[Gl,tT,JO,xO,qR,vO,DO,xl],styles:["#wrapper[_ngcontent-%COMP%]{margin:.5%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#multiplier[_ngcontent-%COMP%]{width:5ch}#modes[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.mode[_ngcontent-%COMP%]{display:flex;cursor:pointer;flex-direction:column;height:150px;width:200px;border:black solid 1px;align-items:center;margin-right:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.mode[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px}.mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:bold}.mode[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{margin-top:4px;font-size:.8em}.selected[_ngcontent-%COMP%]{border:black solid 3px}"]}),e}(),d_=(function(e){e[e.LAND=0]="LAND",e[e.SEA=1]="SEA"}(d_||(d_={})),d_),g_=function(){function e(t,i,n,r,o,s,a,u,c,l){p(this,e),this.speed=3,this.routePaths=[],this.servicesService=t,this.mission=n,this.settings=lm.getMission(n),this.missionTime=this.settings.TIME,this.description=this.settings.DESCRIPTION,this.icon=this.settings.ICON,this.id=i,this.targetIndex=r,this.route=o,this.progress=s,this.status=a,this.ownerCountry=u,this.army=c,this.data=l,t&&(this.armyService=t.getArmyService(),this.logService=t.getLogService(),this.worldService=t.getWorldService(),this.gameService=t.getGameService()),this.initRoutePaths(),"{mission}"===this.status?(this.origin=this.routePaths[this.routePaths.length-1].target,this.target=this.routePaths[this.routePaths.length-1].target):(this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target),this.speed=this.getMissionType()===d_.LAND?c.getArmySpeed():c.getNavy(!1).getArmySpeed()}return S(e,[{key:"getMissionName",value:function(){return Qv.prepareMissionName(this.mission)}},{key:"getArmySpeed",value:function(){return this.getMissionType()===d_.LAND?this.army.getArmySpeed():this.army.getNavy(!1).getArmySpeed()}},{key:"getTargetRegionId",value:function(){return this.route.path[this.targetIndex]}},{key:"getCurrentRegionId",value:function(){return this.route.path[this.targetIndex-1]}},{key:"getOrigin",value:function(){return this.origin}},{key:"getTarget",value:function(){return this.target}},{key:"getTravelSpeed",value:function(){return 60*this.speed/3/this.getDistance()}},{key:"tick",value:function(){if("traveling"===this.status)this.progress<100?(this.progress+=this.getTravelSpeed(),this.progress>100&&(this.progress=100)):(this.evaluateRegion(),this.targetIndex===this.route.path.length-1?(this.origin=this.target,this.isInstant()?this.calculateMission()?(this.status="returning",this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target):this.status="finished":this.status="{mission}"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target),this.progress=0);else if("{mission}"===this.status)if(this.progress<100)this.progress+=1/this.missionTime;else{if(this.calculateMission()){this.status="returning",this.speed=this.army.getArmySpeed();var e=this.worldService.findPath(this.getTargetRegionId(),this.route.path[0],this.ownerCountry.id,!1);this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,e&&(e.path.length<this.route.path.length||!this.validateRoute())&&(this.route=e,this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}else this.worldService.clearMission(),this.status="finished";this.progress=0}else("returning"===this.status||"canceled"===this.status)&&(this.progress<100?(this.progress+=this.getTravelSpeed(),this.progress>100&&(this.progress=100)):(this.evaluateRegion(),this.targetIndex===this.route.path.length-1?(this.finish("canceled"===this.status),this.worldService.getSelectedMission()&&this.worldService.getSelectedMission().id===this.id&&this.worldService.clearMission(),this.status="finished"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,this.progress=0)))}},{key:"getDisplayProgress",value:function(){return"{mission}"===this.status?this.progress:this.distanceSoFar()/this.totalDistance()}},{key:"distanceSoFar",value:function(){for(var e=0,t=0;t<this.targetIndex-1;t++)e+=100*this.calculatePointsDistance(this.routePaths[t].origin,this.routePaths[t].target);return e+=this.calculatePointsDistance(this.routePaths[this.targetIndex-1].origin,this.routePaths[this.targetIndex-1].target)*this.progress}},{key:"totalDistance",value:function(){for(var e=0,t=0;t<this.routePaths.length;t++)e+=this.calculatePointsDistance(this.routePaths[t].origin,this.routePaths[t].target);return e}},{key:"getProgressPercentage",value:function(){return this.progress/100}},{key:"isFinished",value:function(){return"finished"===this.status}},{key:"getStatus",value:function(){return this.status.replace("{mission}",Qv.prepareMissionName(this.mission))}},{key:"getDistance",value:function(){var e=this.calculatePointsDistance(this.origin,this.target);return this.worldService.getRegion(this.getCurrentRegionId()).roads?e*pm.ROADS_DISTANCE_MODIFIER:e}},{key:"calculatePointsDistance",value:function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"canCancel",value:function(){return!1}}]),e}(),f_=function e(t,i,n,r,o,s,a){p(this,e),this.originRegion=t,this.originRegionColour=i,this.targetRegion=n,this.targetRegionColour=r,this.targetRegionCountry=o,this.targetSeaEvent=s,this.missionType=a},v_=(function(e){e[e.NONE=0]="NONE",e[e.PEACE=1]="PEACE",e[e.SAVE_WEALTH=2]="SAVE_WEALTH",e[e.ECONOMY_BUILD=3]="ECONOMY_BUILD",e[e.ECONOMY_COLONIZE=4]="ECONOMY_COLONIZE",e[e.DEFENSE_WALL=5]="DEFENSE_WALL",e[e.DEFENSE_ARCHER=6]="DEFENSE_ARCHER",e[e.DEFENSE_GATHER_FORCES=7]="DEFENSE_GATHER_FORCES",e[e.OFFENSE_MILITIA=8]="OFFENSE_MILITIA",e[e.OFFENSE_SPEARMAN=9]="OFFENSE_SPEARMAN",e[e.OFFENSE_SWORDSMAN=10]="OFFENSE_SWORDSMAN",e[e.OFFENSE_LIGHT_CAVALRY=11]="OFFENSE_LIGHT_CAVALRY",e[e.OFFENSE_GATHER_FORCES=12]="OFFENSE_GATHER_FORCES",e[e.OFFENSE_COLONIZE=13]="OFFENSE_COLONIZE",e[e.OFFENSE_PLUNDER=14]="OFFENSE_PLUNDER",e[e.OFFENSE_CONQUER=15]="OFFENSE_CONQUER",e[e.OFFENSE_RECLAIM_CAPITAL=16]="OFFENSE_RECLAIM_CAPITAL",e[e.DEFENSE_GUARD_TOWER=17]="DEFENSE_GUARD_TOWER"}(v_||(v_={})),v_),p_=function(){function e(t,i,n,r,o,s,a,u){p(this,e),this.data={},this.id=t,this.name=i,this.diplomacy=n,this.colour=r,this.focus=o,this.regions=s,this.data=a,this.capital=u}return S(e,[{key:"getDiplomacy",value:function(){return this.diplomacy<-25?"hostile":this.diplomacy>=-25&&this.diplomacy<25?"neutral":this.diplomacy>=25?"friendly":void 0}},{key:"decreaseDiplomacy",value:function(e){this.diplomacy-=e,this.diplomacy<-100&&(this.diplomacy=-100)}},{key:"increaseDiplomacy",value:function(e){this.diplomacy+=e,this.diplomacy>100&&(this.diplomacy=100)}}]),e}(),m_=function(){function e(t,i,n,r,o,s,a,u,c,l,h,d,g,f,v,m,S){var E=arguments.length>17&&void 0!==arguments[17]?arguments[17]:0;p(this,e),this.id=t,this.path=i,this.center=n,this.neighbours=r,this.land=o,this.forest=s,this.mountains=a,this.wealth=u,this.economy=c,this.defense=l,this.harbour=h,this.roads=d,this.watchtower=g,this.watched=f,this.target=v,this.spy=m,this.army=S,this.navy=new AC([]),this.lastAttack=E}return S(e,[{key:"getSize",value:function(){return this.land+this.forest+this.mountains}}]),e}(),S_=function e(t,i){p(this,e),this.id=t,this.neighbours=i},E_=function(){function e(t){p(this,e),this.distance=0,this.path=t}return S(e,[{key:"reversePath",value:function(){this.path=this.path.reverse()}},{key:"calculatePathDistance",value:function(e){if(0!==this.distance)return this.distance;for(var t=0,i=0;i<this.path.length-1;i++){var n=e.getRegion(this.path[i]),r=this.calculatePointsDistance(n.center,e.getRegion(this.path[i+1]).center);t+=n.roads?r*pm.ROADS_DISTANCE_MODIFIER:r}return this.distance=t,t}},{key:"calculateSeaPathDistance",value:function(e){if(0!==this.distance)return this.distance;for(var t=0,i=0;i<this.path.length-1;i++)t+=this.calculatePointsDistance(e.getSeaArea(this.path[i]).center,e.getSeaArea(this.path[i+1]).center);return this.distance=t,t}},{key:"calculatePointsDistance",value:function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}}]),e}(),y_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u,c,l,h){return p(this,i),t.call(this,e,n,r,o,s,a,u,c,l,h)}return S(i,[{key:"toJSON",value:function(){var e=[];return this.army.units.forEach(function(t){return e.push({troop:t.troop,size:t.size})}),{type:this.mission,id:this.id,ownerCountryId:this.ownerCountry.id,army:e,route:this.route.path,progress:this.progress,targetIndex:this.targetIndex,status:this.status,data:this.data}}},{key:"getDestinationTargetRegion",value:function(){return this.worldService.getRegion(this.route.path[this.route.path.length-1])}},{key:"getMissionType",value:function(){return d_.LAND}},{key:"getTravelSpeed",value:function(){var e=u(v(i.prototype),"getTravelSpeed",this).call(this);return this.ownerCountry.id===Vv.PLAYER&&this.gameService.isEnabled(wv.LOGISTICS)&&(e*=1.1),e}},{key:"evaluateRegion",value:function(){var e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(this.getTargetRegionId());if(!this.validateRoute()){var i=this.worldService.findPath(e.id,this.getDestinationTargetRegion().id,this.ownerCountry.id,!1);if(i&&i.path.length>1){var n=new E_(this.route.path.splice(0,this.targetIndex));n.path=n.path.concat(i.path),this.route=n,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target}}if(e.id!==this.getDestinationTargetRegion().id&&this.ownerCountry.id!==t.id&&(this.ownerCountry.id===Vv.PLAYER&&t.id!==Vv.NEUTRAL||this.ownerCountry.id!==Vv.PLAYER)&&e.army.hasAny()){var r=this.armyService.calculateAttack(this.army,e.army,e.defense,this.ownerCountry.id===Vv.PLAYER,this.ownerCountry.id!==Vv.PLAYER);r.attacker=this.ownerCountry.id,r.defender=t.id,(this.ownerCountry.id===Vv.PLAYER||t.id===Vv.PLAYER)&&(r.result?r.message=this.ownerCountry.id===Vv.PLAYER?"We managed to pass through enemy region":"Enemy managed to pass through our region":(this.ownerCountry.id===Vv.PLAYER?(r.message="We failed passing through enemy region",this.data&&(e.wealth+=this.data)):(r.message="We defeated enemy armies passing through our region",this.data&&this.armyService.loot(this.data)),this.worldService.getSelectedMission()&&this.worldService.getSelectedMission().id===this.id&&this.worldService.clearMission(),this.status="finished"),this.logService.fightReport(r))}}},{key:"validateRoute",value:function(){for(var e=this.targetIndex;e<this.route.path.length-1;e++){var t=this.worldService.getCountryByRegionId(this.route.path[e]),i=this.worldService.getRegion(this.route.path[e]);if(t.id===Vv.NEUTRAL&&i.army.hasAny())return!1;if(t.id===Vv.NEUTRAL)return!0;if(t.id!==this.ownerCountry.id)return!1}return!0}},{key:"initRoutePaths",value:function(){this.routePaths=[];for(var e=0;e<this.route.path.length-1;e++){var t=this.worldService.getRegion(this.route.path[e]),i=this.worldService.getRegion(this.route.path[e+1]);this.routePaths.push({origin:{x:t.center.x,y:t.center.y},target:{x:i.center.x,y:i.center.y}})}}},{key:"cancel",value:function(){this.canCancel()&&"traveling"===this.status&&(this.progress=100-this.progress,this.status="returning",this.route.reversePath(),this.targetIndex=this.route.path.length-this.targetIndex,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}},{key:"getIconPath",value:function(){return"assets/army/mission/"+this.icon+".svg"}},{key:"getArmyEffectiveSpeed",value:function(){return this.ownerCountry.id===Vv.PLAYER&&this.gameService.isEnabled(wv.LOGISTICS)?1.1*this.army.getArmySpeed():this.army.getArmySpeed()}}]),i}(g_),R_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),a=t.call(this,e,n,Fv.COLONIZE,c,s,u,l,r,o,h),e&&(a.landService=e.getLandService()),a}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){var e=this.worldService.getRegion(this.getTargetRegionId());if(this.worldService.getCountryByRegionId(e.id).id!==Vv.PLAYER){if(this.ownerCountry.id!==Vv.PLAYER&&e.army.hasAny()&&e.army.getArmyPower(!1)<10)this.logService.success("Our troops lost against enemy colonists"),e.army=new AC([]);else if(this.ownerCountry.id!==Vv.PLAYER&&e.army.hasAny())return!1;sp.chance(5*this.army.getUnit(Bv.COLONIST).size/100)?(this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.army=new AC([]),this.ownerCountry.id===Vv.PLAYER&&this.logService.success("We colonized new region!")):this.ownerCountry.id===Vv.PLAYER&&this.logService.warning("Our colonists lost against the harsh conditions and died during attempt to colonize new region")}else this.ownerCountry.id===Vv.PLAYER&&this.logService.warning("Our colonists died in a bandits ambush");return!1}},{key:"finish",value:function(e){}}]),i}(y_),O_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),a=t.call(this,e,n,Fv.CONQUER,c,s,u,l,r,o,h),e&&(a.landService=e.getLandService()),a}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){if(this.ownerCountry.id===Vv.PLAYER){var e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){var i=this.armyService.calculateAttack(this.army,e.army,e.defense,!0,!1);return i.attacker=this.ownerCountry.id,i.defender=t.id,i.result?(i.message="Region conquered",this.servicesService.getHappinessService().addHappinessEffect(0,Kv.SUCCESSFUL_CONQUER,2,90),this.logService.fightReport(i),this.armyService.loot(50*e.wealth+200*e.economy),t.diplomacy<25?t.decreaseDiplomacy(30):t.diplomacy=-50,t.capital===e.id&&(t.diplomacy=-100),this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new AC([]),!1):(i.message="Our army has been defeated",this.logService.fightReport(i),t.diplomacy<25?t.decreaseDiplomacy(15):t.diplomacy=30,!1)}return!0}var n=this.worldService.getRegion(this.getTargetRegionId()),r=this.worldService.getCountryByRegionId(n.id);if(r.id===Vv.PLAYER&&this.worldService.isProtected())return this.logService.log("We were protected from conquer"),!0;if(r.id!==this.ownerCountry.id){var o=this.armyService.calculateAttack(this.army,n.army,n.defense,!1,r.id===Vv.PLAYER);return o.attacker=this.ownerCountry.id,o.defender=r.id,o.result?0!==n.id?(r.id===Vv.PLAYER&&(this.reduceLand(n),o.message="Our region has been conquered by enemy!",this.servicesService.getHappinessService().addHappinessEffect(0,Kv.RECENTLY_CONQUERED,-4,90),this.logService.fightReport(o)),this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new AC([]),!1):(this.data=this.armyService.lootPlayer(50*this.army.getArmySize()),o.message="Our capital has been plundered!",this.servicesService.getHappinessService().addHappinessEffect(0,Kv.RECENTLY_INVADED,-4,90),this.logService.fightReport(o),!0):(r.id===Vv.PLAYER&&(o.message="We have defeated enemy conquer party!",this.logService.fightReport(o)),n.target=v_.DEFENSE_ARCHER,!1)}return!0}},{key:"finish",value:function(e){var t=this.getDestinationTargetRegion();t.army.addArmy(this.army),e||(t.wealth+=this.data)}},{key:"reduceLand",value:function(e){var t=e.land+e.forest+e.mountains,i=0,n=0,r=0;if(this.landService.getLand()>=e.land?(t-=e.land,i+=e.land,this.landService.removeLand(e.land)):(t-=this.landService.getLand(),i+=this.landService.getLand(),this.landService.removeLand(this.landService.getLand())),this.landService.getForest()>=e.forest?(t-=e.forest,n+=e.forest,this.landService.removeForest(e.forest)):(t-=this.landService.getForest(),n+=this.landService.getForest(),this.landService.removeForest(this.landService.getForest())),this.landService.getMountains()>=e.mountains?(t-=e.mountains,r+=e.mountains,this.landService.removeMountains(e.mountains)):(t-=this.landService.getMountains(),r+=this.landService.getMountains(),this.landService.removeMountains(this.landService.getMountains())),t>0){if(this.landService.getForest()>0){if(this.landService.getForest()>t)return this.landService.removeForest(t),n+=t,void this.setLands(e,i,n,r);t-=this.landService.getForest(),n+=this.landService.getForest(),this.landService.removeForest(this.landService.getForest())}if(this.landService.getLand()>0){if(this.landService.getLand()>t)return this.landService.removeLand(t),i+=t,void this.setLands(e,i,n,r);t-=this.landService.getLand(),i+=this.landService.getLand(),this.landService.removeLand(this.landService.getLand())}if(this.landService.getMountains()>0){if(this.landService.getMountains()>t)return this.landService.removeMountains(t),r+=t,void this.setLands(e,i,n,r);t-=this.landService.getMountains(),r+=this.landService.getMountains(),this.landService.removeMountains(this.landService.getMountains())}}this.setLands(e,i,n,r)}},{key:"setLands",value:function(e,t,i,n){e.land=t,e.forest=i,e.mountains=n}},{key:"canCancel",value:function(){return!0}}]),i}(y_),T_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.PLUNDER,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){if(this.ownerCountry.id===Vv.PLAYER){var e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){var i=this.armyService.calculateAttack(this.army,e.army,e.defense,!0,!1);return i.attacker=this.ownerCountry.id,i.defender=t.id,i.result?(t.decreaseDiplomacy(t.diplomacy<25?10:30),this.data=e.wealth,e.wealth=0,i.message="Region plundered",this.logService.fightReport(i),e.target=v_.DEFENSE_ARCHER,!0):(i.message="Our army has been defeated",this.logService.fightReport(i),t.decreaseDiplomacy(t.diplomacy<25?5:15),e.target=v_.DEFENSE_ARCHER,!1)}return!0}var n=this.worldService.getRegion(this.getTargetRegionId()),r=this.worldService.getCountryByRegionId(n.id);if(r.id===Vv.PLAYER&&this.worldService.isProtected())return this.logService.log("We were protected from plunder"),!0;if(r.id!==this.ownerCountry.id){var o=this.armyService.calculateAttack(this.army,n.army,n.defense,!1,r.id===Vv.PLAYER);return o.attacker=this.ownerCountry.id,o.defender=r.id,o.result?r.id===Vv.PLAYER||r.id===Vv.NEUTRAL?(this.data=this.armyService.lootPlayer(50*this.army.getArmySize()),o.message=r.id===Vv.NEUTRAL?"Our troops stationed in neutral region have been defeated":"We have been plundered!",this.servicesService.getHappinessService().addHappinessEffect(0,Kv.RECENTLY_INVADED,-2,60),this.logService.fightReport(o),!0):(this.data=n.wealth,this.data>Math.floor(this.army.getArmySize()/2)?(this.data=Math.floor(this.army.getArmySize()/2),n.wealth-=this.data):n.wealth=0,n.target=v_.DEFENSE_ARCHER,!0):(r.id===Vv.PLAYER&&(o.message="We have defeated enemy plunder party!",this.logService.fightReport(o)),!1)}return!0}},{key:"finish",value:function(e){if(this.ownerCountry.id===Vv.PLAYER)this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new AC([]),e||this.armyService.loot(50*this.data);else{var t=this.getDestinationTargetRegion();this.worldService.getCountryByRegionId(t.id)!==this.ownerCountry?this.worldService.addMission(new O_(this.servicesService,this.id,this.ownerCountry,this.army,this.route,0,this.targetIndex,"{mission}",this.data)):(t.army.addArmy(this.army),t.wealth+=this.data)}}},{key:"canCancel",value:function(){return!0}}]),i}(y_),I_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"{mission}",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.BUILD,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){var e=this,t=this.getDestinationTargetRegion();if(null!==this.data)switch(this.data){case dp.DEFENSES:return t.defense+=1,!1;case dp.ROADS:return t.roads=!0,!1;case dp.WATCHTOWER:t.watchtower=!0;var i=this.getDestinationTargetRegion();return this.worldService.getCountryByRegionId(i.id).id===Vv.PLAYER&&i.neighbours.forEach(function(t){t>=0&&(e.worldService.getRegion(t).watched=!0)}),!1;case dp.GUARD_TOWER:return t.army.addTroop(Bv.GUARD_TOWER,1),!1;case dp.HARBOUR:return t.harbour=!0,!1}return!1}},{key:"finish",value:function(e){}}]),i}(y_),b_=function e(t,i,n,r,o){p(this,e),this.id=t,this.center=i,this.r=n,this.events=r,this.neighbours=o},C_=function(){function e(t,i,n,r,o,s,a){var u=this;if(p(this,e),this.parentId=t,this.id=i,this.type=n,this.center=r,this.amount=o,this.time=s,this.data=a,n===jv.PIRATES||n===jv.PIRATES_BASE)if(null===a)for(this.data=new AC([]);this.amount>=80;)this.amount>=lm.getTroop(Bv.GALLEON).PAY&&(this.amount-=lm.getTroop(Bv.GALLEON).PAY,this.data.addTroop(Bv.GALLEON,1),this.amount>=lm.getTroop(Bv.BRIGANTINE).PAY&&(this.amount-=lm.getTroop(Bv.BRIGANTINE).PAY,this.data.addTroop(Bv.BRIGANTINE,1))),this.amount>=lm.getTroop(Bv.BRIGANTINE).PAY&&(this.amount-=lm.getTroop(Bv.BRIGANTINE).PAY,this.data.addTroop(Bv.BRIGANTINE,1));else this.data=new AC([]),a.units.forEach(function(e){e.troop&&u.data.addTroop(e.troop,e.size)});this.amount=o}return S(e,[{key:"toJSON",value:function(){return{parentId:this.parentId,id:this.id,type:this.type,center:this.center,amount:this.amount,time:this.time,data:this.data}}},{key:"tick",value:function(t,i,n,r){if(this.type===jv.WHIRLPOOL&&(this.time-=1),this.type===jv.PIRATES_BASE&&(this.time-=1,this.time<=10)){var o=0;if(i.getSeaAreas().forEach(function(e){e.events.length>0&&e.events[0].type===jv.PIRATES&&(o+=1)}),this.time=sp.randomBetween(pm.SEA_EVENTS.PIRATES_BASE.TIME_MIN+50*o,pm.SEA_EVENTS.PIRATES_BASE.TIME_MAX+50*o),o<2*pm.SEA_EVENTS.PIRATES.NUMBER_MAX){var s=i.getSeaAreas().filter(function(e){return-1!==e.id&&0===e.events.length&&e.r>0}),a=s[sp.randomBetween(0,s.length-1)];a.events.push(new e(a.id,n.getNextId(),jv.PIRATES,i.getRandomPointInCircle(a.center,a.r),sp.randomBetween(pm.SEA_EVENTS.PIRATES.POWER_MIN,pm.SEA_EVENTS.PIRATES.POWER_MAX),sp.randomBetween(pm.SEA_EVENTS.PIRATES.TIME_MIN,pm.SEA_EVENTS.PIRATES.TIME_MAX),null)),t.getGameService().isEnabled(wv.BOAT_BUILDER)&&r.warning("Pirates base sent a new pirates group")}}}}]),e}(),A_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.MOVE,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!0}},{key:"calculateMission",value:function(){var e=this.getDestinationTargetRegion(),t=this.worldService.getCountryByRegionId(e.id);return t.id!==Vv.PLAYER&&t.id!==Vv.NEUTRAL||(e.army.addArmy(this.army),this.army=new AC([]),!1)}},{key:"finish",value:function(e){this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new AC([])}},{key:"canCancel",value:function(){return!0}}]),i}(y_),k_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.SPY,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){var e=this.getDestinationTargetRegion(),t=this.worldService.getCountryByRegionId(e.id);if(e&&this.army.getUnit(Bv.SPY)){if(t.id===Vv.PLAYER)return!0;e.spy+=this.army.getUnit(Bv.SPY).size,this.army=new AC([])}return!1}},{key:"finish",value:function(e){this.getDestinationTargetRegion().army.addArmy(this.army),this.army=new AC([])}}]),i}(y_),N_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a,u,c,l,h){return p(this,i),t.call(this,e,n,r,o,s,a,u,c,l,h)}return S(i,[{key:"toJSON",value:function(){var e=[];return this.army.units.forEach(function(t){return e.push({troop:t.troop,size:t.size})}),{type:this.mission,id:this.id,ownerCountryId:this.ownerCountry.id,army:e,route:this.route.path,progress:this.progress,targetIndex:this.targetIndex,status:this.status,data:this.data}}},{key:"initRoutePaths",value:function(){this.routePaths=[];var e=this.worldService.getSeaArea(this.route.path[0]),t=this.worldService.getSeaArea(this.route.path[1]);this.routePaths.push({origin:{x:e.center.x,y:e.center.y},target:{x:t.center.x,y:t.center.y}});for(var i=1;i<this.route.path.length-1;i++){var n=this.worldService.getSeaArea(this.route.path[i]),r=this.worldService.getSeaArea(this.route.path[i+1]);this.routePaths.push({origin:{x:n.center.x,y:n.center.y},target:{x:r.center.x,y:r.center.y}})}if(this.mission===Fv.FISHING||this.mission===Fv.HUNTING||this.mission===Fv.TREASURE||this.mission===Fv.CARTOGRAPHY||this.mission===Fv.SEA_BATTLE)if("traveling"===this.status)this.routePaths[this.routePaths.length-1].target=this.getDestinationTargetSeaEvent().center;else if("returning"===this.status){var o=this.worldService.getSeaArea(this.route.path[0]);this.routePaths[0].origin=o.events.length>0?o.events[0].center:o.center}}},{key:"getTravelSpeed",value:function(){var e=u(v(i.prototype),"getTravelSpeed",this).call(this);return this.ownerCountry.id===Vv.PLAYER&&(this.gameService.isEnabled(wv.LOGISTICS)&&(e*=1.1),this.servicesService.getService(Zv.SEA).getBuildings().find(function(e){return e.getBuildingType()===Pv.LIGHTHOUSE&&e.isWorking()})&&(e*=1.1)),e}},{key:"getDestinationTargetRegion",value:function(){return this.route.path[this.route.path.length-1]>=0?this.worldService.getRegion(this.route.path[this.route.path.length-1]):null}},{key:"getDestinationTargetSeaEvent",value:function(){return this.worldService.getSeaArea(this.route.path[this.route.path.length-1]).events[0]}},{key:"getMissionType",value:function(){return d_.SEA}},{key:"tick",value:function(){var e=60*this.speed/3/this.getDistance();if(this.ownerCountry.id===Vv.PLAYER&&this.gameService.isEnabled(wv.LOGISTICS)&&(e*=1.1),"traveling"===this.status)if(this.progress<100)this.progress+=e,this.progress>100&&(this.progress=100);else{if(!this.evaluateRegion())return;this.targetIndex===this.route.path.length-1?(this.origin=this.target,this.isInstant()?this.calculateMission()?(this.status="returning",this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target):this.status="finished":this.status="{mission}"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target),this.progress=0}else if("{mission}"===this.status)if(this.progress<100)this.progress+=1/this.missionTime;else{if(this.calculateMission()){this.status="returning";var t=this.worldService.findSeaPath(this.getTargetRegionId(),this.route.path[0],!1);this.route.reversePath(),this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,t&&(t.path.length<this.route.path.length||!this.validateRoute())&&(this.route=t,this.targetIndex=1,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}else this.worldService.clearMission(),this.status="finished";this.progress=0}else("returning"===this.status||"canceled"===this.status)&&(this.progress<100?(this.progress+=e,this.progress>100&&(this.progress=100)):(this.evaluateRegion(),this.targetIndex===this.route.path.length-1?(this.finish("canceled"===this.status),this.worldService.getSelectedMission()&&this.worldService.getSelectedMission().id===this.id&&this.worldService.clearMission(),this.status="finished"):(this.targetIndex+=1,this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target,this.progress=0)))}},{key:"cancel",value:function(){this.canCancel()&&"traveling"===this.status&&(this.progress=100-this.progress,this.status="returning",this.route.reversePath(),this.targetIndex=this.route.path.length-this.targetIndex,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target)}},{key:"evaluateRegion",value:function(){var e,t=this.worldService.getSeaArea(this.getTargetRegionId());if(!this.validateRoute()&&((e=this.getDestinationTargetSeaEvent()?this.worldService.findSeaPath(t.id,this.getDestinationTargetSeaEvent().parentId,!1):this.worldService.findSeaPath(t.id,this.getDestinationTargetRegion().id,!1))&&e.path.length>1)){var i=new E_(this.route.path.splice(0,this.targetIndex));i.path=i.path.concat(e.path),this.route=i,this.initRoutePaths(),this.origin=this.routePaths[this.targetIndex-1].origin,this.target=this.routePaths[this.targetIndex-1].target}if((this.getDestinationTargetSeaEvent()&&t.id!==this.getDestinationTargetSeaEvent().parentId||this.getDestinationTargetRegion()&&t.id!==this.getDestinationTargetRegion().id)&&t.events.length>0&&(t.events[0].type===jv.PIRATES||t.events[0].type===jv.PIRATES_BASE)&&(t.events[0].type===jv.PIRATES||t.events[0].type===jv.PIRATES_BASE)){var n=this.army.getNavy(!0),r=this.armyService.calculateAttack(n,t.events[0].data,t.events[0].type===jv.PIRATES?0:3,!0,!1);if(r.attacker=this.ownerCountry.id,r.defender=Vv.PIRATES,r.result){r.message=t.events[0].type===jv.PIRATES?"Pirates defeated":"Pirates base destroyed",this.army.addArmy(n);for(var o=this.army.getLandUnits(!0);o.getArmySize()>0&&this.getTroopsSize(o)>this.getNavyCapacity(n);)o.units[sp.randomBetween(0,o.units.length-1)].size-=1,o.removeEmptyUnits();return this.army.addArmy(o),this.data=Math.min(10*this.army.getArmyCargo(),t.events[0].amount),t.events[0].amount-=this.data,t.events[0].amount>=50?t.events[0].type=jv.TREASURE:(t.events[0].amount=0,t.events[0].time=-1),this.logService.fightReport(r),!0}return r.message="Pirates won against our navy",this.status="finished",this.army.clearArmy(),this.logService.fightReport(r),!1}return!0}},{key:"validateRoute",value:function(){if("traveling"===this.status&&this.isEventBasedMission()&&!this.getDestinationTargetSeaEvent())return this.cancel(),!1;for(var e=this.targetIndex;e<this.route.path.length-1;e++){var t=this.worldService.getSeaArea(this.route.path[e]);if(t.events.length>0&&(t.events[0].type===jv.PIRATES||t.events[0].type===jv.PIRATES_BASE))return!1}return!0}},{key:"getIconPath",value:function(){return this.army.hasTroop(Bv.GALLEON)?"assets/sea/galleon.svg":this.army.hasTroop(Bv.BRIGANTINE)?"assets/sea/brigantine.svg":this.army.hasTroop(Bv.BOAT)?"assets/sea/boat.svg":void 0}},{key:"getTroopsSize",value:function(e){var t=0;return e.units.forEach(function(e){e.troop!==Bv.ALL&&e.troop!==Bv.BOAT&&e.troop!==Bv.BRIGANTINE&&e.troop!==Bv.GALLEON&&e.size>0&&(t+=e.getTroopSize())}),t}},{key:"getNavyCapacity",value:function(e){var t=0;return e.units.forEach(function(e){(e.troop===Bv.BOAT||e.troop===Bv.BRIGANTINE||e.troop===Bv.GALLEON)&&e.size>0&&(t+=e.getTroopCargo())}),t}},{key:"canCancel",value:function(){return!0}},{key:"getDistance",value:function(){return this.calculatePointsDistance(this.origin,this.target)}},{key:"getArmyEffectiveSpeed",value:function(){return this.servicesService.getService(Zv.SEA).getBuildings().find(function(e){return e.getBuildingType()===Pv.LIGHTHOUSE&&e.isWorking()})?1.1*this.army.getNavy(!1).getArmySpeed():this.army.getNavy(!1).getArmySpeed()}},{key:"isEventBasedMission",value:function(){return!1}}]),i}(g_),__=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.FISHING,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){if(!this.getDestinationTargetSeaEvent())return!0;var e=5*this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount);return this.getDestinationTargetSeaEvent().amount-=t,this.data=t,!0}},{key:"finish",value:function(e){this.data&&this.data>0&&this.servicesService.getResourcesService().increaseResource(Mv.FISH,this.data,"Fishing",!0),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([])}},{key:"isEventBasedMission",value:function(){return!0}}]),i}(N_),w_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.HUNTING,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){if(!this.getDestinationTargetSeaEvent())return!0;var e=5*this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount),i=Math.ceil(.7*t),n=t-i;return this.getDestinationTargetSeaEvent().amount-=t,this.data={meat:i,fur:n},!0}},{key:"finish",value:function(e){this.data&&this.data.meat>0&&(this.servicesService.getResourcesService().increaseResource(Mv.MEAT,this.data.meat,"Sea hunting",!0),this.servicesService.getResourcesService().increaseResource(Mv.FUR,this.data.fur,"Sea hunting",!0)),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([])}},{key:"isEventBasedMission",value:function(){return!0}}]),i}(N_),P_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.TREASURE,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){if(!this.getDestinationTargetSeaEvent())return!0;var e=10*this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount);return this.getDestinationTargetSeaEvent().amount-=t,this.data=t,!0}},{key:"finish",value:function(e){this.data&&this.data>0&&this.servicesService.getResourcesService().increaseResource(Mv.COINS,this.data,"Treasure",!0),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([])}},{key:"isEventBasedMission",value:function(){return!0}}]),i}(N_),M_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.EXPEDITION,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){void 0!==this.data&&(sp.chance(this.data/100)||this.logService.warning("Our expedition didn't find any new land, perhaps we need to go farther"));var e=0,t=0,i=0,n=0;return this.army.getLandUnits(!1).units.forEach(function(e){n+=e.getTroopStrength()*e.size,n+=e.getTroopDefense()*e.size}),sp.chance(.5)?(e+=Math.ceil(.6*n),n-=e,t+=Math.ceil(.6*n),i=n-=t):sp.chance(.7)?(t+=Math.ceil(.6*n),n-=t,e+=Math.ceil(.6*n),i=n-=e):(i+=Math.ceil(.6*n),n-=i,e+=Math.ceil(.6*n),t=n-=e),this.data={land:e,forest:t,mountains:i},!0}},{key:"finish",value:function(e){var t=this.servicesService.getLandService();this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([]),this.data&&(this.data.land&&(t.increaseLand(this.data.land,!0),this.worldService.increaseDiscoveredLand(this.data.land)),this.data.forest&&(t.increaseForest(this.data.forest,!1),this.worldService.increaseDiscoveredForest(this.data.forest)),this.data.mountains&&(t.increaseMountains(this.data.mountains),this.worldService.increaseDiscoveredMountains(this.data.mountains)),this.logService.success("We found a new land:<br> Land:"+this.data.land+"<br> Forest:"+this.data.forest+"<br> Mountains:"+this.data.mountains+"<br>"))}}]),i}(N_),D_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.CARTOGRAPHY,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){if(!this.getDestinationTargetSeaEvent())return!0;var e=this.army.getArmyCargo(),t=Math.min(e,this.getDestinationTargetSeaEvent().amount);return this.getDestinationTargetSeaEvent().amount-=t,this.data=t,!0}},{key:"finish",value:function(e){this.data&&this.data>0&&this.servicesService.getNavyService().increaseCartographyData(this.data),this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([])}},{key:"isEventBasedMission",value:function(){return!0}}]),i}(N_),L_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.SEA_BATTLE,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){if(!this.getDestinationTargetSeaEvent())return!0;var e=this.army.getNavy(!0),t=this.getDestinationTargetSeaEvent().type===jv.PIRATES?0:3,i=this.armyService.calculateAttack(e,this.getDestinationTargetSeaEvent().data,t,!0,!1);if(i.attacker=this.ownerCountry.id,i.defender=Vv.PIRATES,i.result){this.getDestinationTargetSeaEvent().type===jv.PIRATES?(i.message="Pirates defeated",this.servicesService.getHappinessService().addHappinessEffect(0,Kv.PIRATES_DEFEATED,1,180)):(i.message="Pirates base destroyed",this.servicesService.getHappinessService().addHappinessEffect(0,Kv.PIRATES_DEFEATED,3,360)),this.army.addArmy(e);for(var n=this.army.getLandUnits(!0);n.getArmySize()>0&&this.getTroopsSize(n)>this.getNavyCapacity(e);)n.units[sp.randomBetween(0,n.units.length-1)].size-=1,n.removeEmptyUnits();return this.army.addArmy(n),this.data=Math.min(10*this.army.getArmyCargo(),this.getDestinationTargetSeaEvent().amount),this.getDestinationTargetSeaEvent().amount-=this.data,this.getDestinationTargetSeaEvent().amount>=50?this.getDestinationTargetSeaEvent().type=jv.TREASURE:(this.getDestinationTargetSeaEvent().amount=0,this.getDestinationTargetSeaEvent().time=-1),this.logService.fightReport(i),!0}return i.message="Pirates won against our navy",this.army.clearArmy(),this.status="finished",this.logService.fightReport(i),!1}},{key:"finish",value:function(e){this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([])}},{key:"getTroopsSize",value:function(e){var t=0;return e.units.forEach(function(e){e.troop!==Bv.ALL&&e.troop!==Bv.BOAT&&e.troop!==Bv.BRIGANTINE&&e.troop!==Bv.GALLEON&&e.size>0&&(t+=e.getTroopSize())}),t}},{key:"getNavyCapacity",value:function(e){var t=0;return e.units.forEach(function(e){(e.troop===Bv.BOAT||e.troop===Bv.BRIGANTINE||e.troop===Bv.GALLEON)&&e.size>0&&(t+=e.getTroopCargo())}),t}},{key:"isEventBasedMission",value:function(){return!0}}]),i}(N_),x_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.SEA_CONQUER,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){var e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){var i=this.army.getLandUnits(!0),n=this.armyService.calculateAttack(i,e.army,e.defense,!0,!1);return n.attacker=this.ownerCountry.id,n.defender=t.id,n.result?(n.message="Region conquered",this.armyService.loot(50*e.wealth+200*e.economy),t.diplomacy<25?t.decreaseDiplomacy(30):t.diplomacy=-50,t.capital===e.id&&(t.diplomacy=-100),this.worldService.ownRegion(this.getTargetRegionId(),this.ownerCountry),this.getDestinationTargetRegion().army.addArmy(i),this.logService.fightReport(n),!0):(n.message="Our army has been defeated",t.diplomacy<25?t.decreaseDiplomacy(15):t.diplomacy=30,this.logService.fightReport(n),!0)}return!0}},{key:"finish",value:function(e){return this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([]),!1}}]),i}(N_),F_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.SEA_PLUNDER,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!1}},{key:"calculateMission",value:function(){var e=this.worldService.getRegion(this.getTargetRegionId()),t=this.worldService.getCountryByRegionId(e.id);if(t.id!==this.ownerCountry.id){var i=this.army.getLandUnits(!0),n=this.armyService.calculateAttack(i,e.army,e.defense,!0,!1);return n.attacker=this.ownerCountry.id,n.defender=t.id,n.result?(t.decreaseDiplomacy(t.diplomacy<25?10:30),this.data=e.wealth,e.wealth=0,n.message="Region plundered",e.target=v_.DEFENSE_ARCHER,this.army.addArmy(i),this.logService.fightReport(n),!0):(n.message="Our army has been defeated",t.decreaseDiplomacy(t.diplomacy<25?5:15),e.target=v_.DEFENSE_ARCHER,this.logService.fightReport(n),!0)}}},{key:"finish",value:function(e){return this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([]),!1}}]),i}(N_),U_=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"traveling",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return p(this,i),t.call(this,e,n,Fv.SEA_MOVE,u,s,a,c,r,o,l)}return S(i,[{key:"isInstant",value:function(){return!0}},{key:"calculateMission",value:function(){var e=this.getDestinationTargetRegion(),t=this.worldService.getCountryByRegionId(e.id);return t.id!==Vv.PLAYER&&t.id!==Vv.NEUTRAL||(e.army.addArmy(this.army.getLandUnits(!0)),!e.harbour)||(e.navy.addArmy(this.army.getNavy(!0)),!1)}},{key:"finish",value:function(e){return this.getDestinationTargetRegion().army.addArmy(this.army.getLandUnits(!0)),this.getDestinationTargetRegion().navy.addArmy(this.army.getNavy(!0)),this.army=new AC([]),!1}}]),i}(N_),H_=function(){var e=function(){function e(t){p(this,e),this.servicesService=t,t.addService(Zv.MISSION_FACTORY,this)}return S(e,[{key:"loadMission",value:function(e){var t=this.servicesService.getWorldService(),i=new AC([]);if(e.army.forEach(function(e){i.addTroop(e.troop,e.size)}),e.type!==Fv.BUILD&&0===i.units.length)return null;var n=new E_(e.route);switch(e.type){case Fv.COLONIZE:return new R_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.CONQUER:return new O_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.MOVE:return new A_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.PLUNDER:return new T_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.SPY:return new k_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.BUILD:return new I_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.FISHING:return new __(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.HUNTING:return new w_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.TREASURE:return new P_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.EXPEDITION:return new M_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.CARTOGRAPHY:return new D_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.SEA_BATTLE:return new L_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.SEA_MOVE:return new U_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.SEA_PLUNDER:return new F_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data);case Fv.SEA_CONQUER:return new x_(this.servicesService,e.id,t.getCountry(e.ownerCountryId),i,n,e.progress,e.targetIndex,e.status,e.data)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),G_=function(){var e=function(){function e(t,i,n,r,o,s,a,u,c,l,h,d){var g=this;p(this,e),this.servicesService=t,this.idService=i,this.armyService=n,this.navyService=r,this.logService=o,this.calendarService=s,this.modalService=a,this.missionFactoryService=u,this.optionsService=c,this.soundService=l,this.landService=h,this.kongregateService=d,this.countries=[],this.regionsNeighbours=[],this.missions=[],this.regions=[],this.seaAreas=[],this.protection=0,this.defaultOrigin=0,this.discoveredLand=0,this.discoveredForest=0,this.discoveredMountains=0,this.x=150,this.y=-220,this.zoom=1.4,this.mapDisplayOption=0,this.showHarbours=!0,this.activeCountriesList=[],this.pathCacheSubject=new U,this.servicesService.addService(Zv.WORLD,this),this.init(),this.selectedCountry=this.countries[0],this.selectedRegion=this.selectedCountry.regions[0],this.calendarService.registerForDayChange().subscribe(function(){g.countries.filter(function(e){return e.id!==Vv.PLAYER&&e.id!==Vv.NEUTRAL}).forEach(function(e){e.regions.forEach(function(t){sp.chance((t.economy+5)*g.AI_getDifficultyMultiplier()/100)&&(t.wealth+=1),g.AI_dailyRegionAction(e,t)})}),g.seaAreas.filter(function(e){return e.events.length>0}).map(function(e){return e.events[0]}).forEach(function(e){return e.tick(g.servicesService,g,g.idService,g.logService)}),g.seaAreas.forEach(function(e){e.events.length>0&&(e.events[0].time<0||e.events[0].amount<=0)&&(e.events[0]===g.selectedSeaEvent&&(g.selectedSeaEvent=null),e.events.shift())}),g.spawnSeaEvents(),g.protection>0&&(g.protection-=1),g.protection<0&&(g.protection=0)})}return S(e,[{key:"init",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];pm.REGIONS.forEach(function(t){var i=[];t.TROOPS.forEach(function(e){return i.push(new CC(e.troop,e.size))}),e.regions.push(new m_(t.ID,t.PATH,t.CENTER,t.NEIGHBOURS,t.LAND,t.FOREST,t.MOUNTAINS,t.WEALTH,0,0,t.HARBOUR,!1,!1,!1,null,0,new AC(i)))}),this.regions[0].army=this.armyService.getArmy(),this.regions[0].navy=this.navyService.getNavy(),Object.values(pm.COUNTRIES).forEach(function(i){var n=[];i.REGIONS.forEach(function(r){var o=e.regions[r];i.CAPITAL===r&&(o.capital=i.COUNTRY),n.push(o),t&&i.COUNTRY!==Vv.PLAYER&&i.COUNTRY!==Vv.NEUTRAL&&e.regions[r].army.addTroop(Bv.ARCHER,Math.ceil(2*e.AI_getDifficultyMultiplier()))}),e.countries.push(new p_(i.COUNTRY,i.NAME,i.DIPLOMACY,i.COLOUR,i.FOCUS,n,{},i.CAPITAL))}),this.regionsNeighbours=[],Object.values(pm.REGIONS).forEach(function(t){e.regionsNeighbours.push(new S_(t.ID,t.NEIGHBOURS))}),this.calendarService.registerForYearChange().subscribe(function(t){e.countries.filter(function(e){return e.id!==Vv.PLAYER&&e.id!==Vv.NEUTRAL}).forEach(function(t){t.regions.length>0&&sp.chance(pm.KING_DEATH_CHANCE)&&(t.focus=sp.randomElement([{item:Wv.OFFENSE,chance:25},{item:Wv.DEFENSE,chance:25},{item:Wv.PEACE,chance:25},{item:Wv.ECONOMY,chance:25}]),e.logService.warning(t.name+" king died. New king is known to focus on "+Qv.prepareFocusName(t.focus)))})}),this.initSeaAreas(),this.selectedRegion=this.regions[0],this.selectedCountry=this.getPlayerCountry(),this.initPlayerKingdomName()}},{key:"initSeaAreas",value:function(){var e=this;pm.SEA_AREAS.forEach(function(t){e.seaAreas.push(new b_(t.ID,{x:t.CENTER.x,y:t.CENTER.y},t.R,[],t.NEIGHBOURS))});var t=this.seaAreas.filter(function(e){return-1!==e.id});Object.keys(jv).slice(Object.keys(jv).length/2).map(function(e){return jv[e]}).forEach(function(i){for(var n=pm.getSeaEvent(i),r=0;r<n.NUMBER_INIT;r++)if(t.length>0){var o=t.filter(function(e){return e.r>n.FOR_RADIUS}),s=o[sp.randomBetween(0,o.length-1)];0===s.events.length&&s.events.push(new C_(s.id,e.idService.getNextId(),i,e.getRandomPointInCircle(s.center,s.r),sp.randomBetween(n.POWER_MIN,n.POWER_MAX),sp.randomBetween(n.TIME_MIN,n.TIME_MAX),null)),t=t.filter(function(e){return 0===e.events.length})}})}},{key:"AI_dailyRegionAction",value:function(e,t){if(null===t.target?this.AI_chooseTarget(t,e):this.AI_executeTarget(t,e),t.spy>0&&sp.chance(t.army.getArmySize()/2e4)){t.spy-=1;var i=new YC;i.attacker=e.id,i.defender=Vv.PLAYER,i.attackerArmy=AC.clone(t.army),i.defenderArmy=new AC([new CC(Bv.SPY,1)]),i.skirmish.push(new jC(i.attackerArmy.getRandomUnit().troop,i.defenderArmy.getRandomUnit().troop,1,0,!0)),i.result=!0,i.armyAfterFight=i.attackerArmy,i.message="Our "+e.name+" spy has been discovered and killed!",this.logService.fightReport(i),e.decreaseDiplomacy(e.diplomacy<25?5:15)}}},{key:"AI_chooseTarget",value:function(e,t){var i=10;t.regions.find(function(e){return e.id===t.capital})||(i=75);var n=[{item:Wv.OFFENSE,chance:i},{item:Wv.DEFENSE,chance:10},{item:Wv.PEACE,chance:10},{item:Wv.ECONOMY,chance:10}],r=n.find(function(e){return e.item===t.focus});r&&(r.chance=70);var o=sp.randomElement(n),s=v_.NONE;switch(o){case Wv.ECONOMY:var a=[],u=70-8*e.economy;u<5&&(u=5),this.getNeutralRegionsNumber()>0&&a.push({item:v_.ECONOMY_COLONIZE,chance:10}),a.push({item:v_.ECONOMY_BUILD,chance:u}),s=sp.randomElement(a);break;case Wv.DEFENSE:var c=[];e.army.getArmySize()<5*e.wealth&&c.push({item:v_.DEFENSE_ARCHER,chance:50});var l=30-4*e.defense;l<5&&(l=5),c.push({item:v_.DEFENSE_WALL,chance:l}),s=sp.randomElement(c);break;case Wv.PEACE:e.target=v_.PEACE;break;case Wv.OFFENSE:var h=[{item:v_.OFFENSE_PLUNDER,chance:5},{item:v_.OFFENSE_CONQUER,chance:2}];if(e.army.getArmySize()<5*e.wealth&&h.push({item:v_.OFFENSE_SPEARMAN,chance:30},{item:v_.OFFENSE_SWORDSMAN,chance:25},{item:v_.OFFENSE_LIGHT_CAVALRY,chance:10}),this.getNeutralRegionsNumber()>0&&h.push({item:v_.OFFENSE_COLONIZE,chance:10}),!t.regions.find(function(e){return e.id===t.capital})&&e.army.getArmyPower(!0)>5){var d=this.findPath(e.id,t.capital,t.id,!0),g=this.missions.find(function(e){return e.ownerCountry===t&&e.getTargetRegionId()===t.capital});d&&!g&&h.push({item:v_.OFFENSE_RECLAIM_CAPITAL,chance:50})}s=sp.randomElement(h)}e.target=s||v_.NONE}},{key:"AI_executeTarget",value:function(e,t){var i=this;switch(e.target){case v_.NONE:e.target=null;break;case v_.PEACE:sp.chance(.1)&&(e.target=null);break;case v_.SAVE_WEALTH:e.wealth>=5*(e.economy+1)&&(e.target=null);break;case v_.ECONOMY_BUILD:e.wealth>=10*(e.economy+1)&&(e.wealth-=10*(e.economy+1),e.economy+=1,e.target=null);break;case v_.ECONOMY_COLONIZE:if(e.economy>=2){var n=this.findNeighbouringColonizableRegions(e,t);n.length?e.wealth>=40&&(this.missions.push(new R_(this.servicesService,this.idService.getNextId(),t,new AC([new CC(Bv.COLONIST,15)]),this.findPath(e.id,n[0],t.id))),e.wealth-=40,e.target=null):e.target=null}else e.target=null;break;case v_.DEFENSE_WALL:if(e.economy<=e.defense||e.defense>=7){e.target=null;break}e.wealth>=20*(e.defense+1)&&(e.wealth-=20*(e.defense+1),e.defense+=1,e.target=null);break;case v_.DEFENSE_ARCHER:this.AI_hireTroop(e,Bv.ARCHER);break;case v_.DEFENSE_GUARD_TOWER:e.target=null;break;case v_.OFFENSE_SPEARMAN:this.AI_hireTroop(e,Bv.SPEARMAN);break;case v_.OFFENSE_SWORDSMAN:this.AI_hireTroop(e,Bv.SWORDSMAN);break;case v_.OFFENSE_LIGHT_CAVALRY:this.AI_hireTroop(e,Bv.LIGHT_CAVALRY);break;case v_.OFFENSE_COLONIZE:if(e.army.getArmyPower(!0)>=20){var r=this.findNeighbouringColonizableRegions(e,t);r.length?e.wealth>=20&&(this.missions.push(new R_(this.servicesService,this.idService.getNextId(),t,new AC([new CC(Bv.COLONIST,15)]),this.findPath(e.id,r[0],t.id))),e.wealth-=20,e.target=null):e.target=null}else e.target=null;break;case v_.OFFENSE_PLUNDER:if(e.army.getArmyPower(!0)>20){var o=this.findNeighbouringAttackableRegions(e,t,!0);o.length>0?(this.missions.push(new T_(this.servicesService,this.idService.getNextId(),t,this.AI_prepareArmy(e.army),this.findPath(e.id,o[0],t.id))),this.getRegion(o[0]).lastAttack=this.calendarService.getAbsoluteDay(),this.getCountryByRegionId(o[0]).id===Vv.PLAYER&&(this.logService.warning("Incoming invasion!"),this.soundService.playBattle())):e.target=null}else e.target=null;break;case v_.OFFENSE_CONQUER:if(e.army.getArmyPower(!0)>20){var s=this.findNeighbouringAttackableRegions(e,t,!1).filter(function(e){return 0!==e}).filter(function(t){return i.getRegion(t).army.getArmyPower(!1)<1.5*e.army.getArmyPower(!0)});s.length>0?(this.missions.push(new O_(this.servicesService,this.idService.getNextId(),t,this.AI_prepareArmy(e.army),this.findPath(e.id,s[0],t.id))),this.getRegion(s[0]).lastAttack=this.calendarService.getAbsoluteDay(),this.getCountryByRegionId(s[0]).id===Vv.PLAYER&&(this.logService.warning("Incoming invasion!"),this.soundService.playBattle())):e.target=null}else e.target=null;e.target=null;break;case v_.OFFENSE_RECLAIM_CAPITAL:if(t.regions.find(function(i){return i.id===t.capital&&e.army.getArmyPower(!0)>5}))e.target=null;else{var a=this.findPath(e.id,t.capital,t.id,!1),u=this.missions.find(function(e){return e.ownerCountry===t&&e.getTargetRegionId()===t.capital});a&&!u?this.missions.push(new O_(this.servicesService,this.idService.getNextId(),t,this.AI_prepareArmy(e.army),a)):e.target=null}e.target=null}}},{key:"AI_hireTroop",value:function(e,t){var i=lm.getTroop(t).AI_COST;e.wealth>=i&&(e.wealth-=i,e.army.addTroop(t,1),e.target=null)}},{key:"AI_getDifficultyMultiplier",value:function(){var e=1;switch(this.optionsService.getOption(Xv.AI_DIFFICULTY)){case hp.EASY:e=.5;break;case hp.MEDIUM:e=1;break;case hp.HARD:e=2}return e}},{key:"getName",value:function(){return"WorldService"}},{key:"load",value:function(e){var t=this;e.regions||e.countries?(e.regions.forEach(function(e){var i=t.regions[e.id];i.wealth=e.wealth,i.economy=e.economy,i.defense=e.defense,i.defense=null!==e.defense&&e.defense,i.target=e.target,i.land=e.land,i.forest=e.forest,i.mountains=e.mountains,i.spy=e.spy,i.harbour=void 0!==e.harbour?e.harbour:void 0!==pm.REGIONS.find(function(e){return e.ID===i.id})&&pm.REGIONS.find(function(e){return e.ID===i.id}).HARBOUR,i.roads=void 0!==e.roads&&e.roads,i.watchtower=void 0!==e.watchtower&&e.watchtower,i.watched=void 0!==e.watched&&e.watched,i.capital=e.capital,i.lastAttack=void 0!==e.lastAttack?e.lastAttack:0,i.army=new AC([]),i.navy=new AC([]),e.army.forEach(function(e){i.army.addTroop(e.troop,e.size)}),e.navy&&e.navy.forEach(function(e){i.navy.addTroop(e.troop,e.size)})}),this.seaAreas.forEach(function(e){e.events=[]}),void 0!==e.seaEvents&&e.seaEvents.forEach(function(e){var i=t.seaAreas.find(function(t){return t.id===e.parentId});i&&(i.events=[],i.events.push(new C_(i.id,e.id,e.type,e.center,e.amount,e.time,e.data)))}),this.selectedCountry=null===this.selectedCountry?null:this.getCountry(this.selectedCountry.id),e.countries.forEach(function(e){var i=t.getCountry(e.id);i.diplomacy=e.diplomacy,i.focus=e.country,i.capital=void 0!==e.capital?e.capital:pm.COUNTRIES.find(function(e){return e.COUNTRY===i.id}).CAPITAL,i.regions=[],e.regions.forEach(function(e){i.regions.push(t.regions[e])}),i.data=e.data}),this.missions=[],e.missions.forEach(function(e){var i=t.missionFactoryService.loadMission(JSON.parse(e));null!==i&&t.missions.push(i)}),this.missions.forEach(function(e){e.army=new AC(e.army.units.filter(function(e){return e.troop!==Bv.GUARD_TOWER}))}),this.defaultOrigin=e.defaultOrigin,this.discoveredLand=void 0!==e.discoveredLand?e.discoveredLand:0,this.discoveredForest=void 0!==e.discoveredForest?e.discoveredForest:0,this.discoveredMountains=void 0!==e.discoveredMountains?e.discoveredMountains:0,this.getPlayerCountry().name=e.playerNationName,this.x=e.x,this.y=e.y,this.zoom=e.zoom,this.mapDisplayOption=void 0!==e.mapDisplayOption?e.mapDisplayOption:0,this.regions[0].army=this.armyService.getArmy(),this.regions[0].navy=this.navyService.getNavy(),this.protection=void 0!==e.protection?e.protection:0):this.reset(!1,!1)}},{key:"reset",value:function(e,t){var i=this,n=this.getPlayerCountry().name,r=[],o=this.seaAreas;(e||t)&&(this.discoveredLand=0,this.discoveredForest=0,this.discoveredMountains=0),!e&&!t&&this.countries.forEach(function(e){r.push([e.id,e.regions.map(function(e){return e.id})])}),this.countries=[],this.regionsNeighbours=[],this.missions=[],this.regions=[],this.seaAreas=[],this.defaultOrigin=0,this.selectedRegion=null,this.selectedCountry=null,this.selectedMission=null,this.selectedSeaEvent=null,this.x=150,this.y=-220,this.zoom=1.4,this.mapDisplayOption=0,this.protection=0,this.init(!1),!e&&!t&&this.seaAreas.forEach(function(e){var t=o.find(function(t){return t.id===e.id});t&&(e.events=t.events)}),this.regions[0].army=this.armyService.getArmy(),this.regions[0].navy=this.navyService.getNavy(),e?this.initPlayerKingdomName():this.getPlayerCountry().name=n,this.countries.forEach(function(e){var t=r.find(function(t){return t[0]===e.id});t&&(e.regions=[],t[1].forEach(function(t){var n=i.getRegion(t);e.regions.push(n),e.id===Vv.PLAYER&&0!==n.id&&(i.landService.increaseLand(n.land,!0),i.landService.increaseForest(n.forest,!1),i.landService.increaseMountains(n.mountains)),e.id!==Vv.PLAYER&&e.id!==Vv.NEUTRAL&&i.regions[t].army.addTroop(Bv.ARCHER,Math.ceil(2*i.AI_getDifficultyMultiplier()))}))})}},{key:"save",value:function(){var e=[];this.countries.forEach(function(t){var i=[];t.regions.forEach(function(e){i.push(e.id)}),e.push({id:t.id,diplomacy:t.diplomacy,focus:t.focus,regions:i,data:t.data,capital:t.capital})});var t=[];this.regions.forEach(function(e){var i=[],n=[];0!==e.id&&e.army.units.forEach(function(e){i.push({troop:e.troop,size:e.size})}),0!==e.id&&e.navy.units.forEach(function(e){n.push({troop:e.troop,size:e.size})}),t.push({id:e.id,wealth:e.wealth,economy:e.economy,defense:e.defense,harbour:e.harbour,target:e.target,land:e.land,forest:e.forest,mountains:e.mountains,spy:e.spy,capital:e.capital,army:i,navy:n,roads:e.roads,watchtower:e.watchtower,watched:e.watched,lastAttack:e.lastAttack})});var i=[];this.missions.forEach(function(e){i.push(JSON.stringify(e))});var n=[];return this.seaAreas.forEach(function(e){e.events.length>0&&n.push(e.events[0])}),{countries:e,regions:t,seaEvents:n,missions:i,defaultOrigin:this.defaultOrigin,discoveredLand:this.discoveredLand,discoveredForest:this.discoveredForest,discoveredMountains:this.discoveredMountains,playerNationName:this.getPlayerCountry().name,protection:this.protection,x:this.x,y:this.y,zoom:this.zoom,mapDisplayOption:this.mapDisplayOption}}},{key:"getCountries",value:function(){return this.countries}},{key:"getMissions",value:function(){return this.missions}},{key:"getPlayerLandMissions",value:function(){return this.missions.filter(function(e){return e.getMissionType()===d_.LAND&&e.ownerCountry.id===Vv.PLAYER})}},{key:"getPlayerSeaMissions",value:function(){return this.missions.filter(function(e){return e.getMissionType()===d_.SEA&&e.ownerCountry.id===Vv.PLAYER})}},{key:"setSelectedCountry",value:function(e){this.selectedCountry=e,this.selectedMission=null,this.selectedSeaEvent=null}},{key:"getSelectedCountry",value:function(){return this.selectedCountry}},{key:"setSelectedRegion",value:function(e){this.selectedRegion=e,this.selectedMission=null,this.selectedSeaEvent=null}},{key:"getSelectedRegion",value:function(){return this.selectedRegion}},{key:"setSelectedMission",value:function(e){this.selectedCountry=null,this.selectedRegion=null,this.selectedSeaEvent=null,this.selectedMission=e}},{key:"getSelectedMission",value:function(){return this.selectedMission}},{key:"registerForCacheInvalidation",value:function(){return this.pathCacheSubject.asObservable()}},{key:"tick",value:function(e){this.missions.forEach(function(e){e.tick()}),this.missions=this.missions.filter(function(e){return!e.isFinished()}),this.missions.includes(this.getSelectedMission())||(this.selectedMission=null)}},{key:"getRegionNeighbours",value:function(e,t){var i=this.regionsNeighbours.find(function(t){return t.id===e}),n=[];return i&&i.neighbours.forEach(t?function(e){n.push(e)}:function(t){e>=0&&t>=0&&n.push(t)}),n}},{key:"findPath",value:function(e,t,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=!0;if(e===t)return new E_([e]);var a=Number.MAX_SAFE_INTEGER,u=new Array(this.regions.length).fill(Number.MAX_SAFE_INTEGER),c=[],l=[],h=[];for(c.push(new E_([e]));c.length>0||l.length>0;){var d,g=n(c);try{var f=function(){var e=d.value,c=r.getCountryByRegionId(e.path[e.path.length-1]);if(i===Vv.SPECIAL||c.id===i||c.id===Vv.NEUTRAL||s){var g,f=n(r.getRegionNeighbours(e.path[e.path.length-1],!1).filter(function(t){return!e.path.includes(t)}));try{for(f.s();!(g=f.n()).done;){var v=g.value,p=new E_(e.path.slice().concat([v]));if(p.calculatePathDistance(r)<=u[v]&&(u[v]=p.calculatePathDistance(r),u[v]<=a))if(v===t){if(o)return{v:p};u[v]<a&&(a=u[v]),h.push(p)}else l.push(p)}}catch(m){f.e(m)}finally{f.f()}}};for(g.s();!(d=g.n()).done;){var v=f();if("object"==typeof v)return v.v}}catch(p){g.e(p)}finally{g.f()}s=!1,c=l,l=[]}return 0===h.length?null:h.sort(function(e,t){return e.distance-t.distance})[0]}},{key:"addMission",value:function(e){this.missions.push(e)}},{key:"getCountry",value:function(e){return this.countries.find(function(t){return t.id===e})}},{key:"getCountryByRegionId",value:function(e){var t=null;return this.countries.forEach(function(i){i.regions.find(function(t){return t.id===e})&&(t=i)}),t}},{key:"getRegion",value:function(e){return this.regions[e]}},{key:"ownRegion",value:function(e,t){var i=this,n=this.getCountryByRegionId(e);if(n.id!==t.id){var r=n.regions.findIndex(function(t){return t.id===e});if(void 0!==r){var o=n.regions.splice(r,1)[0];t.regions.push(o),this.selectedRegion&&this.selectedRegion.id===o.id&&(this.selectedCountry=this.getCountryByRegionId(this.selectedRegion.id)),t.id===Vv.PLAYER?(this.landService.increaseLand(o.land,!0),this.landService.increaseForest(o.forest,!1),this.landService.increaseMountains(o.mountains),o.spy=0):o.id===this.defaultOrigin&&(this.defaultOrigin=0),this.activeCountriesList=[],this.pathCacheSubject.next()}}this.regions.forEach(function(e){e.watched=!1}),this.regions.filter(function(e){return""!==e.path}).forEach(function(e){i.getCountryByRegionId(e.id).id===Vv.PLAYER&&e.watchtower&&e.neighbours.forEach(function(e){e>=0&&(i.getRegion(e).watched=!0)})})}},{key:"findSeaPath",value:function(e,t){var i=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return new E_([e]);if(void 0===this.getSeaArea(e)||void 0===t)return null;var o=Number.MAX_SAFE_INTEGER,s=[];this.seaAreas.forEach(function(e){return s.push({id:e.id,cost:Number.MAX_SAFE_INTEGER})});var a=[],u=[],c=[];for(a.push(new E_([e]));a.length>0||u.length>0;){var l,h=n(a);try{var d=function(){var e=l.value,a=i.getSeaArea(e.path[e.path.length-1]);if(0===a.events.length||a.events[0].type!==jv.PIRATES&&a.events[0].type!==jv.PIRATES_BASE&&a.events[0].type!==jv.WHIRLPOOL){var h,d=n(i.getSeaArea(e.path[e.path.length-1]).neighbours.filter(function(t){return!e.path.includes(t)}));try{var g=function(){var n=h.value,a=new E_(e.path.slice().concat([n]));if(a.calculateSeaPathDistance(i)<=s.find(function(e){return e.id===n}).cost&&(s.find(function(e){return e.id===n}).cost=a.calculateSeaPathDistance(i),s.find(function(e){return e.id===n}).cost<=o))if(n===t){if(r)return{v:{v:a}};s.find(function(e){return e.id===n}).cost<o&&(o=s.find(function(e){return e.id===n}).cost),c.push(a)}else u.push(a)};for(d.s();!(h=d.n()).done;){var f=g();if("object"==typeof f)return f.v}}catch(v){d.e(v)}finally{d.f()}}};for(h.s();!(l=h.n()).done;){var g=d();if("object"==typeof g)return g.v}}catch(f){h.e(f)}finally{h.f()}!1,a=u,u=[]}return 0===c.length?null:c.sort(function(e,t){return e.distance-t.distance})[0]}},{key:"clearMission",value:function(){this.selectedMission=null}},{key:"canColonize",value:function(e){return!this.missions.find(function(t){return t.getMissionType()===d_.LAND&&t.getDestinationTargetRegion().id===e&&t.mission===Fv.COLONIZE})}},{key:"getPlayerCountry",value:function(){return this.countries[0]}},{key:"getDefaultOriginRegion",value:function(){return this.getRegion(this.getDefaultOrigin())}},{key:"getDefaultOriginRegionCountry",value:function(){return this.getCountryByRegionId(this.getDefaultOrigin())}},{key:"getDefaultOrigin",value:function(){return this.defaultOrigin}},{key:"setDefaultOrigin",value:function(e){this.defaultOrigin=e}},{key:"getStationedArmies",value:function(){var e=[];return this.countries[0].regions.filter(function(e){return 0!==e.id&&e.army.getArmySize()>0}).forEach(function(t){return e.push(t.army)}),this.countries[1].regions.filter(function(e){return e.army.getArmySize()>0}).forEach(function(t){return e.push(t.army)}),e}},{key:"getStationedNavy",value:function(){var e=[];return this.countries[0].regions.filter(function(e){return 0!==e.id&&e.navy.getArmySize()>0}).forEach(function(t){return e.push(t.navy)}),this.countries[1].regions.filter(function(e){return e.navy.getArmySize()>0}).forEach(function(t){return e.push(t.navy)}),e}},{key:"getDisplayX",value:function(){return this.x}},{key:"getDisplayY",value:function(){return this.y}},{key:"getDisplayZoom",value:function(){return this.zoom}},{key:"setDisplayX",value:function(e){this.x=e}},{key:"setDisplayY",value:function(e){this.y=e}},{key:"setDisplayZoom",value:function(e){this.zoom=e}},{key:"getCountriesList",value:function(){var e=this;return 0===this.activeCountriesList.length&&(this.activeCountriesList.push(Vv[Vv.NONE]),this.countries.filter(function(e){return e.id!==Vv.PLAYER&&e.id!==Vv.NEUTRAL&&e.regions.length>0}).forEach(function(t){return e.activeCountriesList.push(Vv[t.id])})),this.activeCountriesList}},{key:"getNeutralRegionsNumber",value:function(){return this.getCountry(Vv.NEUTRAL).regions.length}},{key:"buildRegionBuilding",value:function(e){this.missions.push(new I_(this.servicesService,this.idService.getNextId(),this.getPlayerCountry(),new AC([]),new E_([this.getSelectedRegion().id,this.getSelectedRegion().id]),0,1,"{mission}",e))}},{key:"changeName",value:function(){var e=this;this.modalService.open(_v.INPUT),this.modalService.setModalText("Specify your nation name"),this.modalService.setModalValue(this.getPlayerCountry().name);var t=this.modalService.registerForValueResponse().subscribe(function(i){t.unsubscribe(),null!==i&&(e.getPlayerCountry().name=i)})}},{key:"findNeighbouringAttackableRegions",value:function(e,t,i){var n=this,r=[],o=[];return t.regions.forEach(function(s){s.neighbours.filter(function(e){return e>=0}).forEach(function(s){var a=n.getCountryByRegionId(s);if(t.id!==a.id&&a.id!==Vv.NEUTRAL){if((a.id===Vv.PLAYER&&t.diplomacy<25||a.id!==Vv.PLAYER)&&n.findPath(e.id,s,t.id,!0)){var u=30;a.id===Vv.PLAYER&&(u=90/n.AI_getDifficultyMultiplier()),n.calendarService.getAbsoluteDay()-n.getRegion(s).lastAttack>=u&&(a.id===Vv.PLAYER&&t.diplomacy<-25&&n.protection<=0?r.includes(s)||r.push(s):o.includes(s)||o.push(s))}}else if(i&&a.id===Vv.NEUTRAL&&n.getRegion(s).army.hasAny()&&t.diplomacy<25&&n.findPath(e.id,s,t.id,!0)){n.calendarService.getAbsoluteDay()-n.getRegion(s).lastAttack>=30&&(r.includes(s)||r.push(s))}})}),this.shuffleArray(r.length>0?r:o)}},{key:"findNeighbouringColonizableRegions",value:function(e,t){var i=this,n=[];return t.regions.forEach(function(r){r.neighbours.filter(function(e){return e>=0}).forEach(function(r){i.getCountryByRegionId(r).id===Vv.NEUTRAL&&!i.getRegion(r).army.hasAny()&&i.canColonize(r)&&i.findPath(e.id,r,t.id,!0)&&(n.includes(r)||n.push(r))})}),this.shuffleArray(n)}},{key:"shuffleArray",value:function(e){var t,i,n;for(n=e.length-1;n>0;n--)t=Math.floor(Math.random()*(n+1)),i=e[n],e[n]=e[t],e[t]=i;return e}},{key:"getMapDisplayOption",value:function(){return this.mapDisplayOption}},{key:"setMapDisplayOption",value:function(e){this.mapDisplayOption=e}},{key:"DEV_calculateTotalLand",value:function(){var e=0,t=0,i=0;this.regions.forEach(function(n){8!==n.id&&9!==n.id&&10!==n.id&&11!==n.id&&12!==n.id&&(e+=n.land,t+=n.forest,i+=n.mountains)}),this.logService.success("Land report<br>Land: "+e+"<br>Forest: "+t+"<br>Mountains: "+i+"<br><br>Total: "+(e+t+i))}},{key:"AI_prepareArmy",value:function(e){var t=new AC([]);return e.units.forEach(function(i){i.troop!==Bv.MILITIA&&i.troop!==Bv.GUARD_TOWER&&(t.addTroop(i.troop,i.size),e.removeTroop(i.troop,i.size))}),e.removeEmptyUnits(),t}},{key:"initPlayerKingdomName",value:function(){this.kongregateService.isAvailable()&&!this.kongregateService.isGuest()&&(this.getPlayerCountry().name=this.kongregateService.getUsername()+"'s nation")}},{key:"setSelectedSeaEvent",value:function(e){this.selectedSeaEvent=e,this.selectedRegion=null,this.selectedCountry=null,this.selectedMission=null}},{key:"getSelectedSeaEvent",value:function(){return this.selectedSeaEvent}},{key:"getRandomPointInCircle",value:function(e,t){if(t<10)return e;var i=(t-10)*Math.sqrt(Math.random()),n=Math.random()*Math.PI*2;return{x:i*Math.cos(n)+e.x,y:i*Math.sin(n)+e.y}}},{key:"getShowHarbours",value:function(){return this.showHarbours}},{key:"setShowHarbours",value:function(e){this.showHarbours=e}},{key:"calculatePointsDistance",value:function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"getSeaAreas",value:function(){return this.seaAreas}},{key:"getSeaArea",value:function(e){return this.seaAreas.find(function(t){return t.id===e})}},{key:"spawnSeaEvents",value:function(){var e=this,t=this.seaAreas.filter(function(e){return-1!==e.id});Object.keys(jv).slice(Object.keys(jv).length/2).map(function(e){return jv[e]}).forEach(function(i){var n=pm.getSeaEvent(i),r=0;e.getSeaAreas().forEach(function(e){e.events.length>0&&e.events[0].type===i&&(r+=1)});var o=t.filter(function(e){return e.r>n.FOR_RADIUS&&0===e.events.length});if(o.length>0){var s=!1;if((r<n.NUMBER_MIN||r<n.NUMBER_MAX&&sp.chance(n.SPAWN_CHANCE-r*n.SPAWN_DECREASE))&&(s=!0),s){var a=o[sp.randomBetween(0,o.length-1)];0===a.events.length&&a.events.push(new C_(a.id,e.idService.getNextId(),i,e.getRandomPointInCircle(a.center,a.r),sp.randomBetween(n.POWER_MIN,n.POWER_MAX),sp.randomBetween(n.TIME_MIN,n.TIME_MAX),null))}}})}},{key:"ROYAL_spawnPositiveSeaEvents",value:function(){for(var e=this,t=this.seaAreas.filter(function(e){return-1!==e.id&&0===e.events.length}),i=[],n=0;n<4;n++)i.push(sp.randomArrayElement([jv.TREASURE,jv.FISH,jv.SHARK,jv.CARTOGRAPHY]));i.forEach(function(i){var n=pm.getSeaEvent(i);e.getSeaAreas().forEach(function(e){e.events.length>0&&e.events[0].type===i&&1});var r=t.filter(function(e){return e.r>n.FOR_RADIUS&&0===e.events.length});if(r.length>0){var o=r[sp.randomBetween(0,r.length-1)];0===o.events.length&&o.events.push(new C_(o.id,e.idService.getNextId(),i,e.getRandomPointInCircle(o.center,o.r),sp.randomBetween(n.POWER_MIN,n.POWER_MAX),sp.randomBetween(n.TIME_MIN,n.TIME_MAX),null)),e.logService.success("New sea event: "+Qv.prepareSeaEventName(i))}})}},{key:"getDiscoveredLand",value:function(){return this.discoveredLand}},{key:"increaseDiscoveredLand",value:function(e){this.discoveredLand+=e}},{key:"getDiscoveredForest",value:function(){return this.discoveredForest}},{key:"increaseDiscoveredForest",value:function(e){this.discoveredForest+=e}},{key:"getDiscoveredMountains",value:function(){return this.discoveredMountains}},{key:"increaseDiscoveredMountains",value:function(e){this.discoveredMountains+=e}},{key:"getTotalDiscovered",value:function(){return this.discoveredLand+this.discoveredForest+this.discoveredMountains}},{key:"setPlayerColour",value:function(e){this.getPlayerCountry().colour=e}},{key:"isProtected",value:function(){return this.protection>0}},{key:"addProtection",value:function(e){this.protection+=e}},{key:"getProtection",value:function(){return this.protection}},{key:"hasPiratesBase",value:function(){return this.getSeaAreas().find(function(e){return e.events.length>0&&e.events[0].type===jv.PIRATES_BASE})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(wR),An(KC),An(kC),An(Cm),An(Im),An(Jv),An(H_),An(Om),An(Tm),An(wm),An(ME))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),B_=["svg"];function W_(e,t){if(1&e){var i=qs();zs(0,"img",41),$s("click",function(){return Kt(i),ta(2).changeName()}),Ys()}}function V_(e,t){1&e&&js(0,"span")}function z_(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta(2);ho(1),fa(" standing: ",i.getSelectedCountry().getDiplomacy()," (",i.getSelectedCountry().diplomacy,")\n")}}function Y_(e,t){if(1&e){var i=qs();zs(0,"span"),zs(1,"input",42),$s("change",function(){Kt(i);var e=ta(2);return e.setDefaultOrigin(e.getSelectedRegion().id)}),Ys(),zs(2,"label",43),ha(3,"use as default origin"),Ys(),Ys()}if(2&e){var n=ta(2);ho(1),Ws("checked",n.getDefaultOrigin()===n.getSelectedRegion().id)}}function j_(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",39),js(2,"app-icon",44),ha(3),Ys(),zs(4,"div",39),js(5,"app-icon",44),ha(6),Ys(),zs(7,"div",39),js(8,"app-icon",44),ha(9),Ys(),Ys()),2&e){var i=ta(2);ho(2),Ws("name","wealth")("path","world"),ho(1),ga(" ",i.getSelectedRegion().wealth," "),ho(2),Ws("name","economy")("path","world"),ho(1),ga(" ",i.getSelectedRegion().economy," "),ho(2),Ws("name","defense")("path","world"),ho(1),ga(" ",i.getSelectedRegion().defense," ")}}function K_(e,t){1&e&&(zs(0,"span"),ha(1,"yes"),Ys())}function Q_(e,t){1&e&&(zs(0,"span"),ha(1,"no"),Ys())}function q_(e,t){1&e&&(zs(0,"span"),ha(1,"yes"),Ys())}function X_(e,t){1&e&&(zs(0,"span"),ha(1,"no"),Ys())}function Z_(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",39),js(2,"app-icon",44),Gs(3,K_,2,0,"span",3),Gs(4,Q_,2,0,"span",3),Ys(),zs(5,"div",39),js(6,"app-icon",44),Gs(7,q_,2,0,"span",3),Gs(8,X_,2,0,"span",3),Ys(),zs(9,"div",39),js(10,"app-icon",44),ha(11),Ys(),Ys()),2&e){var i=ta(2);ho(2),Ws("name","roads")("path","world"),ho(1),Ws("ngIf",i.getSelectedRegion().roads),ho(1),Ws("ngIf",!i.getSelectedRegion().roads),ho(2),Ws("name","watchtower")("path","world"),ho(1),Ws("ngIf",i.getSelectedRegion().watchtower),ho(1),Ws("ngIf",!i.getSelectedRegion().watchtower),ho(2),Ws("name","guard_tower")("path","world"),ho(1),ga(" ",i.getGuardTowersCount()," ")}}function $_(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",39),js(2,"app-icon",44),ha(3),Ys(),Ys()),2&e){var i=ta(2);ho(2),Ws("name","defense")("path","world"),ho(1),ga(" ",i.getSelectedRegion().defense," ")}}function J_(e,t){1&e&&(zs(0,"span"),ha(1,"yes"),Ys())}function ew(e,t){1&e&&(zs(0,"span"),ha(1,"no"),Ys())}function tw(e,t){1&e&&(zs(0,"span"),ha(1,"yes"),Ys())}function iw(e,t){1&e&&(zs(0,"span"),ha(1,"no"),Ys())}function nw(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",39),js(2,"app-icon",44),Gs(3,J_,2,0,"span",3),Gs(4,ew,2,0,"span",3),Ys(),zs(5,"div",39),js(6,"app-icon",44),Gs(7,tw,2,0,"span",3),Gs(8,iw,2,0,"span",3),Ys(),zs(9,"div",39),js(10,"app-icon",44),ha(11),Ys(),Ys()),2&e){var i=ta(2);ho(2),Ws("name","roads")("path","world"),ho(1),Ws("ngIf",i.getSelectedRegion().roads),ho(1),Ws("ngIf",!i.getSelectedRegion().roads),ho(2),Ws("name","watchtower")("path","world"),ho(1),Ws("ngIf",i.getSelectedRegion().watchtower),ho(1),Ws("ngIf",!i.getSelectedRegion().watchtower),ho(2),Ws("name","guard_tower")("path","world"),ho(1),ga(" ",i.getGuardTowersCount()," ")}}function rw(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",39),js(2,"app-icon",44),ha(3),Ys(),Ys()),2&e){var i=ta(2);ho(2),Ws("name","spy")("path","army/mission"),ho(1),ga(" ",i.getSelectedRegion().spy," ")}}function ow(e,t){1&e&&(zs(0,"div"),zs(1,"div",39),js(2,"app-icon",44),ha(3," ? "),Ys(),zs(4,"div",39),js(5,"app-icon",44),ha(6," ? "),Ys(),zs(7,"div",39),js(8,"app-icon",44),ha(9," ? "),Ys(),Ys()),2&e&&(ho(2),Ws("name","wealth")("path","world"),ho(3),Ws("name","economy")("path","world"),ho(3),Ws("name","defense")("path","world"))}function sw(e,t){1&e&&(zs(0,"div"),zs(1,"div",39),js(2,"app-icon",44),ha(3," ? "),Ys(),zs(4,"div",39),js(5,"app-icon",44),ha(6," ? "),Ys(),zs(7,"div",39),js(8,"app-icon",44),ha(9," ? "),Ys(),Ys()),2&e&&(ho(2),Ws("name","roads")("path","world"),ho(3),Ws("name","watchtower")("path","world"),ho(3),Ws("name","guard_tower")("path","world"))}function aw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),fa("",n.getTroopName(i.troop)," : ",i.size,"")}}function uw(e,t){if(1&e&&(zs(0,"div"),Gs(1,aw,2,2,"div",32),Ys()),2&e){var i=ta(2);ho(1),Ws("ngForOf",i.getFirstFourUnits(i.getSelectedRegion().army.units))}}function cw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),fa("",n.getTroopName(i.troop)," : ",i.size,"")}}function lw(e,t){if(1&e&&(zs(0,"div"),Gs(1,cw,2,2,"div",32),Ys()),2&e){var i=ta(2);ho(1),Ws("ngForOf",i.getSecondFourUnits(i.getSelectedRegion().army.units))}}function hw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),fa("",n.getTroopName(i.troop)," : ",i.size,"")}}function dw(e,t){if(1&e&&(zs(0,"div"),Gs(1,hw,2,2,"div",32),Ys()),2&e){var i=ta(2);ho(1),Ws("ngForOf",i.getSelectedRegion().navy.units)}}function gw(e,t){1&e&&(zs(0,"div"),zs(1,"div"),ha(2," troops: ? "),Ys(),Ys())}function fw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).colonize()}),ha(1,"Colonize "),js(2,"img",48),Ys()}}function vw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).move()}),ha(1,"Move army "),js(2,"img",49),Ys()}}function pw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).seaMove()}),ha(1,"Sea move "),js(2,"img",50),Ys()}}function mw(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",45),Gs(2,fw,3,0,"button",46),Gs(3,vw,3,0,"button",46),Gs(4,pw,3,0,"button",46),Ys(),Ys()),2&e){var i=ta(4);ho(2),Ws("ngIf",i.canColonize()&&i.hasPath(0,i.getSelectedRegion().id)),ho(1),Ws("ngIf",i.getSelectedRegion().army.hasAny()),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.getSelectedRegion().navy.hasAny()&&i.hasSeaPath(i.getDefaultOrigin(),i.getSelectedRegion().id))}}function Sw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).plunder()}),ha(1," Plunder "),js(2,"img",51),Ys()}}function Ew(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).conquer()}),ha(1," Conquer "),js(2,"img",52),Ys()}}function yw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).spy()}),ha(1,"Spy "),js(2,"img",53),Ys()}}function Rw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).seaPlunder()}),ha(1,"Sea plunder "),js(2,"img",54),Ys()}}function Ow(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(5).seaConquer()}),ha(1,"Sea conquer "),js(2,"img",55),Ys()}}function Tw(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",45),Gs(2,Sw,3,0,"button",46),Gs(3,Ew,3,0,"button",46),Gs(4,yw,3,0,"button",46),Gs(5,Rw,3,0,"button",46),Gs(6,Ow,3,0,"button",46),Ys(),Ys()),2&e){var i=ta(4);ho(2),Ws("ngIf",i.hasPath(i.getDefaultOrigin(),i.getSelectedRegion().id)),ho(1),Ws("ngIf",i.hasPath(i.getDefaultOrigin(),i.getSelectedRegion().id)),ho(1),Ws("ngIf",0===i.getSelectedRegion().spy&&i.hasPath(i.getDefaultOrigin(),i.getSelectedRegion().id,i.countries.SPECIAL,!0)),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.hasSeaPath(0,i.getSelectedRegion().id)),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.hasSeaPath(0,i.getSelectedRegion().id))}}function Iw(e,t){if(1&e&&(zs(0,"div"),Gs(1,mw,5,3,"div",3),Gs(2,Tw,7,5,"div",3),Ys()),2&e){var i=ta(3);ho(1),Ws("ngIf",i.getSelectedCountry().id===i.countries.NEUTRAL),ho(1),Ws("ngIf",i.getSelectedCountry().id!==i.countries.NEUTRAL)}}function bw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(4).move()}),ha(1,"Move army "),js(2,"img",49),Ys()}}function Cw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(4).build()}),ha(1,"Build "),js(2,"img",56),Ys()}}function Aw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(4).seaMove()}),ha(1,"Sea move "),js(2,"img",50),Ys()}}function kw(e,t){if(1&e){var i=qs();zs(0,"button",47),$s("click",function(){return Kt(i),ta(4).expedition()}),ha(1,"Send expedition"),js(2,"img",57),Ys()}}function Nw(e,t){if(1&e&&(zs(0,"div"),zs(1,"div",45),Gs(2,bw,3,0,"button",46),Gs(3,Cw,3,0,"button",46),Gs(4,Aw,3,0,"button",46),Gs(5,kw,3,0,"button",46),Ys(),Ys()),2&e){var i=ta(3);ho(2),Ws("ngIf",i.getSelectedRegion().army.hasAny()),ho(1),Ws("ngIf",0!==i.getSelectedRegion().id),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.getSelectedRegion().navy.hasAny()&&i.hasSeaPath(i.getDefaultOrigin(),i.getSelectedRegion().id)),ho(1),Ws("ngIf",0===i.getSelectedRegion().id&&i.hasMap())}}function _w(e,t){if(1&e&&(zs(0,"div"),Gs(1,Iw,3,2,"div",3),Gs(2,Nw,6,4,"div",3),Ys()),2&e){var i=ta(2);ho(1),Ws("ngIf",i.getSelectedCountry().id!==i.countries.PLAYER),ho(1),Ws("ngIf",i.getSelectedCountry().id===i.countries.PLAYER)}}function ww(e,t){if(1&e&&(zs(0,"div"),ha(1," Kingdom: "),zs(2,"span",34),ha(3),Ys(),Gs(4,W_,1,0,"img",35),Gs(5,V_,1,0,"span",3),js(6,"br"),Gs(7,z_,2,2,"span",3),Gs(8,Y_,4,1,"span",3),js(9,"hr"),zs(10,"div",36),zs(11,"div",37),yi(),zs(12,"svg",38),js(13,"path"),Ys(),Ys(),Vt.lFrame.currentNamespace=null,zs(14,"div"),zs(15,"div",39),js(16,"app-icon",40),ha(17),Ys(),zs(18,"div",39),js(19,"app-icon",40),ha(20),Ys(),zs(21,"div",39),js(22,"app-icon",40),ha(23),Ys(),Ys(),Gs(24,j_,10,9,"div",3),Gs(25,Z_,12,11,"div",3),Gs(26,$_,4,3,"div",3),Gs(27,nw,12,11,"div",3),Gs(28,rw,4,3,"div",3),Gs(29,ow,10,6,"div",3),Gs(30,sw,10,6,"div",3),Gs(31,uw,2,1,"div",3),Gs(32,lw,2,1,"div",3),Gs(33,dw,2,1,"div",3),Gs(34,gw,3,0,"div",3),Ys(),Gs(35,_w,3,2,"div",3),Ys()),2&e){var i=ta();ho(3),da(i.getSelectedCountry().name),ho(1),Ws("ngIf",i.getSelectedCountry().id===i.countries.PLAYER),ho(1),Ws("ngIf",i.isDev()),ho(2),Ws("ngIf",i.getSelectedCountry().id!==i.countries.PLAYER&&i.getSelectedCountry().id!==i.countries.NEUTRAL),ho(1),Ws("ngIf",i.getSelectedCountry().id===i.countries.PLAYER||i.getSelectedCountry().id===i.countries.NEUTRAL),ho(4),Us("height","72px")("width","72px")("viewBox",i.prepareViewbox(i.getSelectedRegion().center)),ho(1),Us("fill",i.getSelectedCountry().colour)("d",i.getSelectedRegion().path)("stroke","black")("stroke-width","2"),ho(3),Ws("name","land"),ho(1),ga(" ",i.getSelectedRegion().land,""),ho(2),Ws("name","forest"),ho(1),ga(" ",i.getSelectedRegion().forest,""),ho(2),Ws("name","mountains"),ho(1),ga(" ",i.getSelectedRegion().mountains,""),ho(1),Ws("ngIf",i.getSelectedRegion().spy>0&&i.getSelectedCountry().id!==i.countries.PLAYER),ho(1),Ws("ngIf",i.getSelectedRegion().spy>0&&i.getSelectedCountry().id!==i.countries.PLAYER),ho(1),Ws("ngIf",i.getSelectedCountry().id===i.countries.PLAYER),ho(1),Ws("ngIf",i.getSelectedCountry().id===i.countries.PLAYER),ho(1),Ws("ngIf",i.getSelectedRegion().spy>0&&i.getSelectedCountry().id!==i.countries.PLAYER),ho(1),Ws("ngIf",0===i.getSelectedRegion().spy&&i.getSelectedCountry().id!==i.countries.PLAYER&&i.getSelectedCountry().id!==i.countries.NEUTRAL),ho(1),Ws("ngIf",0===i.getSelectedRegion().spy&&i.getSelectedCountry().id!==i.countries.PLAYER&&i.getSelectedCountry().id!==i.countries.NEUTRAL),ho(1),Ws("ngIf",i.getSelectedRegion().spy>0||i.getSelectedRegion().watched||i.getSelectedCountry().id===i.countries.PLAYER||i.getSelectedCountry().id===i.countries.NEUTRAL),ho(1),Ws("ngIf",i.getSelectedRegion().spy>0||i.getSelectedRegion().watched||i.getSelectedCountry().id===i.countries.PLAYER||i.getSelectedCountry().id===i.countries.NEUTRAL),ho(1),Ws("ngIf",i.getSelectedRegion().spy>0||i.getSelectedRegion().watched||i.getSelectedCountry().id===i.countries.PLAYER||i.getSelectedCountry().id===i.countries.NEUTRAL),ho(1),Ws("ngIf",0===i.getSelectedRegion().spy&&!i.getSelectedRegion().watched&&i.getSelectedCountry().id!==i.countries.PLAYER&&i.getSelectedCountry().id!==i.countries.NEUTRAL),ho(1),Ws("ngIf",!i.selecting)}}function Pw(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta(3);ho(1),ga("(",i.roundEffectiveSpeed(),")")}}function Mw(e,t){if(1&e&&(zs(0,"div"),js(1,"app-icon",44),ha(2),Gs(3,Pw,2,1,"span",3),Ys()),2&e){var i=ta(2);ho(1),Ws("name","speed")("path","army"),ho(1),ga(" ",i.getSelectedMission().getArmySpeed()," "),ho(1),Ws("ngIf",i.getSelectedMission().getArmySpeed()!==i.getSelectedMission().getArmyEffectiveSpeed())}}function Dw(e,t){if(1&e&&(zs(0,"div"),js(1,"app-icon",40),ha(2),Ys()),2&e){var i=ta(2);ho(1),Ws("name","cargo"),ho(1),ga(" ",i.getMissionCargo(),"")}}function Lw(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"button",65),$s("click",function(){return Kt(i),ta(2).cancel()}),ha(2,"cancel mission"),Ys(),Ys()}}function xw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),fa("",n.getTroopName(i.troop),": ",i.size,"")}}function Fw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(3);ho(1),ga("",i.getSelectedMission().data," fish")}}function Uw(e,t){if(1&e&&(zs(0,"div"),zs(1,"div"),ha(2),Ys(),zs(3,"div"),ha(4),Ys(),Ys()),2&e){var i=ta(3);ho(2),ga("",i.getSelectedMission().data.meat," meat"),ho(2),ga("",i.getSelectedMission().data.fur," fur")}}function Hw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(3);ho(1),ga("",i.getSelectedMission().data," coins")}}function Gw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(3);ho(1),ga("",i.getSelectedMission().data," coins")}}function Bw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(3);ho(1),ga("",i.getSelectedMission().data," cartography data ")}}function Ww(e,t){if(1&e&&(zs(0,"div"),Gs(1,Fw,2,1,"div",3),Gs(2,Uw,5,2,"div",3),Gs(3,Hw,2,1,"div",3),Gs(4,Gw,2,1,"div",3),Gs(5,Bw,2,1,"div",3),Ys()),2&e){var i=ta(2);ho(1),Ws("ngIf",i.getSelectedMission().mission===i.missions.FISHING),ho(1),Ws("ngIf",i.getSelectedMission().mission===i.missions.HUNTING),ho(1),Ws("ngIf",i.getSelectedMission().mission===i.missions.TREASURE),ho(1),Ws("ngIf",i.getSelectedMission().mission===i.missions.SEA_BATTLE),ho(1),Ws("ngIf",i.getSelectedMission().mission===i.missions.CARTOGRAPHY)}}function Vw(e,t){if(1&e&&(zs(0,"div",58),zs(1,"div",59),ha(2),Ys(),zs(3,"div",60),zs(4,"div"),js(5,"img",61),Ys(),zs(6,"div",62),zs(7,"div",63),ha(8),js(9,"app-progress-bar",64),Ys(),Gs(10,Mw,4,4,"div",3),Gs(11,Dw,3,2,"div",3),Gs(12,Lw,3,0,"div",3),Ys(),zs(13,"div"),Gs(14,xw,2,2,"div",32),Ys(),Gs(15,Ww,6,5,"div",3),Ys(),Ys()),2&e){var i=ta();ho(2),da(i.getMissionName()),ho(3),ia("src",i.getSelectedMission().getIconPath(),gr),ho(3),ga(" ",i.getSelectedMission().getStatus(),": "),ho(1),Ws("progress",i.getSelectedMission().getDisplayProgress()),ho(1),Ws("ngIf",i.getSelectedMission().mission!==i.missions.BUILD),ho(1),Ws("ngIf",i.getSelectedMission().getMissionType()===i.missionType.SEA),ho(1),Ws("ngIf",i.canCancel()),ho(2),Ws("ngForOf",i.getSelectedMission().army.units),ho(1),Ws("ngIf",null!==i.getSelectedMission().data)}}function zw(e,t){if(1&e){var i=qs();zs(0,"button",65),$s("click",function(){return Kt(i),ta(2).fishing()}),ha(1,"Start fishing "),Ys()}}function Yw(e,t){if(1&e){var i=qs();zs(0,"button",65),$s("click",function(){return Kt(i),ta(2).hunting()}),ha(1,"Start hunting "),Ys()}}function jw(e,t){if(1&e){var i=qs();zs(0,"button",65),$s("click",function(){return Kt(i),ta(2).treasure()}),ha(1,"Look for treasure "),Ys()}}function Kw(e,t){if(1&e){var i=qs();zs(0,"button",65),$s("click",function(){return Kt(i),ta(2).cartography()}),ha(1,"Gather cartography data "),Ys()}}function Qw(e,t){if(1&e){var i=qs();zs(0,"button",65),$s("click",function(){return Kt(i),ta(2).seaBattle()}),ha(1,"Attack pirates "),Ys()}}function qw(e,t){if(1&e){var i=qs();zs(0,"button",65),$s("click",function(){return Kt(i),ta(2).seaBattle()}),ha(1,"Attack pirates base "),Ys()}}function Xw(e,t){if(1&e&&(zs(0,"div",73),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga(" size: ",i.getSelectedSeaEvent().amount," ")}}function Zw(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),fa("",n.getTroopName(i.troop)," : ",i.size,"")}}function $w(e,t){if(1&e&&(zs(0,"div",74),Gs(1,Zw,2,2,"div",32),Ys()),2&e){var i=ta(2);ho(1),Ws("ngForOf",i.getSelectedSeaEvent().data.units)}}function Jw(e,t){if(1&e&&(zs(0,"div",66),zs(1,"div",67),ha(2),Ys(),zs(3,"div",68),zs(4,"div",69),zs(5,"div"),js(6,"img",61),Ys(),Gs(7,zw,2,0,"button",70),Gs(8,Yw,2,0,"button",70),Gs(9,jw,2,0,"button",70),Gs(10,Kw,2,0,"button",70),Gs(11,Qw,2,0,"button",70),Gs(12,qw,2,0,"button",70),Ys(),Gs(13,Xw,2,1,"div",71),Gs(14,$w,2,1,"div",72),Ys(),Ys()),2&e){var i=ta();ho(2),da(i.getSeaEventName()),ho(4),ia("src",i.getSeaEventIconPath(i.getSelectedSeaEvent().type),gr),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.hasSeaPath(0,i.getSelectedSeaEvent().parentId)&&i.getSelectedSeaEvent().type===i.seaEvents.FISH),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.hasSeaPath(0,i.getSelectedSeaEvent().parentId)&&i.getSelectedSeaEvent().type===i.seaEvents.SHARK),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.hasSeaPath(0,i.getSelectedSeaEvent().parentId)&&i.getSelectedSeaEvent().type===i.seaEvents.TREASURE),ho(1),Ws("ngIf",i.isSeaCartographyEnabled()&&i.hasSeaPath(0,i.getSelectedSeaEvent().parentId)&&i.getSelectedSeaEvent().type===i.seaEvents.CARTOGRAPHY),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.hasSeaPath(0,i.getSelectedSeaEvent().parentId)&&i.getSelectedSeaEvent().type===i.seaEvents.PIRATES),ho(1),Ws("ngIf",i.isSeaEnabled()&&i.hasSeaPath(0,i.getSelectedSeaEvent().parentId)&&i.getSelectedSeaEvent().type===i.seaEvents.PIRATES_BASE),ho(1),Ws("ngIf",i.getSelectedSeaEvent().type!==i.seaEvents.WHIRLPOOL),ho(1),Ws("ngIf",i.getSelectedSeaEvent().data)}}function eP(e,t){if(1&e){var i=qs();yi(),zs(0,"path",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys()}if(2&e){var n=ta().$implicit;Us("fill",ta().$implicit.colour)("d",n.path)("stroke","black")("stroke-width","2")}}function tP(e,t){if(1&e){var i=qs();yi(),zs(0,"g",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),js(1,"path"),js(2,"path"),Ys()}if(2&e){var n=ta().$implicit,r=ta().$implicit;ho(1),Us("fill",r.colour)("d",n.path)("stroke","black")("stroke-width","2"),ho(1),Us("fill","url(#diagonalHatch)")("d",n.path)}}function iP(e,t){if(1&e){var i=qs();yi(),zs(0,"g"),zs(1,"circle",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),zs(2,"image",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta(2);ho(1),Us("r",12)("cx",n.center.x)("cy",n.center.y+1)("fill",r.worldService.getCountry(n.capital).colour),ho(1),Us("height",20)("width",20)("x",n.center.x-10)("y",n.center.y-10)("href","assets/world/capital.svg",null,"xlink")}}function nP(e,t){if(1&e){var i=qs();yi(),zs(0,"g"),zs(1,"circle",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),zs(2,"image",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta().$implicit;ho(1),Us("r",6)("cx",n.center.x)("cy",n.center.y)("fill",r.colour),ho(1),Us("height",10)("width",10)("x",n.center.x-5)("y",n.center.y-5)("href","assets/army/recruit.svg",null,"xlink")}}function rP(e,t){if(1&e){var i=qs();yi(),zs(0,"g"),zs(1,"circle",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),zs(2,"image",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta().$implicit;ho(1),Us("r",6)("cx",n.center.x)("cy",n.center.y)("fill",r.colour),ho(1),Us("height",10)("width",10)("x",n.center.x-5)("y",n.center.y-5)("href","assets/army/mission/spy.svg",null,"xlink")}}function oP(e,t){if(1&e){var i=qs();yi(),zs(0,"g"),zs(1,"circle",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),zs(2,"image",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta().$implicit;ho(1),Us("r",6)("cx",n.center.x)("cy",n.center.y)("fill",r.colour),ho(1),Us("height",10)("width",10)("x",n.center.x-5)("y",n.center.y-5)("href","assets/world/roads.svg",null,"xlink")}}function sP(e,t){if(1&e){var i=qs();yi(),zs(0,"g"),zs(1,"circle",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),zs(2,"image",65),$s("click",function(e){Kt(i);var t=ta().$implicit,n=ta().$implicit;return ta().select(e,n,t)}),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta().$implicit;ho(1),Us("r",6)("cx",n.center.x)("cy",n.center.y)("fill",r.colour),ho(1),Us("height",10)("width",10)("x",n.center.x-5)("y",n.center.y-5)("href","assets/world/watchtower.svg",null,"xlink")}}function aP(e,t){if(1&e&&(yi(),js(0,"image",78)),2&e){var i=ta().$implicit,n=ta(2);Us("height",20)("width",20)("x",n.getHarbour(i.id).CENTER.x-10)("y",n.getHarbour(i.id).CENTER.y-10)("href","assets/sea/port.svg",null,"xlink")}}function uP(e,t){if(1&e&&(yi(),zs(0,"g",76),Gs(1,eP,1,4,"path",70),Gs(2,tP,3,6,"g",70),Gs(3,iP,3,9,"g",3),Gs(4,nP,3,9,"g",3),Gs(5,rP,3,9,"g",3),Gs(6,oP,3,9,"g",3),Gs(7,sP,3,9,"g",3),Gs(8,aP,1,5,"image",77),Ys()),2&e){var i=t.$implicit,n=ta().$implicit,r=ta();ho(1),Ws("ngIf",!r.getSelectedRegion()||i.id!==r.getSelectedRegion().id),ho(1),Ws("ngIf",r.getSelectedRegion()&&i.id===r.getSelectedRegion().id),ho(1),Ws("ngIf",0===r.radio&&void 0!==i.capital),ho(1),Ws("ngIf",1===r.radio&&i.army.hasAny()&&(n.id===r.countries.PLAYER||n.id===r.countries.NEUTRAL||i.spy>0)),ho(1),Ws("ngIf",2===r.radio&&i.spy>0),ho(1),Ws("ngIf",3===r.radio&&i.roads&&(n.id===r.countries.PLAYER||n.id===r.countries.NEUTRAL||i.spy>0)),ho(1),Ws("ngIf",4===r.radio&&i.watchtower&&(n.id===r.countries.PLAYER||n.id===r.countries.NEUTRAL||i.spy>0)),ho(1),Ws("ngIf",r.showHarbours&&i.harbour)}}function cP(e,t){if(1&e&&(yi(),zs(0,"g"),Gs(1,uP,9,8,"g",75),Ys()),2&e){var i=t.$implicit;ho(1),Ws("ngForOf",i.regions)}}function lP(e,t){if(1&e){var i=qs();yi(),zs(0,"circle",65),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().selectArea(e.id)}),Ys()}if(2&e){var n=ta().$implicit;Us("cx",n.center.x)("cy",n.center.y)("r",n.r)("fill","red")("opacity",.1)("stroke-width","1")}}function hP(e,t){if(1&e){var i=qs();yi(),zs(0,"g",80),$s("click",function(){var e=Kt(i).$implicit;return ta(2).selectSeaEvent(e)}),js(1,"image",78),Ys()}if(2&e){var n=t.$implicit,r=ta(2);ho(1),Us("height",20)("width",20)("x",n.center.x-10)("y",n.center.y-10)("href",r.getSeaEventIconPath(n.type),null,"xlink")}}function dP(e,t){if(1&e&&(yi(),zs(0,"g"),Gs(1,lP,1,6,"circle",70),Gs(2,hP,2,5,"g",79),Ys()),2&e){var i=t.$implicit,n=ta();ho(1),Ws("ngIf",i.events.length>0&&(i.events[0].type===n.seaEvents.PIRATES||i.events[0].type===n.seaEvents.PIRATES_BASE)),ho(1),Ws("ngForOf",i.events)}}function gP(e,t){if(1&e&&(yi(),zs(0,"g"),js(1,"line"),Ys()),2&e){var i=t.$implicit;ho(1),Us("x1",i.origin.x)("y1",i.origin.y)("x2",i.target.x)("y2",i.target.y)("stroke","black")("stroke-dasharray","5,5")("stroke-width","1")}}function fP(e,t){if(1&e&&(yi(),zs(0,"g"),Gs(1,gP,2,7,"g",32),Ys()),2&e){var i=ta().$implicit;ho(1),Ws("ngForOf",i.routePaths)}}function vP(e,t){if(1&e&&(yi(),zs(0,"g",81),Gs(1,fP,2,1,"g",3),Ys()),2&e){var i=t.$implicit,n=ta();ho(1),Ws("ngIf",n.getSelectedMission()&&n.getSelectedMission()===i&&n.getSelectedMission().ownerCountry.id===n.countries.PLAYER)}}function pP(e,t){if(1&e){var i=qs();yi(),zs(0,"g",81),zs(1,"circle",65),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().selectMission(e)}),Ys(),zs(2,"image",84),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().selectMission(e)}),Ys(),Ys()}if(2&e){var n=ta().$implicit;ho(1),Us("r",8)("cx",n.getOrigin().x+(n.getTarget().x-n.getOrigin().x)*n.getProgressPercentage())("cy",n.getOrigin().y+(n.getTarget().y-n.getOrigin().y)*n.getProgressPercentage())("fill","lightgrey")("stroke","black")("stroke-width","1"),ho(1),Us("height",12)("width",12)("x",n.getOrigin().x+(n.getTarget().x-n.getOrigin().x)*n.getProgressPercentage()-6)("y",n.getOrigin().y+(n.getTarget().y-n.getOrigin().y)*n.getProgressPercentage()-6)("href",n.getIconPath(),null,"xlink")}}function mP(e,t){if(1&e&&(yi(),zs(0,"g",85),js(1,"circle"),js(2,"circle"),js(3,"image",78),Ys()),2&e){var i=ta().$implicit;ho(1),Us("r",8)("cx",i.getOrigin().x+(i.getTarget().x-i.getOrigin().x)*i.getProgressPercentage())("cy",i.getOrigin().y+(i.getTarget().y-i.getOrigin().y)*i.getProgressPercentage())("fill","white")("stroke","black")("stroke-width","1"),ho(1),Us("r",8)("cx",i.getOrigin().x+(i.getTarget().x-i.getOrigin().x)*i.getProgressPercentage())("cy",i.getOrigin().y+(i.getTarget().y-i.getOrigin().y)*i.getProgressPercentage())("fill",i.ownerCountry.colour)("fill-opacity",.8)("stroke","black")("stroke-width","1"),ho(1),Us("height",12)("width",12)("x",i.getOrigin().x+(i.getTarget().x-i.getOrigin().x)*i.getProgressPercentage()-6)("y",i.getOrigin().y+(i.getTarget().y-i.getOrigin().y)*i.getProgressPercentage()-6)("href",i.getIconPath(),null,"xlink")}}function SP(e,t){if(1&e&&(yi(),zs(0,"g"),Gs(1,pP,3,11,"g",82),Gs(2,mP,4,18,"g",83),Ys()),2&e){var i=t.$implicit,n=ta();ho(1),Ws("ngIf",i.ownerCountry.id===n.countries.PLAYER),ho(1),Ws("ngIf",i.ownerCountry.id!==n.countries.PLAYER)}}var EP=function(e){return{selecting:e}},yP=function(){var e=function(){function e(t,i,n,r,o){var s=this;p(this,e),this.servicesService=t,this.worldService=i,this.gameService=n,this.resourcesService=r,this.modalService=o,this.selecting=!1,this.regionSelected=new Yu,this.dragX=-1,this.dragY=-1,this.clickX=-1,this.clickY=-1,this.moved=!1,this.selectedSeaRegion=null,this.radio=0,this.showHarbours=!0,this.pathCache=[],this.countries=Vv,this.seaEvents=jv,this.missions=Fv,this.missionType=d_,this.troops=Bv,this.worldService.registerForCacheInvalidation().subscribe(function(e){s.pathCache=[]}),this.radio=this.worldService.getMapDisplayOption()}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getX",value:function(){return this.worldService.getDisplayX()}},{key:"getY",value:function(){return this.worldService.getDisplayY()}},{key:"getZoom",value:function(){return this.worldService.getDisplayZoom()}},{key:"getCountries",value:function(){return this.worldService.getCountries()}},{key:"getMissions",value:function(){return this.worldService.getMissions()}},{key:"handleKeyDown",value:function(e){"ArrowDown"===e.key&&this.worldService.setDisplayY(this.worldService.getDisplayY()+5)}},{key:"dragStart",value:function(e){this.moved=!1,this.dragX=e.x,this.dragY=e.y,this.clickX=e.x,this.clickY=e.y}},{key:"mousemove",value:function(e){1===e.buttons&&this.dragX>=1&&this.dragY>=1&&(this.moved=!0,this.worldService.setDisplayX(this.worldService.getDisplayX()+e.x-this.dragX),this.worldService.setDisplayY(this.worldService.getDisplayY()+e.y-this.dragY),this.dragX=e.x,this.dragY=e.y)}},{key:"dragEnd",value:function(e){this.moved&&this.dragX>=0&&this.dragY>=0&&(this.worldService.setDisplayX(this.worldService.getDisplayX()+e.x-this.dragX),this.worldService.setDisplayY(this.worldService.getDisplayY()+e.y-this.dragY)),this.dragX=-1,this.dragY=-1}},{key:"onScroll",value:function(e){e.preventDefault(),(e.deltaY>0&&this.getZoom()<2.5||e.deltaY<0&&this.getZoom()>.7)&&this.worldService.setDisplayZoom(this.getZoom()+Math.sign(e.deltaY)/10),this.getZoom()<.7?this.worldService.setDisplayZoom(.7):this.getZoom()>2.5&&this.worldService.setDisplayZoom(2.5)}},{key:"prepareViewbox",value:function(e){return e.x-65+" "+(e.y-65)+" 130 130"}},{key:"resetView",value:function(){this.worldService.setDisplayZoom(1.4),this.worldService.setDisplayX(150),this.worldService.setDisplayY(-220)}},{key:"select",value:function(e,t,i){Math.abs(e.x-this.clickX)<2&&Math.abs(e.y-this.clickY)<2&&(this.clickX=-1,this.clickY=-1,this.worldService.setSelectedRegion(i),this.worldService.setSelectedCountry(t))}},{key:"moveUp",value:function(){this.worldService.setDisplayY(this.getY()-20)}},{key:"moveDown",value:function(){this.worldService.setDisplayY(this.getY()+20)}},{key:"moveRight",value:function(){this.worldService.setDisplayX(this.getX()+20)}},{key:"moveLeft",value:function(){this.worldService.setDisplayX(this.getX()-20)}},{key:"plunder",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Fv.PLUNDER))}},{key:"conquer",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Fv.CONQUER))}},{key:"colonize",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getRegion(0),this.worldService.getPlayerCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Fv.COLONIZE))}},{key:"move",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,null,null,null,null,Fv.MOVE))}},{key:"spy",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Fv.SPY))}},{key:"seaMove",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,null,null,null,null,Fv.SEA_MOVE))}},{key:"seaPlunder",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Fv.SEA_PLUNDER))}},{key:"seaConquer",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,this.worldService.getSelectedRegion(),this.worldService.getSelectedCountry().colour,this.worldService.getSelectedCountry().id,null,Fv.SEA_CONQUER))}},{key:"fishing",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Fv.FISHING))}},{key:"hunting",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Fv.HUNTING))}},{key:"treasure",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Fv.TREASURE))}},{key:"cartography",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Fv.CARTOGRAPHY))}},{key:"seaBattle",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,this.worldService.getSelectedSeaEvent(),Fv.SEA_BATTLE))}},{key:"expedition",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,null,Fv.EXPEDITION))}},{key:"isDev",value:function(){return!Cp.production}},{key:"getNeighbours",value:function(e){var t=[];return this.getCountries().forEach(function(i){i.regions.forEach(function(i){e.neighbours.includes(i.id)&&t.push(i)})}),t}},{key:"selectMission",value:function(e){this.worldService.setSelectedMission(e)}},{key:"findPath",value:function(e,t,i){var n=this.worldService.findPath(e,t,i,!0);return n?n.path.length-1:-1}},{key:"hasPath",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vv.PLAYER,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n)return this.findPath(e,t,i)>=0;var r=this.pathCache.find(function(i){return i[0]===e&&i[1]===t});if(r)return r[2];var o=this.findPath(e,t,i)>=0;return this.pathCache.push([e,t,o]),o}},{key:"getSelectedRegion",value:function(){return this.worldService.getSelectedRegion()}},{key:"getSelectedCountry",value:function(){return this.worldService.getSelectedCountry()}},{key:"getSelectedMission",value:function(){return this.worldService.getSelectedMission()}},{key:"getTroopName",value:function(e){return Qv.prepareTroopName(e)}},{key:"getMissionName",value:function(){return Qv.prepareMissionName(this.getSelectedMission().mission)}},{key:"canColonize",value:function(){return this.worldService.canColonize(this.getSelectedRegion().id)}},{key:"zoomIn",value:function(){this.getZoom()>.7&&(this.worldService.setDisplayZoom(this.getZoom()-.1),this.getZoom()<.7&&this.worldService.setDisplayZoom(.7))}},{key:"zoomOut",value:function(){this.getZoom()<2.5&&(this.worldService.setDisplayZoom(this.getZoom()+.1),this.getZoom()>2.5&&this.worldService.setDisplayZoom(2.5))}},{key:"getDefaultOrigin",value:function(){return this.worldService.getDefaultOrigin()}},{key:"setDefaultOrigin",value:function(e){this.worldService.setDefaultOrigin(e)}},{key:"getTarget",value:function(e){return v_[e]}},{key:"build",value:function(){var e=this;this.worldService.getMissions().find(function(t){return t.mission===Fv.BUILD&&t.getDestinationTargetRegion().id===e.getSelectedRegion().id})?this.modalService.info("Building already in progress"):(this.modalService.open(_v.WORLD_BUILD),this.modalService.setWorldRegion(this.getSelectedRegion()))}},{key:"getFirstFourUnits",value:function(e){return e.length>4?e.filter(function(e){return e.troop===Bv.MILITIA||e.troop===Bv.ARCHER||e.troop===Bv.SPEARMAN||e.troop===Bv.SWORDSMAN}).sort(function(e,t){return e.troop-t.troop}):e.filter(function(e){return e.troop!==Bv.GUARD_TOWER}).sort(function(e,t){return e.troop-t.troop})}},{key:"getSecondFourUnits",value:function(e){if(e.length>4)return e.filter(function(e){return e.troop===Bv.LIGHT_CAVALRY||e.troop===Bv.HORSE_ARCHER}).sort(function(e,t){return e.troop-t.troop})}},{key:"changeName",value:function(){this.worldService.changeName()}},{key:"calculateTotalLand",value:function(){this.worldService.DEV_calculateTotalLand()}},{key:"updateMapDisplayOption",value:function(){this.worldService.setMapDisplayOption(this.radio),this.worldService.setShowHarbours(this.showHarbours)}},{key:"cancel",value:function(){var e=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to cancel this mission?");var t=this.modalService.registerForConfirmation().subscribe(function(i){t.unsubscribe(),i&&e.getSelectedMission().cancel()})}},{key:"canCancel",value:function(){var e=this.getSelectedMission();return e.canCancel()&&"traveling"===e.status}},{key:"getSeaAreas",value:function(){return this.worldService.getSeaAreas()}},{key:"getSeaArea",value:function(e){return this.worldService.getSeaAreas().find(function(t){return t.id===e})}},{key:"selectArea",value:function(e){this.selectedSeaRegion=e}},{key:"getSeaEventIconPath",value:function(e){var t;switch(e){case jv.FISH:t="fish";break;case jv.SHARK:t="shark";break;case jv.TREASURE:t="treasure";break;case jv.PIRATES:t="pirate_flag";break;case jv.PIRATES_BASE:t="pirates_base";break;case jv.WHIRLPOOL:t="whirlpool";break;case jv.CARTOGRAPHY:t="sextant"}return"assets/sea/"+t+".svg"}},{key:"selectSeaEvent",value:function(e){this.worldService.setSelectedSeaEvent(e)}},{key:"getSelectedSeaEvent",value:function(){return this.worldService.getSelectedSeaEvent()}},{key:"getSeaEventName",value:function(){return Qv.prepareSeaEventName(this.getSelectedSeaEvent().type)}},{key:"getShowHarbours",value:function(){return this.worldService.getShowHarbours()}},{key:"getHarbour",value:function(e){return pm.SEA_AREAS.find(function(t){return t.ID===e})}},{key:"hasSeaPath",value:function(e,t){return!!this.worldService.findSeaPath(e,t,!0)}},{key:"DEV_changeToPirate",value:function(){this.getSelectedSeaEvent().type=jv.PIRATES,this.getSelectedSeaEvent().data=new AC([new CC(Bv.BOAT,1)])}},{key:"hasMap",value:function(){return 0===this.resourcesService.hasResource(Mv.MAP,1,"Expedition",!0)}},{key:"isSeaEnabled",value:function(){return this.gameService.isEnabled(wv.NAVY)}},{key:"isSeaCartographyEnabled",value:function(){return this.gameService.isEnabled(wv.CARTOGRAPHER)}},{key:"getMissionCargo",value:function(){return this.getSelectedMission().army.getArmyCargo()}},{key:"roundEffectiveSpeed",value:function(){return Qv.round(this.getSelectedMission().getArmyEffectiveSpeed(),2)}},{key:"DEV_deleteSeaEvent",value:function(e){this.worldService.getSeaArea(e.parentId).events=[]}},{key:"DEV_clearSeaEventData",value:function(){this.getSelectedSeaEvent().data=new AC([])}},{key:"getGuardTowersCount",value:function(){var e=this.getSelectedRegion().army.getUnit(Bv.GUARD_TOWER);return void 0===e?0:e.size}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs($v),Bs(G_),Bs(_m),Bs(DE),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-world"]],viewQuery:function(e,t){var i;(1&e&&rc(B_,5),2&e)&&(nc(i=sc())&&(t.svgRef=i.first))},hostBindings:function(e,t){1&e&&$s("keydown",function(e){return t.handleKeyDown(e)})("mousedown",function(e){return t.dragStart(e)})("mousemove",function(e){return t.mousemove(e)})("mouseup",function(e){return t.dragEnd(e)})("wheel",function(e){return t.onScroll(e)})},inputs:{selecting:"selecting"},outputs:{regionSelected:"regionSelected"},decls:49,vars:24,consts:[["id","wrapper"],["id","title"],["id","details",3,"ngClass"],[4,"ngIf"],["id","missionDetails",4,"ngIf"],["id","seaEventDetails",4,"ngIf"],["id","svg"],["svg",""],["id","target","src","assets/world/target.svg",3,"click"],["id","arrowUp","src","assets/world/arrow_up.svg",3,"click"],["id","arrowDown","src","assets/world/arrow_down.svg",3,"click"],["id","arrowRight","src","assets/world/arrow_right.svg",3,"click"],["id","arrowLeft","src","assets/world/arrow_left.svg",3,"click"],["id","plus","src","assets/world/plus.svg",3,"click"],["id","minus","src","assets/world/minus.svg",3,"click"],["id","options2"],["for","showRoads"],["id","showRoads","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showWatchtowers"],["id","showWatchtowers","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showHarbours"],["id","showHarbours","type","checkbox",3,"checked","ngModel","change","ngModelChange"],["id","options"],["for","showCapitals"],["id","showCapitals","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showArmies"],["id","showArmies","type","radio",3,"value","ngModel","change","ngModelChange"],["for","showSpies"],["id","showSpies","type","radio",3,"value","ngModel","change","ngModelChange"],["xmlns","http://www.w3.org/2000/svg","id","mainMap"],["id","diagonalHatch","patternUnits","userSpaceOnUse","width","4","height","4"],["d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",2,"stroke","black","stroke-width","0.5"],[4,"ngFor","ngForOf"],["class","mission",4,"ngFor","ngForOf"],["id","kingdomName"],["id","changeName","src","assets/gear.svg",3,"click",4,"ngIf"],["id","regionDetails"],["id","svgBox"],["draggable","false","ondragstart","return false;",1,"regionSVG"],[1,"icon"],[3,"name"],["id","changeName","src","assets/gear.svg",3,"click"],["id","defaultOrigin","type","radio",3,"checked","change"],["for","defaultOrigin"],[3,"name","path"],[1,"buttons"],["class","icon",3,"click",4,"ngIf"],[1,"icon",3,"click"],["src","assets/army/mission/colonize.svg",1,"buttonIcon"],["src","assets/army/mission/move.svg",1,"buttonIcon"],["src","assets/army/mission/sea_move.svg",1,"buttonIcon"],["src","assets/army/mission/plunder.svg",1,"buttonIcon"],["src","assets/army/mission/conquer.svg",1,"buttonIcon"],["src","assets/army/mission/spy.svg",1,"buttonIcon"],["src","assets/army/mission/sea_plunder.svg",1,"buttonIcon"],["src","assets/army/mission/sea_conquer.svg",1,"buttonIcon"],["src","assets/army/mission/build.svg",1,"buttonIcon"],["src","assets/resources/map.svg",1,"buttonIcon"],["id","missionDetails"],["id","missionTitle"],["id","missionBody"],[3,"src"],["id","missionStats"],["id","missionStatus"],[3,"progress"],[3,"click"],["id","seaEventDetails"],["id","seaEventTitle"],["id","seaEventBody"],["id","seaEventLeft"],[3,"click",4,"ngIf"],["id","sizeDiv",4,"ngIf"],["id","seaEventRight",4,"ngIf"],["id","sizeDiv"],["id","seaEventRight"],["class","region",4,"ngFor","ngForOf"],[1,"region"],["draggable","false","ondragstart","return false;",4,"ngIf"],["draggable","false","ondragstart","return false;"],["class","seaEvent",3,"click",4,"ngFor","ngForOf"],[1,"seaEvent",3,"click"],[1,"mission"],["class","mission",4,"ngIf"],["class","computerMission",4,"ngIf"],["draggable","false","ondragstart","return false;",3,"click"],[1,"computerMission"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),ha(2,"World Map"),Ys(),zs(3,"div",2),Gs(4,ww,36,30,"div",3),Gs(5,Vw,16,9,"div",4),Gs(6,Jw,15,10,"div",5),Ys(),zs(7,"div",6,7),zs(9,"img",8),$s("click",function(){return t.resetView()}),Ys(),zs(10,"img",9),$s("click",function(){return t.moveDown()}),Ys(),zs(11,"img",10),$s("click",function(){return t.moveUp()}),Ys(),zs(12,"img",11),$s("click",function(){return t.moveLeft()}),Ys(),zs(13,"img",12),$s("click",function(){return t.moveRight()}),Ys(),zs(14,"img",13),$s("click",function(){return t.zoomIn()}),Ys(),zs(15,"img",14),$s("click",function(){return t.zoomOut()}),Ys(),zs(16,"div",15),zs(17,"label",16),ha(18,"show roads"),Ys(),zs(19,"input",17),$s("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),Ys(),js(20,"br"),zs(21,"label",18),ha(22,"show watchtowers"),Ys(),zs(23,"input",19),$s("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),Ys(),js(24,"br"),zs(25,"label",20),ha(26,"show harbours"),Ys(),zs(27,"input",21),$s("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.showHarbours=e}),Ys(),Ys(),zs(28,"div",22),zs(29,"label",23),ha(30,"show capitals"),Ys(),zs(31,"input",24),$s("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),Ys(),js(32,"br"),zs(33,"label",25),ha(34,"show armies"),Ys(),zs(35,"input",26),$s("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),Ys(),js(36,"br"),zs(37,"label",27),ha(38,"show spies"),Ys(),zs(39,"input",28),$s("change",function(){return t.updateMapDisplayOption()})("ngModelChange",function(e){return t.radio=e}),Ys(),Ys(),yi(),zs(40,"svg",29),zs(41,"defs"),zs(42,"pattern",30),js(43,"path",31),Ys(),Ys(),zs(44,"g"),Gs(45,cP,2,1,"g",32),Gs(46,dP,3,2,"g",32),Gs(47,vP,2,1,"g",33),Gs(48,SP,3,2,"g",32),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(3),Ws("ngClass",Du(22,EP,t.selecting)),ho(1),Ws("ngIf",t.getSelectedCountry()&&t.getSelectedRegion()),ho(1),Ws("ngIf",t.getSelectedMission()),ho(1),Ws("ngIf",t.getSelectedSeaEvent()),ho(13),Ws("value",3)("ngModel",t.radio),ho(4),Ws("value",4)("ngModel",t.radio),ho(4),Ws("checked",t.getShowHarbours())("ngModel",t.showHarbours),ho(4),Ws("value",0)("ngModel",t.radio),ho(4),Ws("value",1)("ngModel",t.radio),ho(4),Ws("value",2)("ngModel",t.radio),ho(1),Us("viewBox",-674*t.getZoom()/2+" "+-674*t.getZoom()/2+" "+674*t.getZoom()+" "+464*t.getZoom()),ho(4),Us("transform","translate("+t.getX()+" "+t.getY()+")"),ho(1),Ws("ngForOf",t.getCountries()),ho(1),Ws("ngForOf",t.getSeaAreas()),ho(1),Ws("ngForOf",t.getMissions()),ho(1),Ws("ngForOf",t.getMissions()))},directives:[xl,Gl,GO,qR,vO,DO,jR,Ul,oT,MT],styles:["#wrapper[_ngcontent-%COMP%]{width:100%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#details[_ngcontent-%COMP%]{margin:5px 5px 0;width:98%;height:152px;border:black solid 2px}#details.selecting[_ngcontent-%COMP%]{height:117px}#svg[_ngcontent-%COMP%]{position:relative;margin:5px;width:98%;height:70.5%;border:black solid 2px}#kingdomName[_ngcontent-%COMP%]{font-weight:bold}#mainMap[_ngcontent-%COMP%]{background-color:#86c5da}#target[_ngcontent-%COMP%]{position:absolute;width:30px;top:25px;right:30px;cursor:pointer}#arrowUp[_ngcontent-%COMP%]{position:absolute;width:30px;top:0;right:30px;cursor:pointer}#arrowDown[_ngcontent-%COMP%]{position:absolute;width:30px;top:50px;right:30px;cursor:pointer}#arrowRight[_ngcontent-%COMP%]{position:absolute;width:30px;top:25px;right:5px;cursor:pointer}#arrowLeft[_ngcontent-%COMP%]{position:absolute;width:30px;top:25px;right:55px;cursor:pointer}#plus[_ngcontent-%COMP%]{position:absolute;width:25px;top:80px;right:50px;cursor:pointer}#minus[_ngcontent-%COMP%]{position:absolute;width:25px;top:80px;right:15px;cursor:pointer}#options[_ngcontent-%COMP%]{position:absolute;top:5px;right:90px;cursor:pointer}#options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:100px;text-align:end;cursor:pointer}#options2[_ngcontent-%COMP%]{position:absolute;top:5px;right:220px;cursor:pointer}#options2[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:150px;text-align:end;cursor:pointer}.mission[_ngcontent-%COMP%]{cursor:pointer}svg[_ngcontent-%COMP%]{height:100%;width:100%}.region[_ngcontent-%COMP%]:hover{opacity:.7}#regionDetails[_ngcontent-%COMP%]{display:flex;flex-direction:row}#regionDetails[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-right:10px}#missionDetails[_ngcontent-%COMP%]{display:flex;flex-direction:column}#missionTitle[_ngcontent-%COMP%]{font-size:1.1em;font-weight:bolder;text-align:center;padding-bottom:5px}#missionBody[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-left:5px}app-progress-bar[_ngcontent-%COMP%]{margin-top:3px;margin-left:5px;display:inline-block;width:150px;height:15px;font-size:.7em}#missionStatus[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:2px}#missionStats[_ngcontent-%COMP%]{display:flex;flex-direction:column}#missionBody[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 auto}#missionBody[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px}#missionDetails[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-right:20px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}hr[_ngcontent-%COMP%]{display:block;height:1px;border:0;border-top:1px solid black;padding:0;margin:2px 0}button[_ngcontent-%COMP%]{margin:2px;padding:4px}.buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}.buttonIcon[_ngcontent-%COMP%]{height:20px}#changeName[_ngcontent-%COMP%]{margin-left:5px;height:14px;cursor:pointer}#svgBox[_ngcontent-%COMP%]{height:72px;width:72px}.seaEvent[_ngcontent-%COMP%]{cursor:pointer}#seaEventBody[_ngcontent-%COMP%]{display:flex;flex-direction:row}#seaEventTitle[_ngcontent-%COMP%]{margin-left:10px;font-weight:bolder}#sizeDiv[_ngcontent-%COMP%]{padding-right:15px}"]}),e}();function RP(e,t){if(1&e&&(zs(0,"div",28),zs(1,"div",29),ha(2),Ys(),Ys()),2&e){var i=ta().$implicit;ho(2),da(i)}}function OP(e,t){if(1&e&&(zs(0,"div",30),zs(1,"div",29),ha(2),Ys(),Ys()),2&e){var i=ta().$implicit;ho(2),da(i)}}function TP(e,t){if(1&e){var i=qs();zs(0,"div",25),$s("click",function(){var e=Kt(i).$implicit;return ta().select(e)}),Gs(1,RP,3,1,"div",26),Gs(2,OP,3,1,"div",27),Ys()}if(2&e){var n=t.$implicit,r=ta();ho(1),Ws("ngIf",r.bookPage===n),ho(1),Ws("ngIf",r.bookPage!==n)}}function IP(e,t){if(1&e){var i=qs();zs(0,"app-recipe",31),$s("click",function(e){var t=Kt(i).$implicit;return ta().craft(e,t)}),Ys()}2&e&&Ws("recipe",t.$implicit)}function bP(e,t){if(1&e&&js(0,"app-recipe",32),2&e){var i=t.$implicit;Ws("recipe",i.recipe)("amount",i.amount)("type",i.type)("id",i.id)}}var CP=function(){var e=function(){function e(t,i,n,r,o){p(this,e),this.recipeService=t,this.resourcesService=i,this.craftingService=n,this.modalService=r,this.changeDetectorRef=o,this.craftingTypes=Vk,this.filterText="",this.amount=1,this.craftingType=this.craftingTypes.SELECTED,this.bookPage=Hv[Hv.ALL]}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.craftingService.registerForUpdate().subscribe(function(){e.changeDetectorRef.destroyed||e.changeDetectorRef.detectChanges()}),this.craftingType=this.craftingService.getCookingType()}},{key:"getRecipes",value:function(){var e=this;return this.filterText&&this.filterText.length>0?this.recipeService.getCookingRecipes().filter(function(t){return t.available&&(e.resourcesService.getResourceTypes(t.getResource()).includes(Hv[e.bookPage])&&t.title.toLowerCase().includes(e.filterText.toLowerCase())||e.resourcesService.getResourceTypes(t.getResource()).includes(Hv[e.bookPage])&&Qv.prepareResourceName(t.getResource()).toLowerCase().includes(e.filterText.toLowerCase()))}):this.recipeService.getCookingRecipes().filter(function(t){return t.available&&e.resourcesService.getResourceTypes(t.getResource()).includes(Hv[e.bookPage])})}},{key:"getEntries",value:function(){var e=[];return e.push(Hv[Hv.FOOD]),e}},{key:"select",value:function(e){this.bookPage=e}},{key:"craft",value:function(e,t){this.validateAmountInput()&&this.craftingService.cook(e,t,this.amount,this.craftingType)}},{key:"getQueue",value:function(){return this.craftingService.getCookingQueue()}},{key:"drop",value:function(e){this.craftingService.moveRecipeInCookingQueue(e)}},{key:"getQueueMaxSize",value:function(){return this.craftingService.getCookingQueueMaxSize()}},{key:"validateAmountInput",value:function(){return!(isNaN(this.amount)||Number(this.amount)<1)||(this.modalService.info("Invalid cook amount"),this.amount=1,!1)}},{key:"updateCraftingType",value:function(){this.craftingService.setCookingType(this.craftingType)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Yk),Bs(DE),Bs(jk),Bs(Jv),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-cooking"]],decls:58,vars:18,consts:[["id","wrapper"],["id","title"],["id","boxes"],["id","recipes"],[1,"title"],[1,"icon"],["appTooltip","",1,"tooltip",3,"elementId"],[3,"name","title"],["id","help1"],["id","recipesBook"],["id","menu"],["class","entry",3,"click",4,"ngFor","ngForOf"],["id","book"],["id","side"],["id","filter"],["type","text",3,"ngModel","ngModelChange"],["id","amount"],["type","number","min","1",3,"ngModel","ngModelChange"],[1,"radios"],["type","radio","name","type",3,"ngModel","value","ngModelChange","change"],["id","bookRecipes"],[3,"recipe","click",4,"ngFor","ngForOf"],[1,"queue"],["id","queueRecipes","cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",3,"recipe","amount","type","id",4,"ngFor","ngForOf"],[1,"entry",3,"click"],["class","activeEntry",4,"ngIf"],["class","inactiveEntry",4,"ngIf"],[1,"activeEntry"],[1,"entryText"],[1,"inactiveEntry"],[3,"recipe","click"],["cdkDrag","",3,"recipe","amount","type","id"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-crafting-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"span",4),zs(6,"span",5),ha(7,"Recipes "),zs(8,"div",6),js(9,"app-icon",7),zs(10,"span",8),ha(11," In this menu you can define orders for your kitchens."),js(12,"br"),js(13,"br"),ha(14," Each kitchen will try to take order from the orders lists starting from top."),js(15,"br"),js(16,"br"),ha(17," Only orders that meet requirements will be taken by kitchen."),js(18,"br"),js(19,"br"),ha(20," You can add order to the top of the list by holding shift while clicking on a recipe. "),Ys(),Ys(),Ys(),Ys(),zs(21,"div",9),zs(22,"div",10),Gs(23,TP,3,2,"div",11),Ys(),zs(24,"div",12),zs(25,"div",13),zs(26,"div",14),ha(27," Filter:"),js(28,"br"),zs(29,"input",15),$s("ngModelChange",function(e){return t.filterText=e}),Ys(),Ys(),zs(30,"div",16),ha(31," amount:"),js(32,"br"),zs(33,"input",17),$s("ngModelChange",function(e){return t.amount=e}),Ys(),Ys(),zs(34,"div",18),zs(35,"label"),zs(36,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(37," selected amount "),Ys(),js(38,"br"),zs(39,"label"),zs(40,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(41," until X available "),Ys(),js(42,"br"),zs(43,"label"),zs(44,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(45," until % available "),Ys(),Ys(),zs(46,"div",18),zs(47,"label"),zs(48,"input",19),$s("ngModelChange",function(e){return t.craftingType=e})("change",function(){return t.updateCraftingType()}),Ys(),ha(49," continuous "),Ys(),Ys(),Ys(),zs(50,"div",20),Gs(51,IP,1,1,"app-recipe",21),Ys(),Ys(),Ys(),Ys(),zs(52,"div",22),zs(53,"span",4),ha(54,"Orders"),Ys(),ha(55),zs(56,"div",23),$s("cdkDropListDropped",function(e){return t.drop(e)}),Gs(57,bP,1,4,"app-recipe",24),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(8),Ws("elementId","help1"),ho(1),Ws("name","question")("title",""),ho(14),Ws("ngForOf",t.getEntries()),ho(6),Ws("ngModel",t.filterText),ho(4),Ws("ngModel",t.amount),ho(3),Ws("ngModel",t.craftingType)("value",t.craftingTypes.SELECTED),ho(4),Ws("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_X),ho(4),Ws("ngModel",t.craftingType)("value",t.craftingTypes.UNTIL_PERCENT),ho(4),Ws("ngModel",t.craftingType)("value",t.craftingTypes.CONTINUOUS),ho(3),Ws("ngForOf",t.getRecipes()),ho(4),fa(" ",t.getQueue().length,"/",t.getQueueMaxSize()," "),ho(2),Ws("ngForOf",t.getQueue()))},directives:[Qk,sT,oT,Ul,qR,vO,DO,tT,xO,GO,sE,Gl,vN,hE],styles:["#wrapper[_ngcontent-%COMP%]{height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#boxes[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:95%;margin:.5%;text-align:center}#recipes[_ngcontent-%COMP%]{text-align:center;flex:0 0 74.3%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.queue[_ngcontent-%COMP%]{text-align:center;flex:0 0 25%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}#queueRecipes[_ngcontent-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:hidden}.title[_ngcontent-%COMP%]{width:100.5%;font-weight:bolder;font-size:1.1em;display:inline-block;border-bottom:black solid 1px}#modes[_ngcontent-%COMP%]{margin-top:-1px;padding:0;margin-bottom:5px}#recipesBook[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}#menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-right:black solid 1px;flex:0 0 10%}.entry[_ngcontent-%COMP%]{display:flex;border-bottom:black solid 1px;flex:1 0 0;height:100%;width:100%;margin-right:-30px;font-size:.8em;font-weight:600;cursor:pointer}.entry[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.entryText[_ngcontent-%COMP%]{-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-ms-transform:rotate(-90deg);-o-transform:rotate(-90deg)}.inactiveEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center}.activeEntry[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;justify-content:center;align-items:center;background-color:var(--active-colour)}#book[_ngcontent-%COMP%]{flex:0 0 90%;width:100%}#bookRecipes[_ngcontent-%COMP%]{overflow-y:auto;border-top:black solid 1px}app-recipe[_ngcontent-%COMP%]{font-size:.8em;display:inline-block;width:130px;margin:4px 6px;cursor:pointer}#side[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-size:.8em;margin:1%;vertical-align:bottom}#filter[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:1.05em;margin-left:0;padding:0;border:none;outline:0}#amount[_ngcontent-%COMP%]{font-size:1em;width:20%;margin:1%;display:block;vertical-align:bottom}#amount[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:65%;font-size:1.15em;margin-left:0;padding:0;border:none;outline:0}.radios[_ngcontent-%COMP%]{text-align:left;font-size:.9em}#progressButton[_ngcontent-%COMP%]{font-size:.6em}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:85px;margin:auto}#help1[_ngcontent-%COMP%]{font-size:.7em;font-weight:normal;text-align:left}"]}),e}();function AP(e,t){if(1&e&&(zs(0,"option",16),ha(1),Ys()),2&e){var i=t.$implicit,n=ta();Ws("ngValue",i),ho(1),ga(" ",n.getRegionName(i)," ")}}function kP(e,t){if(1&e&&(zs(0,"div",17),zs(1,"span"),ha(2),Ys(),zs(3,"span"),ha(4),Ys(),zs(5,"span"),ha(6),Ys(),zs(7,"span"),ha(8),Ys(),zs(9,"span"),ha(10),Ys(),zs(11,"span"),ha(12),Ys(),Ys()),2&e){var i=t.$implicit,n=t.index,r=ta();ho(2),ga("",n+1,"."),ho(2),da(r.getBuildingName(i.building)),ho(2),da(i.count),ho(2),da(i.size),ho(2),da(i.working),ho(2),da(i.count-i.working)}}var NP=function(){var e=function(){function e(t,i){p(this,e),this.servicesService=t,this.gameService=i,this.region=Yv.VILLAGE,this.sorting=0}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getBuildings",value:function(e){var t=[];return this.servicesService.getServiceByRegion(e).getBuildings().forEach(function(e){var i=t.find(function(t){return t.building===e.getBuildingType()});i?(i.count+=1,i.size+=e.getSize(),e.isWorking()&&(i.working+=1)):t.push({building:e.getBuildingType(),count:1,size:e.getSize(),working:e.isWorking()?1:0})}),t.sort(0===this.sorting?function(e,t){return e.building-t.building}:1===this.sorting?function(e,t){return t.count-e.count}:function(e,t){return e.count-t.count})}},{key:"getBuildingName",value:function(e){return Qv.prepareBuildingName(e)}},{key:"getRegions",value:function(){var e=[Yv.VILLAGE];return this.gameService.isEnabled(wv.FORT)&&e.push(Yv.FORT),e.push(Yv.FOREST),this.gameService.isEnabled(wv.FIELD)&&e.push(Yv.FIELD),this.gameService.isEnabled(wv.MOUNTAINS)&&e.push(Yv.MOUNTAINS),this.gameService.isEnabled(wv.PLATEAU)&&e.push(Yv.PLATEAU),this.gameService.isEnabled(wv.SEA)&&e.push(Yv.SEA),e}},{key:"getRegionName",value:function(e){return Qv.prepareRegionName(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs($v),Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-summary"]],decls:39,vars:9,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],["id","sortAlphabetically","type","radio","name","sorting",3,"ngModel","value","ngModelChange"],["for","sortAlphabetically"],["id","sortByBiggest","type","radio","name","sorting",3,"ngModel","value","ngModelChange"],["for","sortByBiggest"],["id","sortBySmallest","type","radio","name","sorting",3,"ngModel","value","ngModelChange"],["for","sortBySmallest"],[3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["id","buildingEffects"],[1,"headers"],[1,"rows"],["class","row",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"row"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-management-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"span"),ha(6,"Summary page"),Ys(),Ys(),zs(7,"input",4),$s("ngModelChange",function(e){return t.sorting=e}),Ys(),zs(8,"label",5),ha(9,"sort alphabetically"),Ys(),js(10,"br"),zs(11,"input",6),$s("ngModelChange",function(e){return t.sorting=e}),Ys(),zs(12,"label",7),ha(13,"sort by most buildings"),Ys(),js(14,"br"),zs(15,"input",8),$s("ngModelChange",function(e){return t.sorting=e}),Ys(),zs(16,"label",9),ha(17,"sort by least buildings"),Ys(),js(18,"br"),zs(19,"h3"),zs(20,"select",10),$s("ngModelChange",function(e){return t.region=e}),Gs(21,AP,2,2,"option",11),Ys(),ha(22," Buildings "),Ys(),zs(23,"div",12),zs(24,"div",13),zs(25,"span"),ha(26,"#"),Ys(),zs(27,"span"),ha(28,"building"),Ys(),zs(29,"span"),ha(30,"count"),Ys(),zs(31,"span"),ha(32,"total land"),Ys(),zs(33,"span"),ha(34,"working"),Ys(),zs(35,"span"),ha(36,"idle"),Ys(),Ys(),zs(37,"div",14),Gs(38,kP,13,6,"div",15),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(7),Ws("ngModel",t.sorting)("value",0),ho(4),Ws("ngModel",t.sorting)("value",1),ho(4),Ws("ngModel",t.sorting)("value",2),ho(5),Ws("ngModel",t.region),ho(1),Ws("ngForOf",t.getRegions()),ho(17),Ws("ngForOf",t.getBuildings(t.region)))},directives:[TN,GO,qR,vO,DO,YO,Ul,jO,XO],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#content[_ngcontent-%COMP%]{margin:.5%;height:94%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}.headers[_ngcontent-%COMP%]{margin:3px 3px 0;display:flex;width:98.3%;flex-direction:row;text-align:center;font-size:.9em;font-weight:bold}.rows[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:center;height:90.5%;overflow-y:auto}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border:black solid 1px;border-left:none}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{border-left:black solid 1px}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 30%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 15%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 18%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.headers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(6){flex:0 0 15%}.row[_ngcontent-%COMP%]{display:flex;border:black solid 1px;margin:3px}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{border-right:none}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){flex:0 0 7%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){flex:0 0 30%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(4){flex:0 0 18%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(5){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(6){flex:0 0 15%}.row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:auto;border-right:black solid 1px}"]}),e}();function _P(e,t){if(1&e&&(zs(0,"span"),js(1,"app-icon",3),ha(2),Ys()),2&e){var i=ta();ho(1),Ws("name","sextant")("path","sea")("title","cartography data"),ho(1),ga(" ",i.getCartographyData()," \xa0\xa0\xa0 ")}}function wP(e,t){if(1&e){var i=qs();zs(0,"span",17),$s("click",function(){return Kt(i),ta().changeDismiss(!0)}),ha(1,"decommission"),Ys()}}function PP(e,t){if(1&e){var i=qs();zs(0,"span",18),$s("click",function(){return Kt(i),ta().changeDismiss(!1)}),ha(1,"decommission"),Ys()}}var MP=function(e){return{pointer:e}};function DP(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"div",19),zs(2,"img",20),$s("click",function(){var e=Kt(i).$implicit;return ta().tryToDismiss(e)}),Ys(),ha(3),zs(4,"span",21),zs(5,"div",22),ha(6),Ys(),js(7,"hr"),zs(8,"div",23),ha(9,"Stats:"),Ys(),zs(10,"div",2),js(11,"app-icon",24),ha(12),Ys(),zs(13,"div",2),js(14,"app-icon",24),ha(15),Ys(),zs(16,"div",2),js(17,"app-icon",24),ha(18),Ys(),zs(19,"div",2),js(20,"app-icon",16),ha(21),Ys(),zs(22,"div",2),js(23,"app-icon",24),ha(24),Ys(),Ys(),Ys(),Ys()}if(2&e){var n=t.$implicit,r=ta();ho(2),ia("src",r.getShipIconPath(n),gr),Ws("elementId","ship-"+n)("ngClass",Du(21,MP,r.dismiss)),ho(1),fa(" ",r.getAvailableShips(n)," /",r.getTotalShips(n)," "),ho(1),na("id","ship-",n,""),ho(2),da(r.getShipName(n)),ho(5),Ws("name","attack")("path","army"),ho(1),ga(": ",r.getShipStrength(n),""),ho(2),Ws("name","defense")("path","army"),ho(1),ga(": ",r.getShipDefense(n),""),ho(2),Ws("name","speed")("path","army"),ho(1),ga(": ",r.getShipSpeed(n),""),ho(2),Ws("name","cargo"),ho(1),ga(": ",r.getShipCargo(n),""),ho(2),Ws("name","coins")("path","resources"),ho(1),ga(": ",r.getShipPay(n),"")}}function LP(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),fa(" ",n.getTroopName(i.troop),": ",i.size," ")}}function xP(e,t){if(1&e){var i=qs();zs(0,"div",25),$s("click",function(){var e=Kt(i).$implicit;return ta().selectMission(e)}),ha(1),zs(2,"span",21),ha(3),js(4,"hr"),ha(5),Hu(6,"number"),Gs(7,LP,2,2,"div",11),Ys(),Ys()}if(2&e){var n=t.$implicit;Ws("elementId","mission-"+n.id),ho(1),ga(" ",n.getMissionName()," "),ho(1),na("id","mission-",n.id,""),ho(1),ga(" ",n.getMissionName()," "),ho(2),fa(" ",n.getStatus()," : ",Bu(6,7,n.getDisplayProgress(),"0.0-0"),"% "),ho(2),Ws("ngForOf",n.army.units)}}function FP(e,t){if(1&e){var i=qs();zs(0,"button",26),$s("click",function(){return Kt(i),ta().startExpedition()}),ha(1,"EXPEDITION"),Ys()}}function UP(e,t){1&e&&(zs(0,"span",27),ha(1,"Discovered land:"),Ys())}function HP(e,t){if(1&e){var i=qs();zs(0,"button",16),$s("click",function(){return Kt(i),ta().openFestivalModal()}),ha(1,"Organize festival"),Ys()}}function GP(e,t){if(1&e&&(zs(0,"span",20),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("(",i.duration,")")}}function BP(e,t){if(1&e&&(zs(0,"div",17),ha(1),Gs(2,GP,2,1,"span",18),zs(3,"span",19),ha(4),Ys(),Ys()),2&e){var i=t.$implicit,n=ta();ho(1),da(n.getEffectName(i.effect)),ho(1),Ws("ngIf",n.getShowDuration()&&i.duration>0),ho(2),da(i.value)}}function WP(e,t){if(1&e&&(zs(0,"span",20),ha(1),Ys()),2&e){var i=ta().$implicit;ho(1),ga("(",i.duration,")")}}function VP(e,t){if(1&e&&(zs(0,"div"),zs(1,"span",21),ha(2),Ys(),Gs(3,WP,2,1,"span",18),ha(4),Ys()),2&e){var i=t.$implicit,n=ta();ho(2),da(i.value),ho(1),Ws("ngIf",n.getShowDuration()&&i.duration>0),ho(1),ga(" ",n.getEffectName(i.effect),"")}}var zP=function(e,t){return{negativeColor:e,positiveColor:t}},YP=[{path:"",redirectTo:"regions/redirect",pathMatch:"full"},{path:"404",component:Ak,pathMatch:"full"},{path:"resources",component:BI},{path:"crafting",children:[{path:"",redirectTo:"crafting",pathMatch:"full"},{path:"crafting",component:RN,canActivate:[Ck]},{path:"cooking",component:CP}]},{path:"market",component:fk,canActivate:[Ck]},{path:"research",component:Eb,canActivate:[Ck]},{path:"army",component:bA,canActivate:[Ck]},{path:"religion",component:WA,canActivate:[Ck]},{path:"weather",component:bk,canActivate:[Ck]},{path:"world",component:yP,canActivate:[Ck]},{path:"navy",component:function(){var e=function(){function e(t,i,n,r,o,s){p(this,e),this.navyService=t,this.worldService=i,this.armyService=n,this.modalService=r,this.gameService=o,this.router=s,this.troops=Bv,this.dismiss=!1}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getHarbourSpace",value:function(){return this.navyService.getHarbourSpace()}},{key:"getMaxHarbourSpace",value:function(){return this.navyService.getMaxHarbourSpace()}},{key:"getAvailableShips",value:function(e){return this.navyService.getAvailableShips(e)}},{key:"getTotalShips",value:function(e){return this.navyService.getTotalShips(e)}},{key:"getMissions",value:function(){return this.worldService.getPlayerSeaMissions()}},{key:"selectMission",value:function(e){this.worldService.setSelectedMission(e),this.router.navigate(["/world"])}},{key:"getTroopName",value:function(e){return Qv.prepareTroopName(e)}},{key:"getCartographyData",value:function(){return this.navyService.getCartographyData()}},{key:"getNavyPay",value:function(){return this.navyService.calculateNavyPay()}},{key:"getPaydayCounter",value:function(){return this.navyService.getPaydayCounter()}},{key:"startExpedition",value:function(){this.modalService.open(_v.MISSION),this.modalService.setMissionData(new f_(this.worldService.getDefaultOriginRegion(),this.worldService.getDefaultOriginRegionCountry().colour,null,null,null,null,Fv.EXPEDITION))}},{key:"isCartographerResearched",value:function(){return this.gameService.isEnabled(wv.CARTOGRAPHER)}},{key:"getShipsTypes",value:function(){return[Bv.BOAT,Bv.BRIGANTINE,Bv.GALLEON]}},{key:"getShipIconPath",value:function(e){return"assets/sea/"+Qv.prepareTroopName(e).toLowerCase()+".svg"}},{key:"getShipName",value:function(e){return Qv.prepareTroopName(e)}},{key:"getShipStrength",value:function(e){return lm.getTroop(e).STRENGTH}},{key:"getShipDefense",value:function(e){return lm.getTroop(e).DEFENSE}},{key:"getShipSpeed",value:function(e){return lm.getTroop(e).SPEED}},{key:"getShipCargo",value:function(e){return lm.getTroop(e).CARGO}},{key:"getShipPay",value:function(e){return lm.getTroop(e).PAY}},{key:"changeDismiss",value:function(e){this.dismiss=e}},{key:"tryToDismiss",value:function(e){this.dismiss&&this.navyService.dismiss(e,1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(kC),Bs(G_),Bs(KC),Bs(Jv),Bs(_m),Bs(sv))},e.\u0275cmp=it({type:e,selectors:[["app-navy"]],decls:36,vars:23,consts:[["id","wrapper"],["id","title"],[1,"icon"],[3,"name","path","title"],[4,"ngIf"],["id","categories"],[1,"category"],[1,"title"],["id","numbers"],["class","number",3,"click",4,"ngIf"],["class","number active",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["id","missionsScroll"],["class","mission tooltip","appTooltip","",3,"elementId","click",4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["class","title marginTop",4,"ngIf"],[3,"name"],[1,"number",3,"click"],[1,"number","active",3,"click"],[1,"icon","tooltip"],["appTooltip","",3,"src","elementId","ngClass","click"],[3,"id"],[1,"tooltipTitle"],[1,"statsTitle"],[3,"name","path"],["appTooltip","",1,"mission","tooltip",3,"elementId","click"],[3,"click"],[1,"title","marginTop"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),ha(2,"Navy"),Ys(),zs(3,"div",2),js(4,"app-icon",3),ha(5),Gs(6,_P,3,4,"span",4),js(7,"app-icon",3),ha(8),Ys(),zs(9,"div",5),zs(10,"div",6),zs(11,"span",7),ha(12,"NAVY"),Ys(),zs(13,"div",8),Gs(14,wP,2,0,"span",9),Gs(15,PP,2,0,"span",10),Ys(),Gs(16,DP,25,23,"div",11),Ys(),zs(17,"div",6),zs(18,"span",7),ha(19,"MISSIONS IN PROGRESS"),Ys(),zs(20,"div",12),Gs(21,xP,8,10,"div",13),Ys(),Ys(),zs(22,"div",6),zs(23,"span",7),ha(24,"OTHER"),Ys(),Gs(25,FP,2,0,"button",14),Gs(26,UP,2,0,"span",15),zs(27,"span",2),js(28,"app-icon",16),ha(29),Ys(),zs(30,"span",2),js(31,"app-icon",16),ha(32),Ys(),zs(33,"span",2),js(34,"app-icon",16),ha(35),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(4),Ws("name","port")("path","sea")("title","Ships space"),ho(1),fa(" ",t.getHarbourSpace(),"/",t.getMaxHarbourSpace()," \xa0\xa0 "),ho(1),Ws("ngIf",t.isCartographerResearched()),ho(1),Ws("name","coins")("path","resources")("title","Navy upkeep (collected every 30 days)"),ho(1),fa("\xa0",t.getNavyPay()," in ",t.getPaydayCounter()+1," days "),ho(6),Ws("ngIf",!t.dismiss),ho(1),Ws("ngIf",t.dismiss),ho(1),Ws("ngForOf",t.getShipsTypes()),ho(5),Ws("ngForOf",t.getMissions()),ho(4),Ws("ngIf",t.isCartographerResearched()),ho(1),Ws("ngIf",t.worldService.getTotalDiscovered()>0),ho(2),Ws("name","land"),ho(1),da(t.worldService.getDiscoveredLand()),ho(2),Ws("name","forest"),ho(1),da(t.worldService.getDiscoveredForest()),ho(2),Ws("name","mountains"),ho(1),da(t.worldService.getDiscoveredMountains()))},directives:[oT,Gl,Ul,sT,xl],pipes:[$l],styles:["#wrapper[_ngcontent-%COMP%]{margin:.7%;height:100%}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#categories[_ngcontent-%COMP%]{display:flex;flex-direction:row;border:black solid 1px;height:91.5%;text-align:center}.category[_ngcontent-%COMP%]{text-align:center;flex:0 0 33%;display:flex;flex-direction:column;border:black solid 1px;align-items:center}.title[_ngcontent-%COMP%]{padding:2px;width:100%;font-weight:bolder;font-size:.9em;margin-bottom:5px;display:block;border-bottom:black solid 1px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#missionsScroll[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;overflow-y:auto;align-items:center}.mission[_ngcontent-%COMP%]{padding:4px;border:black solid 1px;width:80%;cursor:pointer;margin:3px}.tooltipTitle[_ngcontent-%COMP%]{font-weight:bold;padding:0 20px}#numbers[_ngcontent-%COMP%]{margin-top:-6px;padding:0;margin-bottom:5px}.number[_ngcontent-%COMP%]{border:black solid 1px;padding:2px 4px;background-color:var(--passive-colour);font-size:.75em;cursor:pointer}.number[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}.active[_ngcontent-%COMP%]{background-color:var(--active-colour)}.pointer[_ngcontent-%COMP%]{cursor:pointer}.marginTop[_ngcontent-%COMP%]{margin-top:30px}"]}),e}(),canActivate:[Ck]},{path:"heritage",component:h_,canActivate:[Ck]},{path:"royal",component:Wk},{path:"regions",children:[{path:"",redirectTo:"redirect",pathMatch:"full"},{path:"redirect",component:wI,canActivate:[Ck]},{path:"village",component:wI,canActivate:[Ck]},{path:"fort",component:rk,canActivate:[Ck]},{path:"forest",component:Ub,canActivate:[Ck]},{path:"field",component:tC,canActivate:[Ck]},{path:"mountains",component:IC,canActivate:[Ck]},{path:"plateau",component:BN,canActivate:[Ck]},{path:"sea",component:zC,canActivate:[Ck]}]},{path:"management",children:[{path:"",redirectTo:"general",pathMatch:"full"},{path:"general",component:NN},{path:"happiness",component:function(){var e=function(){function e(t,i){p(this,e),this.happinessService=t,this.modalService=i}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getSum",value:function(){return this.happinessService.calculateDailyChange()}},{key:"getPositiveEffects",value:function(){return this.happinessService.getHappinessEffects().filter(function(e){return e.value>=0})}},{key:"getNegativeEffects",value:function(){return this.happinessService.getHappinessEffects().filter(function(e){return e.value<0})}},{key:"getEffectName",value:function(e){return Qv.prepareHappinessEffectName(e)}},{key:"getSumText",value:function(){return Qv.round(this.getSum(),2)}},{key:"getHappinessBonus",value:function(){return this.happinessService.getHappinessEffect()}},{key:"openFestivalModal",value:function(){this.modalService.open(_v.FESTIVAL)}},{key:"canStartFestival",value:function(){return void 0===this.happinessService.getHappinessEffectByEffect(Kv.FESTIVAL)}},{key:"getShowDuration",value:function(){return this.happinessService.getShowDuration()}},{key:"toggleShowDuration",value:function(){this.happinessService.toggleShowDuration()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_E),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-happiness-management"]],decls:33,vars:14,consts:[["id","wrapper"],["id","top-menu"],["id","content"],["id","title"],[1,"center"],[3,"ngClass"],["id","showDuration","type","checkbox",3,"checked","change"],["for","showDuration"],["id","festival",3,"click",4,"ngIf"],[1,"headers"],[1,"center","subtitle"],["id","effects"],["id","positive"],["class","changeToRight",4,"ngFor","ngForOf"],["id","negative"],[4,"ngFor","ngForOf"],["id","festival",3,"click"],[1,"changeToRight"],["class","small",4,"ngIf"],[1,"positiveValue"],[1,"small"],[1,"negativeValue"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),js(2,"app-management-top-menu"),Ys(),zs(3,"div",2),zs(4,"div",3),zs(5,"span"),ha(6,"Happiness"),Ys(),Ys(),zs(7,"div",4),js(8,"app-happiness"),js(9,"br"),ha(10," (bonus: "),zs(11,"span",5),ha(12),Ys(),ha(13,") "),Ys(),zs(14,"div",4),zs(15,"span",5),ha(16),Ys(),ha(17," per day "),Ys(),js(18,"br"),zs(19,"input",6),$s("change",function(){return t.toggleShowDuration()}),Ys(),zs(20,"label",7),ha(21,"show duration in days"),Ys(),Gs(22,HP,2,0,"button",8),zs(23,"div",9),zs(24,"span",10),ha(25,"Positive Effects"),Ys(),zs(26,"span",10),ha(27,"Negative Effects"),Ys(),Ys(),zs(28,"div",11),zs(29,"div",12),Gs(30,BP,5,3,"div",13),Ys(),zs(31,"div",14),Gs(32,VP,5,3,"div",15),Ys(),Ys(),Ys(),Ys()),2&e&&(ho(11),Ws("ngClass",Lu(8,zP,t.getHappinessBonus()<0,t.getHappinessBonus()>0)),ho(1),ga("",t.getHappinessBonus()," %"),ho(3),Ws("ngClass",Lu(11,zP,t.getSum()<0,t.getSum()>0)),ho(1),ga("",t.getSumText(),"%"),ho(3),Ws("checked",t.getShowDuration()),ho(3),Ws("ngIf",t.canStartFestival()),ho(8),Ws("ngForOf",t.getPositiveEffects()),ho(2),Ws("ngForOf",t.getNegativeEffects()))},directives:[TN,gT,xl,Gl,Ul],styles:["#wrapper[_ngcontent-%COMP%]{height:99%}#content[_ngcontent-%COMP%]{margin:.5%;height:90%}#top-menu[_ngcontent-%COMP%]{height:5%;margin:-2px;border:black solid 2px;overflow:hidden}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.5em;font-weight:800}.center[_ngcontent-%COMP%]{text-align:center}.headers[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;margin-bottom:10px}.headers[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 49%}#effects[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;height:78%}#positive[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-right:black solid 4px;font-size:1.5em;padding-right:10px;flex:0 0 49%;align-items:flex-start;height:100%;overflow:auto;direction:rtl}.changeToRight[_ngcontent-%COMP%]{direction:ltr}#negative[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:1.5em;padding-left:10px;flex:0 0 49%;overflow:auto}.positiveValue[_ngcontent-%COMP%]{display:inline-block;width:30px;text-align:center;color:var(--positive-colour)}.negativeValue[_ngcontent-%COMP%]{display:inline-block;width:30px;text-align:center;color:var(--negative-colour)}.positiveColor[_ngcontent-%COMP%]{color:var(--positive-colour)}.negativeColor[_ngcontent-%COMP%]{color:var(--negative-colour)}.subtitle[_ngcontent-%COMP%]{font-size:1.2em;font-weight:bolder}.small[_ngcontent-%COMP%]{font-size:.7em}#festival[_ngcontent-%COMP%]{float:right}"]}),e}()},{path:"effects",component:n_},{path:"forestM",component:s_},{path:"summary",component:NP}]},{path:"**",redirectTo:"regions/village",pathMatch:"full"}],jP=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({imports:[[Rv.forRoot(YP,{relativeLinkResolution:"legacy"})],Rv]}),e}(),KP=["body"],QP=["*"],qP=function(){var e=function(){function e(t,i,n){p(this,e),this.rd=t,this.el=i,this.modalService=n,this.param="",this.element=i.nativeElement}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this,t=this;!this.id||(document.body.appendChild(this.element),this.rd.listen(this.element,"click",function(i){var n=i.target;null===n.closest(".modal-body")&&"BUTTON"!==n.tagName&&"path"!==n.tagName&&"IMG"!==n.tagName&&"tutorial-modal"!==t.id&&(e.modalService.sendConfirmationResult(!1),e.modalService.sendCloseSignal(_v.ALL),t.close())}),this.modalService.add(this))}},{key:"ngOnDestroy",value:function(){this.modalService.remove(this.id),this.element.remove()}},{key:"open",value:function(){this.element.style.display="block",document.body.classList.add("modal-open")}},{key:"openTutorialWindow",value:function(e){var t=this.element.querySelector(".modal-body");t.style.position="absolute",t.style.margin="0",t.style.width=e.width,t.style.top=e.top,t.style.left=e.left,this.element.style.display="block",document.body.classList.add("modal-open")}},{key:"close",value:function(){this.element.style.display="none",document.body.classList.remove("modal-open")}},{key:"onKeydownHandler",value:function(e){"tutorial-modal"!==this.id&&(this.modalService.sendConfirmationResult(!1),this.modalService.sendCloseSignal(_v.ALL),this.close())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Ba),Bs(Ua),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-modal"]],viewQuery:function(e,t){var i;(1&e&&rc(KP,5),2&e)&&(nc(i=sc())&&(t.body=i))},hostBindings:function(e,t){1&e&&$s("keydown.escape",function(e){return t.onKeydownHandler(e)},!1,Tr)},inputs:{id:"id"},ngContentSelectors:QP,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=Yt()[16][6];if(!t.projection)for(var i=t.projection=fn(1,null),n=i.slice(),r=t.child;null!==r;){n[0]?n[0].projectionNext=r:i[0]=r,n[0]=r,r=r.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=Yt(),r=jt(),o=Oo(r,20+e,16,null,i||null);null===o.projection&&(o.projection=t),$t(),64!=(64&o.flags)&&function(e,t,i){Xr(t[11],0,t,i,Fr(e,i,t),Wr(i.parent||t[6],i,t))}(r,n,o)}(0))},encapsulation:2}),e}(),XP=["filterInput"];function ZP(e,t){if(1&e){var i=qs();zs(0,"span"),ha(1,"\xa0Number of buildings: "),zs(2,"input",8),$s("keyup",function(){return Kt(i),ta().verifyMultiplier()})("ngModelChange",function(e){return Kt(i),ta().multiplier=e}),Ys(),zs(3,"button",9),$s("click",function(){return Kt(i),ta().multiplier=1}),ha(4,"reset"),Ys(),Ys()}if(2&e){var n=ta();ho(2),Ws("ngModel",n.multiplier)}}function $P(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta().$implicit,n=ta();ho(1),da(" (limit: "+n.getLimit(n.region,i.getBuildingType())+" building)")}}function JP(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta().$implicit,n=ta();ho(1),da(" (limit: "+n.getLimit(n.region,i.getBuildingType())+" buildings)")}}function eM(e,t){if(1&e&&(zs(0,"span",22),ha(1),js(2,"app-icon",23),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),ga(" ",i.amount," "),ho(1),Ws("name",n.getResourceName(i.resource))("path","resources")}}function tM(e,t){if(1&e&&(zs(0,"span",22),ha(1),js(2,"app-icon",23),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),ga(" ",i.amount," "),ho(1),Ws("name",n.getResourceName(i.resource))("path","resources")}}function iM(e,t){if(1&e&&(zs(0,"div",20),zs(1,"span"),zs(2,"span",16),ha(3,"production input:"),Ys(),js(4,"br"),Gs(5,eM,3,3,"span",21),Ys(),zs(6,"span"),zs(7,"span",16),ha(8,"production output:"),Ys(),js(9,"br"),Gs(10,tM,3,3,"span",21),Ys(),Ys()),2&e){var i=ta().$implicit,n=ta();ho(5),Ws("ngForOf",n.getBuildingSettings(i.getBuildingType()).INPUT_RESOURCES),ho(5),Ws("ngForOf",n.getBuildingSettings(i.getBuildingType()).OUTPUT_RESOURCES)}}function nM(e,t){if(1&e&&(zs(0,"span",22),js(1,"app-icon",23),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("name",n.getResourceName(i))("path","resources")}}function rM(e,t){if(1&e&&(zs(0,"div",20),zs(1,"span"),zs(2,"span",16),ha(3,"can produce:"),Ys(),js(4,"br"),Gs(5,nM,2,2,"span",21),Ys(),Ys()),2&e){var i=ta().$implicit,n=ta();ho(5),Ws("ngForOf",n.getBuildingSettings(i.getBuildingType()).CAN_PRODUCE)}}var oM=function(e){return{notMet:e}};function sM(e,t){if(1&e&&(zs(0,"div"),zs(1,"span",22),zs(2,"span",24),ha(3),Ys(),js(4,"app-icon",25),Ys(),Ys()),2&e){var i=ta().$implicit,n=ta();ho(2),Ws("ngClass",Du(3,oM,!n.hasLand(i.getSize()*n.getNumberToBuild(i)))),ho(1),da(i.getSize()*n.getNumberToBuild(i)),ho(1),Ws("name","land")}}function aM(e,t){if(1&e&&(zs(0,"div"),zs(1,"span",22),zs(2,"span",24),ha(3),Ys(),js(4,"app-icon",25),Ys(),Ys()),2&e){var i=ta().$implicit,n=ta();ho(2),Ws("ngClass",Du(3,oM,!n.hasMountains(i.getSize()*n.getNumberToBuild(i)))),ho(1),da(i.getSize()*n.getNumberToBuild(i)),ho(1),Ws("name","mountains")}}function uM(e,t){if(1&e&&(zs(0,"span"),zs(1,"span",22),zs(2,"span",24),ha(3),Ys(),js(4,"app-icon",23),Ys(),Ys()),2&e){var i=t.$implicit,n=ta().$implicit,r=ta();ho(2),Ws("ngClass",Du(4,oM,!r.hasResource(i,r.getNumberToBuild(n)))),ho(1),da(i.value*r.getNumberToBuild(n)),ho(1),Ws("name",r.getResourceName(i.key))("path","resources")}}function cM(e,t){if(1&e){var i=qs();zs(0,"button",26),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().build(e)}),ha(1),Ys()}if(2&e){var n=ta().$implicit,r=ta();ho(1),ga("Build ",r.getNumberToBuild(n),"")}}function lM(e,t){if(1&e){var i=qs();zs(0,"button",27),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().build(e)}),ha(1),Ys()}if(2&e){var n=ta().$implicit,r=ta();Ws("disabled",0===r.getNumberToBuild(n)),ho(1),ga("Build ",r.getNumberToBuild(n),"")}}function hM(e,t){if(1&e&&(zs(0,"div",10),zs(1,"div",11),zs(2,"span",12),ha(3),Gs(4,$P,2,1,"span",5),Gs(5,JP,2,1,"span",5),Ys(),zs(6,"div",13),js(7,"div",14),Gs(8,iM,11,2,"div",15),Gs(9,rM,6,1,"div",15),zs(10,"div",16),ha(11,"cost:"),Ys(),Gs(12,sM,5,5,"div",5),Gs(13,aM,5,5,"div",5),Gs(14,uM,5,6,"span",17),Hu(15,"keyvalue"),Ys(),Ys(),Gs(16,cM,2,1,"button",18),Gs(17,lM,2,2,"button",19),Ys()),2&e){var i=t.$implicit,n=ta();ho(3),ga("",i.getName()," "),ho(1),Ws("ngIf",1===n.getLimit(n.region,i.getBuildingType())),ho(1),Ws("ngIf",n.getLimit(n.region,i.getBuildingType())>1),ho(2),Ws("innerHTML",i.getDescription(),dr),ho(1),Ws("ngIf",n.hasInputOutputDescription(i.getBuildingType())),ho(1),Ws("ngIf",n.hasCanProduceDescription(i.getBuildingType())),ho(3),Ws("ngIf",!i.buildOnMountain()),ho(1),Ws("ngIf",i.buildOnMountain()),ho(1),Ws("ngForOf",Gu(15,11,n.getBuildingCostEntries(i))),ho(2),Ws("ngIf",0!==n.getNumberToBuild(i)&&n.isCostMet(i)),ho(1),Ws("ngIf",0===n.getNumberToBuild(i)||!n.isCostMet(i))}}var dM=function(){var e=function(){function e(t,i,n,r,o,s,a,u,c,l,h,d,g,f){p(this,e),this.buildingFactoryService=t,this.servicesService=i,this.modalService=n,this.logService=r,this.resourcesService=o,this.landService=s,this.villageService=a,this.fortService=u,this.fieldService=c,this.forestService=l,this.mountainsService=h,this.seaService=d,this.plateauService=g,this.gameService=f,this.filterText="",this.multiplier=1,this.buildings=new Map,this.regions=Yv,this.buildings.set(Yv.VILLAGE,[[new SE,[],0],[new EE,[wv.HOUSE],0],[new Xy,[wv.LONGHOUSE],0],[new cR,[wv.TUDOR_HOUSE],0],[new IR,[wv.SETTLEMENT],0],[new cy,[wv.BAKERY],0],[new Sy,[wv.TAILOR],0],[new XE,[],0],[new _R,[wv.BUILDERS_GUILD],1],[new CR,[wv.SCHOLARS_LAB],0],[new sR,[wv.KITCHEN],0],[new qy,[wv.SPECIALISED_PRODUCTION],0],[new ZE,[],0],[new Fy,[wv.MARKETPLACE],0],[new kR,[wv.TAX_COLLECTOR],1],[new Ty,[wv.TAVERN],1],[new ty,[wv.SHRINE],1],[new Hy,[wv.CHURCH],1]]),this.buildings.set(Yv.FOREST,[[new xE,[],0],[new hR,[wv.PRODUCTION_ZONES],0],[new YE,[],0],[new nR,[wv.PRODUCTION_ZONES],0],[new ey,[wv.HUNTER],0],[new vy,[wv.TANNERY],0],[new UE,[wv.FORESTER],0],[new WE,[wv.SAWMILL],0],[new $y,[wv.PAPER_MILL],0]]),this.buildings.set(Yv.FORT,[[new dy,[wv.BARRACKS],0],[new fy,[wv.BARRACKS],0],[new Zy,[wv.BARRACKS],1],[new py,[wv.STOCKADE],1],[new yy,[wv.WOODEN_TOWER],1],[new Ry,[wv.STONE_TOWER],1],[new Ky,[wv.STASH],3]]),this.buildings.set(Yv.FIELD,[[new ny,[wv.FARM],0],[new uy,[wv.WINDMILL],0],[new oy,[wv.FARM],0],[new ay,[wv.FARM],0],[new Ny,[wv.PASTURE],0],[new wy,[wv.BUTCHER],0],[new my,[wv.COTTON_MILL],0],[new Ey,[wv.BREWERY],0],[new uR,[wv.CLAY_PIT],0],[new Oy,[wv.WINERY],0],[new rR,[wv.BARN],0]]),this.buildings.set(Yv.MOUNTAINS,[[new KE,[],0],[new Iy,[wv.GEOLOGIST],0],[new by,[],0],[new Ay,[wv.PIT_MINE],0],[new Uy,[wv.SMITHY],1],[new Py,[wv.MINT],0],[new eR,[wv.DEEP_MINE],0]]),this.buildings.set(Yv.PLATEAU,[[new xy,[],1],[new Gy,[],1],[new By,[],1],[new Wy,[],1],[new zy,[],1],[new Yy,[],1],[new jy,[],1],[new Vy,[],1]]),this.buildings.set(Yv.SEA,[[new hy,[wv.FISHERS_HUT],0],[new fR,[wv.BOAT_BUILDER],0],[new ER,[wv.BOAT_BUILDER],0],[new vR,[wv.HARBOUR],0],[new RR,[wv.SHIPYARD],0],[new mR,[wv.LIGHTHOUSE],1],[new TR,[wv.CARTOGRAPHER],0]])}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.clearFilterObservable.subscribe(function(){e.filterText="",e.multiplier=1}),this.openEvent.subscribe(function(){e.filterInputRef.nativeElement.focus()})}},{key:"build",value:function(e){var t=this.getNumberToBuild(e);if(e.buildOnMountain()){if(!this.landService.hasMountains(e.getSize()*t))return this.modalService.info("Not enough mountains to build "+t+" "+e.getName()+"!<br>"+e.getSize()*t+" mountains required but only "+this.landService.getMountains()+" available"),void this.modalService.close(_v.BUILD)}else if(!this.landService.hasLand(e.getSize()*t))return this.modalService.info("Not enough empty land to build "+t+" "+e.getName()+"!<br>"+e.getSize()*t+" empty land required but only "+this.landService.getLand()+" available"),void this.modalService.close(_v.BUILD);if(this.resourcesService.decreaseResources(e.getCost(),"Construction",!0,t)){e.buildOnMountain()?this.landService.decreaseMountains(e.getSize()*t):this.landService.decreaseLand(e.getSize()*t);for(var i=0;i<t;i++)switch(this.region){case Yv.VILLAGE:this.villageService.createConstruction(new fE(this.servicesService,this.servicesService.getIdService().getNextId(),Yv.VILLAGE,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Yv.FORT:this.fortService.createConstruction(new fE(this.servicesService,this.servicesService.getIdService().getNextId(),Yv.FORT,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Yv.FOREST:this.forestService.createConstruction(new fE(this.servicesService,this.servicesService.getIdService().getNextId(),Yv.FOREST,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Yv.FIELD:this.fieldService.createConstruction(new fE(this.servicesService,this.servicesService.getIdService().getNextId(),Yv.FIELD,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Yv.MOUNTAINS:this.mountainsService.createConstruction(new fE(this.servicesService,this.servicesService.getIdService().getNextId(),Yv.MOUNTAINS,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Yv.SEA:this.seaService.createConstruction(new fE(this.servicesService,this.servicesService.getIdService().getNextId(),Yv.SEA,e.getBuildingType(),e.getComplexity(),e.getSize()).build());break;case Yv.PLATEAU:this.plateauService.createConstruction(new fE(this.servicesService,this.servicesService.getIdService().getNextId(),Yv.PLATEAU,e.getBuildingType(),e.getComplexity(),e.getSize()).build())}this.modalService.close(_v.BUILD)}else this.modalService.close(_v.BUILD)}},{key:"ngOnChanges",value:function(e){this.regionString=Yv[this.region]}},{key:"checkBuilding",value:function(e,t){var i=this,n=!0;return e[1].forEach(function(e){i.gameService.isEnabled(e)||(n=!1)}),e[2]>0&&e[2]<=this.servicesService.getServiceByRegion(t).getBuildings().filter(function(t){return t.getBuildingType()===e[0].getBuildingType()||t.getBuildingType()===Pv.CONSTRUCTION&&t.getWorkingAt()===e[0].getBuildingType()}).length&&(n=!1),n}},{key:"hasResource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 0===this.resourcesService.hasResource(e.key,e.value*t,"Construction",!0)}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"getBuildingCostEntries",value:function(e){return e.getCost()}},{key:"getBuildingForRegion",value:function(e){var t=this;if(this.buildings&&this.buildings.get(e)){var i=this.buildings.get(e).filter(function(i){return t.checkBuilding(i,e)}).map(function(e){return e[0]});if(e===Yv.PLATEAU){if(this.gameService.getAbdicationLevel()<this.servicesService.getServiceByRegion(e).getBuildings().length)return[];this.gameService.getAbdicationLevel()<7&&(i=i.filter(function(e){return e.getBuildingType()!==Pv.ASCENSION_TEMPLE}))}return null!==this.filterText&&this.filterText.length>0?i.filter(function(e){return e.getName().toLowerCase().includes(t.filterText.toLowerCase())}):i}}},{key:"isCostMet",value:function(e){var t=this,i=!0,n=this.getNumberToBuild(e);return Array.from(e.getCost().entries()).forEach(function(e){0!==t.resourcesService.hasResource(e[0],e[1]*n,"Construction",!0)&&(i=!1)}),i&&(i=e.buildOnMountain()?this.hasMountains(e.getSize()*n):this.hasLand(e.getSize()*n)),i}},{key:"hasLand",value:function(e){return this.landService.hasLand(e)}},{key:"hasMountains",value:function(e){return this.landService.getMountains()>=e}},{key:"getLimit",value:function(e,t){var i=this.buildings.get(e).find(function(e){return e[0].getBuildingType()===t});return i?i[2]:0}},{key:"hasInputOutputDescription",value:function(e){return this.getBuildingSettings(e).INPUT_RESOURCES}},{key:"getBuildingSettings",value:function(e){return um.getBuilding(e)}},{key:"hasCanProduceDescription",value:function(e){return this.getBuildingSettings(e).CAN_PRODUCE}},{key:"getNumberToBuild",value:function(e){var t=this.buildings.get(this.region).find(function(t){return t[0].getBuildingType()===e.getBuildingType()});if(0===t[2])return Math.trunc(this.multiplier);var i=this.servicesService.getServiceByRegion(this.region).getBuildings().filter(function(e){return e.getBuildingType()===t[0].getBuildingType()||e.getBuildingType()===Pv.CONSTRUCTION&&e.getWorkingAt()===t[0].getBuildingType()}).length;return t[2]-i<this.multiplier?t[2]-i:Math.trunc(this.multiplier)}},{key:"verifyMultiplier",value:function(){null!==this.multiplier&&(this.multiplier=Math.trunc(this.multiplier),0===this.multiplier&&(this.multiplier=1))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(PR),Bs($v),Bs(Jv),Bs(Cm),Bs(DE),Bs(wm),Bs(MR),Bs(QC),Bs(Hb),Bs(yb),Bs(iC),Bs(bC),Bs(_N),Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-construction"]],viewQuery:function(e,t){var i;(1&e&&rc(XP,5),2&e)&&(nc(i=sc())&&(t.filterInputRef=i.first))},inputs:{region:"region",clearFilterObservable:"clearFilterObservable",openEvent:"openEvent"},features:[Rt],decls:11,vars:6,consts:[["id","wrapper"],["id","title"],["id","filters"],["type","text",3,"ngModel","ngModelChange"],["filterInput",""],[4,"ngIf"],["id","buildings"],["class","building",4,"ngFor","ngForOf"],["id","multiplierInput","type","number","min","1","step","1",3,"ngModel","keyup","ngModelChange"],["id","multiplierReset",3,"click"],[1,"building"],[1,"buildingSecondRow"],[1,"buildingTitle"],[1,"details"],["id","description",3,"innerHTML"],["class","productionDescription",4,"ngIf"],[1,"subTitle"],[4,"ngFor","ngForOf"],["class","buildButton",3,"click",4,"ngIf"],["class","buildButtonNotAvailable",3,"disabled","click",4,"ngIf"],[1,"productionDescription"],["class","icon",4,"ngFor","ngForOf"],[1,"icon"],[3,"name","path"],[3,"ngClass"],[3,"name"],[1,"buildButton",3,"click"],[1,"buildButtonNotAvailable",3,"disabled","click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),ha(2),Hu(3,"titlecase"),Ys(),zs(4,"span",2),ha(5,"Search: "),zs(6,"input",3,4),$s("ngModelChange",function(e){return t.filterText=e}),Ys(),Gs(8,ZP,5,1,"span",5),Ys(),zs(9,"div",6),Gs(10,hM,18,13,"div",7),Ys(),Ys()),2&e&&(ho(2),ga(" ",Gu(3,4,t.regionString)," buildings "),ho(4),Ws("ngModel",t.filterText),ho(2),Ws("ngIf",t.region!==t.regions.PLATEAU),ho(2),Ws("ngForOf",t.getBuildingForRegion(t.region)))},directives:[qR,vO,DO,Gl,Ul,tT,xO,oT,xl],pipes:[ql,Xl],styles:[".notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.5em;margin-bottom:10px}#filters[_ngcontent-%COMP%]{display:inline-block;width:100%;margin-bottom:5px;border-bottom:black solid 2px}#filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block}#buildings[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;overflow-y:scroll;height:70vh}.building[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 1px;margin-bottom:10px}.buildingTitle[_ngcontent-%COMP%]{font-weight:600;background-color:var(--active-colour);border-bottom:black solid 1px}.buildingSecondRow[_ngcontent-%COMP%]{display:flex;width:100%;border-right:black solid 1px;flex-direction:column}.buildButton[_ngcontent-%COMP%]{width:30%}.buildButtonNotAvailable[_ngcontent-%COMP%]{width:30%;cursor:not-allowed}.details[_ngcontent-%COMP%]{width:100%;text-align:center}.resourceIcon[_ngcontent-%COMP%]{height:20px;width:20px;vertical-align:middle}#description[_ngcontent-%COMP%]{margin-bottom:10px}.icon[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;align-items:center;justify-content:center;margin-right:10px}.subTitle[_ngcontent-%COMP%]{font-size:1em;font-weight:bold}.productionDescription[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-bottom:5px}.productionDescription[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:5px}#actions[_ngcontent-%COMP%]{display:flex;flex-direction:column}#multiplierInput[_ngcontent-%COMP%]{width:5ch}#multiplierReset[_ngcontent-%COMP%]{padding:2px}"]}),e}(),gM=["body"],fM=function(){var e=function(){function e(t){var i=this;p(this,e),this.modalService=t,this.constructionOpenEventEmitter=new Yu,this.clearFilterSubject=new U,this.modalService.registerForRegion().subscribe(function(e){i.region=e,i.clearFilterSubject.next()}),this.modalService.registerForOnOpen().subscribe(function(e){e===_v.BUILD&&(i.bodyRef.nativeElement.scrollTop=0,i.constructionOpenEventEmitter.next())})}return S(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-build-modal"]],viewQuery:function(e,t){var i;(1&e&&rc(gM,5),2&e)&&(nc(i=sc())&&(t.bodyRef=i.first))},decls:6,vars:3,consts:[["id","build-modal"],[1,"modal"],[1,"modal-body"],["body",""],[3,"openEvent","clearFilterObservable","region"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2,3),js(4,"app-construction",4),Ys(),Ys(),js(5,"div",5),Ys()),2&e&&(ho(4),Ws("openEvent",t.constructionOpenEventEmitter.asObservable())("clearFilterObservable",t.clearFilterSubject.asObservable())("region",t.region))},directives:[qP,dM],styles:[""]}),e}(),vM=function e(t,i){p(this,e),this.message=t,this.fullError=i},pM=function(){var e=function(){function e(t,i,n,r,o,s,a){var u=this;p(this,e),this.servicesService=t,this.calendarService=i,this.logService=n,this.idService=r,this.mountainService=o,this.resourcesService=s,this.villageService=a,this.gameService=null,this.gameService=t.getGameService(),i.registerForDayChange().subscribe(function(e){u.checkEvents()})}return S(e,[{key:"checkEvents",value:function(){var e=this;Object.values(Sm).forEach(function(t){var i=!0;if(t.PREREQUISITES.forEach(function(t){e.gameService.isEnabled(t)||(i=!1)}),i&&sp.chance(t.CHANCE)){e.logService.customLog(t.LOG.MESSAGE,t.LOG.LOG_TYPE);var n=sp.randomBetween(t.MIN_POWER,t.MAX_POWER);switch(t.EVENT){case cp.METEORITE:var r=sp.randomElement([{item:Mv.STONE,chance:35},{item:Mv.COPPER_ORE,chance:30},{item:Mv.TIN_ORE,chance:20},{item:Mv.GOLD_ORE,chance:5},{item:Mv.SILVER_ORE,chance:5},{item:Mv.IRON_ORE,chance:5}]);null===r&&(r=Mv.STONE),e.mountainService.buildings.push(new gR(e.servicesService,e.idService.getNextId(),n,r));break;case cp.SMALL_REFUGEE:case cp.MEDIUM_REFUGEE:e.addVillagers(n)}}})}},{key:"addVillagers",value:function(e){this.servicesService.getVillageService().addVillagers(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v),An(Im),An(Cm),An(wR),An(iC),An(DE),An(MR))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),mM=function(){var e=function(){function e(t,i,n,r,o,s,a,u,c,l,h,d,g,f,v,m,S,E,y,R,O){var T=this;p(this,e),this.logService=t,this.villageService=i,this.fortService=n,this.fieldService=r,this.mountainsService=o,this.plateauService=s,this.seaService=a,this.forestService=u,this.calendarService=c,this.landService=l,this.techService=h,this.weatherService=d,this.resourcesService=g,this.gameService=f,this.effectsService=v,this.armyService=m,this.happinessService=S,this.worldService=E,this.servicesService=y,this.navyService=R,this.eventService=O,this.tickerState=0,this.lastTick=0,this.paused=!1,this.ticking=!1,this.resolution=750,y.addService(Zv.TICKER,this),this.tickSubject=new U,this.interval=setInterval(function(){return T.tick()},this.resolution)}return S(e,[{key:"tick",value:function(){if(!this.ticking){this.ticking=!0;var e=Math.floor(Date.now()/this.resolution);if(this.tickerState>=0){this.lastTick=e;try{this.calendarService.tick(e),this.effectsService.tick(e),this.weatherService.tick(e),this.happinessService.tick(e),this.landService.tick(e),this.resourcesService.tick(e),this.gameService.tick(e),this.villageService.tick(e),this.fortService.tick(e),this.fieldService.tick(e),this.mountainsService.tick(e),this.plateauService.tick(e),this.seaService.tick(e),this.forestService.tick(e),this.armyService.tick(e),this.navyService.tick(e),this.worldService.tick(e)}catch(t){this.logService.warning("Game paused due to the internal error: "+t.name),this.logService.errorReport(new vM("Game paused due to the internal error: "+t.name,t.name+": "+t.message+"\n"+t.stack)),console.error(t),this.pause()}}this.ticking=!1}}},{key:"stop",value:function(){return this.tickerState-=1,this.lastTick}},{key:"start",value:function(){this.tickerState+=1,this.tickerState>0&&(this.tickerState=0)}},{key:"forceStart",value:function(){this.tickerState=0}},{key:"clearTicker",value:function(){clearInterval(this.interval)}},{key:"initTicker",value:function(){var e=this;this.interval=setInterval(function(){return e.tick()},this.resolution)}},{key:"pause",value:function(){this.stop(),this.paused=!0}},{key:"resume",value:function(){this.forceStart(),this.paused=!1}},{key:"isPaused",value:function(){return this.paused}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Cm),An(MR),An(QC),An(Hb),An(iC),An(_N),An(bC),An(yb),An(Im),An(wm),An(zI),An(vk),An(DE),An(_m),An(Am),An(KC),An(_E),An(G_),An($v),An(kC),An(pM))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),SM=function e(){p(this,e)},EM=function e(){p(this,e)},yM=function(){function e(t){var i=this;p(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){i.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var n=e.slice(0,t),r=n.toLowerCase(),o=e.slice(t+1).trim();i.maybeSetNormalizedName(n,r),i.headers.has(r)?i.headers.get(r).push(o):i.headers.set(r,[o])}})}:function(){i.headers=new Map,Object.keys(t).forEach(function(e){var n=t[e],r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(i.headers.set(r,n),i.maybeSetNormalizedName(e,r))})}:this.headers=new Map}return S(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(i){t.headers.set(i,e.headers.get(i)),t.normalizedNames.set(i,e.normalizedNames.get(i))})}},{key:"clone",value:function(t){var i=new e;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([t]),i}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,i(n)),this.headers.set(t,r);break;case"d":var o=e.value;if(o){var s=this.headers.get(t);if(!s)return;0===(s=s.filter(function(e){return-1===o.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(i){return e(t.normalizedNames.get(i),t.headers.get(i))})}}]),e}(),RM=function(){function e(){p(this,e)}return S(e,[{key:"encodeKey",value:function(e){return OM(e)}},{key:"encodeValue",value:function(e){return OM(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function OM(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}function TM(e){return"".concat(e)}var IM=function(){function e(){var i=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(p(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new RM,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,i){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),o=t(-1==r?[i.decodeKey(e),""]:[i.decodeKey(e.slice(0,r)),i.decodeValue(e.slice(r+1))],2),s=o[0],a=o[1],u=n.get(s)||[];u.push(a),n.set(s,u)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var t=n.fromObject[e];i.map.set(e,Array.isArray(t)?t:[t])})):this.map=null}return S(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(i){var n=e[i];Array.isArray(n)?n.forEach(function(e){t.push({param:i,value:e,op:"a"})}):t.push({param:i,value:n,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var i=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return i+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var i=new e({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(t),i}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var i=("a"===t.op?e.map.get(t.param):void 0)||[];i.push(TM(t.value)),e.map.set(t.param,i);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var n=e.map.get(t.param)||[],r=n.indexOf(TM(t.value));-1!==r&&n.splice(r,1),n.length>0?e.map.set(t.param,n):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),bM=function(){function e(){p(this,e),this.map=new Map}return S(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function CM(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function AM(e){return"undefined"!=typeof Blob&&e instanceof Blob}function kM(e){return"undefined"!=typeof FormData&&e instanceof FormData}var NM=function(){function e(t,i,n,r){var o;if(p(this,e),this.url=i,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,o=r):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new yM),this.context||(this.context=new bM),this.params){var s=this.params.toString();if(0===s.length)this.urlWithParams=i;else{var a=i.indexOf("?");this.urlWithParams=i+(-1===a?"?":a<i.length-1?"&":"")+s}}else this.params=new IM,this.urlWithParams=i}return S(e,[{key:"serializeBody",value:function(){return null===this.body?null:CM(this.body)||AM(this.body)||kM(this.body)||function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof IM?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||kM(this.body)?null:AM(this.body)?this.body.type||null:CM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof IM?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.method||this.method,r=i.url||this.url,o=i.responseType||this.responseType,s=void 0!==i.body?i.body:this.body,a=void 0!==i.withCredentials?i.withCredentials:this.withCredentials,u=void 0!==i.reportProgress?i.reportProgress:this.reportProgress,c=i.headers||this.headers,l=i.params||this.params,h=null!==(t=i.context)&&void 0!==t?t:this.context;return void 0!==i.setHeaders&&(c=Object.keys(i.setHeaders).reduce(function(e,t){return e.set(t,i.setHeaders[t])},c)),i.setParams&&(l=Object.keys(i.setParams).reduce(function(e,t){return e.set(t,i.setParams[t])},l)),new e(n,r,s,{params:l,headers:c,context:h,reportProgress:u,responseType:o,withCredentials:a})}}]),e}(),_M=((_M=_M||{})[_M.Sent=0]="Sent",_M[_M.UploadProgress=1]="UploadProgress",_M[_M.ResponseHeader=2]="ResponseHeader",_M[_M.DownloadProgress=3]="DownloadProgress",_M[_M.Response=4]="Response",_M[_M.User=5]="User",_M),wM=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";p(this,e),this.headers=t.headers||new yM,this.status=void 0!==t.status?t.status:i,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300},PM=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p(this,i),(e=t.call(this,n)).type=_M.ResponseHeader,e}return S(i,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new i({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),i}(wM),MM=function(e){c(i,e);var t=h(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p(this,i),(e=t.call(this,n)).type=_M.Response,e.body=void 0!==n.body?n.body:null,e}return S(i,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new i({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),i}(wM),DM=function(e){c(i,e);var t=h(i);function i(e){var n;return p(this,i),(n=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",n.ok=!1,n.message=n.status>=200&&n.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),n.error=e.error||null,n}return i}(wM);function LM(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var xM=function(){var e=function(){function e(t){p(this,e),this.handler=t}return S(e,[{key:"request",value:function(e,t){var i,n,r,o=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof NM?i=e:(n=s.headers instanceof yM?s.headers:new yM(s.headers),s.params&&(r=s.params instanceof IM?s.params:new IM({fromObject:s.params})),i=new NM(e,t,void 0!==s.body?s.body:null,{headers:n,context:s.context,params:r,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials}));var a=Lh(i).pipe(hd(function(e){return o.handler.handle(e)}));if(e instanceof NM||"events"===s.observe)return a;var u=a.pipe(od(function(e){return e instanceof MM}));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return u.pipe(B(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(B(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(B(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return u.pipe(B(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(s.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new IM).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,LM(i,t))}},{key:"post",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,LM(i,t))}},{key:"put",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,LM(i,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(SM))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),FM=function(){function e(t,i){p(this,e),this.next=t,this.interceptor=i}return S(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),UM=new an("HTTP_INTERCEPTORS"),HM=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),GM=/^\)\]\}',?\n/,BM=function(){var e=function(){function e(t){p(this,e),this.xhrFactory=t}return S(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new M(function(i){var n=t.xhrFactory.build();if(n.open(e.method,e.urlWithParams),e.withCredentials&&(n.withCredentials=!0),e.headers.forEach(function(e,t){return n.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var r=e.detectContentTypeHeader();null!==r&&n.setRequestHeader("Content-Type",r)}if(e.responseType){var o=e.responseType.toLowerCase();n.responseType="json"!==o?o:"text"}var s=e.serializeBody(),a=null,u=function(){if(null!==a)return a;var t=1223===n.status?204:n.status,i=n.statusText||"OK",r=new yM(n.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(n)||e.url;return a=new PM({headers:r,status:t,statusText:i,url:o})},c=function(){var t=u(),r=t.headers,o=t.status,s=t.statusText,a=t.url,c=null;204!==o&&(c=void 0===n.response?n.responseText:n.response),0===o&&(o=c?200:0);var l=o>=200&&o<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(GM,"");try{c=""!==c?JSON.parse(c):null}catch(d){c=h,l&&(l=!1,c={error:d,text:c})}}l?(i.next(new MM({body:c,headers:r,status:o,statusText:s,url:a||void 0})),i.complete()):i.error(new DM({error:c,headers:r,status:o,statusText:s,url:a||void 0}))},l=function(e){var t=u().url,r=new DM({error:e,status:n.status||0,statusText:n.statusText||"Unknown Error",url:t||void 0});i.error(r)},h=!1,d=function(t){h||(i.next(u()),h=!0);var r={type:_M.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(r.total=t.total),"text"===e.responseType&&!!n.responseText&&(r.partialText=n.responseText),i.next(r)},g=function(e){var t={type:_M.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),i.next(t)};return n.addEventListener("load",c),n.addEventListener("error",l),n.addEventListener("timeout",l),n.addEventListener("abort",l),e.reportProgress&&(n.addEventListener("progress",d),null!==s&&n.upload&&n.upload.addEventListener("progress",g)),n.send(s),i.next({type:_M.Sent}),function(){n.removeEventListener("error",l),n.removeEventListener("abort",l),n.removeEventListener("load",c),n.removeEventListener("timeout",l),e.reportProgress&&(n.removeEventListener("progress",d),null!==s&&n.upload&&n.upload.removeEventListener("progress",g)),n.readyState!==n.DONE&&n.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(oh))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),WM=new an("XSRF_COOKIE_NAME"),VM=new an("XSRF_HEADER_NAME"),zM=function e(){p(this,e)},YM=function(){var e=function(){function e(t,i,n){p(this,e),this.doc=t,this.platform=i,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return S(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ll(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(cl),An(pc),An(WM))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),jM=function(){var e=function(){function e(t,i){p(this,e),this.tokenService=t,this.headerName=i}return S(e,[{key:"intercept",value:function(e,t){var i=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||i.startsWith("http://")||i.startsWith("https://"))return t.handle(e);var n=this.tokenService.getToken();return null!==n&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,n)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(zM),An(VM))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),KM=function(){var e=function(){function e(t,i){p(this,e),this.backend=t,this.injector=i,this.chain=null}return S(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(UM,[]);this.chain=t.reduceRight(function(e,t){return new FM(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(EM),An(Ts))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),QM=function(){var e=function(){function e(){p(this,e)}return S(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:jM,useClass:HM}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:WM,useValue:t.cookieName}:[],t.headerName?{provide:VM,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({providers:[jM,{provide:UM,useExisting:jM,multi:!0},{provide:zM,useClass:YM},{provide:WM,useValue:"XSRF-TOKEN"},{provide:VM,useValue:"X-XSRF-TOKEN"}]}),e}(),qM=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({providers:[xM,{provide:SM,useClass:KM},BM,{provide:EM,useExisting:BM}],imports:[[QM.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),XM=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),ZM=function(){function e(t,i,n,r){p(this,e),this.waitFor=t,this.absoluteTimeout=i,this.withObservable=n,this.scheduler=r}return S(e,[{key:"call",value:function(e,t){return t.subscribe(new $M(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}]),e}(),$M=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s){var a;return p(this,i),(a=t.call(this,e)).absoluteTimeout=n,a.waitFor=r,a.withObservable=o,a.scheduler=s,a.scheduleTimeout(),a}return S(i,[{key:"scheduleTimeout",value:function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(i.dispatchTimeout,this.waitFor,this))}},{key:"_next",value:function(e){this.absoluteTimeout||this.scheduleTimeout(),u(v(i.prototype),"_next",this).call(this,e)}},{key:"_unsubscribe",value:function(){this.action=void 0,this.scheduler=null,this.withObservable=null}}],[{key:"dispatchTimeout",value:function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(J(t,new Z(e)))}}]),i}($);function JM(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jm;return function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jm;return function(n){var r=function(e){return e instanceof Date&&!isNaN(+e)}(e),o=r?+e-i.now():Math.abs(e);return n.lift(new ZM(o,r,t,i))}}(e,uS(new XM),t)}var eD=function(){var e=function(){function e(t,i,n){p(this,e),this.http=t,this.logService=i,this.modalService=n,this.serverUrl="https://villagerkings.com/api/"}return S(e,[{key:"cloudSave",value:function(e,t,i,n,r){var o=this,s={headers:(new yM).append("Content-Type","application/json").append("Access-Control-Allow-Origin","*")},a={};return a.userId=e,a.gameAuthToken=t,a.save=i,a.day=n,a.year=r,this.http.post(this.serverUrl+"save",a,s).pipe(JM(15e3),ud(function(e){return o.handleError(e)}))}},{key:"cloudLoad",value:function(e,t){var i=this,n={headers:(new yM).append("Content-Type","application/json").append("Access-Control-Allow-Origin","*"),observe:"response",responseType:"text"},r={};return r.userId=e,r.gameAuthToken=t,this.http.post(this.serverUrl+"load",r,n).pipe(JM(15e3),ud(function(e){return i.handleError(e)}))}},{key:"cloudCheck",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r={headers:(new yM).append("Content-Type","application/json").append("Access-Control-Allow-Origin","*"),observe:"response"},o={};return o.userId=i,o.gameAuthToken=n,this.http.post(this.serverUrl+"hasSave",o,r).pipe(JM(5e3),ud(function(i){return e.handleError(i,!t)}))}},{key:"handleError",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e instanceof DM?401===e.status?(t?this.modalService.info("Couldn't authorize server call via Kongregate API"):this.logService.warning("Couldn't authorize server call via Kongregate API"),Yh):(console.log("error",e),e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error("Backend returned code ".concat(e.status)),t&&this.modalService.info("Something bad happened; please try again later."),uS("Something bad happened; please try again later.")):e instanceof XM?(t?this.modalService.info("Server request has timed out"):this.logService.warning("Server request has timed out"),Yh):void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(xM),An(Cm),An(Jv))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),tD=function(){var e=function(){function e(t,i,n,r,o,s,a,u,c,l,h,d,g,f,v,m,S,E,y,R,O,T,I,b,C,A,k,N,_,w,P,M,D,L,x){var F=this;p(this,e),this.router=t,this.tickerService=i,this.gameService=n,this.modalService=r,this.optionsService=o,this.logService=s,this.villageService=a,this.forestService=u,this.resourcesService=c,this.landService=l,this.mountainsService=h,this.calendarService=d,this.royalService=g,this.techService=f,this.religionService=v,this.craftingService=m,this.recipeService=S,this.fieldService=E,this.plateauService=y,this.seaService=R,this.fortService=O,this.effectsService=T,this.armyService=I,this.happinessService=b,this.managementService=C,this.marketService=A,this.weatherService=k,this.idService=N,this.heritageService=_,this.tutorialService=w,this.worldService=P,this.kongregateService=M,this.serverService=D,this.navyService=L,this.saveName=Cp.saveName,this.saveVersion=Cp.saveVersion,x.addService(Zv.SERIALIZER,this),this.autoSaveStatus=this.optionsService.getOption(Xv.AUTO_SAVE_STATUS),this.autoSavePeriod=this.optionsService.getOption(Xv.AUTO_SAVE_PERIOD),this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(function(){return F.changeOptions()})),this.saveInterval=setInterval(function(){F.initSave(),F.logService.autoSave()},this.autoSavePeriod)}return S(e,[{key:"changeOptions",value:function(){var e=this,t=this.optionsService.getOption(Xv.AUTO_SAVE_STATUS),i=this.optionsService.getOption(Xv.AUTO_SAVE_PERIOD);(this.autoSaveStatus!==t||this.autoSavePeriod!==i)&&(this.autoSaveStatus=t,this.autoSavePeriod=i,clearInterval(this.saveInterval),this.autoSaveStatus&&(this.saveInterval=setInterval(function(){e.initSave(),e.logService.autoSave()},1e3*this.autoSavePeriod*60)))}},{key:"initSave",value:function(){this.tickerService.stop(),localStorage.setItem(this.saveName,this.prepareBase64()),this.tickerService.start()}},{key:"prepareBase64",value:function(){this.tickerService.stop();var e=btoa(JSON.stringify({saveVersion:this.saveVersion,heritage:this.heritageService.save(),id:this.idService,options:this.optionsService.save(),tutorial:this.tutorialService.save(),resources:this.resourcesService.save(),village:this.villageService.save(),fort:this.fortService.save(),forest:this.forestService.save(),field:this.fieldService.save(),mountains:this.mountainsService.save(),plateau:this.plateauService.save(),sea:this.seaService.save(),land:this.landService.save(),calendar:this.calendarService.save(),game:this.gameService.save(),royal:this.royalService.save(),tech:this.techService.save(),religion:this.religionService.save(),crafting:this.craftingService.save(),recipe:this.recipeService.save(),effects:this.effectsService.save(),army:this.armyService.save(),world:this.worldService.save(),happiness:this.happinessService.save(),management:this.managementService.save(),market:this.marketService.save(),navy:this.navyService.save(),weather:this.weatherService.save(),logs:this.logService.save()}));return this.tickerService.start(),e}},{key:"initLoad",value:function(){if(this.tickerService.stop(),null===localStorage.getItem(this.saveName))return this.modalService.info("There is no any save file to load."),void this.tickerService.start();var e;try{e=JSON.parse(atob(localStorage.getItem(this.saveName)))}catch(t){return this.modalService.info("Save data is corrupted! Loading failed."),void this.tickerService.start()}this.loadSave(e),this.tickerService.start(),this.logService.log("loaded")}},{key:"hasSave",value:function(){return null!=localStorage.getItem(this.saveName)}},{key:"import",value:function(e){var t;this.tickerService.stop();try{t=JSON.parse(atob(e))}catch(i){return this.modalService.info("Import file is not valid or corrupted! Import failed."),void this.tickerService.start()}this.loadSave(t),localStorage.setItem(this.saveName,e),this.tickerService.start(),this.logService.log("save imported")}},{key:"hardReset",value:function(){this.reset(!0),localStorage.removeItem(this.saveName)}},{key:"ascensionReset",value:function(){this.reset(!1,!0)}},{key:"reset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.tickerService.stop(),this.tickerService.clearTicker(),localStorage.removeItem(this.saveName),this.tutorialService.reset(e,t),this.calendarService.reset(e,t),this.gameService.reset(e,t),this.idService.reset(e,t),this.weatherService.reset(e,t),this.effectsService.reset(e,t),this.resourcesService.reset(e,t),this.landService.reset(e,t),this.navyService.reset(e,t),this.villageService.reset(e,t),this.fortService.reset(e,t),this.forestService.reset(e,t),this.fieldService.reset(e,t),this.mountainsService.reset(e,t),this.plateauService.reset(e,t),this.seaService.reset(e,t),this.optionsService.reset(e,t),this.techService.reset(e,t),this.religionService.reset(e,t),this.craftingService.reset(e,t),this.recipeService.reset(e,t),this.armyService.reset(e,t),this.worldService.reset(e,t),this.happinessService.reset(e,t),this.managementService.reset(e,t),this.marketService.reset(e,t),this.heritageService.reset(e,t),this.logService.reset(e,t),this.royalService.reset(e,t),this.initSave(),this.tickerService.initTicker(),this.tickerService.start(),this.router.navigate(["/village"])}},{key:"loadSave",value:function(e){switch(e.saveVersion){case ep.DEV:case ep.V1_0_0:this.loadDevVersion(e);break;default:var t="Corrupted save file (unknown save version). Loading is not possible";return this.logService.log(t),void console.error(t)}}},{key:"loadDevVersion",value:function(e){this.saveVersion=e.saveVersion,this.safeLoad(this.idService,e.id),this.safeLoad(this.optionsService,e.options),this.safeLoad(this.logService,e.logs),this.safeLoad(this.effectsService,e.effects),this.safeLoad(this.resourcesService,e.resources),this.safeLoad(this.villageService,e.village),this.safeLoad(this.fortService,e.fort),this.safeLoad(this.forestService,e.forest),this.safeLoad(this.fieldService,e.field),this.safeLoad(this.mountainsService,e.mountains),this.safeLoad(this.plateauService,e.plateau),this.safeLoad(this.seaService,e.sea),this.safeLoad(this.landService,e.land),this.safeLoad(this.calendarService,e.calendar),this.safeLoad(this.gameService,e.game),this.safeLoad(this.royalService,e.royal),this.safeLoad(this.recipeService,e.recipe),this.safeLoad(this.techService,e.tech),this.safeLoad(this.religionService,e.religion),this.safeLoad(this.craftingService,e.crafting),this.safeLoad(this.armyService,e.army),this.safeLoad(this.worldService,e.world),this.safeLoad(this.navyService,e.navy),this.safeLoad(this.happinessService,e.happiness),this.safeLoad(this.managementService,e.management),this.safeLoad(this.marketService,e.market),this.safeLoad(this.weatherService,e.weather),this.safeLoad(this.heritageService,e.heritage),this.safeLoad(this.tutorialService,e.tutorial)}},{key:"safeLoad",value:function(e,t){try{e.load(void 0!==t?t:{})}catch(i){e!==this.royalService&&(this.logService.errorReport(new vM("Error ("+i.name+") while loading "+e.getName()+"! It will reset to default values",i.name+": "+i.message+"\n"+i.stack)),console.error(i),e.reset(!0,!0))}}},{key:"abdicate",value:function(e,t){this.reset(!1,!1),this.tickerService.stop(),this.tickerService.clearTicker(),e&&(this.landService.reset(!1,!1),this.worldService.reset(!0,!1)),this.tickerService.initTicker(),this.tickerService.start()}},{key:"getTimestamp",value:function(){return(new Date).getTime()}},{key:"cloudSave",value:function(e,t,i){var n=this;if(this.kongregateService.isGuest()&&!zc())this.modalService.info("You must be logged into kongregate to use cloud save");else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to upload save to cloud? Current cloud save will be overridden");var r=this.modalService.registerForConfirmation().subscribe(function(o){if(r.unsubscribe(),o){i.timestamp=n.getTimestamp(),e.status=!0,n.tickerService.stop();var s=n.prepareBase64(),a=n.calendarService.getDay(),u=n.calendarService.getYear();n.tickerService.start(),zc()?n.serverService.cloudSave(392444,"93ba2bd2f335d13f4c9a66447ae22d3db04670c596fd87b6e6424f870d9504b1",s,a,u).subscribe(function(e){n.logService.success("saved to cloud"),n.modalService.info("Saved to cloud!"),t.day=a,t.year=u}).add(function(){e.status=!1}):n.serverService.cloudSave(n.kongregateService.getUserId(),n.kongregateService.getGameAuthToken(),s,a,u).subscribe(function(e){n.logService.success("saved to cloud"),n.modalService.info("Saved to cloud!"),t.day=a,t.year=u}).add(function(){e.status=!1})}})}}},{key:"cloudLoad",value:function(e,t){var i=this;if(this.kongregateService.isGuest()&&!zc())this.modalService.info("You must be logged into kongregate to use cloud save");else{this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to download cloud save? Current game progress will be overridden");var n=this.modalService.registerForConfirmation().subscribe(function(r){n.unsubscribe(),r&&(t.timestamp=i.getTimestamp(),e.status=!0,zc()?i.serverService.cloudLoad(392444,"93ba2bd2f335d13f4c9a66447ae22d3db04670c596fd87b6e6424f870d9504b1").subscribe(function(e){204===e.status?i.modalService.info("There is no save file available on the server"):(i.import(e.body),i.modalService.info("Loaded save file from cloud"))}).add(function(){e.status=!1}):i.serverService.cloudLoad(i.kongregateService.getUserId(),i.kongregateService.getGameAuthToken()).subscribe(function(e){204===e.status?i.modalService.info("There is no save file available on the server"):(i.import(e.body),i.modalService.info("Loaded save file from cloud"))}).add(function(){e.status=!1}))})}}},{key:"cloudCheck",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.kongregateService.isGuest()&&!zc()?e||this.modalService.info("You must be logged into kongregate to use cloud save"):(n.timestamp=this.getTimestamp(),t.status=!0,zc()?this.serverService.cloudCheck(e,392444,"93ba2bd2f335d13f4c9a66447ae22d3db04670c596fd87b6e6424f870d9504b1").subscribe(function(e){204===e.status?i.day=-1:(i.day=e.body.day,i.year=e.body.year)},function(){i.day=-1}).add(function(){t.status=!1}):this.serverService.cloudCheck(e,this.kongregateService.getUserId(),this.kongregateService.getGameAuthToken()).subscribe(function(e){204===e.status?i.day=-1:(i.day=e.body.day,i.year=e.body.year)},function(){i.day=-1}).add(function(){t.status=!1}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(sv),An(mM),An(_m),An(Jv),An(Om),An(Cm),An(MR),An(yb),An(DE),An(wm),An(iC),An(Im),An(PE),An(zI),An(AA),An(jk),An(Yk),An(Hb),An(_N),An(bC),An(QC),An(Am),An(KC),An(_E),An(DR),An(sk),An(vk),An(wR),An(a_),An(Nm),An(G_),An(ME),An(eD),An(kC),An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),iD=function(){var e=function(){function e(t,i,n,r,o){var s=this;p(this,e),this.modalService=t,this.serializerService=i,this.heritageService=n,this.servicesService=r,this.gameService=o,this.resetWorld=!1,this.resetHeritage=!1,t.registerForOnOpen().subscribe(function(e){e===_v.ABDICATION&&(s.resetWorld=!1,s.resetHeritage=!1)}),t.registerForCloseModal().subscribe(function(e){(e===_v.ABDICATION||e===_v.ALL)&&s.modalService.sendAbdicationResult(!1)})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"abdicate",value:function(){var e=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to abdicate?");var t=this.modalService.registerForConfirmation().subscribe(function(i){t.unsubscribe(),i&&(e.modalService.sendAbdicationResult(!0),e.servicesService.getService(Zv.PLATEAU).getBuildings().forEach(function(e){e.getBuildingType()!==Pv.CONSTRUCTION&&e.forceAbdicate()}),e.serializerService.abdicate(e.resetWorld,e.resetHeritage),e.modalService.close(_v.ABDICATION))})}},{key:"cancel",value:function(){this.modalService.sendAbdicationResult(!1),this.modalService.close(_v.ABDICATION)}},{key:"calculateHeritagePoints",value:function(){return this.heritageService.calculateHeritagePoints()}},{key:"peopleToNextHeritagePoint",value:function(){return this.heritageService.peopleToNextHeritagePoint()}},{key:"getStartYear",value:function(){return this.gameService.getGameStartedYear()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(tD),Bs(a_),Bs($v),Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-abdication-modal"]],decls:38,vars:5,consts:[["id","abdication-modal"],[1,"modal"],[1,"modal-body"],["id","resetWorld","type","checkbox",3,"ngModel","ngModelChange"],["for","resetWorld"],["id","buttons"],["id","hardReset",3,"click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"h2"),ha(4,"Abdication"),Ys(),zs(5,"div"),ha(6," Are you sure you want to soft reset your progress? "),js(7,"br"),ha(8," You will start from the beginning and all progress except for:"),js(9,"br"),zs(10,"ul"),zs(11,"li"),ha(12,"Royal Points"),Ys(),zs(13,"li"),ha(14,"Heritage Points"),Ys(),zs(15,"li"),ha(16,"Wonder buildings and their effects"),Ys(),Ys(),ha(17," will be deleted."),js(18,"br"),js(19,"br"),ha(20),js(21,"br"),ha(22),js(23,"br"),js(24,"br"),ha(25),js(26,"br"),js(27,"br"),zs(28,"input",3),$s("ngModelChange",function(e){return t.resetWorld=e}),Ys(),zs(29,"label",4),ha(30,"reset world map progress"),Ys(),js(31,"br"),Ys(),zs(32,"div",5),zs(33,"button",6),$s("click",function(){return t.abdicate()}),ha(34,"ABDICATE"),Ys(),zs(35,"button",7),$s("click",function(){return t.cancel()}),ha(36,"CANCEL"),Ys(),Ys(),Ys(),Ys(),js(37,"div",8),Ys()),2&e&&(ho(20),fa(" You will be awarded ",t.calculateHeritagePoints().hp," Heritage Points and ",t.calculateHeritagePoints().xp," xp towards next point "),ho(2),ga(" (",t.peopleToNextHeritagePoint()," more people/xp needed for the next point)"),ho(3),ga(" You reign since the start of year ",t.getStartYear()," "),ho(3),Ws("ngModel",t.resetWorld))},directives:[qP,jR,vO,DO],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%}button[_ngcontent-%COMP%]{border:black solid 1px;color:#000;padding:1% 2%;text-align:center;text-decoration:none;display:inline-block;font-size:1em;margin:.5%}"]}),e}(),nD=function(e){return{selected:e}},rD=function(e){return{disabled:e}},oD=function(){var e=function(){function e(t){p(this,e),this.modalService=t,this.selectedMode=0}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.close(_v.ASCENSION)}},{key:"canAscend",value:function(){return!0}},{key:"ascend",value:function(){this.canAscend()&&this.modalService.close(_v.ASCENSION)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("ascension-modal").style.display&&(e.preventDefault(),this.ok())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-ascension-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:43,vars:12,consts:[["id","ascension-modal"],[1,"modal"],[1,"modal-body"],["id","modes"],[1,"mode",3,"ngClass","click"],[1,"title"],["src","assets/weather/snow.svg"],[1,"effect"],["src","assets/army/recruit.svg"],["src","assets/resources/food.svg"],["id","buttons"],[3,"ngClass"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"h2"),ha(4,"Ascension"),Ys(),zs(5,"div"),ha(6," Are you sure you want to ascend into a new world? "),js(7,"br"),js(8,"br"),Ys(),zs(9,"div"),ha(10," You will start from the beginning and all progress except for"),js(11,"br"),ha(12," royal points, heritage points and permanent royal upgrades will be deleted "),js(13,"br"),js(14,"br"),Ys(),zs(15,"div"),ha(16,"What world do you choose:"),Ys(),zs(17,"div",3),zs(18,"div",4),$s("click",function(){return t.selectedMode=0}),zs(19,"span",5),ha(20,"Winter"),Ys(),js(21,"img",6),zs(22,"span",7),ha(23,"cold severity +5%"),Ys(),Ys(),zs(24,"div",4),$s("click",function(){return t.selectedMode=1}),zs(25,"span",5),ha(26,"War"),Ys(),js(27,"img",8),zs(28,"span",7),ha(29,"enemy difficulty +5%"),Ys(),Ys(),zs(30,"div",4),$s("click",function(){return t.selectedMode=2}),zs(31,"span",5),ha(32,"Hunger"),Ys(),js(33,"img",9),zs(34,"span",7),ha(35,"food consumption +5%"),Ys(),Ys(),Ys(),js(36,"br"),zs(37,"div",10),zs(38,"button",11),ha(39,"ASCEND"),Ys(),zs(40,"button"),ha(41,"TURN BACK"),Ys(),Ys(),Ys(),Ys(),js(42,"div",12),Ys()),2&e&&(ho(18),Ws("ngClass",Du(4,nD,0===t.selectedMode)),ho(6),Ws("ngClass",Du(6,nD,1===t.selectedMode)),ho(6),Ws("ngClass",Du(8,nD,2===t.selectedMode)),ho(8),Ws("ngClass",Du(10,rD,!t.canAscend())))},directives:[qP,xl],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:100px auto auto}.lineBreak[_ngcontent-%COMP%]{display:block}#modes[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:10px}.mode[_ngcontent-%COMP%]{display:flex;cursor:pointer;flex-direction:column;height:150px;width:200px;border:black solid 1px;align-items:center;margin-right:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.mode[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px}.mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:bold}.mode[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{font-size:.8em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;white-space:nowrap}.disabled[_ngcontent-%COMP%]{color:#5a5a5a}.selected[_ngcontent-%COMP%]{border:black solid 3px}"]}),e}();function sD(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga("army size bonus: ",i.fightReport.attackerArmySizeBonus,"")}}function aD(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),fa("",n.getTroopName(i.troop),": ",i.size,"")}}function uD(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga("army size bonus: ",i.fightReport.defenderArmySizeBonus,"")}}function cD(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),fa("",n.getTroopName(i.troop),": ",i.size,"")}}var lD=function(e,t){return{won:e,lost:t}};function hD(e,t){if(1&e&&(zs(0,"div",14),zs(1,"div"),ha(2),Ys(),zs(3,"div",15),zs(4,"span",7),ha(5),zs(6,"span"),ha(7,"("),js(8,"img",16),ha(9),Ys(),Ys(),zs(10,"span"),ha(11,"vs"),Ys(),zs(12,"span",7),ha(13),js(14,"img",17),ha(15),Ys(),Ys(),Ys()),2&e){var i=t.$implicit,n=t.index,r=ta(2);ho(2),ga("Skirmish ",n+1,""),ho(2),Ws("ngClass",Lu(7,lD,i.result,!i.result)),ho(1),ga("",r.getTroopName(i.attackerTroop)," "),ho(4),ga("",r.round(i.attack),")"),ho(3),Ws("ngClass",Lu(10,lD,!i.result,i.result)),ho(1),ga("",r.getTroopName(i.defenderTroop)," ("),ho(2),ga("",r.round(i.defense),")")}}function dD(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta(2);ho(1),da(i.getAttackerName())}}function gD(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta(2);ho(1),da(i.getDefenderName())}}function fD(e,t){if(1&e&&(zs(0,"div"),ha(1),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(1),fa("",n.getTroopName(i.troop),": ",i.size,"")}}function vD(e,t){if(1&e){var i=qs();zs(0,"div",4),zs(1,"div",5),ha(2,"Fight Report"),Ys(),zs(3,"div"),ha(4),Ys(),zs(5,"div",6),zs(6,"div",7),ha(7,"ATTACKER"),js(8,"br"),ha(9),Ys(),zs(10,"div",7),ha(11,"DEFENDER"),js(12,"br"),ha(13),Ys(),Ys(),zs(14,"div",8),zs(15,"div"),ha(16,"Armies"),Ys(),zs(17,"div",6),zs(18,"div"),Gs(19,sD,2,1,"div",9),Gs(20,aD,2,2,"div",10),Ys(),zs(21,"div"),zs(22,"div"),ha(23),Ys(),Gs(24,uD,2,1,"div",9),Gs(25,cD,2,2,"div",10),Ys(),Ys(),Gs(26,hD,16,13,"div",11),zs(27,"div"),ha(28,"Winner army ("),Gs(29,dD,2,1,"span",9),Gs(30,gD,2,1,"span",9),ha(31,") "),Ys(),zs(32,"div",12),zs(33,"div"),Gs(34,fD,2,2,"div",10),Ys(),Ys(),Ys(),zs(35,"button",13),$s("click",function(){return Kt(i),ta().ok()}),ha(36,"close"),Ys(),Ys()}if(2&e){var n=ta();ho(4),da(n.fightReport.message),ho(2),Ws("ngClass",Lu(14,lD,n.fightReport.result,!n.fightReport.result)),ho(3),ga("",n.getAttackerName()," "),ho(1),Ws("ngClass",Lu(17,lD,!n.fightReport.result,n.fightReport.result)),ho(3),ga("",n.getDefenderName()," "),ho(6),Ws("ngIf",n.fightReport.attackerArmySizeBonus>0),ho(1),Ws("ngForOf",n.fightReport.attackerArmy.units),ho(3),ga("defense: ",n.fightReport.defense,""),ho(1),Ws("ngIf",n.fightReport.defenderArmySizeBonus>0),ho(1),Ws("ngForOf",n.fightReport.defenderArmy.units),ho(1),Ws("ngForOf",n.fightReport.skirmish),ho(3),Ws("ngIf",n.fightReport.result),ho(1),Ws("ngIf",!n.fightReport.result),ho(4),Ws("ngForOf",n.fightReport.armyAfterFight.units)}}var pD=function(){var e=function(){function e(t,i){var n=this;p(this,e),this.modalService=t,this.worldService=i,this.modalService.registerForFightReport().subscribe(function(e){return n.fightReport=e})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.fightReport=null,this.modalService.close(_v.FIGHT_REPORT)}},{key:"getAttackerName",value:function(){return this.fightReport.attacker===Vv.PLAYER?this.worldService.getPlayerCountry().name:Qv.prepareCountryName(this.fightReport.attacker)}},{key:"getDefenderName",value:function(){return this.fightReport.defender===Vv.PLAYER?this.worldService.getPlayerCountry().name:Qv.prepareCountryName(this.fightReport.defender)}},{key:"getTroopName",value:function(e){return Qv.prepareTroopName(e)}},{key:"round",value:function(e){return Qv.round(e,1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(G_))},e.\u0275cmp=it({type:e,selectors:[["app-fight-report-modal"]],decls:4,vars:1,consts:[["id","fight-report-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],[1,"section"],[3,"ngClass"],["id","reportBody"],[4,"ngIf"],[4,"ngFor","ngForOf"],["id","skirmishes",4,"ngFor","ngForOf"],[1,"sectionEnd"],[3,"click"],["id","skirmishes"],[1,"sectionFull"],["src","assets/army/attack.svg",1,"attdefIcon"],["src","assets/army/defense.svg",1,"attdefIcon"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),Gs(2,vD,37,20,"div",2),Ys(),js(3,"div",3),Ys()),2&e&&(ho(2),Ws("ngIf",t.fightReport))},directives:[qP,Gl,xl,Ul],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;font-size:1.2em}#title[_ngcontent-%COMP%]{font-weight:bold}#reportBody[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;overflow-y:auto}.section[_ngcontent-%COMP%]{width:80%;display:flex;flex-direction:row;text-align:center;border-bottom:black solid 2px}.section[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 50%;align-items:center}#skirmishes[_ngcontent-%COMP%]{width:80%;text-align:center}.sectionFull[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;text-align:center;border-bottom:black solid 2px}.sectionEnd[_ngcontent-%COMP%]{width:80%;display:flex;flex-direction:row;text-align:center;border-bottom:black solid 2px}.sectionEnd[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 100%}.sectionFull[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){flex:0 0 45%;align-items:center}.sectionFull[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){flex:0 0 10%;align-items:center}.sectionFull[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(3){flex:0 0 45%;align-items:center}.section[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{border-right:black solid 2px}.section[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{padding-bottom:10px}.won[_ngcontent-%COMP%]{color:var(--positive-colour)}.lost[_ngcontent-%COMP%]{color:var(--negative-colour)}.attdefIcon[_ngcontent-%COMP%]{height:15px}"]}),e}();function mD(e,t){1&e&&(zs(0,"div"),ha(1,"copied..."),Ys())}function SD(e,t){1&e&&(zs(0,"div"),js(1,"br"),Ys())}var ED=function(){var e=function(){function e(t,i){var n=this;p(this,e),this.serializerService=t,this.modalService=i,this.exportTextArea=null,this.showMessage=!1,this.modalService.registerForOnOpen().subscribe(function(e){e===_v.EXPORT&&n.export()})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"export",value:function(){this.exportTextArea=this.serializerService.prepareBase64()}},{key:"copy",value:function(){var e=this,t=this.exportTextArea,i=document.createElement("textarea");i.id="txt",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.opacity="0",i.value=t,document.body.appendChild(i),i.select();try{if(document.execCommand("copy"))return this.showMessage=!0,setTimeout(function(){return e.showMessage=!1},1500),!0}catch(n){console.error(bE.ERROR_1)}finally{document.body.removeChild(i)}return!1}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(tD),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-export-modal"]],decls:15,vars:3,consts:[["id","export-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["readonly","","id","export-area","rows","20","placeholder","Your save will be generated here..."],["id","buttons"],["id","import-button",3,"click"],["id","copy-button",3,"click"],[4,"ngIf"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"span",3),ha(4,"Export save"),Ys(),zs(5,"textarea",4),ha(6),Ys(),zs(7,"div",5),zs(8,"button",6),$s("click",function(){return t.export()}),ha(9,"Update"),Ys(),zs(10,"button",7),$s("click",function(){return t.copy()}),ha(11,"Copy to clipboard"),Ys(),Ys(),Gs(12,mD,2,0,"div",8),Gs(13,SD,2,0,"div",8),Ys(),Ys(),js(14,"div",9),Ys()),2&e&&(ho(6),da(t.exportTextArea),ho(6),Ws("ngIf",t.showMessage),ho(1),Ws("ngIf",!t.showMessage))},directives:[qP,Gl],styles:["#export-area[_ngcontent-%COMP%]{width:95%;resize:none}.modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%}#title[_ngcontent-%COMP%]{font-weight:800;margin-bottom:10px}"]}),e}(),yD=function(){var e=function(){function e(t,i){p(this,e),this.serializerService=t,this.modalService=i}return S(e,[{key:"ngOnInit",value:function(){}},{key:"import",value:function(){this.serializerService.import(this.importTextArea),this.importTextArea="",this.modalService.close(_v.IMPORT)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(tD),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-import-modal"]],decls:9,vars:1,consts:[["id","import-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["id","import-area","rows","20","placeholder","Paste your save here...",3,"ngModel","ngModelChange"],["id","import-button",3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"span",3),ha(4,"Import save"),Ys(),zs(5,"textarea",4),$s("ngModelChange",function(e){return t.importTextArea=e}),Ys(),zs(6,"button",5),$s("click",function(){return t.import()}),ha(7,"Import"),Ys(),Ys(),Ys(),js(8,"div",6),Ys()),2&e&&(ho(5),Ws("ngModel",t.importTextArea))},directives:[qP,qR,vO,DO],styles:["#import-area[_ngcontent-%COMP%]{width:95%;resize:none}.modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#title[_ngcontent-%COMP%]{font-weight:800;margin-bottom:10px}"]}),e}(),RD=function(){var e=function(){function e(t,i){p(this,e),this.modalService=t,this.serializerService=i}return S(e,[{key:"ngOnInit",value:function(){}},{key:"hardReset",value:function(){this.serializerService.hardReset(),this.modalService.close(_v.HARD_RESET)}},{key:"cancel",value:function(){this.modalService.close(_v.HARD_RESET)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(tD))},e.\u0275cmp=it({type:e,selectors:[["app-hard-reset-modal"]],decls:19,vars:0,consts:[["id","hard-reset-modal"],[1,"modal"],[1,"modal-body"],["id","buttons"],["id","hardReset",3,"click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"h2"),ha(4,"Hard Reset"),Ys(),zs(5,"div"),ha(6," Are you sure you want to hard reset your progress? "),js(7,"br"),ha(8," This will remove ALL progress and saved game (except settings and tutorial state). "),js(9,"br"),ha(10," You will still be able to load game from exported save. "),js(11,"br"),ha(12," This should only be done if you have backup save or want to start from the beginning. "),Ys(),zs(13,"div",3),zs(14,"button",4),$s("click",function(){return t.hardReset()}),ha(15,"HARD RESET"),Ys(),zs(16,"button",5),$s("click",function(){return t.cancel()}),ha(17,"CANCEL"),Ys(),Ys(),Ys(),Ys(),js(18,"div",6),Ys())},directives:[qP],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%}button[_ngcontent-%COMP%]{border:black solid 2px;color:#000;padding:1% 2%;text-align:center;text-decoration:none;display:inline-block;font-size:1em;margin:.5%}#hardReset[_ngcontent-%COMP%]{background-color:#5f0000;color:#fff}"]}),e}();function OD(e,t){1&e&&js(0,"div",28)}function TD(e,t){1&e&&(zs(0,"span"),ha(1,"No save file on the server"),Ys())}function ID(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta(3);ho(1),fa("save for day: ",i.saveFileMetadata.day,", year: ",i.saveFileMetadata.year,"")}}function bD(e,t){1&e&&js(0,"img",29)}function CD(e,t){1&e&&js(0,"div",28)}function AD(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"div"),ha(2,"Cloud saving (saving no longer available due to low use, cloud load will be removed soon as well)"),Ys(),zs(3,"button",6),$s("click",function(){return Kt(i),ta(2).cloudLoad()}),ha(4," Cloud load "),Gs(5,OD,1,0,"div",25),Ys(),zs(6,"div"),Gs(7,TD,2,0,"span",5),Gs(8,ID,2,2,"span",5),zs(9,"button",26),$s("click",function(){return Kt(i),ta(2).checkSave()}),Gs(10,bD,1,0,"img",27),Gs(11,CD,1,0,"div",25),Ys(),js(12,"br"),Ys(),Ys()}if(2&e){var n=ta(2);ho(5),Ws("ngIf",n.loadingLoader.status),ho(2),Ws("ngIf",n.saveFileMetadata.day<0),ho(1),Ws("ngIf",n.saveFileMetadata.day>0),ho(2),Ws("ngIf",!n.checkLoader.status),ho(1),Ws("ngIf",n.checkLoader.status)}}function kD(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"h4"),ha(2,"Game options"),Ys(),Gs(3,AD,13,5,"div",5),zs(4,"div",8),zs(5,"h4"),ha(6,"Game options"),Ys(),zs(7,"input",9),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().autoSaveStatus=e}),Ys(),zs(8,"label",10),ha(9,"auto save on/off "),Ys(),js(10,"br"),zs(11,"input",11),$s("change",function(){return Kt(i),ta().updateSaveOption()})("ngModelChange",function(e){return Kt(i),ta().autoSavePeriod=e}),Ys(),ha(12," minutes "),zs(13,"label",12),ha(14,"auto save period "),Ys(),js(15,"br"),zs(16,"input",13),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().metricStatus=e}),Ys(),zs(17,"label",14),ha(18,"use metric units"),Ys(),js(19,"br"),zs(20,"input",15),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().saveLogs=e}),Ys(),zs(21,"label",16),ha(22,"save logs (up to 100 entries)"),Ys(),js(23,"br"),zs(24,"input",17),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().pauseOnInit=e}),Ys(),zs(25,"label",18),ha(26,"pause the game on page refresh"),Ys(),js(27,"br"),zs(28,"input",19),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().keepReservationSettingsOnReset=e}),Ys(),zs(29,"label",20),ha(30,"Keep reservation settings active over resets and abdications"),Ys(),js(31,"br"),zs(32,"input",21),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().keepManagementSettingsOnReset=e}),Ys(),zs(33,"label",22),ha(34,"Keep management settings over resets and abdications"),Ys(),js(35,"br"),zs(36,"input",23),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().keepAutoTradeOnReset=e}),Ys(),zs(37,"label",24),ha(38,"Keep auto trade enabled after resets and abdications"),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(3),Ws("ngIf",n.isKongregate()),ho(4),Ws("ngModel",n.autoSaveStatus),ho(4),Ws("ngModel",n.autoSavePeriod),ho(5),Ws("ngModel",n.metricStatus),ho(4),Ws("ngModel",n.saveLogs),ho(4),Ws("ngModel",n.pauseOnInit),ho(4),Ws("ngModel",n.keepReservationSettingsOnReset),ho(4),Ws("ngModel",n.keepManagementSettingsOnReset),ho(4),Ws("ngModel",n.keepAutoTradeOnReset)}}function ND(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"h4"),ha(2,"Sound"),Ys(),zs(3,"div",8),zs(4,"h5"),ha(5,"Master"),Ys(),zs(6,"input",30),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().soundMaster=e}),Ys(),zs(7,"label",31),ha(8,"master sound on/off"),Ys(),js(9,"br"),zs(10,"label",32),ha(11),Ys(),zs(12,"div",33),zs(13,"input",34),$s("input",function(e){return Kt(i),ta().changeSoundMasterVolume(e)}),Ys(),Ys(),zs(14,"h5"),ha(15,"Music"),Ys(),zs(16,"input",35),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().soundMusic=e}),Ys(),zs(17,"label",36),ha(18,"music on/off"),Ys(),js(19,"br"),zs(20,"label",37),ha(21),Ys(),zs(22,"div",33),zs(23,"input",38),$s("input",function(e){return Kt(i),ta().changeSoundMusicVolume(e)}),Ys(),Ys(),zs(24,"h5"),ha(25,"Effects"),Ys(),zs(26,"input",39),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().soundEffects=e}),Ys(),zs(27,"label",40),ha(28,"effects on/off"),Ys(),js(29,"br"),zs(30,"label",41),ha(31),Ys(),zs(32,"div",33),zs(33,"input",42),$s("input",function(e){return Kt(i),ta().changeSoundEffectsVolume(e)}),Ys(),Ys(),js(34,"br"),zs(35,"input",43),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().soundEffectMarket=e}),Ys(),zs(36,"label",44),ha(37,"Play sound when merchant arrives"),Ys(),js(38,"br"),zs(39,"input",45),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().soundEffectResearch=e}),Ys(),zs(40,"label",46),ha(41,"Play sound when research is finished"),Ys(),js(42,"br"),zs(43,"input",47),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().soundEffectInvasion=e}),Ys(),zs(44,"label",48),ha(45,"Play sound when invasion is coming"),Ys(),js(46,"br"),zs(47,"input",49),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().soundEffectSeason=e}),Ys(),zs(48,"label",50),ha(49,"Play sound when season change"),Ys(),js(50,"br"),Ys(),Ys()}if(2&e){var n=ta();ho(6),Ws("ngModel",n.soundMaster),ho(5),ga("master sound volume ",n.getSoundMasterVolume(),"% "),ho(2),Ws("value",n.getSoundMasterVolume()),ho(3),Ws("ngModel",n.soundMusic),ho(5),ga("music sound volume ",n.getSoundMusicVolume(),"% "),ho(2),Ws("value",n.getSoundMusicVolume()),ho(3),Ws("ngModel",n.soundEffects),ho(5),ga("effects sound volume ",n.getSoundEffectsVolume(),"% "),ho(2),Ws("value",n.getSoundEffectsVolume()),ho(2),Ws("ngModel",n.soundEffectMarket),ho(4),Ws("ngModel",n.soundEffectResearch),ho(4),Ws("ngModel",n.soundEffectInvasion),ho(4),Ws("ngModel",n.soundEffectSeason)}}function _D(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"h4"),ha(2,"Game difficulty"),Ys(),zs(3,"div",8),zs(4,"h5"),ha(5,"AI strength"),Ys(),zs(6,"input",51),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().AIDifficulty=e}),Ys(),zs(7,"label",52),ha(8,"Easy"),Ys(),js(9,"br"),zs(10,"input",53),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().AIDifficulty=e}),Ys(),zs(11,"label",54),ha(12,"Medium"),Ys(),js(13,"br"),zs(14,"input",55),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().AIDifficulty=e}),Ys(),zs(15,"label",56),ha(16,"Hard"),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(6),Ws("value",n.AIDiffs.EASY)("ngModel",n.AIDifficulty),ho(4),Ws("value",n.AIDiffs.MEDIUM)("ngModel",n.AIDifficulty),ho(4),Ws("value",n.AIDiffs.HARD)("ngModel",n.AIDifficulty)}}function wD(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"h4"),ha(2,"Performance options"),Ys(),zs(3,"div",8),zs(4,"input",57),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().pagedView=e}),Ys(),zs(5,"label",58),ha(6,"Display buildings in pages instead of all at once"),Ys(),js(7,"br"),zs(8,"input",59),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().buildingsPerPage=e}),Ys(),zs(9,"label",60),ha(10,"Number of buildings on one page"),Ys(),js(11,"br"),zs(12,"input",61),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().visualProgressBars=e}),Ys(),zs(13,"label",62),ha(14,"Display moving progress bars (on) or just text (off)"),Ys(),js(15,"br"),zs(16,"input",63),$s("change",function(){return Kt(i),ta().updateOptions()})("ngModelChange",function(e){return Kt(i),ta().autoTextFitting=e}),Ys(),zs(17,"label",64),ha(18,"Buildings names and effect font size will be automatically recalculated on change"),Ys(),js(19,"br"),Ys(),Ys()}if(2&e){var n=ta();ho(4),Ws("ngModel",n.pagedView),ho(4),Ws("ngModel",n.buildingsPerPage),ho(4),Ws("ngModel",n.visualProgressBars),ho(4),Ws("ngModel",n.autoTextFitting)}}function PD(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"h4"),ha(2,"Display options"),Ys(),zs(3,"div",8),zs(4,"input",65),$s("change",function(){return Kt(i),ta().setPositiveColour()})("ngModelChange",function(e){return Kt(i),ta().positiveColour=e}),Ys(),zs(5,"label",66),ha(6,"Font colour for positive effects"),Ys(),zs(7,"button",6),$s("click",function(){return Kt(i),ta().resetPositiveColour()}),ha(8,"reset to default"),Ys(),js(9,"br"),zs(10,"input",67),$s("change",function(){return Kt(i),ta().setNegativeColour()})("ngModelChange",function(e){return Kt(i),ta().negativeColour=e}),Ys(),zs(11,"label",68),ha(12,"Font colour for negative effects"),Ys(),zs(13,"button",6),$s("click",function(){return Kt(i),ta().resetNegativeColour()}),ha(14,"reset to default"),Ys(),js(15,"br"),zs(16,"input",69),$s("change",function(){return Kt(i),ta().setPlayerColour()})("ngModelChange",function(e){return Kt(i),ta().playerColour=e}),Ys(),zs(17,"label",70),ha(18,"World map player regions colour"),Ys(),zs(19,"button",6),$s("click",function(){return Kt(i),ta().resetPlayerColour()}),ha(20,"reset to default"),Ys(),js(21,"br"),Ys(),Ys()}if(2&e){var n=ta();ho(4),Ws("ngModel",n.positiveColour),ho(6),Ws("ngModel",n.negativeColour),ho(6),Ws("ngModel",n.playerColour)}}var MD=function(e){return{x:e}},DD=function(){var e=function(){function e(t,i,n){var r=this;p(this,e),this.optionsService=t,this.servicesService=i,this.modalService=n,this.selection=0,this.lastServerAction={timestamp:0},this.saveFileMetadata={day:-1,year:-1},this.savingLoader={status:!1},this.loadingLoader={status:!1},this.checkLoader={status:!1},this.positiveColour=this.optionsService.getOption(Xv.POSITIVE_COLOUR),this.negativeColour=this.optionsService.getOption(Xv.NEGATIVE_COLOUR),this.playerColour=this.optionsService.getOption(Xv.PLAYER_COLOUR),this.AIDiffs=hp,n.registerForOnOpen().subscribe(function(e){e===_v.OPTIONS&&(r.checkSave(!0),r.lastServerAction.timestamp=0)})}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(function(){return e.initOptions()})),this.initOptions()}},{key:"initOptions",value:function(){this.autoSaveStatus=this.optionsService.getOption(Xv.AUTO_SAVE_STATUS),this.autoSavePeriod=this.optionsService.getOption(Xv.AUTO_SAVE_PERIOD),this.metricStatus=this.optionsService.getOption(Xv.METRIC),this.saveLogs=this.optionsService.getOption(Xv.SAVE_LOGS),this.pauseOnInit=this.optionsService.getOption(Xv.PAUSE_ON_INIT),this.keepReservationSettingsOnReset=this.optionsService.getOption(Xv.KEEP_RESERVATION_SETTINGS_ON_RESET),this.keepManagementSettingsOnReset=this.optionsService.getOption(Xv.KEEP_MANAGEMENT_SETTINGS_ON_RESET),this.keepAutoTradeOnReset=this.optionsService.getOption(Xv.KEEP_AUTO_TRADE_ON_RESET),this.soundMaster=this.optionsService.getOption(Xv.SOUND_MASTER),this.soundMasterVolume=this.optionsService.getOption(Xv.SOUND_MASTER_VOLUME),this.soundMusic=this.optionsService.getOption(Xv.SOUND_MUSIC),this.soundMusicVolume=this.optionsService.getOption(Xv.SOUND_MUSIC_VOLUME),this.soundEffects=this.optionsService.getOption(Xv.SOUND_EFFECTS),this.soundEffectsVolume=this.optionsService.getOption(Xv.SOUND_EFFECTS_VOLUME),this.soundEffectMarket=this.optionsService.getOption(Xv.SOUND_EFFECT_MARKET),this.soundEffectResearch=this.optionsService.getOption(Xv.SOUND_EFFECT_RESEARCH),this.soundEffectInvasion=this.optionsService.getOption(Xv.SOUND_EFFECT_INVASION),this.soundEffectSeason=this.optionsService.getOption(Xv.SOUND_EFFECT_SEASON),this.visualProgressBars=this.optionsService.getOption(Xv.VISUAL_PROGRESS_BARS),this.autoTextFitting=this.optionsService.getOption(Xv.AUTO_TEXT_FITTING),this.pagedView=this.optionsService.getOption(Xv.PAGED_VIEW),this.buildingsPerPage=this.optionsService.getOption(Xv.BUILDINGS_PER_PAGE),this.positiveColour=this.optionsService.getOption(Xv.POSITIVE_COLOUR),this.negativeColour=this.optionsService.getOption(Xv.NEGATIVE_COLOUR),this.playerColour=this.optionsService.getOption(Xv.PLAYER_COLOUR),this.AIDifficulty=this.optionsService.getOption(Xv.AI_DIFFICULTY)}},{key:"close",value:function(){this.modalService.close(_v.OPTIONS)}},{key:"updateOptions",value:function(){this.optionsService.setOptions([{option:Xv.AUTO_SAVE_STATUS,value:this.autoSaveStatus},{option:Xv.AUTO_SAVE_PERIOD,value:this.autoSavePeriod},{option:Xv.METRIC,value:this.metricStatus},{option:Xv.SAVE_LOGS,value:this.saveLogs},{option:Xv.PAUSE_ON_INIT,value:this.pauseOnInit},{option:Xv.KEEP_RESERVATION_SETTINGS_ON_RESET,value:this.keepReservationSettingsOnReset},{option:Xv.KEEP_MANAGEMENT_SETTINGS_ON_RESET,value:this.keepManagementSettingsOnReset},{option:Xv.KEEP_AUTO_TRADE_ON_RESET,value:this.keepAutoTradeOnReset},{option:Xv.SOUND_MASTER,value:this.soundMaster},{option:Xv.SOUND_MASTER_VOLUME,value:this.soundMasterVolume},{option:Xv.SOUND_MUSIC,value:this.soundMusic},{option:Xv.SOUND_MUSIC_VOLUME,value:this.soundMusicVolume},{option:Xv.SOUND_EFFECTS,value:this.soundEffects},{option:Xv.SOUND_EFFECTS_VOLUME,value:this.soundEffectsVolume},{option:Xv.SOUND_EFFECT_MARKET,value:this.soundEffectMarket},{option:Xv.SOUND_EFFECT_RESEARCH,value:this.soundEffectResearch},{option:Xv.SOUND_EFFECT_INVASION,value:this.soundEffectInvasion},{option:Xv.SOUND_EFFECT_SEASON,value:this.soundEffectSeason},{option:Xv.VISUAL_PROGRESS_BARS,value:this.visualProgressBars},{option:Xv.AUTO_TEXT_FITTING,value:this.autoTextFitting},{option:Xv.PAGED_VIEW,value:this.pagedView},{option:Xv.BUILDINGS_PER_PAGE,value:this.buildingsPerPage},{option:Xv.POSITIVE_COLOUR,value:this.positiveColour},{option:Xv.NEGATIVE_COLOUR,value:this.negativeColour},{option:Xv.PLAYER_COLOUR,value:this.playerColour},{option:Xv.AI_DIFFICULTY,value:this.AIDifficulty}])}},{key:"updateSaveOption",value:function(){this.autoSavePeriod=Number(this.autoSavePeriod),this.autoSavePeriod<1&&(this.autoSavePeriod=1),this.autoSavePeriod%1!=0&&(this.autoSavePeriod=Math.floor(this.autoSavePeriod)),this.autoSavePeriod>60&&(this.autoSavePeriod=60),this.updateOptions()}},{key:"setPositiveColour",value:function(){this.optionsService.setPositiveColour(this.positiveColour)}},{key:"setNegativeColour",value:function(){this.optionsService.setNegativeColour(this.negativeColour)}},{key:"setPlayerColour",value:function(){this.optionsService.setPlayerColour(this.playerColour)}},{key:"resetPositiveColour",value:function(){this.positiveColour=Np.POSITIVE_COLOUR,this.setPositiveColour()}},{key:"resetNegativeColour",value:function(){this.negativeColour=Np.NEGATIVE_COLOUR,this.setNegativeColour()}},{key:"resetPlayerColour",value:function(){this.playerColour=Np.PLAYER_COLOUR,this.setPlayerColour()}},{key:"resetAll",value:function(){var e=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to reset all settings (in all tabs) to default values?");var t=this.modalService.registerForConfirmation().subscribe(function(i){t.unsubscribe(),i&&e.optionsService.init()})}},{key:"getTimestamp",value:function(){return(new Date).getTime()}},{key:"cloudSave",value:function(){this.getTimestamp()-this.lastServerAction.timestamp>15e3?this.servicesService.getService(Zv.SERIALIZER).cloudSave(this.savingLoader,this.saveFileMetadata,this.lastServerAction):this.modalService.info("You must wait for "+(15-Math.ceil((this.getTimestamp()-this.lastServerAction.timestamp)/1e3))+"s before next cloud save")}},{key:"cloudLoad",value:function(){this.getTimestamp()-this.lastServerAction.timestamp>15e3?this.servicesService.getService(Zv.SERIALIZER).cloudLoad(this.loadingLoader,this.lastServerAction):this.modalService.info("You must wait for "+(15-Math.ceil((this.getTimestamp()-this.lastServerAction.timestamp)/1e3))+"s before next cloud load")}},{key:"checkSave",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||this.getTimestamp()-this.lastServerAction.timestamp>5e3?this.servicesService.getService(Zv.SERIALIZER).cloudCheck(e,this.checkLoader,this.saveFileMetadata,this.lastServerAction):this.modalService.info("You must wait for "+(5-Math.ceil((this.getTimestamp()-this.lastServerAction.timestamp)/1e3))+"s before next save lookup")}},{key:"getSoundMasterVolume",value:function(){return this.optionsService.getOption(Xv.SOUND_MASTER_VOLUME)}},{key:"changeSoundMasterVolume",value:function(e){this.soundMasterVolume=e.target.value,this.updateOptions()}},{key:"getSoundMusicVolume",value:function(){return this.optionsService.getOption(Xv.SOUND_MUSIC_VOLUME)}},{key:"changeSoundMusicVolume",value:function(e){this.soundMusicVolume=e.target.value,this.updateOptions()}},{key:"getSoundEffectsVolume",value:function(){return this.optionsService.getOption(Xv.SOUND_EFFECTS_VOLUME)}},{key:"changeSoundEffectsVolume",value:function(e){this.soundEffectsVolume=e.target.value,this.updateOptions()}},{key:"isKongregate",value:function(){return Cp.target===bp.DEV||Cp.target===bp.KONGREGATE}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Om),Bs($v),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-options-modal"]],decls:29,vars:20,consts:[["id","options-modal"],[1,"modal"],[1,"modal-body"],["id","sections"],[3,"ngClass","click"],[4,"ngIf"],[3,"click"],[1,"modal-background"],[1,"options"],["id","autoSaveStatus","type","checkbox",3,"ngModel","change","ngModelChange"],["for","autoSaveStatus"],["id","autoSavePeriod","type","number","min","1","max","60",3,"ngModel","change","ngModelChange"],["for","autoSavePeriod"],["id","metricStatus","type","checkbox",3,"ngModel","change","ngModelChange"],["for","metricStatus"],["id","saveLogsStatus","type","checkbox",3,"ngModel","change","ngModelChange"],["for","saveLogsStatus"],["id","pauseOnInit","type","checkbox",3,"ngModel","change","ngModelChange"],["for","pauseOnInit"],["id","keepReservationSettings","type","checkbox",3,"ngModel","change","ngModelChange"],["for","keepReservationSettings"],["id","keepManagementSettings","type","checkbox",3,"ngModel","change","ngModelChange"],["for","keepManagementSettings"],["id","keepAutoTradeOnReset","type","checkbox",3,"ngModel","change","ngModelChange"],["for","keepAutoTradeOnReset"],["class","loader",4,"ngIf"],["id","refresh",3,"click"],["id","refreshIMG","src","assets/refresh.svg",4,"ngIf"],[1,"loader"],["id","refreshIMG","src","assets/refresh.svg"],["id","soundMaster","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundMaster"],["for","soundMasterVolume",1,"soundVolumeLabel"],[1,"slidecontainer"],["id","soundMasterVolume","type","range","min","0","max","100","value","100",1,"slider",3,"value","input"],["id","soundMusic","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundMusic"],["for","soundMusicVolume",1,"soundVolumeLabel"],["id","soundMusicVolume","type","range","min","0","max","100","value","100",1,"slider",3,"value","input"],["id","soundEffects","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffects"],["for","soundEffectsVolume",1,"soundVolumeLabel"],["id","soundEffectsVolume","type","range","min","0","max","100","value","100",1,"slider",3,"value","input"],["id","soundEffectMarket","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectMarket"],["id","soundEffectResearch","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectResearch"],["id","soundEffectInvasion","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectInvasion"],["id","soundEffectSeason","type","checkbox",3,"ngModel","change","ngModelChange"],["for","soundEffectSeason"],["id","AIeasy","type","radio",3,"value","ngModel","change","ngModelChange"],["for","AIeasy"],["id","AImedium","type","radio",3,"value","ngModel","change","ngModelChange"],["for","AImedium"],["id","AIhard","type","radio",3,"value","ngModel","change","ngModelChange"],["for","AIhard"],["id","pagedView","type","checkbox",3,"ngModel","change","ngModelChange"],["for","pagedView"],["id","buildingPerPage","type","number",3,"ngModel","change","ngModelChange"],["for","buildingPerPage"],["id","visualProgressBars","type","checkbox",3,"ngModel","change","ngModelChange"],["for","visualProgressBars"],["id","autoTextFitting","type","checkbox",3,"ngModel","change","ngModelChange"],["for","autoTextFitting"],["id","positiveColour","type","color",3,"ngModel","change","ngModelChange"],["for","positiveColour"],["id","negativeColour","type","color",3,"ngModel","change","ngModelChange"],["for","negativeColour"],["id","playerColour","type","color",3,"ngModel","change","ngModelChange"],["for","playerColour"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"div",3),zs(4,"div",4),$s("click",function(){return t.selection=0}),ha(5,"General"),Ys(),zs(6,"div",4),$s("click",function(){return t.selection=1}),ha(7,"Sound"),Ys(),zs(8,"div",4),$s("click",function(){return t.selection=2}),ha(9,"Difficulty"),Ys(),zs(10,"div",4),$s("click",function(){return t.selection=3}),ha(11,"Performance"),Ys(),zs(12,"div",4),$s("click",function(){return t.selection=4}),ha(13,"Display"),Ys(),Ys(),Gs(14,kD,39,9,"div",5),Gs(15,ND,51,13,"div",5),Gs(16,_D,17,6,"div",5),Gs(17,wD,20,4,"div",5),Gs(18,PD,22,3,"div",5),js(19,"br"),js(20,"br"),js(21,"br"),zs(22,"button",6),$s("click",function(){return t.resetAll()}),ha(23,"RESET ALL SETTINGS"),Ys(),js(24,"br"),js(25,"br"),zs(26,"button",6),$s("click",function(){return t.close()}),ha(27,"Close"),Ys(),Ys(),Ys(),js(28,"div",7),Ys()),2&e&&(ho(4),Ws("ngClass",Du(10,MD,0===t.selection)),ho(2),Ws("ngClass",Du(12,MD,1===t.selection)),ho(2),Ws("ngClass",Du(14,MD,2===t.selection)),ho(2),Ws("ngClass",Du(16,MD,3===t.selection)),ho(2),Ws("ngClass",Du(18,MD,4===t.selection)),ho(2),Ws("ngIf",0===t.selection),ho(1),Ws("ngIf",1===t.selection),ho(1),Ws("ngIf",2===t.selection),ho(1),Ws("ngIf",3===t.selection),ho(1),Ws("ngIf",4===t.selection))},directives:[qP,xl,Gl,jR,vO,DO,tT,JO,xO,qR,GO],styles:[".modal-body[_ngcontent-%COMP%]{text-align:center;font-size:1.2em}#title[_ngcontent-%COMP%]{text-align:center;font-weight:800;display:inline-block}.options[_ngcontent-%COMP%]{text-align:left}#autoSavePeriod[_ngcontent-%COMP%]{width:4ch;text-align:right}.slidecontainer[_ngcontent-%COMP%]{display:inline-block;width:150px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.soundVolumeLabel[_ngcontent-%COMP%]{display:inline-block;width:250px}#buildingPerPage[_ngcontent-%COMP%]{width:5ch}#sections[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;width:100%}#sections[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:10px;font-size:1.2em;background-color:var(--passive-colour);border:black solid 1px;cursor:pointer}#sections[_ngcontent-%COMP%] > div.x[_ngcontent-%COMP%]{background-color:var(--active-colour)}#refresh[_ngcontent-%COMP%]{padding:4px 4px 0;align-items:center}#refreshIMG[_ngcontent-%COMP%]{height:20px}"]}),e}();function LD(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span"),ha(2,"Choose how many Royal Points you would like to buy:"),Ys(),js(3,"br"),zs(4,"div",6),zs(5,"button",7),$s("click",function(){return Kt(i),ta().buy("rp_pack10")}),ha(6,"10 "),js(7,"img",8),Ys(),zs(8,"span"),ha(9," 10 Royal points"),Ys(),Ys(),zs(10,"div",6),zs(11,"button",7),$s("click",function(){return Kt(i),ta().buy("rp_pack20")}),ha(12,"20 "),js(13,"img",8),Ys(),zs(14,"span"),ha(15," 20 Royal points"),Ys(),Ys(),zs(16,"div",6),zs(17,"button",7),$s("click",function(){return Kt(i),ta().buy("rp_pack55")}),ha(18,"50 "),js(19,"img",8),Ys(),zs(20,"span"),ha(21," 55 Royal points"),Ys(),Ys(),zs(22,"div",6),zs(23,"button",7),$s("click",function(){return Kt(i),ta().buy("rp_pack125")}),ha(24,"100 "),js(25,"img",8),Ys(),zs(26,"span"),ha(27," 125 Royal points"),Ys(),Ys(),Ys()}}function xD(e,t){1&e&&(zs(0,"div"),zs(1,"span"),ha(2,"Buying Royal Points is currently possible only at Kongregate Villager Kings"),js(3,"br"),ha(4," You can still find Royal Points through playing the game or buying on Kongregate and moving your save file here. "),Ys(),Ys())}var FD=function(){var e=function(){function e(t,i,n){p(this,e),this.kongregateService=t,this.royalService=i,this.modalService=n}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.close(_v.ROYAL)}},{key:"buy",value:function(e){Cp.production?this.kongregateService.buyItem(e):(this.royalService.increaseRoyalPoints(Number(e.replace("rp_pack",""))),this.modalService.close(_v.ROYAL))}},{key:"isKongregate",value:function(){return Cp.target===bp.DEV||Cp.target===bp.KONGREGATE}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(ME),Bs(PE),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-royal-modal"]],decls:8,vars:2,consts:[["id","royal-modal"],[1,"modal"],[1,"modal-body"],[4,"ngIf"],["id","close",3,"click"],[1,"modal-background"],[1,"entry"],[3,"click"],["src","assets/kred.png","alt","Kreds",1,"kred"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),Gs(3,LD,28,0,"div",3),Gs(4,xD,5,0,"div",3),zs(5,"button",4),$s("click",function(){return t.ok()}),ha(6,"CLOSE"),Ys(),Ys(),Ys(),js(7,"div",5),Ys()),2&e&&(ho(3),Ws("ngIf",t.isKongregate()),ho(1),Ws("ngIf",!t.isKongregate()))},directives:[qP,Gl],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.kred[_ngcontent-%COMP%]{width:30px;height:30px;vertical-align:middle}.value[_ngcontent-%COMP%]{margin-top:5px}.entry[_ngcontent-%COMP%]{width:50%;text-align:center}#close[_ngcontent-%COMP%]{margin-top:15px}"]}),e}();function UD(e,t){if(1&e&&(zs(0,"div"),yi(),zs(1,"svg",21),js(2,"path"),Ys(),Ys()),2&e){var i=ta(2);ho(1),Us("height","80px")("width","80px")("viewBox",i.prepareViewbox(i.missionData.originRegion.center)),ho(1),Us("fill",i.missionData.originRegionColour)("d",i.missionData.originRegion.path)("stroke","black")("stroke-width","2")}}function HD(e,t){1&e&&(zs(0,"div"),yi(),js(1,"svg",21),Ys()),2&e&&(ho(1),Us("height","80px")("width","80px"))}function GD(e,t){if(1&e&&(zs(0,"div"),yi(),zs(1,"svg",21),js(2,"path"),Ys(),Ys()),2&e){var i=ta(3);ho(1),Us("height","80px")("width","80px")("viewBox",i.prepareViewbox(i.missionData.targetRegion.center)),ho(1),Us("fill",i.missionData.targetRegionColour)("d",i.missionData.targetRegion.path)("stroke","black")("stroke-width","2")}}function BD(e,t){1&e&&(zs(0,"div"),yi(),js(1,"svg",21),Ys()),2&e&&(ho(1),Us("height","80px")("width","80px"))}function WD(e,t){if(1&e){var i=qs();zs(0,"div",7),zs(1,"span",8),ha(2,"target"),Ys(),Gs(3,GD,3,7,"div",9),Gs(4,BD,2,2,"div",9),zs(5,"button",10),$s("click",function(){return Kt(i),ta(2).changeTarget()}),ha(6,"change"),Ys(),Ys()}if(2&e){var n=ta(2);ho(3),Ws("ngIf",n.missionData.targetRegion),ho(1),Ws("ngIf",!n.missionData.targetRegion)}}var VD=function(e){return{selectedMission:e}};function zD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.COLONIZE)}),js(1,"img",23),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.COLONIZE))}}function YD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.MOVE)}),js(1,"img",24),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.MOVE))}}function jD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.SPY)}),js(1,"img",25),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.SPY))}}function KD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.PLUNDER)}),js(1,"img",26),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.PLUNDER))}}function QD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.CONQUER)}),js(1,"img",27),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.CONQUER))}}function qD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.SEA_MOVE)}),js(1,"img",28),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.SEA_MOVE))}}function XD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.SEA_PLUNDER)}),js(1,"img",29),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.SEA_PLUNDER))}}function ZD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.SEA_CONQUER)}),js(1,"img",30),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.SEA_CONQUER))}}function $D(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.FISHING)}),js(1,"img",31),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.FISHING))}}function JD(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.HUNTING)}),js(1,"img",32),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.HUNTING))}}function eL(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.TREASURE)}),js(1,"img",33),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.TREASURE))}}function tL(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.CARTOGRAPHY)}),js(1,"img",34),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.CARTOGRAPHY))}}function iL(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.SEA_BATTLE)}),js(1,"img",35),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.SEA_BATTLE))}}function nL(e,t){if(1&e){var i=qs();zs(0,"div",22),$s("click",function(){Kt(i);var e=ta(2);return e.changeMission(e.missions.EXPEDITION)}),js(1,"img",36),Ys()}if(2&e){var n=ta(2);Ws("ngClass",Du(1,VD,n.missionData.missionType===n.missions.EXPEDITION))}}function rL(e,t){if(1&e){var i=qs();zs(0,"span"),zs(1,"span",38),ha(2),Ys(),zs(3,"input",39),$s("ngModelChange",function(e){Kt(i);var t=ta().$implicit;return ta(3).troopsHolder[t]=e}),Ys(),ha(4),js(5,"br"),zs(6,"div",40),ha(7," 0 "),zs(8,"input",41),$s("ngModelChange",function(e){Kt(i);var t=ta().$implicit;return ta(3).troopsHolder[t]=e}),Ys(),ha(9),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta(3);ho(2),ga("",r.getTroopName(n),":"),ho(1),ia("max",r.getTroop(n).size),Ws("ngModel",r.troopsHolder[n]),ho(1),ga("/",r.getTroop(n).size," "),ho(4),ia("max",r.getTroop(n).size),Ws("ngModel",r.troopsHolder[n]),ho(1),ga(" ",r.getTroop(n).size," ")}}function oL(e,t){if(1&e&&(zs(0,"div"),Gs(1,rL,10,7,"span",9),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("ngIf",n.getTroop(i).size>0)}}function sL(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"div"),zs(2,"button",10),$s("click",function(){return Kt(i),ta(2).clearAll()}),ha(3,"clear all"),Ys(),zs(4,"button",10),$s("click",function(){return Kt(i),ta(2).selectAll()}),ha(5,"select all"),Ys(),Ys(),Gs(6,oL,2,1,"div",37),Ys()}if(2&e){var n=ta(2);ho(6),Ws("ngForOf",n.getTroops(n.missionData.missionType))}}function aL(e,t){if(1&e){var i=qs();zs(0,"span"),zs(1,"span",38),ha(2),Ys(),zs(3,"input",39),$s("ngModelChange",function(e){Kt(i);var t=ta().$implicit;return ta(3).troopsHolder[t]=e}),Ys(),ha(4),js(5,"br"),zs(6,"div",40),ha(7," 0 "),zs(8,"input",41),$s("ngModelChange",function(e){Kt(i);var t=ta().$implicit;return ta(3).troopsHolder[t]=e}),Ys(),ha(9),Ys(),Ys()}if(2&e){var n=ta().$implicit,r=ta(3);ho(2),ga("",r.getTroopName(n),":"),ho(1),ia("max",r.getTroop(n).size),Ws("ngModel",r.troopsHolder[n]),ho(1),ga("/",r.getTroop(n).size," "),ho(4),ia("max",r.getTroop(n).size),Ws("ngModel",r.troopsHolder[n]),ho(1),ga(" ",r.getTroop(n).size," ")}}function uL(e,t){if(1&e&&(zs(0,"div"),Gs(1,aL,10,7,"span",9),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("ngIf",n.getTroop(i).size>0)}}function cL(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"div"),zs(2,"button",10),$s("click",function(){return Kt(i),ta(2).clearAll()}),ha(3,"clear all"),Ys(),zs(4,"button",10),$s("click",function(){return Kt(i),ta(2).selectAll()}),ha(5,"select all"),Ys(),Ys(),Gs(6,uL,2,1,"div",37),zs(7,"div"),zs(8,"label",42),ha(9,"distance: "),Ys(),zs(10,"input",43),$s("ngModelChange",function(e){return Kt(i),ta(2).expeditionDistance=e}),Ys(),Ys(),Ys()}if(2&e){var n=ta(2);ho(6),Ws("ngForOf",n.getTroops(n.missionData.missionType)),ho(4),ia("min",n.discoveredLand+10),ia("max",n.calculateMaxDistance()),Ws("ngModel",n.expeditionDistance)}}function lL(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span",38),ha(2,"Colonist:"),Ys(),zs(3,"input",39),$s("ngModelChange",function(e){return Kt(i),ta(2).colonistsHolder=e}),Ys(),ha(4),js(5,"br"),zs(6,"div",40),ha(7," 0 "),zs(8,"input",41),$s("ngModelChange",function(e){return Kt(i),ta(2).colonistsHolder=e}),Ys(),ha(9),Ys(),Ys()}if(2&e){var n=ta(2);ho(3),ia("max",n.getFreeWorkers()),Ws("ngModel",n.colonistsHolder),ho(1),ga("/",n.getFreeWorkers(),""),ho(4),ia("max",n.getFreeWorkers()),Ws("ngModel",n.colonistsHolder),ho(1),ga(" ",n.getFreeWorkers()," ")}}function hL(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span",38),ha(2),Ys(),zs(3,"input",39),$s("ngModelChange",function(e){var t=Kt(i).$implicit;return ta(3).troopsHolder[t]=e}),Ys(),ha(4),js(5,"br"),zs(6,"div",40),ha(7," 0 "),zs(8,"input",41),$s("ngModelChange",function(e){var t=Kt(i).$implicit;return ta(3).troopsHolder[t]=e}),Ys(),ha(9),Ys(),Ys()}if(2&e){var n=t.$implicit,r=ta(3);ho(2),ga("",r.getTroopName(n),":"),ho(1),ia("max",r.getTroop(n).size),Ws("ngModel",r.troopsHolder[n]),ho(1),ga("/",r.getTroop(n).size," "),ho(4),ia("max",r.getTroop(n).size),Ws("ngModel",r.troopsHolder[n]),ho(1),ga(" ",r.getTroop(n).size," ")}}function dL(e,t){if(1&e&&(zs(0,"div"),Gs(1,hL,10,7,"div",37),Ys()),2&e){var i=ta(2);ho(1),Ws("ngForOf",i.getSpyUnits())}}function gL(e,t){if(1&e&&(zs(0,"div",44),zs(1,"span"),ha(2,"Stats"),Ys(),zs(3,"div",45),js(4,"app-icon",46),ha(5),Ys(),Ys()),2&e){var i=ta(2);ho(4),Ws("name","colonize")("path","army/mission"),ho(1),ga(" ",5*i.colonistsHolder,"% success chance ")}}function fL(e,t){if(1&e&&(zs(0,"div",45),js(1,"app-icon",46),ha(2),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("name",n.getResourceName(i.resource))("path","resources"),ho(1),ga(" ",i.amount," ")}}var vL=function(e){return{notAvailable:e}};function pL(e,t){if(1&e&&(zs(0,"div",45),js(1,"app-icon",46),zs(2,"span",50),ha(3),Ys(),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("name",n.getResourceName(i.resource))("path","resources"),ho(1),Ws("ngClass",Du(4,vL,!n.hasResource(i.resource,i.amount*n.getUnitsNumber()))),ho(1),ga(" ",i.amount*n.getUnitsNumber()," ")}}function mL(e,t){if(1&e&&(zs(0,"div"),zs(1,"span"),ha(2,"Cost per person"),Ys(),zs(3,"div",47),Gs(4,fL,3,3,"div",48),js(5,"br"),Ys(),zs(6,"span"),ha(7,"Total cost"),Ys(),zs(8,"div",49),Gs(9,pL,4,6,"div",48),Ys(),Ys()),2&e){var i=ta(2);ho(4),Ws("ngForOf",i.getMissionCost(i.missionData.missionType)),ho(5),Ws("ngForOf",i.getMissionCost(i.missionData.missionType))}}function SL(e,t){if(1&e&&(zs(0,"div",45),js(1,"app-icon",46),ha(2),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("name",n.getResourceName(i.resource))("path","resources"),ho(1),ga(" ",i.amount*n.expeditionDistance," ")}}function EL(e,t){if(1&e&&(zs(0,"div",45),js(1,"app-icon",46),zs(2,"span",50),ha(3),Ys(),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("name",n.getResourceName(i.resource))("path","resources"),ho(1),Ws("ngClass",Du(4,vL,!n.hasResource(i.resource,i.amount*n.getUnitsNumber()*n.expeditionDistance))),ho(1),ga(" ",i.amount*n.getUnitsNumber()*n.expeditionDistance," ")}}function yL(e,t){if(1&e&&(zs(0,"div"),zs(1,"span"),ha(2,"Cost per person"),Ys(),zs(3,"div",47),Gs(4,SL,3,3,"div",48),js(5,"br"),Ys(),zs(6,"span"),ha(7,"Total cost"),Ys(),zs(8,"div",49),Gs(9,EL,4,6,"div",48),zs(10,"div",45),js(11,"app-icon",46),zs(12,"span",50),ha(13," 1 "),Ys(),Ys(),Ys(),Ys()),2&e){var i=ta(2);ho(4),Ws("ngForOf",i.getMissionCost(i.missionData.missionType)),ho(5),Ws("ngForOf",i.getMissionCost(i.missionData.missionType)),ho(2),Ws("name","map")("path","resources"),ho(1),Ws("ngClass",Du(5,vL,!i.hasResource(i.resources.MAP,1)))}}function RL(e,t){if(1&e&&(zs(0,"div",45),js(1,"app-icon",51),zs(2,"span",50),ha(3),Ys(),Ys()),2&e){var i=ta(3);ho(1),Ws("name","cargo"),ho(1),Ws("ngClass",Du(4,vL,i.getCargoUtilization()>i.getNavyCapacity())),ho(1),fa("",i.getCargoUtilization()," /",i.getNavyCapacity(),"")}}function OL(e,t){if(1&e&&(zs(0,"div",44),zs(1,"span"),ha(2,"Stats"),Ys(),zs(3,"div",45),js(4,"app-icon",46),ha(5),Ys(),zs(6,"div",45),js(7,"app-icon",51),ha(8),Ys(),zs(9,"div",45),js(10,"app-icon",46),ha(11),Ys(),zs(12,"div",45),js(13,"app-icon",46),ha(14),Ys(),zs(15,"div",45),js(16,"app-icon",46),ha(17),Ys(),Gs(18,RL,4,6,"div",52),Ys()),2&e){var i=ta(2);ho(4),Ws("name","map")("path","resources"),ho(1),ga(" ",i.calculateExpeditionChance(),"% success chance "),ho(2),Ws("name","land"),ho(1),ga(" ~",i.calculateExpeditionLand()," estimated land "),ho(2),Ws("name","attack")("path","army"),ho(1),ga(" ",i.getUnitsStrength()," "),ho(2),Ws("name","defense")("path","army"),ho(1),ga(" ",i.getUnitsDefense()," "),ho(2),Ws("name","speed")("path","army"),ho(1),ga(" ",i.getSeaUnitsSpeed()," "),ho(1),Ws("ngIf",i.isSeaLandMission())}}function TL(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta(3);ho(1),da(i.getSeaUnitsSpeed())}}function IL(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta(3);ho(1),da(i.getUnitsSpeed())}}function bL(e,t){if(1&e&&(zs(0,"div",45),js(1,"app-icon",51),zs(2,"span",50),ha(3),Ys(),Ys()),2&e){var i=ta(3);ho(1),Ws("name","cargo"),ho(1),Ws("ngClass",Du(4,vL,i.getCargoUtilization()>i.getNavyCapacity())),ho(1),fa("",i.getCargoUtilization()," /",i.getNavyCapacity(),"")}}function CL(e,t){if(1&e&&(zs(0,"div",44),zs(1,"span"),ha(2,"Stats"),Ys(),zs(3,"div",45),js(4,"app-icon",46),ha(5),Ys(),zs(6,"div",45),js(7,"app-icon",46),ha(8),Ys(),zs(9,"div",45),js(10,"app-icon",46),Gs(11,TL,2,1,"span",9),Gs(12,IL,2,1,"span",9),Ys(),Gs(13,bL,4,6,"div",52),Ys()),2&e){var i=ta(2);ho(4),Ws("name","attack")("path","army"),ho(1),ga(" ",i.getUnitsStrength()," "),ho(2),Ws("name","defense")("path","army"),ho(1),ga(" ",i.getUnitsDefense()," "),ho(2),Ws("name","speed")("path","army"),ho(1),Ws("ngIf",i.isSeaLandMission()),ho(1),Ws("ngIf",!i.isSeaLandMission()),ho(1),Ws("ngIf",i.isSeaLandMission())}}function AL(e,t){if(1&e&&(zs(0,"div",53),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga(" ",i.cannotStartReason," ")}}var kL=function(e){return{inactive:e}};function NL(e,t){if(1&e){var i=qs();zs(0,"div",4),zs(1,"div",5),ha(2,"New mission"),Ys(),zs(3,"div",6),zs(4,"div",7),zs(5,"span",8),ha(6,"origin"),Ys(),Gs(7,UD,3,7,"div",9),Gs(8,HD,2,2,"div",9),zs(9,"button",10),$s("click",function(){return Kt(i),ta().changeOrigin()}),ha(10,"change"),Ys(),Ys(),Gs(11,WD,7,2,"div",11),Ys(),zs(12,"div",12),Gs(13,zD,2,3,"div",13),Gs(14,YD,2,3,"div",13),Gs(15,jD,2,3,"div",13),Gs(16,KD,2,3,"div",13),Gs(17,QD,2,3,"div",13),Gs(18,qD,2,3,"div",13),Gs(19,XD,2,3,"div",13),Gs(20,ZD,2,3,"div",13),Gs(21,$D,2,3,"div",13),Gs(22,JD,2,3,"div",13),Gs(23,eL,2,3,"div",13),Gs(24,tL,2,3,"div",13),Gs(25,iL,2,3,"div",13),Gs(26,nL,2,3,"div",13),Ys(),zs(27,"div",14),Gs(28,sL,7,1,"div",9),Gs(29,cL,11,4,"div",9),Gs(30,lL,10,6,"div",9),Gs(31,dL,2,1,"div",9),zs(32,"div",15),zs(33,"div",16),Gs(34,gL,6,3,"div",17),Gs(35,mL,10,2,"div",9),Gs(36,yL,14,7,"div",9),Ys(),Gs(37,OL,19,15,"div",17),Gs(38,CL,14,11,"div",17),Ys(),Ys(),Gs(39,AL,2,1,"div",18),zs(40,"div",19),zs(41,"button",20),$s("click",function(){return Kt(i),ta().start()}),ha(42),Ys(),zs(43,"button",10),$s("click",function(){return Kt(i),ta().closeModal()}),ha(44,"Cancel"),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(7),Ws("ngIf",n.missionData.originRegion),ho(1),Ws("ngIf",!n.missionData.originRegion),ho(3),Ws("ngIf",!n.missionData.targetSeaEvent&&n.missionData.missionType!==n.missions.EXPEDITION),ho(2),Ws("ngIf",n.isMissionAllowed(n.missions.COLONIZE)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.MOVE)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.SPY)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.PLUNDER)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.CONQUER)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.SEA_MOVE)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.SEA_PLUNDER)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.SEA_CONQUER)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.FISHING)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.HUNTING)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.TREASURE)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.CARTOGRAPHY)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.SEA_BATTLE)),ho(1),Ws("ngIf",n.isMissionAllowed(n.missions.EXPEDITION)),ho(2),Ws("ngIf",n.missionData.originRegion&&n.missionData.missionType!==n.missions.SPY&&n.missionData.missionType!==n.missions.COLONIZE&&n.missionData.missionType!==n.missions.EXPEDITION),ho(1),Ws("ngIf",n.missionData.originRegion&&n.missionData.missionType===n.missions.EXPEDITION),ho(1),Ws("ngIf",n.missionData.originRegion&&n.missionData.missionType===n.missions.COLONIZE),ho(1),Ws("ngIf",n.missionData.originRegion&&n.missionData.missionType===n.missions.SPY),ho(3),Ws("ngIf",n.missionData.missionType===n.missions.COLONIZE),ho(1),Ws("ngIf",n.missionData.missionType!==n.missions.EXPEDITION),ho(1),Ws("ngIf",n.missionData.missionType===n.missions.EXPEDITION),ho(1),Ws("ngIf",n.missionData.missionType===n.missions.EXPEDITION),ho(1),Ws("ngIf",n.missionData.missionType!==n.missions.COLONIZE&&n.missionData.missionType!==n.missions.EXPEDITION),ho(1),Ws("ngIf",!n.canStart()),ho(2),Ws("ngClass",Du(29,kL,!n.canStart())),ho(1),da(n.getMissionName())}}var _L=function(){var e=function(){function e(t,i,n,r,o){var s=this;p(this,e),this.servicesService=t,this.modalService=i,this.idService=n,this.resourcesService=r,this.worldService=o,this.colonistsHolder=0,this.troopsHolder=new Array(Object.values(Bv).length).fill(0),this.expeditionDistance=1,this.discoveredLand=0,this.cannotStartReason="",this.missions=Fv,this.resources=Mv,i.registerForMissionData().subscribe(function(e){s.missionData=e,s.troopsHolder=new Array(Object.values(Bv).length).fill(0),s.colonistsHolder=0,s.discoveredLand=s.worldService.getTotalDiscovered(),s.expeditionDistance=s.calculateMaxDistance(),s.cannotStartReason=""})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"closeModal",value:function(){this.modalService.close(_v.MISSION),this.missionData=null}},{key:"conquer",value:function(){var e=this,t=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,Vv.PLAYER),i=new AC([]);this.getTroops(Fv.CONQUER).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),e.missionData.originRegion.army.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new O_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"colonize",value:function(){if(this.resourcesService.removeRecruit(this.colonistsHolder)){var e=this.worldService.findPath(0,this.missionData.targetRegion.id,Vv.PLAYER);this.worldService.addMission(new R_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),new AC([new CC(Bv.COLONIST,this.colonistsHolder)]),e)),this.closeModal()}else this.modalService.info("Not enough villagers")}},{key:"plunder",value:function(){var e=this,t=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,Vv.PLAYER),i=new AC([]);this.getTroops(Fv.PLUNDER).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),e.missionData.originRegion.army.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new T_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"move",value:function(){var e=this,t=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,Vv.PLAYER),i=new AC([]);this.getTroops(Fv.MOVE).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),e.missionData.originRegion.army.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new A_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"spy",value:function(){var e=this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,Vv.SPECIAL);this.worldService.addMission(new k_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),new AC([new CC(Bv.SPY,this.troopsHolder[Bv.SPY])]),e)),this.missionData.originRegion.army.removeTroop(Bv.SPY,this.troopsHolder[Bv.SPY]),this.closeModal()}},{key:"seaMove",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id),i=new AC([]);this.getTroops(Fv.SEA_MOVE).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON?e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]):e.missionData.originRegion.army.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new U_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"seaPlunder",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id),i=new AC([]);this.getTroops(Fv.SEA_PLUNDER).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON?e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]):e.missionData.originRegion.army.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new F_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"seaConquer",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id),i=new AC([]);this.getTroops(Fv.SEA_CONQUER).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON?e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]):e.missionData.originRegion.army.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new x_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"fishing",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),i=new AC([]);this.getTroops(Fv.FISHING).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),(t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON)&&e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new __(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"hunting",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),i=new AC([]);this.getTroops(Fv.HUNTING).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),(t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON)&&e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new w_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"treasure",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),i=new AC([]);this.getTroops(Fv.TREASURE).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),(t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON)&&e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new P_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"cartography",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),i=new AC([]);this.getTroops(Fv.CARTOGRAPHY).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),(t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON)&&e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new D_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"seaBattle",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId),i=new AC([]);this.getTroops(Fv.SEA_BATTLE).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),(t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON)&&e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]))}),this.worldService.addMission(new L_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t)),this.closeModal()}},{key:"expedition",value:function(){var e=this,t=this.worldService.findSeaPath(this.missionData.originRegion.id,-9999),i=new AC([]);this.getTroops(Fv.EXPEDITION).forEach(function(t){e.troopsHolder[t]>0&&(i.addTroop(t,e.troopsHolder[t]),t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON?e.missionData.originRegion.navy.removeTroop(t,e.troopsHolder[t]):e.missionData.originRegion.army.removeTroop(t,e.troopsHolder[t]))});var n=new M_(this.servicesService,this.idService.getNextId(),this.worldService.getPlayerCountry(),i,t);n.data=this.calculateExpeditionChance(),this.worldService.addMission(n),this.closeModal()}},{key:"prepareViewbox",value:function(e){return e.x-65+" "+(e.y-65)+" 130 130"}},{key:"isMissionAllowed",value:function(e){if(this.missionData.missionType===Fv.EXPEDITION&&e===Fv.EXPEDITION)return!0;if(this.missionData.targetRegionCountry)if(this.missionData.targetRegionCountry===Vv.PLAYER){if(e===Fv.MOVE||e===Fv.SEA_MOVE&&this.isSeaAvailable())return!0}else if(this.missionData.targetRegionCountry===Vv.NEUTRAL){if(e===Fv.MOVE||e===Fv.COLONIZE||e===Fv.SEA_MOVE&&this.isSeaAvailable())return!0}else{if(e===Fv.SPY)return!0;if((e===Fv.PLUNDER||e===Fv.CONQUER)&&this.hasPath())return!0;if((e===Fv.SEA_PLUNDER||e===Fv.SEA_CONQUER)&&this.hasSeaPath())return!0}else if(this.missionData.targetSeaEvent&&(this.missionData.targetSeaEvent.type===jv.FISH&&e===Fv.FISHING||this.missionData.targetSeaEvent.type===jv.SHARK&&e===Fv.HUNTING||this.missionData.targetSeaEvent.type===jv.TREASURE&&e===Fv.TREASURE||this.missionData.targetSeaEvent.type===jv.CARTOGRAPHY&&e===Fv.CARTOGRAPHY||this.missionData.targetSeaEvent.type===jv.PIRATES&&e===Fv.SEA_BATTLE||this.missionData.targetSeaEvent.type===jv.PIRATES_BASE&&e===Fv.SEA_BATTLE))return!0;return!1}},{key:"hasPath",value:function(){return!!(this.missionData.originRegion&&this.missionData.targetRegion&&this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,Vv.PLAYER,!0))}},{key:"hasSeaPath",value:function(){return!!(this.missionData.originRegion&&this.missionData.targetRegion&&this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,!0))}},{key:"changeMission",value:function(e){this.missionData.missionType=e,e===Fv.COLONIZE&&(this.missionData.originRegion=this.worldService.getRegion(0),this.missionData.originRegionColour=this.worldService.getPlayerCountry().colour)}},{key:"start",value:function(){var e=this;if(this.canStart()){switch(this.missionData.missionType===Fv.EXPEDITION?this.getMissionCost(this.missionData.missionType).forEach(function(t){e.resourcesService.decreaseResource(t.resource,t.amount*e.getUnitsNumber()*e.expeditionDistance,"Mission",!0)}):this.getMissionCost(this.missionData.missionType).forEach(function(t){e.resourcesService.decreaseResource(t.resource,t.amount*e.getUnitsNumber(),"Mission",!0)}),this.missionData.missionType===Fv.EXPEDITION&&this.resourcesService.decreaseResource(Mv.MAP,1,"Mission",!0),this.missionData.missionType){case Fv.MOVE:this.move();break;case Fv.PLUNDER:this.plunder();break;case Fv.CONQUER:this.conquer();break;case Fv.COLONIZE:this.colonize();break;case Fv.SPY:this.spy();break;case Fv.SEA_MOVE:this.seaMove();break;case Fv.SEA_PLUNDER:this.seaPlunder();break;case Fv.SEA_CONQUER:this.seaConquer();break;case Fv.FISHING:this.fishing();break;case Fv.HUNTING:this.hunting();break;case Fv.TREASURE:this.treasure();break;case Fv.CARTOGRAPHY:this.cartography();break;case Fv.SEA_BATTLE:this.seaBattle();break;case Fv.EXPEDITION:this.expedition()}this.troopsHolder=new Array(Object.values(Bv).length).fill(0),this.colonistsHolder=0}}},{key:"getTroopName",value:function(e){return Qv.prepareTroopName(e)}},{key:"getTroops",value:function(e){return e===Fv.MOVE?[Bv.SPY,Bv.MILITIA,Bv.SPEARMAN,Bv.ARCHER,Bv.SWORDSMAN,Bv.LIGHT_CAVALRY,Bv.HORSE_ARCHER]:e===Fv.SEA_MOVE?[Bv.MILITIA,Bv.SPEARMAN,Bv.ARCHER,Bv.SWORDSMAN,Bv.LIGHT_CAVALRY,Bv.HORSE_ARCHER,Bv.BOAT,Bv.BRIGANTINE,Bv.GALLEON]:e===Fv.SEA_PLUNDER||e===Fv.SEA_CONQUER||e===Fv.EXPEDITION?[Bv.SPEARMAN,Bv.ARCHER,Bv.SWORDSMAN,Bv.LIGHT_CAVALRY,Bv.HORSE_ARCHER,Bv.BOAT,Bv.BRIGANTINE,Bv.GALLEON]:e===Fv.FISHING||e===Fv.HUNTING||e===Fv.TREASURE||e===Fv.CARTOGRAPHY||e===Fv.SEA_BATTLE?[Bv.BOAT,Bv.BRIGANTINE,Bv.GALLEON]:[Bv.SPEARMAN,Bv.ARCHER,Bv.SWORDSMAN,Bv.LIGHT_CAVALRY,Bv.HORSE_ARCHER]}},{key:"getSpyUnits",value:function(){return[Bv.SPY]}},{key:"getTroop",value:function(e){return e!==Bv.BOAT&&e!==Bv.BRIGANTINE&&e!==Bv.GALLEON?this.missionData.originRegion.army.units.find(function(t){return t.troop===e})||new CC(e,0):this.missionData.originRegion.navy.units.find(function(t){return t.troop===e})||new CC(e,0)}},{key:"changeOrigin",value:function(){var e=this;if(this.missionData.missionType!==Fv.COLONIZE){this.modalService.open(_v.WORLD),this.modalService.setRegionSelection(!0);var t=this.modalService.registerForReturnRegion().subscribe(function(i){t.unsubscribe(),null!==i&&(e.missionData.originRegionColour=e.worldService.getCountryByRegionId(i.id).colour,e.missionData.originRegion=i,e.troopsHolder=new Array(Object.values(Bv).length).fill(0))})}else this.modalService.info("Cannot change origin region for colonization mission")}},{key:"changeTarget",value:function(){var e=this;this.modalService.open(_v.WORLD),this.modalService.setRegionSelection(!1);var t=this.modalService.registerForReturnRegion().subscribe(function(i){if(t.unsubscribe(),null!==i){var n=e.worldService.getCountryByRegionId(i.id);e.missionData.targetRegionColour=n.colour,e.missionData.targetRegionCountry=n.id,e.missionData.targetRegion=i,n.id===Vv.PLAYER||n.id===Vv.NEUTRAL?e.isMissionAllowed(e.missionData.missionType)||(e.missionData.missionType=Fv.MOVE):e.isMissionAllowed(e.missionData.missionType)||(e.missionData.missionType=Fv.PLUNDER,e.troopsHolder[Bv.MILITIA]=0)}})}},{key:"canStart",value:function(){var e=this,t=!1;if(this.missionData.originRegion&&this.missionData.targetRegion&&this.missionData.originRegion!==this.missionData.targetRegion?this.missionData.missionType===Fv.SPY&&this.troopsHolder[Bv.SPY]>0?t=!0:this.missionData.missionType===Fv.COLONIZE?t=this.colonistsHolder>0:this.anyTroops()&&(t=!0):this.missionData.originRegion&&this.missionData.targetSeaEvent?this.anyTroops()&&(t=!0):this.missionData.originRegion&&this.missionData.missionType===Fv.EXPEDITION&&this.anyTroops()&&(t=!0),this.missionData.missionType===Fv.FISHING||this.missionData.missionType===Fv.HUNTING||this.missionData.missionType===Fv.TREASURE||this.missionData.missionType===Fv.CARTOGRAPHY||this.missionData.missionType===Fv.SEA_BATTLE)this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetSeaEvent.parentId,!0)||(t=!1,this.cannotStartReason="no sea path available");else if(this.missionData.originRegion&&this.missionData.targetRegion&&this.missionData.originRegion!==this.missionData.targetRegion&&this.missionData.missionType===Fv.SEA_MOVE||this.missionData.missionType===Fv.SEA_PLUNDER||this.missionData.missionType===Fv.SEA_CONQUER||this.missionData.missionType===Fv.EXPEDITION)this.missionData.missionType===Fv.EXPEDITION?(this.worldService.findSeaPath(this.missionData.originRegion.id,-9999,!0)||(t=!1,this.cannotStartReason="no sea path available"),this.hasResource(Mv.MAP,1)||(t=!1,this.cannotStartReason="missing map resource"),this.calculateExpeditionChance()<=0&&(t=!1,this.cannotStartReason="expedition chance too low"),this.calculateExpeditionLand()<=0&&(t=!1,this.cannotStartReason="estimated land from expedition too low")):this.worldService.findSeaPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,!0)||(t=!1,this.cannotStartReason="no sea path available"),t&&0===this.getNavyCapacity()&&(t=!1,this.cannotStartReason="not enough cargo capacity"),t&&this.getCargoUtilization()>this.getNavyCapacity()&&(t=!1,this.cannotStartReason="not enough cargo capacity");else if(t&&(this.worldService.findPath(this.missionData.originRegion.id,this.missionData.targetRegion.id,Vv.PLAYER,!0)||(t=!1,this.cannotStartReason="no land path available")),t)for(var i=0;i<this.troopsHolder.length;i++)this.troopsHolder[i]>0&&(void 0===this.missionData.originRegion.army.getUnit(i)||this.missionData.originRegion.army.getUnit(i).size<this.troopsHolder[i])&&(t=!1,this.cannotStartReason="not enough troops available");return t&&(this.missionData.missionType!==Fv.EXPEDITION?this.getMissionCost(this.missionData.missionType).forEach(function(i){e.hasResource(i.resource,i.amount*e.getUnitsNumber())||(t=!1,e.cannotStartReason="not enough resources")}):this.getMissionCost(this.missionData.missionType).forEach(function(i){e.hasResource(i.resource,i.amount*e.getUnitsNumber()*e.expeditionDistance)||(t=!1,e.cannotStartReason="not enough resources")})),t}},{key:"anyTroops",value:function(){var e=!1;return this.troopsHolder.forEach(function(t){t>0&&(e=!0)}),e}},{key:"getFreeWorkers",value:function(){return this.resourcesService.getPeople()<20?this.resourcesService.getPeople():20}},{key:"getMissionCost",value:function(e){return lm.getMission(e).COST}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"getUnitsNumber",value:function(){var e=0;if(this.missionData.missionType===Fv.COLONIZE)e=this.colonistsHolder;else for(var t=0;t<this.troopsHolder.length-1;t++)t!==Bv.BOAT&&t!==Bv.BRIGANTINE&&t!==Bv.GALLEON&&(e+=this.troopsHolder[t]);return e}},{key:"hasResource",value:function(e,t){return 0===this.resourcesService.hasResource(e,t,"Mission",!0)}},{key:"getUnitsStrength",value:function(){for(var e=0,t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(this.missionData.missionType===Fv.SEA_MOVE||this.missionData.missionType===Fv.SEA_PLUNDER||this.missionData.missionType===Fv.SEA_CONQUER?t!==Bv.BOAT&&t!==Bv.BRIGANTINE&&t!==Bv.GALLEON&&(e+=lm.getTroop(t).STRENGTH*this.troopsHolder[t]):e+=lm.getTroop(t).STRENGTH*this.troopsHolder[t]);return e}},{key:"getUnitsDefense",value:function(){for(var e=0,t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(this.missionData.missionType===Fv.SEA_MOVE||this.missionData.missionType===Fv.SEA_PLUNDER||this.missionData.missionType===Fv.SEA_CONQUER?t!==Bv.BOAT&&t!==Bv.BRIGANTINE&&t!==Bv.GALLEON&&(e+=lm.getTroop(t).DEFENSE*this.troopsHolder[t]):e+=lm.getTroop(t).DEFENSE*this.troopsHolder[t]);return e}},{key:"getMissionName",value:function(){return void 0!==this.missionData.missionType?Qv.prepareMissionName(this.missionData.missionType):"no mission"}},{key:"getUnitsSpeed",value:function(){for(var e=0,t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(0===e&&(e=lm.getTroop(t).SPEED),lm.getTroop(t).SPEED<e&&(e=lm.getTroop(t).SPEED));return e}},{key:"getSeaUnitsSpeed",value:function(){for(var e=0,t=0;t<this.troopsHolder.length;t++)this.troopsHolder[t]>0&&(t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON)&&(0===e&&(e=lm.getTroop(t).SPEED),lm.getTroop(t).SPEED<e&&(e=lm.getTroop(t).SPEED));return e}},{key:"selectAll",value:function(){var e=this;this.getTroops(this.missionData.missionType).forEach(function(t){e.troopsHolder[t]=e.getTroop(t).size})}},{key:"clearAll",value:function(){for(var e=0;e<this.troopsHolder.length;e++)this.troopsHolder[e]=0}},{key:"isSeaAvailable",value:function(){return this.missionData.originRegion.neighbours.includes(-1)&&this.missionData.targetRegion.neighbours.includes(-1)}},{key:"isSeaLandMission",value:function(){return this.missionData.missionType===Fv.SEA_MOVE||this.missionData.missionType===Fv.SEA_PLUNDER||this.missionData.missionType===Fv.SEA_CONQUER||this.missionData.missionType===Fv.EXPEDITION}},{key:"getCargoUtilization",value:function(){for(var e=this,t=0,i=0;i<this.troopsHolder.length-1;i++)i!==Bv.ALL&&i!==Bv.BOAT&&i!==Bv.BRIGANTINE&&i!==Bv.GALLEON&&this.troopsHolder[i]>0&&(t+=this.troopsHolder[i]*lm.getTroop(i).SIZE);var n=0;return this.missionData.missionType===Fv.EXPEDITION&&this.getUnitsNumber()>0&&this.expeditionDistance>0&&(this.getMissionCost(this.missionData.missionType).forEach(function(t){n+=t.amount*e.getUnitsNumber()*e.expeditionDistance}),t+=Math.ceil(n/1e3)),t}},{key:"getNavyCapacity",value:function(){for(var e=0,t=0;t<this.troopsHolder.length-1;t++)(t===Bv.BOAT||t===Bv.BRIGANTINE||t===Bv.GALLEON)&&this.troopsHolder[t]>0&&(e+=this.troopsHolder[t]*lm.getTroop(t).CARGO);return e}},{key:"calculateExpeditionChance",value:function(){return this.discoveredLand=this.worldService.getTotalDiscovered(),Math.max(this.expeditionDistance-this.discoveredLand,0)}},{key:"calculateMaxDistance",value:function(){return this.discoveredLand=this.worldService.getTotalDiscovered(),this.discoveredLand+100}},{key:"calculateExpeditionLand",value:function(){for(var e=0,t=0;t<this.troopsHolder.length-1;t++)t!==Bv.ALL&&t!==Bv.BOAT&&t!==Bv.BRIGANTINE&&t!==Bv.GALLEON&&this.troopsHolder[t]>0&&(e+=this.troopsHolder[t]*(lm.getTroop(t).STRENGTH+lm.getTroop(t).DEFENSE));return e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs($v),Bs(Jv),Bs(wR),Bs(DE),Bs(G_))},e.\u0275cmp=it({type:e,selectors:[["app-mission-modal"]],decls:4,vars:1,consts:[["id","mission-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],["id","regions"],[1,"region"],[1,"center"],[4,"ngIf"],[3,"click"],["class","region",4,"ngIf"],["id","missions"],["class","mission",3,"ngClass","click",4,"ngIf"],["id","secondHalf"],["id","bottomSection"],["id","costs"],["class","stats",4,"ngIf"],["class","rejectionReason",4,"ngIf"],["id","buttons"],["id","startButton",3,"ngClass","click"],[1,"regionSVG"],[1,"mission",3,"ngClass","click"],["src","assets/army/mission/colonize.svg"],["src","assets/army/mission/move.svg"],["src","assets/army/mission/spy.svg"],["src","assets/army/mission/plunder.svg"],["src","assets/army/mission/conquer.svg"],["src","assets/army/mission/sea_move.svg"],["src","assets/army/mission/sea_plunder.svg"],["src","assets/army/mission/sea_conquer.svg"],["src","assets/sea/fish.svg",1,"seaIcon"],["src","assets/sea/shark.svg",1,"seaIcon"],["src","assets/sea/treasure.svg",1,"seaIcon"],["src","assets/sea/sextant.svg",1,"seaIcon"],["src","assets/sea/pirate_flag.svg",1,"seaIcon"],["src","assets/resources/map.svg",1,"seaIcon"],[4,"ngFor","ngForOf"],[1,"troopLabel"],["type","number","min","0",1,"armyInput",3,"max","ngModel","ngModelChange"],[1,"slidecontainer"],["type","range","min","0",1,"slider",3,"max","ngModel","ngModelChange"],["for","distanceInput"],["id","distanceInput","type","number",3,"min","max","ngModel","ngModelChange"],[1,"stats"],[1,"icon"],[3,"name","path"],["id","costList"],["class","icon",4,"ngFor","ngForOf"],["id","totalCostList"],[3,"ngClass"],[3,"name"],["class","icon",4,"ngIf"],[1,"rejectionReason"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),Gs(2,NL,45,31,"div",2),Ys(),js(3,"div",3),Ys()),2&e&&(ho(2),Ws("ngIf",t.missionData))},directives:[qP,Gl,xl,Ul,tT,JO,xO,qR,vO,DO,WO,oT],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#regions[_ngcontent-%COMP%]{display:flex;flex-direction:row}.region[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px}.regionSVG[_ngcontent-%COMP%]{border:black solid 1px}.center[_ngcontent-%COMP%]{text-align:center}#missions[_ngcontent-%COMP%]{display:flex;flex-direction:row}.mission[_ngcontent-%COMP%]{height:50px;width:50px;border:black solid 1px;padding:5px;margin:10px;opacity:.3;cursor:pointer}.selectedMission[_ngcontent-%COMP%]{opacity:1;cursor:auto;cursor:initial}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px}.slidecontainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:3px;width:300px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.armyInput[_ngcontent-%COMP%]{width:5ch}#distanceInput[_ngcontent-%COMP%]{width:8ch}.troopLabel[_ngcontent-%COMP%]{display:inline-block;width:150px}.inactive[_ngcontent-%COMP%]{color:#5f5f5f}.inactive[_ngcontent-%COMP%]:hover{cursor:auto;cursor:initial}.inactive[_ngcontent-%COMP%]:active{background-color:var(--passive-colour)}#secondHalf[_ngcontent-%COMP%]{font-size:.7em;padding-bottom:10px}#costs[_ngcontent-%COMP%]{text-align:center}#costList[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}#totalCostList[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-right:3px}.notAvailable[_ngcontent-%COMP%]{color:var(--negative-colour)}#bottomSection[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;margin-top:10px}#bottomSection[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:10px}.stats[_ngcontent-%COMP%]{text-align:center}#startButton[_ngcontent-%COMP%]{white-space:nowrap}.seaIcon[_ngcontent-%COMP%]{height:50px;width:50px}.rejectionReason[_ngcontent-%COMP%]{color:var(--negative-colour);font-size:.6em}"]}),e}();function wL(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span",5),ha(2,"Clothes"),Ys(),zs(3,"input",15),$s("input",function(){return Kt(i),ta().calculateStats()})("ngModelChange",function(e){return Kt(i),ta().clothes=e}),Ys(),ha(4),Ys()}if(2&e){var n=ta();ho(3),ia("max",n.getMaxClothes()),Ws("ngModel",n.clothes),ho(1),ga("/",n.getMaxClothes()," ")}}function PL(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span",5),ha(2,"Beer"),Ys(),zs(3,"input",15),$s("input",function(){return Kt(i),ta().calculateStats()})("ngModelChange",function(e){return Kt(i),ta().beer=e}),Ys(),ha(4),Ys()}if(2&e){var n=ta();ho(3),ia("max",n.getMaxBeer()),Ws("ngModel",n.beer),ho(1),ga("/",n.getMaxBeer()," ")}}function ML(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span",5),ha(2,"Wine"),Ys(),zs(3,"input",15),$s("input",function(){return Kt(i),ta().calculateStats()})("ngModelChange",function(e){return Kt(i),ta().wine=e}),Ys(),ha(4),Ys()}if(2&e){var n=ta();ho(3),ia("max",n.getMaxWine()),Ws("ngModel",n.wine),ho(1),ga("/",n.getMaxWine()," ")}}function DL(e,t){if(1&e){var i=qs();zs(0,"div"),zs(1,"span",5),ha(2,"Jewelry"),Ys(),zs(3,"input",15),$s("input",function(){return Kt(i),ta().calculateStats()})("ngModelChange",function(e){return Kt(i),ta().jewelry=e}),Ys(),ha(4),Ys()}if(2&e){var n=ta();ho(3),ia("max",n.getMaxJewelry()),Ws("ngModel",n.jewelry),ho(1),ga("/",n.getMaxJewelry()," ")}}var LL=function(e){return{notMet:e}};function xL(e,t){if(1&e&&(zs(0,"span",16),js(1,"app-icon",17),ha(2," \xa0"),zs(3,"span",18),ha(4),Ys(),Ys()),2&e){var i=t.$implicit,n=ta();ho(1),Ws("name",n.getResourceName(i.resource))("path","resources")("title",n.getResourceName(i.resource)),ho(2),Ws("ngClass",Du(5,LL,!n.hasResource(i.resource,i.amount))),ho(1),da(i.amount)}}var FL=function(e){return{inactive:e}},UL=function(){var e=function(){function e(t,i,n,r){var o=this;p(this,e),this.modalService=t,this.happinessService=i,this.resourceService=n,this.gameService=r,this.food=1,this.clothes=0,this.beer=0,this.wine=0,this.jewelry=0,this.duration=1,this.happiness=5,t.registerForOnOpen().subscribe(function(e){e===_v.FESTIVAL&&(o.food=Math.ceil(5*o.resourceService.getTotalPeople()/2),o.clothes=0,o.beer=0,o.wine=0,o.jewelry=0,o.happiness=1,o.duration=5)})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("festival-modal").style.display&&(e.preventDefault(),this.modalService.close(_v.FESTIVAL))}},{key:"closeModal",value:function(){this.modalService.close(_v.FESTIVAL)}},{key:"startFestival",value:function(){var e=this;this.canStart(!0)&&(this.getCost().forEach(function(t){e.resourceService.decreaseResource(t.resource,t.amount,"Festival",!0)}),this.happinessService.addHappinessEffect(0,Kv.FESTIVAL,this.happiness,this.duration),this.modalService.close(_v.FESTIVAL))}},{key:"getDuration",value:function(){return this.duration}},{key:"getPoints",value:function(){return Math.floor((2*this.food+500*this.clothes+125*this.wine+75*this.beer+300*this.jewelry*25)/this.resourceService.getTotalPeople())}},{key:"getHappiness",value:function(){return this.happiness}},{key:"getCost",value:function(){var e=[];return this.food>0&&e.push({resource:Mv.FOOD,amount:this.food}),this.clothes>0&&e.push({resource:Mv.CLOTHES,amount:this.clothes}),this.beer>0&&e.push({resource:Mv.BEER,amount:this.beer}),this.wine>0&&e.push({resource:Mv.WINE,amount:this.wine}),this.jewelry>0&&e.push({resource:Mv.JEWELRY,amount:this.jewelry}),e}},{key:"getMaxHappinessThreshold",value:function(){return this.gameService.isEnabled(wv.JEWELRY)||this.resourceService.getResource(Mv.JEWELRY).isVisible()?20:this.gameService.isEnabled(wv.ALCOHOL)?15:this.gameService.isEnabled(wv.TAILOR)?10:4}},{key:"canStart",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.calculateStats(),this.happiness<1)return t&&this.modalService.info("Happiness must be at least 1"),!1;if(this.duration<1)return t&&this.modalService.info("Duration must be at least 1"),!1;var i=!0;return this.getCost().forEach(function(t){i&&(i=0===e.resourceService.hasResource(t.resource,t.amount,"Festival",!0))}),!i&&t&&this.modalService.info("Not enough resources!"),i}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"getNutrition",value:function(){return this.resourceService.getFoodValue("Festival",!0)}},{key:"getMaxClothes",value:function(){return this.resourceService.getResource(Mv.CLOTHES).amount}},{key:"getMaxWine",value:function(){return this.resourceService.getResource(Mv.WINE).amount}},{key:"getMaxBeer",value:function(){return this.resourceService.getResource(Mv.BEER).amount}},{key:"getMaxJewelry",value:function(){return this.resourceService.getResource(Mv.JEWELRY).amount}},{key:"isClothesEnabled",value:function(){return this.gameService.isEnabled(wv.TAILOR)}},{key:"isAlcoholEnabled",value:function(){return this.gameService.isEnabled(wv.ALCOHOL)}},{key:"isJewelryEnabled",value:function(){return this.gameService.isEnabled(wv.JEWELRY)||this.resourceService.getResource(Mv.JEWELRY).isVisible()}},{key:"calculateStats",value:function(){this.duration=Math.floor(this.getPoints()/this.happiness)}},{key:"hasResource",value:function(e,t){return 0===this.resourceService.hasResource(e,t,"Festival",!0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(_E),Bs(DE),Bs(_m))},e.\u0275cmp=it({type:e,selectors:[["app-festival-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:33,vars:14,consts:[["id","festival-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["id","text"],[1,"label"],["type","number","min","1",1,"input",3,"max","ngModel","input","ngModelChange"],[4,"ngIf"],["id","costList"],[1,"iconsLine"],["class","icon",4,"ngFor","ngForOf"],["id","buttons"],[3,"ngClass","click"],[3,"click"],[1,"modal-background"],["type","number","min","0",1,"input",3,"max","ngModel","input","ngModelChange"],[1,"icon"],[3,"name","path","title"],[3,"ngClass"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"div",3),ha(4,"Festival preparations"),Ys(),zs(5,"span",4),ha(6,"\xa0"),Ys(),js(7,"br"),zs(8,"div"),zs(9,"span",5),ha(10,"Food"),Ys(),zs(11,"input",6),$s("input",function(){return t.calculateStats()})("ngModelChange",function(e){return t.food=e}),Ys(),ha(12),Ys(),Gs(13,wL,5,3,"div",7),Gs(14,PL,5,3,"div",7),Gs(15,ML,5,3,"div",7),Gs(16,DL,5,3,"div",7),js(17,"hr"),zs(18,"div",8),zs(19,"div",9),Gs(20,xL,5,7,"span",10),Ys(),Ys(),zs(21,"span"),ha(22),Ys(),zs(23,"span"),ha(24),Ys(),zs(25,"span"),ha(26),Ys(),zs(27,"div",11),zs(28,"button",12),$s("click",function(){return t.startFestival()}),ha(29,"Start festival"),Ys(),zs(30,"button",13),$s("click",function(){return t.closeModal()}),ha(31,"Cancel"),Ys(),Ys(),Ys(),Ys(),js(32,"div",14),Ys()),2&e&&(ho(11),ia("max",t.getNutrition()),Ws("ngModel",t.food),ho(1),ga("/",t.getNutrition()," "),ho(1),Ws("ngIf",t.isClothesEnabled()),ho(1),Ws("ngIf",t.isAlcoholEnabled()),ho(1),Ws("ngIf",t.isAlcoholEnabled()),ho(1),Ws("ngIf",t.isJewelryEnabled()),ho(4),Ws("ngForOf",t.getCost()),ho(2),ga("Festival Points: ",t.getPoints(),""),ho(2),ga("Festival happiness: ",t.getHappiness(),""),ho(2),ga("Festival duration: ",t.getDuration()," days"),ho(2),Ws("ngClass",Du(12,FL,!t.canStart())))},directives:[qP,tT,JO,xO,qR,vO,DO,Gl,Ul,xl,oT],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:160px auto auto}#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em;font-weight:800}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px;white-space:nowrap}.slidecontainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:3px;width:300px}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;border-radius:5px;background:var(--passive-colour);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:15px;height:15px;border-radius:50%;background:var(--active-colour);cursor:pointer}.label[_ngcontent-%COMP%]{display:inline-block;width:150px}.input[_ngcontent-%COMP%]{width:10ch}.inactive[_ngcontent-%COMP%]{color:#5f5f5f}.iconsLine[_ngcontent-%COMP%]{display:flex;flex-direction:row}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-right:7px}hr[_ngcontent-%COMP%]{border-color:#000;width:50%}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e}(),HL=["input"];function GL(e,t){1&e&&(zs(0,"span"),ha(1,"buy"),Ys())}function BL(e,t){1&e&&(zs(0,"span"),ha(1,"sell"),Ys())}function WL(e,t){1&e&&(zs(0,"span"),ha(1,"BUY"),Ys())}function VL(e,t){1&e&&(zs(0,"span"),ha(1,"SELL"),Ys())}function zL(e,t){if(1&e){var i=qs();zs(0,"div",4),zs(1,"span",5),ha(2,"Market offer"),Ys(),zs(3,"span",6),ha(4,"How many "),js(5,"app-icon",7),ha(6),Gs(7,GL,2,0,"span",8),Gs(8,BL,2,0,"span",8),ha(9,"?"),Ys(),js(10,"br"),zs(11,"span",9),zs(12,"input",10,11),$s("ngModelChange",function(e){return Kt(i),ta().checkValue(e)})("ngModelChange",function(e){return Kt(i),ta().value=e}),Ys(),ha(14),js(15,"app-icon",7),ha(16),js(17,"app-icon",7),Ys(),js(18,"br"),zs(19,"div",12),zs(20,"button",13),$s("click",function(){return Kt(i),ta().ok()}),Gs(21,WL,2,0,"span",8),Gs(22,VL,2,0,"span",8),Ys(),zs(23,"button",13),$s("click",function(){return Kt(i),ta().cancel()}),ha(24,"CANCEL"),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(5),Ws("name",n.getResourceName(n.offer.resource))("path","resources"),ho(1),fa("(",n.getResourceAmount(),"/",n.getResourceLimit(),") would you like to "),ho(1),Ws("ngIf",n.offer.buy),ho(1),Ws("ngIf",!n.offer.buy),ho(4),Ws("ngModel",n.value),ho(2),ga("/",n.offer.amount," "),ho(1),Ws("name",n.getResourceName(n.offer.resource))("path","resources"),ho(1),ga(" for ",n.calculatePrice()," "),ho(1),Ws("name","coins")("path","resources"),ho(4),Ws("ngIf",n.offer.buy),ho(1),Ws("ngIf",!n.offer.buy)}}var YL=function(){var e=function(){function e(t,i){p(this,e),this.modalService=t,this.resourcesService=i}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.modalService.registerForValue().subscribe(function(t){t&&void 0!==t.id&&(e.offer=t,e.value=e.offer.amount,e.inputRef&&(e.inputRef.nativeElement.style.width=e.value.toString().length+1+"ch"))})}},{key:"ok",value:function(){this.checkValue(this.value),this.modalService.sendValueInput(Number(this.value)),this.modalService.close(_v.MARKET),this.offer=null}},{key:"cancel",value:function(){this.modalService.sendValueInput(null),this.offer=null,this.modalService.close(_v.MARKET)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("market-modal").style.display&&(e.preventDefault(),this.ok())}},{key:"getResourceName",value:function(e){return Mv[e]}},{key:"calculatePrice",value:function(){var e=this.value;return this.offer.amount<e&&(e=this.offer.amount),this.offer.buy?Math.ceil(e/this.offer.amount*this.offer.price):Math.floor(e/this.offer.amount*this.offer.price)}},{key:"checkValue",value:function(e){if(e&&!isNaN(e)){if(this.offer.amount>=e)return!0;this.inputRef.nativeElement.value=this.offer.amount,this.value=this.offer.amount}return!1}},{key:"getResourceAmount",value:function(){return this.resourcesService.getResource(this.offer.resource).amount}},{key:"getResourceLimit",value:function(){return this.resourcesService.getResource(this.offer.resource).limit}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(DE))},e.\u0275cmp=it({type:e,selectors:[["app-market-modal"]],viewQuery:function(e,t){var i;(1&e&&rc(HL,5),2&e)&&(nc(i=sc())&&(t.inputRef=i.first))},hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:4,vars:1,consts:[["id","market-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],["id","text",1,"icon"],[3,"name","path"],[4,"ngIf"],[1,"icon"],["id","input",3,"ngModel","ngModelChange"],["input",""],["id","buttons"],[3,"click"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),Gs(2,zL,25,15,"div",2),Ys(),js(3,"div",3),Ys()),2&e&&(ho(2),Ws("ngIf",t.offer))},directives:[qP,Gl,oT,qR,vO,DO],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:5px}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}#input[_ngcontent-%COMP%]{display:inline-block;width:3ch;font-size:1em}app-icon[_ngcontent-%COMP%]{display:inline-block;margin:0 3px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}"]}),e}();function jL(e,t){1&e&&(Ks(0),ha(1," working"),Qs())}function KL(e,t){1&e&&(Ks(0),ha(1," not working"),Qs())}function QL(e,t){if(1&e){var i=qs();Ks(0),zs(1,"button",23),$s("click",function(){return Kt(i),ta(2).stop()}),ha(2,"Hire worker"),Ys(),Qs()}}function qL(e,t){if(1&e){var i=qs();Ks(0),zs(1,"button",23),$s("click",function(){return Kt(i),ta(2).stop()}),ha(2,"Fire worker"),Ys(),Qs()}}function XL(e,t){if(1&e){var i=qs();zs(0,"div",24),ha(1),zs(2,"input",7),$s("ngModelChange",function(e){return Kt(i),ta(2).building.getWorkSettings().customRuleEnabled=e}),Ys(),js(3,"br"),Ys()}if(2&e){var n=ta(2);ho(1),ga(" ",n.building.getWorkSettings().customRuleText," "),ho(1),Ws("ngModel",n.building.getWorkSettings().customRuleEnabled)}}function ZL(e,t){if(1&e){var i=qs();zs(0,"div"),js(1,"app-icon",27),ha(2," > "),zs(3,"input",28),$s("ngModelChange",function(e){return Kt(i).$implicit[1]=e}),Ys(),ha(4),Ys()}if(2&e){var n=t.$implicit,r=ta(3);ho(1),Ws("name",r.getResourceName(n[0]))("path","resources"),ho(2),Ws("ngModel",n[1]),ho(1),fa(" ( ",r.getResource(n[0]).amount,"/",r.getResource(n[0]).limit," ) ")}}function $L(e,t){if(1&e&&(zs(0,"div",25),ha(1," Input resources: "),Gs(2,ZL,5,5,"div",26),Ys()),2&e){var i=ta(2);ho(2),Ws("ngForOf",i.building.getWorkSettings().inputSettings)}}function JL(e,t){1&e&&(zs(0,"span"),ha(1,"\u221e"),Ys())}function ex(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta().$implicit,n=ta(3);ho(1),da(n.getResource(i[0]).limit)}}function tx(e,t){if(1&e){var i=qs();zs(0,"span"),zs(1,"input",28),$s("ngModelChange",function(e){return Kt(i),ta().$implicit[1]=e}),Ys(),ha(2),Ys()}if(2&e){var n=ta().$implicit,r=ta(3);ho(1),Ws("ngModel",n[1]),ho(1),ga(" (",r.getResource(n[0]).amount,"")}}function ix(e,t){1&e&&(zs(0,"span"),ha(1,"\u221e"),Ys())}function nx(e,t){if(1&e&&(zs(0,"span"),ha(1),Ys()),2&e){var i=ta().$implicit,n=ta(3);ho(1),da(n.getResource(i[0]).limit)}}function rx(e,t){if(1&e){var i=qs();zs(0,"div"),js(1,"app-icon",27),ha(2," < "),Gs(3,JL,2,0,"span",6),Gs(4,ex,2,1,"span",6),Gs(5,tx,3,2,"span",6),ha(6," / "),Gs(7,ix,2,0,"span",6),Gs(8,nx,2,1,"span",6),ha(9,") "),zs(10,"input",30),$s("ngModelChange",function(e){return Kt(i).$implicit[2]=e}),Ys(),zs(11,"label",31),ha(12,"full"),Ys(),Ys()}if(2&e){var n=t.$implicit,r=ta(3);ho(1),Ws("name",r.getResourceName(n[0]))("path","resources"),ho(2),Ws("ngIf",n[2]&&r.isCoins(n[0])),ho(1),Ws("ngIf",n[2]&&!r.isCoins(n[0])),ho(1),Ws("ngIf",!n[2]),ho(2),Ws("ngIf",r.isCoins(n[0])),ho(1),Ws("ngIf",!r.isCoins(n[0])),ho(2),Ws("ngModel",n[2])}}function ox(e,t){if(1&e&&(zs(0,"div",29),ha(1," Output resources: "),Gs(2,rx,13,8,"div",26),Ys()),2&e){var i=ta(2);ho(2),Ws("ngForOf",i.building.getWorkSettings().outputSettings)}}function sx(e,t){if(1&e){var i=qs();zs(0,"div",4),zs(1,"span",5),ha(2),Ys(),js(3,"br"),js(4,"br"),ha(5," status: "),Gs(6,jL,2,0,"ng-container",6),Gs(7,KL,2,0,"ng-container",6),Gs(8,QL,3,0,"ng-container",6),Gs(9,qL,3,0,"ng-container",6),js(10,"br"),ha(11," work management on/off "),zs(12,"input",7),$s("ngModelChange",function(e){return Kt(i),ta().building.getWorkSettings().enabled=e}),Ys(),js(13,"br"),js(14,"br"),zs(15,"div",8),zs(16,"div"),ha(17,"Seasonal rules"),Ys(),zs(18,"span",9),zs(19,"label",10),ha(20,"Spring"),Ys(),zs(21,"input",11),$s("ngModelChange",function(e){return Kt(i),ta().building.getWorkSettings().seasons[0]=e}),Ys(),Ys(),zs(22,"span",9),zs(23,"label",12),ha(24,"Summer"),Ys(),zs(25,"input",13),$s("ngModelChange",function(e){return Kt(i),ta().building.getWorkSettings().seasons[1]=e}),Ys(),Ys(),zs(26,"span",9),zs(27,"label",14),ha(28,"Autumn"),Ys(),zs(29,"input",15),$s("ngModelChange",function(e){return Kt(i),ta().building.getWorkSettings().seasons[2]=e}),Ys(),Ys(),zs(30,"span",9),zs(31,"label",16),ha(32,"Winter"),Ys(),zs(33,"input",17),$s("ngModelChange",function(e){return Kt(i),ta().building.getWorkSettings().seasons[3]=e}),Ys(),Ys(),js(34,"br"),js(35,"br"),Ys(),Gs(36,XL,4,2,"div",18),zs(37,"div",19),Gs(38,$L,3,1,"div",20),js(39,"br"),Gs(40,ox,3,1,"div",21),Ys(),js(41,"br"),js(42,"br"),zs(43,"div",22),zs(44,"button",23),$s("click",function(){return Kt(i),ta().applyToAll()}),ha(45,"Apply to all buildings of this type"),Ys(),zs(46,"button",23),$s("click",function(){return Kt(i),ta().ok()}),ha(47,"Close"),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(2),ga("",n.getBuildingName()," work management"),ho(4),Ws("ngIf",n.building.isWorking()),ho(1),Ws("ngIf",!n.building.isWorking()),ho(1),Ws("ngIf",!n.building.getWorkSettings().enabled&&!n.building.isWorking()),ho(1),Ws("ngIf",!n.building.getWorkSettings().enabled&&n.building.isWorking()),ho(3),Ws("ngModel",n.building.getWorkSettings().enabled),ho(9),Ws("ngModel",n.building.getWorkSettings().seasons[0]),ho(4),Ws("ngModel",n.building.getWorkSettings().seasons[1]),ho(4),Ws("ngModel",n.building.getWorkSettings().seasons[2]),ho(4),Ws("ngModel",n.building.getWorkSettings().seasons[3]),ho(3),Ws("ngIf",n.building.getWorkSettings().hasCustomRule),ho(2),Ws("ngIf",n.building.getWorkSettings().inputSettings),ho(2),Ws("ngIf",n.building.getWorkSettings().outputSettings)}}var ax=function(){var e=function(){function e(t,i,n){var r=this;p(this,e),this.servicesService=t,this.modalService=i,this.resourcesService=n,this.modalService.registerForBuilding().subscribe(function(e){r.building=e,setTimeout(function(){var e=window.document.getElementsByClassName("textInput").item(0);e&&e.select()},10)})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.close(_v.WORK_MANAGEMENT)}},{key:"cancel",value:function(){this.modalService.close(_v.WORK_MANAGEMENT)}},{key:"stop",value:function(){this.building.isWorking()?this.building.stopProduction():this.building.startProduction()||this.modalService.info("Cannot unlock production of "+this.building.getName()+". Number of free workers: "+this.resourcesService.getPeople())}},{key:"getBuildingName",value:function(){return Qv.prepareBuildingName(this.building.getBuildingType())}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"getResource",value:function(e){return this.resourcesService.getResource(e)}},{key:"onKeydownHandler",value:function(){"none"!==document.getElementById("work-management-modal").style.display&&(event.preventDefault(),this.ok())}},{key:"isCoins",value:function(e){return e===Mv.COINS}},{key:"applyToAll",value:function(){var e=this,t=um.getBuildingRegion(this.building.getBuildingType());this.servicesService.getServiceByRegion(t).getBuildings().filter(function(t){return t.getBuildingType()===e.building.getBuildingType()}).forEach(function(t){return t.setWorkSettings(HE.clone(e.building.getWorkSettings()))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs($v),Bs(Jv),Bs(DE))},e.\u0275cmp=it({type:e,selectors:[["app-work-management-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:4,vars:1,consts:[["id","work-management-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],[4,"ngIf"],["type","checkbox",3,"ngModel","ngModelChange"],["id","seasonalRules"],[1,"seasonalRule"],["for","spring"],["id","spring","type","checkbox",3,"ngModel","ngModelChange"],["for","summer"],["id","summer","type","checkbox",3,"ngModel","ngModelChange"],["for","autumn"],["id","autumn","type","checkbox",3,"ngModel","ngModelChange"],["for","winter"],["id","winter","type","checkbox",3,"ngModel","ngModelChange"],["id","customRule",4,"ngIf"],["id","rules"],["id","input",4,"ngIf"],["id","output",4,"ngIf"],["id","buttons"],[3,"click"],["id","customRule"],["id","input"],[4,"ngFor","ngForOf"],[3,"name","path"],[1,"textInput",3,"ngModel","ngModelChange"],["id","output"],["type","checkbox","id","full",3,"ngModel","ngModelChange"],["for","full"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),Gs(2,sx,48,13,"div",2),Ys(),js(3,"div",3),Ys()),2&e&&(ho(2),Ws("ngIf",t.building))},directives:[qP,Gl,jR,vO,DO,Ul,oT,qR],styles:[".modal-body[_ngcontent-%COMP%]{text-align:center;font-size:1.2em}input[_ngcontent-%COMP%]:not([type]), input[type=text][_ngcontent-%COMP%]{width:5ch}#rules[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}#input[_ngcontent-%COMP%]{flex:0 0 50%;border-right:black solid 1px}#output[_ngcontent-%COMP%]{flex:0 0 50%}.seasonalRule[_ngcontent-%COMP%]{margin-right:10px}"]}),e}();function ux(e,t){if(1&e){var i=qs();zs(0,"button",9),$s("click",function(){return Kt(i),ta(2).ok()}),ha(1,"NEXT"),Ys()}}function cx(e,t){if(1&e){var i=qs();zs(0,"button",9),$s("click",function(){return Kt(i),ta(2).finish()}),ha(1,"FINISH"),Ys()}}function lx(e,t){if(1&e){var i=qs();zs(0,"button",9),$s("click",function(){return Kt(i),ta(2).skip()}),ha(1,"SKIP TUTORIAL"),Ys()}}function hx(e,t){if(1&e&&(Ks(0),zs(1,"span",5),ha(2),Ys(),js(3,"div",6),js(4,"span",7),js(5,"br"),js(6,"div",6),Gs(7,ux,2,0,"button",8),Gs(8,cx,2,0,"button",8),Gs(9,lx,2,0,"button",8),Qs()),2&e){var i=ta();ho(2),ga("Tutorial ",i.currentStep+"/"+i.tutorialStages.length,""),ho(2),Ws("innerHTML",i.tutorialStages[i.currentStep-1].text,dr),ho(3),Ws("ngIf",i.currentStep<i.tutorialStages.length),ho(1),Ws("ngIf",i.currentStep===i.tutorialStages.length),ho(1),Ws("ngIf",i.currentStep!==i.tutorialStages.length)}}var dx=function(){var e=function(){function e(t,i,n,r){var o=this;p(this,e),this.modalService=t,this.tutorialService=i,this.tickerService=n,this.text="",this.tutorialStages=[],this.currentStep=1,this.modalService.registerForTutorial().subscribe(function(e){o.tutorialStages=e,o.currentStep=1,r.destroyed||r.detectChanges()})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.tutorialService.enableTutorials()}},{key:"ok",value:function(){this.currentStep+=1,this.modalService.openTutorialModal(this.tutorialStages[this.currentStep-1].position)}},{key:"skip",value:function(){var e=this;this.modalService.open(_v.CONFIRM),this.modalService.setModalText("Are you sure you want to skip tutorial?<br>You can always start it again from the top right settings menu");var t=this.modalService.registerForConfirmation().subscribe(function(i){t.unsubscribe(),i&&(e.modalService.sendTutorialResponse(-1),e.tickerService.start(),e.modalService.close(_v.TUTORIAL))})}},{key:"finish",value:function(){this.modalService.sendTutorialResponse(1),this.tickerService.start(),this.modalService.close(_v.TUTORIAL)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(Nm),Bs(mM),Bs(cu))},e.\u0275cmp=it({type:e,selectors:[["app-tutorial-modal"]],decls:5,vars:1,consts:[["id","tutorial-modal"],[1,"modal"],[1,"modal-body"],[4,"ngIf"],[1,"modal-background"],["id","title"],[1,"space"],["id","text",3,"innerHTML"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),Gs(3,hx,10,5,"ng-container",3),Ys(),Ys(),js(4,"div",4),Ys()),2&e&&(ho(3),Ws("ngIf",t.tutorialStages.length>0))},directives:[qP,Gl],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.space[_ngcontent-%COMP%]{height:20px}"]}),e}(),gx=["text"],fx=function(){var e=function(){function e(t){var i=this;p(this,e),this.modalService=t,this.messageNumber=km.length,this.modalService.registerForCloseModal().subscribe(function(e){return i.messageNumber=km.length}),this.modalService.registerForOnOpen().subscribe(function(e){(e===_v.CHANGELOG||e===_v.ALL)&&(i.textRef.nativeElement.scrollTop=0)})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.close(_v.CHANGELOG)}},{key:"hasPrevious",value:function(){return this.messageNumber>1}},{key:"previous",value:function(){this.messageNumber>1&&(this.messageNumber-=1)}},{key:"hasNext",value:function(){return this.messageNumber<km.length}},{key:"next",value:function(){this.messageNumber<km.length&&(this.messageNumber+=1)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("changelog-modal").style.display&&(e.preventDefault(),this.ok())}},{key:"getChange",value:function(){return km[this.messageNumber-1]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-changelog-modal"]],viewQuery:function(e,t){var i;(1&e&&rc(gx,5),2&e)&&(nc(i=sc())&&(t.textRef=i.first))},hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:15,vars:4,consts:[["id","changelog-modal"],[1,"modal"],[1,"modal-body"],["id","header",3,"innerHTML"],["id","text",3,"innerHTML"],["text",""],["id","buttons"],[3,"disabled","click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),js(3,"span",3),js(4,"div",4,5),js(6,"br"),zs(7,"div",6),zs(8,"button",7),$s("click",function(){return t.previous()}),ha(9,"PREVIOUS"),Ys(),zs(10,"button",8),$s("click",function(){return t.ok()}),ha(11,"CLOSE"),Ys(),zs(12,"button",7),$s("click",function(){return t.next()}),ha(13,"NEXT"),Ys(),Ys(),Ys(),Ys(),js(14,"div",9),Ys()),2&e&&(ho(3),Ws("innerHTML",t.getChange().VERSION,dr),ho(1),Ws("innerHTML",t.getChange().MESSAGE,dr),ho(4),Ws("disabled",!t.hasPrevious()),ho(4),Ws("disabled",!t.hasNext()))},directives:[qP],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{width:50%;display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:0 0 33%}#header[_ngcontent-%COMP%]{font-size:1.5em;font-weight:bold;margin-bottom:10px}#text[_ngcontent-%COMP%]{font-size:1.2em;overflow-y:auto}#text[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0}button[disabled][_ngcontent-%COMP%]{color:#5a5a5a}button[disabled][_ngcontent-%COMP%]:active{background-color:var(--passive-colour);cursor:default}button[disabled][_ngcontent-%COMP%]:hover{cursor:default}"]}),e}(),vx=function(e){return{hidden:e}};function px(e,t){if(1&e){var i=qs();zs(0,"div",32),zs(1,"label",33),ha(2),zs(3,"input",34),$s("ngModelChange",function(e){return Kt(i).$implicit.enabled=e}),Ys(),Ys(),js(4,"br"),zs(5,"input",35),$s("ngModelChange",function(e){return Kt(i).$implicit.reserved=e}),Ys(),js(6,"br"),zs(7,"label",36),ha(8,"reserve %"),Ys(),zs(9,"input",37),$s("ngModelChange",function(e){return Kt(i).$implicit.reservedPercent=e}),Ys(),Ys()}if(2&e){var n=t.$implicit;ho(1),ia("for",n.name),ho(1),da(n.name),ho(1),ia("id",n.name),Ws("ngModel",n.enabled),ho(2),Ws("ngClass",Du(9,vx,!n.enabled))("ngModel",n.reserved),ho(2),Ws("ngClass",Du(11,vx,!n.enabled)),ho(2),Ws("ngClass",Du(13,vx,!n.enabled))("ngModel",n.reservedPercent)}}function mx(e,t){if(1&e){var i=qs();zs(0,"div",4),zs(1,"span",5),ha(2),Ys(),js(3,"br"),js(4,"br"),zs(5,"span",6),zs(6,"label",7),ha(7,"reserved amount: "),Ys(),js(8,"br"),zs(9,"input",8),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.reserve=e}),Ys(),js(10,"br"),zs(11,"label",9),ha(12,"reserve %"),Ys(),zs(13,"input",10),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.reservePercent=e}),Ys(),Ys(),js(14,"br"),js(15,"br"),zs(16,"span",11),ha(17,"Exceptions:"),js(18,"br"),ha(19," (will use it's own limit number if enabled)"),Ys(),js(20,"br"),zs(21,"div",12),Gs(22,px,10,15,"div",13),Ys(),zs(23,"div",11),ha(24,"Auto trade settings"),js(25,"br"),ha(26,"Auto trade will try to buy/sell until you have the specified amount of resource"),Ys(),js(27,"br"),zs(28,"div"),zs(29,"label",14),ha(30,"Auto sell enabled"),Ys(),zs(31,"input",15),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoSellEnabled=e}),Ys(),js(32,"br"),zs(33,"span"),zs(34,"label",16),ha(35,"continuous sell limit"),Ys(),zs(36,"input",17),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoSellAmount=e}),Ys(),zs(37,"input",18),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoSellPercentage=e}),Ys(),zs(38,"label",19),ha(39,"%"),Ys(),Ys(),js(40,"br"),zs(41,"label",20),ha(42,"Fixed one time sell amount"),Ys(),zs(43,"input",21),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoSellOrder=e}),Ys(),js(44,"br"),js(45,"br"),zs(46,"label",22),ha(47,"Auto buy enabled"),Ys(),zs(48,"input",23),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoBuyEnabled=e}),Ys(),js(49,"br"),zs(50,"span"),zs(51,"label",24),ha(52,"continuous buy limit"),Ys(),zs(53,"input",25),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoBuyAmount=e}),Ys(),zs(54,"input",26),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoBuyPercentage=e}),Ys(),zs(55,"label",27),ha(56,"%"),Ys(),Ys(),js(57,"br"),zs(58,"label",28),ha(59,"Fixed one time buy amount"),Ys(),zs(60,"input",29),$s("ngModelChange",function(e){return Kt(i),ta().resourceOptions.autoTrade.autoBuyOrder=e}),Ys(),Ys(),zs(61,"div",30),zs(62,"button",31),$s("click",function(){return Kt(i),ta().ok()}),ha(63,"SAVE"),Ys(),zs(64,"button",31),$s("click",function(){return Kt(i),ta().cancel()}),ha(65,"CANCEL"),Ys(),zs(66,"button",31),$s("click",function(){return Kt(i),ta().reset()}),ha(67,"RESET"),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(2),ga("",n.getResourceName()," management"),ho(7),Ws("ngModel",n.resourceOptions.reserve),ho(4),Ws("ngModel",n.resourceOptions.reservePercent),ho(9),Ws("ngForOf",n.resourceOptions.consumers),ho(9),Ws("ngModel",n.resourceOptions.autoTrade.autoSellEnabled),ho(5),Ws("ngModel",n.resourceOptions.autoTrade.autoSellAmount),ho(1),Ws("ngModel",n.resourceOptions.autoTrade.autoSellPercentage),ho(6),Ws("ngModel",n.resourceOptions.autoTrade.autoSellOrder),ho(5),Ws("ngModel",n.resourceOptions.autoTrade.autoBuyEnabled),ho(5),Ws("ngModel",n.resourceOptions.autoTrade.autoBuyAmount),ho(1),Ws("ngModel",n.resourceOptions.autoTrade.autoBuyPercentage),ho(6),Ws("ngModel",n.resourceOptions.autoTrade.autoBuyOrder)}}var Sx=function(){var e=function(){function e(t){var i=this;p(this,e),this.modalService=t,this.modalService.registerForResourceOptions().subscribe(function(e){i.resourceOptions=OE.clone(e),setTimeout(function(){window.document.getElementById("reserved").select()},10)}),this.modalService.registerForCloseModal().subscribe(function(e){(e===_v.RESOURCE_MANAGEMENT||e===_v.ALL)&&i.modalService.sendResourceOptionsResponse(null)})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.sendResourceOptionsResponse(this.resourceOptions),this.modalService.close(_v.RESOURCE_MANAGEMENT)}},{key:"cancel",value:function(){this.modalService.sendResourceOptionsResponse(null),this.modalService.close(_v.RESOURCE_MANAGEMENT)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("resource-management-modal").style.display&&(e.preventDefault(),this.ok())}},{key:"getResourceName",value:function(){return Qv.prepareResourceName(this.resourceOptions.resource)}},{key:"reset",value:function(){this.resourceOptions=new OE(this.resourceOptions.resource)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-resource-management-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:4,vars:1,consts:[["id","resource-management-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],[1,"entry"],["for","reserved"],["type","number","min","0","id","reserved",3,"ngModel","ngModelChange"],["for","mainPercent"],["id","mainPercent","type","checkbox",3,"ngModel","ngModelChange"],[1,"subTitle"],["id","exceptions"],["class","exceptionEntry",4,"ngFor","ngForOf"],["for","autoSellEnabled",1,"tradeLabel"],["type","checkbox","id","autoSellEnabled",3,"ngModel","ngModelChange"],["for","autoSellAmount",1,"tradeLabel"],["type","number","min","0","id","autoSellAmount",3,"ngModel","ngModelChange"],["id","autoSellPercentage","type","checkbox",3,"ngModel","ngModelChange"],["for","autoSellPercentage"],["for","autoSellOrder",1,"tradeLabel"],["type","number","min","0","id","autoSellOrder",3,"ngModel","ngModelChange"],["for","autoBuyEnabled",1,"tradeLabel"],["type","checkbox","id","autoBuyEnabled",3,"ngModel","ngModelChange"],["for","autoBuyAmount",1,"tradeLabel"],["type","number","min","0","id","autoBuyAmount",3,"ngModel","ngModelChange"],["id","autoBuyPercentage","type","checkbox",3,"ngModel","ngModelChange"],["for","autoBuyPercentage"],["for","autoBuyOrder",1,"tradeLabel"],["type","number","min","0","id","autoBuyOrder",3,"ngModel","ngModelChange"],["id","buttons"],[3,"click"],[1,"exceptionEntry"],[3,"for"],["type","checkbox",3,"id","ngModel","ngModelChange"],["type","number","min","0",3,"ngClass","ngModel","ngModelChange"],["for","percent",3,"ngClass"],["id","percent","type","checkbox",3,"ngClass","ngModel","ngModelChange"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),Gs(2,mx,68,12,"div",2),Ys(),js(3,"div",3),Ys()),2&e&&(ho(2),Ws("ngIf",t.resourceOptions))},directives:[qP,Gl,tT,xO,qR,vO,DO,jR,Ul,xl],styles:[".modal-body[_ngcontent-%COMP%]{padding:40px;display:flex;flex-direction:column;align-items:center;justify-content:center}#title[_ngcontent-%COMP%]{font-size:1.3em;font-weight:bold;margin-bottom:20px}input[type=number][_ngcontent-%COMP%]{width:6ch}#exceptions[_ngcontent-%COMP%]{width:100%;text-align:center}.subTitle[_ngcontent-%COMP%]{padding-top:10px;text-align:center}.entry[_ngcontent-%COMP%]{text-align:center}.exceptionEntry[_ngcontent-%COMP%]{display:inline-block;text-align:center;border:black solid 1px;min-width:100px;min-height:50px;padding:4px 4px 0;margin:5px}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}.hidden[_ngcontent-%COMP%]{visibility:hidden}.tradeLabel[_ngcontent-%COMP%]{display:inline-block;width:200px}"]}),e}(),Ex=function(e){return{selected:e}};function yx(e,t){if(1&e){var i=qs();zs(0,"div",8),zs(1,"app-recipe",9),$s("click",function(){var e=Kt(i).$implicit;return ta().choose(e)}),Ys(),Ys()}if(2&e){var n=t.$implicit,r=ta();ho(1),Ws("ngClass",Du(2,Ex,n.id===r.selectedRecipeId))("recipe",n)}}var Rx=function(){var e=function(){function e(t,i){var n=this;p(this,e),this.modalService=t,this.recipeService=i,this.selectedRecipeId=-1,this.modalService.registerForCloseModal().subscribe(function(e){(e===_v.RECIPE||e===_v.ALL)&&(n.selectedRecipeId=-1,n.modalService.sendValueInput(null))}),this.modalService.registerForValue().subscribe(function(e){n.selectedRecipeId=e})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.sendValueInput(this.selectedRecipeId),this.modalService.close(_v.RECIPE)}},{key:"cancel",value:function(){this.modalService.sendValueInput(null),this.modalService.close(_v.RECIPE)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("recipe-modal").style.display&&(e.preventDefault(),this.ok())}},{key:"getRecipes",value:function(){return this.recipeService.getRecipes()}},{key:"choose",value:function(e){this.selectedRecipeId=e.id}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(Yk))},e.\u0275cmp=it({type:e,selectors:[["app-recipe-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:14,vars:1,consts:[["id","recipe-modal"],[1,"modal"],[1,"modal-body"],["id","recipes"],["class","recipe",4,"ngFor","ngForOf"],["id","buttons"],[3,"click"],[1,"modal-background"],[1,"recipe"],[3,"ngClass","recipe","click"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"span"),ha(4,"Choose recipe"),Ys(),js(5,"br"),zs(6,"div",3),Gs(7,yx,2,4,"div",4),Ys(),zs(8,"div",5),zs(9,"button",6),$s("click",function(){return t.ok()}),ha(10,"CONFIRM"),Ys(),zs(11,"button",6),$s("click",function(){return t.cancel()}),ha(12,"CANCEL"),Ys(),Ys(),Ys(),Ys(),js(13,"div",7),Ys()),2&e&&(ho(7),Ws("ngForOf",t.getRecipes()))},directives:[qP,Ul,vN,xl],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}app-recipe[_ngcontent-%COMP%]{font-size:.8em;display:inline-block;width:110px;margin:4px 8px;cursor:pointer}.recipe[_ngcontent-%COMP%]{display:inline-block}.selected[_ngcontent-%COMP%]{border:black solid 2px}"]}),e}(),Ox=function(e){return{inactive:e}},Tx=function(){var e=function(){function e(t,i){var n=this;p(this,e),this.modalService=t,this.worldService=i,this.on=!1,this.selectOrigin=!0,this.modalService.registerForRegionSelectionOrder().subscribe(function(e){n.selectOrigin=e,n.on=!0})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"select",value:function(){if(this.canSelect()){var e=this.worldService.getSelectedRegion();this.modalService.setReturnRegion(e),this.modalService.close(_v.WORLD),this.on=!1}else this.modalService.info("Only your and neutral regions can be selected as origin")}},{key:"cancel",value:function(){this.modalService.setReturnRegion(null),this.modalService.close(_v.WORLD),this.on=!1}},{key:"canSelect",value:function(){if(!this.on)return!1;var e=this.worldService.getSelectedCountry();return e?!(this.selectOrigin&&e.id!==Vv.PLAYER&&e.id!==Vv.NEUTRAL):void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(G_))},e.\u0275cmp=it({type:e,selectors:[["app-world-modal"]],decls:10,vars:4,consts:[["id","world-modal"],[1,"modal"],[1,"modal-body"],[3,"selecting"],["id","buttons"],[3,"ngClass","click"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),js(3,"app-world",3),zs(4,"div",4),zs(5,"button",5),$s("click",function(){return t.select()}),ha(6,"Select"),Ys(),zs(7,"button",6),$s("click",function(){return t.cancel()}),ha(8,"Cancel"),Ys(),Ys(),Ys(),Ys(),js(9,"div",7),Ys()),2&e&&(ho(3),Ws("selecting",!0),ho(2),Ws("ngClass",Du(2,Ox,!t.canSelect())))},directives:[qP,yP,xl],styles:[".modal-body[_ngcontent-%COMP%]{height:660px;max-height:660px;margin:20px;display:flex;flex-direction:column;align-items:center;justify-content:center}app-world[_ngcontent-%COMP%]{display:inline-block;height:90%;width:90%}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;margin-right:4px}.inactive[_ngcontent-%COMP%]{color:#5f5f5f}.inactive[_ngcontent-%COMP%]:hover{cursor:auto;cursor:initial}"]}),e}(),Ix=function(e){return{notMet:e}};function bx(e,t){if(1&e&&(zs(0,"span"),zs(1,"span",17),zs(2,"span",18),ha(3),Ys(),js(4,"app-icon",19),Ys(),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(2),Ws("ngClass",Du(4,Ix,!n.hasResource(i))),ho(1),da(i.amount),ho(1),Ws("name",n.getResourceName(i.resource))("path","resources")}}function Cx(e,t){if(1&e){var i=qs();zs(0,"button",20),$s("click",function(){Kt(i);var e=ta().$implicit;return ta(2).buildBuilding(e)}),ha(1,"Build "),Ys()}}function Ax(e,t){if(1&e){var i=qs();zs(0,"button",21),$s("click",function(){return Kt(i),ta(3).buildWallNotAvailable()}),ha(1,"Build "),Ys()}}function kx(e,t){if(1&e&&(zs(0,"div",8),zs(1,"div",9),zs(2,"span",10),ha(3),Ys(),zs(4,"div",11),js(5,"div",12),zs(6,"div",13),ha(7,"cost:"),Ys(),Gs(8,bx,5,6,"span",14),Ys(),Ys(),Gs(9,Cx,2,0,"button",15),Gs(10,Ax,2,0,"button",16),Ys()),2&e){var i=t.$implicit,n=ta(2);ho(3),ga("",i.NAME," "),ho(2),Ws("innerHTML",i.DESCRIPTION,dr),ho(3),Ws("ngForOf",n.getBuildingCost(i)),ho(1),Ws("ngIf",n.isCostMet(i)),ho(1),Ws("ngIf",!n.isCostMet(i))}}function Nx(e,t){if(1&e&&(zs(0,"div",4),zs(1,"div",5),ha(2,"Region construction"),Ys(),zs(3,"div",6),Gs(4,kx,11,5,"div",7),Ys(),Ys()),2&e){var i=ta();ho(4),Ws("ngForOf",i.getBuildings())}}var _x=function(){var e=function(){function e(t,i,n,r){var o=this;p(this,e),this.modalService=t,this.resourcesService=i,this.gameService=n,this.worldService=r,this.defensesCost=[[{resource:Mv.LOG,amount:50}],[{resource:Mv.LOG,amount:50},{resource:Mv.PLANK,amount:30}],[{resource:Mv.LOG,amount:50},{resource:Mv.CUT_STONE,amount:30}],[{resource:Mv.LOG,amount:80},{resource:Mv.CUT_STONE,amount:50}],[{resource:Mv.LOG,amount:80},{resource:Mv.PLANK,amount:40},{resource:Mv.CUT_STONE,amount:40}],[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:60},{resource:Mv.CUT_STONE,amount:60}],[{resource:Mv.LOG,amount:100},{resource:Mv.PLANK,amount:80},{resource:Mv.CUT_STONE,amount:80}]],this.modalService.registerForWorldRegion().subscribe(function(e){o.region=e})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"isCostMet",value:function(e){var t=this,i=!0;return this.getBuildingCost(e).forEach(function(e){0!==t.resourcesService.hasResource(e.resource,e.amount,"Region construction",!0)&&(i=!1)}),i}},{key:"buildBuilding",value:function(e){var t=this;this.getBuildingCost(e).forEach(function(e){t.resourcesService.decreaseResource(e.resource,e.amount,"Region construction",!0)}),this.worldService.buildRegionBuilding(e.REGION_BUILDING),this.region=null,this.modalService.close(_v.WORLD_BUILD)}},{key:"hasResource",value:function(e){return 0===this.resourcesService.hasResource(e.resource,e.amount,"Region construction",!0)}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"buildWallNotAvailable",value:function(){this.modalService.info("Not enough resources")}},{key:"getBuildings",value:function(){var e=[];return this.region.defense<7&&e.push(pm.REGION_BUILDINGS.DEFENSES),!this.region.roads&&this.gameService.isEnabled(wv.LOGISTICS)&&e.push(pm.REGION_BUILDINGS.ROADS),!this.region.watchtower&&this.gameService.isEnabled(wv.WOODEN_TOWER)&&e.push(pm.REGION_BUILDINGS.WATCHTOWER),this.gameService.isEnabled(wv.WOODEN_TOWER)&&(void 0===this.region.army.getUnit(Bv.GUARD_TOWER)||this.region.army.getUnit(Bv.GUARD_TOWER).size<5)&&e.push(pm.REGION_BUILDINGS.GUARD_TOWER),this.gameService.isEnabled(wv.HARBOUR)&&!this.region.harbour&&this.region.neighbours.includes(-1)&&e.push(pm.REGION_BUILDINGS.HARBOUR),e}},{key:"getBuildingCost",value:function(e){return e.REGION_BUILDING===dp.DEFENSES?this.defensesCost[this.region.defense]:e.COST}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(DE),Bs(_m),Bs(G_))},e.\u0275cmp=it({type:e,selectors:[["app-world-build-modal"]],decls:4,vars:1,consts:[["id","world-build-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["id","title"],["id","buildings"],["class","building",4,"ngFor","ngForOf"],[1,"building"],[1,"buildingSecondRow"],[1,"buildingTitle"],[1,"details"],["id","description",3,"innerHTML"],[1,"subTitle"],[4,"ngFor","ngForOf"],["class","buildButton",3,"click",4,"ngIf"],["class","buildButtonNotAvailable",3,"click",4,"ngIf"],[1,"icon"],[3,"ngClass"],[3,"name","path"],[1,"buildButton",3,"click"],[1,"buildButtonNotAvailable",3,"click"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),Gs(2,Nx,5,1,"div",2),Ys(),js(3,"div",3),Ys()),2&e&&(ho(2),Ws("ngIf",t.region))},directives:[qP,Gl,Ul,xl,oT],styles:["#title[_ngcontent-%COMP%]{text-align:center;font-size:1.3em}.building[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:center;border:black solid 1px;margin-bottom:10px}.buildingTitle[_ngcontent-%COMP%]{font-weight:600;background-color:var(--active-colour);border-bottom:black solid 1px}.buildingSecondRow[_ngcontent-%COMP%]{display:flex;width:100%;border-right:black solid 1px;flex-direction:column}.details[_ngcontent-%COMP%]{width:100%;text-align:center}.resourceIcon[_ngcontent-%COMP%]{height:20px;width:20px;vertical-align:middle}.description[_ngcontent-%COMP%]{margin-bottom:10px}.icon[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;align-items:center;justify-content:center;margin-right:10px}.buildButton[_ngcontent-%COMP%]{width:30%}.buildButtonNotAvailable[_ngcontent-%COMP%]{width:30%;cursor:not-allowed}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}"]}),e}(),wx=["input"],Px=function(){var e=function(){function e(t){p(this,e),this.modalService=t,this.text="",this.value=""}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.modalService.registerForText().subscribe(function(t){e.text=t,e.inputRef.nativeElement.select()}),this.modalService.registerForValue().subscribe(function(t){return e.value=t})}},{key:"ok",value:function(){this.modalService.sendValueInput(this.value),this.modalService.close(_v.INPUT)}},{key:"cancel",value:function(){this.modalService.sendValueInput(null),this.modalService.close(_v.INPUT)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("input-modal").style.display&&(e.preventDefault(),this.ok())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-input-modal"]],viewQuery:function(e,t){var i;(1&e&&rc(wx,7),2&e)&&(nc(i=sc())&&(t.inputRef=i.first))},hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:14,vars:2,consts:[["id","input-modal"],[1,"modal"],[1,"modal-body"],["id","text",3,"innerHTML"],["id","input",3,"ngModel","ngModelChange"],["input",""],["id","buttons"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),js(3,"span",3),js(4,"br"),zs(5,"input",4,5),$s("ngModelChange",function(e){return t.value=e}),Ys(),js(7,"br"),zs(8,"div",6),zs(9,"button",7),$s("click",function(){return t.ok()}),ha(10,"CONFIRM"),Ys(),zs(11,"button",7),$s("click",function(){return t.cancel()}),ha(12,"CANCEL"),Ys(),Ys(),Ys(),Ys(),js(13,"div",8),Ys()),2&e&&(ho(3),Ws("innerHTML",t.text,dr),ho(2),Ws("ngModel",t.value))},directives:[qP,qR,vO,DO],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}"]}),e}();function Mx(e,t){if(1&e){var i=qs();zs(0,"div",6),js(1,"span",7),js(2,"br"),zs(3,"div",8),zs(4,"button",9),$s("click",function(){return Kt(i),ta(2).ok()}),ha(5,"YES"),Ys(),zs(6,"button",9),$s("click",function(){return Kt(i),ta(2).cancel()}),ha(7,"NO"),Ys(),Ys(),Ys()}if(2&e){var n=ta(2);ho(1),Ws("innerHTML","Are you sure you want to start researching "+n.tech.getTechName()+"?",dr)}}function Dx(e,t){1&e&&(zs(0,"div",6),ha(1," Research queue is full "),js(2,"br"),Ys())}var Lx=function(e){return{disabled:e}};function xx(e,t){if(1&e){var i=qs();zs(0,"div",6),js(1,"hr"),ha(2),zs(3,"div",8),zs(4,"button",10),$s("click",function(){return Kt(i),ta(2).unlockWithHeritage()}),ha(5),Ys(),Ys(),Ys()}if(2&e){var n=ta(2);ho(2),fa(" Unlock with Heritage Points (",n.getHeritagePoints(),"/",n.getHeritageCap(),") "),ho(2),Ws("ngClass",Du(4,Lx,!n.hasHeritagePoints()||!n.meetsPrerequisites())),ho(1),ga("unlock for ",n.requiredHeritagePoints()," HP")}}function Fx(e,t){if(1&e&&(zs(0,"div",4),Gs(1,Mx,8,1,"div",5),Gs(2,Dx,3,0,"div",5),Gs(3,xx,6,6,"div",5),Ys()),2&e){var i=ta();ho(1),Ws("ngIf",i.hasQueueSpace()),ho(1),Ws("ngIf",!i.hasQueueSpace()),ho(1),Ws("ngIf",i.isHeritageUnlocked())}}var Ux=function(){var e=function(){function e(t,i,n,r){var o=this;p(this,e),this.modalService=t,this.heritageService=i,this.gameService=n,this.techService=r,this.modalService.registerForTech().subscribe(function(e){o.tech=e})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.hasQueueSpace()?this.modalService.sendConfirmationResult(!0):this.modalService.sendConfirmationResult(!1),this.tech=null,this.modalService.close(_v.RESEARCH_UNLOCK)}},{key:"cancel",value:function(){this.modalService.sendConfirmationResult(!1),this.tech=null,this.modalService.close(_v.RESEARCH_UNLOCK)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("research-unlock-modal").style.display&&(e.preventDefault(),this.ok())}},{key:"hasQueueSpace",value:function(){return this.techService.hasQueueSpace()}},{key:"requiredHeritagePoints",value:function(){var e=0,t=10*this.tech.getRequiredResearchPoints();return Array.from(this.tech.getCost()).forEach(function(e){t+=e[0]===Mv.FOOD?Math.ceil(e[1]/50):cm.getResource(e[0]).TRADE_VALUE*e[1]}),t>0&&(e+=Math.ceil(t/100)),e}},{key:"hasHeritagePoints",value:function(){return this.heritageService.hasHeritagePoints(this.requiredHeritagePoints())}},{key:"unlockWithHeritage",value:function(){this.meetsPrerequisites()?this.heritageService.spendHeritagePoints(this.requiredHeritagePoints())?this.techService.finishTech(this.tech.getTech()):this.modalService.info("Not enough Heritage Points"):this.modalService.info("Prerequisites not met"),this.modalService.sendConfirmationResult(!1),this.tech=null,this.modalService.close(_v.RESEARCH_UNLOCK)}},{key:"isHeritageUnlocked",value:function(){return this.gameService.isEnabled(wv.HERITAGE)}},{key:"getHeritagePoints",value:function(){return this.heritageService.getAvailableHeritagePoints()}},{key:"getHeritageCap",value:function(){return this.heritageService.getHeritagePoints()}},{key:"meetsPrerequisites",value:function(){var e=this,t=!0,i=this.techService.getTechDone();return this.tech.getPrerequisites().forEach(function(e){t&&(i.includes(e)||(t=!1))}),this.tech.getFlagPrerequisites().forEach(function(i){e.gameService.isEnabled(i)||t&&(t=!1)}),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(a_),Bs(_m),Bs(zI))},e.\u0275cmp=it({type:e,selectors:[["app-research-unlock-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:4,vars:1,consts:[["id","research-unlock-modal"],[1,"modal"],["class","modal-body",4,"ngIf"],[1,"modal-background"],[1,"modal-body"],["class","center",4,"ngIf"],[1,"center"],["id","text",3,"innerHTML"],[1,"buttons"],[3,"click"],[3,"ngClass","click"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),Gs(2,Fx,4,3,"div",2),Ys(),js(3,"div",3),Ys()),2&e&&(ho(2),Ws("ngIf",t.tech))},directives:[qP,Gl,xl],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:750px;margin:200px auto auto}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}.center[_ngcontent-%COMP%]{text-align:center}.disabled[_ngcontent-%COMP%]{color:#5a5a5a}"]}),e}(),Hx=function(e){return{selected:e}};function Gx(e,t){if(1&e){var i=qs();zs(0,"div",4),$s("click",function(){Kt(i);var e=ta();return e.selectedShip=e.troops.BRIGANTINE}),zs(1,"span",5),ha(2,"Brigantine"),Ys(),js(3,"img",13),Ys()}if(2&e){var n=ta();Ws("ngClass",Du(1,Hx,n.selectedShip===n.troops.BRIGANTINE))}}function Bx(e,t){if(1&e){var i=qs();zs(0,"div",4),$s("click",function(){Kt(i);var e=ta();return e.selectedShip=e.troops.GALLEON}),zs(1,"span",5),ha(2,"Galleon"),Ys(),js(3,"img",14),Ys()}if(2&e){var n=ta();Ws("ngClass",Du(1,Hx,n.selectedShip===n.troops.GALLEON))}}var Wx=function(e){return{notMet:e}};function Vx(e,t){if(1&e&&(zs(0,"div",25),zs(1,"span",22),ha(2),js(3,"app-icon",24),Ys(),Ys()),2&e){var i=t.$implicit,n=ta(2);Ws("ngClass",Du(4,Wx,!n.hasResource(i.resource,i.amount))),ho(2),ga("",i.amount," "),ho(1),Ws("name",n.getResourceName(i.resource))("path","resources")}}function zx(e,t){if(1&e&&(zs(0,"div"),zs(1,"h5",15),ha(2,"Cost"),Ys(),zs(3,"div",16),zs(4,"span",17),ha(5),js(6,"app-icon",18),Ys(),zs(7,"span",17),ha(8),js(9,"app-icon",19),Ys(),Gs(10,Vx,4,6,"div",20),Ys(),zs(11,"h5",15),ha(12,"Stats"),Ys(),zs(13,"div",21),zs(14,"span",22),ha(15),js(16,"app-icon",23),Ys(),zs(17,"span",22),ha(18),js(19,"app-icon",23),Ys(),zs(20,"span",22),ha(21),js(22,"app-icon",24),Ys(),zs(23,"span",22),ha(24),js(25,"app-icon",24),Ys(),zs(26,"span",22),ha(27),js(28,"app-icon",24),Ys(),zs(29,"span",22),ha(30),js(31,"app-icon",24),Ys(),zs(32,"span",22),ha(33),js(34,"app-icon",24),Ys(),Ys(),Ys()),2&e){var i=ta();ho(4),Ws("ngClass",Du(29,Wx,!i.hasPort())),ho(1),ga("",i.getShipStats().SIZE," "),ho(1),Ws("name","port")("path","sea")("title","port space"),ho(1),Ws("ngClass",Du(31,Wx,!i.hasPeople())),ho(1),ga("",i.getShipStats().CREW," "),ho(1),Ws("name","hammer")("title","sailors"),ho(1),Ws("ngForOf",i.getCost()),ho(5),ga("",i.getShipStats().SIZE," "),ho(1),Ws("name","size"),ho(2),ga("",i.getShipStats().CARGO," "),ho(1),Ws("name","cargo"),ho(2),ga("",i.getShipStats().SPEED," "),ho(1),Ws("name","speed")("path","army"),ho(2),ga("",i.getShipStats().SPEED," "),ho(1),Ws("name","speed")("path","army"),ho(2),ga("",i.getShipStats().PAY," "),ho(1),Ws("name","coins")("path","resources"),ho(2),ga("",i.getShipStats().STRENGTH," "),ho(1),Ws("name","attack")("path","army"),ho(2),ga("",i.getShipStats().DEFENSE," "),ho(1),Ws("name","defense")("path","army")}}var Yx=function(e){return{disabled:e}},jx=function(){var e=function(){function e(t,i,n,r){var o=this;p(this,e),this.modalService=t,this.resourcesService=i,this.gameService=n,this.navyService=r,this.selectedShip=Bv.BOAT,this.troops=Bv,this.limitToBoat=!1,t.registerForShipyardLimitBoat().subscribe(function(e){o.limitToBoat=e,o.selectedShip=Bv.BOAT})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("shipyard-modal").style.display&&(e.preventDefault(),this.cancel())}},{key:"build",value:function(){var e=this;if(this.hasPort())if(this.hasResources()){if(!(this.resourcesService.getPeople()>=this.getShipStats().CREW))return void this.modalService.info("Not enough sailors!");this.resourcesService.removeRecruit(this.getShipStats().CREW),this.getCost().forEach(function(t){e.resourcesService.decreaseResource(t.resource,t.amount,"ship construction",!0)}),this.modalService.sendValueInput(this.selectedShip),this.modalService.close(_v.SHIPYARD)}else this.modalService.info("Not enough resources!");else this.modalService.info("Not enough port space!")}},{key:"cancel",value:function(){this.modalService.close(_v.SHIPYARD)}},{key:"hasResources",value:function(){var e=this,t=!0;return this.getCost().forEach(function(i){t&&(t=e.hasResource(i.resource,i.amount))}),t}},{key:"hasResource",value:function(e,t){return 0===this.resourcesService.hasResource(e,t,"ship construction",!0)}},{key:"getCost",value:function(){return lm.getTroop(this.selectedShip).COST}},{key:"getResourceName",value:function(e){return Qv.prepareResourceName(e)}},{key:"getShipStats",value:function(){return lm.getTroop(this.selectedShip)}},{key:"hasPort",value:function(){return this.navyService.getFreeHarbourSpace()>=this.getShipStats().SIZE}},{key:"hasPeople",value:function(){return this.resourcesService.getPeople()>=this.getShipStats().CREW}},{key:"isBrigantineUnlocked",value:function(){return this.gameService.isEnabled(wv.BRIGANTINE)}},{key:"isGalleonUnlocked",value:function(){return this.gameService.isEnabled(wv.GALLEON)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv),Bs(DE),Bs(_m),Bs(kC))},e.\u0275cmp=it({type:e,selectors:[["app-shipyard-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:20,vars:9,consts:[["id","shipyard-modal"],[1,"modal"],[1,"modal-body"],["id","modes"],[1,"mode",3,"ngClass","click"],[1,"title"],["src","assets/sea/boat.svg"],["class","mode",3,"ngClass","click",4,"ngIf"],[4,"ngIf"],["id","buttons"],[3,"ngClass","click"],[3,"click"],[1,"modal-background"],["src","assets/sea/brigantine.svg"],["src","assets/sea/galleon.svg"],[1,"center"],["id","costList"],[1,"icon",3,"ngClass"],[3,"name","path","title"],[3,"name","title"],[3,"ngClass",4,"ngFor","ngForOf"],["id","stats"],[1,"icon"],[3,"name"],[3,"name","path"],[3,"ngClass"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"h2"),ha(4,"Select ship to build"),Ys(),zs(5,"div",3),zs(6,"div",4),$s("click",function(){return t.selectedShip=t.troops.BOAT}),zs(7,"span",5),ha(8,"Boat"),Ys(),js(9,"img",6),Ys(),Gs(10,Gx,4,3,"div",7),Gs(11,Bx,4,3,"div",7),Ys(),js(12,"br"),Gs(13,zx,35,33,"div",8),zs(14,"div",9),zs(15,"button",10),$s("click",function(){return t.build()}),ha(16,"BUILD"),Ys(),zs(17,"button",11),$s("click",function(){return t.cancel()}),ha(18,"CANCEL"),Ys(),Ys(),Ys(),Ys(),js(19,"div",12),Ys()),2&e&&(ho(6),Ws("ngClass",Du(5,Hx,t.selectedShip===t.troops.BOAT)),ho(4),Ws("ngIf",!t.limitToBoat&&t.isBrigantineUnlocked()),ho(1),Ws("ngIf",!t.limitToBoat&&t.isGalleonUnlocked()),ho(2),Ws("ngIf",t.selectedShip),ho(2),Ws("ngClass",Du(7,Yx,!t.hasPort()||!t.hasPeople()||!t.hasResources())))},directives:[qP,xl,Gl,oT,Ul],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:100px auto auto}.lineBreak[_ngcontent-%COMP%]{display:block}#modes[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:10px}.mode[_ngcontent-%COMP%]{display:flex;cursor:pointer;flex-direction:column;height:150px;width:200px;border:black solid 1px;align-items:center;margin-right:5px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.mode[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px}.mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:bold}.mode[_ngcontent-%COMP%]   .effect[_ngcontent-%COMP%]{font-size:.8em}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:10px}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;white-space:nowrap}.disabled[_ngcontent-%COMP%]{color:#5a5a5a}.selected[_ngcontent-%COMP%]{border:black solid 3px}.notMet[_ngcontent-%COMP%]{color:var(--negative-colour)}#costList[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}#stats[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.center[_ngcontent-%COMP%]{text-align:center}h5[_ngcontent-%COMP%]{margin-bottom:5px}.icon[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-right:10px}"]}),e}();function Kx(e,t){if(1&e&&(zs(0,"div",7),js(1,"br"),zs(2,"span"),ha(3),Ys(),js(4,"br"),js(5,"br"),zs(6,"label",8),ha(7,"Full error:"),Ys(),js(8,"br"),zs(9,"textarea",9),ha(10),Ys(),Ys()),2&e){var i=ta();ho(3),da(i.errorReport.message),ho(7),da(i.errorReport.fullError)}}var Qx=function(){var e=function(){function e(t){var i=this;p(this,e),this.modalService=t,this.errorReport=null,this.modalService.registerForErrorReport().subscribe(function(e){return i.errorReport=e}),this.modalService.registerForCloseModal().subscribe(function(e){e===_v.ERROR&&(i.errorReport=null)})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.close(_v.ERROR)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("error-modal").style.display&&(e.preventDefault(),this.ok())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-error-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:10,vars:1,consts:[["id","error-modal"],[1,"modal"],[1,"modal-body"],["id","title"],["id","wrapper",4,"ngIf"],[3,"click"],[1,"modal-background"],["id","wrapper"],["for","errorBox"],["readonly","","rows","20","id","errorBox"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),zs(3,"span",3),ha(4,"Error report"),Ys(),Gs(5,Kx,11,2,"div",4),js(6,"br"),zs(7,"button",5),$s("click",function(){return t.ok()}),ha(8,"OK"),Ys(),Ys(),Ys(),js(9,"div",6),Ys()),2&e&&(ho(5),Ws("ngIf",t.errorReport))},directives:[qP,Gl],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em}#title[_ngcontent-%COMP%]{font-weight:bold}#wrapper[_ngcontent-%COMP%]{width:100%;text-align:center}#errorBox[_ngcontent-%COMP%]{width:100%;resize:none}"]}),e}(),qx=function(){var e=function(){function e(t){var i=this;p(this,e),this.modalService=t,this.modalService.registerForText().subscribe(function(e){return i.text=e})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.sendConfirmationResult(!0),this.modalService.close(_v.CONFIRM)}},{key:"cancel",value:function(){this.modalService.sendConfirmationResult(!1),this.modalService.close(_v.CONFIRM)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("confirm-modal").style.display&&(e.preventDefault(),this.ok())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-confirm-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:11,vars:1,consts:[["id","confirm-modal"],[1,"modal"],[1,"modal-body"],["id","text",3,"innerHTML"],["id","buttons"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),js(3,"span",3),js(4,"br"),zs(5,"div",4),zs(6,"button",5),$s("click",function(){return t.ok()}),ha(7,"YES"),Ys(),zs(8,"button",5),$s("click",function(){return t.cancel()}),ha(9,"NO"),Ys(),Ys(),Ys(),Ys(),js(10,"div",6),Ys()),2&e&&(ho(3),Ws("innerHTML",t.text,dr))},directives:[qP],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:750px;margin:200px auto auto}#buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}#buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px;padding:5px}"]}),e}(),Xx=function(){var e=function(){function e(t){var i=this;p(this,e),this.modalService=t,this.text="",this.modalService.registerForText().subscribe(function(e){return i.text=e})}return S(e,[{key:"ngOnInit",value:function(){}},{key:"ok",value:function(){this.modalService.close(_v.INFO)}},{key:"onKeydownHandler",value:function(e){"none"!==document.getElementById("info-modal").style.display&&(e.preventDefault(),this.ok())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-info-modal"]],hostBindings:function(e,t){1&e&&$s("keydown.enter",function(e){return t.onKeydownHandler(e)},!1,Tr)},decls:8,vars:1,consts:[["id","info-modal"],[1,"modal"],[1,"modal-body"],["id","text",3,"innerHTML"],[3,"click"],[1,"modal-background"]],template:function(e,t){1&e&&(zs(0,"app-modal",0),zs(1,"div",1),zs(2,"div",2),js(3,"span",3),js(4,"br"),zs(5,"button",4),$s("click",function(){return t.ok()}),ha(6,"OK"),Ys(),Ys(),Ys(),js(7,"div",5),Ys()),2&e&&(ho(3),Ws("innerHTML",t.text,dr))},directives:[qP],styles:[".modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.2em;max-width:750px;margin:200px auto auto}"]}),e}(),Zx=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=it({type:e,selectors:[["app-modals"]],decls:25,vars:0,template:function(e,t){1&e&&(js(0,"app-build-modal"),js(1,"app-abdication-modal"),js(2,"app-ascension-modal"),js(3,"app-fight-report-modal"),js(4,"app-export-modal"),js(5,"app-import-modal"),js(6,"app-hard-reset-modal"),js(7,"app-options-modal"),js(8,"app-royal-modal"),js(9,"app-mission-modal"),js(10,"app-festival-modal"),js(11,"app-market-modal"),js(12,"app-work-management-modal"),js(13,"app-tutorial-modal"),js(14,"app-changelog-modal"),js(15,"app-resource-management-modal"),js(16,"app-recipe-modal"),js(17,"app-world-modal"),js(18,"app-world-build-modal"),js(19,"app-input-modal"),js(20,"app-research-unlock-modal"),js(21,"app-shipyard-modal"),js(22,"app-error-modal"),js(23,"app-confirm-modal"),js(24,"app-info-modal"))},directives:[fM,iD,oD,pD,ED,yD,RD,DD,FD,_L,UL,YL,ax,dx,fx,Sx,Rx,Tx,_x,Px,Ux,jx,Qx,qx,Xx],styles:[""]}),e}(),$x=function(){var e=function(){function e(t){p(this,e),this.servicesService=t,t.addService(Zv.REGIONS,this),this.init()}return S(e,[{key:"init",value:function(){this.villageService=this.servicesService.getVillageService(),this.fortService=this.servicesService.getFortService(),this.forestService=this.servicesService.getForestService(),this.fieldService=this.servicesService.getFieldService(),this.mountainsService=this.servicesService.getMountainsService(),this.seaService=this.servicesService.getSeaService(),this.regionsServices=[this.villageService,this.fortService,this.forestService,this.fieldService,this.mountainsService,this.seaService]}},{key:"getAllBuildingSites",value:function(){var e=[];return this.regionsServices.forEach(function(t){e=e.concat(t.getBuildings().filter(function(e){return e.getBuildingType()===Pv.CONSTRUCTION||e.getBuildingType()===Pv.DECONSTRUCTION}))}),e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An($v))},e.\u0275prov=be({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Jx=function(){var e=function(){function e(t){p(this,e),this.calendarService=t}return S(e,[{key:"ngOnInit",value:function(){}},{key:"getDay",value:function(){return this.calendarService.getDay()}},{key:"getYear",value:function(){return this.calendarService.getYear()}},{key:"getSeason",value:function(){return ym[this.calendarService.getSeason()].toLowerCase()}},{key:"polarToCartesian",value:function(e,t,i,n){var r=(n-90)*Math.PI/180;return{x:e+i*Math.cos(r),y:t+i*Math.sin(r)}}},{key:"describeArc",value:function(e,t,i,n,r){360===r&&(r=359.9);var o=this.polarToCartesian(e,t,i,r),s=this.polarToCartesian(e,t,i,n);return["M",o.x,o.y,"A",i,i,0,r-n<=180?"0":"1",0,s.x,s.y,"L",e,t,"L",o.x,o.y].join(" ")}},{key:"getTickNumber",value:function(){return this.calendarService.getTickInDay()-1}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Im))},e.\u0275cmp=it({type:e,selectors:[["app-calendar"]],decls:6,vars:4,consts:[["id","wrapper"],["height","22px","width","23px",1,"progress-circle"],["cx","11","cy","11","r","10","stroke","black","stroke-width","1.5","fill","transparent"]],template:function(e,t){1&e&&(zs(0,"div",0),ha(1),yi(),zs(2,"svg",1),js(3,"circle",2),js(4,"path"),Ys(),ha(5),Ys()),2&e&&(ho(1),ga(" day: ",t.getDay()," "),ho(3),Us("d",t.describeArc(11,11,8,0,36*t.getTickNumber())),ho(1),fa(" year: ",t.getYear()," ",t.getSeason(),"\n"))},styles:[".progress-circle[_ngcontent-%COMP%]{margin-bottom:-2px}"]}),e}(),eF=["line1"],tF=["line22"];function iF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function nF(e,t){if(1&e&&(zs(0,"div",17),js(1,"app-icon",18),ha(2),zs(3,"span",19),ha(4," Total food nutrition"),js(5,"br"),js(6,"hr"),ha(7),js(8,"br"),ha(9),js(10,"br"),ha(11),Hu(12,"number"),js(13,"br"),js(14,"hr"),Gs(15,iF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","nutTolltip"),ho(1),Ws("name","food")("path","resources")("title",""),ho(1),ga("\xa0",i.getFoodValue()," "),ho(5),ga(" Rations: ",i.getRations(),""),ho(2),ga(" Daily consumption: ",i.getDailyNutritionUsage(),""),ho(2),ga(" Average daily production: ",Bu(12,9,i.getAverageDailyNutritionProduction(),"0.0-0"),""),ho(4),Ws("ngForOf",i.getConsumableResources())}}function rF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function oF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0RAW "),zs(2,"span",22),Gs(3,rF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","rawTolltip"),ho(3),Ws("ngForOf",i.geRawResources())}}function sF(e,t){if(1&e&&(zs(0,"div"),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=ta().$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function aF(e,t){if(1&e&&(zs(0,"div"),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=ta().$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),ga("",i.amount," ")}}function uF(e,t){if(1&e&&(zs(0,"div",21),Gs(1,sF,3,4,"div",7),Gs(2,aF,3,3,"div",7),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("ngIf",n.isNotCoins(i)),ho(1),Ws("ngIf",!n.isNotCoins(i))}}function cF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0PROCESSED "),zs(2,"span",23),Gs(3,uF,3,2,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","processedTolltip"),ho(3),Ws("ngForOf",i.geProcessedResources())}}function lF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function hF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0FOOD "),zs(2,"span",24),Gs(3,lF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","foodTolltip"),ho(3),Ws("ngForOf",i.geFoodResources())}}function dF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function gF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0TOOLS "),zs(2,"span",25),Gs(3,dF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","toolsTolltip"),ho(3),Ws("ngForOf",i.geToolsResources())}}function fF(e,t){if(1&e&&(zs(0,"div",17),js(1,"app-icon",18),ha(2),zs(3,"span",19),ha(4," Total food nutrition "),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","nutTolltip"),ho(1),Ws("name","food")("path","resources")("title",""),ho(1),ga("\xa0",i.getFoodValue()," ")}}function vF(e,t){if(1&e&&(zs(0,"div",26),js(1,"app-icon",27),ha(2),Ys()),2&e){var i=ta(2);ho(1),Ws("name","population"),ho(1),ga(" ",i.getPopulation()," ")}}function pF(e,t){if(1&e&&(zs(0,"div",26),js(1,"app-icon",28),ha(2),Ys()),2&e){var i=ta(2);ho(1),Ws("name","hammer")("title","Workers"),ho(1),ga(" ",i.getFreeWorkers()," ")}}function mF(e,t){if(1&e){var i=qs();zs(0,"div",26),zs(1,"app-happiness",15),$s("click",function(){return Kt(i),ta(2).openHappiness()}),Ys(),ha(2," \xa0 "),Ys()}}function SF(e,t){if(1&e&&(zs(0,"div",26),js(1,"app-icon",18),ha(2),Ys()),2&e){var i=ta(2);ho(1),Ws("name","faith")("path","religion")("title","Faith"),ho(1),ga(" ",i.getFaith()," \xa0 ")}}function EF(e,t){if(1&e&&(zs(0,"div",26),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga(" ",i.getResearchProgress()," ")}}function yF(e,t){if(1&e&&(Ks(0,35),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),fa("",i.getAmount(),"/",i.getLimit(),"")}}function RF(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),fa("",i.getAmount(),"/",i.getLimit(),"")}}function OF(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),da(i.getAmount())}}function TF(e,t){if(1&e&&(zs(0,"span"),zs(1,"span",30),zs(2,"span",31),zs(3,"div",32),ha(4),Ys(),js(5,"div",33),js(6,"div",33),Ys(),js(7,"app-icon",18),Gs(8,yF,2,2,"ng-container",34),Gs(9,RF,2,2,"ng-container",7),Gs(10,OF,2,1,"ng-container",7),ha(11," \xa0"),Ys(),Ys()),2&e){var i=ta().$implicit,n=ta(2);ho(1),Ws("elementId",1e5*i.resource),ho(1),ia("id",1e5*i.resource),ho(2),da(i.name),ho(1),Ws("innerHTML",n.getResourceDescription(i),dr),ho(1),Ws("innerHTML",n.getResourceConsumers(i),dr),ho(1),Ws("name",i.getName())("path","resources")("title",""),ho(1),Ws("ngIf",i.getAmount()===i.getLimit()),ho(1),Ws("ngIf",n.isNotCoins(i)&&i.getAmount()!==i.getLimit()),ho(1),Ws("ngIf",!n.isNotCoins(i))}}function IF(e,t){if(1&e&&(zs(0,"div",29),Gs(1,TF,12,11,"span",7),Ys()),2&e){var i=t.$implicit;ho(1),Ws("ngIf",i.visible&&i.highlighted)}}function bF(e,t){1&e&&js(0,"app-calendar")}function CF(e,t){1&e&&(Ks(0),ha(1,"\xb0C"),Qs())}function AF(e,t){1&e&&(Ks(0),ha(1,"\xb0F"),Qs())}function kF(e,t){1&e&&js(0,"img",36)}function NF(e,t){1&e&&js(0,"img",37)}function _F(e,t){if(1&e){var i=qs();zs(0,"li",15),$s("click",function(){return Kt(i),ta(2).pause()}),ha(1,"pause game"),Ys()}}function wF(e,t){if(1&e){var i=qs();zs(0,"li",15),$s("click",function(){return Kt(i),ta(2).resume()}),ha(1,"resume game"),Ys()}}function PF(e,t){if(1&e){var i=qs();zs(0,"div",2),Gs(1,nF,16,12,"div",3),Gs(2,oF,4,2,"div",3),Gs(3,cF,4,2,"div",3),Gs(4,hF,4,2,"div",3),Gs(5,gF,4,2,"div",3),Gs(6,fF,5,5,"div",3),Gs(7,vF,3,2,"div",4),ha(8," \xa0 "),Gs(9,pF,3,3,"div",4),ha(10," \xa0 "),Gs(11,mF,3,0,"div",4),Gs(12,SF,3,4,"div",4),Gs(13,EF,2,1,"div",4),ha(14," \xa0 "),Gs(15,IF,2,1,"div",5),ha(16," \xa0 "),zs(17,"div",6),Gs(18,bF,1,0,"app-calendar",7),zs(19,"span",8),ha(20," \xa0 "),js(21,"app-icon",9),Ks(22,10),ha(23),Hu(24,"number"),Gs(25,CF,2,0,"ng-container",7),Gs(26,AF,2,0,"ng-container",7),Qs(),Ys(),Ys(),zs(27,"div",11),Gs(28,kF,1,0,"img",12),Gs(29,NF,1,0,"img",13),zs(30,"ul",14),zs(31,"li",15),$s("click",function(){return Kt(i),ta().options()}),ha(32,"options"),Ys(),zs(33,"li",15),$s("click",function(){return Kt(i),ta().save()}),ha(34,"save"),Ys(),zs(35,"li",15),$s("click",function(){return Kt(i),ta().load()}),ha(36,"load"),Ys(),zs(37,"li",15),$s("click",function(){return Kt(i),ta().import()}),ha(38,"import"),Ys(),zs(39,"li",15),$s("click",function(){return Kt(i),ta().export()}),ha(40,"export"),Ys(),Gs(41,_F,2,0,"li",16),Gs(42,wF,2,0,"li",16),zs(43,"li",15),$s("click",function(){return Kt(i),ta().showCurrentTutorial()}),ha(44,"show current tab tutorial"),Ys(),zs(45,"li",15),$s("click",function(){return Kt(i),ta().resetTutorials()}),ha(46,"reset tutorials"),Ys(),zs(47,"li",15),$s("click",function(){return Kt(i),ta().softReset()}),ha(48,"abdicate"),Ys(),zs(49,"li",15),$s("click",function(){return Kt(i),ta().hardReset()}),ha(50,"hard reset"),Ys(),Ys(),Ys(),Ys()}if(2&e){var n=ta();ho(1),Ws("ngIf",n.isFoodNutritionEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isRawEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isProcessedEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isFoodEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isToolsEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isFoodNutritionEnabled()&&!n.isManagementResearched()),ho(1),Ws("ngIf",n.showPopulation()),ho(2),Ws("ngIf",n.showFreeWorkers()),ho(2),Ws("ngIf",n.showHappiness()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.showFaith()&&n.isFaithUnlocked()),ho(1),Ws("ngIf",n.showResearchProgress()),ho(2),Ws("ngForOf",n.getResourcesValues()),ho(3),Ws("ngIf",n.calendarEnabled()),ho(3),Ws("name",n.getWeatherName())("path","weather"),ho(2),ga("",Bu(24,22,n.getTemperature(),"0.0-1")," "),ho(2),Ws("ngIf",n.metric),ho(1),Ws("ngIf",!n.metric),ho(2),Ws("ngIf",!n.isPaused()),ho(1),Ws("ngIf",n.isPaused()),ho(12),Ws("ngIf",!n.isPaused()),ho(1),Ws("ngIf",n.isPaused())}}function MF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function DF(e,t){if(1&e&&(zs(0,"div",17),js(1,"app-icon",18),ha(2),zs(3,"span",19),ha(4," Nutrition"),js(5,"br"),js(6,"hr"),ha(7),js(8,"br"),ha(9),js(10,"br"),ha(11),Hu(12,"number"),js(13,"br"),js(14,"hr"),Gs(15,MF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","nutTolltip"),ho(1),Ws("name","food")("path","resources")("title",""),ho(1),ga("\xa0",i.getFoodValue()," "),ho(5),ga(" Rations: ",i.getRations(),""),ho(2),ga(" Daily consumption: ",i.getDailyNutritionUsage(),""),ho(2),ga(" Average daily production: ",Bu(12,9,i.getAverageDailyNutritionProduction(),"0.0-0"),""),ho(4),Ws("ngForOf",i.getConsumableResources())}}function LF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function xF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0RAW "),zs(2,"span",22),Gs(3,LF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","rawTolltip"),ho(3),Ws("ngForOf",i.geRawResources())}}function FF(e,t){if(1&e&&(zs(0,"div"),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=ta().$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function UF(e,t){if(1&e&&(zs(0,"div"),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=ta().$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),ga("",i.amount," ")}}function HF(e,t){if(1&e&&(zs(0,"div",21),Gs(1,FF,3,4,"div",7),Gs(2,UF,3,3,"div",7),Ys()),2&e){var i=t.$implicit,n=ta(3);ho(1),Ws("ngIf",n.isNotCoins(i)),ho(1),Ws("ngIf",!n.isNotCoins(i))}}function GF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0PROCESSED "),zs(2,"span",23),Gs(3,HF,3,2,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","processedTolltip"),ho(3),Ws("ngForOf",i.geProcessedResources())}}function BF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function WF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0FOOD "),zs(2,"span",24),Gs(3,BF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","foodTolltip"),ho(3),Ws("ngForOf",i.geFoodResources())}}function VF(e,t){if(1&e&&(zs(0,"div",21),js(1,"app-icon",9),ha(2),Ys()),2&e){var i=t.$implicit;ho(1),Ws("name",i.getName())("path","resources"),ho(1),fa("",i.amount,"/",i.limit," ")}}function zF(e,t){if(1&e&&(zs(0,"div",17),ha(1," \xa0TOOLS "),zs(2,"span",25),Gs(3,VF,3,4,"div",20),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","toolsTolltip"),ho(3),Ws("ngForOf",i.geToolsResources())}}function YF(e,t){if(1&e&&(zs(0,"div",17),js(1,"app-icon",18),ha(2),zs(3,"span",19),ha(4," Total food nutrition "),Ys(),Ys()),2&e){var i=ta(2);Ws("elementId","nutTolltip"),ho(1),Ws("name","food")("path","resources")("title",""),ho(1),ga("\xa0",i.getFoodValue()," ")}}function jF(e,t){if(1&e&&(zs(0,"div",26),js(1,"app-icon",27),ha(2),Ys()),2&e){var i=ta(2);ho(1),Ws("name","population"),ho(1),ga(" ",i.getPopulation()," ")}}function KF(e,t){if(1&e&&(zs(0,"div",26),js(1,"app-icon",28),ha(2),Ys()),2&e){var i=ta(2);ho(1),Ws("name","hammer")("title","Workers"),ho(1),ga(" ",i.getFreeWorkers()," ")}}function QF(e,t){if(1&e){var i=qs();zs(0,"div",26),zs(1,"app-happiness",15),$s("click",function(){return Kt(i),ta(2).openHappiness()}),Ys(),ha(2," \xa0 "),Ys()}}function qF(e,t){if(1&e&&(zs(0,"div",26),js(1,"app-icon",18),ha(2),Ys()),2&e){var i=ta(2);ho(1),Ws("name","faith")("path","religion")("title","Faith"),ho(1),ga(" ",i.getFaith()," \xa0 ")}}function XF(e,t){if(1&e&&(zs(0,"div",26),ha(1),Ys()),2&e){var i=ta(2);ho(1),ga(" ",i.getResearchProgress()," ")}}function ZF(e,t){1&e&&js(0,"app-calendar")}function $F(e,t){1&e&&(Ks(0),ha(1,"\xb0C"),Qs())}function JF(e,t){1&e&&(Ks(0),ha(1,"\xb0F"),Qs())}function eU(e,t){1&e&&js(0,"img",42)}function tU(e,t){1&e&&js(0,"img",43)}function iU(e,t){if(1&e){var i=qs();zs(0,"li",15),$s("click",function(){return Kt(i),ta(2).pause()}),ha(1,"pause game"),Ys()}}function nU(e,t){if(1&e){var i=qs();zs(0,"li",15),$s("click",function(){return Kt(i),ta(2).resume()}),ha(1,"resume game"),Ys()}}function rU(e,t){if(1&e&&(Ks(0,35),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),fa("",i.getAmount(),"/",i.getLimit(),"")}}function oU(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),fa("",i.getAmount(),"/",i.getLimit(),"")}}function sU(e,t){if(1&e&&(Ks(0),ha(1),Qs()),2&e){var i=ta(2).$implicit;ho(1),da(i.getAmount())}}function aU(e,t){if(1&e&&(zs(0,"span"),zs(1,"span",30),zs(2,"span",31),zs(3,"div",32),ha(4),Ys(),js(5,"div",33),js(6,"div",33),Ys(),js(7,"app-icon",18),Gs(8,rU,2,2,"ng-container",34),Gs(9,oU,2,2,"ng-container",7),Gs(10,sU,2,1,"ng-container",7),ha(11," \xa0"),Ys(),Ys()),2&e){var i=ta().$implicit,n=ta(2);ho(1),Ws("elementId",1e5*i.resource),ho(1),ia("id",1e5*i.resource),ho(2),da(i.name),ho(1),Ws("innerHTML",n.getResourceDescription(i),dr),ho(1),Ws("innerHTML",n.getResourceConsumers(i),dr),ho(1),Ws("name",i.getName())("path","resources")("title",""),ho(1),Ws("ngIf",i.getAmount()===i.getLimit()),ho(1),Ws("ngIf",n.isNotCoins(i)&&i.getAmount()!==i.getLimit()),ho(1),Ws("ngIf",!n.isNotCoins(i))}}function uU(e,t){if(1&e&&(zs(0,"div",29),Gs(1,aU,12,11,"span",7),Ys()),2&e){var i=t.$implicit;ho(1),Ws("ngIf",i.visible&&i.highlighted)}}function cU(e,t){if(1&e){var i=qs();zs(0,"div",38),zs(1,"div",39),Gs(2,DF,16,12,"div",3),Gs(3,xF,4,2,"div",3),Gs(4,GF,4,2,"div",3),Gs(5,WF,4,2,"div",3),Gs(6,zF,4,2,"div",3),Gs(7,YF,5,5,"div",3),Gs(8,jF,3,2,"div",4),ha(9," \xa0 "),Gs(10,KF,3,3,"div",4),ha(11," \xa0 "),Gs(12,QF,3,0,"div",4),Gs(13,qF,3,4,"div",4),Gs(14,XF,2,1,"div",4),ha(15," \xa0 "),zs(16,"div",6),Gs(17,ZF,1,0,"app-calendar",7),zs(18,"span",8),ha(19," \xa0 "),js(20,"app-icon",9),Ks(21,10),ha(22),Hu(23,"number"),Gs(24,$F,2,0,"ng-container",7),Gs(25,JF,2,0,"ng-container",7),Qs(),Ys(),Ys(),zs(26,"div",11),Gs(27,eU,1,0,"img",40),Gs(28,tU,1,0,"img",41),zs(29,"ul",14),zs(30,"li",15),$s("click",function(){return Kt(i),ta().options()}),ha(31,"options"),Ys(),zs(32,"li",15),$s("click",function(){return Kt(i),ta().save()}),ha(33,"save"),Ys(),zs(34,"li",15),$s("click",function(){return Kt(i),ta().load()}),ha(35,"load"),Ys(),zs(36,"li",15),$s("click",function(){return Kt(i),ta().import()}),ha(37,"import"),Ys(),zs(38,"li",15),$s("click",function(){return Kt(i),ta().export()}),ha(39,"export"),Ys(),Gs(40,iU,2,0,"li",16),Gs(41,nU,2,0,"li",16),zs(42,"li",15),$s("click",function(){return Kt(i),ta().showCurrentTutorial()}),ha(43,"show current tab tutorial"),Ys(),zs(44,"li",15),$s("click",function(){return Kt(i),ta().resetTutorials()}),ha(45,"reset tutorials"),Ys(),zs(46,"li",15),$s("click",function(){return Kt(i),ta().softReset()}),ha(47,"abdicate"),Ys(),zs(48,"li",15),$s("click",function(){return Kt(i),ta().hardReset()}),ha(49,"hard reset"),Ys(),Ys(),Ys(),Ys(),zs(50,"div",39),Gs(51,uU,2,1,"div",5),Ys(),Ys()}if(2&e){var n=ta();ho(2),Ws("ngIf",n.isFoodNutritionEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isRawEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isProcessedEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isFoodEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isToolsEnabled()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.isFoodNutritionEnabled()&&!n.isManagementResearched()),ho(1),Ws("ngIf",n.showPopulation()),ho(2),Ws("ngIf",n.showFreeWorkers()),ho(2),Ws("ngIf",n.showHappiness()&&n.isManagementResearched()),ho(1),Ws("ngIf",n.showFaith()&&n.isFaithUnlocked()),ho(1),Ws("ngIf",n.showResearchProgress()),ho(3),Ws("ngIf",n.calendarEnabled()),ho(3),Ws("name",n.getWeatherName())("path","weather"),ho(2),ga("",Bu(23,22,n.getTemperature(),"0.0-1")," "),ho(2),Ws("ngIf",n.metric),ho(1),Ws("ngIf",!n.metric),ho(2),Ws("ngIf",!n.isPaused()),ho(1),Ws("ngIf",n.isPaused()),ho(12),Ws("ngIf",!n.isPaused()),ho(1),Ws("ngIf",n.isPaused()),ho(10),Ws("ngForOf",n.getResourcesValues())}}var lU=function(){var e=function(){function e(t,i,n,r,o,s,a,u,c,l,h,d,g,f){var v=this;p(this,e),this.serializerService=t,this.servicesService=i,this.logService=n,this.modalService=r,this.resourcesService=o,this.weatherService=s,this.optionsService=a,this.gameService=u,this.tickerService=c,this.tutorialService=l,this.techService=h,this.religionService=d,this.router=g,this.managementService=f,this.metric=this.optionsService.getOption(Xv.METRIC),this.optionsSubscription||(this.optionsSubscription=this.optionsService.registerForOptionsChange().subscribe(function(){return v.metric=v.optionsService.getOption(Xv.METRIC)}))}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.resources=this.resourcesService.getResources(),this.resourcesService.registerForResourcesChange().subscribe(function(t){e.resources=t})}},{key:"getResourcesValues",value:function(){return Array.from(this.resources.values())}},{key:"save",value:function(){this.serializerService.initSave(),this.logService.log("saved")}},{key:"load",value:function(){this.serializerService.initLoad()}},{key:"import",value:function(){this.modalService.open(_v.IMPORT)}},{key:"export",value:function(){this.modalService.open(_v.EXPORT)}},{key:"hardReset",value:function(){this.modalService.open(_v.HARD_RESET)}},{key:"options",value:function(){this.modalService.open(_v.OPTIONS)}},{key:"getTemperature",value:function(){return this.weatherService.getCurrentTemperature()}},{key:"getWeather",value:function(){return this.weatherService.getCurrentWeather()}},{key:"getWeatherName",value:function(){return tp[this.getWeather()].toLowerCase()}},{key:"calendarEnabled",value:function(){return this.gameService.isEnabled(wv.CALENDAR)}},{key:"softReset",value:function(){this.modalService.open(_v.ABDICATION)}},{key:"isNotCoins",value:function(e){return e.resource!==Mv.COINS}},{key:"resetTutorials",value:function(){this.tutorialService.resetTutorials()}},{key:"pause",value:function(){this.tickerService.pause()}},{key:"resume",value:function(){this.tickerService.resume()}},{key:"isPaused",value:function(){return this.tickerService.isPaused()}},{key:"getResourceDescription",value:function(e){var t="";return e.hasResourceType(Hv.CONSUMABLE)&&(t+="nutrition: "+cm.getResource(e.resource).POWER),e.hasResourceType(Hv.FUEL)&&(t+="heating energy: "+cm.getResource(e.resource).POWER),""!==t?"<hr>"+t:t}},{key:"getResourceConsumers",value:function(e){var t="",i="<b>used by:</b><br>",n=this.resourcesService.getResourceUses(e.resource),r=[];n&&(n.slice().forEach(function(e){var t=r.find(function(t){return t[0]===e.userName});t?t[1]+=e.value:r.push([e.userName,e.value])}),r.sort(function(e,t){return e[0].localeCompare(t[0])}).forEach(function(e){i+=e[0]+": "+e[1]+"<br>"})),"<b>used by:</b><br>"!==i&&(t+="<hr>"+i),i="<b>produced by:</b><br>";var o=this.resourcesService.getResourceProductions(e.resource),s=[];return o&&(o.slice().forEach(function(e){var t=s.find(function(t){return t[0]===e.producerName});t?t[1]+=e.value:s.push([e.producerName,e.value])}),s.sort(function(e,t){return e[0].localeCompare(t[0])}).forEach(function(e){i+=e[0]+": "+e[1]+"<br>"})),"<b>produced by:</b><br>"!==i&&(t+="<hr>"+i),t}},{key:"showCurrentTutorial",value:function(){this.tutorialService.showCurrentViewTutorial()}},{key:"getFoodValue",value:function(){return this.resourcesService.getFoodValue("Village")}},{key:"isFoodNutritionEnabled",value:function(){return this.managementService.getFoodNutrition()}},{key:"getConsumableResources",value:function(){return this.resourcesService.getResourcesByType(Hv.CONSUMABLE).filter(function(e){return e.isVisible()})}},{key:"getDailyNutritionUsage",value:function(){return 5*(this.resourcesService.getTotalPeople()-1)*this.managementService.getRations()}},{key:"getAverageDailyNutritionProduction",value:function(){return this.resourcesService.getAverageNutritionProduction()}},{key:"getRations",value:function(){return.5*this.managementService.getRations()}},{key:"isHeaderTwoLines",value:function(){return this.managementService.getSecondHeaderRow()}},{key:"showFreeWorkers",value:function(){return this.managementService.getShowFreeWorkers()}},{key:"getFreeWorkers",value:function(){return this.resourcesService.getPeople()}},{key:"showPopulation",value:function(){return this.managementService.getShowPopulation()}},{key:"getPopulation",value:function(){return this.resourcesService.getTotalPeople()+"/"+this.resourcesService.getPopulationCap()}},{key:"isManagementResearched",value:function(){return this.gameService.isEnabled(wv.MANAGEMENT)}},{key:"showResearchProgress",value:function(){return this.managementService.getShowResearchProgress()}},{key:"getResearchProgress",value:function(){var e=this.techService.getCurrentResearch();return e?Qv.prepareTechName(e.getTech())+": "+e.getResearchPoints()+"/"+e.getRequiredResearchPoints():"no research"}},{key:"showFaith",value:function(){return this.managementService.getShowFaith()}},{key:"showHappiness",value:function(){return this.managementService.getShowHappiness()}},{key:"getFaith",value:function(){return this.religionService.getFaith()+"/"+this.religionService.getFaithCap()}},{key:"isFaithUnlocked",value:function(){return this.gameService.isEnabled(wv.RELIGION)}},{key:"isRawEnabled",value:function(){return this.managementService.getShowRaw()}},{key:"geRawResources",value:function(){return this.resourcesService.getResourcesByType(Hv.RAW).filter(function(e){return e.isVisible()})}},{key:"isProcessedEnabled",value:function(){return this.managementService.getShowProcessed()}},{key:"geProcessedResources",value:function(){return this.resourcesService.getResourcesByType(Hv.PROCESSED).filter(function(e){return e.isVisible()})}},{key:"isFoodEnabled",value:function(){return this.managementService.getShowFood()}},{key:"geFoodResources",value:function(){return this.resourcesService.getResourcesByType(Hv.FOOD).filter(function(e){return e.isVisible()})}},{key:"isToolsEnabled",value:function(){return this.managementService.getShowTools()}},{key:"geToolsResources",value:function(){return this.resourcesService.getResourcesByType(Hv.TOOLS).filter(function(e){return e.isVisible()})}},{key:"openHappiness",value:function(){this.router.navigate(["/management/happiness"])}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(tD),Bs($v),Bs(Cm),Bs(Jv),Bs(DE),Bs(vk),Bs(Om),Bs(_m),Bs(mM),Bs(Nm),Bs(zI),Bs(AA),Bs(sv),Bs(DR))},e.\u0275cmp=it({type:e,selectors:[["app-header"]],viewQuery:function(e,t){var i;(1&e&&(rc(eF,5),rc(tF,5)),2&e)&&(nc(i=sc())&&(t.line1Ref=i.first),nc(i=sc())&&(t.line22Ref=i.first))},decls:2,vars:2,consts:[["id","wrapperOneLine",4,"ngIf"],["id","wrapperTwoLines",4,"ngIf"],["id","wrapperOneLine"],["class","highlighted icon tooltip","appTooltip","",3,"elementId",4,"ngIf"],["class","highlighted icon",4,"ngIf"],["class","highlighted",4,"ngFor","ngForOf"],["id","right"],[4,"ngIf"],["id","weather",1,"icon"],[3,"name","path"],["id","temp"],[1,"dropdown"],["draggable","false","id","cog","src","assets/settings.svg","alt","settings",4,"ngIf"],["draggable","false","id","cog","src","assets/pause.svg","alt","settings",4,"ngIf"],[1,"dropdown-content"],[3,"click"],[3,"click",4,"ngIf"],["appTooltip","",1,"highlighted","icon","tooltip",3,"elementId"],[3,"name","path","title"],["id","nutTolltip"],["class","icon",4,"ngFor","ngForOf"],[1,"icon"],["id","rawTolltip"],["id","processedTolltip"],["id","foodTolltip"],["id","toolsTolltip"],[1,"highlighted","icon"],[3,"name"],[3,"name","title"],[1,"highlighted"],["appTooltip","",1,"icon","tooltip",3,"elementId"],[3,"id"],[1,"center"],[1,"center",3,"innerHTML"],["class","full",4,"ngIf"],[1,"full"],["draggable","false","id","cog","src","assets/settings.svg","alt","settings"],["draggable","false","id","cog","src","assets/pause.svg","alt","settings"],["id","wrapperTwoLines"],[1,"line"],["draggable","false","ondragstart","return false;","id","cog","src","assets/settings.svg","alt","settings",4,"ngIf"],["draggable","false","ondragstart","return false;","id","cog","src","assets/pause.svg","alt","settings",4,"ngIf"],["draggable","false","ondragstart","return false;","id","cog","src","assets/settings.svg","alt","settings"],["draggable","false","ondragstart","return false;","id","cog","src","assets/pause.svg","alt","settings"]],template:function(e,t){1&e&&(Gs(0,PF,51,25,"div",0),Gs(1,cU,52,25,"div",1)),2&e&&(Ws("ngIf",!t.isHeaderTwoLines()),ho(1),Ws("ngIf",t.isHeaderTwoLines()))},directives:[Gl,Ul,oT,sT,gT,Jx],pipes:[$l],styles:["#wrapperTwoLines[_ngcontent-%COMP%]{font-size:1em;display:flex;flex-direction:column;height:100%;align-items:center}#wrapperOneLine[_ngcontent-%COMP%]{font-size:1em;display:flex;height:100%;align-items:center}.line[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:50%;width:100%}button[_ngcontent-%COMP%]{width:100%;margin:0;padding:0}app-calendar[_ngcontent-%COMP%]{display:inline-block}.highlighted[_ngcontent-%COMP%]{display:inline-block}#cog[_ngcontent-%COMP%]{float:right;margin-top:-2px;height:30px;width:30px}#cog[_ngcontent-%COMP%]:hover{cursor:pointer}.dropdown[_ngcontent-%COMP%]{position:absolute;right:4px;display:inline-block}.dropdown-content[_ngcontent-%COMP%]{cursor:pointer;display:none;position:absolute;list-style:none;background-color:#f9f9f9;white-space:nowrap;text-align:center;right:0;font-size:1.2em;margin-top:25px;padding:0;border:black solid 1px;z-index:1000}.dropdown-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:var(--passive-colour);border:black solid 1px;padding:3px}.dropdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--active-colour)}#cog[_ngcontent-%COMP%]{width:30px}#temp[_ngcontent-%COMP%]{padding-top:2px;padding-left:5px}.full[_ngcontent-%COMP%]{font-weight:600}app-calendar[_ngcontent-%COMP%]{display:inline-block;font-size:1.1em}#right[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:row;font-size:1.1em;margin-top:2px;right:40px}app-icon[_ngcontent-%COMP%]{flex:0 0 auto;margin-right:3px}#weather[_ngcontent-%COMP%]{flex:0 0 auto}.icon[_ngcontent-%COMP%]{font-size:1.1em;display:flex;flex-direction:row;align-items:center}hr[_ngcontent-%COMP%]{border-color:#000}.center[_ngcontent-%COMP%]{text-align:center}app-happiness[_ngcontent-%COMP%]{cursor:pointer}"]}),e}();function hU(e,t){if(1&e&&(zs(0,"a",18),ha(1),Ys()),2&e){var i=ta();ho(1),da(i.getVillageStageName())}}function dU(e,t){if(1&e&&(zs(0,"a",19),ha(1),Ys()),2&e){var i=ta();sa("active",!0),ho(1),da(i.getVillageStageName())}}function gU(e,t){1&e&&(zs(0,"a",20),ha(1,"Management"),Ys())}function fU(e,t){1&e&&(zs(0,"a",21),ha(1,"Crafting"),Ys())}function vU(e,t){1&e&&(zs(0,"a",22),ha(1,"Research"),Ys())}function pU(e,t){1&e&&(zs(0,"a",23),ha(1,"Market"),Ys())}function mU(e,t){1&e&&(zs(0,"a",24),ha(1,"Army"),Ys())}function SU(e,t){1&e&&(zs(0,"a",25),ha(1,"Religion"),Ys())}function EU(e,t){1&e&&(zs(0,"a",26),ha(1,"Weather"),Ys())}function yU(e,t){1&e&&(zs(0,"a",27),ha(1,"World Map"),Ys())}function RU(e,t){1&e&&(zs(0,"a",28),ha(1,"Navy"),Ys())}function OU(e,t){1&e&&(zs(0,"a",29),ha(1,"Heritage"),Ys())}function TU(e,t){1&e&&js(0,"a",30)}var IU=function(){var e=function(){function e(t,i,n){p(this,e),this.gameService=t,this.resourcesService=i,this.router=n}return S(e,[{key:"ngOnInit",value:function(){}},{key:"isWeatherEnabled",value:function(){return this.gameService.isEnabled(wv.WEATHER)}},{key:"isMarketEnabled",value:function(){return this.gameService.isEnabled(wv.MARKET)}},{key:"isManagementEnabled",value:function(){return this.gameService.isEnabled(wv.MANAGEMENT)}},{key:"isResearchEnabled",value:function(){return this.gameService.isEnabled(wv.RESEARCH)}},{key:"isArmyEnabled",value:function(){return this.gameService.isEnabled(wv.ARMY)}},{key:"isReligionEnabled",value:function(){return this.gameService.isEnabled(wv.RELIGION)}},{key:"isCraftingEnabled",value:function(){return this.gameService.isEnabled(wv.CRAFTING)}},{key:"isHeritageUnlocked",value:function(){return this.gameService.isEnabled(wv.HERITAGE)}},{key:"isCartographyEnabled",value:function(){return this.gameService.isEnabled(wv.CARTOGRAPHY)}},{key:"isDev",value:function(){return!Cp.production}},{key:"isInRegions",value:function(){return this.router.url.includes("/regions/")}},{key:"isNavyEnabled",value:function(){return this.gameService.isEnabled(wv.NAVY)}},{key:"getVillageStageName",value:function(){var e=this,t="Village";return am.forEach(function(i){e.resourcesService.getPopulationCap()>=i.population&&(t=i.name)}),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_m),Bs(DE),Bs(sv))},e.\u0275cmp=it({type:e,selectors:[["app-left-menu"]],decls:20,vars:13,consts:[["id","wrapper"],[1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/regions/village",3,"active",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/resources","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/management","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/crafting","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/research","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/market","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/army","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/religion","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/weather","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/world","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","entry","routerLink","/navy","routerLinkActive","active",4,"ngIf"],[1,"entry2","end"],["draggable","false","ondragstart","return false;","class","entry3","routerLink","/heritage","routerLinkActive","active",4,"ngIf"],["draggable","false","ondragstart","return false;","class","empty",4,"ngIf"],["draggable","false","ondragstart","return false;","routerLink","/royal","routerLinkActive","active",1,"entry3"],["draggable","false","ondragstart","return false;","routerLink","/regions","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/regions/village",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/management","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/crafting","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/research","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/market","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/army","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/religion","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/weather","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/world","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/navy","routerLinkActive","active",1,"entry"],["draggable","false","ondragstart","return false;","routerLink","/heritage","routerLinkActive","active",1,"entry3"],["draggable","false","ondragstart","return false;",1,"empty"]],template:function(e,t){1&e&&(zs(0,"div",0),js(1,"a",1),Gs(2,hU,2,1,"a",2),Gs(3,dU,2,3,"a",3),zs(4,"a",4),ha(5,"Resources"),Ys(),Gs(6,gU,2,0,"a",5),Gs(7,fU,2,0,"a",6),Gs(8,vU,2,0,"a",7),Gs(9,pU,2,0,"a",8),Gs(10,mU,2,0,"a",9),Gs(11,SU,2,0,"a",10),Gs(12,EU,2,0,"a",11),Gs(13,yU,2,0,"a",12),Gs(14,RU,2,0,"a",13),zs(15,"div",14),Gs(16,OU,2,0,"a",15),Gs(17,TU,1,0,"a",16),zs(18,"a",17),ha(19,"Royal perks"),Ys(),Ys(),Ys()),2&e&&(ho(2),Ws("ngIf",!t.isInRegions()),ho(1),Ws("ngIf",t.isInRegions()),ho(3),Ws("ngIf",t.isManagementEnabled()),ho(1),Ws("ngIf",t.isCraftingEnabled()),ho(1),Ws("ngIf",t.isResearchEnabled()),ho(1),Ws("ngIf",t.isMarketEnabled()),ho(1),Ws("ngIf",t.isArmyEnabled()),ho(1),Ws("ngIf",t.isReligionEnabled()),ho(1),Ws("ngIf",t.isWeatherEnabled()),ho(1),Ws("ngIf",t.isCartographyEnabled()),ho(1),Ws("ngIf",t.isNavyEnabled()),ho(2),Ws("ngIf",t.isHeritageUnlocked()),ho(1),Ws("ngIf",!t.isHeritageUnlocked()))},directives:[Gl,uv,lv],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column}.entry[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:5%;text-align:center;border-bottom:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1.1em}.entry2[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:10%;text-align:center;border:none;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry3[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:50%;text-align:center;border-top:black solid 2px;cursor:pointer;text-decoration:none;color:#000;font-size:1em}.entry3[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.entry[_ngcontent-%COMP%]:first-of-type{cursor:default}.empty[_ngcontent-%COMP%]{padding:0;margin:0;display:flex;justify-content:center;flex-direction:column;height:50%;text-align:center;text-decoration:none;color:#000;font-size:1em;cursor:default}.entry.active[_ngcontent-%COMP%]{background:var(--active-colour);text-decoration:none}.entry3.active[_ngcontent-%COMP%]{background:var(--active-colour);text-decoration:none}.end[_ngcontent-%COMP%]{margin-top:auto;border:none}"]}),e}(),bU=["scroll"];function CU(e,t){if(1&e&&(zs(0,"span"),zs(1,"span",12),ha(2),Ys(),js(3,"span",13),Ys()),2&e){var i=ta().$implicit;ho(2),ga("day ",i.day,":"),ho(1),Ws("innerHTML"," "+i.message,dr)}}function AU(e,t){if(1&e&&(zs(0,"span",14),zs(1,"span",12),ha(2),Ys(),js(3,"span",13),Ys()),2&e){var i=ta().$implicit;ho(2),ga("day ",i.day,":"),ho(1),Ws("innerHTML"," "+i.message,dr)}}function kU(e,t){if(1&e&&(zs(0,"span",15),zs(1,"span",12),ha(2),Ys(),js(3,"span",13),Ys()),2&e){var i=ta().$implicit;ho(2),ga("day ",i.day,":"),ho(1),Ws("innerHTML"," "+i.message,dr)}}function NU(e,t){if(1&e&&(zs(0,"span",16),zs(1,"span",12),ha(2),Ys(),js(3,"span",13),Ys()),2&e){var i=ta().$implicit;ho(2),ga("day ",i.day,":"),ho(1),Ws("innerHTML"," "+i.message,dr)}}function _U(e,t){if(1&e){var i=qs();zs(0,"span"),zs(1,"span",12),ha(2),Ys(),js(3,"span",13),zs(4,"button",17),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().showFightReport(e.data)}),ha(5,"report"),Ys(),Ys()}if(2&e){var n=ta().$implicit;ho(2),ga("day ",n.day,":"),ho(1),Ws("innerHTML"," "+n.message,dr)}}function wU(e,t){if(1&e){var i=qs();zs(0,"span",15),zs(1,"span",12),ha(2),Ys(),js(3,"span",13),zs(4,"button",17),$s("click",function(){Kt(i);var e=ta().$implicit;return ta().showErrorReport(e.data)}),ha(5,"report"),Ys(),Ys()}if(2&e){var n=ta().$implicit;ho(2),ga("day ",n.day,":"),ho(1),Ws("innerHTML"," "+n.message,dr)}}function PU(e,t){if(1&e&&(zs(0,"li"),zs(1,"div",7),Gs(2,CU,4,2,"span",8),Gs(3,AU,4,2,"span",9),Gs(4,kU,4,2,"span",10),Gs(5,NU,4,2,"span",11),Gs(6,_U,6,2,"span",8),Gs(7,wU,6,2,"span",10),Ys(),Ys()),2&e){var i=t.$implicit,n=ta();ho(1),Ws("ngSwitch",i.type),ho(1),Ws("ngSwitchCase",n.logEntryTypes.LOG),ho(1),Ws("ngSwitchCase",n.logEntryTypes.SUCCESS),ho(1),Ws("ngSwitchCase",n.logEntryTypes.WARNING),ho(1),Ws("ngSwitchCase",n.logEntryTypes.MYSTICAL),ho(1),Ws("ngSwitchCase",n.logEntryTypes.FIGHT_REPORT),ho(1),Ws("ngSwitchCase",n.logEntryTypes.ERROR)}}var MU=function(){var e=function(){function e(t,i,n){p(this,e),this.logService=t,this.changeDetectorRef=i,this.modalService=n,this.entries=[],this.logEntryTypes=lp}return S(e,[{key:"ngOnInit",value:function(){var e=this;this.logService.registerForLogs().subscribe(function(){e.entries=e.logService.getEntries(),e.scrollToBottom()}),this.entries=this.logService.getEntries(),this.scrollToBottom()}},{key:"clearLogs",value:function(){this.logService.clearEntries()}},{key:"scrollToBottom",value:function(){var e=this.scrollRef.nativeElement,t=e.scrollHeight-e.clientHeight<=e.scrollTop+25;this.changeDetectorRef.destroyed||this.changeDetectorRef.detectChanges(),t&&(e.scrollTop=e.scrollHeight)}},{key:"showFightReport",value:function(e){this.modalService.open(_v.FIGHT_REPORT),this.modalService.setFightReport(e)}},{key:"showErrorReport",value:function(e){this.modalService.open(_v.ERROR),this.modalService.setModalErrorReport(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(Cm),Bs(cu),Bs(Jv))},e.\u0275cmp=it({type:e,selectors:[["app-log"]],viewQuery:function(e,t){var i;(1&e&&rc(bU,7),2&e)&&(nc(i=sc())&&(t.scrollRef=i.first))},decls:10,vars:1,consts:[["id","wrapper"],[1,"title"],["id","title-text"],["id","clear-button",3,"click"],["id","log"],["scroll",""],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","success",4,"ngSwitchCase"],["class","warning",4,"ngSwitchCase"],["class","mystical",4,"ngSwitchCase"],[1,"date"],[3,"innerHTML"],[1,"success"],[1,"warning"],[1,"mystical"],[3,"click"]],template:function(e,t){1&e&&(zs(0,"div",0),zs(1,"div",1),zs(2,"span",2),ha(3,"Log"),Ys(),zs(4,"button",3),$s("click",function(){return t.clearLogs()}),ha(5,"clear"),Ys(),Ys(),zs(6,"div",4,5),zs(8,"ul"),Gs(9,PU,8,7,"li",6),Ys(),Ys(),Ys()),2&e&&(ho(9),Ws("ngForOf",t.entries))},directives:[Ul,zl,Yl],styles:["#wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:100%}#clear-button[_ngcontent-%COMP%]{float:right}#log[_ngcontent-%COMP%]{height:100%;overflow-y:scroll;font-size:.8em}.title[_ngcontent-%COMP%]{border-bottom:black solid 1px;text-align:center;font-weight:bold;font-size:1.1em}#title-text[_ngcontent-%COMP%]{display:inline-block;margin-left:20px;margin-top:3px}ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}li[_ngcontent-%COMP%]{padding-left:.5%;padding-bottom:.4%}.date[_ngcontent-%COMP%]{font-weight:bolder}.warning[_ngcontent-%COMP%]{color:var(--negative-colour)}.success[_ngcontent-%COMP%]{color:var(--positive-colour)}.mystical[_ngcontent-%COMP%]{color:#00008b}#log[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:1px;margin-left:2px}"]}),e}();function DU(e,t){if(1&e){var i=qs();zs(0,"span",8),zs(1,"img",9),$s("click",function(){return Kt(i),ta().toggleSound()}),Ys(),Ys()}}function LU(e,t){if(1&e){var i=qs();zs(0,"span",8),zs(1,"img",10),$s("click",function(){return Kt(i),ta().toggleSound()}),Ys(),Ys()}}function xU(e,t){if(1&e){var i=qs();zs(0,"span",11),zs(1,"img",12),$s("click",function(){return Kt(i),ta().pause()}),Ys(),Ys()}}function FU(e,t){if(1&e){var i=qs();zs(0,"span",11),zs(1,"img",13),$s("click",function(){return Kt(i),ta().resume()}),Ys(),Ys()}}var UU=function(){var e=function(){function e(t,i,n){p(this,e),this.gameService=t,this.tickerService=i,this.optionsService=n,this.gameName=Cp.gameName,this.version=Cp.versionString}return S(e,[{key:"ngOnInit",value:function(){}},{key:"showDevNotes",value:function(){this.gameService.showDevNotes()}},{key:"getSound",value:function(){return this.optionsService.getOption(Xv.SOUND_MASTER)}},{key:"toggleSound",value:function(){this.optionsService.setOption(Xv.SOUND_MASTER,!this.optionsService.getOption(Xv.SOUND_MASTER))}},{key:"isPaused",value:function(){return this.tickerService.isPaused()}},{key:"pause",value:function(){this.tickerService.pause()}},{key:"resume",value:function(){this.tickerService.resume()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_m),Bs(mM),Bs(Om))},e.\u0275cmp=it({type:e,selectors:[["app-footer"]],decls:13,vars:6,consts:[["id","wrapper"],["class","first",4,"ngIf"],["class","second",4,"ngIf"],["id","center"],["id","wiki"],["target","_blank","rel","noopener noreferrer","href","http://wiki.villagerkings.com"],["id","dev"],["draggable","false","ondragstart","return false;","src","assets/dev.svg","title","dev notes",3,"click"],[1,"first"],["draggable","false","ondragstart","return false;","src","assets/sound_on.svg","title","turn master sounds off",3,"click"],["draggable","false","ondragstart","return false;","src","assets/sound_off.svg","title","turn master sound on",3,"click"],[1,"second"],["draggable","false","ondragstart","return false;","src","assets/pause2.svg","title","pause",3,"click"],["draggable","false","ondragstart","return false;","src","assets/play.svg","title","play",3,"click"]],template:function(e,t){1&e&&(zs(0,"div",0),Gs(1,DU,2,0,"span",1),Gs(2,LU,2,0,"span",1),Gs(3,xU,2,0,"span",2),Gs(4,FU,2,0,"span",2),zs(5,"div",3),zs(6,"span"),ha(7),Ys(),Ys(),zs(8,"span",4),zs(9,"a",5),ha(10,"wiki"),Ys(),Ys(),zs(11,"span",6),zs(12,"img",7),$s("click",function(){return t.showDevNotes()}),Ys(),Ys(),Ys()),2&e&&(ho(1),Ws("ngIf",t.getSound()),ho(1),Ws("ngIf",!t.getSound()),ho(1),Ws("ngIf",!t.isPaused()),ho(1),Ws("ngIf",t.isPaused()),ho(3),fa("",t.gameName," v",t.version,""))},directives:[Gl],styles:["#wrapper[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:row;font-size:1.2em}.first[_ngcontent-%COMP%]{flex:0 0 35px;height:30px}.second[_ngcontent-%COMP%]{display:flex;flex:0 0 35px;height:30px;align-items:center;vertical-align:center}.second[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:24px}#center[_ngcontent-%COMP%]{flex:0 0 calc(100% - 150px);display:flex;justify-content:center;align-items:center}#wiki[_ngcontent-%COMP%]{display:flex;flex:0 0 35px;justify-content:flex-end;margin-top:5px}a[_ngcontent-%COMP%]{text-decoration:none;color:#000}#dev[_ngcontent-%COMP%]{display:flex;flex:0 0 35px;height:30px;justify-content:flex-end}img[_ngcontent-%COMP%]{width:30px;cursor:pointer}"]}),e}(),HU=["wrap"],GU=function(){var e=function(){function e(t,i,n,r,o,s,a,u,c,l,h,d,g,f,v,m,S,E){var y=this;p(this,e),this.gameService=t,this.randomService=i,this.optionsService=n,this.tickerService=r,this.serializerService=o,this.resourceService=s,this.techService=a,this.logService=u,this.seaService=c,this.mountainsService=l,this.fortService=h,this.forestService=d,this.fieldService=g,this.managementService=f,this.villageService=v,this.regionsService=m,this.soundService=S,this.router=E,t.registerForHeaderRowsChange().subscribe(function(e){e&&y.wrapperRef?y.wrapperRef.nativeElement.style.gridTemplateRows="70px auto 35px":!e&&y.wrapperRef&&(y.wrapperRef.nativeElement.style.gridTemplateRows="35px auto 35px")})}return S(e,[{key:"ngOnInit",value:function(){this.serializerService.hasSave()?this.serializerService.initLoad():this.initGame(),this.managementService.getSecondHeaderRow()&&this.wrapperRef&&(this.wrapperRef.nativeElement.style.gridTemplateRows="70px auto 35px"),this.tickerService.start(),this.optionsService.getOption(Xv.PAUSE_ON_INIT)&&(this.logService.warning("Game paused on start (settings option)"),this.tickerService.pause()),this.soundService.playMusic()}},{key:"initGame",value:function(){this.gameService.init(),this.optionsService.init(),this.resourceService.init(),this.villageService.init(),this.fortService.init(),this.forestService.init(),this.fieldService.init(),this.mountainsService.init(),this.seaService.init()}},{key:"exitSave",value:function(e){this.serializerService.initSave()}},{key:"pause",value:function(e){if("VillagerKings"===e.target.id)switch(e.key){case"p":"VillagerKings"===e.target.id&&(this.tickerService.isPaused()?this.tickerService.resume():this.tickerService.pause());break;case"m":this.gameService.isEnabled(wv.CARTOGRAPHY)&&this.router.navigate(["/world"])}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Bs(_m),Bs(sp),Bs(Om),Bs(mM),Bs(tD),Bs(DE),Bs(zI),Bs(Cm),Bs(bC),Bs(iC),Bs(QC),Bs(yb),Bs(Hb),Bs(DR),Bs(MR),Bs($x),Bs(Tm),Bs(sv))},e.\u0275cmp=it({type:e,selectors:[["app-game"]],viewQuery:function(e,t){var i;(1&e&&rc(HU,7),2&e)&&(nc(i=sc())&&(t.wrapperRef=i.first))},hostBindings:function(e,t){1&e&&$s("beforeunload",function(e){return t.exitSave(e)},!1,Or)("keydown",function(e){return t.pause(e)},!1,Tr)},decls:132,vars:0,consts:[["id","wrapper"],["wrap",""],["src","assets/buff.svg","alt","",1,"asset"],["src","assets/complex_management_off_off.svg","alt","",1,"asset"],["src","assets/complex_management_off_on.svg","alt","",1,"asset"],["src","assets/complex_management_on_off.svg","alt","",1,"asset"],["src","assets/complex_management_on_on.svg","alt","",1,"asset"],["src","assets/details.svg","alt","",1,"asset"],["src","assets/dev.svg","alt","",1,"asset"],["src","assets/eye.svg","alt","",1,"asset"],["src","assets/foresight.svg","alt","",1,"asset"],["src","assets/forest.svg","alt","",1,"asset"],["src","assets/gear.svg","alt","",1,"asset"],["src","assets/gear_off.svg","alt","",1,"asset"],["src","assets/hammer.svg","alt","",1,"asset"],["src","assets/kred.png","alt","",1,"asset"],["src","assets/land.svg","alt","",1,"asset"],["src","assets/manage.svg","alt","",1,"asset"],["src","assets/mountains.svg","alt","",1,"asset"],["src","assets/pause.svg","alt","",1,"asset"],["src","assets/pause2.svg","alt","",1,"asset"],["src","assets/play.svg","alt","",1,"asset"],["src","assets/population.svg","alt","",1,"asset"],["src","assets/question_mark.svg","alt","",1,"asset"],["src","assets/settings.svg","alt","",1,"asset"],["src","assets/sound_off.svg","alt","",1,"asset"],["src","assets/sound_on.svg","alt","",1,"asset"],["src","assets/stop.svg","alt","",1,"asset"],["src","assets/tick.svg","alt","",1,"asset"],["src","assets/time.svg","alt","",1,"asset"],["src","assets/trade.svg","alt","",1,"asset"],["src","assets/upgrade.svg","alt","",1,"asset"],["src","assets/village.svg","alt","",1,"asset"],["src","assets/religion/faith.svg","alt","",1,"asset"],["src","assets/religion/faith_shield.svg","alt","",1,"asset"],["src","assets/weather/clouds.svg","alt","",1,"asset"],["src","assets/weather/rain.svg","alt","",1,"asset"],["src","assets/weather/snow.svg","alt","",1,"asset"],["src","assets/weather/storm.svg","alt","",1,"asset"],["src","assets/weather/sun.svg","alt","",1,"asset"],["src","assets/weather/wind.svg","alt","",1,"asset"],["src","assets/army/attack.svg","alt","",1,"asset"],["src","assets/army/barracks.svg","alt","",1,"asset"],["src","assets/army/defense.svg","alt","",1,"asset"],["src","assets/army/invasion.svg","alt","",1,"asset"],["src","assets/army/recruit.svg","alt","",1,"asset"],["src","assets/happiness/angry.svg","alt","",1,"asset"],["src","assets/happiness/happy.svg","alt","",1,"asset"],["src","assets/happiness/neutral.svg","alt","",1,"asset"],["src","assets/happiness/overjoyed.svg","alt","",1,"asset"],["src","assets/happiness/sad.svg","alt","",1,"asset"],["src","assets/resources/apple.svg","alt","",1,"asset"],["src","assets/resources/barley.svg","alt","",1,"asset"],["src","assets/resources/beer.svg","alt","",1,"asset"],["src","assets/resources/berry.svg","alt","",1,"asset"],["src","assets/resources/bow.svg","alt","",1,"asset"],["src","assets/resources/bread.svg","alt","",1,"asset"],["src","assets/resources/bricks.svg","alt","",1,"asset"],["src","assets/resources/bronze.svg","alt","",1,"asset"],["src","assets/resources/brushwood.svg","alt","",1,"asset"],["src","assets/resources/cheese.svg","alt","",1,"asset"],["src","assets/resources/chicken.svg","alt","",1,"asset"],["src","assets/resources/clay.svg","alt","",1,"asset"],["src","assets/resources/clothes.svg","alt","",1,"asset"],["src","assets/resources/coal.svg","alt","",1,"asset"],["src","assets/resources/coins.svg","alt","",1,"asset"],["src","assets/resources/cooked_fish.svg","alt","",1,"asset"],["src","assets/resources/cooked_meat.svg","alt","",1,"asset"],["src","assets/resources/copper.svg","alt","",1,"asset"],["src","assets/resources/copper_ore.svg","alt","",1,"asset"],["src","assets/resources/cotton.svg","alt","",1,"asset"],["src","assets/resources/cow.svg","alt","",1,"asset"],["src","assets/resources/cut_stone.svg","alt","",1,"asset"],["src","assets/resources/egg.svg","alt","",1,"asset"],["src","assets/resources/fabric.svg","alt","",1,"asset"],["src","assets/resources/fish.svg","alt","",1,"asset"],["src","assets/resources/flour.svg","alt","",1,"asset"],["src","assets/resources/food.svg","alt","",1,"asset"],["src","assets/resources/fuel.svg","alt","",1,"asset"],["src","assets/resources/fur.svg","alt","",1,"asset"],["src","assets/resources/gold.svg","alt","",1,"asset"],["src","assets/resources/gold_ore.svg","alt","",1,"asset"],["src","assets/resources/grape.svg","alt","",1,"asset"],["src","assets/resources/hay.svg","alt","",1,"asset"],["src","assets/resources/hop.svg","alt","",1,"asset"],["src","assets/resources/horse.svg","alt","",1,"asset"],["src","assets/resources/iron.svg","alt","",1,"asset"],["src","assets/resources/iron_ore.svg","alt","",1,"asset"],["src","assets/resources/leather.svg","alt","",1,"asset"],["src","assets/resources/leather_armor.svg","alt","",1,"asset"],["src","assets/resources/light_armor.svg","alt","",1,"asset"],["src","assets/resources/heavy_armor.svg","alt","",1,"asset"],["src","assets/resources/log.svg","alt","",1,"asset"],["src","assets/resources/meat.svg","alt","",1,"asset"],["src","assets/resources/meat_soup.svg","alt","",1,"asset"],["src","assets/resources/milk.svg","alt","",1,"asset"],["src","assets/resources/mushroom.svg","alt","",1,"asset"],["src","assets/resources/nails.svg","alt","",1,"asset"],["src","assets/resources/omelette.svg","alt","",1,"asset"],["src","assets/resources/pig.svg","alt","",1,"asset"],["src","assets/resources/plank.svg","alt","",1,"asset"],["src","assets/resources/pottery.svg","alt","",1,"asset"],["src","assets/resources/sheep.svg","alt","",1,"asset"],["src","assets/resources/silver.svg","alt","",1,"asset"],["src","assets/resources/silver_ore.svg","alt","",1,"asset"],["src","assets/resources/steel.svg","alt","",1,"asset"],["src","assets/resources/stone.svg","alt","",1,"asset"],["src","assets/resources/axe.svg","alt","",1,"asset"],["src","assets/resources/hammer.svg","alt","",1,"asset"],["src","assets/resources/pickaxe.svg","alt","",1,"asset"],["src","assets/resources/pie.svg","alt","",1,"asset"],["src","assets/resources/shovel.svg","alt","",1,"asset"],["src","assets/resources/spear.svg","alt","",1,"asset"],["src","assets/resources/sword.svg","alt","",1,"asset"],["src","assets/resources/tin.svg","alt","",1,"asset"],["src","assets/resources/tin_ore.svg","alt","",1,"asset"],["src","assets/resources/vegetable_soup.svg","alt","",1,"asset"],["src","assets/resources/wheat.svg","alt","",1,"asset"],["src","assets/resources/wine.svg","alt","",1,"asset"],["src","assets/resources/shield.svg","alt","",1,"asset"],["src","assets/resources/wool.svg","alt","",1,"asset"],["id","header"],["id","left-menu"],["id","center"],["id","screen"],["id","right-menu"],["id","footer"]],template:function(e,t){1&e&&(zs(0,"div",0,1),js(2,"img",2),js(3,"img",3),js(4,"img",4),js(5,"img",5),js(6,"img",6),js(7,"img",7),js(8,"img",8),js(9,"img",9),js(10,"img",10),js(11,"img",11),js(12,"img",12),js(13,"img",13),js(14,"img",14),js(15,"img",15),js(16,"img",16),js(17,"img",17),js(18,"img",18),js(19,"img",19),js(20,"img",20),js(21,"img",21),js(22,"img",22),js(23,"img",23),js(24,"img",24),js(25,"img",25),js(26,"img",26),js(27,"img",27),js(28,"img",28),js(29,"img",29),js(30,"img",30),js(31,"img",31),js(32,"img",32),js(33,"img",33),js(34,"img",34),js(35,"img",35),js(36,"img",36),js(37,"img",37),js(38,"img",38),js(39,"img",39),js(40,"img",40),js(41,"img",41),js(42,"img",42),js(43,"img",43),js(44,"img",44),js(45,"img",45),js(46,"img",46),js(47,"img",47),js(48,"img",48),js(49,"img",49),js(50,"img",50),js(51,"img",51),js(52,"img",52),js(53,"img",53),js(54,"img",54),js(55,"img",55),js(56,"img",56),js(57,"img",57),js(58,"img",58),js(59,"img",59),js(60,"img",60),js(61,"img",61),js(62,"img",62),js(63,"img",63),js(64,"img",64),js(65,"img",65),js(66,"img",66),js(67,"img",67),js(68,"img",68),js(69,"img",69),js(70,"img",70),js(71,"img",71),js(72,"img",72),js(73,"img",73),js(74,"img",74),js(75,"img",75),js(76,"img",76),js(77,"img",77),js(78,"img",78),js(79,"img",79),js(80,"img",80),js(81,"img",81),js(82,"img",82),js(83,"img",83),js(84,"img",84),js(85,"img",85),js(86,"img",86),js(87,"img",87),js(88,"img",88),js(89,"img",89),js(90,"img",90),js(91,"img",91),js(92,"img",92),js(93,"img",93),js(94,"img",94),js(95,"img",95),js(96,"img",96),js(97,"img",97),js(98,"img",98),js(99,"img",99),js(100,"img",100),js(101,"img",101),js(102,"img",102),js(103,"img",103),js(104,"img",104),js(105,"img",105),js(106,"img",106),js(107,"img",107),js(108,"img",108),js(109,"img",109),js(110,"img",110),js(111,"img",111),js(112,"img",112),js(113,"img",113),js(114,"img",114),js(115,"img",115),js(116,"img",116),js(117,"img",117),js(118,"img",118),js(119,"img",119),js(120,"img",120),zs(121,"div",121),js(122,"app-header"),Ys(),zs(123,"div",122),js(124,"app-left-menu"),Ys(),zs(125,"div",123),zs(126,"div",124),js(127,"router-outlet"),Ys(),Ys(),zs(128,"div",125),js(129,"app-log"),Ys(),zs(130,"div",126),js(131,"app-footer"),Ys(),Ys())},directives:[lU,IU,hv,MU,UU],styles:["#wrapper[_ngcontent-%COMP%]{position:relative;display:grid;height:calc(100% - 2px);width:calc(100% - 2px);max-height:100%;grid-template-columns:11% auto 20%;grid-template-rows:35px auto 35px;border:black solid 1px;background:var(--background-clour);background-image:url(old_parchment.5ec6f5823080b4e43708.jpg);background-size:100% 100%}#header[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:4;border:black solid 1px;overflow:hidden}#left-menu[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:2;border:black solid 1px;overflow:hidden}#center[_ngcontent-%COMP%]{grid-column-start:2;grid-column-end:3;border:black solid 1px;overflow:hidden}#screen[_ngcontent-%COMP%]{height:100%}#right-menu[_ngcontent-%COMP%]{grid-column-start:3;grid-column-end:4;border:black solid 1px;overflow:hidden}#footer[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:4;border:black solid 1px;overflow:hidden}.asset[_ngcontent-%COMP%]{display:none}"]}),e}();function BU(e,t){1&e&&(Ks(0),js(1,"app-modals"),js(2,"app-game"),Qs())}function WU(e,t){1&e&&(Ks(0),zs(1,"div",1),zs(2,"span"),ha(3,"Internet Explorer is not supported."),js(4,"br"),ha(5,"Please use Firefox, Chrome, Safari"),js(6,"br"),ha(7,"or Edge."),Ys(),Ys(),Qs())}var VU=function(){var e=function(){function e(){p(this,e),this.title="app"}return S(e,[{key:"isIE",value:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode}},{key:"catchContextMenu",value:function(e){return!1}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=it({type:e,selectors:[["app-root"]],hostBindings:function(e,t){1&e&&$s("contextmenu",function(e){return t.catchContextMenu(e)},!1,Tr)},decls:2,vars:2,consts:[[4,"ngIf"],["id","IEwrapper"]],template:function(e,t){1&e&&(Gs(0,BU,3,0,"ng-container",0),Gs(1,WU,8,0,"ng-container",0)),2&e&&(Ws("ngIf",!t.isIE()),ho(1),Ws("ngIf",t.isIE()))},directives:[Gl,Zx,GU],styles:["#IEwrapper[_ngcontent-%COMP%]{border:black solid 1px;background:#919191;font-size:3em;height:100%;max-height:100%;display:flex;justify-content:center;align-items:center}#IEwrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center}"]}),e}(),zU=function e(){p(this,e)},YU="*";function jU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function KU(e){return{type:6,styles:e,offset:null}}function QU(e){Promise.resolve(null).then(e)}var qU=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;p(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+i}return S(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;QU(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),XU=function(){function e(t){var i=this;p(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var n=0,r=0,o=0,s=this.players.length;0==s?QU(function(){return i._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++n==s&&i._onFinish()}),e.onDestroy(function(){++r==s&&i._onDestroy()}),e.onStart(function(){++o==s&&i._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return S(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var i=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(i)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function ZU(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function $U(e){switch(e.length){case 0:return new qU;case 1:return e[0];default:return new XU(e)}}function JU(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=[],a=[],u=-1,c=null;if(n.forEach(function(e){var i=e.offset,n=i==u,l=n&&c||{};Object.keys(e).forEach(function(i){var n=i,a=e[i];if("offset"!==i)switch(n=t.normalizePropertyName(n,s),a){case"!":a=r[i];break;case YU:a=o[i];break;default:a=t.normalizeStyleValue(i,n,a,s)}l[n]=a}),n||a.push(l),c=l,u=i}),s.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(s.join(l)))}return a}function eH(e,t,i,n){switch(t){case"start":e.onStart(function(){return n(i&&tH(i,"start",e))});break;case"done":e.onDone(function(){return n(i&&tH(i,"done",e))});break;case"destroy":e.onDestroy(function(){return n(i&&tH(i,"destroy",e))})}}function tH(e,t,i){var n=i.totalTime,r=iH(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==n?e.totalTime:n,!!i.disabled),o=e._data;return null!=o&&(r._data=o),r}function iH(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:i,toState:n,phaseName:r,totalTime:o,disabled:!!s}}function nH(e,t,i){var n;return e instanceof Map?(n=e.get(t))||e.set(t,n=i):(n=e[t])||(n=e[t]=i),n}function rH(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var oH=function(e,t){return!1},sH=function(e,t){return!1},aH=function(e,t,i){return[]},uH=ZU();(uH||"undefined"!=typeof Element)&&(oH="undefined"!=typeof window&&void 0!==window.document?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},sH=function(){if(uH||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,i){return t.apply(e,[i])}:sH}(),aH=function(e,t,i){var n=[];if(i)for(var r=e.querySelectorAll(t),o=0;o<r.length;o++)n.push(r[o]);else{var s=e.querySelector(t);s&&n.push(s)}return n});var cH=null,lH=!1;var hH=sH,dH=oH,gH=aH,fH=function(){var e=function(){function e(){p(this,e)}return S(e,[{key:"validateStyleProperty",value:function(e){return function(e){cH||(cH=("undefined"!=typeof document?document.body:null)||{},lH=!!cH.style&&"WebkitAppearance"in cH.style);var t=!0;return cH.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&!(t=e in cH.style)&&lH&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in cH.style),t}(e)}},{key:"matchesElement",value:function(e,t){return hH(e,t)}},{key:"containsElement",value:function(e,t){return dH(e,t)}},{key:"query",value:function(e,t,i){return gH(e,t,i)}},{key:"computeStyle",value:function(e,t,i){return i||""}},{key:"animate",value:function(e,t,i,n,r){return new qU(i,n)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),vH=function e(){p(this,e)};vH.NOOP=new fH;var pH="ng-enter",mH="ng-leave",SH="ng-trigger",EH=".ng-trigger",yH="ng-animating",RH=".ng-animating";function OH(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:TH(parseFloat(t[1]),t[2])}function TH(e,t){switch(t){case"s":return 1e3*e;default:return e}}function IH(e,t,i){return e.hasOwnProperty("duration")?e:function(e,t,i){var n,r=0,o="";if("string"==typeof e){var s=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===s)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};n=TH(parseFloat(s[1]),s[2]);var a=s[3];null!=a&&(r=TH(parseFloat(a),s[4]));var u=s[5];u&&(o=u)}else n=e;if(!i){var c=!1,l=t.length;n<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),r<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:n,delay:r,easing:o}}(e,t,i)}function bH(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(i){t[i]=e[i]}),t}function CH(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var n in e)i[n]=e[n];else bH(e,i);return i}function AH(e,t,i){return i?t+":"+i+";":""}function kH(e){for(var t="",i=0;i<e.style.length;i++){var n=e.style.item(i);t+=AH(0,n,e.style.getPropertyValue(n))}for(var r in e.style)e.style.hasOwnProperty(r)&&!r.startsWith("_")&&(t+=AH(0,UH(r),e.style[r]));e.setAttribute("style",t)}function NH(e,t,i){e.style&&(Object.keys(t).forEach(function(n){var r=FH(n);i&&!i.hasOwnProperty(n)&&(i[n]=e.style[r]),e.style[r]=t[n]}),ZU()&&kH(e))}function _H(e,t){e.style&&(Object.keys(t).forEach(function(t){var i=FH(t);e.style[i]=""}),ZU()&&kH(e))}function wH(e){return Array.isArray(e)?1==e.length?e[0]:jU(e):e}var PH=new RegExp("{{\\s*(.+?)\\s*}}","g");function MH(e){var t=[];if("string"==typeof e){for(var i;i=PH.exec(e);)t.push(i[1]);PH.lastIndex=0}return t}function DH(e,t,i){var n=e.toString(),r=n.replace(PH,function(e,n){var r=t[n];return t.hasOwnProperty(n)||(i.push("Please provide a value for the animation param ".concat(n)),r=""),r.toString()});return r==n?e:r}function LH(e){for(var t=[],i=e.next();!i.done;)t.push(i.value),i=e.next();return t}var xH=/-+([a-z0-9])/g;function FH(e){return e.replace(xH,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t[1].toUpperCase()})}function UH(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function HH(e,t,i){switch(t.type){case 7:return e.visitTrigger(t,i);case 0:return e.visitState(t,i);case 1:return e.visitTransition(t,i);case 2:return e.visitSequence(t,i);case 3:return e.visitGroup(t,i);case 4:return e.visitAnimate(t,i);case 5:return e.visitKeyframes(t,i);case 6:return e.visitStyle(t,i);case 8:return e.visitReference(t,i);case 9:return e.visitAnimateChild(t,i);case 10:return e.visitAnimateRef(t,i);case 11:return e.visitQuery(t,i);case 12:return e.visitStagger(t,i);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function GH(e,t){var i=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,i){if(":"==e[0]){var n=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,i);if("function"==typeof n)return void t.push(n);e=n}var r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return i.push('The provided transition expression "'.concat(e,'" is not supported')),t;var o=r[1],s=r[2],a=r[3];t.push(VH(o,a)),"<"==s[0]&&("*"!=o||"*"!=a)&&t.push(VH(a,o))}(e,i,t)}):i.push(e),i}var BH=new Set(["true","1"]),WH=new Set(["false","0"]);function VH(e,t){var i=BH.has(e)||WH.has(e),n=BH.has(t)||WH.has(t);return function(r,o){var s="*"==e||e==r,a="*"==t||t==o;return!s&&i&&"boolean"==typeof r&&(s=r?BH.has(e):WH.has(e)),!a&&n&&"boolean"==typeof o&&(a=o?BH.has(t):WH.has(t)),s&&a}}var zH=new RegExp("s*:selfs*,?","g");function YH(e,t,i){return new jH(e).build(t,i)}var jH=function(){function e(t){p(this,e),this._driver=t}return S(e,[{key:"build",value:function(e,t){var i=new KH(t);return this._resetContextStyleTimingState(i),HH(this,wH(e),i)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var i=this,n=t.queryCount=0,r=t.depCount=0,o=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(i._resetContextStyleTimingState(t),0==e.type){var a=e,u=a.name;u.toString().split(/\s*,\s*/).forEach(function(e){a.name=e,o.push(i.visitState(a,t))}),a.name=u}else if(1==e.type){var c=i.visitTransition(e,t);n+=c.queryCount,r+=c.depCount,s.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:o,transitions:s,queryCount:n,depCount:r,options:null}}},{key:"visitState",value:function(e,t){var i=this.visitStyle(e.styles,t),n=e.options&&e.options.params||null;if(i.containsDynamicStyles){var r=new Set,o=n||{};if(i.styles.forEach(function(e){if(QH(e)){var t=e;Object.keys(t).forEach(function(e){MH(t[e]).forEach(function(e){o.hasOwnProperty(e)||r.add(e)})})}}),r.size){var s=LH(r.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(s.join(", ")))}}return{type:0,name:e.name,style:i,options:n?{params:n}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var i=HH(this,wH(e.animation),t);return{type:1,matchers:GH(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:qH(e.options)}}},{key:"visitSequence",value:function(e,t){var i=this;return{type:2,steps:e.steps.map(function(e){return HH(i,e,t)}),options:qH(e.options)}}},{key:"visitGroup",value:function(e,t){var i=this,n=t.currentTime,r=0,o=e.steps.map(function(e){t.currentTime=n;var o=HH(i,e,t);return r=Math.max(r,t.currentTime),o});return t.currentTime=r,{type:3,steps:o,options:qH(e.options)}}},{key:"visitAnimate",value:function(e,t){var i=function(e,t){var i=null;if(e.hasOwnProperty("duration"))i=e;else if("number"==typeof e)return XH(IH(e,t).duration,0,"");var n=e;if(n.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var r=XH(0,0,"");return r.dynamic=!0,r.strValue=n,r}return XH((i=i||IH(n,t)).duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;var n,r=e.styles?e.styles:KU({});if(5==r.type)n=this.visitKeyframes(r,t);else{var o=e.styles,s=!1;if(!o){s=!0;var a={};i.easing&&(a.easing=i.easing),o=KU(a)}t.currentTime+=i.duration+i.delay;var u=this.visitStyle(o,t);u.isEmptyStep=s,n=u}return t.currentAnimateTimings=null,{type:4,timings:i,style:n,options:null}}},{key:"visitStyle",value:function(e,t){var i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}},{key:"_makeStyleAst",value:function(e,t){var i=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==YU?i.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):i.push(e)}):i.push(e.styles);var n=!1,r=null;return i.forEach(function(e){if(QH(e)){var t=e,i=t.easing;if(i&&(r=i,delete t.easing),!n)for(var o in t)if(t[o].toString().indexOf("{{")>=0){n=!0;break}}}),{type:6,styles:i,easing:r,offset:e.offset,containsDynamicStyles:n,options:null}}},{key:"_validateStyleAst",value:function(e,t){var i=this,n=t.currentAnimateTimings,r=t.currentTime,o=t.currentTime;n&&o>0&&(o-=n.duration+n.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(n){if(i._driver.validateStyleProperty(n)){var s=t.collectedStyles[t.currentQuerySelector],a=s[n],u=!0;a&&(o!=r&&o>=a.startTime&&r<=a.endTime&&(t.errors.push('The CSS property "'.concat(n,'" that exists between the times of "').concat(a.startTime,'ms" and "').concat(a.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(o,'ms" and "').concat(r,'ms"')),u=!1),o=a.startTime),u&&(s[n]={startTime:o,endTime:r}),t.options&&function(e,t,i){var n=t.params||{},r=MH(e);r.length&&r.forEach(function(e){n.hasOwnProperty(e)||i.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[n],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(n,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var i=this,n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;var r=0,o=[],s=!1,a=!1,u=0,c=e.steps.map(function(e){var n=i._makeStyleAst(e,t),c=null!=n.offset?n.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(QH(e)&&e.hasOwnProperty("offset")){var i=e;t=parseFloat(i.offset),delete i.offset}});else if(QH(e)&&e.hasOwnProperty("offset")){var i=e;t=parseFloat(i.offset),delete i.offset}return t}(n.styles),l=0;return null!=c&&(r++,l=n.offset=c),a=a||l<0||l>1,s=s||l<u,u=l,o.push(l),n});a&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,h=0;r>0&&r<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(h=1/(l-1));var d=l-1,g=t.currentTime,f=t.currentAnimateTimings,v=f.duration;return c.forEach(function(e,r){var s=h>0?r==d?1:h*r:o[r],a=s*v;t.currentTime=g+f.delay+a,f.duration=a,i._validateStyleAst(e,t),e.offset=s,n.styles.push(e)}),n}},{key:"visitReference",value:function(e,t){return{type:8,animation:HH(this,wH(e.animation),t),options:qH(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:qH(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:qH(e.options)}}},{key:"visitQuery",value:function(e,i){var n=i.currentQuerySelector,r=e.options||{};i.queryCount++,i.currentQuery=e;var o=t(function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(zH,"")),[e=e.replace(/@\*/g,EH).replace(/@\w+/g,function(e){return EH+"-"+e.substr(1)}).replace(/:animating/g,RH),t]}(e.selector),2),s=o[0],a=o[1];i.currentQuerySelector=n.length?n+" "+s:s,nH(i.collectedStyles,i.currentQuerySelector,{});var u=HH(this,wH(e.animation),i);return i.currentQuery=null,i.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:u,originalSelector:e.selector,options:qH(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var i="full"===e.timings?{duration:0,delay:0,easing:"full"}:IH(e.timings,t.errors,!0);return{type:12,animation:HH(this,wH(e.animation),t),timings:i,options:null}}}]),e}(),KH=function e(t){p(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null};function QH(e){return!Array.isArray(e)&&"object"==typeof e}function qH(e){return e?(e=bH(e)).params&&(e.params=function(e){return e?bH(e):null}(e.params)):e={},e}function XH(e,t,i){return{duration:e,delay:t,easing:i}}function ZH(e,t,i,n,r,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:i,postStyleProps:n,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}var $H=function(){function e(){p(this,e),this._map=new Map}return S(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,i(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),JH=new RegExp(":enter","g"),eG=new RegExp(":leave","g");function tG(e,t,i,n,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},a=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new iG).buildKeyframes(e,t,i,n,r,o,s,a,u,c)}var iG=function(){function e(){p(this,e)}return S(e,[{key:"buildKeyframes",value:function(e,t,i,n,r,o,s,a,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new $H;var l=new rG(e,t,u,n,r,c,[]);l.options=a,l.currentTimeline.setStyles([o],null,l.errors,a),HH(this,i,l);var h=l.timelines.filter(function(e){return e.containsAnimation()});if(h.length&&Object.keys(s).length){var d=h[h.length-1];d.allowOnlyTimelineStyles()||d.setStyles([s],null,l.errors,a)}return h.length?h.map(function(e){return e.buildKeyframes()}):[ZH(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var i=t.subInstructions.consume(t.element);if(i){var n=t.createSubContext(e.options),r=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,n,n.options);r!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,i){var n=t.currentTimeline.currentTime,r=null!=i.duration?OH(i.duration):null,o=null!=i.delay?OH(i.delay):null;return 0!==r&&e.forEach(function(e){var i=t.appendInstructionToTimeline(e,r,o);n=Math.max(n,i.duration+i.delay)}),n}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),HH(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var i=this,n=t.subContextCount,r=t,o=e.options;if(o&&(o.params||o.delay)&&((r=t.createSubContext(o)).transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=nG);var s=OH(o.delay);r.delayNextStep(s)}e.steps.length&&(e.steps.forEach(function(e){return HH(i,e,r)}),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var i=this,n=[],r=t.currentTimeline.currentTime,o=e.options&&e.options.delay?OH(e.options.delay):0;e.steps.forEach(function(s){var a=t.createSubContext(e.options);o&&a.delayNextStep(o),HH(i,s,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(r),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var i=e.strValue;return IH(t.params?DH(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var i=t.currentAnimateTimings=this._visitTiming(e.timings,t),n=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),n.snapshotCurrentStyles());var r=e.style;5==r.type?this.visitKeyframes(r,t):(t.incrementTime(i.duration),this.visitStyle(r,t),n.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var i=t.currentTimeline,n=t.currentAnimateTimings;!n&&i.getCurrentStyleProperties().length&&i.forwardFrame();var r=n&&n.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(r):i.setStyles(e.styles,r,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var i=t.currentAnimateTimings,n=t.currentTimeline.duration,r=i.duration,o=t.createSubContext().currentTimeline;o.easing=i.easing,e.styles.forEach(function(e){o.forwardTime((e.offset||0)*r),o.setStyles(e.styles,e.easing,t.errors,t.options),o.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(o),t.transformIntoNewTimeline(n+r),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var i=this,n=t.currentTimeline.currentTime,r=e.options||{},o=r.delay?OH(r.delay):0;o&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=nG);var s=n,a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;var u=null;a.forEach(function(n,r){t.currentQueryIndex=r;var a=t.createSubContext(e.options,n);o&&a.delayNextStep(o),n===t.element&&(u=a.currentTimeline),HH(i,e.animation,a),a.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,a.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var i=t.parentContext,n=t.currentTimeline,r=e.timings,o=Math.abs(r.duration),s=o*(t.currentQueryTotal-1),a=o*t.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":a=s-a;break;case"full":a=i.currentStaggerTime}var u=t.currentTimeline;a&&u.delayNextStep(a);var c=u.currentTime;HH(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=n.currentTime-c+(n.startTime-i.currentTimeline.startTime)}}]),e}(),nG={},rG=function(){function e(t,i,n,r,o,s,a,u){p(this,e),this._driver=t,this.element=i,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=nG,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new oG(this._driver,i,0),a.push(this.currentTimeline)}return S(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var i=this;if(e){var n=e,r=this.options;null!=n.duration&&(r.duration=OH(n.duration)),null!=n.delay&&(r.delay=OH(n.delay));var o=n.params;if(o){var s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(function(e){(!t||!s.hasOwnProperty(e))&&(s[e]=DH(o[e],s,i.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var i=e.params={};Object.keys(t).forEach(function(e){i[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=i||this.element,o=new e(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=nG,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,i){var n={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+e.delay,easing:""},r=new sG(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,n,e.stretchStartingKeyframe);return this.timelines.push(r),n}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,o,s){var a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(JH,"."+this._enterClassName)).replace(eG,"."+this._leaveClassName);var u=this._driver.query(this.element,e,1!=n);0!==n&&(u=n<0?u.slice(u.length+n,u.length):u.slice(0,n)),a.push.apply(a,i(u))}return!o&&0==a.length&&s.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),a}}]),e}(),oG=function(){function e(t,i,n,r){p(this,e),this._driver=t,this.element=i,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(i),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(i,this._localTimelineStyles)),this._loadKeyframe()}return S(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,i){return this.applyStylesToKeyframe(),new e(this._driver,t,i||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||YU,t._currentKeyframe[e]=YU}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,i,n){var r=this;t&&(this._previousKeyframe.easing=t);var o=n&&n.params||{},s=function(e,t){var i,n={};return e.forEach(function(e){"*"===e?(i=i||Object.keys(t)).forEach(function(e){n[e]=YU}):CH(e,!1,n)}),n}(e,this._globalTimelineStyles);Object.keys(s).forEach(function(e){var t=DH(s[e],o,i);r._pendingStyles[e]=t,r._localTimelineStyles.hasOwnProperty(e)||(r._backFill[e]=r._globalTimelineStyles.hasOwnProperty(e)?r._globalTimelineStyles[e]:YU),r._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,i=Object.keys(t);0!=i.length&&(this._pendingStyles={},i.forEach(function(i){e._currentKeyframe[i]=t[i]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var i=e._localTimelineStyles[t];e._pendingStyles[t]=i,e._updateStyle(t,i)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(i){var n=t._styleSummary[i],r=e._styleSummary[i];(!n||r.time>n.time)&&t._updateStyle(i,r.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,i=new Set,n=1===this._keyframes.size&&0===this.duration,r=[];this._keyframes.forEach(function(o,s){var a=CH(o,!0);Object.keys(a).forEach(function(e){var n=a[e];"!"==n?t.add(e):n==YU&&i.add(e)}),n||(a.offset=s/e.duration),r.push(a)});var o=t.size?LH(t.values()):[],s=i.size?LH(i.values()):[];if(n){var a=r[0],u=bH(a);a.offset=0,u.offset=1,r=[a,u]}return ZH(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}]),e}(),sG=function(e){c(i,e);var t=h(i);function i(e,n,r,o,s,a){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return p(this,i),(u=t.call(this,e,n,a.delay)).keyframes=r,u.preStyleProps=o,u.postStyleProps=s,u._stretchStartingKeyframe=c,u.timings={duration:a.duration,delay:a.delay,easing:a.easing},u}return S(i,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,i=t.delay,n=t.duration,r=t.easing;if(this._stretchStartingKeyframe&&i){var o=[],s=n+i,a=i/s,u=CH(e[0],!1);u.offset=0,o.push(u);var c=CH(e[0],!1);c.offset=aG(a),o.push(c);for(var l=e.length-1,h=1;h<=l;h++){var d=CH(e[h],!1);d.offset=aG((i+d.offset*n)/s),o.push(d)}n=s,i=0,r="",e=o}return ZH(this.element,e,this.preStyleProps,this.postStyleProps,n,i,r,!0)}}]),i}(oG);function aG(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=Math.pow(10,t-1);return Math.round(e*i)/i}var uG=function e(){p(this,e)},cG=function(e){c(i,e);var t=h(i);function i(){return p(this,i),t.apply(this,arguments)}return S(i,[{key:"normalizePropertyName",value:function(e,t){return FH(e)}},{key:"normalizeStyleValue",value:function(e,t,i,n){var r="",o=i.toString().trim();if(lG[t]&&0!==i&&"0"!==i)if("number"==typeof i)r="px";else{var s=i.match(/^[+-]?[\d\.]+([a-z]*)$/);s&&0==s[1].length&&n.push("Please provide a CSS unit value for ".concat(e,":").concat(i))}return o+r}}]),i}(uG),lG=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function hG(e,t,i,n,r,o,s,a,u,c,l,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:i,fromStyles:o,toState:n,toStyles:s,timelines:a,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:d}}var dG={},gG=function(){function e(t,i,n){p(this,e),this._triggerName=t,this.ast=i,this._stateStyles=n}return S(e,[{key:"match",value:function(e,t,i,n){return function(e,t,i,n,r){return e.some(function(e){return e(t,i,n,r)})}(this.ast.matchers,e,t,i,n)}},{key:"buildStyles",value:function(e,t,i){var n=this._stateStyles["*"],r=this._stateStyles[e],o=n?n.buildStyles(t,i):{};return r?r.buildStyles(t,i):o}},{key:"build",value:function(e,t,i,n,r,o,s,a,u,c){var l=[],h=this.ast.options&&this.ast.options.params||dG,d=this.buildStyles(i,s&&s.params||dG,l),g=a&&a.params||dG,f=this.buildStyles(n,g,l),v=new Set,p=new Map,m=new Map,S="void"===n,E={params:Object.assign(Object.assign({},h),g)},y=c?[]:tG(e,t,this.ast.animation,r,o,d,f,E,u,l),R=0;if(y.forEach(function(e){R=Math.max(e.duration+e.delay,R)}),l.length)return hG(t,this._triggerName,i,n,S,d,f,[],[],p,m,R,l);y.forEach(function(e){var i=e.element,n=nH(p,i,{});e.preStyleProps.forEach(function(e){return n[e]=!0});var r=nH(m,i,{});e.postStyleProps.forEach(function(e){return r[e]=!0}),i!==t&&v.add(i)});var O=LH(v.values());return hG(t,this._triggerName,i,n,S,d,f,y,O,p,m,R)}}]),e}(),fG=function(){function e(t,i,n){p(this,e),this.styles=t,this.defaultParams=i,this.normalizer=n}return S(e,[{key:"buildStyles",value:function(e,t){var i=this,n={},r=bH(this.defaultParams);return Object.keys(e).forEach(function(t){var i=e[t];null!=i&&(r[t]=i)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var o=e;Object.keys(o).forEach(function(e){var s=o[e];s.length>1&&(s=DH(s,r,t));var a=i.normalizer.normalizePropertyName(e,t);s=i.normalizer.normalizeStyleValue(e,a,s,t),n[a]=s})}}),n}}]),e}(),vG=function(){function e(t,i,n){var r=this;p(this,e),this.name=t,this.ast=i,this._normalizer=n,this.transitionFactories=[],this.states={},i.states.forEach(function(e){r.states[e.name]=new fG(e.style,e.options&&e.options.params||{},n)}),pG(this.states,"true","1"),pG(this.states,"false","0"),i.transitions.forEach(function(e){r.transitionFactories.push(new gG(t,e,r.states))}),this.fallbackTransition=function(e,t,i){return new gG(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return S(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,i,n){return this.transitionFactories.find(function(r){return r.match(e,t,i,n)})||null}},{key:"matchStyles",value:function(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}]),e}();function pG(e,t,i){e.hasOwnProperty(t)?e.hasOwnProperty(i)||(e[i]=e[t]):e.hasOwnProperty(i)&&(e[t]=e[i])}var mG=new $H,SG=function(){function e(t,i,n){p(this,e),this.bodyNode=t,this._driver=i,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}return S(e,[{key:"register",value:function(e,t){var i=[],n=YH(this._driver,t,i);if(i.length)throw new Error("Unable to build the animation due to the following errors: ".concat(i.join("\n")));this._animations[e]=n}},{key:"_buildPlayer",value:function(e,t,i){var n=e.element,r=JU(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(n,r,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var i,n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=[],s=this._animations[e],a=new Map;if(s?(i=tG(this._driver,t,s,pH,mH,{},{},r,mG,o)).forEach(function(e){var t=nH(a,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(o.push("The requested animation doesn't exist or has already been destroyed"),i=[]),o.length)throw new Error("Unable to create the animation due to the following errors: ".concat(o.join("\n")));a.forEach(function(e,t){Object.keys(e).forEach(function(i){e[i]=n._driver.computeStyle(t,i,YU)})});var u=$U(i.map(function(e){var t=a.get(e.element);return n._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return n.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,i,n){var r=iH(t,"","","");return eH(this._getPlayer(e),i,r,n),function(){}}},{key:"command",value:function(e,t,i,n){if("register"!=i)if("create"!=i){var r=this._getPlayer(e);switch(i){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(n[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,n[0]||{});else this.register(e,n[0])}}]),e}(),EG="ng-animate-queued",yG="ng-animate-disabled",RG=".ng-animate-disabled",OG=[],TG={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},IG={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},bG="__ng_removed",CG=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";p(this,e),this.namespaceId=i;var n=t&&t.hasOwnProperty("value");if(this.value=function(e){return null!=e?e:null}(n?t.value:t),n){var r=bH(t);delete r.value,this.options=r}else this.options={};this.options.params||(this.options.params={})}return S(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var i=this.options.params;Object.keys(t).forEach(function(e){null==i[e]&&(i[e]=t[e])})}}}]),e}(),AG="void",kG=new CG(AG),NG=function(){function e(t,i,n){p(this,e),this.id=t,this.hostElement=i,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,FG(i,this._hostClassName)}return S(e,[{key:"listen",value:function(e,t,i,n){var r=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(i,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==i||0==i.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if(!function(e){return"start"==e||"done"==e}(i))throw new Error('The provided animation trigger event "'.concat(i,'" for the animation trigger "').concat(t,'" is not supported!'));var o=nH(this._elementListeners,e,[]),s={name:t,phase:i,callback:n};o.push(s);var a=nH(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(FG(e,SH),FG(e,SH+"-"+t),a[t]=kG),function(){r._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),r._triggers[t]||delete a[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,i){var n=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this._getTrigger(t),s=new wG(this.id,t,e),a=this._engine.statesByElement.get(e);a||(FG(e,SH),FG(e,SH+"-"+t),this._engine.statesByElement.set(e,a={}));var u=a[t],c=new CG(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),a[t]=c,u||(u=kG),c.value===AG||u.value!==c.value){var l=nH(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==n.id&&e.triggerName==t&&e.queued&&e.destroy()});var h=o.matchTransition(u.value,c.value,e,c.params),d=!1;if(!h){if(!r)return;h=o.fallbackTransition,d=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:u,toState:c,player:s,isFallbackTransition:d}),d||(FG(e,EG),s.onStart(function(){UG(e,EG)})),s.onDone(function(){var t=n.players.indexOf(s);t>=0&&n.players.splice(t,1);var i=n._engine.playersByElement.get(e);if(i){var r=i.indexOf(s);r>=0&&i.splice(r,1)}}),this.players.push(s),l.push(s),s}if(!function(e,t){var i=Object.keys(e),n=Object.keys(t);if(i.length!=n.length)return!1;for(var r=0;r<i.length;r++){var o=i[r];if(!t.hasOwnProperty(o)||e[o]!==t[o])return!1}return!0}(u.params,c.params)){var g=[],f=o.matchStyles(u.value,u.params,g),v=o.matchStyles(c.value,c.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(function(){_H(e,f),NH(e,v)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,i){delete t[e]}),this._elementListeners.forEach(function(i,n){t._elementListeners.set(n,i.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var i=this,n=this._engine.driver.query(e,EH,!0);n.forEach(function(e){if(!e[bG]){var n=i._engine.fetchNamespacesByElement(e);n.size?n.forEach(function(i){return i.triggerLeaveAnimation(e,t,!1,!0)}):i.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return n.forEach(function(e){return i.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,i,n){var r=this,o=this._engine.statesByElement.get(e);if(o){var s=[];if(Object.keys(o).forEach(function(t){if(r._triggers[t]){var i=r.trigger(e,t,AG,n);i&&s.push(i)}}),s.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),i&&$U(s).onDone(function(){return r._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,i=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(i&&n){var r=new Set;i.forEach(function(i){var o=i.name;if(!r.has(o)){r.add(o);var s=t._triggers[o].fallbackTransition,a=n[o]||kG,u=new CG(AG),c=new wG(t.id,o,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:o,transition:s,fromState:a,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var i=this,n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var r=!1;if(n.totalAnimations){var o=n.players.length?n.playersByQueriedElement.get(e):[];if(o&&o.length)r=!0;else for(var s=e;s=s.parentNode;)if(n.statesByElement.get(s)){r=!0;break}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{var a=e[bG];(!a||a===TG)&&(n.afterFlush(function(){return i.clearElementCache(e)}),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){FG(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,i=[];return this._queue.forEach(function(n){var r=n.player;if(!r.destroyed){var o=n.element,s=t._elementListeners.get(o);s&&s.forEach(function(t){if(t.name==n.triggerName){var i=iH(o,n.triggerName,n.fromState.value,n.toState.value);i._data=e,eH(n.player,t.phase,i,t.callback)}}),r.markedForDestroy?t._engine.afterFlush(function(){r.destroy()}):i.push(n)}}),this._queue=[],i.sort(function(e,i){var n=e.transition.ast.depCount,r=i.transition.ast.depCount;return 0==n||0==r?n-r:t._engine.driver.containsElement(e.element,i.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),_G=function(){function e(t,i,n){p(this,e),this.bodyNode=t,this.driver=i,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return S(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var i=new NG(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}},{key:"_balanceNamespaceList",value:function(e,t){var i=this._namespaceList.length-1;if(i>=0){for(var n=!1,r=i;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,t)){this._namespaceList.splice(r+1,0,e),n=!0;break}n||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}},{key:"registerTrigger",value:function(e,t,i){var n=this._namespaceLookup[e];n&&n.register(t,i)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var i=this;if(e){var n=this._fetchNamespace(e);this.afterFlush(function(){i.namespacesByHostElement.delete(n.hostElement),delete i._namespaceLookup[e];var t=i._namespaceList.indexOf(n);t>=0&&i._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return n.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,i=this.statesByElement.get(e);if(i)for(var n=Object.keys(i),r=0;r<n.length;r++){var o=i[n[r]].namespaceId;if(o){var s=this._fetchNamespace(o);s&&t.add(s)}}return t}},{key:"trigger",value:function(e,t,i,n){if(PG(t)){var r=this._fetchNamespace(e);if(r)return r.trigger(t,i,n),!0}return!1}},{key:"insertNode",value:function(e,t,i,n){if(PG(t)){var r=t[bG];if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;var o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){var s=this._fetchNamespace(e);s&&s.insertNode(t,i)}n&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),FG(e,yG)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),UG(e,yG))}},{key:"removeNode",value:function(e,t,i,n){if(PG(t)){var r=e?this._fetchNamespace(e):null;if(r?r.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n),i){var o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,n)}}else this._onRemovalComplete(t,n)}},{key:"markElementAsRemoved",value:function(e,t,i,n){this.collectedLeaveElements.push(t),t[bG]={namespaceId:e,setForRemoval:n,hasAnimation:i,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,i,n,r){return PG(t)?this._fetchNamespace(e).listen(t,i,n,r):function(){}}},{key:"_buildInstruction",value:function(e,t,i,n,r){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,n,e.fromState.options,e.toState.options,t,r)}},{key:"destroyInnerAnimations",value:function(e){var t=this,i=this.driver.query(e,EH,!0);i.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(i=this.driver.query(e,RH,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return $U(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,i=e[bG];if(i&&i.setForRemoval){if(e[bG]=TG,i.namespaceId){this.destroyInnerAnimations(e);var n=this._fetchNamespace(i.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,i.setForRemoval)}this.driver.matchesElement(e,RG)&&this.markElementAsDisabled(e,!1),this.driver.query(e,RG,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,i){return e._balanceNamespaceList(t,i)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var n=0;n<this.collectedEnterElements.length;n++)FG(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var r=[];try{i=this._flushAnimations(r,t)}finally{for(var o=0;o<r.length;o++)r[o]()}}else for(var s=0;s<this.collectedLeaveElements.length;s++)this.processLeaveNode(this.collectedLeaveElements[s]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var a=this._whenQuietFns;this._whenQuietFns=[],i.length?$U(i).onDone(function(){a.forEach(function(e){return e()})}):a.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new $H,o=[],s=new Map,a=[],u=new Map,c=new Map,l=new Map,h=new Set;this.disabledNodes.forEach(function(e){h.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),i=0;i<t.length;i++)h.add(t[i])});var d=this.bodyNode,g=Array.from(this.statesByElement.keys()),f=LG(g,this.collectedEnterElements),v=new Map,p=0;f.forEach(function(e,t){var i=pH+p++;v.set(t,i),e.forEach(function(e){return FG(e,i)})});for(var m=[],S=new Set,E=new Set,y=0;y<this.collectedLeaveElements.length;y++){var R=this.collectedLeaveElements[y],O=R[bG];O&&O.setForRemoval&&(m.push(R),S.add(R),O.hasAnimation?this.driver.query(R,".ng-star-inserted",!0).forEach(function(e){return S.add(e)}):E.add(R))}var T=new Map,I=LG(g,Array.from(S));I.forEach(function(e,t){var i=mH+p++;T.set(t,i),e.forEach(function(e){return FG(e,i)})}),e.push(function(){f.forEach(function(e,t){var i=v.get(t);e.forEach(function(e){return UG(e,i)})}),I.forEach(function(e,t){var i=T.get(t);e.forEach(function(e){return UG(e,i)})}),m.forEach(function(e){n.processLeaveNode(e)})});for(var b=[],C=[],A=this._namespaceList.length-1;A>=0;A--)this._namespaceList[A].drainQueuedTransitions(t).forEach(function(e){var t=e.player,i=e.element;if(b.push(t),n.collectedEnterElements.length){var s=i[bG];if(s&&s.setForMove)return void t.destroy()}var h=!d||!n.driver.containsElement(d,i),g=T.get(i),f=v.get(i),p=n._buildInstruction(e,r,f,g,h);if(p.errors&&p.errors.length)C.push(p);else{if(h)return t.onStart(function(){return _H(i,p.fromStyles)}),t.onDestroy(function(){return NH(i,p.toStyles)}),void o.push(t);if(e.isFallbackTransition)return t.onStart(function(){return _H(i,p.fromStyles)}),t.onDestroy(function(){return NH(i,p.toStyles)}),void o.push(t);p.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(i,p.timelines),a.push({instruction:p,player:t,element:i}),p.queriedElements.forEach(function(e){return nH(u,e,[]).push(t)}),p.preStyleProps.forEach(function(e,t){var i=Object.keys(e);if(i.length){var n=c.get(t);n||c.set(t,n=new Set),i.forEach(function(e){return n.add(e)})}}),p.postStyleProps.forEach(function(e,t){var i=Object.keys(e),n=l.get(t);n||l.set(t,n=new Set),i.forEach(function(e){return n.add(e)})})}});if(C.length){var k=[];C.forEach(function(e){k.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return k.push("- ".concat(e,"\n"))})}),b.forEach(function(e){return e.destroy()}),this.reportError(k)}var N=new Map,_=new Map;a.forEach(function(e){var t=e.element;r.has(t)&&(_.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,N))}),o.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){nH(N,t,[]).push(e),e.destroy()})});var w=m.filter(function(e){return BG(e,c,l)}),P=new Map;DG(P,this.driver,E,l,YU).forEach(function(e){BG(e,c,l)&&w.push(e)});var M=new Map;f.forEach(function(e,t){DG(M,n.driver,new Set(e),c,"!")}),w.forEach(function(e){var t=P.get(e),i=M.get(e);P.set(e,Object.assign(Object.assign({},t),i))});var D=[],L=[],x={};a.forEach(function(e){var t=e.element,i=e.player,a=e.instruction;if(r.has(t)){if(h.has(t))return i.onDestroy(function(){return NH(t,a.toStyles)}),i.disabled=!0,i.overrideTotalTime(a.totalTime),void o.push(i);var u=x;if(_.size>1){for(var c=t,l=[];c=c.parentNode;){var d=_.get(c);if(d){u=d;break}l.push(c)}l.forEach(function(e){return _.set(e,u)})}var g=n._buildAnimation(i.namespaceId,a,N,s,M,P);if(i.setRealPlayer(g),u===x)D.push(i);else{var f=n.playersByElement.get(u);f&&f.length&&(i.parentPlayer=$U(f)),o.push(i)}}else _H(t,a.fromStyles),i.onDestroy(function(){return NH(t,a.toStyles)}),L.push(i),h.has(t)&&o.push(i)}),L.forEach(function(e){var t=s.get(e.element);if(t&&t.length){var i=$U(t);e.setRealPlayer(i)}}),o.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var F=0;F<m.length;F++){var U=m[F],H=U[bG];if(UG(U,mH),!H||!H.hasAnimation){var G=[];if(u.size){var B=u.get(U);B&&B.length&&G.push.apply(G,i(B));for(var W=this.driver.query(U,RH,!0),V=0;V<W.length;V++){var z=u.get(W[V]);z&&z.length&&G.push.apply(G,i(z))}}var Y=G.filter(function(e){return!e.destroyed});Y.length?HG(this,U,Y):this.processLeaveNode(U)}}return m.length=0,D.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),D}},{key:"elementContainsData",value:function(e,t){var i=!1,n=t[bG];return n&&n.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,i,n,r){var o=[];if(t){var s=this.playersByQueriedElement.get(e);s&&(o=s)}else{var a=this.playersByElement.get(e);if(a){var u=!r||r==AG;a.forEach(function(e){e.queued||!u&&e.triggerName!=n||o.push(e)})}}return(i||n)&&(o=o.filter(function(e){return!(i&&i!=e.namespaceId||n&&n!=e.triggerName)})),o}},{key:"_beforeAnimationBuild",value:function(e,t,i){var r,o=this,s=t.element,a=t.isRemovalTransition?void 0:e,u=t.isRemovalTransition?void 0:t.triggerName,c=n(t.timelines);try{var l=function(){var e=r.value.element,n=e!==s,c=nH(i,e,[]);o._getPreviousPlayers(e,n,a,u,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(c.s();!(r=c.n()).done;)l()}catch(h){c.e(h)}finally{c.f()}_H(s,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,i,n,r,o){var s=this,a=t.triggerName,u=t.element,c=[],l=new Set,h=new Set,d=t.timelines.map(function(t){var d=t.element;l.add(d);var g=d[bG];if(g&&g.removedBeforeQueried)return new qU(t.duration,t.delay);var f=d!==u,v=function(e){var t=[];return GG(e,t),t}((i.get(d)||OG).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===d}),p=r.get(d),m=o.get(d),S=JU(0,s._normalizer,0,t.keyframes,p,m),E=s._buildPlayer(t,S,v);if(t.subTimeline&&n&&h.add(d),f){var y=new wG(e,a,d);y.setRealPlayer(E),c.push(y)}return E});c.forEach(function(e){nH(s.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,i){var n;if(e instanceof Map){if(n=e.get(t)){if(n.length){var r=n.indexOf(i);n.splice(r,1)}0==n.length&&e.delete(t)}}else if(n=e[t]){if(n.length){var o=n.indexOf(i);n.splice(o,1)}0==n.length&&delete e[t]}return n}(s.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return FG(e,yH)});var g=$U(d);return g.onDestroy(function(){l.forEach(function(e){return UG(e,yH)}),NH(u,t.toStyles)}),h.forEach(function(e){nH(n,e,[]).push(g)}),g}},{key:"_buildPlayer",value:function(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new qU(e.duration,e.delay)}}]),e}(),wG=function(){function e(t,i,n){p(this,e),this.namespaceId=t,this.triggerName=i,this.element=n,this._player=new qU,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return S(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(i){t._queuedCallbacks[i].forEach(function(t){return eH(e,i,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,i=this._player;i.triggerCallback&&e.onStart(function(){return i.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){nH(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function PG(e){return e&&1===e.nodeType}function MG(e,t){var i=e.style.display;return e.style.display=null!=t?t:"none",i}function DG(e,t,i,n,r){var o=[];i.forEach(function(e){return o.push(MG(e))});var s=[];n.forEach(function(i,n){var o={};i.forEach(function(e){var i=o[e]=t.computeStyle(n,e,r);(!i||0==i.length)&&(n[bG]=IG,s.push(n))}),e.set(n,o)});var a=0;return i.forEach(function(e){return MG(e,o[a++])}),s}function LG(e,t){var i=new Map;if(e.forEach(function(e){return i.set(e,[])}),0==t.length)return i;var n=new Set(t),r=new Map;function o(e){if(!e)return 1;var t=r.get(e);if(t)return t;var s=e.parentNode;return t=i.has(s)?s:n.has(s)?1:o(s),r.set(e,t),t}return t.forEach(function(e){var t=o(e);1!==t&&i.get(t).push(e)}),i}var xG="$$classes";function FG(e,t){if(e.classList)e.classList.add(t);else{var i=e[xG];i||(i=e[xG]={}),i[t]=!0}}function UG(e,t){if(e.classList)e.classList.remove(t);else{var i=e[xG];i&&delete i[t]}}function HG(e,t,i){$U(i).onDone(function(){return e.processLeaveNode(t)})}function GG(e,t){for(var i=0;i<e.length;i++){var n=e[i];n instanceof XU?GG(n.players,t):t.push(n)}}function BG(e,t,i){var n=i.get(e);if(!n)return!1;var r=t.get(e);return r?n.forEach(function(e){return r.add(e)}):t.set(e,n),i.delete(e),!0}var WG=function(){function e(t,i,n){var r=this;p(this,e),this.bodyNode=t,this._driver=i,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new _G(t,i,n),this._timelineEngine=new SG(t,i,n),this._transitionEngine.onRemovalComplete=function(e,t){return r.onRemovalComplete(e,t)}}return S(e,[{key:"registerTrigger",value:function(e,t,i,n,r){var o=e+"-"+n,s=this._triggerCache[o];if(!s){var a=[],u=YH(this._driver,r,a);if(a.length)throw new Error('The animation trigger "'.concat(n,'" has failed to build due to the following errors:\n - ').concat(a.join("\n - ")));s=function(e,t,i){return new vG(e,t,i)}(n,u,this._normalizer),this._triggerCache[o]=s}this._transitionEngine.registerTrigger(t,n,s)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,i,n){this._transitionEngine.insertNode(e,t,i,n)}},{key:"onRemove",value:function(e,t,i,n){this._transitionEngine.removeNode(e,t,n||!1,i)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,i,n,r){if("@"==n.charAt(0)){var o=t(rH(n),2),s=o[0],a=o[1];this._timelineEngine.command(s,i,a,r)}else this._transitionEngine.trigger(e,i,n,r)}},{key:"listen",value:function(e,i,n,r,o){if("@"==n.charAt(0)){var s=t(rH(n),2),a=s[0],u=s[1];return this._timelineEngine.listen(a,i,u,o)}return this._transitionEngine.listen(e,i,n,r,o)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();(function(){function e(t,i,n){p(this,e),this._element=t,this._startStyles=i,this._endStyles=n,this._state=0;var r=e.initialStylesByElement.get(t);r||e.initialStylesByElement.set(t,r={}),this._initialStyles=r}return S(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&NH(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(NH(this._element,this._initialStyles),this._endStyles&&(NH(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(_H(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(_H(this._element,this._endStyles),this._endStyles=null),NH(this._element,this._initialStyles),this._state=3)}}]),e}()).initialStylesByElement=new WeakMap;var VG=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this))._nextAnimationId=0,r._renderer=e.createRenderer(n.body,{id:"0",encapsulation:Ge.None,styles:[],data:{animation:[]}}),r}return S(i,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var i=Array.isArray(e)?jU(e):e;return jG(this._renderer,null,t,"register",[i]),new zG(t,this._renderer)}}]),i}(zU);return e.\u0275fac=function(t){return new(t||e)(An(Ga),An(cl))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),zG=function(e){c(i,e);var t=h(i);function i(e,n){var r;return p(this,i),(r=t.call(this))._id=e,r._renderer=n,r}return S(i,[{key:"create",value:function(e,t){return new YG(this._id,e,t||{},this._renderer)}}]),i}(function(){return function e(){p(this,e)}}()),YG=function(){function e(t,i,n,r){p(this,e),this.id=t,this.element=i,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}return S(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return jG(this._renderer,this.element,this.id,e,i)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function jG(e,t,i,n,r){return e.setProperty(t,"@@".concat(i,":").concat(n),r)}var KG="@.disabled",QG=function(){var e=function(){function e(t,i,n){p(this,e),this.delegate=t,this.engine=i,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return S(e,[{key:"createRenderer",value:function(e,t){var i=this,n=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var r=this._rendererCache.get(n);return r||(r=new qG("",n,this.engine),this._rendererCache.set(n,r)),r}var o=t.id,s=t.id+"-"+this._currentId;this._currentId++,this.engine.register(s,e);return t.data.animation.forEach(function t(n){Array.isArray(n)?n.forEach(t):i.engine.registerTrigger(o,s,e,n.name,n)}),new XG(this,s,n,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,i,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return i(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var i=t(e,2);(0,i[0])(i[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(An(Ga),An(WG),An(wc))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),qG=function(){function e(t,i,n){p(this,e),this.namespaceId=t,this.delegate=i,this.engine=n,this.destroyNode=this.delegate.destroyNode?function(e){return i.destroyNode(e)}:null}return S(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,n)}},{key:"removeChild",value:function(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,i,n){this.delegate.setAttribute(e,t,i,n)}},{key:"removeAttribute",value:function(e,t,i){this.delegate.removeAttribute(e,t,i)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,i,n){this.delegate.setStyle(e,t,i,n)}},{key:"removeStyle",value:function(e,t,i){this.delegate.removeStyle(e,t,i)}},{key:"setProperty",value:function(e,t,i){"@"==t.charAt(0)&&t==KG?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,i){return this.delegate.listen(e,t,i)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),XG=function(e){c(n,e);var i=h(n);function n(e,t,r,o){var s;return p(this,n),(s=i.call(this,t,r,o)).factory=e,s.namespaceId=t,s}return S(n,[{key:"setProperty",value:function(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==KG?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.substr(1),i):this.delegate.setProperty(e,t,i)}},{key:"listen",value:function(e,i,n){var r=this;if("@"==i.charAt(0)){var o,s=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),a=i.substr(1),u="";return"@"!=a.charAt(0)&&(a=(o=t(function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(a),2))[0],u=o[1]),this.engine.listen(this.namespaceId,s,a,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,i,n)}}]),n}(qG),ZG=function(){var e=function(e){c(i,e);var t=h(i);function i(e,n,r){return p(this,i),t.call(this,e.body,n,r)}return S(i,[{key:"ngOnDestroy",value:function(){this.flush()}}]),i}(WG);return e.\u0275fac=function(t){return new(t||e)(An(cl),An(vH),An(uG))},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),$G=[{provide:vH,useClass:fH},{provide:new an("AnimationModuleType"),useValue:"NoopAnimations"}].concat([{provide:zU,useClass:VG},{provide:uG,useFactory:function(){return new cG}},{provide:WG,useClass:ZG},{provide:Ga,useFactory:function(e,t,i){return new QG(e,t,i)},deps:[Oh,WG,wc]}]),JG=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e}),e.\u0275inj=Ce({providers:$G,imports:[Dh]}),e}(),eB=function(){var e=function(){function e(){p(this,e),this.handlers={}}return S(e,[{key:"shouldDetach",value:function(e){return e.routeConfig&&("village"===e.routeConfig.path||"fort"===e.routeConfig.path||"forest"===e.routeConfig.path||"field"===e.routeConfig.path||"mountains"===e.routeConfig.path||"plateau"===e.routeConfig.path||"sea"===e.routeConfig.path)}},{key:"store",value:function(e,t){this.handlers[e.routeConfig.path]=t}},{key:"shouldAttach",value:function(e){return!!e.routeConfig&&!!this.handlers[e.routeConfig.path]}},{key:"retrieve",value:function(e){return e.routeConfig?this.handlers[e.routeConfig.path]:null}},{key:"shouldReuseRoute",value:function(e,t){return!1}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=be({token:e,factory:e.\u0275fac}),e}(),tB=function(){var e=function e(){p(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=st({type:e,bootstrap:[VU]}),e.\u0275inj=Ce({providers:[DE,{provide:Qf,useClass:eB}],imports:[[nT,Dh,jP,JG,gE,qM]]}),e}();Cp.production&&function(){if(Vc)throw new Error("Cannot enable prod mode after platform setup.");Wc=!1}(),Ph().bootstrapModule(tB).catch(function(e){return console.log(e)})}},function(e){e(e.s=48475)}])}();